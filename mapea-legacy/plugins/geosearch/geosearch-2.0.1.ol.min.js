!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=83)}({0:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"init",value:function(){if(!1===e.initialized){e.initialized=!0;var t=document.createElement("img");t.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24.svg"]),t.width="24",t.height="24",t.crossOrigin="anonymous";var r=document.createElement("IMG");r.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24-new.svg"]),r.width="24",r.height="24",r.crossOrigin="anonymous";var n=document.createElement("IMG");n.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24-sel.svg"]),n.width="24",n.height="24",n.crossOrigin="anonymous",e.DEFAULT[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[24,24]})}),e.DEFAULT[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#A15BD7"}),stroke:new ol.style.Stroke({color:"#A15BD7",width:2})}),e.DEFAULT[M.geom.wkt.type.POLYGON]=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[24,24]})}),e.DEFAULT[M.geom.wkt.type.MULTI_POINT]=e.DEFAULT[M.geom.wkt.type.POINT],e.DEFAULT[M.geom.wkt.type.LINEAR_RING]=e.DEFAULT[M.geom.wkt.type.LINE_STRING],e.DEFAULT[M.geom.wkt.type.MULTI_LINE_STRING]=e.DEFAULT[M.geom.wkt.type.LINE_STRING],e.DEFAULT[M.geom.wkt.type.MULTI_POLYGON]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.DEFAULT[M.geom.wkt.type.CIRCLE]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.DEFAULT[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:r,imgSize:[24,24]})}),e.NEW[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#e2951b"}),stroke:new ol.style.Stroke({color:"#e2951b",width:2})}),e.NEW[M.geom.wkt.type.POLYGON]=new ol.style.Style({image:new ol.style.Icon({img:r,imgSize:[24,24]})}),e.NEW[M.geom.wkt.type.MULTI_POINT]=e.NEW[M.geom.wkt.type.POINT],e.NEW[M.geom.wkt.type.LINEAR_RING]=e.NEW[M.geom.wkt.type.LINE_STRING],e.NEW[M.geom.wkt.type.MULTI_LINE_STRING]=e.NEW[M.geom.wkt.type.LINE_STRING],e.NEW[M.geom.wkt.type.MULTI_POLYGON]=e.NEW[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.CIRCLE]=e.NEW[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.NEW[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:n,imgSize:[24,24]})}),e.SELECTED[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#fcfcfc"}),stroke:new ol.style.Stroke({color:"#3589d1",width:2})}),e.SELECTED[M.geom.wkt.type.POLYGON]=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(240, 220, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#a15bd7",width:2})}),e.SELECTED[M.geom.wkt.type.MULTI_POINT]=e.SELECTED[M.geom.wkt.type.POINT],e.SELECTED[M.geom.wkt.type.LINEAR_RING]=e.SELECTED[M.geom.wkt.type.LINE_STRING],e.SELECTED[M.geom.wkt.type.MULTI_LINE_STRING]=e.SELECTED[M.geom.wkt.type.LINE_STRING],e.SELECTED[M.geom.wkt.type.MULTI_POLYGON]=e.SELECTED[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.CIRCLE]=e.SELECTED[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.SELECTED[M.geom.wkt.type.POLYGON]}}}],(r=null)&&n(t.prototype,r),o&&n(t,o),e}();function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}o.DEFAULT={},o.NEW={},o.SELECTED={},o.initialized=!1;var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"getCentroidCoordinate",value:function(t){var r,n,o,s,l,a;return t.getType()===M.geom.wkt.type.POINT?r=t.getCoordinates():t.getType()===M.geom.wkt.type.LINE_STRING||t.getType()===M.geom.wkt.type.LINEAR_RING?r=(n=t.getCoordinates())[o=Math.floor(n.length/2)]:t.getType()===M.geom.wkt.type.POLYGON?r=e.getCentroidCoordinate(t.getInteriorPoint()):t.getType()===M.geom.wkt.type.MULTI_POINT?(s=t.getPoints(),o=Math.floor(s.length/2),r=e.getCentroidCoordinate(s[o])):t.getType()===M.geom.wkt.type.MULTI_LINE_STRING?(l=t.getLineStrings(),o=Math.floor(l.length/2),r=e.getCentroidCoordinate(l[o])):t.getType()===M.geom.wkt.type.MULTI_POLYGON?(s=t.getInteriorPoints(),r=e.getCentroidCoordinate(s)):t.getType()===M.geom.wkt.type.CIRCLE?r=t.getCenter():t.getType()===M.geom.wkt.type.GEOMETRY_COLLECTION&&(a=t.getGeometries(),o=Math.floor(a.length/2),r=e.getCentroidCoordinate(a[o])),r}}],(r=null)&&s(t.prototype,r),n&&s(t,n),e}(),a=r(4),i=r.n(a);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return m(this,r)}}function m(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(a,M.impl.layer.Vector);var t,r,n,s=y(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"geosearch",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,a);var n=r;return(e=s.call(this,n)).wktFormatter_=new ol.format.WKT,e.popup_=null,e.selectedFeatures_=[],n.displayInLayerSwitcher||(n.displayInLayerSwitcher=!1),e.name=t,e}return t=a,n=[{key:"setStyleFeature",value:function(e,t){var r=e;o.init(),M.utils.isArray(r)||(r=[r]),r.forEach((function(e){var r=e.getGeometry().getType();M.utils.isNullOrEmpty(t)||t===M.style.state.DEFAULT?e.setStyle(o.DEFAULT[r]):t===M.style.state.NEW?e.setStyle(o.NEW[r]):t===M.style.state.SELECTED&&e.setStyle(o.SELECTED[r])}))}}],(r=[{key:"addTo",value:function(e){h(d(a.prototype),"addTo",this).call(this,e),this.ol3Layer.setSource(new ol.source.Vector({useSpatialIndex:!1}))}},{key:"drawResults",value:function(e){var t=this,r=ol.proj.get(this.map.getProjection().code),n=[];M.utils.isNullOrEmpty(e.spatial_response)||(n=e.spatial_response.docs),M.utils.isNullOrEmpty(n)&&(n=e.response.docs);var o=n.map((function(e){var n=t.wktFormatter_.readFeature(e.geom,{dataProjection:r});return n.setId(e.solrid),n.setProperties(e),a.setStyleFeature(n,M.style.state.DEFAULT),t.wrapComplexFeature_(n),M.impl.Feature.olFeature2Facade(n)}),this);this.facadeVector_.addFeatures(o)}},{key:"drawNewResults",value:function(e){var t,r=this,n=ol.proj.get(this.map.getProjection().code);M.utils.isNullOrEmpty(e.spatial_response)?M.utils.isNullOrEmpty(e.response)||(t=e.response.docs):t=e.spatial_response.docs;var o=t.map((function(e){var t=r.wktFormatter_.readFeature(e.geom,{dataProjection:n});return t.setId(e.solrid),t.setProperties(e),a.setStyleFeature(t,M.style.state.NEW),M.impl.Feature.olFeature2Facade(t)}),this);this.facadeVector_.addFeatures(o)}},{key:"clear",value:function(e){this.map.removePopup(),this.facadeVector_.clear()}},{key:"selectFeatures",value:function(e,t,r,n){var o=this,s=e;this.unselectFeatures(),this.selectedFeatures_=s,s=s.map(M.impl.Feature.facade2OLFeature),a.setStyleFeature(s,M.style.state.SELECTED);var l={jsonp:!0,vars:this.parseFeaturesForTemplate_(s),parseToHtml:!1},u={icon:"g-cartografia-pin",title:"Geosearch",content:M.template.compileSync(i.a,l)},c=this.map.getPopup();M.utils.isNullOrEmpty(c)?((c=new M.Popup({panMapIfOutOfView:!n,ani:null})).addTab(u),this.map.addPopup(c,t)):c.addTab(u),c.on(M.evt.DESTROY,(function(){o.internalUnselectFeatures_(!0)}),this)}},{key:"selectFeatureBySolrid",value:function(e){var t=this.facadeVector_.getFeatureById(e);this.selectedFeatures_=[t];var r=t.getImpl().getOLFeature().getGeometry(),n=l.getCentroidCoordinate(r);this.unselectFeatures(),this.selectFeatures([t],n,null,!0),this.map.setBbox(r.getExtent())}},{key:"parseFeaturesForTemplate_",value:function(e){var t={features:[]};return e.forEach((function(e){var r=["geom","_version_","keywords","solrid",e.getGeometryName()],n=e.getProperties(),o=[];Object.keys(n).forEach((function(e){M.utils.includes(r,e.toLowerCase())||o.push({key:M.utils.beautifyAttributeName(e),value:n[e]})}));var s={solrid:e.getId(),attributes:o};t.features.push(s)})),t}},{key:"wrapComplexFeature_",value:function(e){var t=e.getGeometry();if(t.getType()===M.geom.wkt.type.POLYGON||t.getType()===M.geom.wkt.type.MULTI_POLYGON){var r;r=t.getType()===M.geom.wkt.type.POLYGON?t.getInteriorPoint():t.getInteriorPoints();var n=new ol.geom.GeometryCollection([r,t]);e.setGeometry(n)}}},{key:"unselectFeatures",value:function(e,t){this.internalUnselectFeatures_()}},{key:"internalUnselectFeatures_",value:function(e){this.selectedFeatures_.length>0&&(a.setStyleFeature(this.selectedFeatures_.map(M.impl.Feature.facade2OLFeature),M.style.state.DEFAULT),this.selectedFeatures_.length=0,e||this.map.removePopup())}},{key:"setNewResultsAsDefault",value:function(){a.setStyleFeature(this.facadeVector_.getFeatures().map(M.impl.Feature.facade2OLFeature),M.style.state.DEFAULT)}},{key:"getCentroidCoordinate",value:function(e){var t,r,n,o,s,l;return e.getType()===M.geom.wkt.type.POINT?t=e.getCoordinates():e.getType()===M.geom.wkt.type.LINE_STRING||e.getType()===M.geom.wkt.type.LINEAR_RING?t=(r=e.getCoordinates())[n=Math.floor(r.length/2)]:e.getType()===M.geom.wkt.type.POLYGON?t=this.getCentroidCoordinate(e.getInteriorPoint()):e.getType()===M.geom.wkt.type.MULTI_POINT?(o=e.getPoints(),n=Math.floor(o.length/2),t=this.getCentroidCoordinate(o[n])):e.getType()===M.geom.wkt.type.MULTI_LINE_STRING?(s=e.getLineStrings(),n=Math.floor(s.length/2),t=this.getCentroidCoordinate(s[n])):e.getType()===M.geom.wkt.type.MULTI_POLYGON?(o=e.getInteriorPoints(),t=this.getCentroidCoordinate(o)):e.getType()===M.geom.wkt.type.CIRCLE?t=e.getCenter():e.getType()===M.geom.wkt.type.GEOMETRY_COLLECTION&&(l=e.getGeometries(),n=Math.floor(l.length/2),t=this.getCentroidCoordinate(l[n])),t}},{key:"destroy",value:function(){var e=this.map.getMapImpl();M.utils.isNullOrEmpty(this.ol3Layer)||(e.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map=null,this.wktFormatter_=null,this.popup_=null,this.selectedFeatures_=null,this.name=null}},{key:"equals",value:function(e){var t=!1;return e instanceof a&&(t=this.url===e.url,t=t&&this.name===e.name),t}},{key:"getFeaturesExtentPromise",value:function(e,t){var r=this;return new Promise((function(n){var o=r.map.getProjection().code;if(!0===r.isLoaded()){var s=r.getFeatures(e,t),l=M.impl.utils.getFeaturesExtent(s,o);n(l)}else r.requestFeatures_().then((function(e){var t=M.impl.utils.getFeaturesExtent(e,o);n(t)}))}))}}])&&p(t.prototype,r),n&&p(t,n),a}();function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=L(e);if(t){var o=L(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}function S(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}g.POPUP_RESULT="geosearchfeaturepopup.html";var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(s,M.layer.Vector);var t,r,n,o=b(s);function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new g;return v(this,s),e=o.call(this,t,r,{},n),M.utils.isUndefined(g)&&M.exception("La implementación usada no puede crear capas Geosearch"),e.displayInLayerSwitcher=!1,e}return t=s,(r=[{key:"equals",value:function(e){return!1}}])&&E(t.prototype,r),n&&E(t,n),s}();function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=R(e);if(t){var o=R(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return P(this,r)}}function P(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",(function(){return F}));var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(s,M.impl.Control);var t,r,n,o=I(s);function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return O(this,s),(e=o.call(this)).facadeMap_=null,e.helpHtml_=null,e.layer_=new k({name:t.layerName||"__geosearch_plugin_layer_name__"}),e}return t=s,(r=[{key:"addTo",value:function(e,t){this.facadeMap_=e,e.addLayers(this.layer_),ol.control.Control.call(this,{element:t,target:null}),e.getMapImpl().addControl(this)}},{key:"unselectResults",value:function(e){this.layer_.getImpl().unselectFeatures(e)}},{key:"setNewResultsAsDefault",value:function(){this.layer_.getImpl().setNewResultsAsDefault()}},{key:"drawResults",value:function(e){this.layer_.getImpl().drawResults(e)}},{key:"drawNewResults",value:function(e){this.layer_.getImpl().drawNewResults(e)}},{key:"zoomToResults",value:function(){var e=ol.extent.boundingExtent(this.layer_.getImpl().getOL3Layer().getSource().getFeatures().map((function(e){return ol.extent.getCenter(e.getGeometry().getExtent())})));this.facadeMap_.setBbox(e)}},{key:"getLayer",value:function(){return this.layer_}},{key:"resultClick",value:function(e){this.layer_.getImpl().selectFeatureBySolrid(e)}},{key:"hideHelp",value:function(){M.utils.isNullOrEmpty(this.helpHtml_)||(this.facadeMap_.getMapImpl().getTargetElement().removeChild(this.helpHtml_),this.helpHtml_=null)}},{key:"showHelp",value:function(e){var t=this.facadeMap_.getMapImpl().getTargetElement();M.utils.isNullOrEmpty(this.helpHtml_)||t.removeChild(this.helpHtml_),this.helpHtml_=e,t.appendChild(this.helpHtml_)}},{key:"clear",value:function(){this.layer_.clear()}},{key:"destroy",value:function(){this.clear(),this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.remove("top-extra"),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null,this.helpHtml_=null,this.layer_=null}}])&&C(t.prototype,r),n&&C(t,n),s}()},1:function(e,t){e.exports='<div class="results-panels">\n   {{#if partial}}\n   <div class="partial">\n      <p>No se han encontrado resultados para la búsqueda.</p>\n      <p>A continuación se muestran otros resultados que quizás le interesen:...</p>\n   </div>\n   {{/if}}\n   <div class="results" id="m-geosearch-results-scroll">\n      {{#each docs}}\n      <div id="{{solrid}}" class="result">\n         {{#each attributes}}\n         <table>\n            <tbody>\n               <tr>\n                  <td class="key">{{key}}</td>\n                  <td class="value{{#oneword value}} m-wordbreak{{/oneword}}">{{{value}}}</td>\n               </tr>\n            </tbody>\n         </table>\n         {{/each}}\n      </div>\n      {{/each}}\n   </div>\n   {{#eq docs.length 0}}\n   <div class="results">\n      <div class="partial">No se han encontrado resultados para la búsqueda "{{query}}".</div>\n   </div>\n   {{/eq}}\n   <div class="page">\n      <span class="found" id="m-geosearch-page-found">{{docs.length}}</span> de <span class="total">{{total}}</span>\n      <div class="g-cartografia-flecha-arriba"></div>\n   </div>\n</div>'},2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),o=r(5),s=r.n(o),l=r(1),a=r.n(l),i=r(6),u=r.n(i);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,M.Control);var t,r,o,l=f(i);function i(e,t,r,o,s){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var u=new n.a;return a=l.call(this,u,i.NAME),M.utils.isUndefined(n.a)&&M.exception("La implementación usada no puede crear controles Geosearch"),a.input_=null,a.element_=null,a.resultsContainer_=null,a.resultsScrollContainer_=null,a.searchingResult_=null,a.searchTime_=0,a.url_=e,a.core_=t,a.handler_=r,a.searchUrl_=M.utils.concatUrlPaths([a.url_,a.core_,a.handler_]),a.helpUrl_=M.utils.concatUrlPaths([a.url_,a.core_,"/help"]),a.searchParameters_=o,M.utils.isNullOrEmpty(a.searchParameters_)||(M.utils.isNullOrEmpty(a.searchParameters_.rows)&&(a.searchParameters_.rows=M.config.GEOSEARCH_ROWS),a.searchUrl_=M.utils.addParameters(a.searchUrl_,a.searchParameters_)),a.results_=[],a.showHelp_=s,a.scrollIsUp_=!0,a.spatialSearch_=!1,a.facadeMap_=null,a}return t=i,(r=[{key:"createView",value:function(e){this.facadeMap_=e;var t=M.template.compileSync(s.a,{jsonp:!0});return!1===this.showHelp_&&t.querySelector("#m-geosearch-help-btn").classList.add("m-hidden"),this.addEvents(t),t}},{key:"addEvents",value:function(e){var t=this;this.element_=e,this.on(M.evt.COMPLETED,(function(){t.element_.classList.add("shown")}),this),this.input_=this.element_.getElementsByTagName("input")["m-geosearch-search-input"],this.input_.addEventListener("keyup",this.searchClick.bind(this)),this.element_.getElementsByTagName("button")["m-geosearch-search-btn"].addEventListener("click",this.searchClick.bind(this));var r=this.element_.getElementsByTagName("button")["m-geosearch-help-btn"];r&&r.addEventListener("click",(function(e){e.preventDefault(),r.classList.toggle("shown"),t.helpClick_()})),this.element_.getElementsByTagName("button")["m-geosearch-clear-btn"].addEventListener("click",this.clearClick_.bind(this)),this.resultsContainer_=this.element_.querySelector("div#m-geosearch-results"),M.utils.enableTouchScroll(this.resultsContainer_),this.searchingResult_=this.element_.querySelector("div#m-geosearch-results > div#m-searching-result")}},{key:"addEventsHelp",value:function(e){this.element_=e,this.element_.getElementsByTagName("button")["m-geosearch-closeHelp-btn"].addEventListener("click",this.closeHelpClick_.bind(this))}},{key:"searchClick",value:function(e){if(e.preventDefault(),"keyup"!==e.type||13===e.keyCode){this.results_.length=0;var t=this.input_.value;M.utils.isNullOrEmpty(t)?M.dialog.info("Debe introducir una búsqueda."):this.search_(t,this.showResults_)}}},{key:"resultClick_",value:function(e){var t=e;t.preventDefault(),M.window.WIDTH<=M.config.MOBILE_WIDTH&&this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba").click(),this.facadeMap_.removePopup();var r=t.currentTarget.id;this.getImpl().resultClick(r)}},{key:"search_",value:function(e,t){var r=this;this.resultsContainer_.appendChild(this.searchingResult_),this.searchTime_=Date.now(),this.element_.classList.add(i.SEARCHING_CLASS);var n,o=M.utils.addParameters(this.searchUrl_,{q:e,start:this.results_.length,srs:this.facadeMap_.getProjection().code});n=this.searchTime_,M.remote.get(o).then((function(e){if(n===r.searchTime_){var o;try{o=JSON.parse(e.text)}catch(e){M.exception("La respuesta no es un JSON válido: ".concat(e))}t.call(r,o),r.element_.classList.remove(i.SEARCHING_CLASS)}}))}},{key:"showResults_",value:function(e){this.getImpl().clear(),this.drawResults(e);var t={jsonp:!0,vars:this.parseResultsForTemplate_(e)},r=M.template.compileSync(a.a,t);this.resultsContainer_.classList.remove(i.HIDDEN_RESULTS_CLASS),M.utils.isNullOrEmpty(this.resultsScrollContainer_)||this.resultsScrollContainer_.removeEventListener("scroll",this.resultsScroll_);for(var n=this.resultsContainer_.querySelectorAll(".result"),o=0,s=n.length;o<s;o+=1)n.item(o).removeEventListener("click",this.resultClick_.bind(this));e.response.docs.length>0&&this.zoomToResults();var l=this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba");M.utils.isNullOrEmpty(l)||l.removeEventListener("click",this.resultsClick_.bind(this)),this.resultsContainer_.innerHTML=r.innerHTML,this.resultsScrollContainer_=this.resultsContainer_.querySelector("div#m-geosearch-results-scroll"),M.utils.enableTouchScroll(this.resultsScrollContainer_),this.resultsScrollContainer_.addEventListener("scroll",this.resultsScroll_.bind(this));for(var u=0,c=(n=this.resultsContainer_.getElementsByClassName("result")).length;u<c;u+=1)n.item(u).addEventListener("click",this.resultClick_.bind(this));(l=this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba")).addEventListener("click",this.resultsClick_.bind(this)),this.checkScrollSearch_(e),this.fire(M.evt.COMPLETED)}},{key:"drawResults",value:function(e){this.getImpl().drawResults(e)}},{key:"drawNewResults",value:function(e){this.getImpl().drawNewResults(e)}},{key:"zoomToResults",value:function(){this.getImpl().zoomToResults()}},{key:"getInput",value:function(){return this.input_}},{key:"appendResults_",value:function(e){var t=this;this.drawNewResults(e);for(var r={jsonp:!0,vars:this.parseResultsForTemplate_(e,!0)},n=M.template.compileSync(a.a,r).getElementsByTagName("div")["m-geosearch-results-scroll"].children,o=0;o<n.length;o+=1){var s=n.item(o);this.resultsScrollContainer_.appendChild(s),s.addEventListener("click",(function(e){return t.resultClick_(e)}))}this.resultsContainer_.getElementsByTagName("span")["m-geosearch-page-found"].innerHTML=this.results_.length,this.checkScrollSearch_(e)}},{key:"resultsScroll_",value:function(e){var t=e.target,r=t.offsetHeight,n=t.scrollHeight-t.scrollTop-r<=15;n&&this.scrollIsUp_?(this.scrollIsUp_=!1,this.scrollSearch_()):n||(this.scrollIsUp_=!0)}},{key:"scrollSearch_",value:function(){this.getImpl().unselectResults(!0),this.getImpl().setNewResultsAsDefault();var e=this.input_.value;this.search_(e,this.appendResults_)}},{key:"helpClick_",value:function(e){var t=this;!0===this.helpShown_?(this.getImpl().hideHelp(),this.helpShown_=!1):M.remote.get(this.helpUrl_).then((function(e){var r;try{r=JSON.parse(e.text)}catch(e){M.Exception("La respuesta no es un JSON válido: ".concat(e))}var n={jsonp:!0,vars:{entities:r}},o=M.template.compileSync(u.a,n);t.addEventsHelp(o),t.getImpl().showHelp(o),t.helpShown_=!0}))}},{key:"closeHelpClick_",value:function(e){!0===this.helpShown_&&(this.getImpl().hideHelp(),this.helpShown_=!1)}},{key:"clearClick_",value:function(e){this.element_.classList.remove("shown"),M.utils.isNullOrEmpty(this.input_)||(this.input_.value=""),M.utils.isNullOrEmpty(this.resultsContainer_)||(this.resultsContainer_.innerHTML=""),M.utils.isNullOrEmpty(this.resultsScrollContainer_)||(this.resultsScrollContainer_.innerHTML="",this.resultsScrollContainer_=null),this.results_.length=0,this.resultsContainer_.classList.remove(i.HIDDEN_RESULTS_CLASS),this.getImpl().clear(),this.getImpl().hideHelp(),this.spatialSearch_=!1}},{key:"resultsClick_",value:function(e){this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.add("top-extra-search"),e.target.classList.toggle("g-cartografia-flecha-arriba"),e.target.classList.toggle("g-cartografia-flecha-abajo"),this.resultsContainer_.classList.toggle(i.HIDDEN_RESULTS_CLASS)}},{key:"equals",value:function(e){var t=!1;return e instanceof i&&(t=this.name===e.name),t}},{key:"parseResultsForTemplate_",value:function(e,t){var r="";M.utils.isNullOrEmpty(this.input_)||(r=this.input_.value);var n=0;M.utils.isUndefined(e.spatial_response)?(n=e.response.numFound,this.spatialSearch_=!1):(n=e.spatial_response.numFound,this.spatialSearch_=!0);var o=this.getDocsFromResults_(e);this.results_=!0===t?this.results_.concat(o):o;var s=this.spatialSearch_&&M.utils.isNullOrEmpty(e.spatial_response.docs);return 0!==n?{docs:o,total:n,partial:s}:{docs:o,total:n,notResutls:!0,query:r}}},{key:"getDocsFromResults_",value:function(e){var t=[];t=this.spatialSearch_?e.spatial_response.docs:e.response.docs;var r=["geom","_version_","keywords","solrid"];return t=t.map((function(e){var t=[];return Object.keys(e).forEach((function(n){M.utils.includes(r,n)||t.push({key:M.utils.beautifyAttributeName(n),value:e[n]})})),{solrid:e.solrid,attributes:t}}))}},{key:"checkScrollSearch_",value:function(e){var t=0;t=M.utils.isUndefined(e.spatial_response)?e.response.numFound:e.spatial_response.numFound,this.results_.length!==t||M.utils.isNullOrEmpty(this.resultsScrollContainer_)||this.resultsScrollContainer_.removeEventListener("scroll",this.resultsScroll_)}}])&&p(t.prototype,r),o&&p(t,o),i}();d.NAME="geosearch",d.TEMPLATE="geosearch.html",d.RESULTS_TEMPLATE="geosearchresults.html",d.HELP_TEMPLATE="geosearchhelp.html",d.SEARCHING_CLASS="m-searching",d.HIDDEN_RESULTS_CLASS="hidden"},21:function(e){e.exports=JSON.parse('{"url":{"name":"geosearch","separator":"*"},"constructor":"M.plugin.Geosearch","parameters":[{"type":"object","properties":[{"type":"simple","name":"url","position":0},{"type":"simple","name":"core","position":1},{"type":"simple","name":"handler","position":2}]}],"files":{"ol":{"scripts":["geosearch-2.0.1.ol.min.js"],"styles":["geosearch-2.0.1.min.css"]}},"metadata":{"name":"Geosearch","description":"","text":"","version":"2.0.1","date":"11/10/2019","author":"Junta de Andalucía","org":"Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},4:function(e,t){e.exports='<div class="m-geosearch-content">\n   {{#each features}}\n   <div id="{{solrid}}" class="result">\n      {{#each attributes}}\n      <table>\n         <tr>\n            <td class="key">{{key}}</td>\n            <td class="value{{#oneword value}} m-wordbreak{{/oneword}}">{{{value}}}</td>\n         </tr>\n      </table>\n      {{/each}}\n   </div>\n   <div class="m-separator"></div>\n   {{/each}}\n</div>'},5:function(e,t){e.exports='<div class="m-control m-geosearch-container">\n  \x3c!-- search panel --\x3e\n  <div class="search-panel">\n    <input type="text" id="m-geosearch-search-input" placeholder="Buscar" class="m-input-search" />\n    <button id="m-geosearch-search-btn" class="g-cartografia-zoom m-search-btn" title="Buscar"></button>\n    <button id="m-geosearch-help-btn" class="g-cartografia-ayuda m-help-btn" title="Ayuda"></button>\n    <button id="m-geosearch-clear-btn" class="g-cartografia-cancelar m-clear-btn" title="Limpiar búsqueda"></button>\n  </div>\n  \x3c!-- results panel --\x3e\n  <div class="results-panel" id="m-geosearch-results">\n    <div id="m-searching-result" class="m-searching-result g-cartografia-spinner"></div>\n  </div>\n</div>'},56:function(e,t,r){},6:function(e,t){e.exports='<div class="m-geosearch-help">\n  {{#eq entities.length 0}}\n    <div class="entity">\n      <p>El servicio no tiene ayuda configurada</p>\n      <button id="m-geosearch-closeHelp-btn" class="g-cartografia-cancelar" title="Cerrar ayuda"></button>\n    </div>\n  {{/eq}}\n  {{#each entities}}\n    <div class="entity">\n      <button id="m-geosearch-closeHelp-btn" class="g-cartografia-cancelar m-clear-btn" title="Cerrar ayuda"></button>\n      <div class="name">{{entity}}</div>\n      <div class="info">{{info}}</div>\n      <ul class="keywords">\n        {{#each keywords}}\n          <li>{{this}}</li>\n        {{/each}}\n      </ul>\n      <div class="example">\n        <code>{{example}}</code>\n      </div>\n    </div>\n  {{/each}}\n</div>'},83:function(e,t,r){"use strict";r.r(t);var n=r(2),o=(r(56),r(21));function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(p,M.Plugin);var t,r,s,c=u(p);function p(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(this,p),(e=c.call(this)).map_=null,e.control_=null,e.panel_=null,e.name=p.NAME,e.url_=M.config.GEOSEARCH_URL,M.utils.isNullOrEmpty(t.url)||(e.url_=t.url),e.core_=M.config.GEOSEARCH_CORE,M.utils.isNullOrEmpty(t.core)||(e.core_=t.core),e.handler_=M.config.GEOSEARCH_HANDLER,M.utils.isNullOrEmpty(t.handler)||(e.handler_=t.handler),e.searchParameters_=t.params||{},e.showHelp_=t.showHelp,e.metadata_=o.metadata,e}return t=p,(r=[{key:"addTo",value:function(e){this.map_=e,e.areasContainer.getElementsByClassName("m-top m-right")[0].classList.add("top-extra"),this.control_=new n.a(this.url_,this.core_,this.handler_,this.searchParameters_,this.showHelp_),this.control_.on(M.evt.ADD_TO_MAP,this.onLoadCallback_,this),this.panel_=new M.ui.Panel("geosearch",{collapsible:!0,className:"m-geosearch",collapsedButtonClass:"g-cartografia-zoom",position:M.ui.position.TL,tooltip:"Geobúsquedas"}),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_)}},{key:"getInput",value:function(){var e=null;return M.utils.isNullOrEmpty(this.control_)||(e=this.control_.getInput()),e}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.url_=null,this.core_=null,this.handler_=null,this.searchParameters_=null}},{key:"getControls",value:function(){var e=[];return e.push(this.control_),e}},{key:"equals",value:function(e){return e instanceof p}},{key:"getAPIRest",value:function(){return"geosearch=".concat(this.url_,"*").concat(this.core_,"*").concat(this.handler_)}},{key:"getMetadata",value:function(){return this.metadata_}}])&&a(t.prototype,r),s&&a(t,s),p}();h.NAME="geosearch",null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.Geosearch=h}});