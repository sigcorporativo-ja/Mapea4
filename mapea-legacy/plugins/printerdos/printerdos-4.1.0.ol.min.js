!function(t){var e={};function i(l){if(e[l])return e[l].exports;var n=e[l]={i:l,l:!1,exports:{}};return t[l].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,l){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:l})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(l,n,function(e){return t[e]}.bind(null,n));return l},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=81)}({39:function(t,e){t.exports='<div class="m-control m-printer-container">\n    \x3c!-- TITLE --\x3e\n    <div class="title">Impresión del mapa</div>\n    \x3c!-- FORM --\x3e\n    <div class="form">\n        \x3c!-- title --\x3e\n        <div class="title">\n            <input type="text" placeholder="Título">\n        </div>\n        \x3c!-- description --\x3e\n        <div class="description">\n            <textarea placeholder="Descripción"></textarea>\n        </div>\n        \x3c!-- layout --\x3e\n        <div class="layout">\n            <label>Plantilla </label>\n            <select>\n                {{#each layouts}}\n                    <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n                {{/each}}\n            </select>\n        </div>\n        \x3c!-- DPI --\x3e\n        <div class="dpi">\n            <label>DPI </label>\n            <select>\n                {{#each dpis}}\n                    <option value="{{value}}" {{#if default}} selected{{/if}}>{{value}}</option>\n                {{/each}}\n            </select>\n        </div>\n        \x3c!-- format --\x3e\n        <div class="format">\n            <label>Formato </label>\n            <select>\n                {{#each format}}\n                    <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n                {{/each}}\n            </select>\n        </div>\n        \x3c!-- force scale --\x3e\n        <div class="forcescale">\n            <label>Forzar escala </label>\n            <input type="checkbox" {{#if forceScale}} checked{{/if}}>\n        </div>\n        \x3c!-- text wrap --\x3e\n        <div class="textwrap">\n            <label>% Ajuste texto</label>\n            <input id=\'inputRange\' type="range" min="0" max="1" step="0.1" value={{textWrap}}>\n            <div id=\'label\'>{{textWrap}}</div>\n        </div>\n    </div>\n    \x3c!-- buttons --\x3e\n    <div class="button">\n        <button class="print"><i class="g-cartografia-impresora"></i> Imprimir</button>\n        <button class="remove"><i class="g-cartografia-papelera"></i> Borrar</button>\n        <button class="cancel"><i class="g-cartografia-cancelar"></i> Cancelar impresión</button>\n    </div>\n    \x3c!-- queue --\x3e\n    <div class="queue">\n        <div class="title">Descargar</div>\n        <ul class="queue-container"></ul>\n    </div>\n    \x3c!-- minimize button --\x3e\n    <div class="minimize" title="Minimizar el control de impresión"></div>\n</div>'},40:function(t){t.exports=JSON.parse('{"url":{"name":"printerdos","separator":"*"},"constructor":"M.plugin.Printer","parameters":[{"type":"object","properties":[{"type":"simple","name":"url","position":0},{"type":"object","name":"params","properties":[{"type":"object","name":"layout","properties":[{"type":"simple","name":"outputFilename","value":"mapea_${yyyy-MM-dd_hhmmss}"}]},{"type":"object","name":"pages","properties":[{"type":"simple","name":"clientLogo","value":"http://www.juntadeandalucia.es/economiayhacienda/images/plantilla/logo_cabecera.gif"},{"type":"simple","name":"creditos","value":"Impresión generada a través de Mapea"}]}]}]},{"type":"object","properties":[{"type":"object","name":"options","properties":[{"type":"simple","name":"legend","value":"true"}]}]}],"files":{"ol":{"scripts":["printerdos-4.1.0.ol.min.js"],"styles":["printerdos-4.1.0.min.css"]}},"metadata":{"name":"Printer","description":"Tool for printing maps.","text":"","version":"4.1.0","date":"11/10/2019","author":"Junta de Andalucía","org":"Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg"}}')},66:function(t,e,i){},81:function(t,e,i){"use strict";function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var l=e[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,l=u(t);if(e){var n=u(this).constructor;i=Reflect.construct(l,arguments,n)}else i=l.apply(this,arguments);return s(this,i)}}function s(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i.r(e);var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(u,M.impl.Control);var e,i,l,s=a(u);function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(this,u),(t=s.call(this)).facadeMap_=null,t.additionalOptsLabel_={},t.labeling_=e.labeling,M.utils.isNullOrEmpty(t.labeling_)?(t.additionalOptsLabel_.conflictResolution="false",t.additionalOptsLabel_.goodnessOfFit=.9):(M.utils.isNullOrEmpty(t.labeling_.allowOverruns)||(t.additionalOptsLabel_.allowOverruns=t.labeling_.allowOverruns),M.utils.isNullOrEmpty(t.labeling_.autoWrap)||(t.additionalOptsLabel_.autoWrap=t.labeling_.autoWrap),M.utils.isNullOrEmpty(t.labeling_.conflictResolution)?t.additionalOptsLabel_.conflictResolution="false":t.additionalOptsLabel_.conflictResolution=t.labeling_.conflictResolution,M.utils.isNullOrEmpty(t.labeling_.followLine)||(t.additionalOptsLabel_.followLine=t.labeling_.followLine),M.utils.isNullOrEmpty(t.labeling_.goodnessOfFit)?t.additionalOptsLabel_.goodnessOfFit=.9:t.additionalOptsLabel_.goodnessOfFit=t.labeling_.goodnessOfFit,M.utils.isNullOrEmpty(t.labeling_.group)||(t.additionalOptsLabel_.group=t.labeling_.group),M.utils.isNullOrEmpty(t.labeling_.maxDisplacement)||(t.additionalOptsLabel_.maxDisplacement=t.labeling_.maxDisplacement),M.utils.isNullOrEmpty(t.labeling_.spaceAround)||(t.additionalOptsLabel_.spaceAround=t.labeling_.spaceAround)),t}return e=u,(i=[{key:"addTo",value:function(t,e){this.facadeMap_=t,ol.control.Control.call(this,{element:e,target:null}),t.getMapImpl().addControl(this)}},{key:"encodeLayer",value:function(t){var e=this;return new Promise((function(i,l){t.type===M.layer.type.WMC||(t.type===M.layer.type.KML?i(e.encodeKML(t)):t.type===M.layer.type.WMS?i(e.encodeWMS(t)):t.type===M.layer.type.WFS||t.type===M.layer.type.GeoJSON?i(e.encodeWFS(t)):t.type===M.layer.type.WMTS?e.encodeWMTS(t).then((function(t){i(t)})):t.type===M.layer.type.MBtiles||(t.type===M.layer.type.OSM?i(e.encodeOSM(t)):t.type===M.layer.type.Mapbox?i(e.encodeMapbox(t)):(M.utils.isNullOrEmpty(t.type)&&M.layer.Vector,i(e.encodeWFS(t)))))}))}},{key:"encodeLegend",value:function(t){var e=null;if(t.displayInLayerSwitcher){e={classes:[]};var i=new RegExp(".*".concat(M.Layer.LEGEND_DEFAULT,"$")),l=new RegExp(".*".concat(M.Layer.LEGEND_ERROR,"$")),n=t.getLegendURL();M.utils.isNullOrEmpty(n)||i.test(n)||l.test(n)||(e.classes[0]={name:t.name,icons:[t.getLegendURL()]},t instanceof M.layer.Vector&&delete e.classes[0].icons)}return e}},{key:"encodeKML",value:function(t){var e=this,i=t.getImpl().getOL3Layer(),l=i.getSource().getFeatures(),n=t.name,r=i.getOpacity(),o=new ol.format.GeoJSON,a=this.facadeMap_.getBbox();a=[a.x.min,a.y.min,a.x.max,a.y.max];var s,u,c=this.facadeMap_.getMapImpl().getView().getResolution(),p=[],y=1,f=1,g="",m={},d={},O=1;return l.forEach((function(t){var i=t.getGeometry(),l=t.get("styleUrl");M.utils.isNullOrEmpty(l)||(l=l.replace("#",""));var n=t.getStyle();if(!M.utils.isNullOrEmpty(n)){var r;try{r=n(t,c),Array.isArray(r)&&(r=r[0])}catch(e){r=n.call(t,c)[0]}if(!M.utils.isNullOrEmpty(r)){var h,v=r.getImage(),b=v.getImageSize();M.utils.isNullOrEmpty(b)&&(b=[64,64]),h="multipolygon"===t.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===t.getGeometry().getType().toLowerCase()?"point":t.getGeometry().getType().toLowerCase();var _,E=r.getStroke(),S={type:h,id:l,externalGraphic:v.getSrc(),graphicHeight:b[0],graphicWidth:b[1],graphicOpacity:v.getOpacity(),strokeWidth:E?E.getWidth():1},x=r.getText&&r.getText();if(M.utils.isNullOrEmpty(x)||((_={type:"text",label:M.utils.isNullOrEmpty(x.getText())?t.get("name"):x.getText(),fontColor:M.utils.isNullOrEmpty(x.getFill())?"":M.utils.rgbToHex(M.utils.isArray(x.getFill().getColor())?"rgba(".concat(x.getFill().getColor().toString(),")"):x.getFill().getColor()),fontSize:"11px",fontFamily:"Helvetica, sans-serif",fontWeight:"bold",conflictResolution:e.additionalOptsLabel_.conflictResolution,labelAlign:x.getTextAlign(),labelXOffset:x.getOffsetX(),labelYOffset:x.getOffsetY(),labelOutlineColor:M.utils.isNullOrEmpty(x.getStroke())?"":M.utils.rgbToHex(M.utils.isArray(x.getStroke().getColor())?"rgba(".concat(x.getStroke().getColor().toString(),")"):x.getStroke().getColor()),labelOutlineWidth:M.utils.isNullOrEmpty(x.getStroke())?"":x.getStroke().getWidth()}).fontColor=_.fontColor.slice(0,7),_.labelOutlineColor=_.labelOutlineColor.slice(0,7),_=e.addAdditionalLabelOptions(_)),s="draw".concat(O),!M.utils.isNullOrEmpty(i)&&i.intersectsExtent(a)||!M.utils.isNullOrEmpty(x)){var N=JSON.stringify(S),L=JSON.stringify(_),T=m[N],C=d[L];if(M.utils.isUndefined(T)||M.utils.isUndefined(C)){var P=[],w=0;if(!M.utils.isNullOrEmpty(i)&&i.intersectsExtent(a)&&M.utils.isUndefined(T)&&(T=f,m[N]=T,w=1,P.push(N),f+=1,O+=1),!M.utils.isNullOrEmpty(x)&&M.utils.isUndefined(C)&&(C=y,d[L]=C,P.push(L),y+=1,0===w&&(O+=1,P.push(N))),void 0===T&&(T=0),void 0===C&&(C=0),u="\"[_gx_style ='".concat(T+C,"']\""),!M.utils.isNullOrEmpty(P)){var R=" ".concat(u,':{"symbolizers": [').concat(P,"]}");g+=""!==g?",".concat(R):"{".concat(R,',"version":"2"')}}var F=o.writeFeatureObject(t);F.properties={_gx_style:T+C,name:s},p.push(F)}}}}),this),{type:"Vector",style:g=""!==g?JSON.parse(g.concat("}")):{"*":{symbolizers:[]},version:"2"},styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:p},name:n,opacity:r}}},{key:"encodeWMS",value:function(t){var e=null,i=t.getImpl().getOL3Layer(),l=t.url,n=i.getOpacity(),r=i.getSource().getParams(),o=[r.LAYERS],a=r.FORMAT,s=[r.STYLES];if(e={baseURL:l,opacity:n,type:"WMS",layers:o.join(",").split(","),format:a||"image/jpeg",styles:s.join(",").split(",")},t._updateNoCache){t._updateNoCache();var u=t.getNoCacheName(),c=t.getNoCacheUrl();M.utils.isNullOrEmpty(u)||M.utils.isNullOrEmpty(c)||(e.layers=[u],e.baseURL=c)}else{var p=t.getNoChacheName(),y=t.getNoChacheUrl();M.utils.isNullOrEmpty(p)||M.utils.isNullOrEmpty(y)||(e.layers=[p],e.baseURL=y)}return e.customParams={},Object.keys(r).forEach((function(t){-1!=="iswmc,transparent".indexOf(t.toLowerCase())&&(e.customParams[t]=r[t])})),e}},{key:"encodeWFS",value:function(t){var e=this,i=null,l=!0;if((t.getStyle()instanceof M.style.Chart||t.getStyle()instanceof M.style.Cluster&&t.getStyle().getOldStyle()instanceof M.style.Chart)&&(l=!1),l){var n=this.facadeMap_.getProjection(),r=t.getImpl().getOL3Layer(),o=null;o=t.type===M.layer.type.MVT?t.getFeatures():r.getSource().getFeatures();var a=t.name,s=r.getOpacity(),u=r.getStyle(),c=new ol.format.GeoJSON,p=this.facadeMap_.getBbox();p=[p.x.min,p.y.min,p.x.max,p.y.max];var y,f,g=this.facadeMap_.getMapImpl().getView().getResolution(),m=[],d=1,O=1,h=1,v="",b={},_={};o.forEach((function(i){var l,r=i.getGeometry(),o=i.getStyle();M.utils.isNullOrEmpty(o)?M.utils.isNullOrEmpty(u)||(l=u):l=o,l instanceof Function&&(l=l.call(l,i,g));var a=null;if(l instanceof Array&&(l.length>1?(a=M.utils.isNullOrEmpty(l[1])||M.utils.isNullOrEmpty(l[1].getImage())||!l[1].getImage().getGlyph?null:l[1].getImage(),l=!M.utils.isNullOrEmpty(l[1].getImage())&&l[1].getImage().getSrc?l[1]:l[0]):l=l[0]),!M.utils.isNullOrEmpty(l)){var s,E=l.getImage(),S=M.utils.isNullOrEmpty(E)?[0,0]:E.getImageSize()||[24,24],x=l.getText();M.utils.isNullOrEmpty(x)&&!M.utils.isNullOrEmpty(l.textPath)&&(x=l.textPath),s="multipolygon"===i.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===i.getGeometry().getType().toLowerCase()?"point":"multilinestring"===i.getGeometry().getType().toLowerCase()?"line":i.getGeometry().getType().toLowerCase();var N,L=M.utils.isNullOrEmpty(E)?l.getStroke():E.getStroke&&E.getStroke(),T=M.utils.isNullOrEmpty(E)?l.getFill():E.getFill&&E.getFill(),C=M.utils.isNullOrEmpty(E)?"":E.getRadius&&E.getRadius(),P={type:s,fillColor:M.utils.isNullOrEmpty(T)?"#000000":M.utils.rgbaToHex(T.getColor()).slice(0,7),fillOpacity:M.utils.isNullOrEmpty(T)?0:M.utils.getOpacityFromRgba(T.getColor()),strokeColor:M.utils.isNullOrEmpty(L)?"#000000":M.utils.rgbaToHex(L.getColor()),strokeOpacity:M.utils.isNullOrEmpty(L)?0:M.utils.getOpacityFromRgba(L.getColor()),strokeWidth:M.utils.isNullOrEmpty(L)?0:L.getWidth&&L.getWidth(),pointRadius:M.utils.isNullOrEmpty(E)?"":E.getRadius&&E.getRadius(),externalGraphic:M.utils.isNullOrEmpty(E)?"":E.getSrc&&E.getSrc(),graphicHeight:S[0],graphicWidth:S[1]};Number.isNaN(C)&&(P.fillOpacity=0,P.strokeOpacity=0,P.pointRadius=0);var w=!M.utils.isNullOrEmpty(a)&&a.getImage?a.getImage():null;if(M.utils.isNullOrEmpty(w)||(a.getRadius&&a.getRadius()&&(P.pointRadius=a.getRadius&&a.getRadius()),a.getOpacity&&a.getOpacity()&&(P.graphicOpacity=a.getOpacity()),P.externalGraphic=w.toDataURL()),!M.utils.isNullOrEmpty(x)){var R=x.getTextAlign(),F=x.getTextBaseline(),k="";M.utils.isNullOrEmpty(R)||(R=R===M.style.align.LEFT?"l":R===M.style.align.RIGHT?"r":R===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(F)||(F=F===M.style.baseline.BOTTOM?"b":F===M.style.baseline.MIDDLE?"m":F===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(R)||M.utils.isNullOrEmpty(F)||(k=R.concat(F));var A=x.getFont(),I=!M.utils.isNullOrEmpty(A)&&A.indexOf("bold")>-1?"bold":"normal",j="11px";if(!M.utils.isNullOrEmpty(A)){var D=A.substr(0,A.indexOf("px"));if(!M.utils.isNullOrEmpty(D)){var W=D.lastIndexOf(" ");j=W>-1?D.substr(W,D.length).trim().concat("px"):D.concat("px")}}N={type:"text",label:x.getText()||"",fontColor:M.utils.isNullOrEmpty(x.getFill())?"#000000":M.utils.rgbToHex(x.getFill().getColor()),fontSize:j,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:I,conflictResolution:e.additionalOptsLabel_.conflictResolution,labelXOffset:x.getOffsetX(),labelYOffset:x.getOffsetY(),fillColor:P.fillColor||"#FF0000",fillOpacity:P.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(x.getStroke())?"":M.utils.rgbToHex(x.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(x.getStroke())?"":x.getStroke().getWidth(),labelAlign:k},N=e.addAdditionalLabelOptions(N)}if(y="draw".concat(d),!M.utils.isNullOrEmpty(r)&&r.intersectsExtent(p)||!M.utils.isNullOrEmpty(x)){var G,U=JSON.stringify(P),q=JSON.stringify(N),H=b[U],z=_[q];if(M.utils.isUndefined(H)||M.utils.isUndefined(z)){var J=[],B=0;if(!M.utils.isNullOrEmpty(r)&&r.intersectsExtent(p)&&M.utils.isUndefined(H)&&(H=h,b[U]=H,B=1,J.push(U),h+=1,d+=1),!M.utils.isNullOrEmpty(x)&&M.utils.isUndefined(z)&&(z=O,_[q]=z,J.push(q),O+=1,0===B&&(d+=1,J.push(U))),void 0===H&&(H=0),void 0===z&&(z=0),f="\"[_gx_style ='".concat(H+z,"']\""),!M.utils.isNullOrEmpty(J)){var V=" ".concat(f,':{"symbolizers": [').concat(J,"]}");if(t.getStyle()instanceof M.style.Proportional){var X=i.getGeometry().getType().toLocaleLowerCase();X.indexOf("polygon")>=0?V=V.replace("polygon","point"):X.indexOf("line")>=0&&(V=V.replace("line","point"))}V=V.replace("linestring","line"),v+=""!==v?",".concat(V):"{".concat(V,',"version":"2"')}}(G="EPSG:3857"!==n.code&&e.facadeMap_.getLayers().some((function(t){return t.type===M.layer.type.OSM||t.type===M.layer.type.Mapbox}))?c.writeFeatureObject(i,{featureProjection:n.code,dataProjection:"EPSG:3857"}):c.writeFeatureObject(i)).properties={_gx_style:H+z,name:y},m.push(G)}}}),this),i={type:"Vector",style:v=""!==v?JSON.parse(v.concat("}")):{"*":{symbolizers:[]},version:"2"},styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:m},name:a,opacity:s}}return i}},{key:"encodeMVT",value:function(t){var e=this,i=null,l=!0;if((t.getStyle()instanceof M.style.Chart||t.getStyle()instanceof M.style.Cluster&&t.getStyle().getOldStyle()instanceof M.style.Chart)&&(l=!1),l){var n=this.facadeMap_.getProjection(),r=t.getImpl().getOL3Layer(),o=t.getFeatures(),a=t.name,s=r.getOpacity(),u=r.getStyle(),c=new ol.format.GeoJSON,p=this.facadeMap_.getBbox();p=[p.x.min,p.y.min,p.x.max,p.y.max];var y,f,g=this.facadeMap_.getMapImpl().getView().getResolution(),m=[],d=1,O=1,h=1,v="",b={},_={};o.forEach((function(t){var i,l=t.getGeometry(),r=t.getStyle();if(M.utils.isNullOrEmpty(r)?M.utils.isNullOrEmpty(u)||(i=u):i=r,i instanceof Function&&(i=i.call(i,t,g)),i instanceof Array&&(i=i.length>1&&!M.utils.isNullOrEmpty(i[1].getImage())&&i[1].getImage().getSrc?i[1]:i[0]),!M.utils.isNullOrEmpty(i)){var o,a=i.getImage(),s=M.utils.isNullOrEmpty(a)?[0,0]:a.getImageSize()||[24,24],E=i.getText();M.utils.isNullOrEmpty(E)&&!M.utils.isNullOrEmpty(i.textPath)&&(E=i.textPath),o="multipolygon"===t.getGeometry().getType().toLowerCase()?"polygon":"multipoint"===t.getGeometry().getType().toLowerCase()?"point":"multilinestring"===t.getGeometry().getType().toLowerCase()?"line":t.getGeometry().getType().toLowerCase();var S,x=M.utils.isNullOrEmpty(a)?i.getStroke():a.getStroke&&a.getStroke(),N=M.utils.isNullOrEmpty(a)?i.getFill():a.getFill&&a.getFill(),L={type:o,fillColor:M.utils.isNullOrEmpty(N)?"#000000":M.utils.rgbaToHex(N.getColor()).slice(0,7),fillOpacity:M.utils.isNullOrEmpty(N)?0:M.utils.getOpacityFromRgba(N.getColor()),strokeColor:M.utils.isNullOrEmpty(x)?"#000000":M.utils.rgbaToHex(x.getColor()),strokeOpacity:M.utils.isNullOrEmpty(x)?0:M.utils.getOpacityFromRgba(x.getColor()),strokeWidth:M.utils.isNullOrEmpty(x)?0:x.getWidth&&x.getWidth(),pointRadius:M.utils.isNullOrEmpty(a)?"":a.getRadius&&a.getRadius(),externalGraphic:M.utils.isNullOrEmpty(a)?"":a.getSrc&&a.getSrc(),graphicHeight:s[0],graphicWidth:s[1]};if(!M.utils.isNullOrEmpty(E)){var T=E.getTextAlign(),C=E.getTextBaseline(),P="";M.utils.isNullOrEmpty(T)||(T=T===M.style.align.LEFT?"l":T===M.style.align.RIGHT?"r":T===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(C)||(C=C===M.style.baseline.BOTTOM?"b":C===M.style.baseline.MIDDLE?"m":C===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(T)||M.utils.isNullOrEmpty(C)||(P=T.concat(C));var w=E.getFont(),R=!M.utils.isNullOrEmpty(w)&&w.indexOf("bold")>-1?"bold":"normal",F="11px";if(!M.utils.isNullOrEmpty(w)){var k=w.substr(0,w.indexOf("px"));if(!M.utils.isNullOrEmpty(k)){var A=k.lastIndexOf(" ");F=A>-1?k.substr(A,k.length).trim().concat("px"):k.concat("px")}}S={type:"text",label:E.getText()||"",fontColor:M.utils.isNullOrEmpty(E.getFill())?"#000000":M.utils.rgbToHex(E.getFill().getColor()),fontSize:F,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:R,conflictResolution:e.additionalOptsLabel_.conflictResolution,labelXOffset:E.getOffsetX(),labelYOffset:E.getOffsetY(),fillColor:L.fillColor||"#FF0000",fillOpacity:L.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(E.getStroke())?"":M.utils.rgbToHex(E.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(E.getStroke())?"":E.getStroke().getWidth(),labelAlign:P},S=e.addAdditionalLabelOptions(S)}if(y="draw".concat(d),!M.utils.isNullOrEmpty(l)&&l.intersectsExtent(p)||!M.utils.isNullOrEmpty(E)){var I,j=JSON.stringify(L),D=JSON.stringify(S),W=b[j],G=_[D];if(M.utils.isUndefined(W)||M.utils.isUndefined(G)){var U=[],q=0;if(!M.utils.isNullOrEmpty(l)&&l.intersectsExtent(p)&&M.utils.isUndefined(W)&&(W=h,b[j]=W,q=1,U.push(j),h+=1,d+=1),!M.utils.isNullOrEmpty(E)&&M.utils.isUndefined(G)&&(G=O,_[D]=G,U.push(D),O+=1,0===q&&(d+=1,U.push(j))),void 0===W&&(W=0),void 0===G&&(G=0),f="\"[_gx_style ='".concat(W+G,"']\""),!M.utils.isNullOrEmpty(U)){var H=" ".concat(f,':{"symbolizers": [').concat(U,"]}");v+=""!==v?",".concat(H):"{".concat(H,',"version":"2"')}}(I="EPSG:3857"!==n.code&&e.facadeMap_.getLayers().some((function(t){return t.type===M.layer.type.OSM||t.type===M.layer.type.Mapbox}))?c.writeFeatureObject(t,{featureProjection:n.code,dataProjection:"EPSG:3857"}):c.writeFeatureObject(t)).properties={_gx_style:W+G,name:y},m.push(I)}}}),this),i={type:"Vector",style:v=""!==v?JSON.parse(v.concat("}")):{"*":{symbolizers:[]},version:"2"},styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:m},name:a,opacity:s}}return i}},{key:"encodeWMTS",value:function(t){var e=this.facadeMap_.getZoom(),i=t.getImpl(),l=i.getOL3Layer(),n=l.getSource(),r=n.getTileGrid(),o=M.utils.isNullOrEmpty(n.getStyle)?"default":n.getStyle(),a=t.url,s=t.name,u=l.getOpacity(),c=n.getRequestEncoding(),p=i.tiled,y=l.getExtent(),f={},g=n.getMatrixSet(),m=r.getTileSize(e),d=r.getResolutions();return t.getImpl().getCapabilities().then((function(t){var e=t.Contents.TileMatrixSet.filter((function(t){return t.Identifier===g}))[0];return{baseURL:a,opacity:u,singleTile:!p,type:"WMTS",layer:s,requestEncoding:c,tileSize:m,style:M.utils.isNullOrEmpty(o)?"default":o,rotation:0,imageFormat:"image/png",dimensionParams:{},dimensions:[],params:f,version:"1.0.0",maxExtent:y,matrixSet:g,matrices:e.TileMatrix.map((function(t,e){return{identifier:t.Identifier,matrixSize:[t.MatrixHeight,t.MatrixWidth],scaleDenominator:t.ScaleDenominator,tileSize:[t.TileWidth,t.TileHeight],topLeftCorner:t.TopLeftCorner}})),resolutions:d}}))}},{key:"encodeOSM",value:function(t){var e=t.getImpl(),i=e.getOL3Layer(),l=i.getSource().getTileGrid(),n=t.url||"http://tile.openstreetmap.org/",r=t.name,o=i.getOpacity(),a=e.tiled,s=l.getExtent(),u=l.getTileSize();return{baseURL:n,opacity:o,singleTile:!a,layer:r,maxExtent:s,tileSize:[u,u],resolutions:l.getResolutions(),type:"OSM",imageExtension:"png"}}},{key:"encodeMapbox",value:function(t){var e=t.getImpl().getOL3Layer(),i=e.getSource().getTileGrid(),l=M.utils.concatUrlPaths([M.config.MAPBOX_URL,t.name]),n=e.getOpacity(),r=i.getExtent(),o=i.getTileSize(),a=i.getResolutions(),s={};return s[M.config.MAPBOX_TOKEN_NAME]=M.config.MAPBOX_TOKEN_VALUE,{opacity:n,baseURL:l,customParams:s,maxExtent:r,tileSize:[o,o],resolutions:a,extension:M.config.MAPBOX_EXTENSION,type:"osm",path_format:"/${z}/${x}/${y}.png"}}},{key:"transformExt",value:function(t,e,i){return ol.proj.transformExtent(t,e,i)}},{key:"addAdditionalLabelOptions",value:function(t){var e=t;return M.utils.isNullOrEmpty(this.additionalOptsLabel_.allowOverruns)||(e.allowOverruns=this.additionalOptsLabel_.allowOverruns),M.utils.isNullOrEmpty(this.additionalOptsLabel_.autoWrap)||(e.autoWrap=this.additionalOptsLabel_.autoWrap),M.utils.isNullOrEmpty(this.additionalOptsLabel_.followLine)||(e.followLine=this.additionalOptsLabel_.followLine),M.utils.isNullOrEmpty(this.additionalOptsLabel_.goodnessOfFit)||(e.goodnessOfFit=this.additionalOptsLabel_.goodnessOfFit),M.utils.isNullOrEmpty(this.additionalOptsLabel_.group)||(e.group=this.additionalOptsLabel_.group),M.utils.isNullOrEmpty(this.additionalOptsLabel_.maxDisplacement)||(e.maxDisplacement=this.additionalOptsLabel_.maxDisplacement),M.utils.isNullOrEmpty(this.additionalOptsLabel_.spaceAround)||(e.spaceAround=this.additionalOptsLabel_.spaceAround),e}},{key:"setGoodnessOfFit",value:function(t){this.additionalOptsLabel_.goodnessOfFit=t}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&r(e.prototype,i),l&&r(e,l),u}(),p=i(39),y=i.n(p);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var i=0;i<e.length;i++){var l=e[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,l=h(t);if(e){var n=h(this).constructor;i=Reflect.construct(l,arguments,n)}else i=l.apply(this,arguments);return O(this,i)}}function O(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v="No se ha podido conectar con el servicio de impresión",b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(r,M.Control);var e,i,l,n=d(r);function r(t,e,i){var l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var o=new c(i);return l=n.call(this,o,r.NAME),M.utils.isUndefined(c)&&M.exception("La implementación usada no puede crear controles Printer"),M.utils.isUndefined(c.prototype.encodeLayer)&&M.exception("La implementación usada no posee el método encodeLayer"),M.utils.isUndefined(c.prototype.encodeLegend)&&M.exception("La implementación usada no posee el método encodeLegend"),l.url_=t,l.ref_=null,l.printing_=!1,l.inputTitle_=null,l.areaDescription_=null,l.layout_=null,l.format_=null,l.dpi_=null,l.forceScale_=null,l.textWrap_=null,l.params_=e||{},l.queueContainer_=null,l.capabilitiesPromise_=null,l.connectionTimeout_=i.connectionTimeout||15,l.loadingService=!0,l.errorService=!1,l.outputFormats_=Array.isArray(i.outputFormats)?i.outputFormats:["pdf","png","jpg"],l.options_=i||{},M.utils.isNullOrEmpty(l.options_.layout)&&(l.options_.layout=M.config.geoprint.TEMPLATE),M.utils.isNullOrEmpty(l.options_.dpi)&&(l.options_.dpi=M.config.geoprint.DPI),M.utils.isNullOrEmpty(l.options_.format)&&(l.options_.format=M.config.geoprint.FORMAT),M.utils.isNullOrEmpty(l.options_.forceScale)&&(l.options_.forceScale=M.config.geoprint.FORCE_SCALE),M.utils.isNullOrEmpty(l.options_.legend)&&(l.options_.legend=M.config.geoprint.LEGEND),M.utils.isNullOrEmpty(l.options_.labeling)?l.options_.labeling={goodnessOfFit:.9}:M.utils.isNullOrEmpty(l.options_.labeling.goodnessOfFit)&&(l.options_.labeling.goodnessOfFit=.9),l}return e=r,(i=[{key:"getStatus",value:function(t,e){var i=this;M.remote.get(t).then((function(l){var n=JSON.parse(l.text).status;"finished"===n?e():"error"===n?(e(),M.dialog.error("Se ha producido un error en la impresión")):!1===i.printing_?(M.dialog.error("Se ha cancelado la impresión"),i.queueContainer_.lastChild.remove()):setTimeout((function(){return i.getStatus(t,e)}),1e3)}))}},{key:"open",value:function(){if(this.loadingService)M.dialog.error("El servicio aún no ha cargado","Servicio cargando");else if(this.errorService)M.dialog.error(v,"Error de conexión");else{var t=this.getPanel().getTemplatePanel(),e=this.getPanel().getButtonPanel();t.classList.remove("collapsed"),e.classList.remove("g-cartografia-impresora"),t.classList.add("opened"),e.classList.add("g-cartografia-flecha-derecha"),this.getPanel().setCollapsed(!1),this.getPanel().fire(M.evt.SHOW)}}},{key:"createView",value:function(t){var e=this;return this.getPanel().open=this.open.bind(this),new Promise((function(t,i){e.getCapabilities().then((function(i){var l,n,r=i,o=0;for(r.layouts=r.layouts.filter((function(t){return!t.name.endsWith("jpg")})),o=0,l=r.layouts.length;o<l;o+=1){var a=r.layouts[o];if(a.name===e.options_.layout){a.default=!0;break}}for(r.dpis=[],o=0,l=r.layouts[0].attributes.length;o<l;o+=1)null!=r.layouts[0].attributes[o].clientInfo&&(n=r.layouts[0].attributes[o]);for(o=0,l=n.clientInfo.dpiSuggestions.length;o<l;o+=1){var s=n.clientInfo.dpiSuggestions[o],u={value:s};s===e.options_.dpi&&(u.default=!0),r.dpis.push(u)}Array.isArray(r.formats)&&(e.outputFormats_=r.formats),r.format=e.outputFormats_.map((function(t){var i={name:t};return t===e.options_.format&&(i.default=!0),i})),M.template.compileSync||(M.template.compileSync=function(t,e){var i,l={};M.utils.isUndefined(e)||(l=M.utils.extends(l,e.vars),i=e.parseToHtml);var n=Handlebars.compile(t)(l);return!1!==i?M.utils.stringToHtml(n):n}),r.forceScale=e.options_.forceScale,r.textWrap=e.options_.labeling.goodnessOfFit;var c=M.template.compileSync(y.a,{jsonp:!0,vars:r});e.addEvents(c),e.loadingService=!1,t(c)})).catch((function(t){e.loadingService=!1,e.errorService=!0,M.dialog.error(v,"Error de conexión")}))}))}},{key:"addEvents",value:function(t){var e=this;this.element_=t,this.inputTitle_=this.element_.querySelector(".form div.title > input"),this.areaDescription_=this.element_.querySelector(".form div.description > textarea");var i=this.element_.querySelector(".form div.layout > select");i.addEventListener("change",(function(t){var l=i.value;e.setLayout({value:l,name:l})}));var l=i.value;this.setLayout({value:l,name:l});var n=this.element_.querySelector(".form div.dpi > select");n.addEventListener("change",(function(t){var i=n.value;e.setDpi({value:i,name:i})}));var r=n.value;this.setDpi({value:r,name:r});var o=this.element_.querySelector(".form div.format > select");o.addEventListener("change",(function(t){e.setFormat(o.value)})),this.setFormat(o.value);var a=this.element_.querySelector(".form div.forcescale > input");a.addEventListener("click",(function(t){e.setForceScale(!0===a.checked)})),this.setForceScale(!0===a.checked);var s=this.element_.querySelector(".form div.textwrap > input");s.addEventListener("change",(function(t){e.setTextWrap(parseFloat(s.value))})),this.element_.querySelector(".button > button.print").addEventListener("click",this.printClick_.bind(this)),this.element_.querySelector(".button > button.cancel").addEventListener("click",this.cancelClick_.bind(this)),this.element_.querySelector(".button > button.remove").addEventListener("click",(function(t){t.preventDefault(),e.inputTitle_.value="",e.areaDescription_.value="",i.value=e.options_.layout,n.value=e.options_.dpi,o.value=e.options_.format,a.checked=e.options_.forceScale,s.value=e.options_.labeling.textWrap;var l=document.createEvent("HTMLEvents");l.initEvent("change");var r=document.createEvent("HTMLEvents");r.initEvent("click"),i.dispatchEvent(l),n.dispatchEvent(l),o.dispatchEvent(l),a.dispatchEvent(r),s.dispatchEvent(l),Array.prototype.forEach.apply(e.queueContainer_.children,[function(t){t.removeEventListener("click",e.dowloadPrint)},e]),e.queueContainer_.innerHTML=""})),this.queueContainer_=this.element_.querySelector(".queue > ul.queue-container"),M.utils.enableTouchScroll(this.queueContainer_)}},{key:"setLayout",value:function(t){this.layout_=t}},{key:"setFormat",value:function(t){this.format_=t}},{key:"setDpi",value:function(t){this.dpi_=t}},{key:"setForceScale",value:function(t){this.forceScale_=t}},{key:"setTextWrap",value:function(t){this.textwrap_=t,this.getImpl().setGoodnessOfFit(t);var e=this.getPanel().getTemplatePanel(),i=e.querySelector("#label"),l=e.querySelector("#inputRange");i.innerHTML=l.value}},{key:"printClick_",value:function(t){var e=this;t.preventDefault(),this.getPrintData().then((function(t){var i=M.utils.concatUrlPaths([e.url_,"report.".concat(t.outputFormat)]),l=e.createQueueElement();e.queueContainer_.appendChild(l),l.classList.add(r.LOADING_CLASS),i=M.utils.addParameters(i,"mapeaop=geoprint"),M.remote.post(i,t).then((function(t){var i=t,n=JSON.parse(i.text);e.ref_=n.ref;var o=M.utils.concatUrlPaths([e.params_.urlApplication,"print/status","".concat(e.ref_,".json")]);if(e.printing_=!0,e.getStatus(o,(function(){return l.classList.remove(r.LOADING_CLASS)})),200===i.code){var a;try{var s=(i=JSON.parse(i.text)).downloadURL.split("@")[1],u=i.downloadURL.substring(i.downloadURL.indexOf("/print"),i.downloadURL.length);a=M.utils.concatUrlPaths([e.params_.urlApplication,"".concat(u,";GEOPRID=.").concat(s)])}catch(t){M.exception(t)}l.setAttribute(r.DOWNLOAD_ATTR_NAME,a),l.addEventListener("click",e.dowloadPrint)}else M.dialog.error("Se ha producido un error en la impresión")}))}))}},{key:"cancelClick_",value:function(t){t.preventDefault(),this.printing_=!1}},{key:"getCapabilities",value:function(){var t=this;return M.utils.isNullOrEmpty(this.capabilitiesPromise_)&&(this.capabilitiesPromise_=new Promise((function(e,i){setTimeout((function(){var t=new Error("CONNECTION TIMEOUT");i(t)}),1e3*t.connectionTimeout_);var l=M.utils.concatUrlPaths([t.url_,"capabilities.json"]);M.remote.get(l).then((function(t){var i={};try{i=JSON.parse(t.text)}catch(t){M.exception(t)}e(i)}))}))),this.capabilitiesPromise_}},{key:"getPrintData",value:function(){var t=this,e=this.inputTitle_.value,i=this.areaDescription_.value,l=this.map_.getProjection().code,n=this.layout_.name,r=this.dpi_.value,o=this.format_,a=this.map_.getCenter(),s=this.params_.parameters,u=this.options_.legend;"jpg"===o&&(n+=" jpg");var c=M.utils.extend({layout:n,outputFormat:o,attributes:{title:e,description:i,epsg:l,map:{useAdjustBounds:!0,projection:l,dpi:r}}},this.params_.layout);return this.encodeLayers().then((function(e){if(c.attributes.map.layers=e,c.attributes=Object.assign(c.attributes,s),u){for(var i=[],n=t.encodeLegends(),r=0,o=n.length;r<o;r+=1)if(!M.utils.isNullOrEmpty(n[r].classes[0])){var p={name:n[r].classes[0].name,icons:n[r].classes[0].icons};i.push(p)}c.attributes.legend={classes:i}}if("EPSG:3857"!==l&&t.map_.getLayers().some((function(t){return t.type===M.layer.type.OSM||t.type===M.layer.type.Mapbox}))&&(c.attributes.map.projection="EPSG:3857"),!1===t.forceScale_){var y=t.map_.getBbox();c.attributes.map.bbox=[y.x.min,y.y.min,y.x.max,y.y.max],"EPSG:3857"!==l&&t.map_.getLayers().some((function(t){return t.type===M.layer.type.OSM||t.type===M.layer.type.Mapbox}))&&(c.attributes.map.bbox=t.getImpl().transformExt(c.attributes.map.bbox,l,"EPSG:3857"))}else!0===t.forceScale_&&(c.attributes.map.center=[a.x,a.y],c.attributes.map.scale=t.map_.getScale());return c}))}},{key:"encodeLayers",value:function(){var t=this,e=this.map_.getLayers().filter((function(t){return!0===t.isVisible()&&!0===t.inRange()&&M.utils.isString(t.name)&&!t.name.startsWith("cluster_cover")})),i=e.length;return new Promise((function(l,n){var r=[],o=[];e.forEach((function(e){t.getImpl().encodeLayer(e).then((function(n){if(M.utils.isNullOrEmpty(n)||"Vector"===n.type){var a=t.map_.getMapImpl().getView().getResolution(),s=e.getImpl().getOL3Layer().getMaxResolution();a>=e.getImpl().getOL3Layer().getMinResolution()&&a<=s&&o.push(n)}else r.push(n);0==(i-=1)&&(r=r.concat(o),l(r.reverse()))}))}))}))}},{key:"encodeLegends",value:function(){var t=this,e=[];return this.map_.getLayers().forEach((function(i){if(!0===i.isVisible()&&!0===i.inRange()){var l=t.getImpl().encodeLegend(i);null!==l&&e.push(l)}}),this),e}},{key:"createQueueElement",value:function(){var t=document.createElement("li"),e=this.inputTitle_.value;return M.utils.isNullOrEmpty(e)&&(e=r.NO_TITLE),t.innerHTML=e,t}},{key:"dowloadPrint",value:function(t){t.preventDefault();var e=this.getAttribute(r.DOWNLOAD_ATTR_NAME);M.utils.isNullOrEmpty(e)||window.open(e,"_blank")}},{key:"equals",value:function(t){var e=!1;return t instanceof r&&(e=this.name===t.name),e}}])&&g(e.prototype,i),l&&g(e,l),r}();b.NAME="printercontrol",b.TEMPLATE="printer.html",b.LOADING_CLASS="printing",b.DOWNLOAD_ATTR_NAME="data-donwload-url-print",b.NO_TITLE="(Sin título)";i(66);var _=i(40);function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var i=0;i<e.length;i++){var l=e[i];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,l=C(t);if(e){var n=C(this).constructor;i=Reflect.construct(l,arguments,n)}else i=l.apply(this,arguments);return T(this,i)}}function T(t,e){return!e||"object"!==E(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(r,M.Plugin);var e,i,l,n=L(r);function r(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return S(this,r),(t=n.call(this,null)).map_=null,t.control_=null,t.panel_=null,t.name=r.NAME,M.utils.isUndefined(M.config.geoprint2)&&M.config("geoprint2",{URL:"https://geoprint-sigc.juntadeandalucia.es/geoprint3/print/SIGC",URL_APPLICATION:"https://geoprint-sigc.juntadeandalucia.es/geoprint3"}),t.url_=M.config.geoprint2.URL,M.utils.isNullOrEmpty(e.url)||(t.url_=e.url),t.params_={urlApplication:M.config.geoprint2.URL_APPLICATION,layout:{outputFilename:"mapea_${yyyy-MM-dd_hhmmss}"}},M.utils.isNullOrEmpty(e.params)||(t.params_=e.params,M.utils.isNullOrEmpty(t.params_.urlApplication)&&(t.params_.urlApplication=M.config.geoprint2.URL_APPLICATION),M.utils.isNullOrEmpty(t.params_.layout)&&(t.params_.layout={outputFilename:"mapea_${yyyy-MM-dd_hhmmss}"})),t.options_={},M.utils.isNullOrEmpty(e.options)||(t.options_=e.options),t.metadata_=_.metadata,t}return e=r,(i=[{key:"addTo",value:function(t){var e=this;this.map_=t,this.control_=new b(this.url_,this.params_,this.options_),this.panel_=new M.ui.Panel("printer",{collapsible:!0,className:"m-printer",collapsedButtonClass:"g-cartografia-impresora",position:M.ui.position.TR,tooltip:"Impresión del mapa"}),this.panel_.on(M.evt.ADDED_TO_MAP,(function(t){M.utils.enableTouchScroll(t)})),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_),this.control_.on(M.evt.ADDED_TO_MAP,(function(){e.fire(M.evt.ADDED_TO_MAP)}))}},{key:"getControls",value:function(){var t=[];return t.push(this.control_),t}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.url_=null,this.params_=null,this.options_=null,this.name=null}},{key:"equals",value:function(t){return t instanceof r}},{key:"getAPIRest",value:function(){return"printer=".concat(this.url_)}},{key:"getMetadata",value:function(){return this.metadata_}}])&&x(e.prototype,i),l&&x(e,l),r}();P.NAME="printer",null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.Printer=P}});