!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=82)}({10:function(e,t){e.exports='<div class="m-control m-searchstreet-container">\n   <span id="codIne"></span>\n   \x3c!-- search panel --\x3e\n   <div class="search-panel">\n      <input type="text" id="m-searchstreet-search-input" placeholder="Buscar" class="m-input-search" />\n      <button type="button" id="m-searchstreet-search-btn" class="g-cartografia-zoom m-search-btn" title="Buscar"></button>\n      <button type="button" id="m-searchstreet-clear-btn" class="g-cartografia-cancelar m-clear-btn"title="Limpiar búsqueda"></button>\n   </div>\n   \x3c!-- results autocomplete --\x3e\n   <div class="results-panel-content" id="m-autocomplete-results">\n       <div id="m-searching-result-autocomplete" class="m-searching-result g-cartografia-spinner"></div>\n   </div>\n   \x3c!-- results panel --\x3e\n   <div class="results-panel" id="m-searchstreet-results">\n      <div id="m-searching-result-searchstreet" class="m-searching-result g-cartografia-spinner"></div>\n   </div>\n</div>\n'},11:function(e,t){e.exports='<div class="results-panels">\n   {{#if containtResult}}\n   <div class="results" id="m-searchstreet-results-scroll">\n      {{#each docs}}\n      <div class="result">\n         <table>\n            <tbody>\n               <tr>\n                  <td>{{streetType}} {{streetName}}, {{streetNumber}}</td>\n               </tr>\n               <tr>\n                  <td>{{localityName}} ({{cityName}})</td>\n               </tr>\n            </tbody>\n         </table>\n      </div>\n      {{/each}}\n   </div>\n   {{else}}\n   <div class="results">\n   <span class="partial">No se han encontrado resultados\n\t\tpara la búsqueda "{{search}}".</span>\n   </div>\n   {{/if}}\n   <div class="page">\n      <span class="found" id="m-searchstreet-page-found">Resultados encontrados:</span>\n   {{#if containtResult}}\n <span class="total">{{docs.length}} en total.</span>\n{{else}}\n <span class="total">0 en total.</span>\n{{/if}}\n      <div class="g-cartografia-flecha-arriba"></div>\n   </div>\n</div> \n'},3:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(9),i=n.n(r);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,ol.control.Control);var t,n,r,s=l(c);function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=s.call(this,{})).facadeMap_=null,e.listPoints=[],e.element_=null,e}return t=c,(n=[{key:"addTo",value:function(e,t){this.facadeMap_=e,this.element_=t,ol.control.Control.call(this,{element:t,target:null}),e.getMapImpl().addControl(this)}},{key:"drawPoints",value:function(e){for(var t=null,n=0,r=e.length;n<r;n+=1){(t=new ol.Feature).setStyle(new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:2})})})),t.setGeometry(null!==e[n].coordinateX&&null!==e[n].coordinateY?new ol.geom.Point([e[n].coordinateX,e[n].coordinateY]):null);var i=e[n];this.addEventClickFeature(i,t),this.facadeMap_.drawFeatures([M.impl.Feature.olFeature2Facade(t)]),this.listPoints.push([t])}this.zoomResults()}},{key:"zoomResults",value:function(){var e=this.listPoints[0],t=ol.extent.boundingExtent(e.filter((function(e){return!M.utils.isNullOrEmpty(e.getGeometry())})).map((function(e){return e.getGeometry().getFirstCoordinate()})));this.facadeMap_.setBbox(t)}},{key:"addEventClickFeature",value:function(e,t){var n=this;this.facadeMap_.removePopup(),M.utils.isNullOrEmpty(t)?(this.showPopup(e,!1),this.facadeMap_.setBbox([e.coordinateX,e.coordinateY,e.coordinateX,e.coordinateY])):t instanceof ol.Feature&&t.set("vendor",{mapea:{click:function(t){n.showPopup(e,!1)}}})}},{key:"showPopup",value:function(e,t){var n={jsonp:!0,vars:{tVia:e.streetType,nVia:e.streetName,num:e.streetNumber,mun:e.localityName,prov:e.cityName},parseToHtml:!1},r={icon:"g-cartografia-zoom",title:"Searchstreet",content:M.template.compileSync(i.a,n)};this.popup_=this.facadeMap_.getPopup(),M.utils.isNullOrEmpty(this.popup_)?(M.utils.isUndefined(t)?this.popup_=new M.Popup:this.popup_=new M.Popup({panMapIfOutOfView:t}),this.popup_.addTab(r),this.facadeMap_.addPopup(this.popup_,[e.coordinateX,e.coordinateY])):this.popup_.getTabs().some((function(e){return"Searchstreet"!==e.title}))?this.popup_.addTab(r):(this.facadeMap_.removePopup(),M.utils.isUndefined(t)?this.popup_=new M.Popup:this.popup_=new M.Popup({panMapIfOutOfView:t}),this.popup_.addTab(r),this.facadeMap_.addPopup(this.popup_,[e.coordinateX,e.coordinateY]))}},{key:"getElement",value:function(){return this.element_}},{key:"destroy",value:function(){this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.remove("top-extra"),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_.getImpl().removePopup(),this.facadeMap_=null,this.listPoints=null,this.element_=null}}])&&o(t.prototype,n),r&&o(t,r),c}();p.POPUP_TEMPLATE="searchstreetpopup.html"},41:function(e,t){e.exports='<div class="results-panels">\n   <div class="results" id="m-autcomplete">\n      {{#each docs}}\n      <div class="result autocomplete">\n       {{this}}\n      </div>\n      {{/each}}\n   </div>\n</div>\n\n\n'},42:function(e){e.exports=JSON.parse('{"url":{"name":"searchstreet"},"constructor":"M.plugin.Searchstreet","parameters":[{"type":"object","properties":[{"type":"simple","name":"locality","position":0}]}],"files":{"ol":{"scripts":["searchstreet-2.1.0.ol.min.js"],"styles":["searchstreet-2.1.0.min.css"]}},"metadata":{"uuid_plugin":"","uuid_version_plugin":"","version_ficha_metadatos":"","name":"Searchstreet","description":"","text":"","version":"2.1.0","date":"03/02/2020","author":"Junta de Andalucía","org":"Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","buttons":[{"title":"","description":"","querySelector":""},{"title":"","description":"","querySelector":""}],"dependencies":{"modules":["",""],"plugins":[{"uuid":"","name":""}],"services":[{"name":"","description":""}]},"compatibility":["4","5","6"]}}')},68:function(e,t,n){},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(3),i=n(10),s=n.n(i),o=n(11),a=n.n(o);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,M.Control);var t,n,i,o=p(l);function l(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var i=new r.a;return n=o.call(this,i,l.NAME),M.utils.isUndefined(r.a)&&M.exception("La implementación usada no puede crear controles Searchstreet"),n.input_=null,n.button_=null,n.element_=null,n.resultsContainer_=null,n.searchTime_=0,n.name_="searchstreet",n.searchUrl_=e,n.municipio_=null,n.provincia_=null,n.provincias_=[{nombre:"Huelva",codigoINE:"21"},{nombre:"Sevilla",codigoINE:"41"},{nombre:"Córdoba",codigoINE:"14"},{nombre:"Jaén",codigoINE:"23"},{nombre:"Cádiz",codigoINE:"11"},{nombre:"Málaga",codigoINE:"29"},{nombre:"Granada",codigoINE:"18"},{nombre:"Almería",codigoINE:"04"}],M.utils.isUndefined(t)||(n.codIne_=t,n.searchCodIne_=M.config.SEARCHSTREET_URLCOMPROBARINE),n.minAutocomplete_=M.config.AUTOCOMPLETE_MINLENGTH,n.facadeMap_=null,n.resultsAutocomplete_=null,n.completed=!1,n.respuestasProvincias_=[],n.contadorProvincias=0,n.resultsScrollContainer_=null,n}return t=l,(n=[{key:"createView",value:function(e){this.facadeMap_=e;var t=M.template.compileSync(s.a,{jsonp:!0});return this.addEvents(t),t}},{key:"addEvents",value:function(e){var t=this;if(this.element_=e,this.on(M.evt.COMPLETED,(function(){t.element_.classList.add("shown")}),this),this.input_=this.element_.getElementsByTagName("input")["m-searchstreet-search-input"],this.button_=this.element_.getElementsByTagName("button")["m-searchstreet-search-btn"],this.clear_=this.element_.getElementsByTagName("button")["m-searchstreet-clear-btn"],this.button_.addEventListener("click",this.searchClick.bind(this)),this.input_.addEventListener("keyup",this.searchClick.bind(this)),this.clear_.addEventListener("click",this.clearSearchs_.bind(this)),this.resultsContainer_=this.element_.getElementsByTagName("div")["m-searchstreet-results"],this.resultsAutocomplete_=this.element_.getElementsByTagName("div")["m-autocomplete-results"],this.searchingResult_=this.element_.querySelector("div#m-searchstreet-results > div#m-searching-result-searchstreet"),!M.utils.isUndefined(this.codIne_)&&!M.utils.isNullOrEmpty(this.codIne_)){var n=M.utils.addParameters(this.searchCodIne_,{codigo:this.codIne_});M.remote.get(n).then((function(e){var n;try{M.utils.isNullOrEmpty(e.text)||(n=JSON.parse(e.text),M.utils.isNullOrEmpty(n.comprobarCodIneResponse.comprobarCodIneReturn)?M.dialog.error("El código del municipio '".concat(t.codIne_,"' no es válido")):(t.getMunProv_(n),t.element_.getElementsByTagName("span").codIne.innerHTML="Búsquedas en ".concat(t.municipio_,"  (").concat(t.provincia_,")")))}catch(e){M.exception("La respuesta no es un JSON válido: ".concat(e))}}))}this.searchingResult_.parentNode.removeChild(this.searchingResult_)}},{key:"getMunProv_",value:function(e){this.provincia_=e.comprobarCodIneResponse.comprobarCodIneReturn.comprobarCodIneReturn.nombreProvincia,this.municipio_=e.comprobarCodIneResponse.comprobarCodIneReturn.comprobarCodIneReturn.nombreMunicipio}},{key:"searchClick",value:function(e){if(e.preventDefault(),"keyup"!==e.type){this.resultsAutocomplete_.classList.remove(l.MINIMUM),this.resultsAutocomplete_.innerHTML="";var t=this.input_.value;if(M.utils.isNullOrEmpty(t))M.dialog.error("Debe introducir una búsqueda.");else if(t.length<this.minAutocomplete_?this.completed=!1:this.completed=!0,M.utils.isUndefined(this.codIne_)||M.utils.isNullOrEmpty(this.codIne_))this.search_(t,this.showResults_);else{var n=t.indexOf(",");t.indexOf(",")>-1&&(t=t.substring(0,n)),this.search_("".concat(t,", ").concat(this.municipio_," , (").concat(this.provincia_,")"),this.showResults_)}}}},{key:"search_",value:function(e,t){var n=this;this.resultsContainer_.innerHTML=" ";var r=null;this.provincia_=null,this.municipio_=null,this.resultsContainer_.appendChild(this.searchingResult_),this.element_.classList.add(l.SEARCHING_CLASS),this.resultsContainer_.classList.add(l.MINIMUM);var i=M.utils.addParameters(M.config.SEARCHSTREET_NORMALIZAR,{cadena:e});M.remote.get(i).then((function(e){var i=JSON.parse(e.text).normalizarResponse.normalizarReturn;if(n.provincia_=M.utils.beautifyString(i.provincia),n.municipio_=M.utils.beautifyString(i.municipio),M.utils.isNullOrEmpty(n.provincia_))if(M.utils.isNullOrEmpty(n.provincia_)&&!M.utils.isNullOrEmpty(n.municipio_)){n.searchTime_=Date.now(),n.respuestasProvincias_=[],n.contadorProvincias=0;for(var s=0,o=n.provincias_.length;s<o;s+=1)r=M.utils.addParameters(n.searchUrl_,{streetname:i.nombreVia,streetNumber:i.numeroPortal,streetType:i.tipoVia,municipio:n.municipio_,provincia:n.provincias_[s].nombre,srs:n.facadeMap_.getProjection().code}),n.querySearchProvinces(r,n.provincias_[s].nombre,t)}else r=M.utils.addParameters(n.searchUrl_,{streetname:i.direccionSinNormalizar,streetNumber:null,streetType:null,municipio:null,provincia:null,srs:n.facadeMap_.getProjection().code}),n.searchTime_=Date.now(),n.querySearch_(r,null,t);else r=M.utils.addParameters(n.searchUrl_,{streetname:i.nombreVia,streetNumber:i.numeroPortal,streetType:i.tipoVia,municipio:n.municipio_,provincia:n.provincia_,srs:n.facadeMap_.getProjection().code}),n.searchTime_=Date.now(),n.querySearch_(r,n.provincia_,t)}))}},{key:"querySearch_",value:function(e,t,n){var r,i=this;r=this.searchTime_,M.remote.get(e).then((function(e){if(r===i.searchTime_){var s;try{s=M.utils.isNullOrEmpty(e.text)||-1!==e.text.indexOf("No se ha podido obtener el codigoINE")?null:JSON.parse(e.text)}catch(e){M.exception("La respuesta no es un JSON válido: ".concat(e))}M.utils.isNullOrEmpty(s)?(n.call(i,s),i.element_.classList.remove(l.SEARCHING_CLASS),i.resultsContainer_.classList.remove(l.MINIMUM)):(i.provincia_=M.utils.beautifyString(t),n.call(i,s),i.element_.classList.remove(l.SEARCHING_CLASS),i.resultsContainer_.classList.remove(l.MINIMUM))}}))}},{key:"querySearchProvinces",value:function(e,t,n){var r,i=this;r=this.searchTime_,M.remote.get(e).then((function(e){if(i.respuestasProvincias_.push(e),i.contadorProvincias+=1,8===i.contadorProvincias)for(var s=0,o=i.respuestasProvincias_.length;s<o;s+=1)if(r===i.searchTime_){var a=void 0;try{var c=i.respuestasProvincias_[s].text;a=M.utils.isNullOrEmpty(c)||-1!==c.indexOf("No se ha podido obtener el codigoINE")?null:JSON.parse(c)}catch(e){M.exception("La respuesta no es un JSON válido: ".concat(e))}M.utils.isNullOrEmpty(a)||0===a.geocoderMunProvSrsResponse.geocoderMunProvSrsReturn.geocoderMunProvSrsReturn.coordinateX||(i.provincia_=M.utils.beautifyString(t),n.call(i,a),i.element_.classList.remove(l.SEARCHING_CLASS),i.resultsContainer_.classList.remove(l.MINIMUM))}}))}},{key:"showResults_",value:function(e){var t=this.parseResultsForTemplate_(e);if(!M.utils.isUndefined(this.codIne_))for(var n=0,r=t.docs.length;n<r;n+=1)M.utils.isUndefined(t.docs[n])||void 0===t.docs[n].coordinateX&&(t.docs.splice(n,1),r-=1,n-=1);var i={jsonp:!0,vars:t},s=M.template.compileSync(a.a,i);if(this.resultsContainer_.classList.remove(l.HIDDEN_RESULTS_CLASS),this.resultsContainer_.innerHTML=s.innerHTML,this.resultsScrollContainer_=this.resultsContainer_.querySelector("div#m-searchstreet-results-scroll"),M.utils.isNullOrEmpty(this.resultsScrollContainer_)||M.utils.enableTouchScroll(this.resultsScrollContainer_),this.facadeMap_.removePopup(),this.getImpl().listPoints.length>0){var o=this.facadeMap_.getLayers().filter((function(e){return"__draw__"===e.name}))[0];o.removeFeatures(o.getFeatures())}M.utils.isUndefined(t.docs[0])||(this.getImpl().drawPoints(t.docs),this.eventList_(t.docs)),this.element_.classList.remove(l.SEARCHING_CLASS),this.resultsContainer_.classList.remove(l.MINIMUM),this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba").addEventListener("click",this.resultsClick_.bind(this)),this.fire(M.evt.COMPLETED),this.element_.getElementsByClassName("m-autocomplete-results").innerHTML=""}},{key:"parseResultsForTemplate_",value:function(e){var t=null,n=null,r=e,i=this.input_.value;if(M.utils.isNullOrEmpty(r))t={docs:[void 0],containtResult:n,search:i};else{var s=r.geocoderMunProvSrsResponse.geocoderMunProvSrsReturn;if(n=!M.utils.isNullOrEmpty(s),s.geocoderMunProvSrsReturn instanceof Array)if(M.utils.isUndefined(s.geocoderMunProvSrsReturn[0].coordinateX))t={docs:[void 0],containtResult:!1,search:i};else{for(var o=0,a=s.geocoderMunProvSrsReturn.length;o<a;o+=1)s.geocoderMunProvSrsReturn[o].localityName=this.municipio_,s.geocoderMunProvSrsReturn[o].cityName=this.getNameProvince(s.geocoderMunProvSrsReturn[o].locality),s.geocoderMunProvSrsReturn[o].streetType=M.utils.beautifyString(s.geocoderMunProvSrsReturn[o].streetType),s.geocoderMunProvSrsReturn[o].streetName=M.utils.beautifyString(s.geocoderMunProvSrsReturn[o].streetName);t={docs:s.geocoderMunProvSrsReturn,containtResult:n,search:i}}else M.utils.isNullOrEmpty(s)?t={docs:[void 0],containtResult:n,search:i}:0===s.geocoderMunProvSrsReturn.coordinateX?t={docs:[void 0],containtResult:!1,search:i}:(s.geocoderMunProvSrsReturn.localityName=this.municipio_,s.geocoderMunProvSrsReturn.cityName=this.getNameProvince(s.geocoderMunProvSrsReturn.locality),s.geocoderMunProvSrsReturn.streetType=M.utils.beautifyString(s.geocoderMunProvSrsReturn.streetType),s.geocoderMunProvSrsReturn.streetName=M.utils.beautifyString(s.geocoderMunProvSrsReturn.streetName),t={docs:[s.geocoderMunProvSrsReturn],containtResult:n,search:i})}return t}},{key:"getNameProvince",value:function(e){var t=e.toString();t.length<5&&(t="0".concat(t));var n=t.substr(0,2);return this.provincias_.filter((function(e){return e.codigoINE===n}))[0].nombre}},{key:"eventList_",value:function(e){for(var t=this.resultsContainer_.getElementsByClassName("result"),n=0,r=t.length;n<r;n+=1)this.addEventClickList_(t[n],e[n])}},{key:"addEventClickList_",value:function(e,t){var n=this;e.addEventListener("click",(function(e){M.window.WIDTH<=M.config.MOBILE_WIDTH&&n.resultsClick_(Object.create({target:n.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba")})),n.getImpl().addEventClickFeature(t)}),!1,this)}},{key:"equals",value:function(e){var t=!1;return e instanceof l&&(t=this.name===e.name),t}},{key:"getInput",value:function(){return this.input_}},{key:"getHtml",value:function(){return this.element_}},{key:"clearSearchs_",value:function(){this.element_.classList.remove("shown"),this.facadeMap_.removePopup();var e=this.facadeMap_.getLayers().filter((function(e){return"__draw__"===e.name}))[0];e.removeFeatures(e.getFeatures()),this.input_.value="",this.resultsContainer_.innerHTML="",this.resultsAutocomplete_.innerHTML=""}},{key:"resultsClick_",value:function(e){this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.add("top-extra-search"),e.target.classList.toggle("g-cartografia-flecha-arriba"),e.target.classList.toggle("g-cartografia-flecha-abajo"),this.resultsContainer_.classList.toggle(l.HIDDEN_RESULTS_CLASS)}}])&&c(t.prototype,n),i&&c(t,i),l}();f.NAME="searchstreet",f.TEMPLATE="searchstreet.html",f.RESULTS_TEMPLATE="searchstreetresults.html",f.SEARCHING_CLASS="m-searching",f.HIDDEN_RESULTS_CLASS="hidden",f.MINIMUM="minimum"},82:function(e,t,n){"use strict";n.r(t);var r=n(41),i=n.n(r);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(u,M.Plugin);var t,n,r,s=c(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(this,u),(e=s.call(this)).map_=null,e.name=u.NAME,e.locality_="",M.utils.isNullOrEmpty(t.locality)||(e.locality_=t.locality),e.url_=M.config.SEARCHSTREET_URLCODINEAUTOCOMPLETE,e.minLength_=M.config.AUTOCOMPLETE_MINLENGTH,e.target_=t.target,e.resultsContainer_=t.html.querySelector("div#m-autocomplete-results"),e.target_.addEventListener("keydown",(function(t){var n=e.resultsContainer_.querySelectorAll("div.autocomplete"),r=e.resultsContainer_.querySelector(".selected");if(13===t.keyCode){for(var i=e.map_.getControls(),s=0;s<i.length;s+=1)"searchstreet"===i[s].name?t.target.value.indexOf(",")<0?e.searchMunicipality_(t.target.value):(i[s].searchClick(t),i[s].completed=!1):"searchstreetgeosearch"===i[s].name&&(!M.utils.isNullOrEmpty(r)&&t.target.value.indexOf(",")<0?e.searchMunicipality_(t.target.value):(i[s].ctrlSearchstreet.searchClick(t),i[s].ctrlSearchstreet.completed=!1,i[s].ctrlGeosearch.searchClick(t)));r=null}else if(n.length>0){for(var o=-1,a=0;a<n.length;a+=1)n[a].classList.contains("selected")&&(o=a,r=n[a]);if(40===t.keyCode?-1===o?(r=n[0]).classList.add("selected"):o<n.length-1&&(n[o].classList.remove("selected"),(r=n[o+1]).classList.add("selected")):38===t.keyCode&&(o===n.length?(r=n[n.length]).classList.add("selected"):o>=1&&(n[o].classList.remove("selected"),(r=n[o-1]).classList.add("selected"))),!M.utils.isNullOrEmpty(r))t.target.value=r.innerHTML.trim(),document.getElementById("m-autcomplete").scrollTop=r.offsetTop}})),e.delayTime_=M.config.AUTOCOMPLETE_DELAYTIME,e.timeoutKey_=null,e.limit_=M.config.AUTOCOMPLETE_LIMIT,e.searchTime_=0,e.busqMunicipio_=!1,e.busqMunicipioClick_=!1,e.searchingResult_=e.resultsContainer_.querySelector("div#m-autocomplete-results > div#m-searching-result-autocomplete"),e}return t=u,(n=[{key:"addTo",value:function(e){this.map_=e,this.target_.classList.add(u.CLASS),this.resultsContainer_.removeChild(this.searchingResult_),this.target_.addEventListener("input",this.keyPress_.bind(this)),this.target_.addEventListener("keyup",this.hiddenAutocomplete_.bind(this))}},{key:"hiddenAutocomplete_",value:function(e){27!==e.keyCode&&13!==e.keyCode||this.cancelSearch_(e)}},{key:"keyPress_",value:function(e){var t=this;e.preventDefault(),M.utils.isNullOrEmpty(this.timeoutKey_)||this.cancelSearch_(e);var n=this.target_.value.trim();n.length>=this.minLength_&&(this.timeoutKey_=setTimeout((function(){-1!==n.indexOf(",")?t.busqMunicipio_=!0:(t.busqMunicipio_=!1,t.busqMunicipioClick_=!1),t.search_(n)}),this.delayTime_))}},{key:"search_",value:function(e,t){var n,r,s=this;this.evt=t,n=M.utils.addParameters(this.url_,{input:e.trim(),limit:this.limit_,codine:this.locality_}),n=this.formatContent_(n," ","%20"),this.searchTime_=Date.now(),r=this.searchTime_,M.remote.get(n).then((function(e){if(r===s.searchTime_){var t=JSON.parse(e.text);t=s.parseResultsForTemplate_(t);var n=s.map_.getControls();if(M.utils.isUndefined(t.docs))for(var o=0,a=n.length;o<a;o+=1)"searchstreet"===n[o].name?n[o].completed=!1:"searchstreetgeosearch"===n[o].name&&(n[o].ctrlSearchstreet.completed=!1);else if(M.utils.isUndefined(t.docs[0]))for(var l=0,c=n.length;l<c;l+=1)"searchstreet"===n[l].name?n[l].completed=!1:"searchstreetgeosearch"===n[l].name&&(n[l].ctrlSearchstreet.completed=!1);else{var p={jsonp:!0,vars:t};s.resultsContainer_.classList.contains(u.MINIMUM)&&(s.resultsContainer_.classList.remove(u.MINIMUM),M.utils.isNullOrEmpty(s.resultsContainer_.parentElement)||s.searchingResult_.parentElement.removeChild(s.searchingResult_));var d=M.template.compileSync(i.a,p);s.resultsContainer_.innerHTML=d.innerHTML;var h=s.resultsContainer_.querySelectorAll("div.autocomplete");if(s.addEvents_(h),s.target_.focus(),!0===s.busqMunicipio_){if(!0===s.busqMunicipioClick_){if(s.resultsContainer_.innerHTML="",!M.utils.isUndefined(s.evt)){for(var f=0,m=n.length;f<m;f+=1)"searchstreetgeosearch"===n[f].name?(n[f].ctrlSearchstreet.searchClick(s.evt),n[f].ctrlSearchstreet.completed=!1,n[f].ctrlGeosearch.searchClick(s.evt)):"searchstreet"===n[f].name&&(n[f].searchClick(s.evt),n[f].completed=!1);s.busqMunicipioClick_=!1}}else for(var _=s.resultsContainer_.querySelectorAll("div.autocomplete"),v=0,y=n.length;v<y;v+=1)if("searchstreetgeosearch"===n[v].name)if(!0===n[v].ctrlSearchstreet.completed)n[v].ctrlSearchstreet.completed=!1,s.resultsContainer_.innerHTML="";else for(var g=0,b=_.length;g<b;g+=1)s.evtClickMunicipaly_(_[g]);else if("searchstreet"===n[v].name)if(!0===n[v].completed)n[v].completed=!1,s.resultsContainer_.innerHTML="";else for(var S=0,C=_.length;S<C;S+=1)s.evtClickMunicipaly_(_[S])}else for(var E=0,P=n.length;E<P;E+=1)"searchstreet"===n[E].name?!0===n[E].completed&&(s.resultsContainer_.innerHTML="",n[E].completed=!1):"searchstreetgeosearch"===n[E].name&&!0===n[E].ctrlSearchstreet.completed&&(s.resultsContainer_.innerHTML="",n[E].ctrlSearchstreet.completed=!1)}}}))}},{key:"evtClickMunicipaly_",value:function(e){var t=this;e.addEventListener("click",(function(){t.clickMunicipaly_()}))}},{key:"parseResultsForTemplate_",value:function(e){var t=e.autocompletarDireccionMunicipioResponse.autocompletarDireccionMunicipioReturn.autocompletarDireccionMunicipioReturn,n=[];if(!0===this.busqMunicipio_)if(M.utils.isUndefined(t))this.resultsContainer_.innerHTML="";else{t instanceof Array==0&&(t=[t]);for(var r=0,i=t.length;r<i;r+=1){var s=t[r].split(",");n.push("".concat(s[0]," ").concat(s[1],", ").concat(s[3]," (").concat(s[s.length-1],")"))}t=n}else if(t instanceof Array==0){if(n.push(t),t=n,!M.utils.isUndefined(t[0]))for(var o=0,a=t.length;o<a;o+=1)t[o]=this.formatContent_(t[o],","," ")}else for(var l=0,c=t.length;l<c;l+=1)t[l]=this.formatContent_(t[l],","," ");return{docs:t}}},{key:"addEvents_",value:function(e){var t=this;e.forEach((function(e){t.addEventSearchMunicipality_(e)}))}},{key:"addEventSearchMunicipality_",value:function(e){var t=this;e.addEventListener("click",(function(n){if(t.target_.value=e.innerHTML.trim(),M.utils.isNullOrEmpty(t.locality_))t.searchMunicipality_(e.innerHTML,n);else{var r=t.map_.getControls();t.resultsContainer_.innerHTML="",r.forEach((function(e){var t=e;"searchstreet"===t.name?(t.searchClick(n),t.completed=!1):"searchstreetgeosearch"===t.name&&(t.ctrlSearchstreet.searchClick(n),t.ctrlSearchstreet.completed=!1,t.ctrlGeosearch.searchClick(n))}))}}))}},{key:"searchMunicipality_",value:function(e,t){this.busqMunicipio_=!0,this.search_("".concat(e.trim(),","),t)}},{key:"clickMunicipaly_",value:function(){this.busqMunicipioClick_=!0}},{key:"formatContent_",value:function(e,t,n){return e.replace(new RegExp(t,"g"),n)}},{key:"cancelSearch_",value:function(e){clearTimeout(this.timeoutKey_),this.minLength_<=this.target_.value.length&&13!==e.keyCode&&27!==e.keyCode?(M.utils.isNullOrEmpty(this.resultsContainer_.parentElement.querySelector("#m-searchstreet-results>div"))?this.resultsContainer_.classList.add("results-panel"):(this.resultsContainer_.classList.add("results-panel-content"),this.resultsContainer_.classList.remove("results-panel")),this.resultsContainer_.appendChild(this.searchingResult_),this.resultsContainer_.parentElement.classList.add(u.SEARCHING_CLASS),this.resultsContainer_.classList.add(u.MINIMUM)):(this.searchTime_=0,this.resultsContainer_.parentElement.classList.remove(u.SEARCHING_CLASS),this.resultsContainer_.classList.contains(u.MINIMUM)&&(this.resultsContainer_.classList.remove(u.MINIMUM),this.resultsContainer_.removeChild(this.searchingResult_),this.resultsContainer_.innerHTML=""))}},{key:"destroy",value:function(){null!==this.map_&&(this.map_.removeControls(this),this.map_=null,this.locality_="",this.url_=null,this.minLength_=null,this.target_=null,this.resultsContainer_=null,this.delayTime_=null,this.timeoutKey_=null,this.limit_=null,this.searchTime_=null,this.busqMunicipio_=null,this.busqMunicipioClick_=null,this.searchingResult_=null)}},{key:"equals",value:function(e){return e instanceof u}}])&&a(t.prototype,n),r&&a(t,r),u}();d.CLASS="m-plugin-autocomplete",d.SEARCHING_CLASS="m-searching",d.RESULTAUTOCOMPLETE="resultautocomplete.html",d.MINIMUM="minimum",d.NAME="autocomplete";var h=n(7),f=(n(68),n(42));function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(s,M.Plugin);var t,n,r,i=g(s);function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _(this,s),(e=i.call(this)).name="searchstreet",e.map_=null,e.control_=null,e.autocompletador_=null,e.panel_=null,e.url_=M.config.SEARCHSTREET_URL,e.locality_="",M.utils.isNullOrEmpty(t.locality)||(e.locality_=t.locality),e.metadata_=f.metadata,e}return t=s,(n=[{key:"addTo",value:function(e){var t=this;this.map_=e,e.areasContainer.getElementsByClassName("m-top m-right")[0].classList.add("top-extra");var n=M.utils.addParameters(M.config.SEARCHSTREET_URLCOMPROBARINE,{codigo:this.locality_});M.utils.isNullOrEmpty(n)||M.remote.get(n).then((function(e){var n;M.utils.isNullOrEmpty(e.text)||(n=JSON.parse(e.text),!M.utils.isNullOrEmpty(t.locality_)&&M.utils.isNullOrEmpty(n.comprobarCodIneResponse.comprobarCodIneReturn)&&(M.dialog.error("El código del municipio '".concat(t.locality,"' no es válido")),t.locality_="")),t.control_=new h.a(t.url_,t.locality_),t.control_.on(M.evt.ADDED_TO_MAP,(function(){t.fire(M.evt.ADDED_TO_MAP),t.autocompletador_=new d({locality:t.locality_,target:t.control_.getInput(),html:t.control_.getHtml()}),t.map_.addPlugin(t.autocompletador_)}),t),t.panel_=new M.ui.Panel("searchstreet",{collapsible:!0,className:"m-searchstreet",position:M.ui.position.TL,tooltip:"Buscador de calles"}),t.panel_.on(M.evt.ADDED_TO_MAP,(function(e){t.panel_.getButtonPanel().addEventListener("click",(function(e){t.panel_.collapsed||t.control_.getInput().focus()}))})),t.panel_.addControls(t.control_),t.map_.addPanels(t.panel_)}))}},{key:"getControls",value:function(){var e=[];return e.push(this.control_),e}},{key:"destroy",value:function(){this.map_.removeControls([this.control_]),this.map_.removePlugins(this.autocompletador_),this.name=null,this.map_=null,this.control_=null,this.autocompletador_=null,this.panel_=null,this.url_=null,this.locality_=null}},{key:"equals",value:function(e){return e instanceof s}},{key:"getAPIRest",value:function(){return"searchstreet"}},{key:"getMetadata",value:function(){return this.metadata_}}])&&v(t.prototype,n),r&&v(t,r),s}();null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.Searchstreet=C},9:function(e,t){e.exports='<div class="m-searchstreet-content">\n   <div class="result">\n      <table>\n         <tr>\n            <td class="key">Tipo de Vía</td>\n            <td class="value">{{tVia}}</td>\n         </tr>\n         <tr>\n            <td class="key">Nombre de Vía</td>\n            <td class="value">{{nVia}}</td>\n         </tr>\n         <tr>\n            <td class="key">Número</td>\n            <td class="value">{{num}}</td>\n         </tr>\n         <tr>\n            <td class="key">Municipio</td>\n            <td class="value">{{mun}}</td>\n         </tr>\n         <tr>\n            <td class="key">Provincia</td>\n            <td class="value">{{prov}}</td>\n         </tr>\n      </table>\n   </div>\n</div>'}});