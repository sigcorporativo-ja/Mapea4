!function(e){var t={};function i(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,i),l.l=!0,l.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)i.d(s,l,function(t){return e[t]}.bind(null,l));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=80)}({37:function(e,t){e.exports='<div class="m-control m-printer-container">\n   \x3c!-- TITLE --\x3e\n   <div class="title">Impresión del mapa</div>\n   \x3c!-- FORM --\x3e\n   <div class="form">\n      \x3c!-- title --\x3e\n      <div class="title">\n         <input type="text" placeholder="Título">\n      </div>\n      \x3c!-- description --\x3e\n      <div class="description">\n         <textarea placeholder="Descripción"></textarea>\n      </div>\n      \x3c!-- layout --\x3e\n      <div class="layout">\n         <label>Plantilla </label>\n         <select>\n            {{#each layouts}}\n            <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n            {{/each}}\n         </select>\n      </div>\n      \x3c!-- DPI --\x3e\n      <div class="dpi">\n         <label>DPI </label>\n         <select>\n            {{#each dpis}}\n            <option value="{{value}}" {{#if default}} selected{{/if}}>{{name}}</option>\n            {{/each}}\n         </select>\n      </div>\n      \x3c!-- format --\x3e\n      <div class="format">\n         <label>Formato </label>\n         <select>\n            {{#each outputFormats}}\n            <option value="{{name}}" {{#if default}} selected{{/if}}>{{name}}</option>\n            {{/each}}\n         </select>\n      </div>\n      \x3c!-- force scale --\x3e\n      <div class="forcescale">\n         <label>Forzar escala </label>\n         <input type="checkbox" {{#if forceScale}} checked{{/if}}>\n      </div>\n   </div>\n   \x3c!-- buttons --\x3e\n   <div class="button">\n      <button class="print"><i class="g-cartografia-impresora"></i> Imprimir</button>\n       <button class="remove"><i class="g-cartografia-papelera"></i> Borrar</button>\n   </div>\n   \x3c!-- queue --\x3e\n   <div class="queue">\n      <div class="title">Descargar</div>\n      <ul class="queue-container"></ul>\n   </div>\n   \x3c!-- minimize button --\x3e\n   <div class="minimize" title="Minimizar el control de impresión"></div>\n</div>'},38:function(e){e.exports=JSON.parse('{"url":{"name":"printer","separator":"*"},"constructor":"M.plugin.Printer","parameters":[{"type":"object","properties":[{"type":"simple","name":"url","position":0},{"type":"object","name":"params","properties":[{"type":"object","name":"layout","properties":[{"type":"simple","name":"outputFilename","value":"mapea_${yyyy-MM-dd_hhmmss}"}]},{"type":"object","name":"pages","properties":[{"type":"simple","name":"clientLogo","value":"http://www.juntadeandalucia.es/economiayhacienda/images/plantilla/logo_cabecera.gif"},{"type":"simple","name":"creditos","value":"Impresión generada a través de Mapea"}]}]}]},{"type":"object","properties":[{"type":"object","name":"options","properties":[{"type":"simple","name":"legend","value":"true"}]}]}],"files":{"ol":{"scripts":["printer-2.0.1.ol.min.js"],"styles":["printer-2.0.1.min.css"]}},"metadata":{"uuid_plugin":"","uuid_version_plugin":"","version_ficha_metadatos":"","name":"Printer","description":"Tool for printing maps.","text":"","version":"2.0.1","date":"11/10/2019","author":"Junta de Andalucía","org":"Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","buttons":[{"title":"","description":"","querySelector":""},{"title":"","description":"","querySelector":""}],"dependencies":{"modules":["",""],"plugins":[{"uuid":"","name":""}],"services":[{"name":"","description":""}]},"compatibility":["4","5","6"]}}')},64:function(e,t,i){},80:function(e,t,i){"use strict";i.r(t);class s extends M.impl.Control{constructor(){super(),this.facadeMap_=null}addTo(e,t){this.facadeMap_=e,this.element=t,super.addTo(e,t)}encodeLayer(e){return new Promise((t,i)=>{e.type===M.layer.type.WMC||(e.type===M.layer.type.KML?t(this.encodeKML(e)):e.type===M.layer.type.WMS?t(this.encodeWMS(e)):e.type===M.layer.type.WFS||e.type===M.layer.type.GeoJSON?t(this.encodeWFS(e)):e.type===M.layer.type.WMTS?this.encodeWMTS(e).then(e=>{t(e)}):e.type===M.layer.type.MBtiles||(e.type===M.layer.type.OSM?t(this.encodeOSM(e)):e.type===M.layer.type.Mapbox?t(this.encodeMapbox(e)):(M.utils.isNullOrEmpty(e.type)&&M.layer.Vector,t(this.encodeWFS(e)))))})}encodeLegend(e){let t=null;if(e.displayInLayerSwitcher){t={name:e.name,classes:[]};const i=new RegExp(`.*${M.Layer.LEGEND_DEFAULT}$`),s=new RegExp(`.*${M.Layer.LEGEND_ERROR}$`),l=e.getLegendURL();M.utils.isNullOrEmpty(l)||i.test(l)||s.test(l)||(t.classes[0]={name:"",icons:[e.getLegendURL()]},e instanceof M.layer.Vector&&delete t.classes[0].icons)}return t}encodeKML(e){let t=null;const i=e.getImpl().getOL3Layer(),s=i.getSource().getFeatures(),l=e.name,n=i.getOpacity(),o=new ol.format.GeoJSON;let a=this.facadeMap_.getBbox();a=[a.x.min,a.y.min,a.x.max,a.y.max];const r=this.facadeMap_.getMapImpl().getView().getResolution(),c=[],p={},u={};let m=1;return s.forEach(e=>{const t=e.getGeometry();let i=e.get("styleUrl");M.utils.isNullOrEmpty(i)||(i=i.replace("#",""));const s=e.getStyle();if(!M.utils.isNullOrEmpty(s)){const l=s(e,r)[0];if(!M.utils.isNullOrEmpty(l)){const s=l.getImage();let n=s.getImageSize();M.utils.isNullOrEmpty(n)&&(n=[64,64]);const r=l.getStroke();let g={id:i,externalGraphic:s.getSrc(),graphicHeight:n[0],graphicWidth:n[1],graphicOpacity:s.getOpacity(),strokeWidth:r.getWidth()};const d=l.getText&&l.getText();if(M.utils.isNullOrEmpty(d)||(g=Object.assign(g,{label:M.utils.isNullOrEmpty(d.getText())?e.get("name"):d.getText(),fontColor:M.utils.isNullOrEmpty(d.getFill())?"":M.utils.rgbToHex(M.utils.isArray(d.getFill().getColor())?`rgba(${d.getFill().getColor().toString()})`:d.getFill().getColor()),fontSize:"11px",fontFamily:"Helvetica, sans-serif",fontWeight:"bold",labelAlign:d.getTextAlign(),labelXOffset:d.getOffsetX(),labelYOffset:d.getOffsetY(),labelOutlineColor:M.utils.isNullOrEmpty(d.getStroke())?"":M.utils.rgbToHex(M.utils.isArray(d.getStroke().getColor())?`rgba(${d.getStroke().getColor().toString()})`:d.getStroke().getColor()),labelOutlineWidth:M.utils.isNullOrEmpty(d.getStroke())?"":d.getStroke().getWidth()})),!M.utils.isNullOrEmpty(t)&&t.intersectsExtent(a)){const t=JSON.stringify(g);let i=u[t];M.utils.isUndefined(i)&&(i=m,u[t]=i,p[i]=g,m+=1);const s=o.writeFeatureObject(e);s.properties={_gx_style:i},c.push(s)}}}},this),t={type:"Vector",styles:p,styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:c},name:l,opacity:n},t}encodeWMS(e){let t=null;const i=e.getImpl().getOL3Layer(),s=e.url,l=i.getOpacity(),n=e.getImpl().tiled,o=i.getSource().getParams(),a=[o.LAYERS],r=o.FORMAT,c=[o.STYLES];t={baseURL:s,opacity:l,singleTile:!n,type:"WMS",layers:a.join(",").split(","),format:r||"image/jpeg",styles:c.join(",").split(",")},e._updateNoCache();const p=e.getNoCacheName(),u=e.getNoCacheUrl();M.utils.isNullOrEmpty(p)||M.utils.isNullOrEmpty(u)||(t.layers=[p],t.baseURL=u),t.customParams={};return Object.keys(o).forEach(e=>{-1!=="iswmc,transparent".indexOf(e.toLowerCase())&&(t.customParams[e]=o[e])}),t}encodeWFS(e){let t=null,i=!0;if((e.getStyle()instanceof M.style.Chart||e.getStyle()instanceof M.style.Cluster&&e.getStyle().getOldStyle()instanceof M.style.Chart)&&(i=!1),i){const i=this.facadeMap_.getProjection(),s=e.getImpl().getOL3Layer(),l=s.getSource().getFeatures(),n=e.name,o=s.getOpacity(),a=s.getStyle(),r=new ol.format.GeoJSON;let c=this.facadeMap_.getBbox();c=[c.x.min,c.y.min,c.x.max,c.y.max];const p=this.facadeMap_.getMapImpl().getView().getResolution(),u=[],m={},g={};let d=1;l.forEach(e=>{const t=e.getGeometry();let s;const l=e.getStyle();if(M.utils.isNullOrEmpty(l)?M.utils.isNullOrEmpty(a)||(s=a):s=l,s instanceof Function&&(s=s.call(s,e,p)),s instanceof Array&&(s=s.length>1&&!M.utils.isNullOrEmpty(s[1].getImage())&&s[1].getImage().getSrc?s[1]:s[0]),!M.utils.isNullOrEmpty(s)){const l=s.getImage(),n=M.utils.isNullOrEmpty(l)?[0,0]:l.getImageSize()||[24,24];let o=s.getText();M.utils.isNullOrEmpty(o)&&!M.utils.isNullOrEmpty(s.textPath)&&(o=s.textPath);const a=M.utils.isNullOrEmpty(l)?s.getStroke():l.getStroke&&l.getStroke(),p=M.utils.isNullOrEmpty(l)?s.getFill():l.getFill&&l.getFill();let y={fillColor:M.utils.isNullOrEmpty(p)?"#000000":M.utils.rgbaToHex(p.getColor()),fillOpacity:M.utils.isNullOrEmpty(p)?1:M.utils.getOpacityFromRgba(p.getColor()),strokeColor:M.utils.isNullOrEmpty(a)?"#000000":M.utils.rgbaToHex(a.getColor()),strokeOpacity:M.utils.isNullOrEmpty(a)?0:M.utils.getOpacityFromRgba(a.getColor()),strokeWidth:M.utils.isNullOrEmpty(a)?0:a.getWidth&&a.getWidth(),pointRadius:M.utils.isNullOrEmpty(l)?"":l.getRadius&&l.getRadius(),externalGraphic:M.utils.isNullOrEmpty(l)?"":l.getSrc&&l.getSrc(),graphicHeight:n[0],graphicWidth:n[1]};if(!M.utils.isNullOrEmpty(o)){let e=o.getTextAlign(),t=o.getTextBaseline(),i="";M.utils.isNullOrEmpty(e)||(e=e===M.style.align.LEFT?"l":e===M.style.align.RIGHT?"r":e===M.style.align.CENTER?"c":""),M.utils.isNullOrEmpty(t)||(t=t===M.style.baseline.BOTTOM?"b":t===M.style.baseline.MIDDLE?"m":t===M.style.baseline.TOP?"t":""),M.utils.isNullOrEmpty(e)||M.utils.isNullOrEmpty(t)||(i=e.concat(t));const s=o.getFont(),l=!M.utils.isNullOrEmpty(s)&&s.indexOf("bold")>-1?"bold":"normal";let n="11px";if(!M.utils.isNullOrEmpty(s)){const e=s.substr(0,s.indexOf("px"));if(!M.utils.isNullOrEmpty(e)){const t=e.lastIndexOf(" ");n=t>-1?e.substr(t,e.length).trim().concat("px"):e.concat("px")}}y=Object.assign(y,{label:o.getText(),fontColor:M.utils.isNullOrEmpty(o.getFill())?"#000000":M.utils.rgbToHex(o.getFill().getColor()),fontSize:n,fontFamily:"Helvetica, sans-serif",fontStyle:"normal",fontWeight:l,labelXOffset:o.getOffsetX(),labelYOffset:o.getOffsetY(),fillColor:y.fillColor||"#FF0000",fillOpacity:y.fillOpacity||1,labelOutlineColor:M.utils.isNullOrEmpty(o.getStroke())?"":M.utils.rgbToHex(o.getStroke().getColor()||"#FF0000"),labelOutlineWidth:M.utils.isNullOrEmpty(o.getStroke())?"":o.getStroke().getWidth(),labelAlign:i})}if(!M.utils.isNullOrEmpty(t)&&t.intersectsExtent(c)){const t=JSON.stringify(y);let s,l=g[t];M.utils.isUndefined(l)&&(l=d,g[t]=l,m[l]=y,d+=1),s="EPSG:3857"!==i.code&&this.facadeMap_.getLayers().some(e=>e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox)?r.writeFeatureObject(e,{featureProjection:i.code,dataProjection:"EPSG:3857"}):r.writeFeatureObject(e),s.properties={_gx_style:l},u.push(s)}}},this),t={type:"Vector",styles:m,styleProperty:"_gx_style",geoJson:{type:"FeatureCollection",features:u},name:n,opacity:o}}return t}encodeWMTS(e){const t=this.facadeMap_.getZoom(),i=e.getImpl(),s=i.getOL3Layer(),l=s.getSource(),n=l.getTileGrid(),o=e.url,a=e.name,r=s.getOpacity(),c=l.getRequestEncoding(),p=i.tiled,u=s.getExtent(),m={},g=l.getMatrixSet(),d=n.getTileSize(t),y=n.getResolutions();return e.getImpl().getCapabilities().then(e=>{const t=e.Contents.TileMatrixSet.filter(e=>e.Identifier===g)[0];return{baseURL:o,opacity:r,singleTile:!p,type:"WMTS",layer:a,requestEncoding:c,tileSize:d,style:"deafult",rotation:0,imageFormat:"image/png",dimensionParams:{},dimensions:[],params:m,version:"1.0.0",maxExtent:u,matrixSet:g,matrixIds:t.TileMatrix.map((e,t)=>({identifier:e.Identifier,matrixSize:[e.MatrixHeight,e.MatrixWidth],scaleDenominator:e.ScaleDenominator,tileSize:[e.TileWidth,e.TileHeight],topLeftCorner:e.TopLeftCorner})),resolutions:y}})}encodeOSM(e){let t=null;const i=e.getImpl(),s=i.getOL3Layer(),l=s.getSource().getTileGrid(),n=e.url||"http://tile.openstreetmap.org/",o=e.name,a=s.getOpacity(),r=i.tiled,c=l.getExtent(),p=l.getTileSize();return t={baseURL:n,opacity:a,singleTile:!r,layer:o,maxExtent:c,tileSize:[p,p],resolutions:l.getResolutions(),type:"OSM",extension:"png"},t}encodeMapbox(e){let t=null;const i=e.getImpl().getOL3Layer(),s=i.getSource().getTileGrid(),l=M.utils.concatUrlPaths([M.config.MAPBOX_URL,e.name]),n=i.getOpacity(),o=s.getExtent(),a=s.getTileSize(),r=s.getResolutions(),c={};return c[M.config.MAPBOX_TOKEN_NAME]=M.config.MAPBOX_TOKEN_VALUE,t={opacity:n,baseURL:l,customParams:c,maxExtent:o,tileSize:[a,a],resolutions:r,extension:M.config.MAPBOX_EXTENSION,type:"xyz",path_format:"/${z}/${x}/${y}.png"},t}destroy(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}var l=i(37),n=i.n(l);class o extends M.Control{constructor(e,t,i,l){super(new s,o.NAME),M.utils.isUndefined(s)&&M.exception("La implementación usada no puede crear controles Printer"),M.utils.isUndefined(s.prototype.encodeLayer)&&M.exception("La implementación usada no posee el método encodeLayer"),M.utils.isUndefined(s.prototype.encodeLegend)&&M.exception("La implementación usada no posee el método encodeLegend"),this.url_=e,this.inputTitle_=null,this.areaDescription_=null,this.layout_=null,this.format_=null,this.dpi_=null,this.forceScale_=null,this.params_=t||{},this.queueContainer_=null,this.capabilitiesPromise_=null,this.options_=i||{},M.utils.isNullOrEmpty(this.options_.layout)&&(this.options_.layout=M.config.geoprint.TEMPLATE),M.utils.isNullOrEmpty(this.options_.dpi)&&(this.options_.dpi=M.config.geoprint.DPI),M.utils.isNullOrEmpty(this.options_.format)&&(this.options_.format=M.config.geoprint.FORMAT),M.utils.isNullOrEmpty(this.options_.forceScale)&&(this.options_.forceScale=M.config.geoprint.FORCE_SCALE),M.utils.isNullOrEmpty(this.options_.legend)&&(this.options_.legend=M.config.geoprint.LEGEND)}createView(e){return new Promise((e,t)=>{this.getCapabilities().then(t=>{const i=t;let s,l=0;for(l=0,s=i.layouts.length;l<s;l+=1){const e=i.layouts[l];if(e.name===this.options_.layout){e.default=!0;break}}for(l=0,s=i.dpis.length;l<s;l+=1){const e=i.dpis[l];if(parseInt(e.value,10)===this.options_.dpi){e.default=!0;break}}for(l=0,s=i.outputFormats.length;l<s;l+=1){const e=i.outputFormats[l];if(e.name===this.options_.format){e.default=!0;break}}i.forceScale=this.options_.forceScale;const o=M.template.compileSync(n.a,{jsonp:!0,vars:i});this.addEvents(o),e(o)})})}addEvents(e){this.element_=e,this.inputTitle_=this.element_.querySelector(".form div.title > input"),this.areaDescription_=this.element_.querySelector(".form div.description > textarea");const t=this.element_.querySelector(".form div.layout > select");t.addEventListener("change",e=>{const i=t.value;this.setLayout({value:i,name:i})});const i=t.value;this.setLayout({value:i,name:i});const s=this.element_.querySelector(".form div.dpi > select");s.addEventListener("change",e=>{const t=s.value;this.setDpi({value:t,name:t})});const l=s.value;this.setDpi({value:l,name:l});const n=this.element_.querySelector(".form div.format > select");n.addEventListener("change",e=>{this.setFormat(n.value)}),this.setFormat(n.value);const o=this.element_.querySelector(".form div.forcescale > input");o.addEventListener("click",e=>{this.setForceScale(!0===o.checked)}),this.setForceScale(!0===o.checked);this.element_.querySelector(".button > button.print").addEventListener("click",this.printClick_.bind(this));this.element_.querySelector(".button > button.remove").addEventListener("click",e=>{e.preventDefault(),this.inputTitle_.value="",this.areaDescription_.value="",t.value=this.options_.layout,s.value=this.options_.dpi,n.value=this.options_.format,o.checked=this.options_.forceScale;const i=document.createEvent("HTMLEvents");i.initEvent("change");const l=document.createEvent("HTMLEvents");for(l.initEvent("click"),t.dispatchEvent(i),s.dispatchEvent(i),n.dispatchEvent(i),o.dispatchEvent(l),Array.prototype.forEach.apply(this.queueContainer_.children,[e=>{e.removeEventListener("click",this.dowloadPrint)},this]);this.queueContainer_.fistChild;)this.queueContainer_(this.queueContainer_.firsChild)}),this.queueContainer_=this.element_.querySelector(".queue > ul.queue-container"),M.utils.enableTouchScroll(this.queueContainer_)}setLayout(e){this.layout_=e}setFormat(e){this.format_=e}setDpi(e){this.dpi_=e}setForceScale(e){this.forceScale_=e}printClick_(e){e.preventDefault(),this.getCapabilities().then(e=>{this.getPrintData().then(t=>{const i=M.utils.addParameters(e.createURL,"mapeaop=geoprint"),s=this.createQueueElement();this.queueContainer_.appendChild(s),s.classList.add(o.LOADING_CLASS),M.remote.post(i,t).then(e=>{let t=e;if(s.classList.remove(o.LOADING_CLASS),!0!==t.error){let e;try{t=JSON.parse(t.text),e=t.getURL}catch(e){M.exception(e)}s.setAttribute(o.DOWNLOAD_ATTR_NAME,e),s.addEventListener("click",this.dowloadPrint)}else M.dialog.error("Se ha producido un error en la impresión")})})})}getCapabilities(){return M.utils.isNullOrEmpty(this.capabilitiesPromise_)&&(this.capabilitiesPromise_=new Promise((e,t)=>{const i=M.utils.concatUrlPaths([this.url_,"info.json"]);M.remote.get(i).then(t=>{let i={};try{i=JSON.parse(t.text)}catch(e){M.exception(e)}e(i)})})),this.capabilitiesPromise_}getPrintData(){const e=this.inputTitle_.value,t=this.areaDescription_.value,i=this.map_.getProjection(),s=this.layout_.name,l=this.dpi_.value,n=this.format_,o=M.utils.extend({units:i.units,srs:i.code,layout:s,dpi:l,outputFormat:n},this.params_.layout);return this.encodeLayers().then(s=>(o.layers=s,o.pages=this.encodePages(e,t),!0===this.options_.legend&&(o.legends=this.encodeLegends()),"EPSG:3857"!==i.code&&this.map_.getLayers().some(e=>e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox)&&(o.srs="EPSG:3857"),o))}encodeLayers(){const e=this.map_.getLayers().filter(e=>!0===e.isVisible()&&!0===e.inRange()&&M.utils.isString(e.name)&&!e.name.startsWith("cluster_cover"));let t=e.length;return new Promise((i,s)=>{const l=[];e.forEach(e=>{this.getImpl().encodeLayer(e).then(e=>{M.utils.isNullOrEmpty(e)||l.push(e),t-=1,0===t&&i(l)})})})}encodePages(e,t){const i=[],s=this.map_.getProjection();return M.utils.isArray(this.params_.pages)||(this.params_.pages=[this.params_.pages]),this.params_.pages.forEach(l=>{const n=M.utils.extend({title:e,printTitle:e,printDescription:t,infoSRS:"\n "+this.map_.getProjection().code},l);if(!1===this.forceScale_){const e=this.map_.getBbox();n.bbox=[e.x.min,e.y.min,e.x.max,e.y.max],"EPSG:3857"!==s.code&&this.map_.getLayers().some(e=>e.type===M.layer.type.OSM||e.type===M.layer.type.Mapbox)&&(n.bbox=ol.proj.transformExtent(n.bbox,s.code,"EPSG:3857"))}else if(!0===this.forceScale_){const e=this.map_.getCenter();n.center=[e.x,e.y],n.scale=this.map_.getScale()}n.rotation=0,i.push(n)},this),i}encodeLegends(){const e=[];return this.map_.getLayers().forEach(t=>{if(!0===t.isVisible()&&!0===t.inRange()){const i=this.getImpl().encodeLegend(t);null!==i&&e.push(i)}},this),e}createQueueElement(){const e=document.createElement("li");let t=this.inputTitle_.value;return M.utils.isNullOrEmpty(t)&&(t=o.NO_TITLE),e.innerHTML=t,e}dowloadPrint(e){e.preventDefault();const t=this.getAttribute(o.DOWNLOAD_ATTR_NAME);M.utils.isNullOrEmpty(t)||window.open(t,"_blank")}equals(e){let t=!1;return e instanceof o&&(t=this.name===e.name),t}}o.NAME="printercontrol",o.TEMPLATE="printer.html",o.LOADING_CLASS="printing",o.DOWNLOAD_ATTR_NAME="data-donwload-url-print",o.NO_TITLE="(Sin título)";i(64);var a=i(38);class r extends M.Plugin{constructor(e={}){super(null),this.map_=null,this.control_=null,this.panel_=null,this.name=r.NAME,this.url_=M.config.geoprint2.URL,M.utils.isNullOrEmpty(e.url)||(this.url_=e.url),this.params_={},M.utils.isNullOrEmpty(e.params)||(this.params_=e.params),this.options_={},M.utils.isNullOrEmpty(e.options)||(this.options_=e.options),this.metadata_=a.metadata}addTo(e){this.map_=e,this.control_=new o(this.url_,this.params_,this.options_),this.panel_=new M.ui.Panel("printer",{collapsible:!0,className:"m-printer",collapsedButtonClass:"g-cartografia-impresora",position:M.ui.position.TR,tooltip:"Impresión del mapa"}),this.panel_.on(M.evt.ADDED_TO_MAP,e=>{M.utils.enableTouchScroll(e)}),this.panel_.addControls(this.control_),this.map_.addPanels(this.panel_),this.control_.on(M.evt.ADDED_TO_MAP,()=>{this.fire(M.evt.ADDED_TO_MAP)})}getControls(){const e=[];return e.push(this.control_),e}destroy(){this.map_.removeControls([this.control_]),this.map_=null,this.control_=null,this.panel_=null,this.url_=null,this.params_=null,this.options_=null,this.name=null}equals(e){return e instanceof r}getAPIRest(){return"printer="+this.url_}getMetadata(){return this.metadata_}}r.NAME="printer",null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.Printer=r}});