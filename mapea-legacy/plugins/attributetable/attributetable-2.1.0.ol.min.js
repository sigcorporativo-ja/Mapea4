!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=78)}({13:function(t,e,i){var n,r;
/*!
 * getSize v2.0.3
 * measure size of elements
 * MIT license
 */window,void 0===(r="function"==typeof(n=function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}var e="undefined"==typeof console?function(){}:function(t){console.error(t)},i=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],n=i.length;function r(t){var i=getComputedStyle(t);return i||e("Style returned "+i+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),i}var o,a=!1;function s(e){if(function(){if(!a){a=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var n=r(e);o=200==Math.round(t(n.width)),s.isBoxSizeOuter=o,i.removeChild(e)}}(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var l=r(e);if("none"==l.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<n;e++)t[i[e]]=0;return t}();var c={};c.width=e.offsetWidth,c.height=e.offsetHeight;for(var u=c.isBorderBox="border-box"==l.boxSizing,h=0;h<n;h++){var d=i[h],p=l[d],f=parseFloat(p);c[d]=isNaN(f)?0:f}var g=c.paddingLeft+c.paddingRight,y=c.paddingTop+c.paddingBottom,v=c.marginLeft+c.marginRight,b=c.marginTop+c.marginBottom,m=c.borderLeftWidth+c.borderRightWidth,_=c.borderTopWidth+c.borderBottomWidth,P=u&&o,S=t(l.width);!1!==S&&(c.width=S+(P?0:g+m));var E=t(l.height);return!1!==E&&(c.height=E+(P?0:y+_)),c.innerWidth=c.width-(g+m),c.innerHeight=c.height-(y+_),c.outerWidth=c.width+v,c.outerHeight=c.height+b,c}}return s})?n.call(e,i,e,t):n)||(t.exports=r)},14:function(t,e,i){var n,r;
/*!
 * Unidragger v2.3.0
 * Draggable base class
 * MIT license
 */!function(o,a){n=[i(15)],void 0===(r=function(t){return function(t,e){"use strict";function i(){}var n=i.prototype=Object.create(e.prototype);n.bindHandles=function(){this._bindHandles(!0)},n.unbindHandles=function(){this._bindHandles(!1)},n._bindHandles=function(e){for(var i=(e=void 0===e||e)?"addEventListener":"removeEventListener",n=e?this._touchActionValue:"",r=0;r<this.handles.length;r++){var o=this.handles[r];this._bindStartEvent(o,e),o[i]("click",this),t.PointerEvent&&(o.style.touchAction=n)}},n._touchActionValue="none",n.pointerDown=function(t,e){this.okayPointerDown(t)&&(this.pointerDownPointer=e,t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var r={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},o={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return n.okayPointerDown=function(t){var e=r[t.target.nodeName],i=o[t.target.type],n=!e||i;return n||this._pointerReset(),n},n.pointerDownBlur=function(){var t=document.activeElement;t&&t.blur&&t!=document.body&&t.blur()},n.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},n._dragPointerMove=function(t,e){var i={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(t,e),i},n.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},n._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},n._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},n.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},n._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},n.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},n._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},n.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},n.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},n._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},n.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},i.getPointerPoint=e.getPointerPoint,i}(o,t)}.apply(e,n))||(t.exports=r)}(window)},15:function(t,e,i){var n,r;
/*!
 * Unipointer v2.3.0
 * base class for doing one thing with pointer event
 * MIT license
 */!function(o,a){n=[i(16)],void 0===(r=function(t){return function(t,e){"use strict";function i(){}var n=i.prototype=Object.create(e.prototype);n.bindStartEvent=function(t){this._bindStartEvent(t,!0)},n.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},n._bindStartEvent=function(e,i){var n=(i=void 0===i||i)?"addEventListener":"removeEventListener",r="mousedown";t.PointerEvent?r="pointerdown":"ontouchstart"in t&&(r="touchstart"),e[n](r,this)},n.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},n.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},n.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},n.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},n.onpointerdown=function(t){this._pointerDown(t,t)},n._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},n.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var r={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return n._bindPostStartEvents=function(e){if(e){var i=r[e.type];i.forEach((function(e){t.addEventListener(e,this)}),this),this._boundPointerEvents=i}},n._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach((function(e){t.removeEventListener(e,this)}),this),delete this._boundPointerEvents)},n.onmousemove=function(t){this._pointerMove(t,t)},n.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},n.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},n._pointerMove=function(t,e){this.pointerMove(t,e)},n.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},n.onmouseup=function(t){this._pointerUp(t,t)},n.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},n.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},n._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},n._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},n._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},n.pointerDone=function(){},n.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},n.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},n._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},n.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},i.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},i}(o,t)}.apply(e,n))||(t.exports=r)}(window)},16:function(t,e,i){var n,r;"undefined"!=typeof window&&window,void 0===(r="function"==typeof(n=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r];n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})?n.call(e,i,e,t):n)||(t.exports=r)},18:function(t,e){t.exports='<div class="m-control m-attributetable-container">\n    <div class="m-attributetable-panel">\n        <div class="title">Tabla de Atributos</div>\n        <div class="m-attributetable-container-select">\n            <p class="m-attributetable-headers">Capas disponibles <span id="m-attributetable-layer" class="g-cartografia-flecha-abajo"></span></p>\n            <select class="" id="m-attributetable-select">\n                <option disabled="disabled" selected="selected">Seleccione una capa...</option>\n                {{#each layers}}\n                    <option name="{{this.id}}">{{this.name}}</option>\n                {{/each}}\n                <select>\n                    <button class="" id="m-zoom-selected">Zoom selección</button>\n        </div>\n        <div id="m-attributetable-datas"></div>\n    </div>\n</div>'},19:function(t,e){t.exports='<div id="m-attributetable-content-attributes">\n    <div class="m-attributetable-headers">\n        <span id="m-attributetable-refresh" class="g-cartografia-flecha-deshacer"></span> Tabla Atributos\n        <span id="m-attributetable-attributes" class="g-cartografia-flecha-abajo"></span>\n    </div>\n    {{#if attributes}}\n        <div id="m-attributetable-table">\n            <table>\n                <tbody>\n                    <tr class="m-attributetable-thead">\n                        <td><input type="checkbox" name="selectAll" value="selectAll" {{#if this.allSelected}} checked="true" {{/if}} {{#if this.disableChecks}} disabled="true" {{/if}}></td>\n                        {{#each headerAtt}}\n                            <td>{{this}}</td>\n                        {{/each}}\n                    </tr> {{#each attributes}}\n                        <tr>\n                            <td><input type="checkbox" {{#if this.seleccionado}} checked="true" {{/if}} {{#if this.disableChecks}} disabled="true" {{/if}} id="m-check-select" name="" value="{{this.id}}"></td>\n                            {{#each this.properties}}\n                                <td> {{{this}}}</td>\n                            {{/each}}\n                        </tr>\n                    {{/each}}\n                </tbody>\n            </table>\n        </div>\n        <div id="m-attributetable-tfoot">\n            <span class="g-cartografia-flecha-izquierda m-attributetable-hidden" id="m-attributetable-previous"></span>\n            <span>Página {{pages.actual}} de {{pages.total}}</span>\n            <span class="g-cartografia-flecha-derecha m-attributetable-hidden" id="m-attributetable-next"></span>\n        </div>\n    {{else}}\n        <div class="m-attributetable-notResult">No se han encontrado atributos.</div>\n    {{/if}}\n</div>'},20:function(t){t.exports=JSON.parse('{"url":{"name":"attributetable","separator":"*"},"constructor":"M.plugin.AttributeTable","parameters":[{"type":"object","properties":[{"type":"simple","name":"pages","position":0}]}],"files":{"ol":{"scripts":["attributetable-2.1.0.ol.min.js"],"styles":["attributetable-2.1.0.min.css"]}},"metadata":{"uuid_plugin":"","uuid_version_plugin":"","version_ficha_metadatos":"","name":"Attributable","description":"Shows a table of all the attributes of each feature of a vector layer.","text":"","version":"2.1.0","date":"01/09/2022","author":"Junta de Andalucía","org":"Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","buttons":[{"title":"","description":"","querySelector":""},{"title":"","description":"","querySelector":""}],"dependencies":{"modules":["",""],"plugins":[{"uuid":"","name":""}],"services":[{"name":"","description":""}]},"compatibility":["6"]}}')},54:function(t,e,i){},78:function(t,e,i){"use strict";i.r(e);i(54);var n=i(8),r=i.n(n);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,i){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(t,e,i||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=d(t);if(e){var r=d(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h(this,i)}}function h(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(o,M.impl.Control);var e,i,n,r=u(o);function o(){return a(this,o),r.apply(this,arguments)}return e=o,(i=[{key:"addTo",value:function(t,e){l(d(o.prototype),"addTo",this).call(this,t,e)}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this)}}])&&s(e.prototype,i),n&&s(e,n),o}();p.PANEL_ID="m-attibutetable-panel";var f=i(18),g=i.n(f),y=i(19),v=i.n(y);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=E(t);if(e){var r=E(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return S(this,i)}}function S(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(a,M.Control);var e,i,n,o=P(a);function a(t,e){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=new p,r=[null,!1,null,null,null,t,null];return(i=o.call(this,n,"attributetableControl")).facadeMap_=r[0],i.selectAllActive_=r[1],i.template_=r[2],i.areaTable_=r[3],i.layer_=r[4],i.numPages_=r[5],i.draggable_=r[6],i.pages_={total:0,actual:1,element:0},i.sortProperties_={active:!1,sortBy:null,sortType:null},i.featuresSeleccionados=[],i.originalStyles=[],M.utils.isNullOrEmpty(e)?i.selectedStyle=new M.style.Generic({point:{radius:5,fill:{color:"yellow",opacity:1},stroke:{color:"red",width:2}},polygon:{fill:{color:"yellow",opacity:.6},stroke:{color:"red",width:1}},line:{stroke:{color:"red",width:1},fill:{color:"yellow",width:2,opacity:.8}}}):i.selectedStyle=e,M.utils.isUndefined(p)&&M.exception("La implementación usada no puede crear controles AttributeTableControl"),i}return e=a,(i=[{key:"createView",value:function(t){var e=this;this.facadeMap_=t;var i={jsonp:!0,vars:{layers:t.getWFS().concat(t.getKML().concat(t.getMVT().concat(t.getLayers().filter((function(t){return"GeoJSON"===t.type})))))}},n=M.template.compileSync(g.a,i),r=this.getPanel();if(!M.utils.isNullOrEmpty(r)){var o=r.getTemplatePanel();o.querySelector(".g-cartografia-localizacion4").addEventListener("click",(function(){e.getPanel().isCollapsed()&&(o.style.removeProperty("left"),o.style.removeProperty("top")),M.window.WIDTH>=M.config.MOBILE_WIDTH&&(e.getPanel().isCollapsed()?e.deactivateDraggable_():e.activateDraggable_())})),this.template_=n,this.areaTable_=n.querySelector("div#m-attributetable-datas"),n.querySelector("#m-attributetable-layer").addEventListener("click",this.openPanel_.bind(this)),n.querySelector("#m-zoom-selected").addEventListener("click",this.zoomToSelected.bind(this)),n.querySelector("#m-attributetable-select").addEventListener("change",(function(t){e.pages_={total:0,actual:1,element:0},e.sortProperties_={active:!1,sortBy:null,sortType:null},e.layer_&&e.layer_.getFeatures().filter((function(t){return e.featuresSeleccionados.includes(t.getId())})).forEach((function(t){t.setStyle(e.originalStyles[t.getId()])})),e.featuresSeleccionados=[],e.originalStyles=[],e.selectAllActive_=!1,e.renderPanel_(t.target[t.target.selectedIndex].getAttribute("name"))}))}return n}},{key:"zoomToSelected",value:function(t){var e=this,i=[];this.layer_.getFeatures().forEach((function(t){e.featuresSeleccionados.includes(t.getId())&&i.push(t)}));var n=this.facadeMap_.getProjection().code,r=M.impl.utils.getFeaturesExtent(i,n);M.utils.isNullOrEmpty(r)||this.facadeMap_.setBbox(r)}},{key:"refresh_",value:function(){this.renderPanel_()}},{key:"renderPanel_",value:function(t){var e,i=this;M.utils.isNullOrEmpty(t)||(this.layer_=this.hasLayer_(t)[0]);var n=[],r=this.layer_.getFeatures();M.utils.isNullOrEmpty(r)||(e=Object.keys(r[0].getAttributes()),r.forEach((function(t){var e=Object.values(t.getAttributes()),r=t.getId(),o=!1,a=!1;i.featuresSeleccionados.includes(r)&&(o=!0),i.layer_ instanceof M.layer.MVT&&(a=!0),M.utils.isNullOrEmpty(e)||n.push({properties:e,id:r,seleccionado:o,disableChecks:a})})),this.sortProperties_.active&&(n=this.sortAttributes_(n,e)));var o={},a=!1;this.layer_ instanceof M.layer.MVT&&(a=!0),M.utils.isUndefined(e)||(o={headerAtt:e,legend:this.layer_.legend,pages:this.pageResults_(n),attributes:!M.utils.isNullOrEmpty(n)&&n.slice(this.pages_.element,this.pages_.element+this.numPages_),allSelected:this.selectAllActive_,disableChecks:a});var s={jsonp:!0,vars:o},l=M.template.compileSync(v.a,s),c=this.areaTable_.querySelector("table");M.utils.isNullOrEmpty(c)||this.areaTable_.removeChild(this.areaTable_.querySelector("#m-attributetable-content-attributes"));var u=this.areaTable_.querySelector(".m-attributetable-notResult");if(M.utils.isNullOrEmpty(u)||this.areaTable_.querySelector("#m-attributetable-content-attributes").parentElement.removeChild(this.areaTable_.querySelector("#m-attributetable-content-attributes")),this.areaTable_.appendChild(l),M.utils.isNullOrEmpty(l.querySelector("div.m-attributetable-notResult"))){this.areaTable_.querySelector("#m-attributetable-next").addEventListener("click",this.nextPage_.bind(this)),l.querySelector("#m-attributetable-previous").addEventListener("click",this.previousPage_.bind(this)),l.querySelector("input[value=selectAll]").addEventListener("click",this.selectAll.bind(this)),l.querySelector("#m-attributetable-attributes").addEventListener("click",this.openPanel_.bind(this)),l.querySelector("#m-attributetable-refresh").addEventListener("click",this.refresh_.bind(this));for(var h=l.querySelectorAll("#m-check-select"),d=0;d<h.length;d+=1)h[d].addEventListener("change",this.markSelected.bind(this));Array.prototype.slice.call(this.areaTable_.querySelector("tr").querySelectorAll("td"),1).forEach((function(t){t.addEventListener("click",i.sort_.bind(i))})),this.hasNext_(l),this.hasPrevious_(l)}else l.querySelector("#m-attributetable-refresh").addEventListener("click",this.refresh_.bind(this));return this.rePosition_(),l}},{key:"markSelected",value:function(t){var e=this.layer_.getFeatures().filter((function(e){return e.getId()===t.target.value}));t.target.checked?(this.featuresSeleccionados.push(t.target.value),e.length>0&&(this.originalStyles[t.target.value]=e[0].getStyle(),e[0].setStyle(this.selectedStyle))):(this.featuresSeleccionados.remove(t.target.value),e.length>0&&e[0].setStyle(this.originalStyles[t.target.value]))}},{key:"hasLayer_",value:function(t){var e=[];return!M.utils.isNullOrEmpty(t)&&(M.utils.isArray(t)||M.utils.isString(t)||t instanceof M.Layer)?(M.utils.isString(t)&&this.facadeMap_.getLayers().forEach((function(i){i.id===t&&e.push(i)})),t instanceof M.Layer&&this.facadeMap_.getLayers().forEach((function(i){i.equals(t)&&e.push(i)})),M.utils.isArray(t)&&this.facadeMap_.getLayers().forEach((function(i){t.indexOf(i.id)>=0&&e.push(i)})),e):(M.dialog.error("El parametro para el método hasLayer no es correcto.","Error"),e)}},{key:"selectAll",value:function(){this.selectAllActive_=!this.selectAllActive_,!0===this.selectAllActive_?this.addSelectAll_():this.removeSelectAll_()}},{key:"addSelectAll_",value:function(){var t=this;this.layer_.getFeatures().forEach((function(e){var i=e.getId();t.featuresSeleccionados.includes(i)||(t.featuresSeleccionados.push(i),t.originalStyles[i]=e.getStyle(),e.setStyle(t.selectedStyle))})),this.renderPanel_()}},{key:"removeSelectAll_",value:function(){var t=this;this.featuresSeleccionados=[],this.layer_.getFeatures().forEach((function(e){var i=e.getId();e.setStyle(t.originalStyles[i])})),this.renderPanel_()}},{key:"pageResults_",value:function(t){return this.pages_.total=Math.ceil(t.length/this.numPages_),this.pages_}},{key:"nextPage_",value:function(){this.pages_.total>this.pages_.actual&&(this.pages_.actual=this.pages_.actual+1,this.pages_.element=this.pages_.element+this.numPages_,this.renderPanel_(),this.renderPanel_()&&(this.hasNext_(),this.hasPrevious_()))}},{key:"previousPage_",value:function(){this.pages_.total>=this.pages_.actual&&(this.pages_.actual=this.pages_.actual-1,this.pages_.element=this.pages_.element-this.numPages_,this.renderPanel_(),this.renderPanel_()&&this.hasPrevious_())}},{key:"hasNext_",value:function(t){var e=this.template_;M.utils.isNullOrEmpty(t)||(e=t),this.pages_.actual<this.pages_.total&&e.querySelector("#m-attributetable-next").classList.remove("m-attributetable-hidden")}},{key:"hasPrevious_",value:function(t){var e=this.template_;M.utils.isNullOrEmpty(t)||(e=t),this.pages_.actual<=this.pages_.total&&1!==this.pages_.actual&&e.querySelector("#m-attributetable-previous").classList.remove("m-attributetable-hidden")}},{key:"sort_",value:function(t){!1===this.sortProperties_.active&&(this.sortProperties_.active=!0),this.sortProperties_.sortBy!==t.target.innerHTML?this.sortProperties_.sortType="<":this.sortProperties_.sortType=">"===this.sortProperties_.sortType?"<":">",this.sortProperties_.sortBy=t.target.innerHTML,this.renderPanel_()}},{key:"sortAttributes_",value:function(t,e){var i=this.sortProperties_.sortBy,n=e.indexOf(i),r=t.sort((function(t,e){return t.properties[n].localeCompare(e.properties[n])}));return">"===this.sortProperties_.sortType&&(r=r.reverse()),r}},{key:"openPanel_",value:function(t){var e=t.target.id;if("m-attributetable-layer"===e){var i=this.template_.querySelector("select#m-attributetable-select");i.classList.toggle("m-attributetable-hidden"),i.classList.toggle("show")}else"m-attributetable-attributes"===e&&(this.template_.querySelector("#m-attributetable-table").classList.toggle("m-attributetable-hidden"),this.template_.querySelector("#m-attributetable-tfoot").classList.toggle("m-attributetable-hidden"));this.rePosition_()}},{key:"activateDraggable_",value:function(){if(M.utils.isNullOrEmpty(this.draggable_)){var t=this.getPanel().getTemplatePanel();this.draggable_=new r.a(t,{containment:".m-mapea-container",handle:".m-attributetable-container>div.m-attributetable-panel div.title"})}this.draggable_.enable()}},{key:"deactivateDraggable_",value:function(){document.querySelector(".m-attributetable").style.position="relative",this.draggable_.disable()}},{key:"rePosition_",value:function(){var t=this.getPanel().getTemplatePanel();parseInt(t.style.left.replace("px",""),10)+t.clientWidth>document.querySelector(".m-mapea-container").clientWidth&&(t.style.left="".concat(document.querySelector(".m-mapea-container").clientWidth-t.clientWidth,"px")),parseInt(t.style.top.replace("px",""),10)+t.clientHeight>document.querySelector(".m-mapea-container").clientHeight&&(t.style.top="".concat(document.querySelector(".m-mapea-container").clientHeight-t.clientHeight-10,"px"))}},{key:"equals",value:function(t){return t instanceof a}}])&&m(e.prototype,i),n&&m(e,n),a}(),x=i(20);function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=C(t);if(e){var r=C(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return L(this,i)}}function L(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(o,M.Plugin);var e,i,n,r=A(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O(this,o);var i=[null,null,null];return(t=r.call(this)).control_=i[0],t.panel_=i[1],t.facadeMap_=i[2],t.numPages_=parseInt(!M.utils.isNullOrEmpty(e.pages)&&e.pages>=1&&e.pages%1==0?e.pages:M.config.ATTRIBUTETABLE_PAGES,10),t.name=o.NAME,t.metadata_=x.metadata,t.idAddedLayer="",t.added_to_map=!0,t.userSelectedStyle=e.selectedStyle,t}return e=o,(i=[{key:"addTo",value:function(t){var e=this;this.idAddedLayer=t.on(M.evt.ADDED_LAYER,(function(){e.destroy(),e.add(t)})),this.add(t)}},{key:"add",value:function(t){var e=this;this.facadeMap_=t,this.control_=new w(this.numPages_,this.userSelectedStyle),this.control_.on(M.evt.ADDED_TO_MAP,(function(){e.added_to_map&&(e.fire(M.evt.ADDED_TO_MAP),e.added_to_map=!1)})),this.panel_=new M.ui.Panel(o.NAME,{collapsible:!0,className:"m-attributetable",collapsedButtonClass:"g-cartografia-localizacion4",position:M.ui.position.TR,tooltip:"Tabla de atributos"}),this.panel_.addControls(this.control_),this.panel_.on(M.evt.SHOW,(function(i){0===t.getWFS().length&&0===t.getKML().length&&0===t.getLayers().filter((function(t){return"GeoJSON"===t.type}))&&(e.panel_.collapse(),M.dialog.info("No existen capas consultables."))})),t.addPanels(this.panel_)}},{key:"destroy",value:function(){this.facadeMap_.unByKey(M.evt.ADDED_LAYER,this.idAddedLayer),this.facadeMap_.removeControls([this.control_]);var t=[null,null,null];this.control_=t[0],this.panel_=t[1],this.facadeMap_=t[2]}},{key:"getControls",value:function(){var t=[];return t.push(this.control_),t}},{key:"getAPIRest",value:function(){return"attributetable"}},{key:"getMetadata",value:function(){return this.metadata_}}])&&k(e.prototype,i),n&&k(e,n),o}();j.NAME="attributetable",null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.AttributeTable=j},8:function(t,e,i){var n,r;
/*!
 * Draggabilly v2.2.0
 * Make that shiz draggable
 * https://draggabilly.desandro.com
 * MIT license
 */!function(o,a){n=[i(13),i(14)],void 0===(r=function(t,e){return function(t,e,i){"use strict";function n(t,e){for(var i in e)t[i]=e[i];return t}var r=t.jQuery;function o(t,e){this.element="string"==typeof t?document.querySelector(t):t,r&&(this.$element=r(this.element)),this.options=n({},this.constructor.defaults),this.option(e),this._create()}var a=o.prototype=Object.create(i.prototype);o.defaults={},a.option=function(t){n(this.options,t)};var s={relative:!0,absolute:!0,fixed:!0};function l(t,e,i){return i=i||"round",e?Math[i](t/e)*e:t}a._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=n({},this.position);var t=getComputedStyle(this.element);s[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},a.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},a.dispatchEvent=function(t,e,i){var n=[e].concat(i);this.emitEvent(t,n),this.dispatchJQueryEvent(t,e,i)},a.dispatchJQueryEvent=function(e,i,n){var r=t.jQuery;if(r&&this.$element){var o=r.Event(i);o.type=e,this.$element.trigger(o,n)}},a._getPosition=function(){var t=getComputedStyle(this.element),e=this._getPositionCoord(t.left,"width"),i=this._getPositionCoord(t.top,"height");this.position.x=isNaN(e)?0:e,this.position.y=isNaN(i)?0:i,this._addTransformPosition(t)},a._getPositionCoord=function(t,i){if(-1!=t.indexOf("%")){var n=e(this.element.parentNode);return n?parseFloat(t)/100*n[i]:0}return parseInt(t,10)},a._addTransformPosition=function(t){var e=t.transform;if(0===e.indexOf("matrix")){var i=e.split(","),n=0===e.indexOf("matrix3d")?12:4,r=parseInt(i[n],10),o=parseInt(i[n+1],10);this.position.x+=r,this.position.y+=o}},a.onPointerDown=function(t,e){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[e])},a.dragStart=function(t,e){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[e]),this.animate())},a.measureContainment=function(){var t=this.getContainer();if(t){var i=e(this.element),n=e(t),r=this.element.getBoundingClientRect(),o=t.getBoundingClientRect(),a=n.borderLeftWidth+n.borderRightWidth,s=n.borderTopWidth+n.borderBottomWidth,l=this.relativeStartPosition={x:r.left-(o.left+n.borderLeftWidth),y:r.top-(o.top+n.borderTopWidth)};this.containSize={width:n.width-a-l.x-i.width,height:n.height-s-l.y-i.height}}},a.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},a.onPointerMove=function(t,e,i){this.dispatchJQueryEvent("pointerMove",t,[e,i])},a.dragMove=function(t,e,i){if(this.isEnabled){var n=i.x,r=i.y,o=this.options.grid,a=o&&o[0],s=o&&o[1];n=l(n,a),r=l(r,s),n=this.containDrag("x",n,a),r=this.containDrag("y",r,s),n="y"==this.options.axis?0:n,r="x"==this.options.axis?0:r,this.position.x=this.startPosition.x+n,this.position.y=this.startPosition.y+r,this.dragPoint.x=n,this.dragPoint.y=r,this.dispatchEvent("dragMove",t,[e,i])}},a.containDrag=function(t,e,i){if(!this.options.containment)return e;var n="x"==t?"width":"height",r=l(-this.relativeStartPosition[t],i,"ceil"),o=this.containSize[n];return o=l(o,i,"floor"),Math.max(r,Math.min(o,e))},a.onPointerUp=function(t,e){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[e])},a.dragEnd=function(t,e){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[e]))},a.animate=function(){if(this.isDragging){this.positionDrag();var t=this;requestAnimationFrame((function(){t.animate()}))}},a.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},a.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},a.staticClick=function(t,e){this.dispatchEvent("staticClick",t,[e])},a.setPosition=function(t,e){this.position.x=t,this.position.y=e,this.setLeftTop()},a.enable=function(){this.isEnabled=!0},a.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},a.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},a._init=function(){},r&&r.bridget&&r.bridget("draggabilly",o);return o}(o,t,e)}.apply(e,n))||(t.exports=r)}(window)}});