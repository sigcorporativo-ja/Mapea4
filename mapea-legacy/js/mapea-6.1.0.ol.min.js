!function(t){function e(e){for(var r,i,o=e[0],s=e[1],a=0,u=[];a<o.length;a++)i=o[a],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&u.push(n[i][0]),n[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);for(l&&l(e);u.length;)u.shift()()}var r={},n={0:0};function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var a=0;a<o.length;a++)e(o[a]);var l=s;i(i.s=108)}([function(t,e,r){"use strict";function n(){return function(){throw new Error("Unimplemented abstract method.")}()}r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return s}));var i=0;function o(t){return t.ol_uid||(t.ol_uid=String(++i))}var s="6.9.0"},function(t,e,r){"use strict";r.d(e,"e",(function(){return n})),r.d(e,"f",(function(){return o})),r.d(e,"d",(function(){return s})),r.d(e,"g",(function(){return a})),r.d(e,"h",(function(){return l})),r.d(e,"j",(function(){return u})),r.d(e,"a",(function(){return c})),r.d(e,"c",(function(){return h})),r.d(e,"b",(function(){return f})),r.d(e,"i",(function(){return p}));const n={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},i={};for(const t in n)n.hasOwnProperty(t)&&(i[n[t]]=parseInt(t,10));const o={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",297:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",3072:"SHORT",3073:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"},s=[i.BitsPerSample,i.ExtraSamples,i.SampleFormat,i.StripByteCounts,i.StripOffsets,i.StripRowCounts,i.TileByteCounts,i.TileOffsets,i.SubIFDs],a={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},l={};for(const t in a)a.hasOwnProperty(t)&&(l[a[t]]=parseInt(t,10));const u={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},c={Unspecified:0,Assocalpha:1,Unassalpha:2},h={Version:0,AddCompression:1},f={None:0,Deflate:1},p={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},d={};for(const t in p)p.hasOwnProperty(t)&&(d[p[t]]=parseInt(t,10))},function(t,e,r){"use strict";function n(t,e){for(const r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function i(t,e){if(t.length<e.length)return!1;return t.substr(t.length-e.length)===e}function o(t,e){const{length:r}=t;for(let n=0;n<r;n++)e(t[n],n)}function s(t){const e={};for(const r in t)if(t.hasOwnProperty(r)){e[t[r]]=r}return e}function a(t,e){const r=[];for(let n=0;n<t;n++)r.push(e(n));return r}async function l(t){return new Promise(e=>setTimeout(e,t))}function u(t,e){const r=Array.isArray(t)?t:Array.from(t),n=Array.isArray(e)?e:Array.from(e);return r.map((t,e)=>[t,n[e]])}r.d(e,"c",(function(){return n})),r.d(e,"d",(function(){return i})),r.d(e,"e",(function(){return o})),r.d(e,"f",(function(){return s})),r.d(e,"g",(function(){return a})),r.d(e,"h",(function(){return l})),r.d(e,"i",(function(){return u})),r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return f}));class c extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,c),this.name="AbortError"}}class h extends Error{constructor(t,e){super(e),this.errors=t,this.message=e,this.name="AggregateError"}}const f=h},function(t,e,r){(function(t){var r;
/**
 * @license
 *
 * chroma.js - JavaScript library for color conversions
 * 
 * Copyright (c) 2011-2017, Gregor Aisch
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */(function(){var n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,x,E,S,I,O,C,T,P,R,L,M,k,N,A,F,D,j,G,z,U,B,V,q,Y,W,X,H,Z,K,$,J,Q,tt,et,rt,nt,it,ot,st,at,lt,ut,ct,ht,ft,pt,dt,gt,yt,mt,_t,vt,bt,wt,xt,Et,St,It,Ot,Ct,Tt,Pt=[].slice;St=function(){var t,e,r,n,i;for(t={},n=0,e=(i="Boolean Number String Function Array Date RegExp Undefined Null".split(" ")).length;n<e;n++)r=i[n],t["[object "+r+"]"]=r.toLowerCase();return function(e){var r;return r=Object.prototype.toString.call(e),t[r]||"object"}}(),Z=function(t,e,r){return null==e&&(e=0),null==r&&(r=1),t<e&&(t=e),t>r&&(t=r),t},It=function(t){return t.length>=3?Array.prototype.slice.call(t):t[0]},E=function(t){var e,r;for(t._clipped=!1,t._unclipped=t.slice(0),e=r=0;r<3;e=++r)e<3?((t[e]<0||t[e]>255)&&(t._clipped=!0),t[e]<0&&(t[e]=0),t[e]>255&&(t[e]=255)):3===e&&(t[e]<0&&(t[e]=0),t[e]>1&&(t[e]=1));return t._clipped||delete t._unclipped,t},s=Math.PI,vt=Math.round,I=Math.cos,R=Math.floor,nt=Math.pow,K=Math.log,wt=Math.sin,xt=Math.sqrt,y=Math.atan2,Q=Math.max,g=Math.abs,u=2*s,a=s/3,i=s/180,l=180/s,(x=function(){return arguments[0]instanceof n?arguments[0]:function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,arguments,(function(){}))}).default=x,d=[],null!==t&&null!=t.exports&&(t.exports=x),void 0===(r=function(){return x}.apply(e,[]))||(t.exports=r),x.version="1.4.0",p={},h=[],f=!1,n=function(){function t(){var t,e,r,n,i,o,s,a,l;for(o=this,e=[],a=0,n=arguments.length;a<n;a++)null!=(t=arguments[a])&&e.push(t);if(e.length>1&&(s=e[e.length-1]),null!=p[s])o._rgb=E(p[s](It(e.slice(0,-1))));else{for(f||(h=h.sort((function(t,e){return e.p-t.p})),f=!0),l=0,i=h.length;l<i&&!(s=(r=h[l]).test.apply(r,e));l++);s&&(o._rgb=E(p[s].apply(p,e)))}null==o._rgb&&console.warn("unknown format: "+e),null==o._rgb&&(o._rgb=[0,0,0]),3===o._rgb.length&&o._rgb.push(1)}return t.prototype.toString=function(){return this.hex()},t}(),x._input=p,
/**
  	ColorBrewer colors for chroma.js
  
  	Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The 
  	Pennsylvania State University.
  
  	Licensed under the Apache License, Version 2.0 (the "License"); 
  	you may not use this file except in compliance with the License.
  	You may obtain a copy of the License at	
  	http://www.apache.org/licenses/LICENSE-2.0
  
  	Unless required by applicable law or agreed to in writing, software distributed
  	under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
  	CONDITIONS OF ANY KIND, either express or implied. See the License for the
  	specific language governing permissions and limitations under the License.
  
      @preserve
   */
x.brewer=b={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var t,e;for(t in e=[],b)e.push(b[t.toLowerCase()]=b[t])}(),x.colors=Ot={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},q=function(){var t,e,r,n,i,s,a;return n=(e=It(arguments))[0],t=e[1],r=e[2],s=(n+16)/116,i=isNaN(t)?s:s+t/500,a=isNaN(r)?s:s-r/200,s=o.Yn*Y(s),i=o.Xn*Y(i),a=o.Zn*Y(a),[Tt(3.2404542*i-1.5371385*s-.4985314*a),Tt(-.969266*i+1.8760108*s+.041556*a),r=Tt(.0556434*i-.2040259*s+1.0572252*a),e.length>3?e[3]:1]},Tt=function(t){return 255*(t<=.00304?12.92*t:1.055*nt(t,1/2.4)-.055)},Y=function(t){return t>o.t1?t*t*t:o.t2*(t-o.t0)},o={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ht=function(){var t,e,r,n,i,o,s;return r=(n=It(arguments))[0],e=n[1],t=n[2],o=(i=yt(r,e,t))[0],[116*(s=i[1])-16,500*(o-s),200*(s-i[2])]},mt=function(t){return(t/=255)<=.04045?t/12.92:nt((t+.055)/1.055,2.4)},Ct=function(t){return t>o.t3?nt(t,1/3):t/o.t2+o.t0},yt=function(){var t,e,r,n;return r=(n=It(arguments))[0],e=n[1],t=n[2],r=mt(r),e=mt(e),t=mt(t),[Ct((.4124564*r+.3575761*e+.1804375*t)/o.Xn),Ct((.2126729*r+.7151522*e+.072175*t)/o.Yn),Ct((.0193339*r+.119192*e+.9503041*t)/o.Zn)]},x.lab=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["lab"]),(function(){}))},p.lab=q,n.prototype.lab=function(){return ht(this._rgb)},m=function(t){var e,r,n,i,o,s,a,l,u,c,h;return 2===(t=function(){var e,r,n;for(n=[],r=0,e=t.length;r<e;r++)i=t[r],n.push(x(i));return n}()).length?(u=function(){var e,r,n;for(n=[],r=0,e=t.length;r<e;r++)i=t[r],n.push(i.lab());return n}(),o=u[0],s=u[1],e=function(t){var e,r;return r=function(){var r,n;for(n=[],e=r=0;r<=2;e=++r)n.push(o[e]+t*(s[e]-o[e]));return n}(),x.lab.apply(x,r)}):3===t.length?(c=function(){var e,r,n;for(n=[],r=0,e=t.length;r<e;r++)i=t[r],n.push(i.lab());return n}(),o=c[0],s=c[1],a=c[2],e=function(t){var e,r;return r=function(){var r,n;for(n=[],e=r=0;r<=2;e=++r)n.push((1-t)*(1-t)*o[e]+2*(1-t)*t*s[e]+t*t*a[e]);return n}(),x.lab.apply(x,r)}):4===t.length?(h=function(){var e,r,n;for(n=[],r=0,e=t.length;r<e;r++)i=t[r],n.push(i.lab());return n}(),o=h[0],s=h[1],a=h[2],l=h[3],e=function(t){var e,r;return r=function(){var r,n;for(n=[],e=r=0;r<=2;e=++r)n.push((1-t)*(1-t)*(1-t)*o[e]+3*(1-t)*(1-t)*t*s[e]+3*(1-t)*t*t*a[e]+t*t*t*l[e]);return n}(),x.lab.apply(x,r)}):5===t.length&&(r=m(t.slice(0,3)),n=m(t.slice(2,5)),e=function(t){return t<.5?r(2*t):n(2*(t-.5))}),e},x.bezier=function(t){var e;return(e=m(t)).scale=function(){return x.scale(e)},e},x.cubehelix=function(t,e,r,n,i){var o,s,a;return null==t&&(t=300),null==e&&(e=-1.5),null==r&&(r=1),null==n&&(n=1),null==i&&(i=[0,1]),o=0,"array"===St(i)?s=i[1]-i[0]:(s=0,i=[i,i]),(a=function(a){var l,c,h,f,p;return l=u*((t+120)/360+e*a),f=nt(i[0]+s*a,n),c=(0!==o?r[0]+a*o:r)*f*(1-f)/2,h=I(l),p=wt(l),x(E([255*(f+c*(-.14861*h+1.78277*p)),255*(f+c*(-.29227*h-.90649*p)),255*(f+c*(1.97294*h)),1]))}).start=function(e){return null==e?t:(t=e,a)},a.rotations=function(t){return null==t?e:(e=t,a)},a.gamma=function(t){return null==t?n:(n=t,a)},a.hue=function(t){return null==t?r:("array"===St(r=t)?0===(o=r[1]-r[0])&&(r=r[1]):o=0,a)},a.lightness=function(t){return null==t?i:("array"===St(t)?(i=t,s=t[1]-t[0]):(i=[t,t],s=0),a)},a.scale=function(){return x.scale(a)},a.hue(r),a},x.random=function(){var t,e;for("0123456789abcdef",t="#",e=0;e<6;++e)t+="0123456789abcdef".charAt(R(16*Math.random()));return new n(t)},d=[],D=function(t,e,r,n){var i,o,s,a;for(null==r&&(r=.5),null==n&&(n="rgb"),"object"!==St(t)&&(t=x(t)),"object"!==St(e)&&(e=x(e)),s=0,o=d.length;s<o;s++)if(n===(i=d[s])[0]){a=i[1](t,e,r,n);break}if(null==a)throw"color mode "+n+" is not supported";return a.alpha(t.alpha()+r*(e.alpha()-t.alpha()))},x.interpolate=D,n.prototype.interpolate=function(t,e,r){return D(this,t,e,r)},x.mix=D,n.prototype.mix=n.prototype.interpolate,p.rgb=function(){var t,e,r,n;for(t in r=[],e=It(arguments))n=e[t],r.push(n);return r},x.rgb=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["rgb"]),(function(){}))},n.prototype.rgb=function(t){return null==t&&(t=!0),t?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},n.prototype.rgba=function(t){return null==t&&(t=!0),t?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},h.push({p:3,test:function(t){var e;return e=It(arguments),"array"===St(e)&&3===e.length||4===e.length&&"number"===St(e[3])&&e[3]>=0&&e[3]<=1?"rgb":void 0}}),p.lrgb=p.rgb,z=function(t,e,r,i){var o,s;return o=t._rgb,s=e._rgb,new n(xt(nt(o[0],2)*(1-r)+nt(s[0],2)*r),xt(nt(o[1],2)*(1-r)+nt(s[1],2)*r),xt(nt(o[2],2)*(1-r)+nt(s[2],2)*r),i)},c=function(t){var e,r,i,o,s;for(e=1/t.length,s=[0,0,0,0],i=0,r=t.length;i<r;i++)o=t[i]._rgb,s[0]+=nt(o[0],2)*e,s[1]+=nt(o[1],2)*e,s[2]+=nt(o[2],2)*e,s[3]+=o[3]*e;return s[0]=xt(s[0]),s[1]=xt(s[1]),s[2]=xt(s[2]),s[3]>1&&(s[3]=1),new n(E(s))},d.push(["lrgb",z]),x.average=function(t,e){var r,n,i,o,a,l,u,h,f,p,d,g,m;if(null==e&&(e="rgb"),f=t.length,u=(t=t.map((function(t){return x(t)}))).splice(0,1)[0],"lrgb"===e)return c(t);for(h in o=[],a=0,l=0,g=u.get(e))g[h]=g[h]||0,o.push(isNaN(g[h])?0:1),"h"!==e.charAt(h)||isNaN(g[h])||(r=g[h]/180*s,a+=I(r),l+=wt(r));for(n=u.alpha(),d=0,p=t.length;d<p;d++)for(h in m=(i=t[d]).get(e),n+=i.alpha(),g)isNaN(m[h])||(o[h]+=1,"h"===e.charAt(h)?(r=m[h]/180*s,a+=I(r),l+=wt(r)):g[h]+=m[h]);for(h in g)if("h"===e.charAt(h)){for(r=y(l/o[h],a/o[h])/s*180;r<0;)r+=360;for(;r>=360;)r-=360;g[h]=r}else g[h]=g[h]/o[h];return x(g,e).alpha(n/f)},M=function(t){var e,r;if(t.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]),[(r=parseInt(t,16))>>16,r>>8&255,255&r,1];if(t.match(/^#?([A-Fa-f0-9]{8})$/))return 9===t.length&&(t=t.substr(1)),[(r=parseInt(t,16))>>24&255,r>>16&255,r>>8&255,vt((255&r)/255*100)/100];if(null!=p.css&&(e=p.css(t)))return e;throw"unknown color: "+t},at=function(t,e){var r,n,i,o,s,a;return null==e&&(e="auto"),s=t[0],i=t[1],n=t[2],r=t[3],"auto"===e&&(e=r<1?"rgba":"rgb"),s=Math.round(s),i=Math.round(i),n=Math.round(n),a=(a="000000"+(s<<16|i<<8|n).toString(16)).substr(a.length-6),o=(o="0"+vt(255*r).toString(16)).substr(o.length-2),"#"+function(){switch(e.toLowerCase()){case"rgba":return a+o;case"argb":return o+a;default:return a}}()},p.hex=function(t){return M(t)},x.hex=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["hex"]),(function(){}))},n.prototype.hex=function(t){return null==t&&(t="auto"),at(this._rgb,t)},h.push({p:4,test:function(t){if(1===arguments.length&&"string"===St(t))return"hex"}}),A=function(){var t,e,r,n,i,o,s,a,l,u,c,h,f,p;if(i=(t=It(arguments))[0],c=t[1],s=t[2],0===c)l=n=e=255*s;else{for(r=[0,0,0],h=2*s-(f=s<.5?s*(1+c):s+c-s*c),(p=[0,0,0])[0]=(i/=360)+1/3,p[1]=i,p[2]=i-1/3,o=a=0;a<=2;o=++a)p[o]<0&&(p[o]+=1),p[o]>1&&(p[o]-=1),6*p[o]<1?r[o]=h+6*(f-h)*p[o]:2*p[o]<1?r[o]=f:3*p[o]<2?r[o]=h+(f-h)*(2/3-p[o])*6:r[o]=h;l=(u=[vt(255*r[0]),vt(255*r[1]),vt(255*r[2])])[0],n=u[1],e=u[2]}return t.length>3?[l,n,e,t[3]]:[l,n,e]},ut=function(t,e,r){var n,i,o,s,a;return void 0!==t&&t.length>=3&&(t=(s=t)[0],e=s[1],r=s[2]),t/=255,e/=255,r/=255,o=Math.min(t,e,r),i=((Q=Math.max(t,e,r))+o)/2,Q===o?(a=0,n=Number.NaN):a=i<.5?(Q-o)/(Q+o):(Q-o)/(2-Q-o),t===Q?n=(e-r)/(Q-o):e===Q?n=2+(r-t)/(Q-o):r===Q&&(n=4+(t-e)/(Q-o)),(n*=60)<0&&(n+=360),[n,a,i]},x.hsl=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["hsl"]),(function(){}))},p.hsl=A,n.prototype.hsl=function(){return ut(this._rgb)},F=function(){var t,e,r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m;if(i=(t=It(arguments))[0],g=t[1],m=t[2],m*=255,0===g)l=n=e=m;else switch(360===i&&(i=0),i>360&&(i-=360),i<0&&(i+=360),s=m*(1-g),a=m*(1-g*(r=(i/=60)-(o=R(i)))),y=m*(1-g*(1-r)),o){case 0:l=(u=[m,y,s])[0],n=u[1],e=u[2];break;case 1:l=(c=[a,m,s])[0],n=c[1],e=c[2];break;case 2:l=(h=[s,m,y])[0],n=h[1],e=h[2];break;case 3:l=(f=[s,a,m])[0],n=f[1],e=f[2];break;case 4:l=(p=[y,s,m])[0],n=p[1],e=p[2];break;case 5:l=(d=[m,s,a])[0],n=d[1],e=d[2]}return[l,n,e,t.length>3?t[3]:1]},ct=function(){var t,e,r,n,i,o,s,a,l;return o=(s=It(arguments))[0],r=s[1],t=s[2],i=Math.min(o,r,t),e=(Q=Math.max(o,r,t))-i,l=Q/255,0===Q?(n=Number.NaN,a=0):(a=e/Q,o===Q&&(n=(r-t)/e),r===Q&&(n=2+(t-o)/e),t===Q&&(n=4+(o-r)/e),(n*=60)<0&&(n+=360)),[n,a,l]},x.hsv=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["hsv"]),(function(){}))},p.hsv=F,n.prototype.hsv=function(){return ct(this._rgb)},et=function(t){return"number"===St(t)&&t>=0&&t<=16777215?[t>>16,t>>8&255,255&t,1]:(console.warn("unknown num color: "+t),[0,0,0,1])},dt=function(){var t;return((t=It(arguments))[0]<<16)+(t[1]<<8)+t[2]},x.num=function(t){return new n(t,"num")},n.prototype.num=function(t){return null==t&&(t="rgb"),dt(this._rgb,t)},p.num=et,h.push({p:1,test:function(t){if(1===arguments.length&&"number"===St(t)&&t>=0&&t<=16777215)return"num"}}),L=function(){var t,e,r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v;if(a=(r=It(arguments))[0],i=r[1],e=r[2],s=s/100*255,t=255*(i/=100),0===i)h=s=n=e;else switch(360===a&&(a=0),a>360&&(a-=360),a<0&&(a+=360),c=(u=e*(1-i))+t*(1-(o=(a/=60)-(l=R(a)))),_=u+t*o,v=u+t,l){case 0:h=(f=[v,_,u])[0],s=f[1],n=f[2];break;case 1:h=(p=[c,v,u])[0],s=p[1],n=p[2];break;case 2:h=(d=[u,v,_])[0],s=d[1],n=d[2];break;case 3:h=(g=[u,c,v])[0],s=g[1],n=g[2];break;case 4:h=(y=[_,u,v])[0],s=y[1],n=y[2];break;case 5:h=(m=[v,u,c])[0],s=m[1],n=m[2]}return[h,s,n,r.length>3?r[3]:1]},st=function(){var t,e,r,n,i,o,s,a,l;return a=(l=It(arguments))[0],i=l[1],e=l[2],s=Math.min(a,i,e),r=100*(n=(Q=Math.max(a,i,e))-s)/255,t=s/(255-n)*100,0===n?o=Number.NaN:(a===Q&&(o=(i-e)/n),i===Q&&(o=2+(e-a)/n),e===Q&&(o=4+(a-i)/n),(o*=60)<0&&(o+=360)),[o,r,t]},x.hcg=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["hcg"]),(function(){}))},p.hcg=L,n.prototype.hcg=function(){return st(this._rgb)},O=function(t){var e,r,n,i,o,s,a,l;if(t=t.toLowerCase(),null!=x.colors&&x.colors[t])return M(x.colors[t]);if(o=t.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(a=o.slice(1,4),i=s=0;s<=2;i=++s)a[i]=+a[i];a[3]=1}else if(o=t.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(a=o.slice(1,5),i=l=0;l<=3;i=++l)a[i]=+a[i];else if(o=t.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(a=o.slice(1,4),i=e=0;e<=2;i=++e)a[i]=vt(2.55*a[i]);a[3]=1}else if(o=t.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(a=o.slice(1,5),i=r=0;r<=2;i=++r)a[i]=vt(2.55*a[i]);a[3]=+a[3]}else(o=t.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?((n=o.slice(1,4))[1]*=.01,n[2]*=.01,(a=A(n))[3]=1):(o=t.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&((n=o.slice(1,4))[1]*=.01,n[2]*=.01,(a=A(n))[3]=+o[4]);return a},ot=function(t){var e;return"rgb"===(e=t[3]<1?"rgba":"rgb")?e+"("+t.slice(0,3).map(vt).join(",")+")":"rgba"===e?e+"("+t.slice(0,3).map(vt).join(",")+","+t[3]+")":void 0},_t=function(t){return vt(100*t)/100},N=function(t,e){var r;return r=e<1?"hsla":"hsl",t[0]=_t(t[0]||0),t[1]=_t(100*t[1])+"%",t[2]=_t(100*t[2])+"%","hsla"===r&&(t[3]=e),r+"("+t.join(",")+")"},p.css=function(t){return O(t)},x.css=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["css"]),(function(){}))},n.prototype.css=function(t){return null==t&&(t="rgb"),"rgb"===t.slice(0,3)?ot(this._rgb):"hsl"===t.slice(0,3)?N(this.hsl(),this.alpha()):void 0},p.named=function(t){return M(Ot[t])},h.push({p:5,test:function(t){if(1===arguments.length&&null!=Ot[t])return"named"}}),n.prototype.name=function(t){var e,r;for(r in arguments.length&&(Ot[t]&&(this._rgb=M(Ot[t])),this._rgb[3]=1),e=this.hex("rgb"),Ot)if(e===Ot[r])return r;return e},W=function(){var t,e,r,n;return r=(n=It(arguments))[0],t=n[1],e=n[2],[r,I(e*=i)*t,wt(e)*t]},X=function(){var t,e,r,n,i,o,s,a,l;return s=(r=It(arguments))[0],i=r[1],o=r[2],t=(a=W(s,i,o))[0],e=a[1],n=a[2],[(l=q(t,e,n))[0],l[1],n=l[2],r.length>3?r[3]:1]},V=function(){var t,e,r,n,i,o;return i=(o=It(arguments))[0],t=o[1],e=o[2],r=xt(t*t+e*e),n=(y(e,t)*l+360)%360,0===vt(1e4*r)&&(n=Number.NaN),[i,r,n]},ft=function(){var t,e,r,n,i,o,s;return i=(o=It(arguments))[0],r=o[1],e=o[2],n=(s=ht(i,r,e))[0],t=s[1],e=s[2],V(n,t,e)},x.lch=function(){var t;return t=It(arguments),new n(t,"lch")},x.hcl=function(){var t;return t=It(arguments),new n(t,"hcl")},p.lch=X,p.hcl=function(){var t,e,r,n;return e=(n=It(arguments))[0],t=n[1],r=n[2],X([r,t,e])},n.prototype.lch=function(){return ft(this._rgb)},n.prototype.hcl=function(){return ft(this._rgb).reverse()},it=function(t){var e,r,n,i,o,s;return null==t&&(t="rgb"),o=(s=It(arguments))[0],n=s[1],e=s[2],n/=255,e/=255,[(1-(o/=255)-(i=1-Math.max(o,Math.max(n,e))))*(r=i<1?1/(1-i):0),(1-n-i)*r,(1-e-i)*r,i]},S=function(){var t,e,r,n,i,o;return r=(e=It(arguments))[0],i=e[1],o=e[2],n=e[3],t=e.length>4?e[4]:1,1===n?[0,0,0,t]:[r>=1?0:255*(1-r)*(1-n),i>=1?0:255*(1-i)*(1-n),o>=1?0:255*(1-o)*(1-n),t]},p.cmyk=function(){return S(It(arguments))},x.cmyk=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["cmyk"]),(function(){}))},n.prototype.cmyk=function(){return it(this._rgb)},p.gl=function(){var t,e,r,n,i;for(n=function(){var t,r;for(e in r=[],t=It(arguments))i=t[e],r.push(i);return r}.apply(this,arguments),t=r=0;r<=2;t=++r)n[t]*=255;return n},x.gl=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["gl"]),(function(){}))},n.prototype.gl=function(){var t;return[(t=this._rgb)[0]/255,t[1]/255,t[2]/255,t[3]]},pt=function(t,e,r){var n;return t=(n=It(arguments))[0],e=n[1],r=n[2],.2126*(t=$(t))+.7152*(e=$(e))+.0722*(r=$(r))},$=function(t){return(t/=255)<=.03928?t/12.92:nt((t+.055)/1.055,2.4)},B=function(t,e,r,i){var o,s;return o=t._rgb,s=e._rgb,new n(o[0]+r*(s[0]-o[0]),o[1]+r*(s[1]-o[1]),o[2]+r*(s[2]-o[2]),i)},d.push(["rgb",B]),n.prototype.luminance=function(t,e){var r,n,i,o,s;return null==e&&(e="rgb"),arguments.length?(o=this._rgb,0===t?o=[0,0,0,this._rgb[3]]:1===t?o=[255,255,255,this[3]]:(r=pt(this._rgb),n=1e-7,i=20,s=function(r,o){var a,l;return a=(l=r.interpolate(o,.5,e)).luminance(),Math.abs(t-a)<n||!i--?l:a>t?s(r,l):s(l,o)},o=r>t?s(x("black"),this).rgba():s(this,x("white")).rgba()),x(o).alpha(this.alpha())):pt(this._rgb)},Et=function(t){var e,r,n,i;return(i=t/100)<66?(n=255,r=-155.25485562709179-.44596950469579133*(r=i-2)+104.49216199393888*K(r),e=i<20?0:.8274096064007395*(e=i-10)-254.76935184120902+115.67994401066147*K(e)):(n=351.97690566805693+.114206453784165*(n=i-55)-40.25366309332127*K(n),r=325.4494125711974+.07943456536662342*(r=i-50)-28.0852963507957*K(r),e=255),[n,r,e]},gt=function(){var t,e,r,n,i,o,s,a;for(i=(o=It(arguments))[0],o[1],t=o[2],n=1e3,r=4e4,e=.4;r-n>e;)(s=Et(a=.5*(r+n)))[2]/s[0]>=t/i?r=a:n=a;return vt(a)},x.temperature=x.kelvin=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["temperature"]),(function(){}))},p.temperature=p.kelvin=p.K=Et,n.prototype.temperature=function(){return gt(this._rgb)},n.prototype.kelvin=n.prototype.temperature,x.contrast=function(t,e){var r,i,o,s;return"string"!==(o=St(t))&&"number"!==o||(t=new n(t)),"string"!==(s=St(e))&&"number"!==s||(e=new n(e)),(r=t.luminance())>(i=e.luminance())?(r+.05)/(i+.05):(i+.05)/(r+.05)},x.distance=function(t,e,r){var i,o,s,a,l,u,c;for(o in null==r&&(r="lab"),"string"!==(l=St(t))&&"number"!==l||(t=new n(t)),"string"!==(u=St(e))&&"number"!==u||(e=new n(e)),s=t.get(r),a=e.get(r),c=0,s)c+=(i=(s[o]||0)-(a[o]||0))*i;return Math.sqrt(c)},x.deltaE=function(t,e,r,i){var o,a,l,u,c,h,f,p,d,m,_,v,b,w,x,E,S,O,C,T,P,R,L,M;for(null==r&&(r=1),null==i&&(i=1),"string"!==(x=St(t))&&"number"!==x||(t=new n(t)),"string"!==(E=St(e))&&"number"!==E||(e=new n(e)),o=(S=t.lab())[0],l=S[1],c=S[2],a=(O=e.lab())[0],u=O[1],h=O[2],f=xt(l*l+c*c),p=xt(u*u+h*h),T=o<16?.511:.040975*o/(1+.01765*o),C=.0638*f/(1+.0131*f)+.638,w=f<1e-6?0:180*y(c,l)/s;w<0;)w+=360;for(;w>=360;)w-=360;return P=w>=164&&w<=345?.56+g(.2*I(s*(w+168)/180)):.36+g(.4*I(s*(w+35)/180)),b=xt((d=f*f*f*f)/(d+1900)),xt((R=(o-a)/(r*T))*R+(L=(v=f-p)/(i*C))*L+((m=l-u)*m+(_=c-h)*_-v*v)/((M=C*(b*P+1-b))*M))},n.prototype.get=function(t){var e,r,n,i,o;return this,n=(i=t.split("."))[0],e=i[1],o=this[n](),e?(r=n.indexOf(e))>-1?o[r]:console.warn("unknown channel "+e+" in mode "+n):o},n.prototype.set=function(t,e){var r,n,i,o,s;if(this,i=(o=t.split("."))[0],r=o[1])if(s=this[i](),(n=i.indexOf(r))>-1)if("string"===St(e))switch(e.charAt(0)){case"+":case"-":s[n]+=+e;break;case"*":s[n]*=+e.substr(1);break;case"/":s[n]/=+e.substr(1);break;default:s[n]=+e}else s[n]=e;else console.warn("unknown channel "+r+" in mode "+i);else s=e;return x(s,i).alpha(this.alpha())},n.prototype.clipped=function(){return this._rgb._clipped||!1},n.prototype.alpha=function(t){return arguments.length?x.rgb([this._rgb[0],this._rgb[1],this._rgb[2],t]):this._rgb[3]},n.prototype.darken=function(t){var e;return null==t&&(t=1),this,(e=this.lab())[0]-=o.Kn*t,x.lab(e).alpha(this.alpha())},n.prototype.brighten=function(t){return null==t&&(t=1),this.darken(-t)},n.prototype.darker=n.prototype.darken,n.prototype.brighter=n.prototype.brighten,n.prototype.saturate=function(t){var e;return null==t&&(t=1),this,(e=this.lch())[1]+=t*o.Kn,e[1]<0&&(e[1]=0),x.lch(e).alpha(this.alpha())},n.prototype.desaturate=function(t){return null==t&&(t=1),this.saturate(-t)},n.prototype.premultiply=function(){var t,e;return e=this.rgb(),t=this.alpha(),x(e[0]*t,e[1]*t,e[2]*t,t)},tt=function(t,e){return t*e/255},C=function(t,e){return t>e?e:t},H=function(t,e){return t>e?t:e},bt=function(t,e){return 255*(1-(1-t/255)*(1-e/255))},rt=function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))},w=function(t,e){return 255*(1-(1-e/255)/(t/255))},T=function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t},(_=function(t,e,r){if(!_[r])throw"unknown blend mode "+r;return _[r](t,e)}).normal=(v=function(t){return function(e,r){var n,i;return n=x(r).rgb(),i=x(e).rgb(),x(t(n,i),"rgb")}})((P=function(t){return function(e,r){var n,i,o;for(o=[],n=i=0;i<=3;n=++i)o[n]=t(e[n],r[n]);return o}})((function(t,e){return t}))),_.multiply=v(P(tt)),_.screen=v(P(bt)),_.overlay=v(P(rt)),_.darken=v(P(C)),_.lighten=v(P(H)),_.dodge=v(P(T)),_.burn=v(P(w)),x.blend=_,x.analyze=function(t){var e,r,n,i;for(n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},r=0,e=t.length;r<e;r++)null==(i=t[r])||isNaN(i)||(n.values.push(i),n.sum+=i,i<n.min&&(n.min=i),i>n.max&&(n.max=i),n.count+=1);return n.domain=[n.min,n.max],n.limits=function(t,e){return x.limits(n,t,e)},n},x.scale=function(t,e){var r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,E;return c="rgb",h=x("#ccc"),g=0,!1,s=[0,1],d=[],p=[0,0],r=!1,i=[],f=!1,u=0,l=1,o=!1,n={},y=!0,a=1,w=function(t){var e,r,n,o,s,a;if(null==t&&(t=["#fff","#000"]),null!=t&&"string"===St(t)&&null!=x.brewer&&(t=x.brewer[t]||x.brewer[t.toLowerCase()]||t),"array"===St(t)){for(1===t.length&&(t=[t[0],t[0]]),e=n=0,o=(t=t.slice(0)).length-1;0<=o?n<=o:n>=o;e=0<=o?++n:--n)r=t[e],"string"===St(r)&&(t[e]=x(r));for(d.length=0,e=a=0,s=t.length-1;0<=s?a<=s:a>=s;e=0<=s?++a:--a)d.push(e/(t.length-1))}return b(),i=t},_=function(t){var e,n;if(null!=r){for(n=r.length-1,e=0;e<n&&t>=r[e];)e++;return e-1}return 0},E=function(t){return t},function(t){var e,n,i,o,s;return s=t,r.length>2&&(o=r.length-1,e=_(t),i=r[0]+(r[1]-r[0])*(0+.5*g),n=r[o-1]+(r[o]-r[o-1])*(1-.5*g),s=u+(r[e]+.5*(r[e+1]-r[e])-i)/(n-i)*(l-u)),s},v=function(t,e){var o,s,f,g,m,v,b;if(null==e&&(e=!1),isNaN(t))return h;if(b=e?t:r&&r.length>2?_(t)/(r.length-2):l!==u?(t-u)/(l-u):1,e||(b=E(b)),1!==a&&(b=nt(b,a)),b=p[0]+b*(1-p[0]-p[1]),b=Math.min(1,Math.max(0,b)),f=Math.floor(1e4*b),y&&n[f])o=n[f];else{if("array"===St(i))for(s=g=0,v=d.length-1;0<=v?g<=v:g>=v;s=0<=v?++g:--g){if(b<=(m=d[s])){o=i[s];break}if(b>=m&&s===d.length-1){o=i[s];break}if(b>m&&b<d[s+1]){b=(b-m)/(d[s+1]-m),o=x.interpolate(i[s],i[s+1],b,c);break}}else"function"===St(i)&&(o=i(b));y&&(n[f]=o)}return o},b=function(){return n={}},w(t),(m=function(t){var e;return e=x(v(t)),f&&e[f]?e[f]():e}).classes=function(t){var e;return null!=t?("array"===St(t)?(r=t,s=[t[0],t[t.length-1]]):(e=x.analyze(s),r=0===t?[e.min,e.max]:x.limits(e,"e",t)),m):r},m.domain=function(t){var e,r,n,o,a,c,h;if(!arguments.length)return s;if(u=t[0],l=t[t.length-1],d=[],n=i.length,t.length===n&&u!==l)for(a=0,o=t.length;a<o;a++)r=t[a],d.push((r-u)/(l-u));else for(e=h=0,c=n-1;0<=c?h<=c:h>=c;e=0<=c?++h:--h)d.push(e/(n-1));return s=[u,l],m},m.mode=function(t){return arguments.length?(c=t,b(),m):c},m.range=function(t,e){return w(t),m},m.out=function(t){return f=t,m},m.spread=function(t){return arguments.length?(g=t,m):g},m.correctLightness=function(t){return null==t&&(t=!0),o=t,b(),E=o?function(t){var e,r,n,i,o,s,a,l,u;for(e=v(0,!0).lab()[0],r=v(1,!0).lab()[0],a=e>r,n=v(t,!0).lab()[0],i=n-(o=e+(r-e)*t),l=0,u=1,s=20;Math.abs(i)>.01&&s-- >0;)a&&(i*=-1),i<0?(l=t,t+=.5*(u-t)):(u=t,t+=.5*(l-t)),n=v(t,!0).lab()[0],i=n-o;return t}:function(t){return t},m},m.padding=function(t){return null!=t?("number"===St(t)&&(t=[t,t]),p=t,m):p},m.colors=function(e,n){var o,a,l,u,c,h,f,p;if(arguments.length<2&&(n="hex"),c=[],0===arguments.length)c=i.slice(0);else if(1===e)c=[m(.5)];else if(e>1)a=s[0],o=s[1]-a,c=function(){h=[];for(var t=0;0<=e?t<e:t>e;0<=e?t++:t--)h.push(t);return h}.apply(this).map((function(t){return m(a+t/(e-1)*o)}));else{if(t=[],f=[],r&&r.length>2)for(l=p=1,u=r.length;1<=u?p<u:p>u;l=1<=u?++p:--p)f.push(.5*(r[l-1]+r[l]));else f=s;c=f.map((function(t){return m(t)}))}return x[n]&&(c=c.map((function(t){return t[n]()}))),c},m.cache=function(t){return null!=t?(y=t,m):y},m.gamma=function(t){return null!=t?(a=t,m):a},m},null==x.scales&&(x.scales={}),x.scales.cool=function(){return x.scale([x.hsl(180,1,.9),x.hsl(250,.7,.4)])},x.scales.hot=function(){return x.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},x.analyze=function(t,e,r){var n,i,o,s,a,l;if(a={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==r&&(r=function(){return!0}),n=function(t){null==t||isNaN(t)||(a.values.push(t),a.sum+=t,t<a.min&&(a.min=t),t>a.max&&(a.max=t),a.count+=1)},l=function(t,i){if(r(t,i))return null!=e&&"function"===St(e)?n(e(t)):null!=e&&"string"===St(e)||"number"===St(e)?n(t[e]):n(t)},"array"===St(t))for(s=0,o=t.length;s<o;s++)l(t[s]);else for(i in t)l(t[i],i);return a.domain=[a.min,a.max],a.limits=function(t,e){return x.limits(a,t,e)},a},x.limits=function(t,e,r){var n,i,o,s,a,l,u,c,h,f,p,d,y,m,_,v,b,w,E,S,I,O,C,T,P,L,M,k,N,A,F,D,j,G,z,U,B,V,q,Y,W,X,H,Z,$,J,tt,et,rt,it,ot,st,at,lt,ut;if(null==e&&(e="equal"),null==r&&(r=7),"array"===St(t)&&(t=x.analyze(t)),P=t.min,Q=t.max,t.sum,lt=t.values.sort((function(t,e){return t-e})),1===r)return[P,Q];if(C=[],"c"===e.substr(0,1)&&(C.push(P),C.push(Q)),"e"===e.substr(0,1)){for(C.push(P),S=F=1,z=r-1;1<=z?F<=z:F>=z;S=1<=z?++F:--F)C.push(P+S/r*(Q-P));C.push(Q)}else if("l"===e.substr(0,1)){if(P<=0)throw"Logarithmic scales are only possible for values > 0";for(L=Math.LOG10E*K(P),T=Math.LOG10E*K(Q),C.push(P),S=ut=1,U=r-1;1<=U?ut<=U:ut>=U;S=1<=U?++ut:--ut)C.push(nt(10,L+S/r*(T-L)));C.push(Q)}else if("q"===e.substr(0,1)){for(C.push(P),S=n=1,X=r-1;1<=X?n<=X:n>=X;S=1<=X?++n:--n)D=(lt.length-1)*S/r,(j=R(D))===D?C.push(lt[j]):(G=D-j,C.push(lt[j]*(1-G)+lt[j+1]*G));C.push(Q)}else if("k"===e.substr(0,1)){for(k=lt.length,m=new Array(k),w=new Array(r),it=!0,N=0,v=null,(v=[]).push(P),S=i=1,H=r-1;1<=H?i<=H:i>=H;S=1<=H?++i:--i)v.push(P+S/r*(Q-P));for(v.push(Q);it;){for(I=o=0,Z=r-1;0<=Z?o<=Z:o>=Z;I=0<=Z?++o:--o)w[I]=0;for(S=s=0,$=k-1;0<=$?s<=$:s>=$;S=0<=$?++s:--s){for(at=lt[S],M=Number.MAX_VALUE,I=a=0,J=r-1;0<=J?a<=J:a>=J;I=0<=J?++a:--a)(E=g(v[I]-at))<M&&(M=E,_=I);w[_]++,m[S]=_}for(A=new Array(r),I=l=0,tt=r-1;0<=tt?l<=tt:l>=tt;I=0<=tt?++l:--l)A[I]=null;for(S=u=0,et=k-1;0<=et?u<=et:u>=et;S=0<=et?++u:--u)null===A[b=m[S]]?A[b]=lt[S]:A[b]+=lt[S];for(I=c=0,rt=r-1;0<=rt?c<=rt:c>=rt;I=0<=rt?++c:--c)A[I]*=1/w[I];for(it=!1,I=h=0,B=r-1;0<=B?h<=B:h>=B;I=0<=B?++h:--h)if(A[I]!==v[S]){it=!0;break}v=A,++N>200&&(it=!1)}for(O={},I=f=0,V=r-1;0<=V?f<=V:f>=V;I=0<=V?++f:--f)O[I]=[];for(S=p=0,q=k-1;0<=q?p<=q:p>=q;S=0<=q?++p:--p)O[b=m[S]].push(lt[S]);for(ot=[],I=d=0,Y=r-1;0<=Y?d<=Y:d>=Y;I=0<=Y?++d:--d)ot.push(O[I][0]),ot.push(O[I][O[I].length-1]);for(ot=ot.sort((function(t,e){return t-e})),C.push(ot[0]),S=y=1,W=ot.length-1;y<=W;S=y+=2)st=ot[S],isNaN(st)||-1!==C.indexOf(st)||C.push(st)}return C},k=function(t,e,r){var n,i,o,s;return t=(n=It(arguments))[0],e=n[1],r=n[2],isNaN(t)&&(t=0),(t/=360)<1/3?o=1-((i=(1-e)/3)+(s=(1+e*I(u*t)/I(a-u*t))/3)):t<2/3?i=1-((s=(1-e)/3)+(o=(1+e*I(u*(t-=1/3))/I(a-u*t))/3)):s=1-((o=(1-e)/3)+(i=(1+e*I(u*(t-=2/3))/I(a-u*t))/3)),[255*(s=Z(r*s*3)),255*(o=Z(r*o*3)),255*(i=Z(r*i*3)),n.length>3?n[3]:1]},lt=function(){var t,e,r,n,i,o,s;return i=(o=It(arguments))[0],e=o[1],t=o[2],u=2*Math.PI,i/=255,e/=255,t/=255,0===(s=1-Math.min(i,e,t)/(n=(i+e+t)/3))?r=0:(r=(i-e+(i-t))/2,r/=Math.sqrt((i-e)*(i-e)+(i-t)*(e-t)),r=Math.acos(r),t>e&&(r=u-r),r/=u),[360*r,s,n]},x.hsi=function(){return function(t,e,r){r.prototype=t.prototype;var n=new r,i=t.apply(n,e);return Object(i)===i?i:n}(n,Pt.call(arguments).concat(["hsi"]),(function(){}))},p.hsi=k,n.prototype.hsi=function(){return lt(this._rgb)},j=function(t,e,r,n){var i,o,s,a,l,u,c,h,f,p;return"hsl"===n?(f=t.hsl(),p=e.hsl()):"hsv"===n?(f=t.hsv(),p=e.hsv()):"hcg"===n?(f=t.hcg(),p=e.hcg()):"hsi"===n?(f=t.hsi(),p=e.hsi()):"lch"!==n&&"hcl"!==n||(n="hcl",f=t.hcl(),p=e.hcl()),"h"===n.substr(0,1)&&(o=f[0],c=f[1],a=f[2],s=p[0],h=p[1],l=p[2]),isNaN(o)||isNaN(s)?isNaN(o)?isNaN(s)?i=Number.NaN:(i=s,1!==a&&0!==a||"hsv"===n||(u=h)):(i=o,1!==l&&0!==l||"hsv"===n||(u=c)):i=o+r*(s>o&&s-o>180?s-(o+360):s<o&&o-s>180?s+360-o:s-o),null==u&&(u=c+r*(h-c)),x[n](i,u,a+r*(l-a))},U=function(t,e,r,n){var i,o;return i=t.num(),o=e.num(),x.num(i+(o-i)*r,"num")},(d=d.concat(function(){var t,e,r,n;for(n=[],e=0,t=(r=["hsv","hsl","hsi","hcl","lch","hcg"]).length;e<t;e++)J=r[e],n.push([J,j]);return n}())).push(["num",U]),G=function(t,e,r,i){var o,s;return o=t.lab(),s=e.lab(),new n(o[0]+r*(s[0]-o[0]),o[1]+r*(s[1]-o[1]),o[2]+r*(s[2]-o[2]),i)},d.push(["lab",G])}).call(this)}).call(this,r(68)(t))},function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return s})),r.d(e,"e",(function(){return a}));const n=Symbol("thread.errors"),i=Symbol("thread.events"),o=Symbol("thread.terminate"),s=Symbol("thread.transferable"),a=Symbol("thread.worker")},function(t,e,r){"use strict";function n(t,e){let r=t.length-e,n=0;do{for(let r=e;r>0;r--)t[n+e]+=t[n],n++;r-=e}while(r>0)}function i(t,e,r){let n=0,i=t.length;const o=i/r;for(;i>e;){for(let r=e;r>0;--r)t[n+e]+=t[n],++n;i-=e}const s=t.slice();for(let e=0;e<o;++e)for(let n=0;n<r;++n)t[r*e+n]=s[(r-n-1)*o+e]}r.d(e,"a",(function(){return o}));class o{async decode(t,e){const r=await this.decodeBlock(e),o=t.Predictor||1;if(1!==o){const e=!t.StripOffsets;return function(t,e,r,o,s,a){if(!e||1===e)return t;for(let t=0;t<s.length;++t){if(s[t]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[t]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const l=s[0]/8,u=2===a?1:s.length;for(let a=0;a<o&&!(a*u*r*l>=t.byteLength);++a){let o;if(2===e){switch(s[0]){case 8:o=new Uint8Array(t,a*u*r*l,u*r*l);break;case 16:o=new Uint16Array(t,a*u*r*l,u*r*l/2);break;case 32:o=new Uint32Array(t,a*u*r*l,u*r*l/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}n(o,u)}else 3===e&&(o=new Uint8Array(t,a*u*r*l,u*r*l),i(o,u,l))}return t}(r,o,e?t.TileWidth:t.ImageWidth,e?t.TileLength:t.RowsPerStrip||t.ImageLength,t.BitsPerSample,t.PlanarConfiguration)}return r}}},function(t,e,r){"use strict";(function(t,n){r.d(e,"a",(function(){return $})),r.d(e,"b",(function(){return Lr})),r.d(e,"c",(function(){return cn})),r.d(e,"d",(function(){return mr})),r.d(e,"e",(function(){return hn})),r.d(e,"f",(function(){return i}));var i={$version:8,$root:{version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90° orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features."},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Suported projections are Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Mercator, Natural Earth, and Winkel Tripel. Terrain, fog, sky and CustomLayerInterface are not supported for projections other than mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},sources:{"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_raster:{type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},encoding:{type:"enum",values:{terrarium:{doc:"Terrarium format PNG tiles. See https://aws.amazon.com/es/public-datasets/terrain/ for more info."},mapbox:{doc:"Mapbox Terrain RGB tiles. See https://www.mapbox.com/help/access-elevation-data/#mapbox-terrain-rgb for more info."}},default:"mapbox",doc:"The encoding used by this source. Mapbox Terrain RGB is used by default"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups. Cluster groups become new `Point` features in the source with additional properties:\n * `cluster` Is `true` if the point is a cluster \n * `cluster_id` A unqiue id for the cluster to be used in conjunction with the [cluster inspection methods](https://www.mapbox.com/mapbox-gl-js/api/#geojsonsource#getclusterexpansionzoom)\n * `point_count` Number of original points grouped into this cluster\n * `point_count_abbreviated` An abbreviated point count"},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) — it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},source_video:{type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},source_image:{type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},layer:{id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},hillshade:{doc:"Client-side hillshading visualization based on DEM data. Currently, the implementation only supports Mapbox Terrain RGB and Mapzen Terrarium tiles.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer. When using a client that supports global collision detection, like Mapbox GL JS version 0.42.0 or greater, enabling this property is not needed to prevent clipped labels at tile boundaries.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn’t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},filter:{type:"array",value:"*",doc:"A filter selects specific features from a layer."},filter_symbol:{type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] ≠ value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] ≥ value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] ≤ value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] ∈ {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] ∉ {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 ∧ ... ∧ fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 ∨ ... ∨ fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `¬f0 ∧ ... ∧ ¬fn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},geometry_type:{type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:"A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:\n* In categorical functions, when the feature value does not match any of the stop domain values.\n* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.\n* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a `circle-color` property but the feature property value is not a string or not a valid color).\n* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.\nIf no default is provided, the style property's default is used in these circumstances."}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},expression:{type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},expression_name:{doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"Returns a [`ResolvedImage`](/mapbox-gl-js/style-spec/types/#resolvedimage) for use in [`icon-image`](/mapbox-gl-js/style-spec/layers/#layout-symbol-icon-image), `*-pattern` entries, and as a section in the [`'format'`](#types-format) expression. A [`'coalesce'`](#coalesce) expression containing `image` expressions will evaluate to the first listed image that is currently in the style. This validation process is synchronous and requires the image to have been added to the style before requesting it in the `'image'` argument.",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm](https://tc39.github.io/ecma262/#sec-tostring-applied-to-the-number-type) of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`](https://tc39.github.io/ecma262/#sec-json.stringify) function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm](https://tc39.github.io/ecma262/#sec-tonumber-applied-to-the-string-type) of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`. `Multi*` feature types are only returned in GeoJSON sources. When working with vector tile sources, use the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"Returns `true` if the input string is expected to render legibly. Returns `false` if the input string contains sections that cannot be rendered without potential loss of meaning (e.g. Indic scripts that require complex text shaping, or right-to-left scripts if the the `mapbox-gl-rtl-text` plugin is not in use in Mapbox GL JS).",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the fog. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the fog to the color of the sky. A value of zero leaves a sharp transition from fog to sky. Increasing the value blends the color of fog into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0"}}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0° (0° when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0° when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0°, directly above, to 180°, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},projection:{name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carrée projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},terrain:{source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,doc:"The color of the icon. This can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0° north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0° is directly above, at zenith, and 90° at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0° north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0° is directly above, at zenith, and 90° at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"cross-faded":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms."},"cross-faded-data-driven":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms. It can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:{"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}}};var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function s(t){var e={exports:{}};return t(e,e.exports),e.exports}
/*! https://mths.be/punycode v1.3.2 by @mathias */
var a=s((function(t,e){!function(r){var n=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s="object"==typeof o&&o;s.global!==s&&s.window!==s&&s.self!==s||(r=s);var a,l,u=2147483647,c=36,h=/^xn--/,f=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},g=Math.floor,y=String.fromCharCode;function m(t){throw RangeError(d[t])}function _(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function v(t,e){var r=t.split("@"),n="";return r.length>1&&(n=r[0]+"@",t=r[1]),n+_((t=t.replace(p,".")).split("."),e).join(".")}function b(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function w(t){return _(t,(function(t){var e="";return t>65535&&(e+=y((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=y(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function E(t,e,r){var n=0;for(t=r?g(t/700):t>>1,t+=g(t/e);t>455;n+=c)t=g(t/35);return g(n+36*t/(t+38))}function S(t){var e,r,n,i,o,s,a,l,h,f,p,d=[],y=t.length,_=0,v=128,b=72;for((r=t.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&m("not-basic"),d.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<y;){for(o=_,s=1,a=c;i>=y&&m("invalid-input"),((l=(p=t.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:c)>=c||l>g((u-_)/s))&&m("overflow"),_+=l*s,!(l<(h=a<=b?1:a>=b+26?26:a-b));a+=c)s>g(u/(f=c-h))&&m("overflow"),s*=f;b=E(_-o,e=d.length+1,0==o),g(_/e)>u-v&&m("overflow"),v+=g(_/e),_%=e,d.splice(_++,0,v)}return w(d)}function I(t){var e,r,n,i,o,s,a,l,h,f,p,d,_,v,w,S=[];for(d=(t=b(t)).length,e=128,r=0,o=72,s=0;s<d;++s)(p=t[s])<128&&S.push(y(p));for(n=i=S.length,i&&S.push("-");n<d;){for(a=u,s=0;s<d;++s)(p=t[s])>=e&&p<a&&(a=p);for(a-e>g((u-r)/(_=n+1))&&m("overflow"),r+=(a-e)*_,e=a,s=0;s<d;++s)if((p=t[s])<e&&++r>u&&m("overflow"),p==e){for(l=r,h=c;!(l<(f=h<=o?1:h>=o+26?26:h-o));h+=c)w=l-f,v=c-f,S.push(y(x(f+w%v,0))),l=g(w/v);S.push(y(x(l,0))),o=E(r,_,n==i),r=0,++n}++r,++e}return S.join("")}if(a={version:"1.3.2",ucs2:{decode:b,encode:w},decode:S,encode:I,toASCII:function(t){return v(t,(function(t){return f.test(t)?"xn--"+I(t):t}))},toUnicode:function(t){return v(t,(function(t){return h.test(t)?S(t.slice(4).toLowerCase()):t}))}},n&&i)if(t.exports==n)i.exports=a;else for(l in a)a.hasOwnProperty(l)&&(n[l]=a[l]);else r.punycode=a}(o)})),l=function(t){return"string"==typeof t},u=function(t){return"object"==typeof t&&null!==t},c=function(t){return null===t},h=function(t){return null==t};function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var p=function(t,e,r,n){e=e||"&",r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var u,c,h,p,d=t[l].replace(o,"%20"),g=d.indexOf(r);g>=0?(u=d.substr(0,g),c=d.substr(g+1)):(u=d,c=""),h=decodeURIComponent(u),p=decodeURIComponent(c),f(i,h)?Array.isArray(i[h])?i[h].push(p):i[h]=[i[h],p]:i[h]=p}return i},d=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},g=function(t,e,r,n){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(n){var i=encodeURIComponent(d(n))+r;return Array.isArray(t[n])?t[n].map((function(t){return i+encodeURIComponent(d(t))})).join(e):i+encodeURIComponent(d(t[n]))})).join(e):n?encodeURIComponent(d(n))+r+encodeURIComponent(d(t)):""},y=s((function(t,e){e.decode=e.parse=p,e.encode=e.stringify=g}));function m(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var _=/^([a-z0-9.+-]+:)/i,v=/:[0-9]*$/,b=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,w=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),x=["'"].concat(w),E=["%","/","?",";","#"].concat(x),S=["/","?","#"],I=/^[+a-z0-9A-Z_-]{0,63}$/,O=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function R(t,e,r){if(t&&u(t)&&t instanceof m)return t;var n=new m;return n.parse(t,e,r),n}m.prototype.parse=function(t,e,r){if(!l(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=-1!==n&&n<t.indexOf("#")?"?":"#",o=t.split(i);o[0]=o[0].replace(/\\/g,"/");var s=t=o.join(i);if(s=s.trim(),!r&&1===t.split("#").length){var u=b.exec(s);if(u)return this.path=s,this.href=s,this.pathname=u[1],u[2]?(this.search=u[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=_.exec(s);if(c){var h=(c=c[0]).toLowerCase();this.protocol=h,s=s.substr(c.length)}if(r||c||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var f="//"===s.substr(0,2);!f||c&&T[c]||(s=s.substr(2),this.slashes=!0)}if(!T[c]&&(f||c&&!P[c])){for(var p,d,g=-1,m=0;m<S.length;m++){-1!==(v=s.indexOf(S[m]))&&(-1===g||v<g)&&(g=v)}-1!==(d=-1===g?s.lastIndexOf("@"):s.lastIndexOf("@",g))&&(p=s.slice(0,d),s=s.slice(d+1),this.auth=decodeURIComponent(p)),g=-1;for(m=0;m<E.length;m++){var v;-1!==(v=s.indexOf(E[m]))&&(-1===g||v<g)&&(g=v)}-1===g&&(g=s.length),this.host=s.slice(0,g),s=s.slice(g),this.parseHost(),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w)for(var R=this.hostname.split(/\./),L=(m=0,R.length);m<L;m++){var M=R[m];if(M&&!M.match(I)){for(var k="",N=0,A=M.length;N<A;N++)M.charCodeAt(N)>127?k+="x":k+=M[N];if(!k.match(I)){var F=R.slice(0,m),D=R.slice(m+1),j=M.match(O);j&&(F.push(j[1]),D.unshift(j[2])),D.length&&(s="/"+D.join(".")+s),this.hostname=F.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=a.toASCII(this.hostname));var G=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+G,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!C[h])for(m=0,L=x.length;m<L;m++){var U=x[m];if(-1!==s.indexOf(U)){var B=encodeURIComponent(U);B===U&&(B=escape(U)),s=s.split(U).join(B)}}var V=s.indexOf("#");-1!==V&&(this.hash=s.substr(V),s=s.slice(0,V));var q=s.indexOf("?");if(-1!==q?(this.search=s.substr(q),this.query=s.substr(q+1),e&&(this.query=y.parse(this.query)),s=s.slice(0,q)):e&&(this.search="",this.query={}),s&&(this.pathname=s),P[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var Y=this.search||"";this.path=G+Y}return this.href=this.format(),this},m.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||P[e])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),e+i+(r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(s=s.replace("#","%23"))+n},m.prototype.resolve=function(t){return this.resolveObject(R(t,!1,!0)).format()},m.prototype.resolveObject=function(t){if(l(t)){var e=new m;e.parse(t,!1,!0),t=e}for(var r=new m,n=Object.keys(this),i=0;i<n.length;i++){var o=n[i];r[o]=this[o]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var u=s[a];"protocol"!==u&&(r[u]=t[u])}return P[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!P[t.protocol]){for(var f=Object.keys(t),p=0;p<f.length;p++){var d=f[p];r[d]=t[d]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||T[t.protocol])r.pathname=t.pathname;else{for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==g[0]&&g.unshift(""),g.length<2&&g.unshift(""),r.pathname=g.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var y=r.pathname||"",_=r.search||"";r.path=y+_}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=b||v||r.host&&t.pathname,x=w,E=r.pathname&&r.pathname.split("/")||[],S=(g=t.pathname&&t.pathname.split("/")||[],r.protocol&&!P[r.protocol]);if(S&&(r.hostname="",r.port=null,r.host&&(""===E[0]?E[0]=r.host:E.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===g[0]?g[0]=t.host:g.unshift(t.host)),t.host=null),w=w&&(""===g[0]||""===E[0])),b)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,E=g;else if(g.length)E||(E=[]),E.pop(),E=E.concat(g),r.search=t.search,r.query=t.query;else if(!h(t.search)){if(S)r.hostname=r.host=E.shift(),(L=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=L.shift(),r.host=r.hostname=L.shift());return r.search=t.search,r.query=t.query,c(r.pathname)&&c(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!E.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var I=E.slice(-1)[0],O=(r.host||t.host||E.length>1)&&("."===I||".."===I)||""===I,C=0,R=E.length;R>=0;R--)"."===(I=E[R])?E.splice(R,1):".."===I?(E.splice(R,1),C++):C&&(E.splice(R,1),C--);if(!w&&!x)for(;C--;C)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),O&&"/"!==E.join("/").substr(-1)&&E.push("");var L,M=""===E[0]||E[0]&&"/"===E[0].charAt(0);S&&(r.hostname=r.host=M?"":E.length?E.shift():"",(L=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=L.shift(),r.host=r.hostname=L.shift()));return(w=w||r.host&&E.length)&&!M&&E.unshift(""),E.length?r.pathname=E.join("/"):(r.pathname=null,r.path=null),c(r.pathname)&&c(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},m.prototype.parseHost=function(){var t=this.host,e=v.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};function L(t,...e){for(const r of e)for(const e in r)t[e]=r[e];return t}class M extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class k{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,r]of e)this.bindings[t]=r}concat(t){return new k(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const N={kind:"null"},A={kind:"number"},F={kind:"string"},D={kind:"boolean"},j={kind:"color"},G={kind:"object"},z={kind:"value"},U={kind:"collator"},B={kind:"formatted"},V={kind:"resolvedImage"};function q(t,e){return{kind:"array",itemType:t,N:e}}function Y(t){if("array"===t.kind){const e=Y(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const W=[N,A,F,D,j,B,G,q(z),V];function X(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!X(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of W)if(!X(t,e))return null}return`Expected ${Y(t)} but found ${Y(e)} instead.`}function H(t,e){return e.some(e=>e.kind===t.kind)}function Z(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}var K=s((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function s(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function a(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=i.indexOf("("),u=i.indexOf(")");if(-1!==l&&u+1===i.length){var c=i.substr(0,l),h=i.substr(l+1,u-(l+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=s(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),f];case"hsla":if(4!==h.length)return null;f=s(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,d=s(h[1]),g=s(h[2]),y=g<=.5?g*(d+1):g+d-g*d,m=2*g-y;return[n(255*a(m,y,p+1/3)),n(255*a(m,y,p)),n(255*a(m,y,p-1/3)),f];default:return null}}return null}}catch(t){}}));class ${constructor(t,e,r,n=1){this.r=t,this.g=e,this.b=r,this.a=n}static parse(t){if(!t)return;if(t instanceof $)return t;if("string"!=typeof t)return;const e=K.parseCSSColor(t);return e?new $(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,r,n]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(r)},${n})`}toArray(){const{r:t,g:e,b:r,a:n}=this;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*r/n,n]}}$.black=new $(0,0,0,1),$.white=new $(1,1,1,1),$.transparent=new $(0,0,0,0),$.red=new $(1,0,0,1),$.blue=new $(0,0,1,1);class J{constructor(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Q{constructor(t,e,r,n,i){this.text=t,this.image=e,this.scale=r,this.fontStack=n,this.textColor=i}}class tt{constructor(t){this.sections=t}static fromString(t){return new tt([new Q(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof tt?t:tt.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const r={};e.fontStack&&(r["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(r["font-scale"]=e.scale),e.textColor&&(r["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(r)}return t}}class et{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new et({name:t,available:!1}):null}serialize(){return["image",this.name]}}function rt(t,e,r,n){if(!("number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255)){return`Invalid rgba value [${("number"==typeof n?[t,e,r,n]:[t,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}return void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[t,e,r,n].join(", ")}]: 'a' must be between 0 and 1.`}function nt(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof $)return!0;if(t instanceof J)return!0;if(t instanceof tt)return!0;if(t instanceof et)return!0;if(Array.isArray(t)){for(const e of t)if(!nt(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!nt(t[e]))return!1;return!0}return!1}function it(t){if(null===t)return N;if("string"==typeof t)return F;if("boolean"==typeof t)return D;if("number"==typeof t)return A;if(t instanceof $)return j;if(t instanceof J)return U;if(t instanceof tt)return B;if(t instanceof et)return V;if(Array.isArray(t)){const e=t.length;let r;for(const e of t){const t=it(e);if(r){if(r===t)continue;r=z;break}r=t}return q(r||z,e)}return G}function ot(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof $||t instanceof tt||t instanceof et?t.toString():JSON.stringify(t)}class st{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!nt(t[1]))return e.error("invalid value");const r=t[1];let n=it(r);const i=e.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new st(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof $?["rgba"].concat(this.value.toArray()):this.value instanceof tt?this.value.serialize():this.value}}class at{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const lt={string:F,number:A,boolean:D,object:G};class ut{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let r,n=1;const i=t[0];if("array"===i){let i,o;if(t.length>2){const r=t[1];if("string"!=typeof r||!(r in lt)||"object"===r)return e.error('The item type argument of "array" must be one of string, number, boolean',1);i=lt[r],n++}else i=z;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],n++}r=q(i,o)}else r=lt[i];const o=[];for(;n<t.length;n++){const r=e.parse(t[n],n,z);if(!r)return null;o.push(r)}return new ut(r,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const r=this.args[e].evaluate(t);if(!X(this.type,it(r)))return r;if(e===this.args.length-1)throw new at(`Expected value to be of type ${Y(this.type)}, but found ${Y(it(r))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);const n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map(t=>t.serialize()))}}class ct{constructor(t){this.type=B,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=t.length-1;++r){const o=t[r];if(i&&"object"==typeof o&&!Array.isArray(o)){i=!1;let t=null;if(o["font-scale"]&&(t=e.parse(o["font-scale"],1,A),!t))return null;let r=null;if(o["text-font"]&&(r=e.parse(o["text-font"],1,q(F)),!r))return null;let s=null;if(o["text-color"]&&(s=e.parse(o["text-color"],1,j),!s))return null;const a=n[n.length-1];a.scale=t,a.font=r,a.textColor=s}else{const o=e.parse(t[r],1,z);if(!o)return null;const s=o.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:o,scale:null,font:null,textColor:null})}}return new ct(n)}evaluate(t){return new tt(this.sections.map(e=>{const r=e.content.evaluate(t);return it(r)===V?new Q("",r,null,null,null):new Q(ot(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const r={};e.scale&&(r["font-scale"]=e.scale.serialize()),e.font&&(r["text-font"]=e.font.serialize()),e.textColor&&(r["text-color"]=e.textColor.serialize()),t.push(r)}return t}}class ht{constructor(t){this.type=V,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const r=e.parse(t[1],1,F);return r?new ht(r):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),r=et.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ft={"to-boolean":D,"to-color":j,"to-number":A,"to-string":F};class pt{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");const n=ft[r],i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],r,z);if(!n)return null;i.push(n)}return new pt(n,i)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,r;for(const n of this.args){if(e=n.evaluate(t),r=null,e instanceof $)return e;if("string"==typeof e){const r=t.parseColor(e);if(r)return r}else if(Array.isArray(e)&&(r=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:rt(e[0],e[1],e[2],e[3]),!r))return new $(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new at(r||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const r of this.args){if(e=r.evaluate(t),null===e)return 0;const n=Number(e);if(!isNaN(n))return n}throw new at(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?tt.fromString(ot(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?et.fromString(ot(this.args[0].evaluate(t))):ot(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new ct([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ht(this.args[0]).serialize();const t=["to-"+this.type.kind];return this.eachChild(e=>{t.push(e.serialize())}),t}}const dt=["Unknown","Point","LineString","Polygon"];class gt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?dt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:n}=this.featureTileCoord,i=r*e-t[0],o=n*e-t[1];return this.featureDistanceData.bearing[0]*i+this.featureDistanceData.bearing[1]*o}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=$.parse(t)),e}}class yt{constructor(t,e,r,n){this.name=t,this.type=e,this._evaluate=r,this.args=n}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const r=t[0],n=yt.definitions[r];if(!n)return e.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=o.filter(([e])=>!Array.isArray(e)||e.length===t.length-1);let a=null;for(const[n,o]of s){a=new zt(e.registry,e.path,null,e.scope);const s=[];let l=!1;for(let e=1;e<t.length;e++){const r=t[e],i=Array.isArray(n)?n[e-1]:n.type,o=a.parse(r,1+s.length,i);if(!o){l=!0;break}s.push(o)}if(!l)if(Array.isArray(n)&&n.length!==s.length)a.error(`Expected ${n.length} arguments, but found ${s.length} instead.`);else{for(let t=0;t<s.length;t++){const e=Array.isArray(n)?n[t]:n.type,r=s[t];a.concat(t+1).checkSubtype(e,r.type)}if(0===a.errors.length)return new yt(r,i,o,s)}}if(1===s.length)e.errors.push(...a.errors);else{const r=(s.length?s:o).map(([t])=>{return e=t,Array.isArray(e)?`(${e.map(Y).join(", ")})`:`(${Y(e.type)}...)`;var e}).join(" | "),n=[];for(let r=1;r<t.length;r++){const i=e.parse(t[r],1+n.length);if(!i)return null;n.push(Y(i.type))}e.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(t,e){yt.definitions=e;for(const r in e)t[r]=yt}}class mt{constructor(t,e,r){this.type=U,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");const n=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,D);if(!n)return null;const i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,D);if(!i)return null;let o=null;return r.locale&&(o=e.parse(r.locale,1,F),!o)?null:new mt(n,i,o)}evaluate(t){return new J(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const _t=8192;function vt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function bt(t,e){return!(t[0]<=e[0])&&(!(t[2]>=e[2])&&(!(t[1]<=e[1])&&!(t[3]>=e[3])))}function wt(t,e){const r=(180+t[0])/360;const n=(i=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360);var i;const o=Math.pow(2,e.z);return[Math.round(r*o*_t),Math.round(n*o*_t)]}function xt(t,e,r){const n=t[0]-e[0],i=t[1]-e[1],o=t[0]-r[0],s=t[1]-r[1];return n*s-o*i==0&&n*o<=0&&i*s<=0}function Et(t,e){let r=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(xt(t,a[e],a[e+1]))return!1;n=t,i=a[e],o=a[e+1],i[1]>n[1]!=o[1]>n[1]&&n[0]<(o[0]-i[0])*(n[1]-i[1])/(o[1]-i[1])+i[0]&&(r=!r)}}var n,i,o;return r}function St(t,e){for(let r=0;r<e.length;r++)if(Et(t,e[r]))return!0;return!1}function It(t,e,r,n){const i=t[0]-r[0],o=t[1]-r[1],s=e[0]-r[0],a=e[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,h=s*u-l*a;return c>0&&h<0||c<0&&h>0}function Ot(t,e,r,n){const i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]];return 0!=(s=o)[0]*(a=i)[1]-s[1]*a[0]&&!(!It(t,e,r,n)||!It(r,n,t,e));var s,a}function Ct(t,e,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(Ot(t,e,n[r],n[r+1]))return!0;return!1}function Tt(t,e){for(let r=0;r<t.length;++r)if(!Et(t[r],e))return!1;for(let r=0;r<t.length-1;++r)if(Ct(t[r],t[r+1],e))return!1;return!0}function Pt(t,e){for(let r=0;r<e.length;r++)if(Tt(t,e[r]))return!0;return!1}function Rt(t,e,r){const n=[];for(let i=0;i<t.length;i++){const o=[];for(let n=0;n<t[i].length;n++){const s=wt(t[i][n],r);vt(e,s),o.push(s)}n.push(o)}return n}function Lt(t,e,r){const n=[];for(let i=0;i<t.length;i++){const o=Rt(t[i],e,r);n.push(o)}return n}function Mt(t,e,r,n){if(t[0]<r[0]||t[0]>r[2]){const e=.5*n;let i=t[0]-r[0]>e?-n:r[0]-t[0]>e?n:0;0===i&&(i=t[0]-r[2]>e?-n:r[2]-t[0]>e?n:0),t[0]+=i}vt(e,t)}function kt(t,e,r,n){const i=Math.pow(2,n.z)*_t,o=[n.x*_t,n.y*_t],s=[];for(const n of t)for(const t of n){const n=[t.x+o[0],t.y+o[1]];Mt(n,e,r,i),s.push(n)}return s}function Nt(t,e,r,n){const i=Math.pow(2,n.z)*_t,o=[n.x*_t,n.y*_t],s=[];for(const r of t){const t=[];for(const n of r){const r=[n.x+o[0],n.y+o[1]];vt(e,r),t.push(r)}s.push(t)}if(e[2]-e[0]<=i/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const n of t)Mt(n,e,r,i)}var a;return s}class At{constructor(t,e){this.type=D,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(nt(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const r=e.features[t].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new At(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new At(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new At(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=Rt(e.coordinates,n,i),s=kt(t.geometry(),r,n,i);if(!bt(r,n))return!1;for(const t of s)if(!Et(t,o))return!1}if("MultiPolygon"===e.type){const o=Lt(e.coordinates,n,i),s=kt(t.geometry(),r,n,i);if(!bt(r,n))return!1;for(const t of s)if(!St(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){const o=Rt(e.coordinates,n,i),s=Nt(t.geometry(),r,n,i);if(!bt(r,n))return!1;for(const t of s)if(!Tt(t,o))return!1}if("MultiPolygon"===e.type){const o=Lt(e.coordinates,n,i),s=Nt(t.geometry(),r,n,i);if(!bt(r,n))return!1;for(const t of s)if(!Pt(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Ft(t){if(t instanceof yt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof At)return!1;let e=!0;return t.eachChild(t=>{e&&!Ft(t)&&(e=!1)}),e}function Dt(t){if(t instanceof yt&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!Dt(t)&&(e=!1)}),e}function jt(t,e){if(t instanceof yt&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(t=>{r&&!jt(t,e)&&(r=!1)}),r}class Gt{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const r=t[1];return e.scope.has(r)?new Gt(r,e.scope.get(r)):e.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class zt{constructor(t,e=[],r,n=new k,i=[]){this.registry=t,this.path=e,this.key=e.map(t=>`[${t}]`).join(""),this.scope=n,this.errors=i,this.expectedType=r}parse(t,e,r,n,i={}){return e?this.concat(e,r,n)._parse(t,i):this._parse(t,i)}_parse(t,e){function r(t,e,r){return"assert"===r?new ut(e,[t]):"coerce"===r?new pt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=t[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(t,this);if(!n)return null;if(this.expectedType){const t=this.expectedType,i=n.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==i.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(t,i))return null}else n=r(n,t,e.typeAnnotation||"coerce");else n=r(n,t,e.typeAnnotation||"assert")}if(!(n instanceof st)&&"resolvedImage"!==n.type.kind&&Ut(n)){const t=new gt;try{n=new st(n.type,n.evaluate(t))}catch(t){return this.error(t.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,e,r){const n="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new zt(this.registry,n,e||null,i,this.errors)}error(t,...e){const r=`${this.key}${e.map(t=>`[${t}]`).join("")}`;this.errors.push(new M(r,t))}checkSubtype(t,e){const r=X(t,e);return r&&this.error(r),r}}function Ut(t){if(t instanceof Gt)return Ut(t.boundExpression);if(t instanceof yt&&"error"===t.name)return!1;if(t instanceof mt)return!1;if(t instanceof At)return!1;const e=t instanceof pt||t instanceof ut;let r=!0;return t.eachChild(t=>{r=e?r&&Ut(t):r&&t instanceof st}),!!r&&(Ft(t)&&jt(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]))}function Bt(t,e){const r=t.length-1;let n,i,o=0,s=r,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),n=t[a],i=t[a+1],n<=e){if(a===r||e<i)return a;o=a+1}else{if(!(n>e))throw new at("Input is not a number.");s=a-1}return 0}class Vt{constructor(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const r=e.parse(t[1],1,A);if(!r)return null;const n=[];let i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(let r=1;r<t.length;r+=2){const o=1===r?-1/0:t[r],s=t[r+1],a=r,l=r+1;if("number"!=typeof o)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(n.length&&n[n.length-1][0]>=o)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const u=e.parse(s,l,i);if(!u)return null;i=i||u.type,n.push([o,u])}return new Vt(i,r,n)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);const i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);return r[Bt(e,n)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var qt=Yt;function Yt(t,e,r,n){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=r,this.p2y=n}function Wt(t,e,r){return t*(1-r)+e*r}Yt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Yt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Yt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Yt.prototype.solveCurveX=function(t,e){var r,n,i,o,s;for(void 0===e&&(e=1e-6),i=t,s=0;s<8;s++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=o/a}if((i=t)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?r=i:n=i,i=.5*(n-r)+r}return i},Yt.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Xt=Object.freeze({__proto__:null,number:Wt,color:function(t,e,r){return new $(Wt(t.r,e.r,r),Wt(t.g,e.g,r),Wt(t.b,e.b,r),Wt(t.a,e.a,r))},array:function(t,e,r){return t.map((t,n)=>Wt(t,e[n],r))}});const Ht=.95047,Zt=1.08883,Kt=4/29,$t=6/29,Jt=3*$t*$t,Qt=Math.PI/180,te=180/Math.PI;function ee(t){return t>.008856451679035631?Math.pow(t,1/3):t/Jt+Kt}function re(t){return t>$t?t*t*t:Jt*(t-Kt)}function ne(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ie(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function oe(t){const e=ie(t.r),r=ie(t.g),n=ie(t.b),i=ee((.4124564*e+.3575761*r+.1804375*n)/Ht),o=ee((.2126729*e+.7151522*r+.072175*n)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-ee((.0193339*e+.119192*r+.9503041*n)/Zt)),alpha:t.a}}function se(t){let e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*re(e),r=Ht*re(r),n=Zt*re(n),new $(ne(3.2404542*r-1.5371385*e-.4985314*n),ne(-.969266*r+1.8760108*e+.041556*n),ne(.0556434*r-.2040259*e+1.0572252*n),t.alpha)}function ae(t,e,r){const n=e-t;return t+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const le={forward:oe,reverse:se,interpolate:function(t,e,r){return{l:Wt(t.l,e.l,r),a:Wt(t.a,e.a,r),b:Wt(t.b,e.b,r),alpha:Wt(t.alpha,e.alpha,r)}}},ue={forward:function(t){const{l:e,a:r,b:n}=oe(t),i=Math.atan2(n,r)*te;return{h:i<0?i+360:i,c:Math.sqrt(r*r+n*n),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Qt,r=t.c;return se({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:ae(t.h,e.h,r),c:Wt(t.c,e.c,r),l:Wt(t.l,e.l,r),alpha:Wt(t.alpha,e.alpha,r)}}};var ce=Object.freeze({__proto__:null,lab:le,hcl:ue});class he{constructor(t,e,r,n,i){this.type=t,this.operator=e,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,r,n){let i=0;if("exponential"===t.name)i=fe(e,t.base,r,n);else if("linear"===t.name)i=fe(e,1,r,n);else if("cubic-bezier"===t.name){const o=t.controlPoints;i=new qt(o[0],o[1],o[2],o[3]).solve(fe(e,1,r,n))}return i}static parse(t,e){let[r,n,i,...o]=t;if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const t=n[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:t}}else{if("cubic-bezier"!==n[0])return e.error("Unknown interpolation type "+String(n[0]),1,0);{const t=n.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(i=e.parse(i,2,A),!i)return null;const s=[];let a=null;"interpolate-hcl"===r||"interpolate-lab"===r?a=j:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let t=0;t<o.length;t+=2){const r=o[t],n=o[t+1],i=t+3,l=t+4;if("number"!=typeof r)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=r)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const u=e.parse(n,l,a);if(!u)return null;a=a||u.type,s.push([r,u])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new he(a,r,n,i,s):e.error(`Type ${Y(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return r[0].evaluate(t);const i=e.length;if(n>=e[i-1])return r[i-1].evaluate(t);const o=Bt(e,n),s=e[o],a=e[o+1],l=he.interpolationFactor(this.interpolation,n,s,a),u=r[o].evaluate(t),c=r[o+1].evaluate(t);return"interpolate"===this.operator?Xt[this.type.kind.toLowerCase()](u,c,l):"interpolate-hcl"===this.operator?ue.reverse(ue.interpolate(ue.forward(u),ue.forward(c),l)):le.reverse(le.interpolate(le.forward(u),le.forward(c),l))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function fe(t,e,r,n){const i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}class pe{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let r=null;const n=e.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of t.slice(1)){const t=e.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!t)return null;r=r||t.type,i.push(t)}const o=n&&i.some(t=>X(n,t.type));return new pe(o?z:r,i)}evaluate(t){let e,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(t),r&&r instanceof et&&!r.available&&(e||(e=r.name),r=null,n===this.args.length&&(r=e)),null!==r)break;return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class de{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const r=[];for(let n=1;n<t.length-1;n+=2){const i=t[n];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,n);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);const o=e.parse(t[n+1],n+1);if(!o)return null;r.push([i,o])}const n=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return n?new de(r,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,r]of this.bindings)t.push(e,r.serialize());return t.push(this.result.serialize()),t}}class ge{constructor(t,e,r){this.type=t,this.index=e,this.input=r}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,A),n=e.parse(t[2],2,q(e.expectedType||z));if(!r||!n)return null;const i=n.type;return new ge(i.itemType,r,n)}evaluate(t){const e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new at(`Array index out of bounds: ${e} < 0.`);if(e>=r.length)throw new at(`Array index out of bounds: ${e} > ${r.length-1}.`);if(e!==Math.floor(e))throw new at(`Array index must be an integer, but found ${e} instead.`);return r[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ye{constructor(t,e){this.type=D,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,z),n=e.parse(t[2],2,z);return r&&n?H(r.type,[D,F,A,N,z])?new ye(r,n):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Y(r.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!Z(e,["boolean","string","number","null"]))throw new at(`Expected first argument to be of type boolean, string, number or null, but found ${Y(it(e))} instead.`);if(!Z(r,["string","array"]))throw new at(`Expected second argument to be of type array or string, but found ${Y(it(r))} instead.`);return r.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class me{constructor(t,e,r){this.type=A,this.needle=t,this.haystack=e,this.fromIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,z),n=e.parse(t[2],2,z);if(!r||!n)return null;if(!H(r.type,[D,F,A,N,z]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Y(r.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,A);return i?new me(r,n,i):null}return new me(r,n)}evaluate(t){const e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!Z(e,["boolean","string","number","null"]))throw new at(`Expected first argument to be of type boolean, string, number or null, but found ${Y(it(e))} instead.`);if(!Z(r,["string","array"]))throw new at(`Expected second argument to be of type array or string, but found ${Y(it(r))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(t);return r.indexOf(e,n)}return r.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class _e{constructor(t,e,r,n,i,o){this.inputType=t,this.type=e,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let r,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i={},o=[];for(let s=2;s<t.length-1;s+=2){let a=t[s];const l=t[s+1];Array.isArray(a)||(a=[a]);const u=e.concat(s);if(0===a.length)return u.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,it(t)))return null}else r=it(t);if(void 0!==i[String(t)])return u.error("Branch labels must be unique.");i[String(t)]=o.length}const c=e.parse(l,s,n);if(!c)return null;n=n||c.type,o.push(c)}const s=e.parse(t[1],1,z);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,n);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(r,s.type)?null:new _e(r,n,s,i,o,a):null}evaluate(t){const e=this.input.evaluate(t);return(it(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),r=[],n={};for(const t of e){const e=n[this.cases[t]];void 0===e?(n[this.cases[t]]=r.length,r.push([this.cases[t],[t]])):r[e][1].push(t)}const i=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,n]of r)1===n.length?t.push(i(n[0])):t.push(n.map(i)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class ve{constructor(t,e,r){this.type=t,this.branches=e,this.otherwise=r}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const n=[];for(let i=1;i<t.length-1;i+=2){const o=e.parse(t[i],i,D);if(!o)return null;const s=e.parse(t[i+1],i+1,r);if(!s)return null;n.push([o,s]),r=r||s.type}const i=e.parse(t[t.length-1],t.length-1,r);return i?new ve(r,n,i):null}evaluate(t){for(const[e,r]of this.branches)if(e.evaluate(t))return r.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,r]of this.branches)t(e),t(r);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class be{constructor(t,e,r,n){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const r=e.parse(t[1],1,z),n=e.parse(t[2],2,A);if(!r||!n)return null;if(!H(r.type,[q(z),F,z]))return e.error(`Expected first argument to be of type array or string, but found ${Y(r.type)} instead`);if(4===t.length){const i=e.parse(t[3],3,A);return i?new be(r.type,r,n,i):null}return new be(r.type,r,n)}evaluate(t){const e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!Z(e,["string","array"]))throw new at(`Expected first argument to be of type array or string, but found ${Y(it(e))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(t);return e.slice(r,n)}return e.slice(r)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function we(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function xe(t,e,r,n){return 0===n.compare(e,r)}function Ee(t,e,r){const n="=="!==t&&"!="!==t;return class i{constructor(t,e,r){this.type=D,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const r=t[0];let o=e.parse(t[1],1,z);if(!o)return null;if(!we(r,o.type))return e.concat(1).error(`"${r}" comparisons are not supported for type '${Y(o.type)}'.`);let s=e.parse(t[2],2,z);if(!s)return null;if(!we(r,s.type))return e.concat(2).error(`"${r}" comparisons are not supported for type '${Y(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${Y(o.type)}' and '${Y(s.type)}'.`);n&&("value"===o.type.kind&&"value"!==s.type.kind?o=new ut(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new ut(o.type,[s])));let a=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,U),!a)return null}return new i(o,s,a)}evaluate(i){const o=this.lhs.evaluate(i),s=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const e=it(o),r=it(s);if(e.kind!==r.kind||"string"!==e.kind&&"number"!==e.kind)throw new at(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const t=it(o),r=it(s);if("string"!==t.kind||"string"!==r.kind)return e(i,o,s)}return this.collator?r(i,o,s,this.collator.evaluate(i)):e(i,o,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild(t=>{e.push(t.serialize())}),e}}}const Se=Ee("==",(function(t,e,r){return e===r}),xe),Ie=Ee("!=",(function(t,e,r){return e!==r}),(function(t,e,r,n){return!xe(0,e,r,n)})),Oe=Ee("<",(function(t,e,r){return e<r}),(function(t,e,r,n){return n.compare(e,r)<0})),Ce=Ee(">",(function(t,e,r){return e>r}),(function(t,e,r,n){return n.compare(e,r)>0})),Te=Ee("<=",(function(t,e,r){return e<=r}),(function(t,e,r,n){return n.compare(e,r)<=0})),Pe=Ee(">=",(function(t,e,r){return e>=r}),(function(t,e,r,n){return n.compare(e,r)>=0}));class Re{constructor(t,e,r,n,i){this.type=F,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const r=e.parse(t[1],1,A);if(!r)return null;const n=t[2];if("object"!=typeof n||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=e.parse(n.locale,1,F),!i))return null;let o=null;if(n.currency&&(o=e.parse(n.currency,1,F),!o))return null;let s=null;if(n["min-fraction-digits"]&&(s=e.parse(n["min-fraction-digits"],1,A),!s))return null;let a=null;return n["max-fraction-digits"]&&(a=e.parse(n["max-fraction-digits"],1,A),!a)?null:new Re(r,i,o,s,a)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Le{constructor(t){this.type=A,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error(`Expected argument of type string or array, but found ${Y(r.type)} instead.`):new Le(r):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new at(`Expected value to be of type string or array, but found ${Y(it(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Me={"==":Se,"!=":Ie,">":Ce,"<":Oe,">=":Pe,"<=":Te,array:ut,at:ge,boolean:ut,case:ve,coalesce:pe,collator:mt,format:ct,image:ht,in:ye,"index-of":me,interpolate:he,"interpolate-hcl":he,"interpolate-lab":he,length:Le,let:de,literal:st,match:_e,number:ut,"number-format":Re,object:ut,slice:be,step:Vt,string:ut,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:Gt,within:At};function ke(t,[e,r,n,i]){e=e.evaluate(t),r=r.evaluate(t),n=n.evaluate(t);const o=i?i.evaluate(t):1,s=rt(e,r,n,o);if(s)throw new at(s);return new $(e/255*o,r/255*o,n/255*o,o)}function Ne(t,e){return t in e}function Ae(t,e){const r=e[t];return void 0===r?null:r}function Fe(t){return{type:t}}function De(t){return{result:"success",value:t}}function je(t){return{result:"error",value:t}}function Ge(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function ze(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Ue(t){return!!t.expression&&t.expression.interpolated}function Be(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ve(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function qe(t){return t}function Ye(t,e){const r="color"===e.type,n=t.stops&&"object"==typeof t.stops[0][0],i=n||void 0!==t.property,o=n||!i,s=t.type||(Ue(e)?"exponential":"interval");if(r&&((t=L({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],$.parse(t[1])])),t.default?t.default=$.parse(t.default):t.default=$.parse(e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ce[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);let a,l,u;if("exponential"===s)a=Ze;else if("interval"===s)a=He;else if("categorical"===s){a=Xe,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];u=typeof t.stops[0][0]}else{if("identity"!==s)throw new Error(`Unknown function type "${s}"`);a=Ke}if(n){const r={},n=[];for(let e=0;e<t.stops.length;e++){const i=t.stops[e],o=i[0].zoom;void 0===r[o]&&(r[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},n.push(o)),r[o].stops.push([i[0].value,i[1]])}const i=[];for(const t of n)i.push([r[t].zoom,Ye(r[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:he.interpolationFactor.bind(void 0,o),zoomStops:i.map(t=>t[0]),evaluate:({zoom:r},n)=>Ze({stops:i,base:t.base},e,r).evaluate(r,n)}}if(o){const r="exponential"===s?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:he.interpolationFactor.bind(void 0,r),zoomStops:t.stops.map(t=>t[0]),evaluate:({zoom:r})=>a(t,e,r,l,u)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[t.property]:void 0;return void 0===i?We(t.default,e.default):a(t,e,i,l,u)}}}function We(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Xe(t,e,r,n,i){return We(typeof r===i?n[r]:void 0,t.default,e.default)}function He(t,e,r){if("number"!==Be(r))return We(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[n-1][0])return t.stops[n-1][1];const i=Bt(t.stops.map(t=>t[0]),r);return t.stops[i][1]}function Ze(t,e,r){const n=void 0!==t.base?t.base:1;if("number"!==Be(r))return We(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];const o=Bt(t.stops.map(t=>t[0]),r),s=function(t,e,r,n){const i=n-r,o=t-r;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(r,n,t.stops[o][0],t.stops[o+1][0]),a=t.stops[o][1],l=t.stops[o+1][1];let u=Xt[e.type]||qe;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=ce[t.colorSpace];u=(t,r)=>e.reverse(e.interpolate(e.forward(t),e.forward(r),s))}return"function"==typeof a.evaluate?{evaluate(...t){const e=a.evaluate.apply(void 0,t),r=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==r)return u(e,r,s)}}:u(a,l,s)}function Ke(t,e,r){return"color"===e.type?r=$.parse(r):"formatted"===e.type?r=tt.fromString(r.toString()):"resolvedImage"===e.type?r=et.fromString(r.toString()):Be(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),We(r,t.default,e.default)}yt.register(Me,{error:[{kind:"error"},[F],(t,[e])=>{throw new at(e.evaluate(t))}],typeof:[F,[z],(t,[e])=>Y(it(e.evaluate(t)))],"to-rgba":[q(A,4),[j],(t,[e])=>e.evaluate(t).toArray()],rgb:[j,[A,A,A],ke],rgba:[j,[A,A,A,A],ke],has:{type:D,overloads:[[[F],(t,[e])=>Ne(e.evaluate(t),t.properties())],[[F,G],(t,[e,r])=>Ne(e.evaluate(t),r.evaluate(t))]]},get:{type:z,overloads:[[[F],(t,[e])=>Ae(e.evaluate(t),t.properties())],[[F,G],(t,[e,r])=>Ae(e.evaluate(t),r.evaluate(t))]]},"feature-state":[z,[F],(t,[e])=>Ae(e.evaluate(t),t.featureState||{})],properties:[G,[],t=>t.properties()],"geometry-type":[F,[],t=>t.geometryType()],id:[z,[],t=>t.id()],zoom:[A,[],t=>t.globals.zoom],pitch:[A,[],t=>t.globals.pitch||0],"distance-from-center":[A,[],t=>t.distanceFromCenter()],"heatmap-density":[A,[],t=>t.globals.heatmapDensity||0],"line-progress":[A,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[A,[],t=>t.globals.skyRadialProgress||0],accumulated:[z,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[A,Fe(A),(t,e)=>{let r=0;for(const n of e)r+=n.evaluate(t);return r}],"*":[A,Fe(A),(t,e)=>{let r=1;for(const n of e)r*=n.evaluate(t);return r}],"-":{type:A,overloads:[[[A,A],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[A],(t,[e])=>-e.evaluate(t)]]},"/":[A,[A,A],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[A,[A,A],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[A,[],()=>Math.LN2],pi:[A,[],()=>Math.PI],e:[A,[],()=>Math.E],"^":[A,[A,A],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[A,[A],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[A,[A],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[A,[A],(t,[e])=>Math.log(e.evaluate(t))],log2:[A,[A],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[A,[A],(t,[e])=>Math.sin(e.evaluate(t))],cos:[A,[A],(t,[e])=>Math.cos(e.evaluate(t))],tan:[A,[A],(t,[e])=>Math.tan(e.evaluate(t))],asin:[A,[A],(t,[e])=>Math.asin(e.evaluate(t))],acos:[A,[A],(t,[e])=>Math.acos(e.evaluate(t))],atan:[A,[A],(t,[e])=>Math.atan(e.evaluate(t))],min:[A,Fe(A),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[A,Fe(A),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[A,[A],(t,[e])=>Math.abs(e.evaluate(t))],round:[A,[A],(t,[e])=>{const r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[A,[A],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[A,[A],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[D,[F,z],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[D,[z],(t,[e])=>t.id()===e.value],"filter-type-==":[D,[F],(t,[e])=>t.geometryType()===e.value],"filter-<":[D,[F,z],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[D,[z],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r<n}],"filter->":[D,[F,z],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[D,[z],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r>n}],"filter-<=":[D,[F,z],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[D,[z],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r<=n}],"filter->=":[D,[F,z],(t,[e,r])=>{const n=t.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[D,[z],(t,[e])=>{const r=t.id(),n=e.value;return typeof r==typeof n&&r>=n}],"filter-has":[D,[z],(t,[e])=>e.value in t.properties()],"filter-has-id":[D,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[D,[q(F)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[D,[q(z)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[D,[F,q(z)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[D,[F,q(z)],(t,[e,r])=>function(t,e,r,n){for(;r<=n;){const i=r+n>>1;if(e[i]===t)return!0;e[i]>t?n=i-1:r=i+1}return!1}(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:D,overloads:[[[D,D],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Fe(D),(t,e)=>{for(const r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:D,overloads:[[[D,D],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Fe(D),(t,e)=>{for(const r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[D,[D],(t,[e])=>!e.evaluate(t)],"is-supported-script":[D,[F],(t,[e])=>{const r=t.globals&&t.globals.isSupportedScript;return!r||r(e.evaluate(t))}],upcase:[F,[F],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[F,[F],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[F,Fe(z),(t,e)=>e.map(e=>ot(e.evaluate(t))).join("")],"resolved-locale":[F,[U],(t,[e])=>e.evaluate(t).resolvedLocale()]});class $e{constructor(t,e){var r;this.expression=t,this._warningHistory={},this._evaluator=new gt,this._defaultValue=e?"color"===(r=e).type&&Ve(r.default)?new $(0,0,0,0):"color"===r.type?$.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,r,n,i,o,s,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,r,n,i,o,s,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new at(`Expected value to be one of ${Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Je(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Me}function Qe(t,e){const r=new zt(Me,[],e?function(t){const e={color:j,string:F,number:A,enum:F,boolean:D,formatted:B,resolvedImage:V};if("array"===t.type)return q(e[t.value]||z,t.length);return e[t.type]}(e):void 0),n=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?De(new $e(n,e)):je(r.errors)}class tr{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Dt(e.expression)}evaluateWithoutErrorHandling(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)}evaluate(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)}}class er{constructor(t,e,r,n){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Dt(e.expression),this.interpolationType=n}evaluateWithoutErrorHandling(t,e,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,n,i,o)}evaluate(t,e,r,n,i,o){return this._styleExpression.evaluate(t,e,r,n,i,o)}interpolationFactor(t,e,r){return this.interpolationType?he.interpolationFactor(this.interpolationType,t,e,r):0}}function rr(t,e){if("error"===(t=Qe(t,e)).result)return t;const r=t.value.expression,n=Ft(r);if(!n&&!Ge(e))return je([new M("","data expressions not supported")]);const i=jt(r,["zoom","pitch","distance-from-center"]);if(!i&&!ze(e))return je([new M("","zoom expressions not supported")]);const o=ir(r);if(!o&&!i)return je([new M("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof M)return je([o]);if(o instanceof he&&!Ue(e))return je([new M("",'"interpolate" expressions cannot be used with this property')]);if(!o)return De(new tr(n?"constant":"source",t.value));const s=o instanceof he?o.interpolation:void 0;return De(new er(n?"camera":"composite",t.value,o.labels,s))}class nr{constructor(t,e){this._parameters=t,this._specification=e,L(this,Ye(this._parameters,this._specification))}static deserialize(t){return new nr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ir(t){let e=null;if(t instanceof de)e=ir(t.result);else if(t instanceof pe){for(const r of t.args)if(e=ir(r),e)break}else(t instanceof Vt||t instanceof he)&&t.input instanceof yt&&"zoom"===t.input.name&&(e=t);return e instanceof M||t.eachChild(t=>{const r=ir(t);r instanceof M?e=r:!e&&r?e=new M("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new M("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function or(t){return"object"==typeof t?["literal",t]:t}function sr(t,e){let r=t.stops;if(!r)return function(t,e){const r=["get",t.property];if(void 0===t.default)return"string"===e.type?["string",r]:r;if("enum"===e.type)return["match",r,Object.keys(e.values),r,t.default];{const n=["color"===e.type?"to-color":e.type,r,or(t.default)];return"array"===e.type&&n.splice(1,0,e.value,e.length||null),n}}(t,e);const n=r&&"object"==typeof r[0][0],i=n||void 0!==t.property,o=n||!i;return r=r.map(t=>!i&&e.tokens&&"string"==typeof t[1]?[t[0],pr(t[1])]:[t[0],or(t[1])]),n?function(t,e,r){const n={},i={},o=[];for(let e=0;e<r.length;e++){const s=r[e],a=s[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:t.type,property:t.property,default:t.default},i[a]=[],o.push(a)),i[a].push([s[0].value,s[1]])}if("exponential"===fr({},e)){const r=[ar(t),["linear"],["zoom"]];for(const t of o){hr(r,t,ur(n[t],e,i[t]),!1)}return r}{const t=["step",["zoom"]];for(const r of o){hr(t,r,ur(n[r],e,i[r]),!0)}return cr(t),t}}(t,e,r):o?function(t,e,r,n=["zoom"]){const i=fr(t,e);let o,s=!1;if("interval"===i)o=["step",n],s=!0;else{if("exponential"!==i)throw new Error(`Unknown zoom function type "${i}"`);{const e=void 0!==t.base?t.base:1;o=[ar(t),1===e?["linear"]:["exponential",e],n]}}for(const t of r)hr(o,t[0],t[1],s);return cr(o),o}(t,e,r):ur(t,e,r)}function ar(t){switch(t.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function lr(t,e){const r=or((n=t.default,i=e.default,void 0!==n?n:void 0!==i?i:void 0));var n,i;return void 0===r&&"resolvedImage"===e.type?"":r}function ur(t,e,r){const n=fr(t,e),i=["get",t.property];if("categorical"===n&&"boolean"==typeof r[0][0]){const n=["case"];for(const t of r)n.push(["==",i,t[0]],t[1]);return n.push(lr(t,e)),n}if("categorical"===n){const n=["match",i];for(const t of r)hr(n,t[0],t[1],!1);return n.push(lr(t,e)),n}if("interval"===n){const e=["step",["number",i]];for(const t of r)hr(e,t[0],t[1],!0);return cr(e),void 0===t.default?e:["case",["==",["typeof",i],"number"],e,or(t.default)]}if("exponential"===n){const e=void 0!==t.base?t.base:1,n=[ar(t),1===e?["linear"]:["exponential",e],["number",i]];for(const t of r)hr(n,t[0],t[1],!1);return void 0===t.default?n:["case",["==",["typeof",i],"number"],n,or(t.default)]}throw new Error("Unknown property function type "+n)}function cr(t){"step"===t[0]&&3===t.length&&(t.push(0),t.push(t[3]))}function hr(t,e,r,n){t.length>3&&e===t[t.length-2]||(n&&2===t.length||t.push(e),t.push(r))}function fr(t,e){return t.type?t.type:e.expression.interpolated?"exponential":"interval"}function pr(t){const e=["concat"],r=/{([^{}]+)}/g;let n=0;for(let i=r.exec(t);null!==i;i=r.exec(t)){const o=t.slice(n,r.lastIndex-i[0].length);n=r.lastIndex,o.length>0&&e.push(o),e.push(["get",i[1]])}if(1===e.length)return t;if(n<t.length)e.push(t.slice(n));else if(2===e.length)return["to-string",e[1]];return e}function dr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function gr(t){if(Array.isArray(t))return t.map(gr);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const r in t)e[r]=gr(t[r]);return e}return dr(t)}function yr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!yr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function mr(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yr(t)||(t=Sr(t));const r=t;let n=!0;try{n=function(t){if(!br(t))return t;let e=gr(t);return vr(e),e=_r(e),e}(r)}catch(t){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const o=i["filter_"+e],s=Qe(n,o);let a=null;if("error"===s.result)throw new Error(s.value.map(t=>`${t.key}: ${t.message}`).join(", "));a=(t,e,r)=>s.value.evaluate(t,e,{},r);let l=null,u=null;if(n!==r){const t=Qe(r,o);if("error"===t.result)throw new Error(t.value.map(t=>`${t.key}: ${t.message}`).join(", "));l=(e,r,n,i,o)=>t.value.evaluate(e,r,{},n,void 0,void 0,i,o),u=!Ft(t.value.expression)}a=a;return{filter:a,dynamicFilter:l||void 0,needGeometry:Er(n),needFeature:!!u}}function _r(t){if(!Array.isArray(t))return t;const e=function(t){if(wr.has(t[0]))for(let e=1;e<t.length;e++){if(br(t[e]))return!0}return t}(t);return!0===e?e:e.map(t=>_r(t))}function vr(t){let e=!1;const r=[];if("case"===t[0]){for(let n=1;n<t.length-1;n+=2)e=e||br(t[n]),r.push(t[n+1]);r.push(t[t.length-1])}else if("match"===t[0]){e=e||br(t[1]);for(let e=2;e<t.length-1;e+=2)r.push(t[e+1]);r.push(t[t.length-1])}else if("step"===t[0]){e=e||br(t[1]);for(let e=1;e<t.length-1;e+=2)r.push(t[e+1])}e&&(t.length=0,t.push("any",...r));for(let e=1;e<t.length;e++)vr(t[e])}function br(t){if(!Array.isArray(t))return!1;if(function(t){return"pitch"===t||"distance-from-center"===t}(t[0]))return!0;for(let e=1;e<t.length;e++){if(br(t[e]))return!0}return!1}const wr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function xr(t,e){return t<e?-1:t>e?1:0}function Er(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Er(t[e]))return!0;return!1}function Sr(t){if(!t)return!0;const e=t[0];if(t.length<=1)return"any"!==e;var r;return"=="===e?Ir(t[1],t[2],"=="):"!="===e?Tr(Ir(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ir(t[1],t[2],e):"any"===e?(r=t.slice(1),["any"].concat(r.map(Sr))):"all"===e?["all"].concat(t.slice(1).map(Sr)):"none"===e?["all"].concat(t.slice(1).map(Sr).map(Tr)):"in"===e?Or(t[1],t.slice(2)):"!in"===e?Tr(Or(t[1],t.slice(2))):"has"===e?Cr(t[1]):"!has"===e?Tr(Cr(t[1])):"within"!==e||t}function Ir(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function Or(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(xr)]]:["filter-in-small",t,["literal",e]]}}function Cr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Tr(t){return["!",t]}var Pr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Rr(t,e){const r={};for(const e in t)"ref"!==e&&(r[e]=t[e]);return Pr.forEach(t=>{t in e&&(r[t]=e[t])}),r}function Lr(t){t=t.slice();const e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Rr(t[r],e[t[r].ref]));return t}class Mr{constructor(t,e,r,n){this.message=(t?t+": ":"")+r,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__)}}class kr{constructor(t){this.error=t,this.message=t.message;const e=t.message.match(/line (\d+)/);this.line=e?parseInt(e[1],10):0}}function Nr(t){const e=t.key,r=t.value;return r?[new Mr(e,r,"constants have been deprecated as of v8")]:[]}function Ar(t){const e=t.key,r=t.value,n=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,s=t.styleSpec;let a=[];const l=Be(r);if("object"!==l)return[new Mr(e,r,`object expected, ${l} found`)];for(const t in r){const l=t.split(".")[0],u=n[l]||n["*"];let c;if(i[l])c=i[l];else if(n[l])c=en;else if(i["*"])c=i["*"];else{if(!n["*"]){a.push(new Mr(e,r[t],`unknown property "${t}"`));continue}c=en}a=a.concat(c({key:(e?e+".":e)+t,value:r[t],valueSpec:u,style:o,styleSpec:s,object:r,objectKey:t},r))}for(const t in n)i[t]||n[t].required&&void 0===n[t].default&&void 0===r[t]&&a.push(new Mr(e,r,`missing required property "${t}"`));return a}function Fr(t){const e=t.value,r=t.valueSpec,n=t.style,i=t.styleSpec,o=t.key,s=t.arrayElementValidator||en;if("array"!==Be(e))return[new Mr(o,e,`array expected, ${Be(e)} found`)];if(r.length&&e.length!==r.length)return[new Mr(o,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new Mr(o,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let a={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum};i.$version<7&&(a.function=r.function),"object"===Be(r.value)&&(a=r.value);let l=[];for(let t=0;t<e.length;t++)l=l.concat(s({array:e,arrayIndex:t,value:e[t],valueSpec:a,style:n,styleSpec:i,key:`${o}[${t}]`}));return l}function Dr(t){const e=t.key,r=t.value,n=t.valueSpec;let i=Be(r);if("number"===i&&r!=r&&(i="NaN"),"number"!==i)return[new Mr(e,r,`number expected, ${i} found`)];if("minimum"in n){let i=n.minimum;if("array"===Be(n.minimum)){const e=t.arrayIndex;i=n.minimum[e]}if(r<i)return[new Mr(e,r,`${r} is less than the minimum value ${i}`)]}if("maximum"in n){let i=n.maximum;if("array"===Be(n.maximum)){const e=t.arrayIndex;i=n.maximum[e]}if(r>i)return[new Mr(e,r,`${r} is greater than the maximum value ${i}`)]}return[]}function jr(t){const e=t.valueSpec,r=dr(t.value.type);let n,i,o,s={};const a="categorical"!==r&&void 0===t.value.property,l=!a,u="array"===Be(t.value.stops)&&"array"===Be(t.value.stops[0])&&"object"===Be(t.value.stops[0][0]),c=Ar({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===r)return[new Mr(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const n=t.value;e=e.concat(Fr({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Be(n)&&0===n.length&&e.push(new Mr(t.key,n,"array must have at least one stop"));return e},default:function(t){return en({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===r&&a&&c.push(new Mr(t.key,t.value,'missing required property "property"')),"identity"===r||t.value.stops||c.push(new Mr(t.key,t.value,'missing required property "stops"')),"exponential"===r&&t.valueSpec.expression&&!Ue(t.valueSpec)&&c.push(new Mr(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Ge(t.valueSpec)?c.push(new Mr(t.key,t.value,"property functions not supported")):a&&!ze(t.valueSpec)&&c.push(new Mr(t.key,t.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==t.value.property||c.push(new Mr(t.key,t.value,'"property" property is required')),c;function h(t){let r=[];const n=t.value,a=t.key;if("array"!==Be(n))return[new Mr(a,n,`array expected, ${Be(n)} found`)];if(2!==n.length)return[new Mr(a,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==Be(n[0]))return[new Mr(a,n,`object expected, ${Be(n[0])} found`)];if(void 0===n[0].zoom)return[new Mr(a,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Mr(a,n,"object stop key must have value")];if(o&&o>dr(n[0].zoom))return[new Mr(a,n[0].zoom,"stop zoom values must appear in ascending order")];dr(n[0].zoom)!==o&&(o=dr(n[0].zoom),i=void 0,s={}),r=r.concat(Ar({key:a+"[0]",value:n[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Dr,value:f}}))}else r=r.concat(f({key:a+"[0]",value:n[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},n));return Je(gr(n[1]))?r.concat([new Mr(a+"[1]",n[1],"expressions are not allowed in function stops.")]):r.concat(en({key:a+"[1]",value:n[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function f(t,o){const a=Be(t.value),l=dr(t.value),u=null!==t.value?t.value:o;if(n){if(a!==n)return[new Mr(t.key,u,`${a} stop domain type must match previous stop domain type ${n}`)]}else n=a;if("number"!==a&&"string"!==a&&"boolean"!==a)return[new Mr(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==r){let n=`number expected, ${a} found`;return Ge(e)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Mr(t.key,u,n)]}return"categorical"!==r||"number"!==a||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===a&&void 0!==i&&l<i?[new Mr(t.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in s?[new Mr(t.key,u,"stop domain values must be unique")]:(s[l]=!0,[])):[new Mr(t.key,u,"integer expected, found "+l)]}}function Gr(t){const e=("property"===t.expressionContext?rr:Qe)(gr(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new Mr(`${t.key}${e.key}`,t.value,e.message));const r=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return[new Mr(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Dt(r))return[new Mr(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return zr(r,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!jt(r,["zoom","feature-state"]))return[new Mr(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ft(r))return[new Mr(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zr(t,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const t of e.valueSpec.expression.parameters)r.delete(t);if(0===r.size)return[];const n=[];return t instanceof yt&&r.has(t.name)?[new Mr(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(t=>{n.push(...zr(t,e))}),n)}function Ur(t){const e=t.key,r=t.value,n=t.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(dr(r))&&i.push(new Mr(e,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(dr(r))&&i.push(new Mr(e,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function Br(t){if(yr(gr(t.value))){const e=gr(t.layerType);return Gr(L({},t,{expressionContext:"filter",valueSpec:t.styleSpec["filter_"+(e||"fill")]}))}return Vr(t)}function Vr(t){const e=t.value,r=t.key;if("array"!==Be(e))return[new Mr(r,e,`array expected, ${Be(e)} found`)];const n=t.styleSpec;let i,o=[];if(e.length<1)return[new Mr(r,e,"filter array must have at least 1 element")];switch(o=o.concat(Ur({key:r+"[0]",value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),dr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===dr(e[1])&&o.push(new Mr(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&o.push(new Mr(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(i=Be(e[1]),"string"!==i&&o.push(new Mr(r+"[1]",e[1],`string expected, ${i} found`)));for(let s=2;s<e.length;s++)i=Be(e[s]),"$type"===dr(e[1])?o=o.concat(Ur({key:`${r}[${s}]`,value:e[s],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new Mr(`${r}[${s}]`,e[s],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<e.length;n++)o=o.concat(Vr({key:`${r}[${n}]`,value:e[n],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=Be(e[1]),2!==e.length?o.push(new Mr(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==i&&o.push(new Mr(r+"[1]",e[1],`string expected, ${i} found`));break;case"within":i=Be(e[1]),2!==e.length?o.push(new Mr(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==i&&o.push(new Mr(r+"[1]",e[1],`object expected, ${i} found`))}return o}function qr(t,e){const r=t.key,n=t.style,i=t.styleSpec,o=t.value,s=t.objectKey,a=i[`${e}_${t.layerType}`];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===e&&l&&a[l[1]]&&a[l[1]].transition)return en({key:r,value:o,valueSpec:i.transition,style:n,styleSpec:i});const u=t.valueSpec||a[s];if(!u)return[new Mr(r,o,`unknown property "${s}"`)];let c;if("string"===Be(o)&&Ge(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new Mr(r,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===s&&n&&!n.glyphs&&h.push(new Mr(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Ve(gr(o))&&"identity"===dr(o.type)&&h.push(new Mr(r,o,'"text-font" does not support identity functions'))),h.concat(en({key:t.key,value:o,valueSpec:u,style:n,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:s}))}function Yr(t){return qr(t,"paint")}function Wr(t){return qr(t,"layout")}function Xr(t){let e=[];const r=t.value,n=t.key,i=t.style,o=t.styleSpec;r.type||r.ref||e.push(new Mr(n,r,'either "type" or "ref" is required'));let s=dr(r.type);const a=dr(r.ref);if(r.id){const o=dr(r.id);for(let s=0;s<t.arrayIndex;s++){const t=i.layers[s];dr(t.id)===o&&e.push(new Mr(n,r.id,`duplicate layer id "${r.id}", previously used at line ${t.id.__line__}`))}}if("ref"in r){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in r&&e.push(new Mr(n,r[t],`"${t}" is prohibited for ref layers`))}),i.layers.forEach(e=>{dr(e.id)===a&&(t=e)}),t?t.ref?e.push(new Mr(n,r.ref,"ref cannot reference another ref layer")):s=dr(t.type):e.push(new Mr(n,r.ref,`ref layer "${a}" not found`))}else if("background"!==s&&"sky"!==s)if(r.source){const t=i.sources&&i.sources[r.source],o=t&&dr(t.type);t?"vector"===o&&"raster"===s?e.push(new Mr(n,r.source,`layer "${r.id}" requires a raster source`)):"raster"===o&&"raster"!==s?e.push(new Mr(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==o||r["source-layer"]?"raster-dem"===o&&"hillshade"!==s?e.push(new Mr(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===o&&t.lineMetrics||e.push(new Mr(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Mr(n,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new Mr(n,r.source,`source "${r.source}" not found`))}else e.push(new Mr(n,r,'missing required property "source"'));return e=e.concat(Ar({key:n,value:r,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>en({key:n+".type",value:r.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"}),filter:t=>Br(L({layerType:s},t)),layout:t=>Ar({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Wr(L({layerType:s},t))}}),paint:t=>Ar({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Yr(L({layerType:s},t))}})}})),e}function Hr(t){const e=t.value,r=t.key,n=Be(e);return"string"!==n?[new Mr(r,e,`string expected, ${n} found`)]:[]}const Zr={promoteId:function({key:t,value:e}){if("string"===Be(e))return Hr({key:t,value:e});{const r=[];for(const n in e)r.push(...Hr({key:`${t}.${n}`,value:e[n]}));return r}}};function Kr(t){const e=t.value,r=t.key,n=t.styleSpec,i=t.style;if(!e.type)return[new Mr(r,e,'"type" is required')];const o=dr(e.type);let s;switch(o){case"vector":case"raster":case"raster-dem":return s=Ar({key:r,value:e,valueSpec:n["source_"+o.replace("-","_")],style:t.style,styleSpec:n,objectElementValidators:Zr}),s;case"geojson":if(s=Ar({key:r,value:e,valueSpec:n.source_geojson,style:i,styleSpec:n,objectElementValidators:Zr}),e.cluster)for(const t in e.clusterProperties){const[n,i]=e.clusterProperties[t],o="string"==typeof n?[n,["accumulated"],["get",t]]:n;s.push(...Gr({key:`${r}.${t}.map`,value:i,expressionContext:"cluster-map"})),s.push(...Gr({key:`${r}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return Ar({key:r,value:e,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return Ar({key:r,value:e,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return[new Mr(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ur({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function $r(t){const e=t.value,r=t.styleSpec,n=r.light,i=t.style;let o=[];const s=Be(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new Mr("light",e,`object expected, ${s} found`)]),o;for(const t in e){const s=t.match(/^(.*)-transition$/);o=s&&n[s[1]]&&n[s[1]].transition?o.concat(en({key:t,value:e[t],valueSpec:r.transition,style:i,styleSpec:r})):n[t]?o.concat(en({key:t,value:e[t],valueSpec:n[t],style:i,styleSpec:r})):o.concat([new Mr(t,e[t],`unknown property "${t}"`)])}return o}function Jr(t){const e=t.value,r=t.key,n=t.style,i=t.styleSpec,o=i.terrain;let s=[];const a=Be(e);if(void 0===e)return s;if("object"!==a)return s=s.concat([new Mr("terrain",e,`object expected, ${a} found`)]),s;for(const t in e){const r=t.match(/^(.*)-transition$/);s=r&&o[r[1]]&&o[r[1]].transition?s.concat(en({key:t,value:e[t],valueSpec:i.transition,style:n,styleSpec:i})):o[t]?s.concat(en({key:t,value:e[t],valueSpec:o[t],style:n,styleSpec:i})):s.concat([new Mr(t,e[t],`unknown property "${t}"`)])}if(e.source){const t=n.sources&&n.sources[e.source],i=t&&dr(t.type);t?"raster-dem"!==i&&s.push(new Mr(r,e.source,`terrain cannot be used with a source of type ${i}, it only be used with a "raster-dem" source type`)):s.push(new Mr(r,e.source,`source "${e.source}" not found`))}else s.push(new Mr(r,e,'terrain is missing required property "source"'));return s}function Qr(t){const e=t.value,r=t.style,n=t.styleSpec,i=n.fog;let o=[];const s=Be(e);if(void 0===e)return o;if("object"!==s)return o=o.concat([new Mr("fog",e,`object expected, ${s} found`)]),o;for(const t in e){const s=t.match(/^(.*)-transition$/);o=s&&i[s[1]]&&i[s[1]].transition?o.concat(en({key:t,value:e[t],valueSpec:n.transition,style:r,styleSpec:n})):i[t]?o.concat(en({key:t,value:e[t],valueSpec:i[t],style:r,styleSpec:n})):o.concat([new Mr(t,e[t],`unknown property "${t}"`)])}return o}const tn={"*":()=>[],array:Fr,boolean:function(t){const e=t.value,r=t.key,n=Be(e);return"boolean"!==n?[new Mr(r,e,`boolean expected, ${n} found`)]:[]},number:Dr,color:function(t){const e=t.key,r=t.value,n=Be(r);return"string"!==n?[new Mr(e,r,`color expected, ${n} found`)]:null===K.parseCSSColor(r)?[new Mr(e,r,`color expected, "${r}" found`)]:[]},constants:Nr,enum:Ur,filter:Br,function:jr,layer:Xr,object:Ar,source:Kr,light:$r,terrain:Jr,fog:Qr,string:Hr,formatted:function(t){return 0===Hr(t).length?[]:Gr(t)},resolvedImage:function(t){return 0===Hr(t).length?[]:Gr(t)},projection:function(t){const e=t.value,r=t.styleSpec,n=r.projection,i=t.style;let o=[];const s=Be(e);if("object"===s)for(const t in e)o=o.concat(en({key:t,value:e[t],valueSpec:n[t],style:i,styleSpec:r}));else"string"!==s&&(o=o.concat([new Mr("projection",e,`object or string expected, ${s} found`)]));return o}};function en(t){const e=t.value,r=t.valueSpec,n=t.styleSpec;if(r.expression&&Ve(dr(e)))return jr(t);if(r.expression&&Je(gr(e)))return Gr(t);if(r.type&&tn[r.type])return tn[r.type](t);return Ar(L({},t,{valueSpec:r.type?n[r.type]:r}))}function rn(t){const e=t.value,r=t.key,n=Hr(t);return n.length||(-1===e.indexOf("{fontstack}")&&n.push(new Mr(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new Mr(r,e,'"glyphs" url must include a "{range}" token'))),n}function nn(t,e=i){let r=[];return r=r.concat(en({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:rn,"*":()=>[]}})),t.constants&&(r=r.concat(Nr({key:"constants",value:t.constants,style:t,styleSpec:e}))),on(r)}function on(t){return[].concat(t).sort((t,e)=>t.line-e.line)}function sn(t){return function(...e){return on(t.apply(this,e))}}nn.source=sn(Kr),nn.light=sn($r),nn.terrain=sn(Jr),nn.fog=sn(Qr),nn.layer=sn(Xr),nn.filter=sn(Br),nn.paintProperty=sn(Yr),nn.layoutProperty=sn(Wr);var an=s((function(t,e){var r=function(){var t=function(t,e,r,n){for(r=r||{},n=t.length;n--;r[t[n]]=e);return r},e=[1,12],r=[1,13],n=[1,9],i=[1,10],o=[1,11],s=[1,14],a=[1,15],l=[14,18,22,24],u=[18,22],c=[22,24],h={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,r,n,i,o,s){var a=o.length-1;switch(i){case 1:this.$=new String(t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(t),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=o[a-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=o[a-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[o[a-2],o[a]];break;case 16:this.$={},this.$[o[a][0]]=o[a][1];break;case 17:this.$=o[a-2],o[a-2][o[a][0]]=o[a][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[o[a]];break;case 21:this.$=o[a-2],o[a-2].push(o[a])}},table:[{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,12:1,13:2,15:7,16:8,17:s,23:a},{1:[3]},{14:[1,16]},t(l,[2,7]),t(l,[2,8]),t(l,[2,9]),t(l,[2,10]),t(l,[2,11]),t(l,[2,12]),t(l,[2,3]),t(l,[2,4]),t(l,[2,5]),t([14,18,21,22,24],[2,1]),t(l,[2,2]),{3:20,4:e,18:[1,17],19:18,20:19},{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:23,15:7,16:8,17:s,23:a,24:[1,21],25:22},{1:[2,6]},t(l,[2,13]),{18:[1,24],22:[1,25]},t(u,[2,16]),{21:[1,26]},t(l,[2,18]),{22:[1,28],24:[1,27]},t(c,[2,20]),t(l,[2,14]),{3:20,4:e,20:29},{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:30,15:7,16:8,17:s,23:a},t(l,[2,19]),{3:5,4:e,5:6,6:r,7:3,8:n,9:4,10:i,11:o,13:31,15:7,16:8,17:s,23:a},t(u,[2,17]),t(u,[2,15]),t(c,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],i=[],o=this.table,s="",a=0,l=0,u=2,c=1,h=i.slice.call(arguments,1),f=Object.create(this.lexer),p={yy:{}};for(var d in this.yy)Object.prototype.hasOwnProperty.call(this.yy,d)&&(p.yy[d]=this.yy[d]);f.setInput(t,p.yy),p.yy.lexer=f,p.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var g=f.yylloc;i.push(g);var y=f.options&&f.options.ranges;function m(){var t;return"number"!=typeof(t=f.lex()||c)&&(t=e.symbols_[t]||t),t}"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var _,v,b,w,x,E,S,I,O={};;){if(v=r[r.length-1],this.defaultActions[v]?b=this.defaultActions[v]:(null==_&&(_=m()),b=o[v]&&o[v][_]),void 0===b||!b.length||!b[0]){var C="";for(x in I=[],o[v])this.terminals_[x]&&x>u&&I.push("'"+this.terminals_[x]+"'");C=f.showPosition?"Parse error on line "+(a+1)+":\n"+f.showPosition()+"\nExpecting "+I.join(", ")+", got '"+(this.terminals_[_]||_)+"'":"Parse error on line "+(a+1)+": Unexpected "+(_==c?"end of input":"'"+(this.terminals_[_]||_)+"'"),this.parseError(C,{text:f.match,token:this.terminals_[_]||_,line:f.yylineno,loc:g,expected:I})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+_);switch(b[0]){case 1:r.push(_),n.push(f.yytext),i.push(f.yylloc),r.push(b[1]),_=null,l=f.yyleng,s=f.yytext,a=f.yylineno,g=f.yylloc;break;case 2:if(E=this.productions_[b[1]][1],O.$=n[n.length-E],O._$={first_line:i[i.length-(E||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(E||1)].first_column,last_column:i[i.length-1].last_column},y&&(O._$.range=[i[i.length-(E||1)].range[0],i[i.length-1].range[1]]),void 0!==(w=this.performAction.apply(O,[s,l,a,p.yy,b[1],n,i].concat(h))))return w;E&&(r=r.slice(0,-1*E*2),n=n.slice(0,-1*E),i=i.slice(0,-1*E)),r.push(this.productions_[b[1]][0]),n.push(O.$),i.push(O._$),S=o[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},f={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((r=this._input.match(this.rules[i[o]]))&&(!e||r[0].length>e[0].length)){if(e=r,n=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,i[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,r,n){switch(r){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function p(){this.yy={}}return h.lexer=f,p.prototype=h,h.Parser=p,new p}();e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)}}));function ln(t){if(t instanceof String||"string"==typeof t||t instanceof n)try{return an.parse(t.toString())}catch(t){throw new kr(t)}return t}function un(t,e=i){let r=t;try{r=ln(r)}catch(t){return[t]}return nn(r,e)}new Set(["vector","raster","raster-dem"]);const cn={StyleExpression:$e,isExpression:Je,isExpressionFilter:yr,createExpression:Qe,createPropertyExpression:rr,normalizePropertyExpression:function(t,e){if(Ve(t))return new nr(t,e);if(Je(t)){const r=rr(t,e);if("error"===r.result)throw new Error(r.value.map(t=>`${t.key}: ${t.message}`).join(", "));return r.value}{let r=t;return"string"==typeof t&&"color"===e.type&&(r=$.parse(t)),{kind:"constant",evaluate:()=>r}}},ZoomConstantExpression:tr,ZoomDependentExpression:er,StylePropertyFunction:nr},hn={convertFunction:sr,createFunction:Ye,isFunction:Ve};un.parsed=un,un.latest=un}).call(this,r(22),r(23).Buffer)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{async fetch(t,e){return Promise.all(t.map(t=>this.fetchSlice(t,e)))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}},function(t,e,r){
/**!

 @license
 handlebars v4.5.2

Copyright (C) 2011-2017 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
t.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(){var t=f();return t.compile=function(e,r){return l.compile(e,r,t)},t.precompile=function(e,r){return l.precompile(e,r,t)},t.AST=s.default,t.Compiler=l.Compiler,t.JavaScriptCompiler=u.default,t.Parser=a.parser,t.parse=a.parse,t.parseWithoutProcessing=a.parseWithoutProcessing,t}var i=r(1).default;e.__esModule=!0;var o=i(r(2)),s=i(r(35)),a=r(36),l=r(41),u=i(r(42)),c=i(r(39)),h=i(r(34)),f=o.default.create,p=n();p.create=n,h.default(p),p.Visitor=c.default,p.default=p,e.default=p,t.exports=e.default},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,r){"use strict";function n(){var t=new s.HandlebarsEnvironment;return u.extend(t,s),t.SafeString=a.default,t.Exception=l.default,t.Utils=u,t.escapeExpression=u.escapeExpression,t.VM=c,t.template=function(e){return c.template(e,t)},t}var i=r(3).default,o=r(1).default;e.__esModule=!0;var s=i(r(4)),a=o(r(21)),l=o(r(6)),u=i(r(5)),c=i(r(22)),h=o(r(34)),f=n();f.create=n,h.default(f),f.default=f,e.default=f,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},e.__esModule=!0},function(t,e,r){"use strict";function n(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},a.registerDefaultHelpers(this),l.registerDefaultDecorators(this)}var i=r(1).default;e.__esModule=!0,e.HandlebarsEnvironment=n;var o=r(5),s=i(r(6)),a=r(10),l=r(18),u=i(r(20)),c="4.5.2";e.VERSION=c;var h=8;e.COMPILER_REVISION=h;var f=7;e.LAST_COMPATIBLE_COMPILER_REVISION=f;var p={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};e.REVISION_CHANGES=p;var d="[object Object]";n.prototype={constructor:n,logger:u.default,log:u.default.log,registerHelper:function(t,e){if(o.toString.call(t)===d){if(e)throw new s.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===d)o.extend(this.partials,t);else{if(void 0===e)throw new s.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===d){if(e)throw new s.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var g=u.default.log;e.log=g,e.createFrame=o.createFrame,e.logger=u.default},function(t,e){"use strict";function r(t){return c[t]}function n(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}function i(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function o(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return f.test(t)?t.replace(h,r):t}function s(t){return!t&&0!==t||!(!g(t)||0!==t.length)}function a(t){var e=n({},t);return e._parent=t,e}function l(t,e){return t.path=e,t}function u(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=n,e.indexOf=i,e.escapeExpression=o,e.isEmpty=s,e.createFrame=a,e.blockParams=l,e.appendContextPath=u;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},h=/[&<>"'`=]/g,f=/[&<>"'`=]/,p=Object.prototype.toString;e.toString=p;var d=function(t){return"function"==typeof t};d(/x/)&&(e.isFunction=d=function(t){return"function"==typeof t&&"[object Function]"===p.call(t)}),e.isFunction=d;var g=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===p.call(t)};e.isArray=g},function(t,e,r){"use strict";function n(t,e){var r=e&&e.loc,s=void 0,a=void 0,l=void 0,u=void 0;r&&(s=r.start.line,a=r.end.line,l=r.start.column,u=r.end.column,t+=" - "+s+":"+l);for(var c=Error.prototype.constructor.call(this,t),h=0;h<o.length;h++)this[o[h]]=c[o[h]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{r&&(this.lineNumber=s,this.endLineNumber=a,i?(Object.defineProperty(this,"column",{value:l,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:u,enumerable:!0})):(this.column=l,this.endColumn=u))}catch(t){}}var i=r(7).default;e.__esModule=!0;var o=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];n.prototype=new Error,e.default=n,t.exports=e.default},function(t,e,r){t.exports={default:r(8),__esModule:!0}},function(t,e,r){var n=r(9);t.exports=function(t,e,r){return n.setDesc(t,e,r)}},function(t,e){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(t,e,r){"use strict";function n(t){s.default(t),a.default(t),l.default(t),u.default(t),c.default(t),h.default(t),f.default(t)}function i(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])}var o=r(1).default;e.__esModule=!0,e.registerDefaultHelpers=n,e.moveHelperToHooks=i;var s=o(r(11)),a=o(r(12)),l=o(r(13)),u=o(r(14)),c=o(r(15)),h=o(r(16)),f=o(r(17))},function(t,e,r){"use strict";e.__esModule=!0;var n=r(5);e.default=function(t){t.registerHelper("blockHelperMissing",(function(e,r){var i=r.inverse,o=r.fn;if(!0===e)return o(this);if(!1===e||null==e)return i(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):i(this);if(r.data&&r.ids){var s=n.createFrame(r.data);s.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:s}}return o(e,r)}))},t.exports=e.default},function(t,e,r){(function(n){"use strict";var i=r(1).default;e.__esModule=!0;var o=r(5),s=i(r(6));e.default=function(t){t.registerHelper("each",(function(t,e){function r(e,r,n){c&&(c.key=e,c.index=r,c.first=0===r,c.last=!!n,h&&(c.contextPath=h+e)),u+=i(t[e],{data:c,blockParams:o.blockParams([t[e],e],[h+e,null])})}if(!e)throw new s.default("Must pass iterator to #each");var i=e.fn,a=e.inverse,l=0,u="",c=void 0,h=void 0;if(e.data&&e.ids&&(h=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(c=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var f=t.length;l<f;l++)l in t&&r(l,l,l===t.length-1);else if(n.Symbol&&t[n.Symbol.iterator]){for(var p=[],d=t[n.Symbol.iterator](),g=d.next();!g.done;g=d.next())p.push(g.value);for(f=(t=p).length;l<f;l++)r(l,l,l===t.length-1)}else{var y=void 0;for(var m in t)t.hasOwnProperty(m)&&(void 0!==y&&r(y,l-1),y=m,l++);void 0!==y&&r(y,l-1,!0)}return 0===l&&(u=a(this)),u}))},t.exports=e.default}).call(e,function(){return this}())},function(t,e,r){"use strict";var n=r(1).default;e.__esModule=!0;var i=n(r(6));e.default=function(t){t.registerHelper("helperMissing",(function(){if(1!==arguments.length)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}))},t.exports=e.default},function(t,e,r){"use strict";var n=r(1).default;e.__esModule=!0;var i=r(5),o=n(r(6));e.default=function(t){t.registerHelper("if",(function(t,e){if(2!=arguments.length)throw new o.default("#if requires exactly one argument");return i.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||i.isEmpty(t)?e.inverse(this):e.fn(this)})),t.registerHelper("unless",(function(e,r){if(2!=arguments.length)throw new o.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})}))},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",(function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var i=1;null!=r.hash.level?i=r.hash.level:r.data&&null!=r.data.level&&(i=r.data.level),e[0]=i,t.log.apply(t,e)}))},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",(function(t,e){return t?"constructor"!==String(e)||t.propertyIsEnumerable(e)?t[e]:void 0:t}))},t.exports=e.default},function(t,e,r){"use strict";var n=r(1).default;e.__esModule=!0;var i=r(5),o=n(r(6));e.default=function(t){t.registerHelper("with",(function(t,e){if(2!=arguments.length)throw new o.default("#with requires exactly one argument");i.isFunction(t)&&(t=t.call(this));var r=e.fn;if(i.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=i.createFrame(e.data)).contextPath=i.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:i.blockParams([t],[n&&n.contextPath])})}))},t.exports=e.default},function(t,e,r){"use strict";function n(t){o.default(t)}var i=r(1).default;e.__esModule=!0,e.registerDefaultDecorators=n;var o=i(r(19))},function(t,e,r){"use strict";e.__esModule=!0;var n=r(5);e.default=function(t){t.registerDecorator("inline",(function(t,e,r,i){var o=t;return e.partials||(e.partials={},o=function(i,o){var s=r.partials;r.partials=n.extend({},s,e.partials);var a=t(i,o);return r.partials=s,a}),e.partials[i.args[0]]=i.fn,o}))},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=r(5),i={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(i.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=i.lookupLevel(t),"undefined"!=typeof console&&i.lookupLevel(i.level)<=t){var e=i.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];console[e].apply(console,n)}}};e.default=i,t.exports=e.default},function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},function(t,e,r){"use strict";function n(t){var e=t&&t[0]||1,r=y.COMPILER_REVISION;if(!(e>=y.LAST_COMPATIBLE_COMPILER_REVISION&&e<=y.COMPILER_REVISION)){if(e<y.LAST_COMPATIBLE_COMPILER_REVISION){var n=y.REVISION_CHANGES[r],i=y.REVISION_CHANGES[e];throw new g.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+i+").")}throw new g.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function i(t,e){function r(r,n,i){i.hash&&(n=d.extend({},n,i.hash),i.ids&&(i.ids[0]=!0)),r=e.VM.resolvePartial.call(this,r,n,i);var o=d.extend({},i,{hooks:this.hooks}),s=e.VM.invokePartial.call(this,r,n,o);if(null==s&&e.compile&&(i.partials[i.name]=e.compile(r,t.compilerOptions,e),s=i.partials[i.name](n,o)),null!=s){if(i.indent){for(var a=s.split("\n"),l=0,u=a.length;l<u&&(a[l]||l+1!==u);l++)a[l]=i.indent+a[l];s=a.join("\n")}return s}throw new g.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")}function n(e){function r(e){return""+t.main(s,e,s.helpers,s.partials,o,l,a)}var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=i.data;n._setup(i),!i.partial&&t.useData&&(o=u(e,o));var a=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(a=i.depths?e!=i.depths[0]?[e].concat(i.depths):i.depths:[e]),(r=c(t.main,r,s,i.depths||[],o,l))(e,i)}if(!e)throw new g.default("No environment passed to template");if(!t||!t.main)throw new g.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var i=t.compiler&&7===t.compiler[0],s={strict:function(t,e,r){if(!t||!(e in t))throw new g.default('"'+e+'" not defined in '+t,{loc:r});return t[e]},lookup:function(t,e){for(var r=t.length,n=0;n<r;n++)if(t[n]&&null!=t[n][e])return t[n][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:d.escapeExpression,invokePartial:r,fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,i){var s=this.programs[t],a=this.fn(t);return e||i||n||r?s=o(this,t,a,e,r,n,i):s||(s=this.programs[t]=o(this,t,a)),s},data:function(t,e){for(;t&&e--;)t=t._parent;return t},nullContext:h({}),noop:e.VM.noop,compilerInfo:t.compiler};return n.isTop=!0,n._setup=function(r){if(r.partial)s.helpers=r.helpers,s.partials=r.partials,s.decorators=r.decorators,s.hooks=r.hooks;else{s.helpers=d.extend({},e.helpers,r.helpers),t.usePartial&&(s.partials=d.extend({},e.partials,r.partials)),(t.usePartial||t.useDecorators)&&(s.decorators=d.extend({},e.decorators,r.decorators)),s.hooks={};var n=r.allowCallsToHelperMissing||i;m.moveHelperToHooks(s,"helperMissing",n),m.moveHelperToHooks(s,"blockHelperMissing",n)}},n._child=function(e,r,n,i){if(t.useBlockParams&&!n)throw new g.default("must pass block params");if(t.useDepths&&!i)throw new g.default("must pass parent depths");return o(s,e,t[e],r,0,n,i)},n}function o(t,e,r,n,i,o,s){function a(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=s;return!s||e==s[0]||e===t.nullContext&&null===s[0]||(a=[e].concat(s)),r(t,e,t.helpers,t.partials,i.data||n,o&&[i.blockParams].concat(o),a)}return(a=c(r,a,t,s,n,o)).program=e,a.depth=s?s.length:0,a.blockParams=i||0,a}function s(t,e,r){return t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name],t}function a(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var i=void 0;if(r.fn&&r.fn!==l&&function(){r.data=y.createFrame(r.data);var t=r.fn;i=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=y.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=d.extend({},r.partials,t.partials))}(),void 0===t&&i&&(t=i),void 0===t)throw new g.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)}function l(){return""}function u(t,e){return e&&"root"in e||((e=e?y.createFrame(e):{}).root=t),e}function c(t,e,r,n,i,o){if(t.decorator){var s={};e=t.decorator(e,s,r,n&&n[0],i,o,n),d.extend(e,s)}return e}var h=r(23).default,f=r(3).default,p=r(1).default;e.__esModule=!0,e.checkRevision=n,e.template=i,e.wrapProgram=o,e.resolvePartial=s,e.invokePartial=a,e.noop=l;var d=f(r(5)),g=p(r(6)),y=r(4),m=r(10)},function(t,e,r){t.exports={default:r(24),__esModule:!0}},function(t,e,r){r(25),t.exports=r(30).Object.seal},function(t,e,r){var n=r(26);r(27)("seal",(function(t){return function(e){return t&&n(e)?t(e):e}}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){var n=r(28),i=r(30),o=r(33);t.exports=function(t,e){var r=(i.Object||{})[t]||Object[t],s={};s[t]=e(r),n(n.S+n.F*o((function(){r(1)})),"Object",s)}},function(t,e,r){var n=r(29),i=r(30),o=r(31),s="prototype",a=function(t,e,r){var l,u,c,h=t&a.F,f=t&a.G,p=t&a.S,d=t&a.P,g=t&a.B,y=t&a.W,m=f?i:i[e]||(i[e]={}),_=f?n:p?n[e]:(n[e]||{})[s];for(l in f&&(r=e),r)(u=!h&&_&&l in _)&&l in m||(c=u?_[l]:r[l],m[l]=f&&"function"!=typeof _[l]?r[l]:g&&u?o(c,n):y&&_[l]==c?function(t){var e=function(e){return this instanceof t?new t(e):t(e)};return e[s]=t[s],e}(c):d&&"function"==typeof c?o(Function.call,c):c,d&&((m[s]||(m[s]={}))[l]=c))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,t.exports=a},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){var r=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(32);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){(function(r){"use strict";e.__esModule=!0,e.default=function(t){var e=void 0!==r?r:window,n=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=n),t}},t.exports=e.default}).call(e,function(){return this}())},function(t,e){"use strict";e.__esModule=!0;var r={helpers:{helperExpression:function(t){return"SubExpression"===t.type||("MustacheStatement"===t.type||"BlockStatement"===t.type)&&!!(t.params&&t.params.length||t.hash)},scopedId:function(t){return/^\.|this\b/.test(t.original)},simpleId:function(t){return 1===t.parts.length&&!r.helpers.scopedId(t)&&!t.depth}}};e.default=r,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){return"Program"===t.type?t:(a.default.yy=h,h.locInfo=function(t){return new h.SourceLocation(e&&e.srcName,t)},a.default.parse(t))}function i(t,e){var r=n(t,e);return new l.default(e).accept(r)}var o=r(1).default,s=r(3).default;e.__esModule=!0,e.parseWithoutProcessing=n,e.parse=i;var a=o(r(37)),l=o(r(38)),u=s(r(40)),c=r(5);e.parser=a.default;var h={};c.extend(h,u)},function(t,e){"use strict";e.__esModule=!0;var r=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(t,e,r,n,i,o,s){var a=o.length-1;switch(i){case 1:return o[a-1];case 2:this.$=n.prepareProgram(o[a]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=o[a];break;case 9:this.$={type:"CommentStatement",value:n.stripComment(o[a]),strip:n.stripFlags(o[a],o[a]),loc:n.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:o[a],value:o[a],loc:n.locInfo(this._$)};break;case 11:this.$=n.prepareRawBlock(o[a-2],o[a-1],o[a],this._$);break;case 12:this.$={path:o[a-3],params:o[a-2],hash:o[a-1]};break;case 13:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!1,this._$);break;case 14:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!0,this._$);break;case 15:this.$={open:o[a-5],path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 16:case 17:this.$={path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 18:this.$={strip:n.stripFlags(o[a-1],o[a-1]),program:o[a]};break;case 19:var l=n.prepareBlock(o[a-2],o[a-1],o[a],o[a],!1,this._$),u=n.prepareProgram([l],o[a-1].loc);u.chained=!0,this.$={strip:o[a-2].strip,program:u,chain:!0};break;case 20:this.$=o[a];break;case 21:this.$={path:o[a-1],strip:n.stripFlags(o[a-2],o[a])};break;case 22:case 23:this.$=n.prepareMustache(o[a-3],o[a-2],o[a-1],o[a-4],n.stripFlags(o[a-4],o[a]),this._$);break;case 24:this.$={type:"PartialStatement",name:o[a-3],params:o[a-2],hash:o[a-1],indent:"",strip:n.stripFlags(o[a-4],o[a]),loc:n.locInfo(this._$)};break;case 25:this.$=n.preparePartialBlock(o[a-2],o[a-1],o[a],this._$);break;case 26:this.$={path:o[a-3],params:o[a-2],hash:o[a-1],strip:n.stripFlags(o[a-4],o[a])};break;case 27:case 28:this.$=o[a];break;case 29:this.$={type:"SubExpression",path:o[a-3],params:o[a-2],hash:o[a-1],loc:n.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:o[a],loc:n.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:n.id(o[a-2]),value:o[a],loc:n.locInfo(this._$)};break;case 32:this.$=n.id(o[a-1]);break;case 33:case 34:this.$=o[a];break;case 35:this.$={type:"StringLiteral",value:o[a],original:o[a],loc:n.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(o[a]),original:Number(o[a]),loc:n.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===o[a],original:"true"===o[a],loc:n.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:n.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:n.locInfo(this._$)};break;case 40:case 41:this.$=o[a];break;case 42:this.$=n.preparePath(!0,o[a],this._$);break;case 43:this.$=n.preparePath(!1,o[a],this._$);break;case 44:o[a-2].push({part:n.id(o[a]),original:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 45:this.$=[{part:n.id(o[a]),original:o[a]}];break;case 46:this.$=[];break;case 47:o[a-1].push(o[a]);break;case 48:this.$=[];break;case 49:o[a-1].push(o[a]);break;case 50:this.$=[];break;case 51:o[a-1].push(o[a]);break;case 58:this.$=[];break;case 59:o[a-1].push(o[a]);break;case 64:this.$=[];break;case 65:o[a-1].push(o[a]);break;case 70:this.$=[];break;case 71:o[a-1].push(o[a]);break;case 78:this.$=[];break;case 79:o[a-1].push(o[a]);break;case 82:this.$=[];break;case 83:o[a-1].push(o[a]);break;case 86:this.$=[];break;case 87:o[a-1].push(o[a]);break;case 90:this.$=[];break;case 91:o[a-1].push(o[a]);break;case 94:this.$=[];break;case 95:o[a-1].push(o[a]);break;case 98:this.$=[o[a]];break;case 99:o[a-1].push(o[a]);break;case 100:this.$=[o[a]];break;case 101:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return"number"!=typeof(t=r.lexer.lex()||1)&&(t=r.symbols_[t]||t),t}var r=this,n=[0],i=[null],o=[],s=this.table,a="",l=0,u=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var f=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,d,g,y,m,_,v,b,w,x={};;){if(g=n[n.length-1],this.defaultActions[g]?y=this.defaultActions[g]:(null!=p||(p=e()),y=s[g]&&s[g][p]),void 0===y||!y.length||!y[0]){var E="";if(!c){for(_ in w=[],s[g])this.terminals_[_]&&_>2&&w.push("'"+this.terminals_[_]+"'");E=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(E,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:w})}}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+p);switch(y[0]){case 1:n.push(p),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(y[1]),p=null,d?(p=d,d=null):(u=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,c>0&&c--);break;case 2:if(v=this.productions_[y[1]][1],x.$=i[i.length-v],x._$={first_line:o[o.length-(v||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(v||1)].first_column,last_column:o[o.length-1].last_column},f&&(x._$.range=[o[o.length-(v||1)].range[0],o[o.length-1].range[1]]),void 0!==(m=this.performAction.call(x,a,u,l,this.yy,y[1],i,o)))return m;v&&(n=n.slice(0,-1*v*2),i=i.slice(0,-1*v),o=o.slice(0,-1*v)),n.push(this.productions_[y[1]][0]),i.push(x.$),o.push(x._$),b=s[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},r=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;var t,e,r,n,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),s=0;s<o.length&&(!(r=this._input.match(this.rules[o[s]]))||e&&!(r[0].length>e[0].length)||(e=r,n=s,this.options.flex));s++);return e?((i=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)},options:{},performAction:function(t,e,r,n){function i(t,r){return e.yytext=e.yytext.substring(t,e.yyleng-r+t)}switch(r){case 0:if("\\\\"===e.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(i(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(e.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return e.yytext=i(1,2).replace(/\\"/g,'"'),80;case 32:return e.yytext=i(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return e.yytext=e.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}}};return t}();return e.lexer=r,t.prototype=e,e.Parser=t,new t}();e.default=r,t.exports=e.default},function(t,e,r){"use strict";function n(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=t}function i(t,e,r){void 0===e&&(e=t.length);var n=t[e-1],i=t[e-2];return n?"ContentStatement"===n.type?(i||!r?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:r}function o(t,e,r){void 0===e&&(e=-1);var n=t[e+1],i=t[e+2];return n?"ContentStatement"===n.type?(i||!r?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:r}function s(t,e,r){var n=t[null==e?0:e+1];if(n&&"ContentStatement"===n.type&&(r||!n.rightStripped)){var i=n.value;n.value=n.value.replace(r?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==i}}function a(t,e,r){var n=t[null==e?t.length-1:e-1];if(n&&"ContentStatement"===n.type&&(r||!n.leftStripped)){var i=n.value;return n.value=n.value.replace(r?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==i,n.leftStripped}}var l=r(1).default;e.__esModule=!0;var u=l(r(39));n.prototype=new u.default,n.prototype.Program=function(t){var e=!this.options.ignoreStandalone,r=!this.isRootSeen;this.isRootSeen=!0;for(var n=t.body,l=0,u=n.length;l<u;l++){var c=n[l],h=this.accept(c);if(h){var f=i(n,l,r),p=o(n,l,r),d=h.openStandalone&&f,g=h.closeStandalone&&p,y=h.inlineStandalone&&f&&p;h.close&&s(n,l,!0),h.open&&a(n,l,!0),e&&y&&(s(n,l),a(n,l)&&"PartialStatement"===c.type&&(c.indent=/([ \t]+$)/.exec(n[l-1].original)[1])),e&&d&&(s((c.program||c.inverse).body),a(n,l)),e&&g&&(s(n,l),a((c.inverse||c.program).body))}}return t},n.prototype.BlockStatement=n.prototype.DecoratorBlock=n.prototype.PartialBlockStatement=function(t){this.accept(t.program),this.accept(t.inverse);var e=t.program||t.inverse,r=t.program&&t.inverse,n=r,l=r;if(r&&r.chained)for(n=r.body[0].program;l.chained;)l=l.body[l.body.length-1].program;var u={open:t.openStrip.open,close:t.closeStrip.close,openStandalone:o(e.body),closeStandalone:i((n||e).body)};if(t.openStrip.close&&s(e.body,null,!0),r){var c=t.inverseStrip;c.open&&a(e.body,null,!0),c.close&&s(n.body,null,!0),t.closeStrip.open&&a(l.body,null,!0),!this.options.ignoreStandalone&&i(e.body)&&o(n.body)&&(a(e.body),s(n.body))}else t.closeStrip.open&&a(e.body,null,!0);return u},n.prototype.Decorator=n.prototype.MustacheStatement=function(t){return t.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(t){var e=t.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}},e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(){this.parents=[]}function i(t){this.acceptRequired(t,"path"),this.acceptArray(t.params),this.acceptKey(t,"hash")}function o(t){i.call(this,t),this.acceptKey(t,"program"),this.acceptKey(t,"inverse")}function s(t){this.acceptRequired(t,"name"),this.acceptArray(t.params),this.acceptKey(t,"hash")}var a=r(1).default;e.__esModule=!0;var l=a(r(6));n.prototype={constructor:n,mutating:!1,acceptKey:function(t,e){var r=this.accept(t[e]);if(this.mutating){if(r&&!n.prototype[r.type])throw new l.default('Unexpected node type "'+r.type+'" found when accepting '+e+" on "+t.type);t[e]=r}},acceptRequired:function(t,e){if(this.acceptKey(t,e),!t[e])throw new l.default(t.type+" requires "+e)},acceptArray:function(t){for(var e=0,r=t.length;e<r;e++)this.acceptKey(t,e),t[e]||(t.splice(e,1),e--,r--)},accept:function(t){if(t){if(!this[t.type])throw new l.default("Unknown type: "+t.type,t);this.current&&this.parents.unshift(this.current),this.current=t;var e=this[t.type](t);return this.current=this.parents.shift(),!this.mutating||e?e:!1!==e?t:void 0}},Program:function(t){this.acceptArray(t.body)},MustacheStatement:i,Decorator:i,BlockStatement:o,DecoratorBlock:o,PartialStatement:s,PartialBlockStatement:function(t){s.call(this,t),this.acceptKey(t,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:i,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(t){this.acceptArray(t.pairs)},HashPair:function(t){this.acceptRequired(t,"value")}},e.default=n,t.exports=e.default},function(t,e,r){"use strict";function n(t,e){if(e=e.path?e.path.original:e,t.path.original!==e){var r={loc:t.path.loc};throw new g.default(t.path.original+" doesn't match "+e,r)}}function i(t,e){this.source=t,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function o(t){return/^\[.*\]$/.test(t)?t.substring(1,t.length-1):t}function s(t,e){return{open:"~"===t.charAt(2),close:"~"===e.charAt(e.length-3)}}function a(t){return t.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function l(t,e,r){r=this.locInfo(r);for(var n=t?"@":"",i=[],o=0,s=0,a=e.length;s<a;s++){var l=e[s].part,u=e[s].original!==l;if(n+=(e[s].separator||"")+l,u||".."!==l&&"."!==l&&"this"!==l)i.push(l);else{if(i.length>0)throw new g.default("Invalid path: "+n,{loc:r});".."===l&&o++}}return{type:"PathExpression",data:t,depth:o,parts:i,original:n,loc:r}}function u(t,e,r,n,i,o){var s=n.charAt(3)||n.charAt(2),a="{"!==s&&"&"!==s;return{type:/\*/.test(n)?"Decorator":"MustacheStatement",path:t,params:e,hash:r,escaped:a,strip:i,loc:this.locInfo(o)}}function c(t,e,r,i){n(t,r);var o={type:"Program",body:e,strip:{},loc:i=this.locInfo(i)};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:o,openStrip:{},inverseStrip:{},closeStrip:{},loc:i}}function h(t,e,r,i,o,s){i&&i.path&&n(t,i);var a=/\*/.test(t.open);e.blockParams=t.blockParams;var l=void 0,u=void 0;if(r){if(a)throw new g.default("Unexpected inverse block on decorator",r);r.chain&&(r.program.body[0].closeStrip=i.strip),u=r.strip,l=r.program}return o&&(o=l,l=e,e=o),{type:a?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:l,openStrip:t.strip,inverseStrip:u,closeStrip:i&&i.strip,loc:this.locInfo(s)}}function f(t,e){if(!e&&t.length){var r=t[0].loc,n=t[t.length-1].loc;r&&n&&(e={source:r.source,start:{line:r.start.line,column:r.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:t,strip:{},loc:e}}function p(t,e,r,i){return n(t,r),{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:r&&r.strip,loc:this.locInfo(i)}}var d=r(1).default;e.__esModule=!0,e.SourceLocation=i,e.id=o,e.stripFlags=s,e.stripComment=a,e.preparePath=l,e.prepareMustache=u,e.prepareRawBlock=c,e.prepareBlock=h,e.prepareProgram=f,e.preparePartialBlock=p;var g=d(r(6))},function(t,e,r){"use strict";function n(){}function i(t,e,r){if(null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);"data"in(e=e||{})||(e.data=!0),e.compat&&(e.useDepths=!0);var n=r.parse(t,e),i=(new r.Compiler).compile(n,e);return(new r.JavaScriptCompiler).compile(i,e)}function o(t,e,r){function n(){var n=r.parse(t,e),i=(new r.Compiler).compile(n,e),o=(new r.JavaScriptCompiler).compile(i,e,void 0,!0);return r.template(o)}function i(t,e){return o||(o=n()),o.call(this,t,e)}if(void 0===e&&(e={}),null==t||"string"!=typeof t&&"Program"!==t.type)throw new u.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in(e=c.extend({},e))||(e.data=!0),e.compat&&(e.useDepths=!0);var o=void 0;return i._setup=function(t){return o||(o=n()),o._setup(t)},i._child=function(t,e,r,i){return o||(o=n()),o._child(t,e,r,i)},i}function s(t,e){if(t===e)return!0;if(c.isArray(t)&&c.isArray(e)&&t.length===e.length){for(var r=0;r<t.length;r++)if(!s(t[r],e[r]))return!1;return!0}}function a(t){if(!t.path.parts){var e=t.path;t.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}var l=r(1).default;e.__esModule=!0,e.Compiler=n,e.precompile=i,e.compile=o;var u=l(r(6)),c=r(5),h=l(r(35)),f=[].slice;n.prototype={compiler:n,equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var r=0;r<e;r++){var n=this.opcodes[r],i=t.opcodes[r];if(n.opcode!==i.opcode||!s(n.args,i.args))return!1}for(e=this.children.length,r=0;r<e;r++)if(!this.children[r].equals(t.children[r]))return!1;return!0},guid:0,compile:function(t,e){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=e,this.stringParams=e.stringParams,this.trackIds=e.trackIds,e.blockParams=e.blockParams||[];var r=e.knownHelpers;if(e.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},r)for(var n in r)this.options.knownHelpers[n]=r[n];return this.accept(t)},compileProgram:function(t){var e=(new this.compiler).compile(t,this.options),r=this.guid++;return this.usePartial=this.usePartial||e.usePartial,this.children[r]=e,this.useDepths=this.useDepths||e.useDepths,r},accept:function(t){if(!this[t.type])throw new u.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var e=this[t.type](t);return this.sourceNode.shift(),e},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var e=t.body,r=e.length,n=0;n<r;n++)this.accept(e[n]);return this.options.blockParams.shift(),this.isSimple=1===r,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){a(t);var e=t.program,r=t.inverse;e=e&&this.compileProgram(e),r=r&&this.compileProgram(r);var n=this.classifySexpr(t);"helper"===n?this.helperSexpr(t,e,r):"simple"===n?(this.simpleSexpr(t),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,e,r),this.opcode("pushProgram",e),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var e=t.program&&this.compileProgram(t.program),r=this.setupFullMustacheParams(t,e,void 0),n=t.path;this.useDecorators=!0,this.opcode("registerDecorator",r.length,n.original)},PartialStatement:function(t){this.usePartial=!0;var e=t.program;e&&(e=this.compileProgram(t.program));var r=t.params;if(r.length>1)throw new u.default("Unsupported number of partial arguments: "+r.length,t);r.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):r.push({type:"PathExpression",parts:[],depth:0}));var n=t.name.original,i="SubExpression"===t.name.type;i&&this.accept(t.name),this.setupFullMustacheParams(t,e,void 0,!0);var o=t.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",i,n,o),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){a(t);var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,e,r){var n=t.path,i=n.parts[0],o=null!=e||null!=r;this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",r),n.strict=!0,this.accept(n),this.opcode("invokeAmbiguous",i,o)},simpleSexpr:function(t){var e=t.path;e.strict=!0,this.accept(e),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,r){var n=this.setupFullMustacheParams(t,e,r),i=t.path,o=i.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new u.default("You specified knownHelpersOnly, but used the unknown helper "+o,t);i.strict=!0,i.falsy=!0,this.accept(i),this.opcode("invokeHelper",n.length,i.original,h.default.helpers.simpleId(i))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0],r=h.default.helpers.scopedId(t),n=!t.depth&&!r&&this.blockParamIndex(e);n?this.opcode("lookupBlockParam",n,t.parts):e?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,r):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var e=t.pairs,r=0,n=e.length;for(this.opcode("pushHash");r<n;r++)this.pushParam(e[r].value);for(;r--;)this.opcode("assignToHash",e[r].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:f.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var e=h.default.helpers.simpleId(t.path),r=e&&!!this.blockParamIndex(t.path.parts[0]),n=!r&&h.default.helpers.helperExpression(t),i=!r&&(n||e);if(i&&!n){var o=t.path.parts[0],s=this.options;s.knownHelpers[o]?n=!0:s.knownHelpersOnly&&(i=!1)}return n?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e=0,r=t.length;e<r;e++)this.pushParam(t[e])},pushParam:function(t){var e=null!=t.value?t.value:t.original||"";if(this.stringParams)e.replace&&(e=e.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",e,t.type),"SubExpression"===t.type&&this.accept(t);else{if(this.trackIds){var r=void 0;if(!t.parts||h.default.helpers.scopedId(t)||t.depth||(r=this.blockParamIndex(t.parts[0])),r){var n=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",r,n)}else(e=t.original||e).replace&&(e=e.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,e)}this.accept(t)}},setupFullMustacheParams:function(t,e,r,n){var i=t.params;return this.pushParams(i),this.opcode("pushProgram",e),this.opcode("pushProgram",r),t.hash?this.accept(t.hash):this.opcode("emptyHash",n),i},blockParamIndex:function(t){for(var e=0,r=this.options.blockParams.length;e<r;e++){var n=this.options.blockParams[e],i=n&&c.indexOf(n,t);if(n&&i>=0)return[e,i]}}}},function(t,e,r){"use strict";function n(t){this.value=t}function i(){}function o(t,e,r,n){var i=e.popStack(),o=0,s=r.length;for(t&&s--;o<s;o++)i=e.nameLookup(i,r[o],n);return t?[e.aliasable("container.strict"),"(",i,", ",e.quotedString(r[o]),", ",JSON.stringify(e.source.currentLocation)," )"]:i}var s=r(1).default;e.__esModule=!0;var a=r(4),l=s(r(6)),u=r(5),c=s(r(43));i.prototype={nameLookup:function(t,e){function r(){return i.isValidJavaScriptVariableName(e)?[t,".",e]:[t,"[",JSON.stringify(e),"]"]}var n=[this.aliasable("container.propertyIsEnumerable"),".call(",t,',"constructor")'];return"constructor"===e?["(",n,"?",r()," : undefined)"]:r()},depthedLookup:function(t){return[this.aliasable("container.lookup"),'(depths, "',t,'")']},compilerInfo:function(){var t=a.COMPILER_REVISION;return[t,a.REVISION_CHANGES[t]]},appendToBuffer:function(t,e,r){return u.isArray(t)||(t=[t]),t=this.source.wrap(t,e),this.environment.isSimple?["return ",t,";"]:r?["buffer += ",t,";"]:(t.appendToBuffer=!0,t)},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,r,n){this.environment=t,this.options=e,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!r,this.context=r||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(t,e),this.useDepths=this.useDepths||t.useDepths||t.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||t.useBlockParams;var i=t.opcodes,o=void 0,s=void 0,a=void 0,u=void 0;for(a=0,u=i.length;a<u;a++)o=i[a],this.source.currentLocation=o.loc,s=s||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new l.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),n?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var c=this.createFunctionContext(n);if(this.isChild)return c;var h={compiler:this.compilerInfo(),main:c};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var f=this.context,p=f.programs,d=f.decorators;for(a=0,u=p.length;a<u;a++)p[a]&&(h[a]=p[a],d[a]&&(h[a+"_d"]=d[a],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),n?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),e.srcName?(h=h.toStringWithSourceMap({file:e.destName})).map=h.map&&h.map.toString():h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new c.default(this.options.srcName),this.decorators=new c.default(this.options.srcName)},createFunctionContext:function(t){var e="",r=this.stackVars.concat(this.registers.list);r.length>0&&(e+=", "+r.join(", "));var n=0;for(var i in this.aliases){var o=this.aliases[i];this.aliases.hasOwnProperty(i)&&o.children&&o.referenceCount>1&&(e+=", alias"+ ++n+"="+i,o.children[0]="alias"+n)}var s=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var a=this.mergeSource(e);return t?(s.push(a),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",a,"}"])},mergeSource:function(t){var e=this.environment.isSimple,r=!this.forceBuffer,n=void 0,i=void 0,o=void 0,s=void 0;return this.source.each((function(t){t.appendToBuffer?(o?t.prepend("  + "):o=t,s=t):(o&&(i?o.prepend("buffer += "):n=!0,s.add(";"),o=s=void 0),i=!0,e||(r=!1))})),r?o?(o.prepend("return "),s.add(";")):i||this.source.push('return "";'):(t+=", buffer = "+(n?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),t&&this.source.prepend("var "+t.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(t){var e=this.aliasable("container.hooks.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs(t,0,r);var n=this.popStack();r.splice(1,0,n),this.push(this.source.functionCall(e,"call",r))},ambiguousBlockValue:function(){var t=this.aliasable("container.hooks.blockHelperMissing"),e=[this.contextName(0)];this.setupHelperArgs("",0,e,!0),this.flushInline();var r=this.topStack();e.splice(1,0,r),this.pushSource(["if (!",this.lastHelper,") { ",r," = ",this.source.functionCall(t,"call",e),"}"])},appendContent:function(t){this.pendingContent?t=this.pendingContent+t:this.pendingLocation=this.source.currentLocation,this.pendingContent=t},append:function(){if(this.isInline())this.replaceStack((function(t){return[" != null ? ",t,' : ""']})),this.pushSource(this.appendToBuffer(this.popStack()));else{var t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(t){this.lastContext=t},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(t,e,r,n){var i=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(t[i++])),this.resolvePath("context",t,i,e,r)},lookupBlockParam:function(t,e){this.useBlockParams=!0,this.push(["blockParams[",t[0],"][",t[1],"]"]),this.resolvePath("context",e,1)},lookupData:function(t,e,r){t?this.pushStackLiteral("container.data(data, "+t+")"):this.pushStackLiteral("data"),this.resolvePath("data",e,0,!0,r)},resolvePath:function(t,e,r,n,i){var s=this;if(this.options.strict||this.options.assumeObjects)this.push(o(this.options.strict&&i,this,e,t));else for(var a=e.length;r<a;r++)this.replaceStack((function(i){var o=s.nameLookup(i,e[r],t);return n?[" && ",o]:[" != null ? ",o," : ",i]}))},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(t,e){this.pushContext(),this.pushString(e),"SubExpression"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(t){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(t?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(t.ids)),this.stringParams&&(this.push(this.objectLiteral(t.contexts)),this.push(this.objectLiteral(t.types))),this.push(this.objectLiteral(t.values))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},registerDecorator:function(t,e){var r=this.nameLookup("decorators",e,"decorator"),n=this.setupHelperArgs(e,t);this.decorators.push(["fn = ",this.decorators.functionCall(r,"",["fn","props","container",n])," || fn;"])},invokeHelper:function(t,e,r){var n=this.popStack(),i=this.setupHelper(t,e),o=[];r&&o.push(i.name),o.push(n),this.options.strict||o.push(this.aliasable("container.hooks.helperMissing"));var s=["(",this.itemsSeparatedBy(o,"||"),")"],a=this.source.functionCall(s,"call",i.callParams);this.push(a)},itemsSeparatedBy:function(t,e){var r=[];r.push(t[0]);for(var n=1;n<t.length;n++)r.push(e,t[n]);return r},invokeKnownHelper:function(t,e){var r=this.setupHelper(t,e);this.push(this.source.functionCall(r.name,"call",r.callParams))},invokeAmbiguous:function(t,e){this.useRegister("helper");var r=this.popStack();this.emptyHash();var n=this.setupHelper(0,t,e),i=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",t,"helper")," || ",r,")"];this.options.strict||(i[0]="(helper = ",i.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",i,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(t,e,r){var n=[],i=this.setupParams(e,1,n);t&&(e=this.popStack(),delete i.name),r&&(i.indent=JSON.stringify(r)),i.helpers="helpers",i.partials="partials",i.decorators="container.decorators",t?n.unshift(e):n.unshift(this.nameLookup("partials",e,"partial")),this.options.compat&&(i.depths="depths"),i=this.objectLiteral(i),n.push(i),this.push(this.source.functionCall("container.invokePartial","",n))},assignToHash:function(t){var e=this.popStack(),r=void 0,n=void 0,i=void 0;this.trackIds&&(i=this.popStack()),this.stringParams&&(n=this.popStack(),r=this.popStack());var o=this.hash;r&&(o.contexts[t]=r),n&&(o.types[t]=n),i&&(o.ids[t]=i),o.values[t]=e},pushId:function(t,e,r){"BlockParam"===t?this.pushStackLiteral("blockParams["+e[0]+"].path["+e[1]+"]"+(r?" + "+JSON.stringify("."+r):"")):"PathExpression"===t?this.pushString(e):"SubExpression"===t?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:i,compileChildren:function(t,e){for(var r=t.children,n=void 0,i=void 0,o=0,s=r.length;o<s;o++){n=r[o],i=new this.compiler;var a=this.matchExistingProgram(n);if(null==a){this.context.programs.push("");var l=this.context.programs.length;n.index=l,n.name="program"+l,this.context.programs[l]=i.compile(n,e,this.context,!this.precompile),this.context.decorators[l]=i.decorators,this.context.environments[l]=n,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams,n.useDepths=this.useDepths,n.useBlockParams=this.useBlockParams}else n.index=a.index,n.name="program"+a.index,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams}},matchExistingProgram:function(t){for(var e=0,r=this.context.environments.length;e<r;e++){var n=this.context.environments[e];if(n&&n.equals(t))return n}},programExpression:function(t){var e=this.environment.children[t],r=[e.index,"data",e.blockParams];return(this.useBlockParams||this.useDepths)&&r.push("blockParams"),this.useDepths&&r.push("depths"),"container.program("+r.join(", ")+")"},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},push:function(t){return t instanceof n||(t=this.source.wrap(t)),this.inlineStack.push(t),t},pushStackLiteral:function(t){this.push(new n(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),t&&this.source.push(t)},replaceStack:function(t){var e=["("],r=void 0,i=void 0,o=void 0;if(!this.isInline())throw new l.default("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof n)e=["(",r=[s.value]],o=!0;else{i=!0;var a=this.incrStack();e=["((",this.push(a)," = ",s,")"],r=this.topStack()}var u=t.call(this,r);o||this.popStack(),i&&this.stackSlot--,this.push(e.concat(u,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;this.inlineStack=[];for(var e=0,r=t.length;e<r;e++){var i=t[e];if(i instanceof n)this.compileStack.push(i);else{var o=this.incrStack();this.pushSource([o," = ",i,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),r=(e?this.inlineStack:this.compileStack).pop();if(!t&&r instanceof n)return r.value;if(!e){if(!this.stackSlot)throw new l.default("Invalid stack pop");this.stackSlot--}return r},topStack:function(){var t=this.isInline()?this.inlineStack:this.compileStack,e=t[t.length-1];return e instanceof n?e.value:e},contextName:function(t){return this.useDepths&&t?"depths["+t+"]":"depth"+t},quotedString:function(t){return this.source.quotedString(t)},objectLiteral:function(t){return this.source.objectLiteral(t)},aliasable:function(t){var e=this.aliases[t];return e?(e.referenceCount++,e):((e=this.aliases[t]=this.source.wrap(t)).aliasable=!0,e.referenceCount=1,e)},setupHelper:function(t,e,r){var n=[];return{params:n,paramsInit:this.setupHelperArgs(e,t,n,r),name:this.nameLookup("helpers",e,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})")].concat(n)}},setupParams:function(t,e,r){var n={},i=[],o=[],s=[],a=!r,l=void 0;a&&(r=[]),n.name=this.quotedString(t),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var u=this.popStack(),c=this.popStack();(c||u)&&(n.fn=c||"container.noop",n.inverse=u||"container.noop");for(var h=e;h--;)l=this.popStack(),r[h]=l,this.trackIds&&(s[h]=this.popStack()),this.stringParams&&(o[h]=this.popStack(),i[h]=this.popStack());return a&&(n.args=this.source.generateArray(r)),this.trackIds&&(n.ids=this.source.generateArray(s)),this.stringParams&&(n.types=this.source.generateArray(o),n.contexts=this.source.generateArray(i)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(t,e,r,n){var i=this.setupParams(t,e,r);return i.loc=JSON.stringify(this.source.currentLocation),i=this.objectLiteral(i),n?(this.useRegister("options"),r.push("options"),["options=",i]):r?(r.push(i),""):i}},function(){for(var t="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=i.RESERVED_WORDS={},r=0,n=t.length;r<n;r++)e[t[r]]=!0}(),i.isValidJavaScriptVariableName=function(t){return!i.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)},e.default=i,t.exports=e.default},function(t,e,r){"use strict";function n(t,e,r){if(o.isArray(t)){for(var n=[],i=0,s=t.length;i<s;i++)n.push(e.wrap(t[i],r));return n}return"boolean"==typeof t||"number"==typeof t?t+"":t}function i(t){this.srcFile=t,this.source=[]}e.__esModule=!0;var o=r(5),s=void 0;s||((s=function(t,e,r,n){this.src="",n&&this.add(n)}).prototype={add:function(t){o.isArray(t)&&(t=t.join("")),this.src+=t},prepend:function(t){o.isArray(t)&&(t=t.join("")),this.src=t+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),i.prototype={isEmpty:function(){return!this.source.length},prepend:function(t,e){this.source.unshift(this.wrap(t,e))},push:function(t,e){this.source.push(this.wrap(t,e))},merge:function(){var t=this.empty();return this.each((function(e){t.add(["  ",e,"\n"])})),t},each:function(t){for(var e=0,r=this.source.length;e<r;e++)t(this.source[e])},empty:function(){var t=this.currentLocation||{start:{}};return new s(t.start.line,t.start.column,this.srcFile)},wrap:function(t){var e=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return t instanceof s?t:(t=n(t,this,e),new s(e.start.line,e.start.column,this.srcFile,t))},functionCall:function(t,e,r){return r=this.generateList(r),this.wrap([t,e?"."+e+"(":"(",r,")"])},quotedString:function(t){return'"'+(t+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(t){var e=[];for(var r in t)if(t.hasOwnProperty(r)){var i=n(t[r],this);"undefined"!==i&&e.push([this.quotedString(r),":",i])}var o=this.generateList(e);return o.prepend("{"),o.add("}"),o},generateList:function(t){for(var e=this.empty(),r=0,i=t.length;r<i;r++)r&&e.add(","),e.add(n(t[r],this));return e},generateArray:function(t){var e=this.generateList(t);return e.prepend("["),e.add("]"),e}},e.default=i,t.exports=e.default}])},function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i}));class n{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class i{constructor(t){this.url=t}async request({headers:t,credentials:e,signal:r}={}){throw new Error("request is not implemented")}}},function(t,e,r){(function(n){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(i=n))}),e.splice(i,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=r(101)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,r(30))},function(t,e,r){"use strict";const n={deserialize:t=>Object.assign(Error(t.message),{name:t.name,stack:t.stack}),serialize:t=>({__error_marker:"$$error",message:t.message,name:t.name,stack:t.stack})},i={deserialize(t){return(e=t)&&"object"==typeof e&&"__error_marker"in e&&"$$error"===e.__error_marker?n.deserialize(t):t;var e},serialize:t=>t instanceof Error?n.serialize(t):t};r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return a}));let o=i;function s(t){return o.deserialize(t)}function a(t){return o.serialize(t)}},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return s}));var n,i=r(0),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function s(t,e,r,n){var o=document.createElement("script"),s="olc_"+Object(i.c)(e);function a(){delete window[s],o.parentNode.removeChild(o)}o.async=!0,o.src=t+(-1==t.indexOf("?")?"?":"&")+(n||"callback")+"="+s;var l=setTimeout((function(){a(),r&&r()}),1e4);window[s]=function(t){clearTimeout(l),a(),e(t)},document.getElementsByTagName("head")[0].appendChild(o)}(function(t){function e(e){var r=this,n="Unexpected response status: "+e.status;return(r=t.call(this,n)||this).name="ResponseError",r.response=e,r}o(e,t)})(Error),function(t){function e(e){var r=t.call(this,"Failed to issue request")||this;return r.name="ClientError",r.client=e,r}o(e,t)}(Error)}).call(this,r(22))},function(t,e,r){t.exports=function(){"use strict";function t(t,n,i,o,s){!function t(r,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=n-i+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-l*c/a+h)),Math.min(o,Math.floor(n+(a-l)*c/a+h)),s)}var f=r[n],p=i,d=o;for(e(r,i,n),s(r[o],f)>0&&e(r,i,o);p<d;){for(e(r,p,d),p++,d--;s(r[p],f)<0;)p++;for(;s(r[d],f)>0;)d--}0===s(r[i],f)?e(r,i,d):e(r,++d,o),d<=n&&(i=d+1),n<=d&&(o=d-1)}}(t,n,i||0,o||t.length-1,s||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,i,o){for(var s=[r,n];s.length;)if(!((n=s.pop())-(r=s.pop())<=i)){var a=r+Math.ceil((n-r)/i/2)*i;t(e,a,r,n,o),s.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!p(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;p(t,a)&&(e.leaf?r.push(s):f(t,a)?this._all(s,r):i.push(s))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],r=u.pop(),o=!0),s.leaf){var c=i(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}o||s.leaf||!f(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(l.push(s),u.push(r),r=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,s=r-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(i=d([])).leaf=!1,i.height=n;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,r,u,this.compareMinX);for(var c=e;c<=r;c+=u){var h=Math.min(c+u-1,r);g(t,c,h,l,this.compareMinY);for(var f=c;f<=h;f+=l){var p=Math.min(f+l-1,h);i.children.push(this._build(t,f,p,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),h=(f=t,p=l,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-u);h<o?(o=h,i=u<i?u:i,s=l):h===o&&u<i&&(i=u,s=l)}e=s||e.children[0]}var f,p;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var s=this._chooseSplitIndex(r,i,n),a=d(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,a,l,u,h,f=1/0,p=1/0,d=e;d<=r-e;d++){var g=s(t,0,d,this.toBBox),y=s(t,d,r,this.toBBox),m=(i=g,o=y,a=void 0,l=void 0,u=void 0,h=void 0,a=Math.max(i.minX,o.minX),l=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,u-a)*Math.max(0,h-l)),_=c(g)+c(y);m<f?(f=m,n=d,p=_<p?_:p):m===f&&_<p&&(p=_,n=d)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=s(t,0,e,i),l=s(t,r-e,r,i),u=h(o)+h(l),c=e;c<r-e;c++){var f=t.children[c];a(o,t.leaf?i(f):f),u+=h(o)}for(var p=r-e-1;p>=e;p--){var d=t.children[p];a(l,t.leaf?i(d):d),u+=h(l)}return u},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},function(t,e,r){"use strict";var n,i;r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i})),function(t){t.cancel="cancel",t.run="run"}(n||(n={})),function(t){t.error="error",t.init="init",t.result="result",t.running="running",t.uncaughtError="uncaughtError"}(i||(i={}))},function(t,e,r){"use strict";const n=()=>"function"==typeof Symbol,i=t=>n()&&Boolean(Symbol[t]),o=t=>i(t)?Symbol[t]:"@@"+t;i("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const s=o("iterator"),a=o("observable"),l=o("species");function u(t,e){const r=t[e];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function c(t){let e=t.constructor;return void 0!==e&&(e=e[l],null===e&&(e=void 0)),void 0!==e?e:v}function h(t){h.log?h.log(t):setTimeout(()=>{throw t},0)}function f(t){Promise.resolve().then(()=>{try{t()}catch(t){h(t)}})}function p(t){const e=t._cleanup;if(void 0!==e&&(t._cleanup=void 0,e))try{if("function"==typeof e)e();else{const t=u(e,"unsubscribe");t&&t.call(e)}}catch(t){h(t)}}function d(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function g(t,e,r){t._state="running";const n=t._observer;try{const i=n?u(n,e):void 0;switch(e){case"next":i&&i.call(n,r);break;case"error":if(d(t),!i)throw r;i.call(n,r);break;case"complete":d(t),i&&i.call(n)}}catch(t){h(t)}"closed"===t._state?p(t):"running"===t._state&&(t._state="ready")}function y(t,e,r){if("closed"!==t._state)return"buffering"===t._state?(t._queue=t._queue||[],void t._queue.push({type:e,value:r})):"ready"!==t._state?(t._state="buffering",t._queue=[{type:e,value:r}],void f(()=>function(t){const e=t._queue;if(e){t._queue=void 0,t._state="ready";for(const r of e)if(g(t,r.type,r.value),"closed"===t._state)break}}(t))):void g(t,e,r)}class m{constructor(t,e){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const r=new _(this);try{this._cleanup=e.call(void 0,r)}catch(t){r.error(t)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(d(this),p(this))}}class _{constructor(t){this._subscription=t}get closed(){return"closed"===this._subscription._state}next(t){y(this._subscription,"next",t)}error(t){y(this._subscription,"error",t)}complete(){y(this._subscription,"complete")}}class v{constructor(t){if(!(this instanceof v))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,e,r){return"object"==typeof t&&null!==t||(t={next:t,error:e,complete:r}),new m(t,this._subscriber)}pipe(t,...e){let r=this;for(const n of[t,...e])r=n(r);return r}tap(t,e,r){const n="object"!=typeof t||null===t?{next:t,error:e,complete:r}:t;return new v(t=>this.subscribe({next(e){n.next&&n.next(e),t.next(e)},error(e){n.error&&n.error(e),t.error(e)},complete(){n.complete&&n.complete(),t.complete()},start(t){n.start&&n.start(t)}}))}forEach(t){return new Promise((e,r)=>{if("function"!=typeof t)return void r(new TypeError(t+" is not a function"));function n(){i.unsubscribe(),e(void 0)}const i=this.subscribe({next(e){try{t(e,n)}catch(t){r(t),i.unsubscribe()}},error(t){r(t)},complete(){e(void 0)}})})}map(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(c(this))(e=>this.subscribe({next(r){let n=r;try{n=t(r)}catch(t){return e.error(t)}e.next(n)},error(t){e.error(t)},complete(){e.complete()}}))}filter(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(c(this))(e=>this.subscribe({next(r){try{if(!t(r))return}catch(t){return e.error(t)}e.next(r)},error(t){e.error(t)},complete(){e.complete()}}))}reduce(t,e){if("function"!=typeof t)throw new TypeError(t+" is not a function");const r=c(this),n=arguments.length>1;let i=!1,o=e;return new r(e=>this.subscribe({next(r){const s=!i;if(i=!0,!s||n)try{o=t(o,r)}catch(t){return e.error(t)}else o=r},error(t){e.error(t)},complete(){if(!i&&!n)return e.error(new TypeError("Cannot reduce an empty sequence"));e.next(o),e.complete()}}))}concat(...t){const e=c(this);return new e(r=>{let n,i=0;return function o(s){n=s.subscribe({next(t){r.next(t)},error(t){r.error(t)},complete(){i===t.length?(n=void 0,r.complete()):o(e.from(t[i++]))}})}(this),()=>{n&&(n.unsubscribe(),n=void 0)}})}flatMap(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");const e=c(this);return new e(r=>{const n=[],i=this.subscribe({next(i){let s;if(t)try{s=t(i)}catch(t){return r.error(t)}else s=i;const a=e.from(s).subscribe({next(t){r.next(t)},error(t){r.error(t)},complete(){const t=n.indexOf(a);t>=0&&n.splice(t,1),o()}});n.push(a)},error(t){r.error(t)},complete(){o()}});function o(){i.closed&&0===n.length&&r.complete()}return()=>{n.forEach(t=>t.unsubscribe()),i.unsubscribe()}})}[(Symbol.observable,a)](){return this}static from(t){const e="function"==typeof this?this:v;if(null==t)throw new TypeError(t+" is not an object");const r=u(t,a);if(r){const n=r.call(t);if(Object(n)!==n)throw new TypeError(n+" is not an object");return function(t){return t instanceof v}(n)&&n.constructor===e?n:new e(t=>n.subscribe(t))}if(i("iterator")){const r=u(t,s);if(r)return new e(e=>{f(()=>{if(!e.closed){for(const n of r.call(t))if(e.next(n),e.closed)return;e.complete()}})})}if(Array.isArray(t))return new e(e=>{f(()=>{if(!e.closed){for(const r of t)if(e.next(r),e.closed)return;e.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){return new("function"==typeof this?this:v)(e=>{f(()=>{if(!e.closed){for(const r of t)if(e.next(r),e.closed)return;e.complete()}})})}static get[l](){return this}}n()&&Object.defineProperty(v,Symbol("extensions"),{value:{symbol:a,hostReportError:h},configurable:!0});e.a=v},function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t.internalError="internalError",t.message="message",t.termination="termination"}(n||(n={}))},function(t,e){t.exports='{{#*inline "layerswitcherLayer"}}\n  {{#each layers}}\n    <li class="m-layer {{#if outOfRange}}disabled{{/if}}{{#if visible}} visible{{/if}}">\n      <div class="m-visible-control">\n        <span data-layer-name="{{id}}" {{#if ../group}} data-group-id="{{../group}}" {{/if}} class="m-check g-cartografia-check{{#if base}}{{#if visible}}5{{^}}4{{/if}}{{^}}{{#if visible}}3{{^}}2{{/if}}{{/if}}"></span>\n      </div>\n      <div class="m-title">\n        <span>{{title}}</span>\n      </div>\n      {{#if visible}}\n        {{#unless base}}\n          <div class="m-tools">\n            <input type="range" data-layer-name="{{id}}" {{#if ../group}} data-group-id="{{../group}}" {{/if}} class="m-layerswitcher-transparency" min="0" max="1" step="0.1" value="{{opacity}}" {{#unless visible}} disabled {{/unless}}\n              {{#if outOfRange}} disabled {{/if}} />\n            <span data-layer-name="{{id}}" {{#if ../group}} data-group-id="{{../group}}" {{/if}} class="g-cartografia-cancelar m-layerswitcher-remove"></span>\n          </div>\n        {{/unless}}\n        <div class="m-legend">\n          <img data-layer-name="{{id}}" {{#if ../group}} data-group-id="{{../group}}" {{/if}} src="{{legend}}"></img>\n        </div>\n      {{/if}}\n    </li>\n  {{/each}}\n  {{/inline}}\n  {{#*inline "layerswitcherGroup"}}\n    {{#each layerGroups}}\n      <li class="m-group{{#if collapsed}} m-collapsed{{/if}}">\n        <div class="m-visible-control">\n          <span data-group-id="{{id}}" class="m-check g-cartografia-check{{#eq visible 0}}2{{/eq}}{{#eq visible 1}}5{{/eq}}{{#eq visible 2}}3{{/eq}}"></span>\n        </div>\n        <div class="m-title" data-group-id="{{id}}">\n          <span data-group-id="{{id}}">{{title}}</span>\n        </div>\n        <div class="m-collapsed-icon" data-group-id="{{id}}">\n          <span class="g-cartografia-flecha-{{#if collapsed}}izquierda{{^}}abajo{{/if}}" data-group-id="{{id}}"></span>\n        </div>\n        {{#unless collapsed}}\n          {{#gt layerGroups.length 0}}\n            <ul class="m-groups">\n              {{> layerswitcherGroup}}\n            </ul>\n          {{/gt}}\n          {{#gt layers.length 0}}\n            <ul class="m-layers">\n              {{> layerswitcherLayer group=id}}\n            </ul>\n          {{/gt}}\n        {{/unless}}\n      </li>\n    {{/each}}\n    {{/inline}}\n    <div class="m-control m-layerswitcher-container">\n      <div class="m-layersiwtcher-panel" id="m-layerswitcher-panel">\n        <ul>\n          {{#gt baseLayers.length 0}}\n            <li class="m-group">\n              <div class="m-title">Capas base</div>\n              <ul class="m-base-layers">\n                {{> layerswitcherLayer layers=baseLayers}}\n              </ul>\n            </li>\n          {{/gt}}\n          {{#gt layerGroups.length 0}}\n            <li class="m-group">\n              <div class="m-title">Grupos de capas</div>\n              <ul class="m-groups">\n                {{> layerswitcherGroup }}\n              </ul>\n            </li>\n          {{/gt}}\n          {{#gt overlayLayers.length 0}}\n            <li class="m-group">\n              <div class="m-title">Otras capas</div>\n              <ul class="m-layers">\n                {{> layerswitcherLayer layers=overlayLayers}}\n              </ul>\n            </li>\n          {{/gt}}\n        </ul>\n      </div>\n    </div>'},function(t,e){var r={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},n=" ",i=/(italic|oblique)$/i,o={};t.exports=function(t,e,s){var a=o[t];if(!a){Array.isArray(t)||(t=[t]);for(var l=400,u="normal",c=[],h=0,f=t.length;h<f;++h){var p=t[h].split(" "),d=p[p.length-1].toLowerCase();for(var g in"normal"==d||"italic"==d||"oblique"==d?(u=d,p.pop(),d=p[p.length-1].toLowerCase()):i.test(d)&&(d=d.replace(i,""),u=p[p.length-1].replace(d,"")),r)if(d==g||d==g.replace("-","")||d==g.replace("-",n)){l=r[g],p.pop();break}"number"==typeof d&&(l=d);var y=p.join(n).replace("Klokantech Noto Sans","Noto Sans");-1!==y.indexOf(n)&&(y='"'+y+'"'),c.push(y)}a=o[t]=[u,l,c]}return a[0]+n+a[1]+n+e+"px"+(s?"/"+s:"")+n+a[2]}},function(t,e,r){"use strict";r.d(e,"a",(function(){return sr}));function n(t){let e=t.length;for(;--e>=0;)t[e]=0}const i=256,o=286,s=30,a=15,l=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),u=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=new Array(576);n(f);const p=new Array(60);n(p);const d=new Array(512);n(d);const g=new Array(256);n(g);const y=new Array(29);n(y);const m=new Array(s);function _(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}let v,b,w;function x(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}n(m);const E=t=>t<256?d[t]:d[256+(t>>>7)],S=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},I=(t,e,r)=>{t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,S(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},O=(t,e,r)=>{I(t,r[2*e],r[2*e+1])},C=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},T=(t,e,r)=>{const n=new Array(16);let i,o,s=0;for(i=1;i<=a;i++)n[i]=s=s+r[i-1]<<1;for(o=0;o<=e;o++){let e=t[2*o+1];0!==e&&(t[2*o]=C(n[e]++,e))}},P=t=>{let e;for(e=0;e<o;e++)t.dyn_ltree[2*e]=0;for(e=0;e<s;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},R=t=>{t.bi_valid>8?S(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},L=(t,e,r,n)=>{const i=2*e,o=2*r;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},M=(t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&L(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!L(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},k=(t,e,r)=>{let n,o,s,a,c=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],o=t.pending_buf[t.l_buf+c],c++,0===n?O(t,o,e):(s=g[o],O(t,s+i+1,e),a=l[s],0!==a&&(o-=y[s],I(t,o,a)),n--,s=E(n),O(t,s,r),a=u[s],0!==a&&(n-=m[s],I(t,n,a)))}while(c<t.last_lit);O(t,256,e)},N=(t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let s,l,u,c=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==r[2*s]?(t.heap[++t.heap_len]=c=s,t.depth[s]=0):r[2*s+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,r[2*u]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[2*u+1]);for(e.max_code=c,s=t.heap_len>>1;s>=1;s--)M(t,r,s);u=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],M(t,r,1),l=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=l,r[2*u]=r[2*s]+r[2*l],t.depth[u]=(t.depth[s]>=t.depth[l]?t.depth[s]:t.depth[l])+1,r[2*s+1]=r[2*l+1]=u,t.heap[1]=u++,M(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,l=e.stat_desc.extra_base,u=e.stat_desc.max_length;let c,h,f,p,d,g,y=0;for(p=0;p<=a;p++)t.bl_count[p]=0;for(r[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)h=t.heap[c],p=r[2*r[2*h+1]+1]+1,p>u&&(p=u,y++),r[2*h+1]=p,h>n||(t.bl_count[p]++,d=0,h>=l&&(d=s[h-l]),g=r[2*h],t.opt_len+=g*(p+d),o&&(t.static_len+=g*(i[2*h+1]+d)));if(0!==y){do{for(p=u-1;0===t.bl_count[p];)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[u]--,y-=2}while(y>0);for(p=u;0!==p;p--)for(h=t.bl_count[p];0!==h;)f=t.heap[--c],f>n||(r[2*f+1]!==p&&(t.opt_len+=(p-r[2*f+1])*r[2*f],r[2*f+1]=p),h--)}})(t,e),T(r,c,t.bl_count)},A=(t,e,r)=>{let n,i,o=-1,s=e[1],a=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=e[2*(n+1)+1],++a<l&&i===s||(a<u?t.bl_tree[2*i]+=a:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,o=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4))},F=(t,e,r)=>{let n,i,o=-1,s=e[1],a=0,l=7,u=4;for(0===s&&(l=138,u=3),n=0;n<=r;n++)if(i=s,s=e[2*(n+1)+1],!(++a<l&&i===s)){if(a<u)do{O(t,i,t.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(O(t,i,t.bl_tree),a--),O(t,16,t.bl_tree),I(t,a-3,2)):a<=10?(O(t,17,t.bl_tree),I(t,a-3,3)):(O(t,18,t.bl_tree),I(t,a-11,7));a=0,o=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4)}};let D=!1;const j=(t,e,r,n)=>{I(t,0+(n?1:0),3),((t,e,r,n)=>{R(t),n&&(S(t,r),S(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r})(t,e,r,!0)};var G={_tr_init:t=>{D||((()=>{let t,e,r,n,i;const h=new Array(16);for(r=0,n=0;n<28;n++)for(y[n]=r,t=0;t<1<<l[n];t++)g[r++]=n;for(g[r-1]=n,i=0,n=0;n<16;n++)for(m[n]=i,t=0;t<1<<u[n];t++)d[i++]=n;for(i>>=7;n<s;n++)for(m[n]=i<<7,t=0;t<1<<u[n]-7;t++)d[256+i++]=n;for(e=0;e<=a;e++)h[e]=0;for(t=0;t<=143;)f[2*t+1]=8,t++,h[8]++;for(;t<=255;)f[2*t+1]=9,t++,h[9]++;for(;t<=279;)f[2*t+1]=7,t++,h[7]++;for(;t<=287;)f[2*t+1]=8,t++,h[8]++;for(T(f,287,h),t=0;t<s;t++)p[2*t+1]=5,p[2*t]=C(t,5);v=new _(f,l,257,o,a),b=new _(p,u,0,s,a),w=new _(new Array(0),c,0,19,7)})(),D=!0),t.l_desc=new x(t.dyn_ltree,v),t.d_desc=new x(t.dyn_dtree,b),t.bl_desc=new x(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,P(t)},_tr_stored_block:j,_tr_flush_block:(t,e,r,n)=>{let o,s,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<i;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),N(t,t.l_desc),N(t,t.d_desc),a=(t=>{let e;for(A(t,t.dyn_ltree,t.l_desc.max_code),A(t,t.dyn_dtree,t.d_desc.max_code),N(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*h[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),o=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=o&&(o=s)):o=s=r+5,r+4<=o&&-1!==e?j(t,e,r,n):4===t.strategy||s===o?(I(t,2+(n?1:0),3),k(t,f,p)):(I(t,4+(n?1:0),3),((t,e,r,n)=>{let i;for(I(t,e-257,5),I(t,r-1,5),I(t,n-4,4),i=0;i<n;i++)I(t,t.bl_tree[2*h[i]+1],3);F(t,t.dyn_ltree,e-1),F(t,t.dyn_dtree,r-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),k(t,t.dyn_ltree,t.dyn_dtree)),P(t),n&&R(t)},_tr_tally:(t,e,r)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(g[r]+i+1)]++,t.dyn_dtree[2*E(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{I(t,2,3),O(t,256,f),(t=>{16===t.bi_valid?(S(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var z=(t,e,r,n)=>{let i=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==r;){s=r>2e3?2e3:r,r-=s;do{i=i+e[n++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16|0};const U=new Uint32Array((()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e})());var B=(t,e,r,n)=>{const i=U,o=n+r;t^=-1;for(let r=n;r<o;r++)t=t>>>8^i[255&(t^e[r])];return-1^t},V={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},q={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Y,_tr_stored_block:W,_tr_flush_block:X,_tr_tally:H,_tr_align:Z}=G,{Z_NO_FLUSH:K,Z_PARTIAL_FLUSH:$,Z_FULL_FLUSH:J,Z_FINISH:Q,Z_BLOCK:tt,Z_OK:et,Z_STREAM_END:rt,Z_STREAM_ERROR:nt,Z_DATA_ERROR:it,Z_BUF_ERROR:ot,Z_DEFAULT_COMPRESSION:st,Z_FILTERED:at,Z_HUFFMAN_ONLY:lt,Z_RLE:ut,Z_FIXED:ct,Z_DEFAULT_STRATEGY:ht,Z_UNKNOWN:ft,Z_DEFLATED:pt}=q,dt=258,gt=262,yt=103,mt=113,_t=666,vt=(t,e)=>(t.msg=V[e],e),bt=t=>(t<<1)-(t>4?9:0),wt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let xt=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask;const Et=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},St=(t,e)=>{X(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Et(t.strm)},It=(t,e)=>{t.pending_buf[t.pending++]=e},Ot=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Ct=(t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),1===t.state.wrap?t.adler=z(t.adler,e,i,r):2===t.state.wrap&&(t.adler=B(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},Tt=(t,e)=>{let r,n,i=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-gt?t.strstart-(t.w_size-gt):0,u=t.window,c=t.w_mask,h=t.prev,f=t.strstart+dt;let p=u[o+s-1],d=u[o+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=e,u[r+s]===d&&u[r+s-1]===p&&u[r]===u[o]&&u[++r]===u[o+1]){o+=2,r++;do{}while(u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&u[++o]===u[++r]&&o<f);if(n=dt-(f-o),o=f-dt,n>s){if(t.match_start=e,s=n,n>=a)break;p=u[o+s-1],d=u[o+s]}}}while((e=h[e&c])>l&&0!=--i);return s<=t.lookahead?s:t.lookahead},Pt=t=>{const e=t.w_size;let r,n,i,o,s;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-gt)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do{i=t.head[--r],t.head[r]=i>=e?i-e:0}while(--n);n=e,r=n;do{i=t.prev[--r],t.prev[r]=i>=e?i-e:0}while(--n);o+=e}if(0===t.strm.avail_in)break;if(n=Ct(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=xt(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=xt(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<gt&&0!==t.strm.avail_in)},Rt=(t,e)=>{let r,n;for(;;){if(t.lookahead<gt){if(Pt(t),t.lookahead<gt&&e===K)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-gt&&(t.match_length=Tt(t,r)),t.match_length>=3)if(n=H(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=xt(t,t.ins_h,t.window[t.strstart+1]);else n=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(St(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Q?(St(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(St(t,!1),0===t.strm.avail_out)?1:2},Lt=(t,e)=>{let r,n,i;for(;;){if(t.lookahead<gt){if(Pt(t),t.lookahead<gt&&e===K)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-gt&&(t.match_length=Tt(t,r),t.match_length<=5&&(t.strategy===at||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=H(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(St(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=H(t,0,t.window[t.strstart-1]),n&&St(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=H(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Q?(St(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(St(t,!1),0===t.strm.avail_out)?1:2};function Mt(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}const kt=[new Mt(0,0,0,0,(t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Pt(t),0===t.lookahead&&e===K)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,St(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-gt&&(St(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Q?(St(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(St(t,!1),t.strm.avail_out),1)}),new Mt(4,4,8,4,Rt),new Mt(4,5,16,8,Rt),new Mt(4,6,32,32,Rt),new Mt(4,4,16,16,Lt),new Mt(8,16,32,32,Lt),new Mt(8,16,128,128,Lt),new Mt(8,32,128,256,Lt),new Mt(32,128,258,1024,Lt),new Mt(32,258,258,4096,Lt)];function Nt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const At=t=>{if(!t||!t.state)return vt(t,nt);t.total_in=t.total_out=0,t.data_type=ft;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:mt,t.adler=2===e.wrap?0:1,e.last_flush=K,Y(e),et},Ft=t=>{const e=At(t);var r;return e===et&&((r=t.state).window_size=2*r.w_size,wt(r.head),r.max_lazy_match=kt[r.level].max_lazy,r.good_match=kt[r.level].good_length,r.nice_match=kt[r.level].nice_length,r.max_chain_length=kt[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),e},Dt=(t,e,r,n,i,o)=>{if(!t)return nt;let s=1;if(e===st&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==pt||n<8||n>15||e<0||e>9||o<0||o>ct)return vt(t,nt);8===n&&(n=9);const a=new Nt;return t.state=a,a.strm=t,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=o,a.method=r,Ft(t)};var jt={deflateInit:(t,e)=>Dt(t,e,pt,15,8,ht),deflateInit2:Dt,deflateReset:Ft,deflateResetKeep:At,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?nt:(t.state.gzhead=e,et):nt,deflate:(t,e)=>{let r,n;if(!t||!t.state||e>tt||e<0)return t?vt(t,nt):nt;const i=t.state;if(!t.output||!t.input&&0!==t.avail_in||i.status===_t&&e!==Q)return vt(t,0===t.avail_out?ot:nt);i.strm=t;const o=i.last_flush;if(i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,It(i,31),It(i,139),It(i,8),i.gzhead?(It(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),It(i,255&i.gzhead.time),It(i,i.gzhead.time>>8&255),It(i,i.gzhead.time>>16&255),It(i,i.gzhead.time>>24&255),It(i,9===i.level?2:i.strategy>=lt||i.level<2?4:0),It(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(It(i,255&i.gzhead.extra.length),It(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=B(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(It(i,0),It(i,0),It(i,0),It(i,0),It(i,0),It(i,9===i.level?2:i.strategy>=lt||i.level<2?4:0),It(i,3),i.status=mt);else{let e=pt+(i.w_bits-8<<4)<<8,r=-1;r=i.strategy>=lt||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=r<<6,0!==i.strstart&&(e|=32),e+=31-e%31,i.status=mt,Ot(i,e),0!==i.strstart&&(Ot(i,t.adler>>>16),Ot(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),Et(t),r=i.pending,i.pending!==i.pending_buf_size));)It(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),Et(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,It(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),Et(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,It(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(t.adler=B(t.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.status=yt)}else i.status=yt;if(i.status===yt&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Et(t),i.pending+2<=i.pending_buf_size&&(It(i,255&t.adler),It(i,t.adler>>8&255),t.adler=0,i.status=mt)):i.status=mt),0!==i.pending){if(Et(t),0===t.avail_out)return i.last_flush=-1,et}else if(0===t.avail_in&&bt(e)<=bt(o)&&e!==Q)return vt(t,ot);if(i.status===_t&&0!==t.avail_in)return vt(t,ot);if(0!==t.avail_in||0!==i.lookahead||e!==K&&i.status!==_t){let r=i.strategy===lt?((t,e)=>{let r;for(;;){if(0===t.lookahead&&(Pt(t),0===t.lookahead)){if(e===K)return 1;break}if(t.match_length=0,r=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(St(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Q?(St(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(St(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===ut?((t,e)=>{let r,n,i,o;const s=t.window;for(;;){if(t.lookahead<=dt){if(Pt(t),t.lookahead<=dt&&e===K)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=t.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=t.strstart+dt;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);t.match_length=dt-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=H(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(St(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Q?(St(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(St(t,!1),0===t.strm.avail_out)?1:2})(i,e):kt[i.level].func(i,e);if(3!==r&&4!==r||(i.status=_t),1===r||3===r)return 0===t.avail_out&&(i.last_flush=-1),et;if(2===r&&(e===$?Z(i):e!==tt&&(W(i,0,0,!1),e===J&&(wt(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Et(t),0===t.avail_out))return i.last_flush=-1,et}return e!==Q?et:i.wrap<=0?rt:(2===i.wrap?(It(i,255&t.adler),It(i,t.adler>>8&255),It(i,t.adler>>16&255),It(i,t.adler>>24&255),It(i,255&t.total_in),It(i,t.total_in>>8&255),It(i,t.total_in>>16&255),It(i,t.total_in>>24&255)):(Ot(i,t.adler>>>16),Ot(i,65535&t.adler)),Et(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?et:rt)},deflateEnd:t=>{if(!t||!t.state)return nt;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==yt&&e!==mt&&e!==_t?vt(t,nt):(t.state=null,e===mt?vt(t,it):et)},deflateSetDictionary:(t,e)=>{let r=e.length;if(!t||!t.state)return nt;const n=t.state,i=n.wrap;if(2===i||1===i&&42!==n.status||n.lookahead)return nt;if(1===i&&(t.adler=z(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){0===i&&(wt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(r-n.w_size,r),0),e=t,r=n.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Pt(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=xt(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Pt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,n.wrap=i,et},deflateInfo:"pako deflate (from Nodeca project)"};const Gt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var zt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const e in r)Gt(r,e)&&(t[e]=r[e])}}return t},Ut=t=>{let e=0;for(let r=0,n=t.length;r<n;r++)e+=t[r].length;const r=new Uint8Array(e);for(let e=0,n=0,i=t.length;e<i;e++){let i=t[e];r.set(i,n),n+=i.length}return r};let Bt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Bt=!1}const Vt=new Uint8Array(256);for(let t=0;t<256;t++)Vt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Vt[254]=Vt[254]=1;var qt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,n,i,o,s=t.length,a=0;for(i=0;i<s;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=t.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),o=0,i=0;o<a;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=t.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|63&r):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|63&r):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|63&r);return e},Yt=(t,e)=>{const r=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,i;const o=new Array(2*r);for(i=0,n=0;n<r;){let e=t[n++];if(e<128){o[i++]=e;continue}let s=Vt[e];if(s>4)o[i++]=65533,n+=s-1;else{for(e&=2===s?31:3===s?15:7;s>1&&n<r;)e=e<<6|63&t[n++],s--;s>1?o[i++]=65533:e<65536?o[i++]=e:(e-=65536,o[i++]=55296|e>>10&1023,o[i++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Bt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r})(o,i)},Wt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let r=e-1;for(;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+Vt[t[r]]>e?r:e};var Xt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ht=Object.prototype.toString,{Z_NO_FLUSH:Zt,Z_SYNC_FLUSH:Kt,Z_FULL_FLUSH:$t,Z_FINISH:Jt,Z_OK:Qt,Z_STREAM_END:te,Z_DEFAULT_COMPRESSION:ee,Z_DEFAULT_STRATEGY:re,Z_DEFLATED:ne}=q;function ie(t){this.options=zt({level:ee,method:ne,chunkSize:16384,windowBits:15,memLevel:8,strategy:re},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xt,this.strm.avail_out=0;let r=jt.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Qt)throw new Error(V[r]);if(e.header&&jt.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?qt(e.dictionary):"[object ArrayBuffer]"===Ht.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=jt.deflateSetDictionary(this.strm,t),r!==Qt)throw new Error(V[r]);this._dict_set=!0}}function oe(t,e){const r=new ie(e);if(r.push(t,!0),r.err)throw r.msg||V[r.err];return r.result}ie.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Jt:Zt,"string"==typeof t?r.input=qt(t):"[object ArrayBuffer]"===Ht.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===Kt||o===$t)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=jt.deflate(r,o),i===te)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=jt.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Qt;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},ie.prototype.onData=function(t){this.chunks.push(t)},ie.prototype.onEnd=function(t){t===Qt&&(this.result=Ut(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var se={Deflate:ie,deflate:oe,deflateRaw:function(t,e){return(e=e||{}).raw=!0,oe(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,oe(t,e)},constants:q};var ae=function(t,e){let r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,x,E,S,I;const O=t.state;r=t.next_in,S=t.input,n=r+(t.avail_in-5),i=t.next_out,I=t.output,o=i-(e-t.avail_out),s=i+(t.avail_out-257),a=O.dmax,l=O.wsize,u=O.whave,c=O.wnext,h=O.window,f=O.hold,p=O.bits,d=O.lencode,g=O.distcode,y=(1<<O.lenbits)-1,m=(1<<O.distbits)-1;t:do{p<15&&(f+=S[r++]<<p,p+=8,f+=S[r++]<<p,p+=8),_=d[f&y];e:for(;;){if(v=_>>>24,f>>>=v,p-=v,v=_>>>16&255,0===v)I[i++]=65535&_;else{if(!(16&v)){if(0==(64&v)){_=d[(65535&_)+(f&(1<<v)-1)];continue e}if(32&v){O.mode=12;break t}t.msg="invalid literal/length code",O.mode=30;break t}b=65535&_,v&=15,v&&(p<v&&(f+=S[r++]<<p,p+=8),b+=f&(1<<v)-1,f>>>=v,p-=v),p<15&&(f+=S[r++]<<p,p+=8,f+=S[r++]<<p,p+=8),_=g[f&m];r:for(;;){if(v=_>>>24,f>>>=v,p-=v,v=_>>>16&255,!(16&v)){if(0==(64&v)){_=g[(65535&_)+(f&(1<<v)-1)];continue r}t.msg="invalid distance code",O.mode=30;break t}if(w=65535&_,v&=15,p<v&&(f+=S[r++]<<p,p+=8,p<v&&(f+=S[r++]<<p,p+=8)),w+=f&(1<<v)-1,w>a){t.msg="invalid distance too far back",O.mode=30;break t}if(f>>>=v,p-=v,v=i-o,w>v){if(v=w-v,v>u&&O.sane){t.msg="invalid distance too far back",O.mode=30;break t}if(x=0,E=h,0===c){if(x+=l-v,v<b){b-=v;do{I[i++]=h[x++]}while(--v);x=i-w,E=I}}else if(c<v){if(x+=l+c-v,v-=c,v<b){b-=v;do{I[i++]=h[x++]}while(--v);if(x=0,c<b){v=c,b-=v;do{I[i++]=h[x++]}while(--v);x=i-w,E=I}}}else if(x+=c-v,v<b){b-=v;do{I[i++]=h[x++]}while(--v);x=i-w,E=I}for(;b>2;)I[i++]=E[x++],I[i++]=E[x++],I[i++]=E[x++],b-=3;b&&(I[i++]=E[x++],b>1&&(I[i++]=E[x++]))}else{x=i-w;do{I[i++]=I[x++],I[i++]=I[x++],I[i++]=I[x++],b-=3}while(b>2);b&&(I[i++]=I[x++],b>1&&(I[i++]=I[x++]))}break}}break}}while(r<n&&i<s);b=p>>3,r-=b,p-=b<<3,f&=(1<<p)-1,t.next_in=r,t.next_out=i,t.avail_in=r<n?n-r+5:5-(r-n),t.avail_out=i<s?s-i+257:257-(i-s),O.hold=f,O.bits=p};const le=15,ue=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ce=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),he=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),fe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var pe=(t,e,r,n,i,o,s,a)=>{const l=a.bits;let u,c,h,f,p,d,g=0,y=0,m=0,_=0,v=0,b=0,w=0,x=0,E=0,S=0,I=null,O=0;const C=new Uint16Array(16),T=new Uint16Array(16);let P,R,L,M=null,k=0;for(g=0;g<=le;g++)C[g]=0;for(y=0;y<n;y++)C[e[r+y]]++;for(v=l,_=le;_>=1&&0===C[_];_--);if(v>_&&(v=_),0===_)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(m=1;m<_&&0===C[m];m++);for(v<m&&(v=m),x=1,g=1;g<=le;g++)if(x<<=1,x-=C[g],x<0)return-1;if(x>0&&(0===t||1!==_))return-1;for(T[1]=0,g=1;g<le;g++)T[g+1]=T[g]+C[g];for(y=0;y<n;y++)0!==e[r+y]&&(s[T[e[r+y]]++]=y);if(0===t?(I=M=s,d=19):1===t?(I=ue,O-=257,M=ce,k-=257,d=256):(I=he,M=fe,d=-1),S=0,y=0,g=m,p=o,b=v,w=0,h=-1,E=1<<v,f=E-1,1===t&&E>852||2===t&&E>592)return 1;for(;;){P=g-w,s[y]<d?(R=0,L=s[y]):s[y]>d?(R=M[k+s[y]],L=I[O+s[y]]):(R=96,L=0),u=1<<g-w,c=1<<b,m=c;do{c-=u,i[p+(S>>w)+c]=P<<24|R<<16|L|0}while(0!==c);for(u=1<<g-1;S&u;)u>>=1;if(0!==u?(S&=u-1,S+=u):S=0,y++,0==--C[g]){if(g===_)break;g=e[r+s[y]]}if(g>v&&(S&f)!==h){for(0===w&&(w=v),p+=m,b=g-w,x=1<<b;b+w<_&&(x-=C[b+w],!(x<=0));)b++,x<<=1;if(E+=1<<b,1===t&&E>852||2===t&&E>592)return 1;h=S&f,i[h]=v<<24|b<<16|p-o|0}}return 0!==S&&(i[p+S]=g-w<<24|64<<16|0),a.bits=v,0};const{Z_FINISH:de,Z_BLOCK:ge,Z_TREES:ye,Z_OK:me,Z_STREAM_END:_e,Z_NEED_DICT:ve,Z_STREAM_ERROR:be,Z_DATA_ERROR:we,Z_MEM_ERROR:xe,Z_BUF_ERROR:Ee,Z_DEFLATED:Se}=q,Ie=12,Oe=30,Ce=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Pe=t=>{if(!t||!t.state)return be;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,me},Re=t=>{if(!t||!t.state)return be;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Pe(t)},Le=(t,e)=>{let r;if(!t||!t.state)return be;const n=t.state;return e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?be:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Re(t))},Me=(t,e)=>{if(!t)return be;const r=new Te;t.state=r,r.window=null;const n=Le(t,e);return n!==me&&(t.state=null),n};let ke,Ne,Ae=!0;const Fe=t=>{if(Ae){ke=new Int32Array(512),Ne=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(pe(1,t.lens,0,288,ke,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;pe(2,t.lens,0,32,Ne,0,t.work,{bits:5}),Ae=!1}t.lencode=ke,t.lenbits=9,t.distcode=Ne,t.distbits=5},De=(t,e,r,n)=>{let i;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var je={inflateReset:Re,inflateReset2:Le,inflateResetKeep:Pe,inflateInit:t=>Me(t,15),inflateInit2:Me,inflate:(t,e)=>{let r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,x,E,S=0;const I=new Uint8Array(4);let O,C;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return be;r=t.state,r.mode===Ie&&(r.mode=13),s=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,u=r.hold,c=r.bits,h=a,f=l,E=me;t:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(2&r.wrap&&35615===u){r.check=0,I[0]=255&u,I[1]=u>>>8&255,r.check=B(r.check,I,2,0),u=0,c=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Oe;break}if((15&u)!==Se){t.msg="unknown compression method",r.mode=Oe;break}if(u>>>=4,c-=4,x=8+(15&u),0===r.wbits)r.wbits=x;else if(x>r.wbits){t.msg="invalid window size",r.mode=Oe;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=512&u?10:Ie,u=0,c=0;break;case 2:for(;c<16;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(r.flags=u,(255&r.flags)!==Se){t.msg="unknown compression method",r.mode=Oe;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=Oe;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(I[0]=255&u,I[1]=u>>>8&255,r.check=B(r.check,I,2,0)),u=0,c=0,r.mode=3;case 3:for(;c<32;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&(I[0]=255&u,I[1]=u>>>8&255,I[2]=u>>>16&255,I[3]=u>>>24&255,r.check=B(r.check,I,4,0)),u=0,c=0,r.mode=4;case 4:for(;c<16;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(I[0]=255&u,I[1]=u>>>8&255,r.check=B(r.check,I,2,0)),u=0,c=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(I[0]=255&u,I[1]=u>>>8&255,r.check=B(r.check,I,2,0)),u=0,c=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(p=r.length,p>a&&(p=a),p&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+p),x)),512&r.flags&&(r.check=B(r.check,n,p,o)),a-=p,o+=p,r.length-=p),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===a)break t;p=0;do{x=n[o+p++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&p<a);if(512&r.flags&&(r.check=B(r.check,n,p,o)),a-=p,o+=p,x)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===a)break t;p=0;do{x=n[o+p++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&p<a);if(512&r.flags&&(r.check=B(r.check,n,p,o)),a-=p,o+=p,x)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(u!==(65535&r.check)){t.msg="header crc mismatch",r.mode=Oe;break}u=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ie;break;case 10:for(;c<32;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}t.adler=r.check=Ce(u),u=0,c=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=c,ve;t.adler=r.check=1,r.mode=Ie;case Ie:if(e===ge||e===ye)break t;case 13:if(r.last){u>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}switch(r.last=1&u,u>>>=1,c-=1,3&u){case 0:r.mode=14;break;case 1:if(Fe(r),r.mode=20,e===ye){u>>>=2,c-=2;break t}break;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=Oe}u>>>=2,c-=2;break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Oe;break}if(r.length=65535&u,u=0,c=0,r.mode=15,e===ye)break t;case 15:r.mode=16;case 16:if(p=r.length,p){if(p>a&&(p=a),p>l&&(p=l),0===p)break t;i.set(n.subarray(o,o+p),s),a-=p,o+=p,l-=p,s+=p,r.length-=p;break}r.mode=Ie;break;case 17:for(;c<14;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Oe;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.lens[T[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},E=pe(0,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,E){t.msg="invalid code lengths set",r.mode=Oe;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;S=r.lencode[u&(1<<r.lenbits)-1],y=S>>>24,m=S>>>16&255,_=65535&S,!(y<=c);){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(_<16)u>>>=y,c-=y,r.lens[r.have++]=_;else{if(16===_){for(C=y+2;c<C;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(u>>>=y,c-=y,0===r.have){t.msg="invalid bit length repeat",r.mode=Oe;break}x=r.lens[r.have-1],p=3+(3&u),u>>>=2,c-=2}else if(17===_){for(C=y+3;c<C;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}u>>>=y,c-=y,x=0,p=3+(7&u),u>>>=3,c-=3}else{for(C=y+7;c<C;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}u>>>=y,c-=y,x=0,p=11+(127&u),u>>>=7,c-=7}if(r.have+p>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Oe;break}for(;p--;)r.lens[r.have++]=x}}if(r.mode===Oe)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=Oe;break}if(r.lenbits=9,O={bits:r.lenbits},E=pe(1,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,E){t.msg="invalid literal/lengths set",r.mode=Oe;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},E=pe(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,E){t.msg="invalid distances set",r.mode=Oe;break}if(r.mode=20,e===ye)break t;case 20:r.mode=21;case 21:if(a>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=c,ae(t,f),s=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,u=r.hold,c=r.bits,r.mode===Ie&&(r.back=-1);break}for(r.back=0;S=r.lencode[u&(1<<r.lenbits)-1],y=S>>>24,m=S>>>16&255,_=65535&S,!(y<=c);){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(m&&0==(240&m)){for(v=y,b=m,w=_;S=r.lencode[w+((u&(1<<v+b)-1)>>v)],y=S>>>24,m=S>>>16&255,_=65535&S,!(v+y<=c);){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}u>>>=v,c-=v,r.back+=v}if(u>>>=y,c-=y,r.back+=y,r.length=_,0===m){r.mode=26;break}if(32&m){r.back=-1,r.mode=Ie;break}if(64&m){t.msg="invalid literal/length code",r.mode=Oe;break}r.extra=15&m,r.mode=22;case 22:if(r.extra){for(C=r.extra;c<C;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;S=r.distcode[u&(1<<r.distbits)-1],y=S>>>24,m=S>>>16&255,_=65535&S,!(y<=c);){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(0==(240&m)){for(v=y,b=m,w=_;S=r.distcode[w+((u&(1<<v+b)-1)>>v)],y=S>>>24,m=S>>>16&255,_=65535&S,!(v+y<=c);){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}u>>>=v,c-=v,r.back+=v}if(u>>>=y,c-=y,r.back+=y,64&m){t.msg="invalid distance code",r.mode=Oe;break}r.offset=_,r.extra=15&m,r.mode=24;case 24:if(r.extra){for(C=r.extra;c<C;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Oe;break}r.mode=25;case 25:if(0===l)break t;if(p=f-l,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Oe;break}p>r.wnext?(p-=r.wnext,d=r.wsize-p):d=r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=i,d=s-r.offset,p=r.length;p>l&&(p=l),l-=p,r.length-=p;do{i[s++]=g[d++]}while(--p);0===r.length&&(r.mode=21);break;case 26:if(0===l)break t;i[s++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===a)break t;a--,u|=n[o++]<<c,c+=8}if(f-=l,t.total_out+=f,r.total+=f,f&&(t.adler=r.check=r.flags?B(r.check,i,f,s-f):z(r.check,i,f,s-f)),f=l,(r.flags?u:Ce(u))!==r.check){t.msg="incorrect data check",r.mode=Oe;break}u=0,c=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===a)break t;a--,u+=n[o++]<<c,c+=8}if(u!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=Oe;break}u=0,c=0}r.mode=29;case 29:E=_e;break t;case Oe:E=we;break t;case 31:return xe;case 32:default:return be}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=c,(r.wsize||f!==t.avail_out&&r.mode<Oe&&(r.mode<27||e!==de))&&De(t,t.output,t.next_out,f-t.avail_out),h-=t.avail_in,f-=t.avail_out,t.total_in+=h,t.total_out+=f,r.total+=f,r.wrap&&f&&(t.adler=r.check=r.flags?B(r.check,i,f,t.next_out-f):z(r.check,i,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ie?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===f||e===de)&&E===me&&(E=Ee),E},inflateEnd:t=>{if(!t||!t.state)return be;let e=t.state;return e.window&&(e.window=null),t.state=null,me},inflateGetHeader:(t,e)=>{if(!t||!t.state)return be;const r=t.state;return 0==(2&r.wrap)?be:(r.head=e,e.done=!1,me)},inflateSetDictionary:(t,e)=>{const r=e.length;let n,i,o;return t&&t.state?(n=t.state,0!==n.wrap&&11!==n.mode?be:11===n.mode&&(i=1,i=z(i,e,r,0),i!==n.check)?we:(o=De(t,e,r,r),o?(n.mode=31,xe):(n.havedict=1,me))):be},inflateInfo:"pako inflate (from Nodeca project)"};var Ge=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ze=Object.prototype.toString,{Z_NO_FLUSH:Ue,Z_FINISH:Be,Z_OK:Ve,Z_STREAM_END:qe,Z_NEED_DICT:Ye,Z_STREAM_ERROR:We,Z_DATA_ERROR:Xe,Z_MEM_ERROR:He}=q;function Ze(t){this.options=zt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xt,this.strm.avail_out=0;let r=je.inflateInit2(this.strm,e.windowBits);if(r!==Ve)throw new Error(V[r]);if(this.header=new Ge,je.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=qt(e.dictionary):"[object ArrayBuffer]"===ze.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=je.inflateSetDictionary(this.strm,e.dictionary),r!==Ve)))throw new Error(V[r])}function Ke(t,e){const r=new Ze(e);if(r.push(t),r.err)throw r.msg||V[r.err];return r.result}Ze.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Be:Ue,"[object ArrayBuffer]"===ze.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=je.inflate(r,s),o===Ye&&i&&(o=je.inflateSetDictionary(r,i),o===Ve?o=je.inflate(r,s):o===Xe&&(o=Ye));r.avail_in>0&&o===qe&&r.state.wrap>0&&0!==t[r.next_in];)je.inflateReset(r),o=je.inflate(r,s);switch(o){case We:case Xe:case Ye:case He:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||o===qe))if("string"===this.options.to){let t=Wt(r.output,r.next_out),e=r.next_out-t,i=Yt(r.output,t);r.next_out=e,r.avail_out=n-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==Ve||0!==a){if(o===qe)return o=je.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Ze.prototype.onData=function(t){this.chunks.push(t)},Ze.prototype.onEnd=function(t){t===Ve&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ut(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var $e={Inflate:Ze,inflate:Ke,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Ke(t,e)},ungzip:Ke,constants:q};const{Deflate:Je,deflate:Qe,deflateRaw:tr,gzip:er}=se,{Inflate:rr,inflate:nr,inflateRaw:ir,ungzip:or}=$e;var sr=nr},function(t,e){},,function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=r(99),i=r(29),o=r(100);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return u(this,t,e,r)}function u(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(e,r),i=(t=a(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(l.isBuffer(e)){var r=0|p(e.length);return 0===(t=a(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?a(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=a(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function f(t,e){var r=e.length<0?0:0|p(e.length);t=a(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return B(t).length;default:if(n)return U(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return O(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return P(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:_(t,e,r,n,i);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):_(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,r,n,i){var o,s=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var c=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var h=!0,f=0;f<l;f++)if(u(t,o+f)!==u(e,f)){h=!1;break}if(h)return o}return-1}function v(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function b(t,e,r,n){return V(U(e,t.length-r),t,r,n)}function w(t,e,r,n){return V(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function x(t,e,r,n){return w(t,e,r,n)}function E(t,e,r,n){return V(B(e),t,r,n)}function S(t,e,r,n){return V(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function I(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function O(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,l,u=t[i],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,h=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(t){var e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=C));return r}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,r){return u(null,t,e,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,r){return function(t,e,r,n){return c(e),e<=0?a(t,e):void 0!==r?"string"==typeof n?a(t,e).fill(r,n):a(t,e).fill(r):a(t,e)}(null,t,e,r)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=l.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?O(this,0,t):g.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,r,n,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(n,i),c=t.slice(e,r),h=0;h<a;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},l.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},l.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},l.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":return w(this,t,e,r);case"latin1":case"binary":return x(this,t,e,r);case"base64":return E(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function P(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function R(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=z(t[o]);return i}function L(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,r,n,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function N(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function A(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function F(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(t,e,r,n,o){return o||F(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function j(t,e,r,n,o){return o||F(t,0,r,8),i.write(t,e,r,n,52,8),r+8}l.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=l.prototype;else{var i=e-t;r=new l(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},l.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||M(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},l.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||M(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},l.prototype.readUInt8=function(t,e){return e||M(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||M(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||M(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||M(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||M(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||M(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(t,e){e||M(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(t,e){return e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||M(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||M(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||M(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||M(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||k(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},l.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||k(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},l.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):A(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);k(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},l.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);k(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},l.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):N(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):N(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):A(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,r){return D(this,t,e,!0,r)},l.prototype.writeFloatBE=function(t,e,r){return D(this,t,e,!1,r)},l.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},l.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},l.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},l.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var s=l.isBuffer(t)?t:U(new l(t,n).toString()),a=s.length;for(o=0;o<r-e;++o)this[o+e]=s[o%a]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function B(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(22))},function(t,e){t.exports='<div class="m-popup{{#gt tabs.length 1}} m-has-tabs{{/gt}} m-collapsed">\n    {{#gt tabs.length 1}}\n        <div class="m-tabs">\n            {{#each tabs}}\n                <div class="m-tab{{#eq @index 0}} m-activated{{/eq}}" data-index="{{@index}}">\n                    <i class="{{icon}}"></i>\n                </div>\n            {{/each}}\n        </div>\n    {{/gt}}\n    <div class="m-content">\n        <div class="m-header">\n            {{#eq tabs.length 1}}\n                <div class="m-title">{{{tabs.0.title}}}</div>\n                <div class="m-subtitle">{{{tabs.0.subtitle}}}</div>\n            {{/eq}}\n            <a class="m-popup-closer" href="#" title="cerrar popup"></a>\n        </div>\n        {{#if options.takeMeThere}}\n            {{#if options.textMode}}\n                <div class="m-footer">\n                    <a target="_blank" href="{{url}}">{{options.msg}}</a>\n                </div>\n            {{else}}\n                <div class="m-footer">\n                    <a target="_blank" href="{{url}}">\n                        <button class="g-cartografia-localizacion3"></button>\n                    </a>\n                </div>\n            {{/if}}\n        {{/if}}\n        <div class="m-body">{{{tabs.0.content}}}</div>\n    </div>\n</div>'},function(t,e){t.exports=function(t,e,r){const n=r&&r.debug||!1;n&&console.log("getting "+e+" in "+t);const i="object"==typeof t?t.outer:t,o=e+'\\="([^"]*)"';n&&console.log("pattern:",o);const s=new RegExp(o).exec(i);if(n&&console.log("match:",s),s)return s[1]}},function(t,e,r){"use strict";var n=r(10),i=r.n(n),o=r(15),s=r(118),a=r(11);const l=()=>{},u=t=>t,c=t=>Promise.resolve().then(t);function h(t){throw t}class f extends o.a{constructor(t){super(e=>{const r=this,n=Object.assign(Object.assign({},e),{complete(){e.complete(),r.onCompletion()},error(t){e.error(t),r.onError(t)},next(t){e.next(t),r.onNext(t)}});try{return this.initHasRun=!0,t(n)}catch(t){n.error(t)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(t){this.firstValueSet||(this.firstValue=t,this.firstValueSet=!0)}onError(t){this.state="rejected",this.rejection=t;for(const e of this.rejectionCallbacks)c(()=>e(t))}onCompletion(){this.state="fulfilled";for(const t of this.fulfillmentCallbacks)c(()=>t(this.firstValue))}then(t,e){const r=t||u,n=e||h;let i=!1;return new Promise((t,e)=>{const o=r=>{if(!i){i=!0;try{t(n(r))}catch(t){e(t)}}};return this.initHasRun||this.subscribe({error:o}),"fulfilled"===this.state?t(r(this.firstValue)):"rejected"===this.state?(i=!0,t(n(this.rejection))):(this.fulfillmentCallbacks.push(e=>{try{t(r(e))}catch(t){o(t)}}),void this.rejectionCallbacks.push(o))})}catch(t){return this.then(void 0,t)}finally(t){const e=t||l;return this.then(t=>(e(),t),()=>e())}static from(t){return function(t){return t&&"function"==typeof t.then}(t)?new f(e=>{t.then(t=>{e.next(t),e.complete()},t=>{e.error(t)})}):super.from(t)}}var p=r(57),d=r(14);r.d(e,"a",(function(){return _})),r.d(e,"b",(function(){return v}));const g=i()("threads:master:messages");let y=1;function m(t,e){return new o.a(r=>{let n;const i=o=>{var s;if(g("Message from worker:",o.data),o.data&&o.data.uid===e)if((s=o.data)&&s.type===d.b.running)n=o.data.resultType;else if((t=>t&&t.type===d.b.result)(o.data))"promise"===n?(void 0!==o.data.payload&&r.next(Object(a.a)(o.data.payload)),r.complete(),t.removeEventListener("message",i)):(o.data.payload&&r.next(Object(a.a)(o.data.payload)),o.data.complete&&(r.complete(),t.removeEventListener("message",i)));else if((t=>t&&t.type===d.b.error)(o.data)){const e=Object(a.a)(o.data.error);r.error(e),t.removeEventListener("message",i)}};return t.addEventListener("message",i),()=>{if("observable"===n||!n){const r={type:d.a.cancel,uid:e};t.postMessage(r)}t.removeEventListener("message",i)}})}function _(t,e){return(...r)=>{const n=y++,{args:i,transferables:o}=function(t){if(0===t.length)return{args:[],transferables:[]};const e=[],r=[];for(const n of t)Object(p.b)(n)?(e.push(Object(a.b)(n.send)),r.push(...n.transferables)):e.push(Object(a.b)(n));return{args:e,transferables:0===r.length?r:(n=r,Array.from(new Set(n)))};var n}(r),l={type:d.a.run,uid:n,method:e,args:i};g("Sending command to run function to worker:",l);try{t.postMessage(l,o)}catch(t){return f.from(Promise.reject(t))}return f.from(Object(s.a)(m(t,n)))}}function v(t,e){const r={};for(const n of e)r[n]=_(t,n);return r}},function(t){t.exports=JSON.parse('{"a":"2.5.0"}')},function(t,e,r){},function(t,e){e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,u=l>>1,c=-7,h=r?i-1:0,f=r?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+p]=255&s,p+=d,s/=256,u-=8);t[r+p-d]|=128*g}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var l,u=[],c=!1,h=-1;function f(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&p())}function p(){if(!c){var t=a(f);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new d(t,e)),1!==u.length||c||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return m}));var n=r(10),i=r.n(n),o=r(15),s=r(11),a=r(56),l=r(4),u=r(16),c=r(26),h=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const f=i()("threads:master:messages"),p=i()("threads:master:spawn"),d=i()("threads:master:thread-utils"),g=void 0!==t&&t.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(t.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function y(t,e,r,n){const i=r.filter(t=>t.type===u.a.internalError).map(t=>t.error);return Object.assign(t,{[l.a]:i,[l.b]:r,[l.c]:n,[l.e]:e})}function m(t,e){return h(this,void 0,void 0,(function*(){p("Initializing new thread");const r=e&&e.timeout?e.timeout:g,n=(yield function(t,e,r){return h(this,void 0,void 0,(function*(){let n;const i=new Promise((t,i)=>{n=setTimeout(()=>i(Error(r)),e)}),o=yield Promise.race([t,i]);return clearTimeout(n),o}))}(function(t){return new Promise((e,r)=>{const n=i=>{var o;f("Message from worker before finishing initialization:",i.data),(o=i.data)&&"init"===o.type?(t.removeEventListener("message",n),e(i.data)):(t=>t&&"uncaughtError"===t.type)(i.data)&&(t.removeEventListener("message",n),r(Object(s.a)(i.data.error)))};t.addEventListener("message",n)})}(t),r,`Timeout: Did not receive an init message from worker after ${r}ms. Make sure the worker calls expose().`)).exposed,{termination:i,terminate:l}=function(t){const[e,r]=Object(a.a)();return{terminate:()=>h(this,void 0,void 0,(function*(){d("Terminating worker"),yield t.terminate(),r()})),termination:e}}(t),m=function(t,e){return new o.a(r=>{const n=t=>{const e={type:u.a.message,data:t.data};r.next(e)},i=t=>{d("Unhandled promise rejection event in thread:",t);const e={type:u.a.internalError,error:Error(t.reason)};r.next(e)};t.addEventListener("message",n),t.addEventListener("unhandledrejection",i),e.then(()=>{const e={type:u.a.termination};t.removeEventListener("message",n),t.removeEventListener("unhandledrejection",i),r.next(e),r.complete()})})}(t,i);if("function"===n.type){return y(Object(c.a)(t),t,m,l)}if("module"===n.type){return y(Object(c.b)(t,n.methods),t,m,l)}{const t=n.type;throw Error("Worker init message states unexpected type of expose(): "+t)}}))}}).call(this,r(30))},function(t){t.exports=JSON.parse('{"name":"mapea","version":"6.1.0","description":"Herramienta para desarrollo de mapas interactivos de forma sencilla","keywords":["map","mapping","tool","sigcorporativo-ja"],"homepage":"http://mapea4-sigc.juntadeandalucia.es/","repository":{"type":"git","url":"https://github.com/sigcorporativo-ja/Mapea4"},"license":"EUPL","bugs":{"url":"https://github.com/sigcorporativo-ja/Mapea4/issues"},"devDependencies":{"@babel/core":"^7.6.4","@babel/plugin-proposal-export-default-from":"^7.0.0-beta.51","@babel/preset-env":"^7.4.4","babel-loader":"^8.0.0-beta.4","chromedriver":"^2.46.0","copy-webpack-plugin":"^6.1.0","cross-env":"^5.2.0","css-loader":"^2.1.1","eslint":"^4.19.1","eslint-config-airbnb":"^16.1.0","eslint-loader":"^2.0.0","eslint-plugin-import":"^2.9.0","eslint-plugin-jsx-a11y":"^6.0.3","eslint-plugin-react":"^7.7.0","expect.js":"^0.3.1","expose-loader":"^0.7.5","file-loader":"^1.1.11","fs-extra":"2.0.0","get-image-colors":"^2.0.0","html-loader":"^0.5.5","jsdoc-plugin-typescript":"^2.0.5","karma":"^5.2.2","karma-chrome-launcher":"^2.2.0","karma-firefox-launcher":"^1.1.0","karma-mocha":"^2.0.1","karma-webpack":"^3.0.5","mini-css-extract-plugin":"^0.4.1","mocha":"^8.1.3","nightwatch":"^1.4.2","optimize-css-assets-webpack-plugin":"^5.0.1","style-loader":"^0.21.0","terser-webpack-plugin":"^4.2.1","uglify-js":"^2.6.1","uglifycss":"0.0.29","url-loader":"^1.0.1","walk":"^2.3.14","webpack":"^4.41.2","webpack-cli":"^3.3.12","webpack-dev-server":"^3.11.0","yargs":"^16.0.3"},"dependencies":{"chroma-js":"^1.3.7","draggabilly":"^2.2.0","handlebars":"4.5.2","jsdoc":"^3.6.4","jsts":"^2.0.2","ol":"6.9.0","proj4":"^2.4.4"},"scripts":{"build":"cross-env NODE_OPTIONS=--max_old_space_size=2048 ./node/npm run build:core && ./node/npm run build:plugins && ./node/npm run build:plugins-extern","build:sourcemap":"npm run prebuild && npm run build:core -- --source-map && npm run build:plugins","build:core":"webpack --config=webpack-config/webpack.production-core.config.js","build:plugins":"webpack --config=webpack-config/webpack.production-plugins.config.js","build:plugins-extern":"./node/node tasks/build-extern-plugins.js","debug:build":"webpack-dev-server --config=webpack-config/webpack.test-production.config.js","debug:prebuild":"node --inspect-brk tasks/generate-index.js","generate-doc":"jsdoc config/jsdoc/api/index.md -c config/jsdoc/api/conf.json","generate-test":"node tasks/test-generator","karma":"karma start ./karma.conf.js","nightwatch":"nightwatch --config=./nightwatch.conf.js","prebuild":"node tasks/clean-build.js --path=dist && node tasks/generate-index.js && node tasks/generate-plugins-entrypoints.js","postbuild":"npm run generate-doc && node tasks/copy-legacy.js","publish_npm":"node tasks/prepare-package/prepare.js","start":"webpack-dev-server --config=webpack-config/webpack.development.config.js","start:build":"npm run build && npm run debug:build","test":"npm run karma && npm run nightwatch"}}')},function(t,e){t.exports='<div class="m-control"></div>'},function(t){t.exports=JSON.parse('{"location":{"title":"Get current location"},"layerswitcher":{"title":"Layer selector"},"scale":{"title":"Scale","scale":"Scale"},"getfeatureinfo":{"info":"Information","title":"Consult layer","no_info":"No associated info","info_of":"Information about","unsupported_format":"Unsupported format"},"wmcselector":{"title":"Context selector"},"dialog":{"info":"INFORMATION","error":"ERROR","success":"SUCCESS","id_feature":"An ID has not been indicated to obtain the feature","invalid_type_layer":"A valid type was not specified for the layer","vector_filter":"The indicated filter is not correct","unauthorized_user":"An error occurred while loading the layer: Unauthorized user.","only_one_filter":"FeatureID and CQL are mutually exclusive, indicate only one type of filtering.","getfeatureinfo_type":"The requested format for the information is not available. Try it using gml, plain or html."},"feature":{"incorrect_attributes":"The attributes were not specified correctly."},"exception":{"addto_method":"The used implementation does not have the addTo method","no_get_rotation_method":"The used implementation does not have the getRotation method","no_set_rotation_method":"The used implementation does not have the setRotation method","getelement_method":"The used implementation does not have the getElement method","getfeatureinfo_method":"The used implementation can not create GetFeatureInfo controls","mouse_method":"The used implementation can not create Mouse controls","navtoolbar_method":"The used implementation can not create navtoolbar controls","overviewmap_method":"The used implementation can not create OverviewMap controls","panzoom_method":"The used implementation can not create Panzoom controls","panzoombar_method":"The used implementation can not create Panzoombar controls","scale_method":"The used implementation can not create Scale controls","scaleline_method":"The used implementation can not create ScaleLine controls","wmcselector_method":"The used implementation can not create WMCSelector controls","geojson_method":"The used implementation can not create objects M.impl.format.GeoJSON","wkt_method":"The used implementation can not creat objects M.impl.format.WKT","getfeaturesbylayer_method":"The used implementation does not have the getFeaturesByLayer method","geojsonlayer_method":"The used implementation can not create GeoJSON layers","no_param":"No parameters specified","no_name":"You have not specified any name","kmllayer_method":"The used implementation can not create KML layers","isvisible_method":"The used implementation does not have the isVisible method","isqueryable_methd":"The used implementation does not have the isQueryable method","visibility_param":"You have not specified any visibility parameters","setvisible_method":"The used implementation does not have the setVisible method","inrange_method":"The used implementation does not have the inRange method","mapbox_method":"The used implementation can not create Mapbox layers","osm_method":"The used implementation can not create OSM layers","vectorlayer_method":"The used implementation can not create Vector layers","wfslayer_method":"The used implementation can not create WFS layers","wmclayer_method":"The used implementation can not create WMC layers","select_method":"The used implementation does not have the select method","unselect_method":"The used implementation does not have the unselect method","constructor_impl":"The used implementation does not have a constructor.","getlayers_method":"The used implementation does not have the getLayers method.","getbaselayers_method":"The used implementation does not have the getBaseLayers method.","addlayers_method":"The used implementation does not have the addLayers method.","removelayers_method":"The used implementation does not have the removeLayers method.","getwmc_method":"The implementation used does not have the getWMC method.","addwmc_method":"The used implementation does not have the addWMC method.","removewmc_method":"The used implementation does not have the removeWMC method.","getkml_method":"The used implementation does not have the getKML method.","addkml_method":"The implementation used does not have the addKML method.","removekml_method":"The implementation used does not have the removeKML method.","getwms_method":"The used implementation does not have the getWMS method.","addwms_method":"The used implementation does not have the addWMS method.","removewms_method":"The used implementation does not have the removeWMS method.","getwfs_method":"The implementation used does not have the getWFS method.","getgeojson_method":"The used implementation does not have the getGeoJSON method.","addwfs_method":"The used implementation does not have the addWFS method.","removewfs_method":"The used implementation does not have the removeWFS method.","getwmts_method":"The implementation used does not have the getWMTS method.","addwmts_method":"The used implementation does not have the addWMTS method.","removewmts_method":"The used implementation does not have the removeWMTS method.","getmbtiles_method":"The used implementation does not have the getMBtiles method.","getcontrols_method":"The used implementation does not have the getControls method.","addcontrols_method":"The used implementation does not have the addControls method.","remove_control":"You have not specified any control to delete.","removecontrol_method":"The used implementation does not have the removeControls method.","setmaxextent_method":"The used implementation does not have the setMaxExtent method.","getbbox_method":"The used implementation does not have the getBbox method.","no_bbox":"You have not specified any bbox.","setbbox_method":"The used implementation does not have the setBbox method.","incorrect_bbox_format":"The format of the bbox parameter is not correct.","getzoom_method":"The used implementation does not have the getZoom method.","no_zoom":"You have not specified any zoom.","setzoom_method":"The implementation used does not have the setZoom method.","getcenter_method":"The used implementation does not have the getCenter method.","setcenter_method":"The used implementation does not have the setCenter method.","getresolutions_method":"The used implementation does not have the getResolutions method.","no_resolutions":"You have not specified any resolution.","setresolutions_method":"The used implementation does not have the setResolutions method.","getscale_method":"The used implementation does not have the getScale method.","getprojection_method":"The implementation used does not have the getProjection method.","no_projection":"You have not specified any projection.","setprojection_method":"The used implementation does not have the setProjection method.","no_plugins":"You have not specified any plugins.","no_add_plugin_to_map":"The plugin can not be added to the map.","no_plugin_to_remove":"You have not specified any plugins to delete.","destroy_method":"The used implementation does not have the destroy method.","addlabel_method":"The used implementation does not have the addLabel method.","no_point":"You have not specified any points.","remove_control_from_panel":"You must remove the controls from the panel previously.","getcontainer_method":"The used implementation does not have the getContainer method.","getmapimpl_method":"The used implementation does not have the getMapImpl method.","removepopup_method":"The used implementation does not have the removePopup method.","no_popup":"You have not specified any popup.","invalid_popup":"The specified popup is not valid.","no_maxextent":"You have not specified any maxExtent","must_be_document":"doc.nodeType must be DOCUMENT type","no_service_response":"There was no reply from the service","no_kml_response":"There was no response from the KML","no_getfeature_response":"There was no response in the GetFeature operation","no_map":"You have not specified any map","layerswitcher_method":"The used implementation can not create LayerSwitcher controls","location_method":"The used implementation can not create Location controls","wms_method":"The used implementation can not create WMS layers","wmts_method":"The used implementation can not create WMTS layers","no_impl":"No implementation specified","no_container":"You have not specified any container parameters","no_id_container":"There is no container with the specified id","no_center":"You have not specified any center parameters","no_attr_name":"The name of the attribute was not specified","no_empty":"The attribute name can not be null. Specify string or function","invalid_center_param":"The format of the center parameter is not correct","invalid_maxextent_param":"The format of the maxExtent parameter is not correct","invalid_resolutions_param":"The format of the resolutions parameter is not correct","invalid_zoom_param":"The format of the zoom parameter is not correct","min_gt_max":"A minimum radius greater than the maximum can not be established.","max_lt_min":"A maximum radius of less than the minimum can not be established.","no_geojson":"No GeoJSON has been specified","unsupported_lang":"A language without support has been established"}}')},function(t){t.exports=JSON.parse('{"location":{"title":"Obtener ubicación actual"},"layerswitcher":{"title":"Selector de capas"},"scale":{"title":"Escala","scale":"Escala"},"getfeatureinfo":{"info":"Información","title":"Consultar capa","no_info":"No existe información asociada","info_of":"Información de","unsupported_format":"Formato no soportado"},"wmcselector":{"title":"Selector de contextos"},"dialog":{"info":"INFORMACIÓN","error":"ERROR","success":"ÉXITO","id_feature":"No se ha indicado un ID para obtener el feature","invalid_type_layer":"No se ha especificado un tipo válido para la capa","vector_filter":"El filtro indicado no es correcto","unauthorized_user":"Ha ocurrido un error al cargar la capa: Usuario no autorizado.","only_one_filter":"FeatureID y CQL son mutuamente excluyentes. Indicar sólo un tipo de filtrado.","getfeatureinfo_type":"El formato solicitado para la información no está disponible. Inténtelo utilizando gml, plain o html."},"feature":{"incorrect_attributes":"No se han especificado correctamente los atributos."},"exception":{"addto_method":"La implementación usada no posee el método addTo","no_get_rotation_method":"La implementación usada no posee el método getRotation","no_set_rotation_method":"La implementación usada no posee el método setRotation","getelement_method":"La implementación usada no posee el método getElement","getfeatureinfo_method":"La implementación usada no puede crear controles GetFeatureInfo","mouse_method":"La implementación usada no puede crear controles Mouse","navtoolbar_method":"La implementación usada no puede crear controles Navtoolbar","overviewmap_method":"La implementación usada no puede crear controles OverviewMap","panzoom_method":"La implementación usada no puede crear controles Panzoom","panzoombar_method":"La implementación usada no puede crear controles Panzoombar","scale_method":"La implementación usada no puede crear controles Scale","scaleline_method":"La implementación usada no puede crear controles ScaleLine","wmcselector_method":"La implementación usada no puede crear controles WMCSelector","geojson_method":"La implementación usada no puede crear objetos M.impl.format.GeoJSON","wkt_method":"La implementación usada no puede creat objetos M.impl.format.WKT","getfeaturesbylayer_method":"La implementación usada no posee el método getFeaturesByLayer","geojsonlayer_method":"La implementación usada no puede crear capas GeoJSON","no_param":"No se ha especificado ningun parámetro","no_name":"No ha especificado ningún nombre","kmllayer_method":"La implementación usada no puede crear capas KML","isvisible_method":"La implementación usada no posee el método isVisible","isqueryable_methd":"La implementación usada no posee el método isQueryable","visibility_param":"No ha especificado ningún parámetro de visibilidad","setvisible_method":"La implementación usada no posee el método setVisible","inrange_method":"La implementación usada no posee el método inRange","mapbox_method":"La implementación usada no puede crear capas Mapbox","osm_method":"La implementación usada no puede crear capas OSM","vectorlayer_method":"La implementación usada no puede crear capas Vector","wfslayer_method":"La implementación usada no puede crear capas WFS","wmclayer_method":"La implementación usada no puede crear capas WMC","select_method":"La implementación usada no posee el método select","unselect_method":"La implementación usada no posee el método unselect","constructor_impl":"La implementación usada no posee un constructor.","getlayers_method":"La implementación usada no posee el método getLayers.","getbaselayers_method":"La implementación usada no posee el método getBaseLayers.","addlayers_method":"La implementación usada no posee el método addLayers.","removelayers_method":"La implementación usada no posee el método removeLayers.","getwmc_method":"La implementación usada no posee el método getWMC.","addwmc_method":"La implementación usada no posee el método addWMC.","removewmc_method":"La implementación usada no posee el método removeWMC.","getkml_method":"La implementación usada no posee el método getKML.","addkml_method":"La implementación usada no posee el método addKML.","removekml_method":"La implementación usada no posee el método removeKML.","getwms_method":"La implementación usada no posee el método getWMS.","addwms_method":"La implementación usada no posee el método addWMS.","removewms_method":"La implementación usada no posee el método removeWMS.","getwfs_method":"La implementación usada no posee el método getWFS.","getgeojson_method":"La implementación usada no posee el método getGeoJSON.","addwfs_method":"La implementación usada no posee el método addWFS.","removewfs_method":"La implementación usada no posee el método removeWFS.","getwmts_method":"La implementación usada no posee el método getWMTS.","addwmts_method":"La implementación usada no posee el método addWMTS.","removewmts_method":"La implementación usada no posee el método removeWMTS.","getmbtiles_method":"La implementación usada no posee el método getMBtiles.","getcontrols_method":"La implementación usada no posee el método getControls.","addcontrols_method":"La implementación usada no posee el método addControls.","remove_control":"No ha especificado ningún control a eliminar.","removecontrol_method":"La implementación usada no posee el método removeControls.","setmaxextent_method":"La implementación usada no posee el método setMaxExtent.","getbbox_method":"La implementación usada no posee el método getBbox.","no_bbox":"No ha especificado ningún bbox.","setbbox_method":"La implementación usada no posee el método setBbox.","incorrect_bbox_format":"El formato del parámetro bbox no es el correcto.","getzoom_method":"La implementación usada no posee el método getZoom.","no_zoom":"No ha especificado ningún zoom.","setzoom_method":"La implementación usada no posee el método setZoom.","getcenter_method":"La implementación usada no posee el método getCenter.","setcenter_method":"La implementación usada no posee el método setCenter.","getresolutions_method":"La implementación usada no posee el método getResolutions.","no_resolutions":"No ha especificado ninguna resolución.","setresolutions_method":"La implementación usada no posee el método setResolutions.","getscale_method":"La implementación usada no posee el método getScale.","getprojection_method":"La implementación usada no posee el método getProjection.","no_projection":"No ha especificado ninguna proyección.","setprojection_method":"La implementación usada no posee el método setProjection.","no_plugins":"No ha especificado ningún plugin.","no_add_plugin_to_map":"El plugin no puede añadirse al mapa.","no_plugin_to_remove":"No ha especificado ningún plugin a eliminar.","destroy_method":"La implementación usada no posee el método destroy.","addlabel_method":"La implementación usada no posee el método addLabel.","no_point":"No ha especificado ningún punto.","remove_control_from_panel":"Debe eliminar los controles del panel previamente.","getcontainer_method":"La implementación usada no posee el método getContainer.","getmapimpl_method":"La implementación usada no posee el método getMapImpl.","removepopup_method":"La implementación usada no posee el método removePopup.","no_popup":"No ha especificado ningún popup.","invalid_popup":"El popup especificado no es válido.","no_maxextent":"No ha especificado ningún maxExtent","must_be_document":"doc.nodeType debe ser de tipo DOCUMENT","no_service_response":"No hubo respuesta del servicio","no_kml_response":"No hubo respuesta del KML","no_getfeature_response":"No hubo respuesta en la operación GetFeature","no_map":"No ha especificado ningun mapa","layerswitcher_method":"La implementación usada no puede crear controles LayerSwitcher","location_method":"La implementación usada no puede crear controles Location","wms_method":"La implementación usada no puede crear capas WMS","wmts_method":"La implementación usada no puede crear capas WMTS","no_impl":"No se ha especificado ninguna implementación","no_container":"No ha especificado ningún parámetro contenedor","no_id_container":"No existe ningún contenedor con el id especificado","no_center":"No ha especificado ningún parámetro center","no_attr_name":"No se ha especificado el nombre del atributo","no_empty":"El nombre de atributo no puede ser nulo. Especifique cadena o función","invalid_center_param":"El formato del parámetro center no es correcto","invalid_maxextent_param":"El formato del parámetro maxExtent no es correcto","invalid_resolutions_param":"El formato del parámetro resolutions no es correcto","invalid_zoom_param":"El formato del parámetro zoom no es correcto","min_gt_max":"No puede establecerse un radio mínimo mayor que el máximo.","max_lt_min":"No puede establecerse un radio máximo menor que el mínimo.","no_geojson":"No se ha especificado ningun GeoJSON","unsupported_lang":"Se ha establecido un idioma sin soporte"}}')},function(t,e){t.exports='<div class="m-control m-wmcselector-container g-cartografia-mapa" title="{{title}}">\n    <select class="m-wmcselector-select">\n        {{#each layers}}\n            <option {{#if selected}}selected {{/if}}value="{{url}}">{{name}}</option>\n        {{/each}}\n    </select>\n</div>'},function(t,e){t.exports='<div class="m-geojson-content">\n   {{#each features}}\n   <div id="{{id}}" class="result">\n      {{#each attributes}}\n      <table>\n         <tr>\n            <td class="key">{{key}}</td>\n            <td class="value">{{{value}}}</td>\n         </tr>\n      </table>\n      {{/each}}\n   </div>\n   <div class="m-separator"></div>\n   {{/each}}\n</div>'},function(t,e){t.exports='<div class="m-dialog {{severity}}">\n   <div class="m-modal">\n      <div class="m-content">\n         <div class="m-title">\n            <i class="m-icon"></i>\n            <span>{{{title}}}</span>\n         </div>\n         <div class="m-message">{{{message}}}</div>\n         <div class="m-button">\n            <button>OK</button>\n         </div>\n      </div>\n   </div>\n</div>'},function(t,e){t.exports='<div class="m-control m-location-container" title="{{title}}">\n    <button id="m-location-button" class="g-cartografia-gps2"></button>\n</div>'},function(t,e){t.exports='<div class="m-control m-scale-container" title="{{title}}">\n    <div class="m-unit g-cartografia-escala3">{{scale}} = 1 : </div>\n    <div class="m-scale" id="m-scale-span"></div>\n</div>'},function(t,e){t.exports='<div class="m-control m-rotate-container">\n    <div id="m-rotate-slider-container">\n        <div id="m-rotate-slider" class="m-rotate-slider">\n        </div>\n        <button id="m-rotate-button" class="g-cartografia-brujula-norte"></button>\n        <svg id="m-rotate-marker">\n            <circle id="m-rotate-marker-circle" cx="8" cy="8" r="6" />\n        </svg>\n    </div>\n</div>'},function(t,e){t.exports='<div class="m-control"></div>'},function(t,e){t.exports='<div class="m-control"></div>'},function(t,e){t.exports='<div class="m-control"></div>'},function(t,e){t.exports='<div class="m-control"></div>'},function(t,e){t.exports='<div class="m-control"></div>'},function(t,e){t.exports='<div class="m-getfeatureinfo-content">\n   {{{info}}}\n</div>'},function(t,e){t.exports="  {{#each layers}}\n      <div class='m-getfeatureinfo-content-info'>\n          <div class='m-getfeatureinfo-content-info-header'>\n              <div class=\"m-arrow-right\"></div>\n              <div>\n                  <p> {{../info_of}} <strong>{{layerName}}</strong></p>\n              </div>\n          </div>\n          <div class='m-getfeatureinfo-content-info-body m-content-collapsed'>\n              {{{formatedInfo}}}\n          </div>\n      </div>\n  {{/each}}"},function(t,e){t.exports='<div class="m-control m-getfeatureinfo-container" id="infoGetFeature">\n    <button id="m-getfeatureinfo-button" class="g-cartografia-info" title="{{title}}"></button>\n</div>'},function(t,e){t.exports='<div class="m-panel">\n   <button class="m-panel-btn"></button>\n   <div class="m-panel-controls"></div>\n</div>'},function(t,e){t.exports='<div class="m-label-content">\n   {{{info}}}\n</div>'},function(t,e){t.exports='<div class="m-kml-content">\n   <p class="m-kml-name">{{{name}}}</p>\n   <div class="m-kml-desc">{{{desc}}}</div>\n</div>'},function(t,e,r){"use strict";t.exports=i;var n=r(29);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,s=1/o,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function u(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function c(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=t;i--)r.buf[i+n]=r.buf[i]}function h(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function f(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function p(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function d(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function g(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function y(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function m(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function _(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function v(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function w(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=b(this.buf,this.pos)+b(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=b(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,n=this.buf;return e=127&(r=n[this.pos++]),r<128?e:(e|=(127&(r=n[this.pos++]))<<7,r<128?e:(e|=(127&(r=n[this.pos++]))<<14,r<128?e:(e|=(127&(r=n[this.pos++]))<<21,r<128?e:function(t,e,r){var n,i,o=r.buf;if(i=o[r.pos++],n=(112&i)>>4,i<128)return u(t,n,e);if(i=o[r.pos++],n|=(127&i)<<3,i<128)return u(t,n,e);if(i=o[r.pos++],n|=(127&i)<<10,i<128)return u(t,n,e);if(i=o[r.pos++],n|=(127&i)<<17,i<128)return u(t,n,e);if(i=o[r.pos++],n|=(127&i)<<24,i<128)return u(t,n,e);if(i=o[r.pos++],n|=(1&i)<<31,i<128)return u(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,r){return a.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){var n="",i=e;for(;i<r;){var o,s,a,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var r=l(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,n;t>=0?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}(r,0,e),function(t,e){var r=(7&t)<<4;if(e.buf[e.pos++]|=r|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&c(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;n>=128&&c(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,i.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,_,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e){(function(){var e;t.exports={icon:"icons/google.svg",name:"google",title:"Google Fonts",link:"google.com/fonts",getNames:function(){return e},getLink:function(t){return"https://fonts.google.com/specimen/"+t.replace(/( )/g,"+")},normalizeName:function(t){return t}},e=["ABeeZee","Abel","Abril Fatface","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akronim","Aladin","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Alex Brush","Alfa Slab One","Alice","Alike","Alike Angular","Allan","Allerta","Allerta Stencil","Allura","Almendra","Almendra Display","Almendra SC","Amarante","Amaranth","Amatic SC","Amethysta","Amiri","Amita","Anaheim","Andada","Andika","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Arapey","Arbutus","Arbutus Slab","Architects Daughter","Archivo Black","Archivo Narrow","Arimo","Arizonia","Armata","Artifika","Arvo","Arya","Asap","Asar","Asset","Astloch","Asul","Atomic Age","Aubrey","Audiowide","Autour One","Average","Average Sans","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","Bad Script","Balthazar","Bangers","Basic","Battambang","Baumans","Bayon","Belgrano","Belleza","BenchNine","Bentham","Berkshire Swash","Bevan","Bigelow Rules","Bigshot One","Bilbo","Bilbo Swash Caps","Biryani","Bitter","Black Ops One","Bokor","Bonbon","Boogaloo","Bowlby One","Bowlby One SC","Brawler","Bree Serif","Bubblegum Sans","Bubbler One","Buda","Buenard","Butcherman","Butterfly Kids","Cabin","Cabin Condensed","Cabin Sketch","Caesar Dressing","Cagliostro","Calligraffitti","Cambay","Cambo","Candal","Cantarell","Cantata One","Cantora One","Capriola","Cardo","Carme","Carrois Gothic","Carrois Gothic SC","Carter One","Catamaran","Caudex","Caveat","Caveat Brush","Cedarville Cursive","Ceviche One","Changa One","Chango","Chau Philomene One","Chela One","Chelsea Market","Chenla","Cherry Cream Soda","Cherry Swash","Chewy","Chicle","Chivo","Chonburi","Cinzel","Cinzel Decorative","Clicker Script","Coda","Coda Caption","Codystar","Combo","Comfortaa","Coming Soon","Concert One","Condiment","Content","Contrail One","Convergence","Cookie","Copse","Corben","Courgette","Cousine","Coustard","Covered By Your Grace","Crafty Girls","Creepster","Crete Round","Crimson Text","Croissant One","Crushed","Cuprum","Cutive","Cutive Mono","Damion","Dancing Script","Dangrek","Dawning of a New Day","Days One","Dekko","Delius","Delius Swash Caps","Delius Unicase","Della Respira","Denk One","Devonshire","Dhurjati","Didact Gothic","Diplomata","Diplomata SC","Domine","Donegal One","Doppio One","Dorsa","Dosis","Dr Sugiyama","Droid Sans","Droid Sans Mono","Droid Serif","Duru Sans","Dynalight","EB Garamond","Eagle Lake","Eater","Economica","Eczar","Ek Mukta","Electrolize","Elsie","Elsie Swash Caps","Emblema One","Emilys Candy","Engagement","Englebert","Enriqueta","Erica One","Esteban","Euphoria Script","Ewert","Exo","Exo 2","Expletus Sans","Fanwood Text","Fascinate","Fascinate Inline","Faster One","Fasthand","Fauna One","Federant","Federo","Felipa","Fenix","Finger Paint","Fira Mono","Fira Sans","Fjalla One","Fjord One","Flamenco","Flavors","Fondamento","Fontdiner Swanky","Forum","Francois One","Freckle Face","Fredericka the Great","Fredoka One","Freehand","Fresca","Frijole","Fruktur","Fugaz One","GFS Didot","GFS Neohellenic","Gabriela","Gafata","Galdeano","Galindo","Gentium Basic","Gentium Book Basic","Geo","Geostar","Geostar Fill","Germania One","Gidugu","Gilda Display","Give You Glory","Glass Antiqua","Glegoo","Gloria Hallelujah","Goblin One","Gochi Hand","Gorditas","Goudy Bookletter 1911","Graduate","Grand Hotel","Gravitas One","Great Vibes","Griffy","Gruppo","Gudea","Gurajada","Habibi","Halant","Hammersmith One","Hanalei","Hanalei Fill","Handlee","Hanuman","Happy Monkey","Headland One","Henny Penny","Herr Von Muellerhoff","Hind","Hind Siliguri","Hind Vadodara","Holtwood One SC","Homemade Apple","Homenaje","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Iceberg","Iceland","Imprima","Inconsolata","Inder","Indie Flower","Inika","Inknut Antiqua","Irish Grover","Istok Web","Italiana","Italianno","Itim","Jacques Francois","Jacques Francois Shadow","Jaldi","Jim Nightshade","Jockey One","Jolly Lodger","Josefin Sans","Josefin Slab","Joti One","Judson","Julee","Julius Sans One","Junge","Jura","Just Another Hand","Just Me Again Down Here","Kadwa","Kalam","Kameron","Kantumruy","Karla","Karma","Kaushan Script","Kavoon","Kdam Thmor","Keania One","Kelly Slab","Kenia","Khand","Khmer","Khula","Kite One","Knewave","Kotta One","Koulen","Kranky","Kreon","Kristi","Krona One","Kurale","La Belle Aurore","Laila","Lakki Reddy","Lancelot","Lateef","Lato","League Script","Leckerli One","Ledger","Lekton","Lemon","Libre Baskerville","Life Savers","Lilita One","Lily Script One","Limelight","Linden Hill","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Lora","Love Ya Like A Sister","Loved by the King","Lovers Quarrel","Luckiest Guy","Lusitana","Lustria","Macondo","Macondo Swash Caps","Magra","Maiden Orange","Mako","Mallanna","Mandali","Marcellus","Marcellus SC","Marck Script","Margarine","Marko One","Marmelad","Martel","Martel Sans","Marvel","Mate","Mate SC","Maven Pro","McLaren","Meddon","MedievalSharp","Medula One","Megrim","Meie Script","Merienda","Merienda One","Merriweather","Merriweather Sans","Metal","Metal Mania","Metamorphous","Metrophobic","Michroma","Milonga","Miltonian","Miltonian Tattoo","Miniver","Miss Fajardose","Modak","Modern Antiqua","Molengo","Molle","Monda","Monofett","Monoton","Monsieur La Doulaise","Montaga","Montez","Montserrat","Montserrat Alternates","Montserrat Subrayada","Moul","Moulpali","Mountains of Christmas","Mouse Memoirs","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Muli","Mystery Quest","NTR","Neucha","Neuton","New Rocker","News Cycle","Niconne","Nixie One","Nobile","Nokora","Norican","Nosifer","Nothing You Could Do","Noticia Text","Noto Sans","Noto Serif","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Numans","Nunito","Odor Mean Chey","Offside","Old Standard TT","Oldenburg","Oleo Script","Oleo Script Swash Caps","Open Sans","Open Sans Condensed","Oranienbaum","Orbitron","Oregano","Orienta","Original Surfer","Oswald","Over the Rainbow","Overlock","Overlock SC","Ovo","Oxygen","Oxygen Mono","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Pacifico","Palanquin","Palanquin Dark","Paprika","Parisienne","Passero One","Passion One","Pathway Gothic One","Patrick Hand","Patrick Hand SC","Patua One","Paytone One","Peddana","Peralta","Permanent Marker","Petit Formal Script","Petrona","Philosopher","Piedra","Pinyon Script","Pirata One","Plaster","Play","Playball","Playfair Display","Playfair Display SC","Podkova","Poiret One","Poller One","Poly","Pompiere","Pontano Sans","Poppins","Port Lligat Sans","Port Lligat Slab","Pragati Narrow","Prata","Preahvihear","Press Start 2P","Princess Sofia","Prociono","Prosto One","Puritan","Purple Purse","Quando","Quantico","Quattrocento","Quattrocento Sans","Questrial","Quicksand","Quintessential","Qwigley","Racing Sans One","Radley","Rajdhani","Raleway","Raleway Dots","Ramabhadra","Ramaraja","Rambla","Rammetto One","Ranchers","Rancho","Ranga","Rationale","Ravi Prakash","Redressed","Reenie Beanie","Revalia","Rhodium Libre","Ribeye","Ribeye Marrow","Righteous","Risque","Roboto","Roboto Condensed","Roboto Mono","Roboto Slab","Rochester","Rock Salt","Rokkitt","Romanesco","Ropa Sans","Rosario","Rosarivo","Rouge Script","Rozha One","Rubik","Rubik Mono One","Rubik One","Ruda","Rufina","Ruge Boogie","Ruluko","Rum Raisin","Ruslan Display","Russo One","Ruthie","Rye","Sacramento","Sahitya","Sail","Salsa","Sanchez","Sancreek","Sansita One","Sarala","Sarina","Sarpanch","Satisfy","Scada","Scheherazade","Schoolbell","Seaweed Script","Sevillana","Seymour One","Shadows Into Light","Shadows Into Light Two","Shanti","Share","Share Tech","Share Tech Mono","Shojumaru","Short Stack","Siemreap","Sigmar One","Signika","Signika Negative","Simonetta","Sintony","Sirin Stencil","Six Caps","Skranji","Slabo 13px","Slabo 27px","Slackey","Smokum","Smythe","Sniglet","Snippet","Snowburst One","Sofadi One","Sofia","Sonsie One","Sorts Mill Goudy","Source Code Pro","Source Sans Pro","Source Serif Pro","Special Elite","Spicy Rice","Spinnaker","Spirax","Squada One","Sree Krushnadevaraya","Stalemate","Stalinist One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Stoke","Strait","Sue Ellen Francisco","Sumana","Sunshiney","Supermercado One","Sura","Suranna","Suravaram","Suwannaphum","Swanky and Moo Moo","Syncopate","Tangerine","Taprom","Tauri","Teko","Telex","Tenali Ramakrishna","Tenor Sans","Text Me One","The Girl Next Door","Tienne","Tillana","Timmana","Tinos","Titan One","Titillium Web","Trade Winds","Trocchi","Trochut","Trykker","Tulpen One","Ubuntu","Ubuntu Condensed","Ubuntu Mono","Ultra","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unkempt","Unlock","Unna","VT323","Vampiro One","Varela","Varela Round","Vast Shadow","Vesper Libre","Vibur","Vidaloka","Viga","Voces","Volkhov","Vollkorn","Voltaire","Waiting for the Sunrise","Wallpoet","Walter Turncoat","Warnes","Wellfleet","Wendy One","Wire One","Work Sans","Yanone Kaffeesatz","Yantramanav","Yellowtail","Yeseva One","Yesteryear","Zeyada"]}).call(this)},function(t,e,r){"use strict";var n=r(15);class i extends n.a{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const e of this._observers)e.next(t)}error(t){for(const e of this._observers)e.error(t)}complete(){for(const t of this._observers)t.complete()}}e.a=i},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));const n=()=>{};function i(){let t,e=!1,r=n;return[new Promise(n=>{e?n(t):r=n}),n=>{e=!0,t=n,r(t)}]}},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return o}));var n=r(4);function i(t){return t&&"object"==typeof t&&t[n.d]}function o(t,e){if(!e){if(!(r=t)||"object"!=typeof r)throw Error();e=[t]}var r;return{[n.d]:!0,send:t,transferables:e}}},function(t,e,r){const n=r(103);t.exports=function(t,e,r){const i=[],o=r&&r.debug||!1;let s,a=r&&r.startIndex||0;for(;s=n(t,e,{debug:o,startIndex:a});)a=s.end,i.push(s);return o&&console.log("findTagsByName found",i.length,"tags"),i}},function(t,e,r){"use strict";const n=r(105),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),h=Symbol("lruList"),f=Symbol("cache"),p=Symbol("updateAgeOnGet"),d=()=>1;const g=(t,e,r)=>{const n=t[f].get(e);if(n){const e=n.value;if(y(t,e)){if(_(t,n),!t[a])return}else r&&(t[p]&&(n.value.now=Date.now()),t[h].unshiftNode(n));return e.value}},y=(t,e)=>{if(!e||!e.maxAge&&!t[l])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[l]&&r>t[l]},m=t=>{if(t[o]>t[i])for(let e=t[h].tail;t[o]>t[i]&&null!==e;){const r=e.prev;_(t,e),e=r}},_=(t,e)=>{if(e){const r=e.value;t[u]&&t[u](r.key,r.value),t[o]-=r.length,t[f].delete(r.key),t[h].removeNode(e)}};class v{constructor(t,e,r,n,i){this.key=t,this.value=e,this.length=r,this.now=n,this.maxAge=i||0}}const b=(t,e,r,n)=>{let i=r.value;y(t,i)&&(_(t,r),t[a]||(i=void 0)),i&&e.call(n,i.value,i.key,t)};t.exports=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||d;if(this[s]="function"!=typeof e?d:e,this[a]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[u]=t.dispose,this[c]=t.noDisposeOnSet||!1,this[p]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,m(this)}get max(){return this[i]}set allowStale(t){this[a]=!!t}get allowStale(){return this[a]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[l]=t,m(this)}get maxAge(){return this[l]}set lengthCalculator(t){"function"!=typeof t&&(t=d),t!==this[s]&&(this[s]=t,this[o]=0,this[h].forEach(t=>{t.length=this[s](t.value,t.key),this[o]+=t.length})),m(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[h].length}rforEach(t,e){e=e||this;for(let r=this[h].tail;null!==r;){const n=r.prev;b(this,t,r,e),r=n}}forEach(t,e){e=e||this;for(let r=this[h].head;null!==r;){const n=r.next;b(this,t,r,e),r=n}}keys(){return this[h].toArray().map(t=>t.key)}values(){return this[h].toArray().map(t=>t.value)}reset(){this[u]&&this[h]&&this[h].length&&this[h].forEach(t=>this[u](t.key,t.value)),this[f]=new Map,this[h]=new n,this[o]=0}dump(){return this[h].map(t=>!y(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[h]}set(t,e,r){if((r=r||this[l])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,a=this[s](e,t);if(this[f].has(t)){if(a>this[i])return _(this,this[f].get(t)),!1;const s=this[f].get(t).value;return this[u]&&(this[c]||this[u](t,s.value)),s.now=n,s.maxAge=r,s.value=e,this[o]+=a-s.length,s.length=a,this.get(t),m(this),!0}const p=new v(t,e,a,n,r);return p.length>this[i]?(this[u]&&this[u](t,e),!1):(this[o]+=p.length,this[h].unshift(p),this[f].set(t,this[h].head),m(this),!0)}has(t){if(!this[f].has(t))return!1;const e=this[f].get(t).value;return!y(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[h].tail;return t?(_(this,t),t.value):null}del(t){_(this,this[f].get(t))}load(t){this.reset();const e=Date.now();for(let r=t.length-1;r>=0;r--){const n=t[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const t=i-e;t>0&&this.set(n.k,n.v,t)}}}prune(){this[f].forEach((t,e)=>g(this,e,!1))}}},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return f}));var n=r(61),i=r.n(n),o=r(62),s=r.n(o),a=r(63),l=r.n(a),u=r(9),c=r(2);class h extends u.b{constructor(t,e){super(),this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){return await this.dataPromise}}class f extends u.a{constructor(t){super(t),this.parsedUrl=l.a.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?i.a:s.a}constructRequest(e,r){return new Promise((n,i)=>{const o=this.httpApi.get({...this.parsedUrl,headers:e},e=>{const r=new Promise(r=>{const n=[];e.on("data",t=>{n.push(t)}),e.on("end",()=>{const e=t.concat(n).buffer;r(e)}),e.on("error",i)});n(new h(e,r))});o.on("error",i),r&&(r.aborted&&o.destroy(new c.a("Request aborted")),r.addEventListener("abort",()=>o.destroy(new c.a("Request aborted"))))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}}).call(this,r(23).Buffer)},function(t,e){},function(t,e){},function(t,e){},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return a}));var n=r(20),i=r.n(n),o=r(7);class s extends o.a{constructor(t){super(),this.path=t,this.openRequest=function(t,e,r){return new Promise((n,o)=>{i.a.open(t,e,r,(t,e)=>{t?o(t):n(e)})})}(t,"r")}async fetchSlice(e){const r=await this.openRequest,{buffer:n}=await function(...t){return new Promise((e,r)=>{i.a.read(...t,(t,n,i)=>{t?r(t):e({bytesRead:n,buffer:i})})})}(r,t.alloc(e.length),0,e.length,e.offset);return n.buffer}async close(){const t=await this.openRequest;await function(t){return new Promise((e,r)=>{i.a.close(t,t=>{t?r(t):e()})})}(t)}}function a(t){return new s(t)}}).call(this,r(23).Buffer)},function(t,e,r){var n,i,o,s,a,l,u,c,h,f,p,d,g;
/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */i={defaultNoDataValue:-34027999387901484e22,decode:function(t,e){var r=(e=e||{}).encodedMaskData||null===e.encodedMaskData,n=l(t,e.inputOffset||0,r),u=null!==e.noDataValue?e.noDataValue:i.defaultNoDataValue,c=o(n,e.pixelType||Float32Array,e.encodedMaskData,u,e.returnMask),h={width:n.width,height:n.height,pixelData:c.resultPixels,minValue:c.minValue,maxValue:n.pixels.maxValue,noDataValue:u};return c.resultMask&&(h.maskData=c.resultMask),e.returnEncodedMask&&n.mask&&(h.encodedMaskData=n.mask.bitset?n.mask.bitset:null),e.returnFileInfo&&(h.fileInfo=s(n),e.computeUsedBitDepths&&(h.fileInfo.bitDepths=a(n))),h}},o=function(t,e,r,n,i){var o,s,a,l=0,c=t.pixels.numBlocksX,h=t.pixels.numBlocksY,f=Math.floor(t.width/c),p=Math.floor(t.height/h),d=2*t.maxZError,g=Number.MAX_VALUE;r=r||(t.mask?t.mask.bitset:null),s=new e(t.width*t.height),i&&r&&(a=new Uint8Array(t.width*t.height));for(var y,m,_=new Float32Array(f*p),v=0;v<=h;v++){var b=v!==h?p:t.height%h;if(0!==b)for(var w=0;w<=c;w++){var x=w!==c?f:t.width%c;if(0!==x){var E,S,I,O,C=v*t.width*p+w*f,T=t.width-x,P=t.pixels.blocks[l];if(P.encoding<2?(0===P.encoding?E=P.rawData:(u(P.stuffedData,P.bitsPerPixel,P.numValidPixels,P.offset,d,_,t.pixels.maxValue),E=_),S=0):I=2===P.encoding?0:P.offset,r)for(m=0;m<b;m++){for(7&C&&(O=r[C>>3],O<<=7&C),y=0;y<x;y++)7&C||(O=r[C>>3]),128&O?(a&&(a[C]=1),g=g>(o=P.encoding<2?E[S++]:I)?o:g,s[C++]=o):(a&&(a[C]=0),s[C++]=n),O<<=1;C+=T}else if(P.encoding<2)for(m=0;m<b;m++){for(y=0;y<x;y++)g=g>(o=E[S++])?o:g,s[C++]=o;C+=T}else for(g=g>I?I:g,m=0;m<b;m++){for(y=0;y<x;y++)s[C++]=I;C+=T}if(1===P.encoding&&S!==P.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:s,resultMask:a,minValue:g}},s=function(t){return{fileIdentifierString:t.fileIdentifierString,fileVersion:t.fileVersion,imageType:t.imageType,height:t.height,width:t.width,maxZError:t.maxZError,eofOffset:t.eofOffset,mask:t.mask?{numBlocksX:t.mask.numBlocksX,numBlocksY:t.mask.numBlocksY,numBytes:t.mask.numBytes,maxValue:t.mask.maxValue}:null,pixels:{numBlocksX:t.pixels.numBlocksX,numBlocksY:t.pixels.numBlocksY,numBytes:t.pixels.numBytes,maxValue:t.pixels.maxValue,noDataValue:t.noDataValue}}},a=function(t){for(var e=t.pixels.numBlocksX*t.pixels.numBlocksY,r={},n=0;n<e;n++){var i=t.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},l=function(t,e,r){var n={},i=new Uint8Array(t,e,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;e+=10;var o=new DataView(t,e,24);if(n.fileVersion=o.getInt32(0,!0),n.imageType=o.getInt32(4,!0),n.height=o.getUint32(8,!0),n.width=o.getUint32(12,!0),n.maxZError=o.getFloat64(16,!0),e+=24,!r)if(o=new DataView(t,e,16),n.mask={},n.mask.numBlocksY=o.getUint32(0,!0),n.mask.numBlocksX=o.getUint32(4,!0),n.mask.numBytes=o.getUint32(8,!0),n.mask.maxValue=o.getFloat32(12,!0),e+=16,n.mask.numBytes>0){var s=new Uint8Array(Math.ceil(n.width*n.height/8)),a=(o=new DataView(t,e,n.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(a>0)for(;a--;)s[u++]=o.getUint8(l++);else{var c=o.getUint8(l++);for(a=-a;a--;)s[u++]=c}a=o.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==a||u<s.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=s,e+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));o=new DataView(t,e,16),n.pixels={},n.pixels.numBlocksY=o.getUint32(0,!0),n.pixels.numBlocksX=o.getUint32(4,!0),n.pixels.numBytes=o.getUint32(8,!0),n.pixels.maxValue=o.getFloat32(12,!0),e+=16;var h=n.pixels.numBlocksX,f=n.pixels.numBlocksY,p=h+(n.width%h>0?1:0),d=f+(n.height%f>0?1:0);n.pixels.blocks=new Array(p*d);for(var g=0,y=0;y<d;y++)for(var m=0;m<p;m++){var _=0,v=t.byteLength-e;o=new DataView(t,e,Math.min(10,v));var b={};n.pixels.blocks[g++]=b;var w=o.getUint8(0);if(_++,b.encoding=63&w,b.encoding>3)throw"Invalid block encoding ("+b.encoding+")";if(2!==b.encoding){if(0!==w&&2!==w){if(w>>=6,b.offsetType=w,2===w)b.offset=o.getInt8(1),_++;else if(1===w)b.offset=o.getInt16(1,!0),_+=2;else{if(0!==w)throw"Invalid block offset type";b.offset=o.getFloat32(1,!0),_+=4}if(1===b.encoding)if(w=o.getUint8(_),_++,b.bitsPerPixel=63&w,w>>=6,b.numValidPixelsType=w,2===w)b.numValidPixels=o.getUint8(_),_++;else if(1===w)b.numValidPixels=o.getUint16(_,!0),_+=2;else{if(0!==w)throw"Invalid valid pixel count type";b.numValidPixels=o.getUint32(_,!0),_+=4}}var x;if(e+=_,3!==b.encoding)if(0===b.encoding){var E=(n.pixels.numBytes-1)/4;if(E!==Math.floor(E))throw"uncompressed block has invalid length";x=new ArrayBuffer(4*E),new Uint8Array(x).set(new Uint8Array(t,e,4*E));var S=new Float32Array(x);b.rawData=S,e+=4*E}else if(1===b.encoding){var I=Math.ceil(b.numValidPixels*b.bitsPerPixel/8),O=Math.ceil(I/4);x=new ArrayBuffer(4*O),new Uint8Array(x).set(new Uint8Array(t,e,I)),b.stuffedData=new Uint32Array(x),e+=I}}else e++}return n.eofOffset=e,n},u=function(t,e,r,n,i,o,s){var a,l,u,c=(1<<e)-1,h=0,f=0,p=Math.ceil((s-n)/i),d=4*t.length-Math.ceil(e*r/8);for(t[t.length-1]<<=8*d,a=0;a<r;a++){if(0===f&&(u=t[h++],f=32),f>=e)l=u>>>f-e&c,f-=e;else{var g=e-f;l=(u&c)<<g&c,l+=(u=t[h++])>>>(f=32-g)}o[a]=l<p?n+l*i:s}return o},f=i,p=function(){"use strict";var t=function(t,e,r,n,i,o,s,a){var l,u,c,h,f,p=(1<<r)-1,d=0,g=0,y=4*t.length-Math.ceil(r*n/8);if(t[t.length-1]<<=8*y,i)for(l=0;l<n;l++)0===g&&(c=t[d++],g=32),g>=r?(u=c>>>g-r&p,g-=r):(u=(c&p)<<(h=r-g)&p,u+=(c=t[d++])>>>(g=32-h)),e[l]=i[u];else for(f=Math.ceil((a-o)/s),l=0;l<n;l++)0===g&&(c=t[d++],g=32),g>=r?(u=c>>>g-r&p,g-=r):(u=(c&p)<<(h=r-g)&p,u+=(c=t[d++])>>>(g=32-h)),e[l]=u<f?o+u*s:a},e=function(t,e,r,n,i,o){var s,a=(1<<e)-1,l=0,u=0,c=0,h=0,f=0,p=[],d=4*t.length-Math.ceil(e*r/8);t[t.length-1]<<=8*d;var g=Math.ceil((o-n)/i);for(u=0;u<r;u++)0===h&&(s=t[l++],h=32),h>=e?(f=s>>>h-e&a,h-=e):(f=(s&a)<<(c=e-h)&a,f+=(s=t[l++])>>>(h=32-c)),p[u]=f<g?n+f*i:o;return p.unshift(n),p},r=function(t,e,r,n,i,o,s,a){var l,u,c,h,f=(1<<r)-1,p=0,d=0,g=0;if(i)for(l=0;l<n;l++)0===d&&(c=t[p++],d=32,g=0),d>=r?(u=c>>>g&f,d-=r,g+=r):(u=c>>>g&f,d=32-(h=r-d),u|=((c=t[p++])&(1<<h)-1)<<r-h,g=h),e[l]=i[u];else{var y=Math.ceil((a-o)/s);for(l=0;l<n;l++)0===d&&(c=t[p++],d=32,g=0),d>=r?(u=c>>>g&f,d-=r,g+=r):(u=c>>>g&f,d=32-(h=r-d),u|=((c=t[p++])&(1<<h)-1)<<r-h,g=h),e[l]=u<y?o+u*s:a}return e},n=function(t,e,r,n,i,o){var s,a=(1<<e)-1,l=0,u=0,c=0,h=0,f=0,p=0,d=[],g=Math.ceil((o-n)/i);for(u=0;u<r;u++)0===h&&(s=t[l++],h=32,p=0),h>=e?(f=s>>>p&a,h-=e,p+=e):(f=s>>>p&a,h=32-(c=e-h),f|=((s=t[l++])&(1<<c)-1)<<e-c,p=c),d[u]=f<g?n+f*i:o;return d.unshift(n),d},i=function(t,e,r,n){var i,o,s,a,l=(1<<r)-1,u=0,c=0,h=4*t.length-Math.ceil(r*n/8);for(t[t.length-1]<<=8*h,i=0;i<n;i++)0===c&&(s=t[u++],c=32),c>=r?(o=s>>>c-r&l,c-=r):(o=(s&l)<<(a=r-c)&l,o+=(s=t[u++])>>>(c=32-a)),e[i]=o;return e},o=function(t,e,r,n){var i,o,s,a,l=(1<<r)-1,u=0,c=0,h=0;for(i=0;i<n;i++)0===c&&(s=t[u++],c=32,h=0),c>=r?(o=s>>>h&l,c-=r,h+=r):(o=s>>>h&l,c=32-(a=r-c),o|=((s=t[u++])&(1<<a)-1)<<r-a,h=a),e[i]=o;return e},s={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(t){for(var e=65535,r=65535,n=t.length,i=Math.floor(n/2),o=0;i;){var s=i>=359?359:i;i-=s;do{e+=t[o++]<<8,r+=e+=t[o++]}while(--s);e=(65535&e)+(e>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=e+=t[o]<<8),((r=(65535&r)+(r>>>16))<<16|(e=(65535&e)+(e>>>16)))>>>0},readHeaderInfo:function(t,e){var r=e.ptr,n=new Uint8Array(t,r,6),i={};if(i.fileIdentifierString=String.fromCharCode.apply(null,n),0!==i.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+i.fileIdentifierString;r+=6;var o,s=new DataView(t,r,8),a=s.getInt32(0,!0);if(i.fileVersion=a,r+=4,a>=3&&(i.checksum=s.getUint32(4,!0),r+=4),s=new DataView(t,r,12),i.height=s.getUint32(0,!0),i.width=s.getUint32(4,!0),r+=8,a>=4?(i.numDims=s.getUint32(8,!0),r+=4):i.numDims=1,s=new DataView(t,r,40),i.numValidPixel=s.getUint32(0,!0),i.microBlockSize=s.getInt32(4,!0),i.blobSize=s.getInt32(8,!0),i.imageType=s.getInt32(12,!0),i.maxZError=s.getFloat64(16,!0),i.zMin=s.getFloat64(24,!0),i.zMax=s.getFloat64(32,!0),r+=40,e.headerInfo=i,e.ptr=r,a>=3&&(o=a>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(t,r-o,i.blobSize-14))!==i.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(t,e){var r=e.headerInfo,n=this.getDataTypeArray(r.imageType),i=r.numDims*this.getDataTypeSize(r.imageType),o=this.readSubArray(t,e.ptr,n,i),s=this.readSubArray(t,e.ptr+i,n,i);e.ptr+=2*i;var a,l=!0;for(a=0;a<r.numDims;a++)if(o[a]!==s[a]){l=!1;break}return r.minValues=o,r.maxValues=s,l},readSubArray:function(t,e,r,n){var i;if(r===Uint8Array)i=new Uint8Array(t,e,n);else{var o=new ArrayBuffer(n);new Uint8Array(o).set(new Uint8Array(t,e,n)),i=new r(o)}return i},readMask:function(t,e){var r,n,i=e.ptr,o=e.headerInfo,s=o.width*o.height,a=o.numValidPixel,l=new DataView(t,i,4),u={};if(u.numBytes=l.getUint32(0,!0),i+=4,(0===a||s===a)&&0!==u.numBytes)throw"invalid mask";if(0===a)r=new Uint8Array(Math.ceil(s/8)),u.bitset=r,n=new Uint8Array(s),e.pixels.resultMask=n,i+=u.numBytes;else if(u.numBytes>0){r=new Uint8Array(Math.ceil(s/8));var c=(l=new DataView(t,i,u.numBytes)).getInt16(0,!0),h=2,f=0,p=0;do{if(c>0)for(;c--;)r[f++]=l.getUint8(h++);else for(p=l.getUint8(h++),c=-c;c--;)r[f++]=p;c=l.getInt16(h,!0),h+=2}while(h<u.numBytes);if(-32768!==c||f<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(s);var d=0,g=0;for(g=0;g<s;g++)7&g?(d=r[g>>3],d<<=7&g):d=r[g>>3],128&d&&(n[g]=1);e.pixels.resultMask=n,u.bitset=r,i+=u.numBytes}return e.ptr=i,e.mask=u,!0},readDataOneSweep:function(t,e,r,n){var i,o=e.ptr,a=e.headerInfo,l=a.numDims,u=a.width*a.height,c=a.imageType,h=a.numValidPixel*s.getDataTypeSize(c)*l,f=e.pixels.resultMask;if(r===Uint8Array)i=new Uint8Array(t,o,h);else{var p=new ArrayBuffer(h);new Uint8Array(p).set(new Uint8Array(t,o,h)),i=new r(p)}if(i.length===u*l)e.pixels.resultPixels=n?s.swapDimensionOrder(i,u,l,r,!0):i;else{e.pixels.resultPixels=new r(u*l);var d=0,g=0,y=0,m=0;if(l>1){if(n){for(g=0;g<u;g++)if(f[g])for(m=g,y=0;y<l;y++,m+=u)e.pixels.resultPixels[m]=i[d++]}else for(g=0;g<u;g++)if(f[g])for(m=g*l,y=0;y<l;y++)e.pixels.resultPixels[m+y]=i[d++]}else for(g=0;g<u;g++)f[g]&&(e.pixels.resultPixels[g]=i[d++])}return o+=h,e.ptr=o,!0},readHuffmanTree:function(t,e){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(t,e.ptr,16);if(e.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var i=n.getInt32(4,!0),o=n.getInt32(8,!0),l=n.getInt32(12,!0);if(o>=l)return!1;var u=new Uint32Array(l-o);s.decodeBits(t,e,u);var c,h,f,p,d=[];for(c=o;c<l;c++)d[h=c-(c<i?0:i)]={first:u[c-o],second:null};var g=t.byteLength-e.ptr,y=Math.ceil(g/4),m=new ArrayBuffer(4*y);new Uint8Array(m).set(new Uint8Array(t,e.ptr,g));var _,v=new Uint32Array(m),b=0,w=0;for(_=v[0],c=o;c<l;c++)(p=d[h=c-(c<i?0:i)].first)>0&&(d[h].second=_<<b>>>32-p,32-b>=p?32===(b+=p)&&(b=0,_=v[++w]):(b+=p-32,_=v[++w],d[h].second|=_>>>32-b));var x=0,E=0,S=new a;for(c=0;c<d.length;c++)void 0!==d[c]&&(x=Math.max(x,d[c].first));E=x>=r?r:x;var I,O,C,T,P,R=[];for(c=o;c<l;c++)if((p=d[h=c-(c<i?0:i)].first)>0)if(I=[p,h],p<=E)for(O=d[h].second<<E-p,C=1<<E-p,f=0;f<C;f++)R[O|f]=I;else for(O=d[h].second,P=S,T=p-1;T>=0;T--)O>>>T&1?(P.right||(P.right=new a),P=P.right):(P.left||(P.left=new a),P=P.left),0!==T||P.val||(P.val=I[1]);return{decodeLut:R,numBitsLUTQick:E,numBitsLUT:x,tree:S,stuffedData:v,srcPtr:w,bitPos:b}},readHuffman:function(t,e,r,n){var i,o,a,l,u,c,h,f,p,d=e.headerInfo.numDims,g=e.headerInfo.height,y=e.headerInfo.width,m=y*g,_=this.readHuffmanTree(t,e),v=_.decodeLut,b=_.tree,w=_.stuffedData,x=_.srcPtr,E=_.bitPos,S=_.numBitsLUTQick,I=_.numBitsLUT,O=0===e.headerInfo.imageType?128:0,C=e.pixels.resultMask,T=0;E>0&&(x++,E=0);var P,R=w[x],L=1===e.encodeMode,M=new r(m*d),k=M;if(d<2||L){for(P=0;P<d;P++)if(d>1&&(k=new r(M.buffer,m*P,m),T=0),e.headerInfo.numValidPixel===y*g)for(f=0,c=0;c<g;c++)for(h=0;h<y;h++,f++){if(o=0,u=l=R<<E>>>32-S,32-E<S&&(u=l|=w[x+1]>>>64-E-S),v[u])o=v[u][1],E+=v[u][0];else for(u=l=R<<E>>>32-I,32-E<I&&(u=l|=w[x+1]>>>64-E-I),i=b,p=0;p<I;p++)if(!(i=l>>>I-p-1&1?i.right:i.left).left&&!i.right){o=i.val,E=E+p+1;break}E>=32&&(E-=32,R=w[++x]),a=o-O,L?(a+=h>0?T:c>0?k[f-y]:T,a&=255,k[f]=a,T=a):k[f]=a}else for(f=0,c=0;c<g;c++)for(h=0;h<y;h++,f++)if(C[f]){if(o=0,u=l=R<<E>>>32-S,32-E<S&&(u=l|=w[x+1]>>>64-E-S),v[u])o=v[u][1],E+=v[u][0];else for(u=l=R<<E>>>32-I,32-E<I&&(u=l|=w[x+1]>>>64-E-I),i=b,p=0;p<I;p++)if(!(i=l>>>I-p-1&1?i.right:i.left).left&&!i.right){o=i.val,E=E+p+1;break}E>=32&&(E-=32,R=w[++x]),a=o-O,L?(h>0&&C[f-1]?a+=T:c>0&&C[f-y]?a+=k[f-y]:a+=T,a&=255,k[f]=a,T=a):k[f]=a}}else for(f=0,c=0;c<g;c++)for(h=0;h<y;h++)if(f=c*y+h,!C||C[f])for(P=0;P<d;P++,f+=m){if(o=0,u=l=R<<E>>>32-S,32-E<S&&(u=l|=w[x+1]>>>64-E-S),v[u])o=v[u][1],E+=v[u][0];else for(u=l=R<<E>>>32-I,32-E<I&&(u=l|=w[x+1]>>>64-E-I),i=b,p=0;p<I;p++)if(!(i=l>>>I-p-1&1?i.right:i.left).left&&!i.right){o=i.val,E=E+p+1;break}E>=32&&(E-=32,R=w[++x]),a=o-O,k[f]=a}e.ptr=e.ptr+4*(x+1)+(E>0?4:0),e.pixels.resultPixels=M,d>1&&!n&&(e.pixels.resultPixels=s.swapDimensionOrder(M,m,d,r))},decodeBits:function(s,a,l,u,c){var h=a.headerInfo,f=h.fileVersion,p=0,d=s.byteLength-a.ptr>=5?5:s.byteLength-a.ptr,g=new DataView(s,a.ptr,d),y=g.getUint8(0);p++;var m=y>>6,_=0===m?4:3-m,v=(32&y)>0,b=31&y,w=0;if(1===_)w=g.getUint8(p),p++;else if(2===_)w=g.getUint16(p,!0),p+=2;else{if(4!==_)throw"Invalid valid pixel count type";w=g.getUint32(p,!0),p+=4}var x,E,S,I,O,C,T,P,R,L=2*h.maxZError,M=h.numDims>1?h.maxValues[c]:h.zMax;if(v){for(a.counter.lut++,P=g.getUint8(p),p++,I=Math.ceil((P-1)*b/8),O=Math.ceil(I/4),E=new ArrayBuffer(4*O),S=new Uint8Array(E),a.ptr+=p,S.set(new Uint8Array(s,a.ptr,I)),T=new Uint32Array(E),a.ptr+=I,R=0;P-1>>>R;)R++;I=Math.ceil(w*R/8),O=Math.ceil(I/4),E=new ArrayBuffer(4*O),(S=new Uint8Array(E)).set(new Uint8Array(s,a.ptr,I)),x=new Uint32Array(E),a.ptr+=I,C=f>=3?n(T,b,P-1,u,L,M):e(T,b,P-1,u,L,M),f>=3?r(x,l,R,w,C):t(x,l,R,w,C)}else a.counter.bitstuffer++,R=b,a.ptr+=p,R>0&&(I=Math.ceil(w*R/8),O=Math.ceil(I/4),E=new ArrayBuffer(4*O),(S=new Uint8Array(E)).set(new Uint8Array(s,a.ptr,I)),x=new Uint32Array(E),a.ptr+=I,f>=3?null==u?o(x,l,R,w):r(x,l,R,w,!1,u,L,M):null==u?i(x,l,R,w):t(x,l,R,w,!1,u,L,M))},readTiles:function(t,e,r,n){var i=e.headerInfo,o=i.width,a=i.height,l=o*a,u=i.microBlockSize,c=i.imageType,h=s.getDataTypeSize(c),f=Math.ceil(o/u),p=Math.ceil(a/u);e.pixels.numBlocksY=p,e.pixels.numBlocksX=f,e.pixels.ptr=0;var d,g,y,m,_,v,b,w,x,E,S=0,I=0,O=0,C=0,T=0,P=0,R=0,L=0,M=0,k=0,N=0,A=0,F=0,D=0,j=0,G=new r(u*u),z=a%u||u,U=o%u||u,B=i.numDims,V=e.pixels.resultMask,q=e.pixels.resultPixels,Y=i.fileVersion>=5?14:15,W=i.zMax;for(O=0;O<p;O++)for(T=O!==p-1?u:z,C=0;C<f;C++)for(k=O*o*u+C*u,N=o-(P=C!==f-1?u:U),w=0;w<B;w++){if(B>1?(E=q,k=O*o*u+C*u,q=new r(e.pixels.resultPixels.buffer,l*w*h,l),W=i.maxValues[w]):E=null,R=t.byteLength-e.ptr,g={},j=0,L=(d=new DataView(t,e.ptr,Math.min(10,R))).getUint8(0),j++,x=i.fileVersion>=5?4&L:0,M=L>>6&255,(L>>2&Y)!=(C*u>>3&Y))throw"integrity issue";if(x&&0===w)throw"integrity issue";if((_=3&L)>3)throw e.ptr+=j,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(x)throw"integrity issue";if(e.counter.uncompressed++,e.ptr+=j,A=(A=T*P*h)<(F=t.byteLength-e.ptr)?A:F,y=new ArrayBuffer(A%h==0?A:A+h-A%h),new Uint8Array(y).set(new Uint8Array(t,e.ptr,A)),m=new r(y),D=0,V)for(S=0;S<T;S++){for(I=0;I<P;I++)V[k]&&(q[k]=m[D++]),k++;k+=N}else for(S=0;S<T;S++){for(I=0;I<P;I++)q[k++]=m[D++];k+=N}e.ptr+=D*h}else if(v=s.getDataTypeUsed(x&&c<6?4:c,M),b=s.getOnePixel(g,j,v,d),j+=s.getDataTypeSize(v),3===_)if(e.ptr+=j,e.counter.constantoffset++,V)for(S=0;S<T;S++){for(I=0;I<P;I++)V[k]&&(q[k]=x?Math.min(W,E[k]+b):b),k++;k+=N}else for(S=0;S<T;S++){for(I=0;I<P;I++)q[k]=x?Math.min(W,E[k]+b):b,k++;k+=N}else if(e.ptr+=j,s.decodeBits(t,e,G,b,w),j=0,x)if(V)for(S=0;S<T;S++){for(I=0;I<P;I++)V[k]&&(q[k]=G[j++]+E[k]),k++;k+=N}else for(S=0;S<T;S++){for(I=0;I<P;I++)q[k]=G[j++]+E[k],k++;k+=N}else if(V)for(S=0;S<T;S++){for(I=0;I<P;I++)V[k]&&(q[k]=G[j++]),k++;k+=N}else for(S=0;S<T;S++){for(I=0;I<P;I++)q[k++]=G[j++];k+=N}else{if(x)if(V)for(S=0;S<T;S++)for(I=0;I<P;I++)V[k]&&(q[k]=E[k]),k++;else for(S=0;S<T;S++)for(I=0;I<P;I++)q[k]=E[k],k++;e.counter.constant++,e.ptr+=j}}B>1&&!n&&(e.pixels.resultPixels=s.swapDimensionOrder(e.pixels.resultPixels,l,B,r))},formatFileInfo:function(t){return{fileIdentifierString:t.headerInfo.fileIdentifierString,fileVersion:t.headerInfo.fileVersion,imageType:t.headerInfo.imageType,height:t.headerInfo.height,width:t.headerInfo.width,numValidPixel:t.headerInfo.numValidPixel,microBlockSize:t.headerInfo.microBlockSize,blobSize:t.headerInfo.blobSize,maxZError:t.headerInfo.maxZError,pixelType:s.getPixelType(t.headerInfo.imageType),eofOffset:t.eofOffset,mask:t.mask?{numBytes:t.mask.numBytes}:null,pixels:{numBlocksX:t.pixels.numBlocksX,numBlocksY:t.pixels.numBlocksY,maxValue:t.headerInfo.zMax,minValue:t.headerInfo.zMin,noDataValue:t.noDataValue}}},constructConstantSurface:function(t,e){var r=t.headerInfo.zMax,n=t.headerInfo.zMin,i=t.headerInfo.maxValues,o=t.headerInfo.numDims,s=t.headerInfo.height*t.headerInfo.width,a=0,l=0,u=0,c=t.pixels.resultMask,h=t.pixels.resultPixels;if(c)if(o>1){if(e)for(a=0;a<o;a++)for(u=a*s,r=i[a],l=0;l<s;l++)c[l]&&(h[u+l]=r);else for(l=0;l<s;l++)if(c[l])for(u=l*o,a=0;a<o;a++)h[u+o]=i[a]}else for(l=0;l<s;l++)c[l]&&(h[l]=r);else if(o>1&&n!==r)if(e)for(a=0;a<o;a++)for(u=a*s,r=i[a],l=0;l<s;l++)h[u+l]=r;else for(l=0;l<s;l++)for(u=l*o,a=0;a<o;a++)h[u+a]=i[a];else for(l=0;l<s*o;l++)h[l]=r},getDataTypeArray:function(t){var e;switch(t){case 0:e=Int8Array;break;case 1:e=Uint8Array;break;case 2:e=Int16Array;break;case 3:e=Uint16Array;break;case 4:e=Int32Array;break;case 5:e=Uint32Array;break;case 6:e=Float32Array;break;case 7:e=Float64Array;break;default:e=Float32Array}return e},getPixelType:function(t){var e;switch(t){case 0:e="S8";break;case 1:e="U8";break;case 2:e="S16";break;case 3:e="U16";break;case 4:e="S32";break;case 5:e="U32";break;case 6:e="F32";break;case 7:e="F64";break;default:e="F32"}return e},isValidPixelValue:function(t,e){if(null==e)return!1;var r;switch(t){case 0:r=e>=-128&&e<=127;break;case 1:r=e>=0&&e<=255;break;case 2:r=e>=-32768&&e<=32767;break;case 3:r=e>=0&&e<=65536;break;case 4:r=e>=-2147483648&&e<=2147483647;break;case 5:r=e>=0&&e<=4294967296;break;case 6:r=e>=-34027999387901484e22&&e<=34027999387901484e22;break;case 7:r=e>=-17976931348623157e292&&e<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(t){var e=0;switch(t){case 0:case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:case 6:e=4;break;case 7:e=8;break;default:e=t}return e},getDataTypeUsed:function(t,e){var r=t;switch(t){case 2:case 4:r=t-e;break;case 3:case 5:r=t-2*e;break;case 6:r=0===e?t:1===e?2:1;break;case 7:r=0===e?t:t-2*e+1;break;default:r=t}return r},getOnePixel:function(t,e,r,n){var i=0;switch(r){case 0:i=n.getInt8(e);break;case 1:i=n.getUint8(e);break;case 2:i=n.getInt16(e,!0);break;case 3:i=n.getUint16(e,!0);break;case 4:i=n.getInt32(e,!0);break;case 5:i=n.getUInt32(e,!0);break;case 6:i=n.getFloat32(e,!0);break;case 7:i=n.getFloat64(e,!0);break;default:throw"the decoder does not understand this pixel type"}return i},swapDimensionOrder:function(t,e,r,n,i){var o=0,s=0,a=0,l=0,u=t;if(r>1)if(u=new n(e*r),i)for(o=0;o<e;o++)for(l=o,a=0;a<r;a++,l+=e)u[l]=t[s++];else for(o=0;o<e;o++)for(l=o,a=0;a<r;a++,l+=e)u[s++]=t[l];return u}},a=function(t,e,r){this.val=t,this.left=e,this.right=r};return{decode:function(t,e){var r=(e=e||{}).noDataValue,n=0,i={};if(i.ptr=e.inputOffset||0,i.pixels={},s.readHeaderInfo(t,i)){var o=i.headerInfo,a=o.fileVersion,l=s.getDataTypeArray(o.imageType);if(a>5)throw"unsupported lerc version 2."+a;s.readMask(t,i),o.numValidPixel===o.width*o.height||i.pixels.resultMask||(i.pixels.resultMask=e.maskData);var u=o.width*o.height;i.pixels.resultPixels=new l(u*o.numDims),i.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var c,h=!e.returnPixelInterleavedDims;if(0!==o.numValidPixel)if(o.zMax===o.zMin)s.constructConstantSurface(i,h);else if(a>=4&&s.checkMinMaxRanges(t,i))s.constructConstantSurface(i,h);else{var f=new DataView(t,i.ptr,2),p=f.getUint8(0);if(i.ptr++,p)s.readDataOneSweep(t,i,l,h);else if(a>1&&o.imageType<=1&&Math.abs(o.maxZError-.5)<1e-5){var d=f.getUint8(1);if(i.ptr++,i.encodeMode=d,d>2||a<4&&d>1)throw"Invalid Huffman flag "+d;d?s.readHuffman(t,i,l,h):s.readTiles(t,i,l,h)}else s.readTiles(t,i,l,h)}i.eofOffset=i.ptr,e.inputOffset?(c=i.headerInfo.blobSize+e.inputOffset-i.ptr,Math.abs(c)>=1&&(i.eofOffset=e.inputOffset+i.headerInfo.blobSize)):(c=i.headerInfo.blobSize-i.ptr,Math.abs(c)>=1&&(i.eofOffset=i.headerInfo.blobSize));var g={width:o.width,height:o.height,pixelData:i.pixels.resultPixels,minValue:o.zMin,maxValue:o.zMax,validPixelCount:o.numValidPixel,dimCount:o.numDims,dimStats:{minValues:o.minValues,maxValues:o.maxValues},maskData:i.pixels.resultMask};if(i.pixels.resultMask&&s.isValidPixelValue(o.imageType,r)){var y=i.pixels.resultMask;for(n=0;n<u;n++)y[n]||(g.pixelData[n]=r);g.noDataValue=r}return i.noDataValue=r,e.returnFileInfo&&(g.fileInfo=s.formatFileInfo(i)),g}},getBandCount:function(t){for(var e=0,r=0,n={ptr:0,pixels:{}};r<t.byteLength-58;)s.readHeaderInfo(t,n),r+=n.headerInfo.blobSize,e++,n.ptr=r;return e}}}(),c=new ArrayBuffer(4),h=new Uint8Array(c),new Uint32Array(c)[0]=1,d=1===h[0],g={decode:function(t,e){if(!d)throw"Big endian system is not supported.";var r,n,i=(e=e||{}).inputOffset||0,o=new Uint8Array(t,i,10),s=String.fromCharCode.apply(null,o);if("CntZImage"===s.trim())r=f,n=1;else{if("Lerc2"!==s.substring(0,5))throw"Unexpected file identifier string: "+s;r=p,n=2}for(var a,l,u,c,h,g,y=0,m=t.byteLength-10,_=[],v={width:0,height:0,pixels:[],pixelType:e.pixelType,mask:null,statistics:[]},b=0;i<m;){var w=r.decode(t,{inputOffset:i,encodedMaskData:a,maskData:u,returnMask:0===y,returnEncodedMask:0===y,returnFileInfo:!0,returnPixelInterleavedDims:e.returnPixelInterleavedDims,pixelType:e.pixelType||null,noDataValue:e.noDataValue||null});i=w.fileInfo.eofOffset,u=w.maskData,0===y&&(a=w.encodedMaskData,v.width=w.width,v.height=w.height,v.dimCount=w.dimCount||1,v.pixelType=w.pixelType||w.fileInfo.pixelType,v.mask=u),n>1&&(u&&_.push(u),w.fileInfo.mask&&w.fileInfo.mask.numBytes>0&&b++),y++,v.pixels.push(w.pixelData),v.statistics.push({minValue:w.minValue,maxValue:w.maxValue,noDataValue:w.noDataValue,dimStats:w.dimStats})}if(n>1&&b>1){for(g=v.width*v.height,v.bandMasks=_,(u=new Uint8Array(g)).set(_[0]),c=1;c<_.length;c++)for(l=_[c],h=0;h<g;h++)u[h]=u[h]&l[h];v.maskData=u}return v}},void 0===(n=function(){return g}.apply(e,[]))||(t.exports=n)},,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e,r){},,function(t,e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}[].includes||(Array.prototype.includes=function(t){var e=Object(this),r=parseInt(e.length)||0;if(0===r)return!1;var n,i,o=parseInt(arguments[1])||0;for(o>=0?n=o:(n=r+o)<0&&(n=0);n<r;){if(t===(i=e[n])||Object.equals(t,i)||t!=t&&i!=i)return!0;n++}return!1}),[].remove||(Array.prototype.remove=function(t){var e=Object(this),r=parseInt(e.length)||0;if(0===r)return!1;var n,i=parseInt(arguments[1])||0;i>=0?n=i:(n=r+i)<0&&(n=0);for(var o,s=[];n<r;)(t===(o=e[n])||Object.equals(t,o)||t!=t&&o!=o)&&s.push(n),n++;var a=0;s.forEach((function(t){t+=a,e.splice(t,1),a--}))}),Object.equals||(Object.equals=function(t,e){if(null!==t.equals&&"function"==typeof t.equals&&t.equals.call)return t.equals(e);if(null!==e.equals&&"function"==typeof e.equals&&e.equals.call)return e.equals(t);var n,i=[],o=[];if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if("function"==typeof t&&"function"==typeof e||t instanceof Date&&e instanceof Date||t instanceof RegExp&&e instanceof RegExp||t instanceof String&&e instanceof String||t instanceof Number&&e instanceof Number)return t.toString()===e.toString();if(!(t instanceof Object&&e instanceof Object))return!1;if(t.isPrototypeOf(e)||e.isPrototypeOf(t))return!1;if(t.constructor!==e.constructor)return!1;if(t.prototype!==e.prototype)return!1;if(i.indexOf(t)>-1||o.indexOf(e)>-1)return!1;for(n in e){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(r(e[n])!==r(t[n]))return!1}for(n in t){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(r(e[n])!==r(t[n]))return!1;switch(r(t[n])){case"object":case"function":if(i.push(t),o.push(e),!Object.equals(t[n],e[n]))return!1;i.pop(),o.pop();break;default:if(t[n]!==e[n])return!1}}return!0})},function(t,e,r){"use strict";e.byteLength=function(t){var e=u(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,n=u(t),s=n[0],a=n[1],l=new o(function(t,e,r){return 3*(e+r)/4-r}(0,s,a)),c=0,h=a>0?s-4:s;for(r=0;r<h;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],l[c++]=e>>16&255,l[c++]=e>>8&255,l[c++]=255&e;2===a&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,l[c++]=255&e);1===a&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,l[c++]=e>>8&255,l[c++]=255&e);return l},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,l=r-i;a<l;a+=s)o.push(c(t,a,a+s>l?l:a+s));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){t.exports=function(t){function e(t){let r,i,o,s=null;function a(...t){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,i)=>{if("%%"===r)return"%";s++;const o=e.formatters[i];if("function"==typeof o){const e=t[s];r=o.call(n,e),t.splice(s,1),s--}return r}),e.formatArgs.call(n,t);(n.log||e.log).apply(n,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==e.namespaces&&(i=e.namespaces,o=e.enabled(t)),o),set:t=>{s=t}}),"function"==typeof e.init&&e.init(a),a}function n(t,r){const n=e(this.namespace+(void 0===r?":":r)+t);return n.log=this.log,n}function i(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(i),...e.skips.map(i).map(t=>"-"+t)].join(",");return e.enable(""),t},e.enable=function(t){let r;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(102),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{e[r]=t[r]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let r=0;for(let e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return e.colors[Math.abs(r)%e.colors.length]},e.enable(e.load()),e}},function(t,e){var r=1e3,n=60*r,i=60*n,o=24*i,s=7*o,a=365.25*o;function l(t,e,r,n){var i=e>=1.5*r;return Math.round(t/r)+" "+n+(i?"s":"")}t.exports=function(t,e){e=e||{};var u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var l=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*a;case"weeks":case"week":case"w":return l*s;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*i;case"minutes":case"minute":case"mins":case"min":case"m":return l*n;case"seconds":case"second":case"secs":case"sec":case"s":return l*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(t);if("number"===u&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=o)return l(t,e,o,"day");if(e>=i)return l(t,e,i,"hour");if(e>=n)return l(t,e,n,"minute");if(e>=r)return l(t,e,r,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=o)return Math.round(t/o)+"d";if(e>=i)return Math.round(t/i)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=r)return Math.round(t/r)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){const n=r(104);t.exports=function(t,e,r){const i=r&&r.debug||!1,o=r&&r.startIndex||0;i&&console.log("starting findTagByName with",e," and ",r);const s=n(t,`<${e}[ >]`,o);if(i&&console.log("start:",s),-1===s)return;const a=t.slice(s+e.length);let l=n(a,"[ /]"+e+">",0);const u=-1===l;u&&(l=n(a,"[ /]>",0));const c=s+e.length+l+1+(u?0:e.length)+1;if(i&&console.log("end:",c),-1===c)return;const h=t.slice(s,c);let f;return f=u?null:h.slice(h.indexOf(">")+1,h.lastIndexOf("<")),{inner:f,outer:h,start:s,end:c}}},function(t,e){t.exports=function(t,e,r){const n=new RegExp(e).exec(t.slice(r));return n?r+n.index:-1}},function(t,e,r){"use strict";function n(t){var e=this;if(e instanceof n||(e=new n),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}function i(t,e,r){var n=e===t.head?new a(r,null,e,t):new a(r,e,e.next,t);return null===n.next&&(t.tail=n),null===n.prev&&(t.head=n),t.length++,n}function o(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function s(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,r,n){if(!(this instanceof a))return new a(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}t.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e},n.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},n.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},n.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},n.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)s(this,arguments[t]);return this.length},n.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},n.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},n.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;null!==r;n++)t.call(e,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;null!==r;n--)t.call(e,r.value,n,this),r=r.prev},n.prototype.get=function(t){for(var e=0,r=this.head;null!==r&&e<t;e++)r=r.next;if(e===t&&null!==r)return r.value},n.prototype.getReverse=function(t){for(var e=0,r=this.tail;null!==r&&e<t;e++)r=r.prev;if(e===t&&null!==r)return r.value},n.prototype.map=function(t,e){e=e||this;for(var r=new n,i=this.head;null!==i;)r.push(t.call(e,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(t,e){e=e||this;for(var r=new n,i=this.tail;null!==i;)r.push(t.call(e,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=t(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=t(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;null!==r;e++)t[e]=r.value,r=r.next;return t},n.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;null!==r;e++)t[e]=r.value,r=r.prev;return t},n.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,o=this.head;null!==o&&n<t;n++)o=o.next;var s=[];for(n=0;o&&n<e;n++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(n=0;n<r.length;n++)o=i(this,o,r[n]);return s},n.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};try{r(106)(n)}catch(t){}},function(t,e,r){"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},function(t,e,r){
/**
 * JSTS. See https://github.com/bjornharrtell/jsts
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EDLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EPLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_LICENSE_ES6_COLLECTIONS.txt
 * @license
 */
!function(t){"use strict";"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),r=Math.max(Math.min(e.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(r+n,0):Math.min(n,r);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:r;for(i=i<0?Math.max(r+arguments[2],0):Math.min(i,r);n<i;)e[n]=t,++n;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)},Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E};class e{constructor(){e.constructor_.apply(this,arguments)}static equalsWithTolerance(t,e,r){return Math.abs(t-e)<=r}getClass(){return e}get interfaces_(){return[]}}function r(t){this.message=t}function n(t,e){this.low=0|e,this.high=0|t}function i(){}var o,s,a,l,u,c;function h(){}function f(){}function p(){}function d(){}function g(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}e.constructor_=function(){},n.toBinaryString=function(t){for(var e="",r=2147483648;r>0;r>>>=1)e+=(t.high&r)===r?"1":"0";for(r=2147483648;r>0;r>>>=1)e+=(t.low&r)===r?"1":"0";return e},i.isNaN=t=>Number.isNaN(t),i.isInfinite=t=>!Number.isFinite(t),i.MAX_VALUE=Number.MAX_VALUE,"function"==typeof Float64Array&&"function"==typeof Int32Array?(u=new Float64Array(1),c=new Int32Array(u.buffer),i.doubleToLongBits=function(t){u[0]=t;var e=0|c[0],r=0|c[1];return 2146435072==(2146435072&r)&&0!=(1048575&r)&&0!==e&&(e=0,r=2146959360),new n(r,e)},i.longBitsToDouble=function(t){return c[0]=t.low,c[1]=t.high,u[0]}):(o=Math.log2,s=Math.floor,a=Math.pow,l=function(){for(var t=53;t>0;t--){var e=a(2,t)-1;if(s(o(e))+1===t)return e}return 0}(),i.doubleToLongBits=function(t){var e,r,i,u,c,h,f,p,d;if(t<0||1/t===Number.NEGATIVE_INFINITY?(h=1<<31,t=-t):h=0,0===t)return new n(p=h,d=0);if(t===1/0)return new n(p=2146435072|h,d=0);if(t!=t)return new n(p=2146959360,d=0);if(u=0,d=0,(e=s(t))>1)if(e<=l)(u=s(o(e)))<=20?(d=0,p=e<<20-u&1048575):(d=e%(r=a(2,i=u-20))<<32-i,p=e/r&1048575);else for(i=e,d=0;0!==(i=s(r=i/2));)u++,d>>>=1,d|=(1&p)<<31,p>>>=1,r!==i&&(p|=524288);if(f=u+1023,c=0===e,e=t-e,u<52&&0!==e)for(i=0;;){if((r=2*e)>=1?(e=r-1,c?(f--,c=!1):(i<<=1,i|=1,u++)):(e=r,c?0==--f&&(u++,c=!1):(i<<=1,u++)),20===u)p|=i,i=0;else if(52===u){d|=i;break}if(1===r){u<20?p|=i<<20-u:u<52&&(d|=i<<52-u);break}}return p|=f<<20,new n(p|=h,d)},i.longBitsToDouble=function(t){var e,r,n,i,o=t.high,s=t.low;r=o&1<<31?-1:1,n=((2146435072&o)>>20)-1023,i=0,e=1<<19;for(var l=1;l<=20;l++)o&e&&(i+=a(2,-l)),e>>>=1;for(e=1<<31,l=21;l<=52;l++)s&e&&(i+=a(2,-l)),e>>>=1;if(-1023===n){if(0===i)return 0*r;n=-1022}else{if(1024===n)return 0===i?r/0:NaN;i+=1}return r*i*a(2,n)}),g.prototype=Object.create(Error.prototype),g.prototype.constructor=Error;class y extends g{constructor(){super(),y.constructor_.apply(this,arguments)}getClass(){return y}get interfaces_(){return[]}}y.constructor_=function(){if(0===arguments.length)g.constructor_.call(this);else if(1===arguments.length){let t=arguments[0];g.constructor_.call(this,t)}};class m{constructor(){m.constructor_.apply(this,arguments)}static shouldNeverReachHere(){if(0===arguments.length)m.shouldNeverReachHere(null);else if(1===arguments.length){let t=arguments[0];throw new y("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){let t=arguments[0];m.isTrue(t,null)}else if(2===arguments.length){let t=arguments[1];if(!arguments[0])throw null===t?new y:new y(t)}}static equals(){if(2===arguments.length){let t=arguments[0],e=arguments[1];m.equals(t,e,null)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];if(!e.equals(t))throw new y("Expected "+t+" but encountered "+e+(null!==r?": "+r:""))}}getClass(){return m}get interfaces_(){return[]}}m.constructor_=function(){};class _{constructor(){_.constructor_.apply(this,arguments)}static hashCode(){if(1===arguments.length&&"number"==typeof arguments[0]){let e=arguments[0];var t=i.doubleToLongBits(e);return Math.trunc(t^t>>>32)}}setOrdinate(t,e){switch(t){case _.X:this.x=e;break;case _.Y:this.y=e;break;case _.Z:this.z=e;break;default:throw new r("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){let t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){let t=arguments[0],r=arguments[1];return!!e.equalsWithTolerance(this.x,t.x,r)&&!!e.equalsWithTolerance(this.y,t.y,r)}}getOrdinate(t){switch(t){case _.X:return this.x;case _.Y:return this.y;case _.Z:return this.z}throw new r("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||i.isNaN(this.z)&&i.isNaN(t.z))}equals(t){return t instanceof _&&this.equals2D(t)}equalInZ(t,r){return e.equalsWithTolerance(this.z,t.z,r)}compareTo(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return m.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new _(this)}toString(){return"("+this.x+", "+this.y+", "+this.z+")"}distance3D(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+r*r+n*n)}distance(t){var e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}hashCode(){var t=17;return 37*(t=37*t+_.hashCode(this.x))+_.hashCode(this.y)}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.z}getClass(){return _}get interfaces_(){return[h,f,d]}}class v{constructor(){v.constructor_.apply(this,arguments)}static compare(t,e){return t<e?-1:t>e?1:i.isNaN(t)?i.isNaN(e)?0:-1:i.isNaN(e)?1:0}compare(t,e){var r=t,n=e,i=v.compare(r.x,n.x);if(0!==i)return i;var o=v.compare(r.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:v.compare(r.z,n.z)}getClass(){return v}get interfaces_(){return[p]}}function b(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}function w(){}function x(){}function E(t){this.message=t||""}function S(){}function I(t){this.message=t||""}function O(t){this.message=t||""}function C(){this.array_=[],arguments[0]instanceof x&&this.addAll(arguments[0])}v.constructor_=function(){if(this._dimensionsToTest=2,0===arguments.length)v.constructor_.call(this,2);else if(1===arguments.length){let t=arguments[0];if(2!==t&&3!==t)throw new r("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}},_.DimensionalComparator=v,_.constructor_=function(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)_.constructor_.call(this,0,0);else if(1===arguments.length){let t=arguments[0];_.constructor_.call(this,t.x,t.y,t.z)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];_.constructor_.call(this,t,e,_.NULL_ORDINATE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.x=t,this.y=e,this.z=r}},_.serialVersionUID=0x5cbf2c235c7e5800,_.NULL_ORDINATE=i.NaN,_.X=0,_.Y=1,_.Z=2,w.prototype.hasNext=function(){},w.prototype.next=function(){},w.prototype.remove=function(){},x.prototype.add=function(){},x.prototype.addAll=function(){},x.prototype.isEmpty=function(){},x.prototype.iterator=function(){},x.prototype.size=function(){},x.prototype.toArray=function(){},x.prototype.remove=function(){},E.prototype=new Error,E.prototype.name="IndexOutOfBoundsException",S.prototype=Object.create(x.prototype),S.prototype.constructor=S,S.prototype.get=function(){},S.prototype.set=function(){},S.prototype.isEmpty=function(){},I.prototype=new Error,I.prototype.name="NoSuchElementException",O.prototype=new Error,O.prototype.name="OperationNotSupported",C.prototype=Object.create(S.prototype),C.prototype.constructor=C,C.prototype.ensureCapacity=function(){},C.prototype.interfaces_=[S,x],C.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],0,arguments[1]),!0},C.prototype.clear=function(){this.array_=[]},C.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},C.prototype.set=function(t,e){var r=this.array_[t];return this.array_[t]=e,r},C.prototype.iterator=function(){return new T(this)},C.prototype.get=function(t){if(t<0||t>=this.size())throw new E;return this.array_[t]},C.prototype.isEmpty=function(){return 0===this.array_.length},C.prototype.size=function(){return this.array_.length},C.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},C.prototype.remove=function(t){for(var e=!1,r=0,n=this.array_.length;r<n;r++)if(this.array_[r]===t){this.array_.splice(r,1),e=!0;break}return e},C.prototype.removeAll=function(t){for(var e=t.iterator();e.hasNext();)this.remove(e.next());return!0};var T=function(t){this.arrayList_=t,this.position_=0};T.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new I;return this.arrayList_.get(this.position_++)},T.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},T.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},T.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))};class P extends C{constructor(){super(),P.constructor_.apply(this,arguments)}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&b(arguments[0],x)){let r=arguments[1];for(var t=!1,e=arguments[0].iterator();e.hasNext();)this.add(e.next(),r),t=!0;return t}return super.addAll.apply(this,arguments)}clone(){for(var t=super.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){return this.toArray(P.coordArrayType)}add(){if(1===arguments.length){let t=arguments[0];super.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof _&&"boolean"==typeof arguments[1]){let t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let e=arguments[0],r=arguments[1];if(arguments[2])for(var t=0;t<e.length;t++)this.add(e[t],r);else for(t=e.length-1;t>=0;t--)this.add(e[t],r);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof _){let t=arguments[0],r=arguments[1];if(!arguments[2]){var e=this.size();if(e>0){if(t>0&&this.get(t-1).equals2D(r))return null;if(t<e&&this.get(t).equals2D(r))return null}}super.add.call(this,t,r)}}else if(4===arguments.length){let e=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3];var r=1;for(i>o&&(r=-1),t=i;t!==o;t+=r)this.add(e[t],n);return!0}}closeRing(){this.size()>0&&this.add(new _(this.get(0)),!1)}getClass(){return P}get interfaces_(){return[]}}P.constructor_=function(){if(0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}},P.coordArrayType=new Array(0).fill(null);class R{constructor(){R.constructor_.apply(this,arguments)}static intersects(){if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];return r.x>=(t.x<e.x?t.x:e.x)&&r.x<=(t.x>e.x?t.x:e.x)&&r.y>=(t.y<e.y?t.y:e.y)&&r.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){let i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];var t=Math.min(s.x,a.x),e=Math.max(s.x,a.x),r=Math.min(i.x,o.x),n=Math.max(i.x,o.x);return!(r>e||n<t||(t=Math.min(s.y,a.y),e=Math.max(s.y,a.y),r=Math.min(i.y,o.y),n=Math.max(i.y,o.y),r>e||n<t))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof R))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new R;var e=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new R(e,n,r,i)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof _){let t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof R){let t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return!this.isNull()&&t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy}}intersects(){if(1===arguments.length){if(arguments[0]instanceof R){let t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof _){let t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof _&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1];return!(this.isNull()||(t.x<e.x?t.x:e.x)>this._maxx||(t.x>e.x?t.x:e.x)<this._minx||(t.y<e.y?t.y:e.y)>this._maxy||(t.y>e.y?t.y:e.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof _){let t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof R){let t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){let t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof R){let t=arguments[0];return this.covers(t)}if(arguments[0]instanceof _){let t=arguments[0];return this.covers(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new _((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof _){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof R){let t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),r<n?(this._miny=r,this._maxy=n):(this._miny=n,this._maxy=r)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),0===e?r:0===r?e:Math.sqrt(e*e+r*r)}hashCode(){var t=17;return 37*(t=37*(t=37*(t=37*t+_.hashCode(this._minx))+_.hashCode(this._maxx))+_.hashCode(this._miny))+_.hashCode(this._maxy)}getClass(){return R}get interfaces_(){return[h,d]}}function L(){}R.constructor_=function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof _){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof R){let t=arguments[0];this.init(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.init(t,e,r,n)}},R.serialVersionUID=0x51845cd552189800;class M extends L{constructor(){super(),M.constructor_.apply(this,arguments)}getClass(){return M}get interfaces_(){return[]}}function k(t){this.str=t}function N(t){this.value=t}function A(){}M.constructor_=function(){L.constructor_.call(this,"Projective point not representable on the Cartesian plane.")},k.prototype.append=function(t){this.str+=t},k.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},k.prototype.toString=function(t){return this.str},N.prototype.intValue=function(){return this.value},N.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},N.isNaN=t=>Number.isNaN(t),A.isWhitespace=t=>t<=32&&t>=0||127==t,A.toUpperCase=t=>t.toUpperCase();class F{constructor(){F.constructor_.apply(this,arguments)}static sqr(t){return F.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){let t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0])return new F(arguments[0])}static sqrt(t){return F.valueOf(t).sqrt()}static parse(t){for(var e=0,r=t.length;A.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<r){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(n=!0))}for(var o=new F,s=0,a=0,l=0;!(e>=r);){var u=t.charAt(e);if(e++,A.isDigit(u)){var c=u-"0";o.selfMultiply(F.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=N.parseInt(h)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+h+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var f=o,p=s-a-l;if(0===p)f=o;else if(p>0){var d=F.TEN.pow(p);f=o.divide(d)}else p<0&&(d=F.TEN.pow(-p),f=o.multiply(d));return n?f.negate():f}static createNaN(){return new F(i.NaN,i.NaN)}static copy(t){return new F(t)}static magnitude(t){var e=Math.abs(t),r=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(r));return 10*Math.pow(10,n)<=e&&(n+=1),n}static stringOfChar(t,e){for(var r=new k,n=0;n<e;n++)r.append(t);return r.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){var r=this.abs(),n=F.magnitude(r._hi),i=F.TEN.pow(n);(r=r.divide(i)).gt(F.TEN)?(r=r.divide(F.TEN),n+=1):r.lt(F.ONE)&&(r=r.multiply(F.TEN),n-=1);for(var o=n+1,s=new k,a=F.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(r._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),r=r.subtract(F.valueOf(u)).multiply(F.TEN),c&&r.selfAdd(F.TEN);var f=!0,p=F.magnitude(r._hi);if(p<0&&Math.abs(p)>=a-l&&(f=!1),!f)break}return e[0]=n,s.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof F){let t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){let t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof F){let t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof F){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){let l=arguments[0],u=arguments[1];var t,e,r,n,i=null,o=null,s=null,a=null;return r=this._hi/l,a=(i=(s=F.SPLIT*r)-(i=s-r))*(o=(a=F.SPLIT*l)-(o=a-l))-(n=r*l)+i*(e=l-o)+(t=r-i)*o+t*e,a=r+(s=(this._hi-n-a+this._lo-r*u)/l),this._hi=a,this._lo=r-a+s,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof F){let i=arguments[0];var t,e,r,n,o=null,s=null,a=null,l=null;return t=(r=this._hi/i._hi)-(o=(a=F.SPLIT*r)-(o=a-r)),l=o*(s=(l=F.SPLIT*i._hi)-(s=l-i._hi))-(n=r*i._hi)+o*(e=i._hi-s)+t*s+t*e,a=(this._hi-n-l+this._lo-r*i._lo)/i._hi,new F(l=r+a,r-l+a)}if("number"==typeof arguments[0]){let t=arguments[0];return i.isNaN(t)?F.createNaN():F.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return F.valueOf(1);var e=new F(this),r=F.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&r.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else r=e;return t<0?r.reciprocal():r}ceil(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)}compareTo(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof F){let t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){let t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,r=F.valueOf(e),n=this.subtract(r.sqr())._hi*(.5*t);return r.add(n)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){let s=arguments[0];var t=null,e=null,r=null,n=null,i=null,o=null;return n=(r=this._hi+s)-(i=r-this._hi),e=(o=(n=s-i+(this._hi-n))+this._lo)+(r-(t=r+o)),this._hi=t+e,this._lo=e+(t-this._hi),this}}else if(2===arguments.length){let c=arguments[0],h=arguments[1];t=null,e=null;var s,a=null;r=null,n=null,i=null,o=null,r=this._hi+c,s=this._lo+h,n=r-(i=r-this._hi),a=s-(o=s-this._lo);var l=(t=r+(i=(n=c-i+(this._hi-n))+s))+(i=(a=h-o+(this._lo-a))+(e=i+(r-t))),u=i+(t-l);return this._hi=l,this._lo=u,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){let l=arguments[0],u=arguments[1];var t,e,r=null,n=null,i=null,o=null;r=(i=F.SPLIT*this._hi)-this._hi,o=F.SPLIT*l,r=i-r,t=this._hi-r,n=o-l;var s=(i=this._hi*l)+(o=r*(n=o-n)-i+r*(e=l-n)+t*n+t*e+(this._hi*u+this._lo*l)),a=o+(r=i-s);return this._hi=s,this._lo=a,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)}negate(){return this.isNaN()?this:new F(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof F){let t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){let t=arguments[0];return i.isNaN(t)?F.createNaN():F.copy(this).selfMultiply(t,0)}}isNaN(){return i.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!0,e),n=e[0]+1,i=r;if("."===r.charAt(0))i="0"+r;else if(n<0)i="0."+F.stringOfChar("0",-n)+r;else if(-1===r.indexOf(".")){var o=n-r.length;i=r+F.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i}reciprocal(){var t,e,r,n,i=null,o=null,s=null,a=null;t=(r=1/this._hi)-(i=(s=F.SPLIT*r)-(i=s-r)),o=(a=F.SPLIT*this._hi)-this._hi;var l=r+(s=(1-(n=r*this._hi)-(a=i*(o=a-o)-n+i*(e=this._hi-o)+t*o+t*e)-r*this._lo)/this._hi);return new F(l,r-l+s)}toSciNotation(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!1,e),n=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===r.charAt(0))throw new IllegalStateException("Found leading zero: "+r);var i="";r.length>1&&(i=r.substring(1));var o=r.charAt(0)+"."+i;return this.isNegative()?"-"+o+n:o+n}abs(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof F){let t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){let t=arguments[0];return F.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){let t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}getClass(){return F}get interfaces_(){return[d,h,f]}}F.constructor_=function(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this.init(t)}else if(arguments[0]instanceof F){let t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){let t=arguments[0];F.constructor_.call(this,F.parse(t))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t,e)}},F.PI=new F(3.141592653589793,12246467991473532e-32),F.TWO_PI=new F(6.283185307179586,24492935982947064e-32),F.PI_2=new F(1.5707963267948966,6123233995736766e-32),F.E=new F(2.718281828459045,14456468917292502e-32),F.NaN=new F(i.NaN,i.NaN),F.EPS=123259516440783e-46,F.SPLIT=134217729,F.MAX_PRINT_DIGITS=32,F.TEN=F.valueOf(10),F.ONE=F.valueOf(1),F.SCI_NOT_EXPONENT_CHAR="E",F.SCI_NOT_ZERO="0.0E0";class D{constructor(){D.constructor_.apply(this,arguments)}static orientationIndex(t,e,r){var n=D.orientationIndexFilter(t,e,r);if(n<=1)return n;var i=F.valueOf(e.x).selfAdd(-t.x),o=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(r.x).selfAdd(-e.x),a=F.valueOf(r.y).selfAdd(-e.y);return i.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()}static signOfDet2x2(){if(arguments[0]instanceof F){let t=arguments[1],e=arguments[2],r=arguments[3];return arguments[0].multiply(r).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[0]){let i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];var t=F.valueOf(i),e=F.valueOf(o),r=F.valueOf(s),n=F.valueOf(a);return t.multiply(n).selfSubtract(e.multiply(r)).signum()}}static intersection(t,e,r,n){var i=F.valueOf(n.y).selfSubtract(r.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),o=F.valueOf(n.x).selfSubtract(r.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=i.subtract(o),a=F.valueOf(n.x).selfSubtract(r.x).selfMultiply(F.valueOf(t.y).selfSubtract(r.y)),l=F.valueOf(n.y).selfSubtract(r.y).selfMultiply(F.valueOf(t.x).selfSubtract(r.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(r.y)),f=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(r.x)),p=h.subtract(f).selfDivide(s).doubleValue(),d=F.valueOf(r.y).selfAdd(F.valueOf(n.y).selfSubtract(r.y).selfMultiply(p)).doubleValue();return new _(c,d)}static orientationIndexFilter(t,e,r){var n=null,i=(t.x-r.x)*(e.y-r.y),o=(t.y-r.y)*(e.x-r.x),s=i-o;if(i>0){if(o<=0)return D.signum(s);n=i+o}else{if(!(i<0))return D.signum(s);if(o>=0)return D.signum(s);n=-i-o}var a=D.DP_SAFE_EPSILON*n;return s>=a||-s>=a?D.signum(s):2}static signum(t){return t>0?1:t<0?-1:0}getClass(){return D}get interfaces_(){return[]}}D.constructor_=function(){},D.DP_SAFE_EPSILON=1e-15;class j{constructor(){j.constructor_.apply(this,arguments)}static index(t,e,r){return D.orientationIndex(t,e,r)}static isCCW(t){var e=t.length-1;if(e<3)throw new r("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,o=1;o<=e;o++){var s=t[o];s.y>n.y&&(n=s,i=o)}var a=i;do{(a-=1)<0&&(a=e)}while(t[a].equals2D(n)&&a!==i);var l=i;do{l=(l+1)%e}while(t[l].equals2D(n)&&l!==i);var u=t[a],c=t[l];if(u.equals2D(n)||c.equals2D(n)||u.equals2D(c))return!1;var h=j.index(u,n,c);return 0===h?u.x>c.x:h>0}getClass(){return j}get interfaces_(){return[]}}function G(){}j.constructor_=function(){},j.CLOCKWISE=-1,j.RIGHT=j.CLOCKWISE,j.COUNTERCLOCKWISE=1,j.LEFT=j.COUNTERCLOCKWISE,j.COLLINEAR=0,j.STRAIGHT=j.COLLINEAR,G.arraycopy=(t,e,r,n,i)=>{let o=0;for(let s=e;s<e+i;s++)r[n+o]=t[s],o++},G.getProperty=t=>({"line.separator":"\n"}[t]);class z{constructor(){z.constructor_.apply(this,arguments)}static intersection(t,e,r,n){var o=t.y-e.y,s=e.x-t.x,a=t.x*e.y-e.x*t.y,l=r.y-n.y,u=n.x-r.x,c=r.x*n.y-n.x*r.y,h=o*u-l*s,f=(s*c-u*a)/h,p=(l*a-o*c)/h;if(i.isNaN(f)||i.isInfinite(f)||i.isNaN(p)||i.isInfinite(p))throw new M;return new _(f,p)}getY(){var t=this.y/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new M;return t}getX(){var t=this.x/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new M;return t}getCoordinate(){var t=new _;return t.x=this.getX(),t.y=this.getY(),t}getClass(){return z}get interfaces_(){return[]}}z.constructor_=function(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){let t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof z&&arguments[1]instanceof z){let t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof _&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.x=t,this.y=e,this.w=r}else if(4===arguments.length){let s=arguments[0],a=arguments[1],l=arguments[2],u=arguments[3];var t=s.y-a.y,e=a.x-s.x,r=s.x*a.y-a.x*s.y,n=l.y-u.y,i=u.x-l.x,o=l.x*u.y-u.x*l.y;this.x=e*o-i*r,this.y=n*r-t*o,this.w=t*i-n*e}};class U{constructor(){U.constructor_.apply(this,arguments)}static log10(t){var e=Math.log(t);return i.isInfinite(e)||i.isNaN(e)?e:e/U.LOG_10}static min(t,e,r,n){var i=t;return e<i&&(i=e),r<i&&(i=r),n<i&&(i=n),i}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){let e=arguments[1],r=arguments[2];return e>(t=arguments[0])&&(t=e),r>t&&(t=r),t}if(4===arguments.length){let e=arguments[1],r=arguments[2],n=arguments[3];var t;return e>(t=arguments[0])&&(t=e),r>t&&(t=r),n>t&&(t=n),t}}static average(t,e){return(t+e)/2}getClass(){return U}get interfaces_(){return[]}}U.constructor_=function(){},U.LOG_10=Math.log(10);class B{constructor(){B.constructor_.apply(this,arguments)}static segmentToSegment(t,e,r,n){if(t.equals(e))return B.pointToSegment(t,r,n);if(r.equals(n))return B.pointToSegment(n,t,e);var i=!1;if(R.intersects(t,e,r,n)){var o=(e.x-t.x)*(n.y-r.y)-(e.y-t.y)*(n.x-r.x);if(0===o)i=!0;else{var s=(t.y-r.y)*(n.x-r.x)-(t.x-r.x)*(n.y-r.y),a=((t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(i=!0)}}else i=!0;return i?U.min(B.pointToSegment(t,r,n),B.pointToSegment(e,r,n),B.pointToSegment(r,t,e),B.pointToSegment(n,t,e)):0}static pointToSegment(t,e,r){if(e.x===r.x&&e.y===r.y)return t.distance(e);var n=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;if(i<=0)return t.distance(e);if(i>=1)return t.distance(r);var o=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/n;return Math.abs(o)*Math.sqrt(n)}static pointToLinePerpendicular(t,e,r){var n=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),i=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/n;return Math.abs(i)*Math.sqrt(n)}static pointToSegmentString(t,e){if(0===e.length)throw new r("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var o=B.pointToSegment(t,e[i],e[i+1]);o<n&&(n=o)}return n}getClass(){return B}get interfaces_(){return[]}}B.constructor_=function(){};class V{constructor(){V.constructor_.apply(this,arguments)}setOrdinate(t,e,r){}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}getDimension(){}getX(t){}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}getClass(){return V}get interfaces_(){return[f]}}V.constructor_=function(){},V.X=0,V.Y=1,V.Z=2,V.M=3;class q{constructor(){q.constructor_.apply(this,arguments)}create(){1===arguments.length&&(arguments[0]instanceof Array||b(arguments[0],V))}getClass(){return q}get interfaces_(){return[]}}q.constructor_=function(){};class Y{constructor(){Y.constructor_.apply(this,arguments)}filter(t){}getClass(){return Y}get interfaces_(){return[]}}Y.constructor_=function(){};class W{constructor(){W.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===W.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equals(){if(arguments[0]instanceof W){let t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){let e=arguments[0];if(!(e instanceof W))return!1;var t=e;return this.equalsExact(t)}}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(W.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){if(1===arguments.length){let e=arguments[0];var t=e;return this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){let e=arguments[0],r=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,r)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}checkNotGeometryCollection(t){if(t.getTypeCode()===W.TYPECODE_GEOMETRYCOLLECTION)throw new r("This method does not support GeometryCollection arguments")}equal(t,e,r){return 0===r?t.equals(e):t.distance(e)<=r}norm(){var t=this.copy();return t.normalize(),t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new R(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){for(var r=t.iterator(),n=e.iterator();r.hasNext()&&n.hasNext();){var i=r.next(),o=n.next(),s=i.compareTo(o);if(0!==s)return s}return r.hasNext()?1:n.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isGeometryCollectionOrDerived(){return this.getTypeCode()===W.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===W.TYPECODE_MULTIPOINT||this.getTypeCode()===W.TYPECODE_MULTILINESTRING||this.getTypeCode()===W.TYPECODE_MULTIPOLYGON}get interfaces_(){return[f,h,d]}getClass(){return W}static hasNonEmptyElements(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}W.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},W.serialVersionUID=0x799ea46522854c00,W.TYPECODE_POINT=0,W.TYPECODE_MULTIPOINT=1,W.TYPECODE_LINESTRING=2,W.TYPECODE_LINEARRING=3,W.TYPECODE_MULTILINESTRING=4,W.TYPECODE_POLYGON=5,W.TYPECODE_MULTIPOLYGON=6,W.TYPECODE_GEOMETRYCOLLECTION=7,W.TYPENAME_POINT="Point",W.TYPENAME_MULTIPOINT="MultiPoint",W.TYPENAME_LINESTRING="LineString",W.TYPENAME_LINEARRING="LinearRing",W.TYPENAME_MULTILINESTRING="MultiLineString",W.TYPENAME_POLYGON="Polygon",W.TYPENAME_MULTIPOLYGON="MultiPolygon",W.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",W.geometryChangedFilter={get interfaces_(){return[Y]},filter(t){t.geometryChangedAction()}};class X{constructor(){X.constructor_.apply(this,arguments)}filter(t){}getClass(){return X}get interfaces_(){return[]}}X.constructor_=function(){};class H{constructor(){H.constructor_.apply(this,arguments)}isInBoundary(t){}getClass(){return H}get interfaces_(){return[]}}class Z{constructor(){Z.constructor_.apply(this,arguments)}isInBoundary(t){return t%2==1}getClass(){return Z}get interfaces_(){return[H]}}Z.constructor_=function(){};class K{constructor(){K.constructor_.apply(this,arguments)}isInBoundary(t){return t>0}getClass(){return K}get interfaces_(){return[H]}}K.constructor_=function(){};class ${constructor(){$.constructor_.apply(this,arguments)}isInBoundary(t){return t>1}getClass(){return $}get interfaces_(){return[H]}}$.constructor_=function(){};class J{constructor(){J.constructor_.apply(this,arguments)}isInBoundary(t){return 1===t}getClass(){return J}get interfaces_(){return[H]}}J.constructor_=function(){},H.Mod2BoundaryNodeRule=Z,H.EndPointBoundaryNodeRule=K,H.MultiValentEndPointBoundaryNodeRule=$,H.MonoValentEndPointBoundaryNodeRule=J,H.constructor_=function(){},H.MOD2_BOUNDARY_RULE=new Z,H.ENDPOINT_BOUNDARY_RULE=new K,H.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new $,H.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new J,H.OGC_SFS_BOUNDARY_RULE=H.MOD2_BOUNDARY_RULE;class Q{constructor(){Q.constructor_.apply(this,arguments)}static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(Q.indexOf(n,e)<0)return n}return null}static scroll(t,e){var r=Q.indexOf(e,t);if(r<0)return null;var n=new Array(t.length).fill(null);G.arraycopy(t,r,n,0,t.length-r),G.arraycopy(t,0,n,t.length-r,r),G.arraycopy(n,0,t,0,t.length)}static equals(){if(2===arguments.length){let e=arguments[0],r=arguments[1];if(e===r)return!0;if(null===e||null===r)return!1;if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(!e[t].equals(r[t]))return!1;return!0}if(3===arguments.length){let e=arguments[0],r=arguments[1],n=arguments[2];if(e===r)return!0;if(null===e||null===r)return!1;if(e.length!==r.length)return!1;for(t=0;t<e.length;t++)if(0!==n.compare(e[t],r[t]))return!1;return!0}}static intersection(t,e){for(var r=new P,n=0;n<t.length;n++)e.intersects(t[n])&&r.add(t[n],!0);return r.toCoordinateArray()}static hasRepeatedPoints(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){return Q.hasRepeatedPoints(t)?new P(t,!1).toCoordinateArray():t}static reverse(t){for(var e=t.length-1,r=Math.trunc(e/2),n=0;n<=r;n++){var i=t[n];t[n]=t[e-n],t[e-n]=i}}static removeNull(t){for(var e=0,r=0;r<t.length;r++)null!==t[r]&&e++;var n=new Array(e).fill(null);if(0===e)return n;var i=0;for(r=0;r<t.length;r++)null!==t[r]&&(n[i++]=t[r]);return n}static copyDeep(){if(1===arguments.length){let r=arguments[0];for(var t=new Array(r.length).fill(null),e=0;e<r.length;e++)t[e]=new _(r[e]);return t}if(5===arguments.length){let t=arguments[0],r=arguments[1],n=arguments[2],i=arguments[3],o=arguments[4];for(e=0;e<o;e++)n[i+e]=new _(t[r+e])}}static isEqualReversed(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=e[t.length-r-1];if(0!==n.compareTo(i))return!1}return!0}static envelope(t){for(var e=new R,r=0;r<t.length;r++)e.expandToInclude(t[r]);return e}static toCoordinateArray(t){return t.toArray(Q.coordArrayType)}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(var r=0;r<e.length;r++)if(t.equals(e[r]))return r;return-1}static increasingDirection(t){for(var e=0;e<Math.trunc(t.length/2);e++){var r=t.length-1-e,n=t[e].compareTo(t[r]);if(0!==n)return n}return 1}static compare(t,e){for(var r=0;r<t.length&&r<e.length;){var n=t[r].compareTo(e[r]);if(0!==n)return n;r++}return r<e.length?-1:r<t.length?1:0}static minCoordinate(t){for(var e=null,r=0;r<t.length;r++)(null===e||e.compareTo(t[r])>0)&&(e=t[r]);return e}static extract(t,e,r){e=U.clamp(e,0,t.length);var n=(r=U.clamp(r,-1,t.length))-e+1;r<0&&(n=0),e>=t.length&&(n=0),r<e&&(n=0);var i=new Array(n).fill(null);if(0===n)return i;for(var o=0,s=e;s<=r;s++)i[o++]=t[s];return i}getClass(){return Q}get interfaces_(){return[]}}class tt{constructor(){tt.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e;return Q.compare(r,n)}getClass(){return tt}get interfaces_(){return[p]}}tt.constructor_=function(){};class et{constructor(){et.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;var i=Q.compare(r,n);return Q.isEqualReversed(r,n)?0:i}OLDcompare(t,e){var r=t,n=e;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;for(var i=Q.increasingDirection(r),o=Q.increasingDirection(n),s=i>0?0:r.length-1,a=o>0?0:r.length-1,l=0;l<r.length;l++){var u=r[s].compareTo(n[a]);if(0!==u)return u;s+=i,a+=o}return 0}getClass(){return et}get interfaces_(){return[p]}}function rt(){}function nt(){}function it(){}function ot(){this.array_=[],arguments[0]instanceof x&&this.addAll(arguments[0])}et.constructor_=function(){},Q.ForwardComparator=tt,Q.BidirectionalComparator=et,Q.constructor_=function(){},Q.coordArrayType=new Array(0).fill(null),rt.prototype.get=function(){},rt.prototype.put=function(){},rt.prototype.size=function(){},rt.prototype.values=function(){},rt.prototype.entrySet=function(){},nt.prototype=new rt,it.prototype=new x,it.prototype.contains=function(){},ot.prototype=new it,ot.prototype.contains=function(t){for(var e=0,r=this.array_.length;e<r;e++)if(this.array_[e]===t)return!0;return!1},ot.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},ot.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},ot.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},ot.prototype.size=function(){return this.array_.length},ot.prototype.isEmpty=function(){return 0===this.array_.length},ot.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},ot.prototype.iterator=function(){return new st(this)};var st=function(t){this.hashSet_=t,this.position_=0};st.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new I;return this.hashSet_.array_[this.position_++]},st.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},st.prototype.remove=function(){throw new O};const at=0;function lt(t){return null==t?at:t.color}function ut(t){return null==t?null:t.parent}function ct(t,e){null!==t&&(t.color=e)}function ht(t){return null==t?null:t.left}function ft(t){return null==t?null:t.right}function pt(){this.root_=null,this.size_=0}pt.prototype=new nt,pt.prototype.get=function(t){for(var e=this.root_;null!==e;){var r=t.compareTo(e.key);if(r<0)e=e.left;else{if(!(r>0))return e.value;e=e.right}}return null},pt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:at,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;var r,n,i=this.root_;do{if(r=i,(n=t.compareTo(i.key))<0)i=i.left;else{if(!(n>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var s={key:t,left:null,right:null,value:e,parent:r,color:at,getValue(){return this.value},getKey(){return this.key}};return n<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null},pt.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;){var e;ut(t)==ht(ut(ut(t)))?1==lt(e=ft(ut(ut(t))))?(ct(ut(t),at),ct(e,at),ct(ut(ut(t)),1),t=ut(ut(t))):(t==ft(ut(t))&&(t=ut(t),this.rotateLeft(t)),ct(ut(t),at),ct(ut(ut(t)),1),this.rotateRight(ut(ut(t)))):1==lt(e=ht(ut(ut(t))))?(ct(ut(t),at),ct(e,at),ct(ut(ut(t)),1),t=ut(ut(t))):(t==ht(ut(t))&&(t=ut(t),this.rotateRight(t)),ct(ut(t),at),ct(ut(ut(t)),1),this.rotateLeft(ut(ut(t))))}this.root_.color=at},pt.prototype.values=function(){var t=new C,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=pt.successor(e));)t.add(e.value);return t},pt.prototype.entrySet=function(){var t=new ot,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=pt.successor(e));)t.add(e);return t},pt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},pt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},pt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},pt.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var r=t;null!==e&&r===e.right;)r=e,e=e.parent;return e},pt.prototype.size=function(){return this.size_},pt.prototype.containsKey=function(t){for(var e=this.root_;null!==e;){var r=t.compareTo(e.key);if(r<0)e=e.left;else{if(!(r>0))return!0;e=e.right}}return!1};class dt{constructor(){dt.constructor_.apply(this,arguments)}getClass(){return dt}get interfaces_(){return[]}}function gt(){}function yt(){this.array_=[],arguments[0]instanceof x&&this.addAll(arguments[0])}dt.constructor_=function(){},gt.prototype=new it,yt.prototype=new gt,yt.prototype.contains=function(t){for(var e=0,r=this.array_.length;e<r;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},yt.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,r=this.array_.length;e<r;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},yt.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},yt.prototype.remove=function(t){throw new O},yt.prototype.size=function(){return this.array_.length},yt.prototype.isEmpty=function(){return 0===this.array_.length},yt.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},yt.prototype.iterator=function(){return new _t(this)};var mt,_t=function(t){this.treeSet_=t,this.position_=0};function vt(){}_t.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new I;return this.treeSet_.array_[this.position_++]},_t.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},_t.prototype.remove=function(){throw new O},vt.sort=function(){var t,e,r,n,i=arguments[0];if(1===arguments.length)return n=function(t,e){return t.compareTo(e)},void i.sort(n);if(2===arguments.length)r=arguments[1],n=function(t,e){return r.compare(t,e)},i.sort(n);else{if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}if(4===arguments.length){for(e=i.slice(arguments[1],arguments[2]),r=arguments[3],n=function(t,e){return r.compare(t,e)},e.sort(n),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}}},vt.asList=function(t){for(var e=new C,r=0,n=t.length;r<n;r++)e.add(t[r]);return e};class bt{constructor(){bt.constructor_.apply(this,arguments)}static toDimensionSymbol(t){switch(t){case bt.FALSE:return bt.SYM_FALSE;case bt.TRUE:return bt.SYM_TRUE;case bt.DONTCARE:return bt.SYM_DONTCARE;case bt.P:return bt.SYM_P;case bt.L:return bt.SYM_L;case bt.A:return bt.SYM_A}throw new r("Unknown dimension value: "+t)}static toDimensionValue(t){switch(A.toUpperCase(t)){case bt.SYM_FALSE:return bt.FALSE;case bt.SYM_TRUE:return bt.TRUE;case bt.SYM_DONTCARE:return bt.DONTCARE;case bt.SYM_P:return bt.P;case bt.SYM_L:return bt.L;case bt.SYM_A:return bt.A}throw new r("Unknown dimension symbol: "+t)}getClass(){return bt}get interfaces_(){return[]}}bt.constructor_=function(){},bt.P=0,bt.L=1,bt.A=2,bt.FALSE=-1,bt.TRUE=-2,bt.DONTCARE=-3,bt.SYM_FALSE="F",bt.SYM_TRUE="T",bt.SYM_DONTCARE="*",bt.SYM_P="0",bt.SYM_L="1",bt.SYM_A="2";class wt{constructor(){wt.constructor_.apply(this,arguments)}filter(t){}getClass(){return wt}get interfaces_(){return[]}}wt.constructor_=function(){};class xt{constructor(){xt.constructor_.apply(this,arguments)}filter(t,e){}isDone(){}isGeometryChanged(){}getClass(){return xt}get interfaces_(){return[]}}xt.constructor_=function(){};class Et extends W{constructor(){super(),Et.constructor_.apply(this,arguments)}computeEnvelopeInternal(){for(var t=new R,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,r=0;r<this._geometries.length;r++)for(var n=this._geometries[r].getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];return t}getArea(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let r=arguments[0],n=arguments[1];if(!this.isEquivalentClass(r))return!1;var t=r;if(this._geometries.length!==t._geometries.length)return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].equalsExact(t._geometries[e],n))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();vt.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){for(var t=bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}getTypeCode(){return W.TYPECODE_GEOMETRYCOLLECTION}getDimension(){for(var t=bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[r]=this._geometries[r].reverse();return this.getFactory().createGeometryCollection(e)}compareToSameClass(){if(1===arguments.length){let r=arguments[0];var t=new yt(vt.asList(this._geometries)),e=new yt(vt.asList(r._geometries));return this.compare(t,e)}if(2===arguments.length){let t=arguments[1];for(var r=arguments[0],n=this.getNumGeometries(),i=r.getNumGeometries(),o=0;o<n&&o<i;){var s=this.getGeometryN(o),a=r.getGeometryN(o),l=s.compareToSameClass(a,t);if(0!==l)return l;o++}return o<n?1:o<i?-1:0}}apply(){if(b(arguments[0],X)){let e=arguments[0];for(var t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(b(arguments[0],xt)){let e=arguments[0];if(0===this._geometries.length)return null;for(t=0;t<this._geometries.length&&(this._geometries[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],wt)){let e=arguments[0];for(e.filter(this),t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(b(arguments[0],Y)){let e=arguments[0];for(e.filter(this),t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}}getBoundary(){return this.checkNotGeometryCollection(this),m.shouldNeverReachHere(),null}getGeometryType(){return W.TYPENAME_GEOMETRYCOLLECTION}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Et(t,this._factory)}isEmpty(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}getClass(){return Et}get interfaces_(){return[]}}Et.constructor_=function(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(W.constructor_.call(this,e),null===t&&(t=[]),W.hasNullElements(t))throw new r("geometries must not contain null elements");this._geometries=t}},Et.serialVersionUID=-0x4f07bcb1f857d800;class St extends Et{constructor(){super(),St.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?bt.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return W.TYPECODE_MULTILINESTRING}getDimension(){return 1}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[t-1-r]=this._geometries[r].reverse();return this.getFactory().createMultiLineString(e)}getBoundary(){return new It(this).getBoundary()}getGeometryType(){return W.TYPENAME_MULTILINESTRING}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new St(t,this._factory)}getClass(){return St}get interfaces_(){return[dt]}}St.constructor_=function(){let t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},St.serialVersionUID=0x7155d2ab4afa8000;class It{constructor(){It.constructor_.apply(this,arguments)}static getBoundary(){return 1===arguments.length?new It(arguments[0]).getBoundary():2===arguments.length?new It(arguments[0],arguments[1]).getBoundary():void 0}boundaryMultiLineString(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)}getBoundary(){return this._geom instanceof Ft?this.boundaryLineString(this._geom):this._geom instanceof St?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(t){var e=new C;this._endpointMap=new pt;for(var r=0;r<t.getNumGeometries();r++){var n=t.getGeometryN(r);0!==n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Q.toCoordinateArray(e)}addEndpoint(t){var e=this._endpointMap.get(t);null===e&&(e=new Ot,this._endpointMap.put(t,e)),e.count++}getClass(){return It}get interfaces_(){return[]}}It.constructor_=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){let t=arguments[0];It.constructor_.call(this,t,H.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}};class Ot{constructor(){Ot.constructor_.apply(this,arguments)}getClass(){return Ot}get interfaces_(){return[]}}Ot.constructor_=function(){this.count=null};class Ct{constructor(){Ct.constructor_.apply(this,arguments)}static ofLine(t){var e=t.size();if(e<=1)return 0;var r=0,n=new _;t.getCoordinate(0,n);for(var i=n.x,o=n.y,s=1;s<e;s++){t.getCoordinate(s,n);var a=n.x,l=n.y,u=a-i,c=l-o;r+=Math.sqrt(u*u+c*c),i=a,o=l}return r}getClass(){return Ct}get interfaces_(){return[]}}function Tt(){}function Pt(){}function Rt(){}function Lt(){}function Mt(){}Ct.constructor_=function(){};class kt{constructor(){kt.constructor_.apply(this,arguments)}static chars(t,e){for(var r=new Array(e).fill(null),n=0;n<e;n++)r[n]=t;return new String(r)}static getStackTrace(){if(1===arguments.length){let r=arguments[0];var t=new Rt,e=new Tt(t);return r.printStackTrace(e),t.toString()}if(2===arguments.length){let e=arguments[0],o=arguments[1];for(var r="",n=new Mt(new Pt(kt.getStackTrace(e))),i=0;i<o;i++)try{r+=n.readLine()+kt.NEWLINE}catch(t){if(!(t instanceof Lt))throw t;m.shouldNeverReachHere()}return r}}static split(t,e){for(var r=e.length,n=new C,i=""+t,o=i.indexOf(e);o>=0;){var s=i.substring(0,o);n.add(s),o=(i=i.substring(o+r)).indexOf(e)}i.length>0&&n.add(i);for(var a=new Array(n.size()).fill(null),l=0;l<a.length;l++)a[l]=n.get(l);return a}static toString(){if(1===arguments.length&&"number"==typeof arguments[0]){let t=arguments[0];return kt.SIMPLE_ORDINATE_FORMAT.format(t)}}static spaces(t){return kt.chars(" ",t)}getClass(){return kt}get interfaces_(){return[]}}function Nt(t){this.str=t}kt.constructor_=function(){},kt.NEWLINE=G.getProperty("line.separator"),kt.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),Nt.prototype.append=function(t){this.str+=t},Nt.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},Nt.prototype.toString=function(t){return this.str};class At{constructor(){At.constructor_.apply(this,arguments)}static copyCoord(t,e,r,n){for(var i=Math.min(t.getDimension(),r.getDimension()),o=0;o<i;o++)r.setOrdinate(n,o,t.getOrdinate(e,o))}static isRing(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,V.X)===t.getOrdinate(e-1,V.X)&&t.getOrdinate(0,V.Y)===t.getOrdinate(e-1,V.Y)}static isEqual(t,e){var r=t.size();if(r!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),o=0;o<r;o++)for(var s=0;s<n;s++){var a=t.getOrdinate(o,s),l=e.getOrdinate(o,s);if(!(t.getOrdinate(o,s)===e.getOrdinate(o,s)||i.isNaN(a)&&i.isNaN(l)))return!1}return!0}static extend(t,e,r){var n=t.create(r,e.getDimension()),i=e.size();if(At.copy(e,0,n,0,i),i>0)for(var o=i;o<r;o++)At.copy(e,i-1,n,o,1);return n}static reverse(t){for(var e=t.size()-1,r=Math.trunc(e/2),n=0;n<=r;n++)At.swap(t,n,e-n)}static swap(t,e,r){if(e===r)return null;for(var n=0;n<t.getDimension();n++){var i=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(r,n)),t.setOrdinate(r,n,i)}}static copy(t,e,r,n,i){for(var o=0;o<i;o++)At.copyCoord(t,e+o,r,n+o)}static toString(){if(1===arguments.length&&b(arguments[0],V)){let o=arguments[0];var t=o.size();if(0===t)return"()";var e=o.getDimension(),r=new Nt;r.append("(");for(var n=0;n<t;n++){n>0&&r.append(" ");for(var i=0;i<e;i++)i>0&&r.append(","),r.append(kt.toString(o.getOrdinate(n,i)))}return r.append(")"),r.toString()}}static ensureValidRing(t,e){var r=e.size();return 0===r?e:r<=3?At.createClosedRing(t,e,4):e.getOrdinate(0,V.X)===e.getOrdinate(r-1,V.X)&&e.getOrdinate(0,V.Y)===e.getOrdinate(r-1,V.Y)?e:At.createClosedRing(t,e,r+1)}static createClosedRing(t,e,r){var n=t.create(r,e.getDimension()),i=e.size();At.copy(e,0,n,0,i);for(var o=i;o<r;o++)At.copy(e,0,n,o,1);return n}getClass(){return At}get interfaces_(){return[]}}At.constructor_=function(){};class Ft extends W{constructor(){super(),Ft.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this.isEmpty()?new R:this._points.expandEnvelope(new R)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let r=arguments[0],n=arguments[1];if(!this.isEquivalentClass(r))return!1;var t=r;if(this._points.size()!==t._points.size())return!1;for(var e=0;e<this._points.size();e++)if(!this.equal(this._points.getCoordinate(e),t._points.getCoordinate(e),n))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){var r=this._points.copy();At.reverse(r),this._points=r}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?bt.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return W.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return Ct.ofLine(this._points)}getNumPoints(){return this._points.size()}reverse(){var t=this._points.copy();return At.reverse(t),this.getFactory().createLineString(t)}compareToSameClass(){if(1===arguments.length){for(var t=arguments[0],e=0,r=0;e<this._points.size()&&r<t._points.size();){var n=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(r));if(0!==n)return n;e++,r++}return e<this._points.size()?1:r<t._points.size()?-1:0}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this._points,t._points)}apply(){if(b(arguments[0],X)){let e=arguments[0];for(var t=0;t<this._points.size();t++)e.filter(this._points.getCoordinate(t))}else if(b(arguments[0],xt)){let e=arguments[0];if(0===this._points.size())return null;for(t=0;t<this._points.size()&&(e.filter(this._points,t),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else(b(arguments[0],wt)||b(arguments[0],Y))&&arguments[0].filter(this)}getBoundary(){return new It(this).getBoundary()}isEquivalentClass(t){return t instanceof Ft}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return W.TYPENAME_LINESTRING}copy(){return new Ft(this._points.copy(),this._factory)}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new r("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}getClass(){return Ft}get interfaces_(){return[dt]}}Ft.constructor_=function(){if(this._points=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];W.constructor_.call(this,e),this.init(t)}},Ft.serialVersionUID=0x2b2b51ba435c8e00;class Dt{constructor(){Dt.constructor_.apply(this,arguments)}getClass(){return Dt}get interfaces_(){return[]}}Dt.constructor_=function(){};class jt extends W{constructor(){super(),jt.constructor_.apply(this,arguments)}computeEnvelopeInternal(){if(this.isEmpty())return new R;var t=new R;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return bt.FALSE}getTypeCode(){return W.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}reverse(){return this.copy()}getX(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this._coordinates,t._coordinates)}apply(){if(b(arguments[0],X)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(b(arguments[0],xt)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else(b(arguments[0],wt)||b(arguments[0],Y))&&arguments[0].filter(this)}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return W.TYPENAME_POINT}copy(){return new jt(this._coordinates.copy(),this._factory)}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),m.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}getClass(){return jt}get interfaces_(){return[Dt]}}jt.constructor_=function(){this._coordinates=null;let t=arguments[0],e=arguments[1];W.constructor_.call(this,e),this.init(t)},jt.serialVersionUID=0x44077bad161cbc00;class Gt{constructor(){Gt.constructor_.apply(this,arguments)}static ofRing(){if(arguments[0]instanceof Array){let t=arguments[0];return Math.abs(Gt.ofRingSigned(t))}if(b(arguments[0],V)){let t=arguments[0];return Math.abs(Gt.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){let o=arguments[0];if(o.length<3)return 0;for(var t=0,e=o[0].x,r=1;r<o.length-1;r++){var n=o[r].x-e,i=o[r+1].y;t+=n*(o[r-1].y-i)}return t/2}if(b(arguments[0],V)){let n=arguments[0];var o=n.size();if(o<3)return 0;var s=new _,a=new _,l=new _;for(n.getCoordinate(0,a),n.getCoordinate(1,l),e=a.x,l.x-=e,t=0,r=1;r<o-1;r++)s.y=a.y,a.x=l.x,a.y=l.y,n.getCoordinate(r+1,l),l.x-=e,t+=a.x*(s.y-l.y);return t/2}}getClass(){return Gt}get interfaces_(){return[]}}Gt.constructor_=function(){};class zt{constructor(){zt.constructor_.apply(this,arguments)}getClass(){return zt}get interfaces_(){return[]}}zt.constructor_=function(){};class Ut extends W{constructor(){super(),Ut.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,r=this._shell.getCoordinates(),n=0;n<r.length;n++)t[++e]=r[n];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t}getArea(){var t=0;t+=Gt.ofRing(this._shell.getCoordinateSequence());for(var e=0;e<this._holes.length;e++)t-=Gt.ofRing(this._holes[e].getCoordinateSequence());return t}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),r=0;r<5;r++){if((o=t.getX(r))!==e.getMinX()&&o!==e.getMaxX())return!1;if((s=t.getY(r))!==e.getMinY()&&s!==e.getMaxY())return!1}var n=t.getX(0),i=t.getY(0);for(r=1;r<=4;r++){var o,s;if((o=t.getX(r))!==n==((s=t.getY(r))!==i))return!1;n=o,i=s}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let i=arguments[0],o=arguments[1];if(!this.isEquivalentClass(i))return!1;var t=i,e=this._shell,r=t._shell;if(!e.equalsExact(r,o))return!1;if(this._holes.length!==t._holes.length)return!1;for(var n=0;n<this._holes.length;n++)if(!this._holes[n].equalsExact(t._holes[n],o))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);vt.sort(this._holes)}else if(2===arguments.length){let t=arguments[0],n=arguments[1];if(t.isEmpty())return null;var e=new Array(t.getCoordinates().length-1).fill(null);G.arraycopy(t.getCoordinates(),0,e,0,e.length);var r=Q.minCoordinate(t.getCoordinates());Q.scroll(e,r),G.arraycopy(e,0,t.getCoordinates(),0,e.length),t.getCoordinates()[e.length]=e[0],j.isCCW(t.getCoordinates())===n&&Q.reverse(t.getCoordinates())}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getTypeCode(){return W.TYPECODE_POLYGON}getDimension(){return 2}getLength(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}reverse(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t}convexHull(){return this.getExteriorRing().convexHull()}compareToSameClass(){if(1===arguments.length){let r=arguments[0];var t=this._shell,e=r._shell;return t.compareToSameClass(e)}if(2===arguments.length){let c=arguments[1];var r=arguments[0],n=(t=this._shell,e=r._shell,t.compareToSameClass(e,c));if(0!==n)return n;for(var i=this.getNumInteriorRing(),o=r.getNumInteriorRing(),s=0;s<i&&s<o;){var a=this.getInteriorRingN(s),l=r.getInteriorRingN(s),u=a.compareToSameClass(l,c);if(0!==u)return u;s++}return s<i?1:s<o?-1:0}}apply(){if(b(arguments[0],X)){let e=arguments[0];this._shell.apply(e);for(var t=0;t<this._holes.length;t++)this._holes[t].apply(e)}else if(b(arguments[0],xt)){let e=arguments[0];if(this._shell.apply(e),!e.isDone())for(t=0;t<this._holes.length&&(this._holes[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],wt))arguments[0].filter(this);else if(b(arguments[0],Y)){let e=arguments[0];for(e.filter(this),this._shell.apply(e),t=0;t<this._holes.length;t++)this._holes[t].apply(e)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return W.TYPENAME_POLYGON}copy(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),r=0;r<this._holes.length;r++)e[r]=this._holes[r].copy();return new Ut(t,e,this._factory)}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}getClass(){return Ut}get interfaces_(){return[zt]}}Ut.constructor_=function(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],n=arguments[2];if(W.constructor_.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),W.hasNullElements(e))throw new r("holes must not contain null elements");if(t.isEmpty()&&W.hasNonEmptyElements(e))throw new r("shell is empty but holes are not");this._shell=t,this._holes=e},Ut.serialVersionUID=-0x307ffefd8dc97200;class Bt extends Et{constructor(){super(),Bt.constructor_.apply(this,arguments)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){let t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return bt.FALSE}getTypeCode(){return W.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return W.TYPENAME_MULTIPOINT}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Bt(t,this._factory)}getClass(){return Bt}get interfaces_(){return[Dt]}}Bt.constructor_=function(){let t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},Bt.serialVersionUID=-0x6fb1ed4162e0fc00;class Vt extends Ft{constructor(){super(),Vt.constructor_.apply(this,arguments)}getBoundaryDimension(){return bt.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}getTypeCode(){return W.TYPECODE_LINEARRING}reverse(){var t=this._points.copy();return At.reverse(t),this.getFactory().createLinearRing(t)}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new r("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Vt.MINIMUM_VALID_SIZE)throw new r("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return W.TYPENAME_LINEARRING}copy(){return new Vt(this._points.copy(),this._factory)}getClass(){return Vt}get interfaces_(){return[]}}Vt.constructor_=function(){if(arguments[0]instanceof Array&&arguments[1]instanceof se){let t=arguments[0],e=arguments[1];Vt.constructor_.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(b(arguments[0],V)&&arguments[1]instanceof se){let t=arguments[0],e=arguments[1];Ft.constructor_.call(this,t,e),this.validateConstruction()}},Vt.MINIMUM_VALID_SIZE=4,Vt.serialVersionUID=-0x3b229e262367a600;class qt extends Et{constructor(){super(),qt.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return W.TYPECODE_MULTIPOLYGON}getDimension(){return 2}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[r]=this._geometries[r].reverse();return this.getFactory().createMultiPolygon(e)}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new C,e=0;e<this._geometries.length;e++)for(var r=this._geometries[e].getBoundary(),n=0;n<r.getNumGeometries();n++)t.add(r.getGeometryN(n));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))}getGeometryType(){return W.TYPENAME_MULTIPOLYGON}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new qt(t,this._factory)}getClass(){return qt}get interfaces_(){return[zt]}}qt.constructor_=function(){let t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},qt.serialVersionUID=-0x7a5aa1369171980;class Yt{constructor(){Yt.constructor_.apply(this,arguments)}setCopyUserData(t){this._isUserDataCopied=t}edit(t,e){if(null===t)return null;var r=this.editInternal(t,e);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r}editInternal(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Et?this.editGeometryCollection(t,e):t instanceof Ut?this.editPolygon(t,e):t instanceof jt||t instanceof Ft?e.edit(t,this._factory):(m.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)}editGeometryCollection(t,e){for(var r=e.edit(t,this._factory),n=new C,i=0;i<r.getNumGeometries();i++){var o=this.edit(r.getGeometryN(i),e);null===o||o.isEmpty()||n.add(o)}return r.getClass()===Bt?this._factory.createMultiPoint(n.toArray([])):r.getClass()===St?this._factory.createMultiLineString(n.toArray([])):r.getClass()===qt?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))}editPolygon(t,e){var r=e.edit(t,this._factory);if(null===r&&(r=this._factory.createPolygon()),r.isEmpty())return r;var n=this.edit(r.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var i=new C,o=0;o<r.getNumInteriorRing();o++){var s=this.edit(r.getInteriorRingN(o),e);null===s||s.isEmpty()||i.add(s)}return this._factory.createPolygon(n,i.toArray([]))}getClass(){return Yt}get interfaces_(){return[]}}function Wt(){}Yt.GeometryEditorOperation=Wt;class Xt{constructor(){Xt.constructor_.apply(this,arguments)}edit(t,e){return t}getClass(){return Xt}get interfaces_(){return[Wt]}}Xt.constructor_=function(){};class Ht{constructor(){Ht.constructor_.apply(this,arguments)}edit(t,e){var r=this.edit(t.getCoordinates(),t);return t instanceof Vt?null===r?e.createLinearRing():e.createLinearRing(r):t instanceof Ft?null===r?e.createLineString():e.createLineString(r):t instanceof jt?null===r||0===r.length?e.createPoint():e.createPoint(r[0]):t}getClass(){return Ht}get interfaces_(){return[Wt]}}Ht.constructor_=function(){};class Zt{constructor(){Zt.constructor_.apply(this,arguments)}edit(t,e){return t instanceof Vt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Ft?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof jt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t}getClass(){return Zt}get interfaces_(){return[Wt]}}Zt.constructor_=function(){},Yt.NoOpGeometryOperation=Xt,Yt.CoordinateOperation=Ht,Yt.CoordinateSequenceOperation=Zt,Yt.constructor_=function(){if(this._factory=null,this._isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._factory=t}};class Kt{constructor(){Kt.constructor_.apply(this,arguments)}setOrdinate(t,e,n){switch(e){case V.X:this._coordinates[t].x=n;break;case V.Y:this._coordinates[t].y=n;break;case V.Z:this._coordinates[t].z=n;break;default:throw new r("invalid ordinateIndex")}}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case V.X:return this._coordinates[t].x;case V.Y:return this._coordinates[t].y;case V.Z:return this._coordinates[t].z}return i.NaN}getCoordinate(){if(1===arguments.length){let t=arguments[0];return this._coordinates[t]}if(2===arguments.length){let t=arguments[0],e=arguments[1];e.x=this._coordinates[t].x,e.y=this._coordinates[t].y,e.z=this._coordinates[t].z}}getCoordinateCopy(t){return new _(this._coordinates[t])}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}expandEnvelope(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Kt(t,this._dimension)}toString(){if(this._coordinates.length>0){var t=new Nt(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}getClass(){return Kt}get interfaces_(){return[V,d]}}Kt.constructor_=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];Kt.constructor_.call(this,t,3)}else if(Number.isInteger(arguments[0])){let e=arguments[0];this._coordinates=new Array(e).fill(null);for(var t=0;t<e;t++)this._coordinates[t]=new _}else if(b(arguments[0],V)){let e=arguments[0];if(null===e)return this._coordinates=new Array(0).fill(null),null;for(this._dimension=e.getDimension(),this._coordinates=new Array(e.size()).fill(null),t=0;t<this._coordinates.length;t++)this._coordinates[t]=e.getCoordinateCopy(t)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1];this._coordinates=t,this._dimension=e,null===t&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let e=arguments[0],r=arguments[1];for(this._coordinates=new Array(e).fill(null),this._dimension=r,t=0;t<e;t++)this._coordinates[t]=new _}},Kt.serialVersionUID=-0xcb44a778db18e00;class $t{constructor(){$t.constructor_.apply(this,arguments)}static instance(){return $t.instanceObject}readResolve(){return $t.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Kt(arguments[0]);if(b(arguments[0],V))return new Kt(arguments[0])}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new Kt(t):new Kt(t,e)}}getClass(){return $t}get interfaces_(){return[q,d]}}$t.constructor_=function(){},$t.serialVersionUID=-0x38e49fa6cf6f2e00,$t.instanceObject=new $t;var Jt=Object.defineProperty,Qt=function(t,e){function r(t){if(!this||this.constructor!==r)return new r(t);this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,t&&function(t){this.add?t.forEach(this.add,this):t.forEach((function(t){this.set(t[0],t[1])}),this)}.call(this,t)}return e||Jt(t,"size",{get:ee}),t.constructor=r,r.prototype=t,r}({delete:function(t){return this.has(t)&&(this._keys.splice(mt,1),this._values.splice(mt,1),this._itp.forEach((function(t){mt<t[0]&&t[0]--}))),mt>-1},has:function(t){return function(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(mt=t.length;mt--&&(r=t[mt])!==(n=e)&&(r==r||n==n););else mt=t.indexOf(e);var r,n;return mt>-1}.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[mt]:void 0},set:function(t,e){return this.has(t)?this._values[mt]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return te(this._itp,this._keys)},values:function(){return te(this._itp,this._values)},entries:function(){return te(this._itp,this._keys,this._values)},forEach:function(t,e){for(var r=this.entries();;){var n=r.next();if(n.done)break;t.call(e,n.value[1],n.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}});function te(t,e,r){var n=[0],i=!1;return t.push(n),{next:function(){var o,s=n[0];return!i&&s<e.length?(o=r?[e[s],r[s]]:e[s],n[0]++):(i=!0,t.splice(t.indexOf(n),1)),{done:i,value:o}}}}function ee(){return this._values.length}let re="undefined"!=typeof Map&&Map.prototype.values?Map:Qt;function ne(){this.map_=new re}ne.prototype=new rt,ne.prototype.get=function(t){return this.map_.get(t)||null},ne.prototype.put=function(t,e){return this.map_.set(t,e),e},ne.prototype.values=function(){const t=new C,e=this.map_.values();let r=e.next();for(;!r.done;)t.add(r.value),r=e.next();return t},ne.prototype.entrySet=function(){const t=new ot;return this.map_.entries().forEach(e=>t.add(e)),t},ne.prototype.size=function(){return this.map_.size()};class ie{constructor(){ie.constructor_.apply(this,arguments)}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof ie))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){var e=t,r=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new N(r).compareTo(new N(n))}getScale(){return this._scale}isFloating(){return this._modelType===ie.FLOATING||this._modelType===ie.FLOATING_SINGLE}getType(){return this._modelType}toString(){var t="UNKNOWN";return this._modelType===ie.FLOATING?t="Floating":this._modelType===ie.FLOATING_SINGLE?t="Floating-Single":this._modelType===ie.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){let t=arguments[0];return i.isNaN(t)||this._modelType===ie.FLOATING_SINGLE?t:this._modelType===ie.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof _){let t=arguments[0];if(this._modelType===ie.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){var t=16;return this._modelType===ie.FLOATING?t=16:this._modelType===ie.FLOATING_SINGLE?t=6:this._modelType===ie.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}getClass(){return ie}get interfaces_(){return[d,h]}}class oe{constructor(){oe.constructor_.apply(this,arguments)}readResolve(){return oe.nameToTypeMap.get(this._name)}toString(){return this._name}getClass(){return oe}get interfaces_(){return[d]}}oe.constructor_=function(){this._name=null;let t=arguments[0];this._name=t,oe.nameToTypeMap.put(t,this)},oe.serialVersionUID=-552860263173159e4,oe.nameToTypeMap=new ne,ie.Type=oe,ie.constructor_=function(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=ie.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof oe){let t=arguments[0];this._modelType=t,t===ie.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){let t=arguments[0];this._modelType=ie.FIXED,this.setScale(t)}else if(arguments[0]instanceof ie){let t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}},ie.serialVersionUID=0x6bee6404e9a25c00,ie.FIXED=new oe("FIXED"),ie.FLOATING=new oe("FLOATING"),ie.FLOATING_SINGLE=new oe("FLOATING SINGLE"),ie.maximumPreciseValue=9007199254740992;class se{constructor(){se.constructor_.apply(this,arguments)}static toMultiPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return $t.instance()}static toMultiLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new _(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new _(t.getMinX(),t.getMinY()),new _(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new _(t.getMinX(),t.getMinY()),new _(t.getMinX(),t.getMaxY()),new _(t.getMaxX(),t.getMaxY()),new _(t.getMaxX(),t.getMinY()),new _(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(b(arguments[0],V))return new Ft(arguments[0],this)}}createMultiLineString(){return 0===arguments.length?new St(null,this):1===arguments.length?new St(arguments[0],this):void 0}buildGeometry(t){for(var e=null,r=!1,n=!1,i=t.iterator();i.hasNext();){var o=i.next(),s=o.getClass();null===e&&(e=s),s!==e&&(r=!0),o instanceof Et&&(n=!0)}if(null===e)return this.createGeometryCollection();if(r||n)return this.createGeometryCollection(se.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Ut)return this.createMultiPolygon(se.toPolygonArray(t));if(a instanceof Ft)return this.createMultiLineString(se.toLineStringArray(t));if(a instanceof jt)return this.createMultiPoint(se.toPointArray(t));m.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof _){let t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(b(arguments[0],V))return new jt(arguments[0],this)}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(b(arguments[0],V)){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Vt){let t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length)return new Ut(arguments[0],arguments[1],this)}getSRID(){return this._SRID}createGeometryCollection(){return 0===arguments.length?new Et(null,this):1===arguments.length?new Et(arguments[0],this):void 0}createGeometry(t){return new Yt(this).edit(t,new class{edit(){if(2===arguments.length&&arguments[1]instanceof W&&b(arguments[0],V)){let t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(b(arguments[0],V))return new Vt(arguments[0],this)}}createMultiPolygon(){return 0===arguments.length?new qt(null,this):1===arguments.length?new qt(arguments[0],this):void 0}createMultiPoint(){if(0===arguments.length)return new Bt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new Bt(arguments[0],this);if(b(arguments[0],V)){let n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var t=new Array(n.size()).fill(null),e=0;e<n.size();e++){var r=this.getCoordinateSequenceFactory().create(1,n.getDimension());At.copy(n,e,r,0,1),t[e]=this.createPoint(r)}return this.createMultiPoint(t)}}}getClass(){return se}get interfaces_(){return[d]}}se.constructor_=function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)se.constructor_.call(this,new ie,0);else if(1===arguments.length){if(b(arguments[0],q)){let t=arguments[0];se.constructor_.call(this,new ie,0,t)}else if(arguments[0]instanceof ie){let t=arguments[0];se.constructor_.call(this,t,0,se.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];se.constructor_.call(this,t,e,se.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=r,this._SRID=e}},se.serialVersionUID=-0x5ea75f2051eeb400;const ae={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};class le{constructor(t){this.geometryFactory=t||new se,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){var e,r,n;t=t.replace(/[\n\r]/g," ");var i=ae.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=ae.emptyTypeStr.exec(t))[2]=void 0),i&&(r=i[1].toLowerCase(),n=i[2],ce[r]&&(e=ce[r].call(this,n))),void 0===e)throw new Error("Could not parse WKT "+t);return e}write(t){return this.extractGeometry(t)}extractGeometry(t){var e=t.getGeometryType().toLowerCase();if(!ue[e])return null;var r=e.toUpperCase();return t.isEmpty()?r+" EMPTY":r+"("+ue[e].call(this,t)+")"}}const ue={coordinate:t=>t.x+" "+t.y,point(t){return ue.coordinate.call(this,t._coordinates._coordinates[0])},multipoint(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+ue.point.call(this,t._geometries[r])+")");return e.join(",")},linestring(t){var e=[];for(let r=0,n=t._points._coordinates.length;r<n;++r)e.push(ue.coordinate.call(this,t._points._coordinates[r]));return e.join(",")},linearring(t){var e=[];for(let r=0,n=t._points._coordinates.length;r<n;++r)e.push(ue.coordinate.call(this,t._points._coordinates[r]));return e.join(",")},multilinestring(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+ue.linestring.call(this,t._geometries[r])+")");return e.join(",")},polygon(t){var e=[];e.push("("+ue.linestring.call(this,t._shell)+")");for(let r=0,n=t._holes.length;r<n;++r)e.push("("+ue.linestring.call(this,t._holes[r])+")");return e.join(",")},multipolygon(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+ue.polygon.call(this,t._geometries[r])+")");return e.join(",")},geometrycollection(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push(this.extractGeometry(t._geometries[r]));return e.join(",")}},ce={coord(t){var e=t.trim().split(ae.spaces),r=new _(Number.parseFloat(e[0]),Number.parseFloat(e[1]));return this.precisionModel.makePrecise(r),r},point(t){return void 0===t?this.geometryFactory.createPoint():this.geometryFactory.createPoint(ce.coord.call(this,t))},multipoint(t){if(void 0===t)return this.geometryFactory.createMultiPoint();var e,r=t.trim().split(","),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(ae.trimParens,"$1"),n.push(ce.point.call(this,e));return this.geometryFactory.createMultiPoint(n)},linestring(t){if(void 0===t)return this.geometryFactory.createLineString();var e=t.trim().split(","),r=[];for(let t=0,n=e.length;t<n;++t)r.push(ce.coord.call(this,e[t]));return this.geometryFactory.createLineString(r)},linearring(t){if(void 0===t)return this.geometryFactory.createLinearRing();var e=t.trim().split(","),r=[];for(let t=0,n=e.length;t<n;++t)r.push(ce.coord.call(this,e[t]));return this.geometryFactory.createLinearRing(r)},multilinestring(t){if(void 0===t)return this.geometryFactory.createMultiLineString();var e,r=t.trim().split(ae.parenComma),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(ae.trimParens,"$1"),n.push(ce.linestring.call(this,e));return this.geometryFactory.createMultiLineString(n)},polygon(t){if(void 0===t)return this.geometryFactory.createPolygon();var e,r,n,i,o=t.trim().split(ae.parenComma),s=[];for(let t=0,a=o.length;t<a;++t)e=o[t].replace(ae.trimParens,"$1"),r=ce.linestring.call(this,e),n=this.geometryFactory.createLinearRing(r._points),0===t?i=n:s.push(n);return this.geometryFactory.createPolygon(i,s)},multipolygon(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();var e,r=t.trim().split(ae.doubleParenComma),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(ae.trimParens,"$1"),n.push(ce.polygon.call(this,e));return this.geometryFactory.createMultiPolygon(n)},geometrycollection(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),r=[];for(let t=0,n=e.length;t<n;++t)r.push(this.read(e[t]));return this.geometryFactory.createGeometryCollection(r)}};class he{constructor(t){this.parser=new le(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class fe{constructor(){fe.constructor_.apply(this,arguments)}static computeEdgeDistance(t,e,r){var n=Math.abs(r.x-e.x),i=Math.abs(r.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(r))o=n>i?n:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=n>i?s:a)||t.equals(e)||(o=Math.max(s,a))}return m.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o}static nonRobustComputeEdgeDistance(t,e,r){var n=t.x-e.x,i=t.y-e.y,o=Math.sqrt(n*n+i*i);return m.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){var t=new Nt;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,r,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=r,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,r,n)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){let t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){let e=arguments[0];for(var t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==fe.NO_INTERSECTION}getEdgeDistance(t,e){return fe.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===fe.COLLINEAR_INTERSECTION}toString(){return he.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+he.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}getClass(){return fe}get interfaces_(){return[]}}fe.constructor_=function(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new _,this._intPt[1]=new _,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},fe.DONT_INTERSECT=0,fe.DO_INTERSECT=1,fe.COLLINEAR=2,fe.NO_INTERSECTION=0,fe.POINT_INTERSECTION=1,fe.COLLINEAR_INTERSECTION=2;class pe extends fe{constructor(){super(),pe.constructor_.apply(this,arguments)}static nearestEndpoint(t,e,r,n){var i=t,o=B.pointToSegment(t,r,n),s=B.pointToSegment(e,r,n);return s<o&&(o=s,i=e),(s=B.pointToSegment(r,t,e))<o&&(o=s,i=r),(s=B.pointToSegment(n,t,e))<o&&(o=s,i=n),i}isInSegmentEnvelopes(t){var e=new R(this._inputLines[0][0],this._inputLines[0][1]),r=new R(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&r.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{let t=arguments[0],e=arguments[1],r=arguments[2];if(this._isProper=!1,R.intersects(e,r,t)&&0===j.index(e,r,t)&&0===j.index(r,e,t))return this._isProper=!0,(t.equals(e)||t.equals(r))&&(this._isProper=!1),this._result=fe.POINT_INTERSECTION,null;this._result=fe.NO_INTERSECTION}}normalizeToMinimum(t,e,r,n,i){i.x=this.smallestInAbsValue(t.x,e.x,r.x,n.x),i.y=this.smallestInAbsValue(t.y,e.y,r.y,n.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y}safeHCoordinateIntersection(t,e,r,n){var i=null;try{i=z.intersection(t,e,r,n)}catch(o){if(!(o instanceof M))throw o;i=pe.nearestEndpoint(t,e,r,n)}return i}intersection(t,e,r,n){var i=this.intersectionWithNormalization(t,e,r,n);return this.isInSegmentEnvelopes(i)||(i=new _(pe.nearestEndpoint(t,e,r,n))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i}smallestInAbsValue(t,e,r,n){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(r)<o&&(i=r,o=Math.abs(r)),Math.abs(n)<o&&(i=n),i}checkDD(t,e,r,n,i){var o=D.intersection(t,e,r,n),s=this.isInSegmentEnvelopes(o);G.out.println("DD in env = "+s+"  --------------------- "+o),i.distance(o)>1e-4&&G.out.println("Distance = "+i.distance(o))}intersectionWithNormalization(t,e,r,n){var i=new _(t),o=new _(e),s=new _(r),a=new _(n),l=new _;this.normalizeToEnvCentre(i,o,s,a,l);var u=this.safeHCoordinateIntersection(i,o,s,a);return u.x+=l.x,u.y+=l.y,u}computeCollinearIntersection(t,e,r,n){var i=R.intersects(t,e,r),o=R.intersects(t,e,n),s=R.intersects(r,n,t),a=R.intersects(r,n,e);return i&&o?(this._intPt[0]=r,this._intPt[1]=n,fe.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,fe.COLLINEAR_INTERSECTION):i&&s?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||o||a?fe.COLLINEAR_INTERSECTION:fe.POINT_INTERSECTION):i&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||s?fe.COLLINEAR_INTERSECTION:fe.POINT_INTERSECTION):o&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||i||a?fe.COLLINEAR_INTERSECTION:fe.POINT_INTERSECTION):o&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||i||s?fe.COLLINEAR_INTERSECTION:fe.POINT_INTERSECTION):fe.NO_INTERSECTION}normalizeToEnvCentre(t,e,r,n,i){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=r.x<n.x?r.x:n.x,c=r.y<n.y?r.y:n.y,h=r.x>n.x?r.x:n.x,f=r.y>n.y?r.y:n.y,p=((o>u?o:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<f?l:f))/2;i.x=p,i.y=d,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y}computeIntersect(t,e,r,n){if(this._isProper=!1,!R.intersects(t,e,r,n))return fe.NO_INTERSECTION;var i=j.index(t,e,r),o=j.index(t,e,n);if(i>0&&o>0||i<0&&o<0)return fe.NO_INTERSECTION;var s=j.index(r,n,t),a=j.index(r,n,e);return s>0&&a>0||s<0&&a<0?fe.NO_INTERSECTION:0===i&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,r,n):(0===i||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(r)||t.equals2D(n)?this._intPt[0]=t:e.equals2D(r)||e.equals2D(n)?this._intPt[0]=e:0===i?this._intPt[0]=new _(r):0===o?this._intPt[0]=new _(n):0===s?this._intPt[0]=new _(t):0===a&&(this._intPt[0]=new _(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,r,n)),fe.POINT_INTERSECTION)}getClass(){return pe}get interfaces_(){return[]}}pe.constructor_=function(){};class de{constructor(){de.constructor_.apply(this,arguments)}static midPoint(t,e){return new _((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof de){let r=arguments[0];var t=j.index(this.p0,this.p1,r.p0),e=j.index(this.p0,this.p1,r.p1);return t>=0&&e>=0||t<=0&&e<=0?Math.max(t,e):0}if(arguments[0]instanceof _){let t=arguments[0];return j.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof de))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){var e=new pe;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof _){let r=arguments[0];if(r.equals(this.p0)||r.equals(this.p1))return new _(r);var t=this.projectionFactor(r),e=new _;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}if(arguments[0]instanceof de){let t=arguments[0];var r=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(r>=1&&n>=1)return null;if(r<=0&&n<=0)return null;var i=this.project(t.p0);r<0&&(i=this.p0),r>1&&(i=this.p1);var o=this.project(t.p1);return n<0&&(o=this.p0),n>1&&(o=this.p1),new de(i,o)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return B.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return de.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,n=e*e+r*r;return n<=0?i.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*r)/n}closestPoints(t){var e=this.intersection(t);if(null!==e)return[e,e];var r=new Array(2).fill(null),n=i.MAX_VALUE,o=null,s=this.closestPoint(t.p0);n=s.distance(t.p0),r[0]=s,r[1]=t.p0;var a=this.closestPoint(t.p1);(o=a.distance(t.p1))<n&&(n=o,r[0]=a,r[1]=t.p1);var l=t.closestPoint(this.p0);(o=l.distance(this.p0))<n&&(n=o,r[0]=this.p0,r[1]=l);var u=t.closestPoint(this.p1);return(o=u.distance(this.p1))<n&&(n=o,r[0]=this.p1,r[1]=u),r}closestPoint(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){var e=t,r=this.p0.compareTo(e.p0);return 0!==r?r:this.p1.compareTo(e.p1)}reverse(){var t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){try{return z.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof M))throw t}return null}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){var r=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(i*i+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*i/s,l=e*o/s}return new _(r-l,n+a)}setCoordinates(){if(1===arguments.length){let t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||i.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}distance(){if(arguments[0]instanceof de){let t=arguments[0];return B.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof _){let t=arguments[0];return B.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){var e=new _;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),r=java.lang.Double.doubleToLongBits(this.p1.x);return r^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(r)^Math.trunc(r>>32)}getClass(){return de}get interfaces_(){return[h,d]}}de.constructor_=function(){if(this.p0=null,this.p1=null,0===arguments.length)de.constructor_.call(this,new _,new _);else if(1===arguments.length){let t=arguments[0];de.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];de.constructor_.call(this,new _(t,e),new _(r,n))}},de.serialVersionUID=0x2d2172135f411c00;class ge{constructor(){ge.constructor_.apply(this,arguments)}static toLocationSymbol(t){switch(t){case ge.EXTERIOR:return"e";case ge.BOUNDARY:return"b";case ge.INTERIOR:return"i";case ge.NONE:return"-"}throw new r("Unknown location value: "+t)}getClass(){return ge}get interfaces_(){return[]}}ge.constructor_=function(){},ge.INTERIOR=0,ge.BOUNDARY=1,ge.EXTERIOR=2,ge.NONE=-1;class ye{constructor(){ye.constructor_.apply(this,arguments)}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return e===bt.SYM_DONTCARE||e===bt.SYM_TRUE&&(t>=0||t===bt.TRUE)||e===bt.SYM_FALSE&&t===bt.FALSE||e===bt.SYM_P&&t===bt.P||e===bt.SYM_L&&t===bt.L||e===bt.SYM_A&&t===bt.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){let t=arguments[1];return new ye(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===bt.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])||ye.isTrue(this._matrix[ge.INTERIOR][ge.BOUNDARY])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.INTERIOR])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.BOUNDARY]))&&this._matrix[ge.EXTERIOR][ge.INTERIOR]===bt.FALSE&&this._matrix[ge.EXTERIOR][ge.BOUNDARY]===bt.FALSE}isCoveredBy(){return(ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])||ye.isTrue(this._matrix[ge.INTERIOR][ge.BOUNDARY])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.INTERIOR])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.BOUNDARY]))&&this._matrix[ge.INTERIOR][ge.EXTERIOR]===bt.FALSE&&this._matrix[ge.BOUNDARY][ge.EXTERIOR]===bt.FALSE}set(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<n.length;t++){var e=Math.trunc(t/3),r=t%3;this._matrix[e][r]=bt.toDimensionValue(n.charAt(t))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._matrix[t][e]=r}}isContains(){return ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&this._matrix[ge.EXTERIOR][ge.INTERIOR]===bt.FALSE&&this._matrix[ge.EXTERIOR][ge.BOUNDARY]===bt.FALSE}setAtLeast(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<n.length;t++){var e=Math.trunc(t/3),r=t%3;this.setAtLeast(e,r,bt.toDimensionValue(n.charAt(t)))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._matrix[t][e]<r&&(this._matrix[t][e]=r)}}setAtLeastIfValid(t,e,r){t>=0&&e>=0&&this.setAtLeast(t,e,r)}isWithin(){return ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&this._matrix[ge.INTERIOR][ge.EXTERIOR]===bt.FALSE&&this._matrix[ge.BOUNDARY][ge.EXTERIOR]===bt.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===bt.A&&e===bt.A||t===bt.L&&e===bt.L||t===bt.L&&e===bt.A||t===bt.P&&e===bt.A||t===bt.P&&e===bt.L)&&this._matrix[ge.INTERIOR][ge.INTERIOR]===bt.FALSE&&(ye.isTrue(this._matrix[ge.INTERIOR][ge.BOUNDARY])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.INTERIOR])||ye.isTrue(this._matrix[ge.BOUNDARY][ge.BOUNDARY]))}isOverlaps(t,e){return t===bt.P&&e===bt.P||t===bt.A&&e===bt.A?ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&ye.isTrue(this._matrix[ge.INTERIOR][ge.EXTERIOR])&&ye.isTrue(this._matrix[ge.EXTERIOR][ge.INTERIOR]):t===bt.L&&e===bt.L&&1===this._matrix[ge.INTERIOR][ge.INTERIOR]&&ye.isTrue(this._matrix[ge.INTERIOR][ge.EXTERIOR])&&ye.isTrue(this._matrix[ge.EXTERIOR][ge.INTERIOR])}isEquals(t,e){return t===e&&ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&this._matrix[ge.INTERIOR][ge.EXTERIOR]===bt.FALSE&&this._matrix[ge.BOUNDARY][ge.EXTERIOR]===bt.FALSE&&this._matrix[ge.EXTERIOR][ge.INTERIOR]===bt.FALSE&&this._matrix[ge.EXTERIOR][ge.BOUNDARY]===bt.FALSE}toString(){for(var t=new Nt("123456789"),e=0;e<3;e++)for(var r=0;r<3;r++)t.setCharAt(3*e+r,bt.toDimensionSymbol(this._matrix[e][r]));return t.toString()}setAll(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this._matrix[e][r]=t}get(t,e){return this._matrix[t][e]}transpose(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new r("Should be length 9: "+t);for(var e=0;e<3;e++)for(var n=0;n<3;n++)if(!ye.matches(this._matrix[e][n],t.charAt(3*e+n)))return!1;return!0}add(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this.setAtLeast(e,r,t.get(e,r))}isDisjoint(){return this._matrix[ge.INTERIOR][ge.INTERIOR]===bt.FALSE&&this._matrix[ge.INTERIOR][ge.BOUNDARY]===bt.FALSE&&this._matrix[ge.BOUNDARY][ge.INTERIOR]===bt.FALSE&&this._matrix[ge.BOUNDARY][ge.BOUNDARY]===bt.FALSE}isCrosses(t,e){return t===bt.P&&e===bt.L||t===bt.P&&e===bt.A||t===bt.L&&e===bt.A?ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&ye.isTrue(this._matrix[ge.INTERIOR][ge.EXTERIOR]):t===bt.L&&e===bt.P||t===bt.A&&e===bt.P||t===bt.A&&e===bt.L?ye.isTrue(this._matrix[ge.INTERIOR][ge.INTERIOR])&&ye.isTrue(this._matrix[ge.EXTERIOR][ge.INTERIOR]):t===bt.L&&e===bt.L&&0===this._matrix[ge.INTERIOR][ge.INTERIOR]}getClass(){return ye}get interfaces_(){return[f]}}ye.constructor_=function(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(bt.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){let t=arguments[0];ye.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof ye){let t=arguments[0];ye.constructor_.call(this),this._matrix[ge.INTERIOR][ge.INTERIOR]=t._matrix[ge.INTERIOR][ge.INTERIOR],this._matrix[ge.INTERIOR][ge.BOUNDARY]=t._matrix[ge.INTERIOR][ge.BOUNDARY],this._matrix[ge.INTERIOR][ge.EXTERIOR]=t._matrix[ge.INTERIOR][ge.EXTERIOR],this._matrix[ge.BOUNDARY][ge.INTERIOR]=t._matrix[ge.BOUNDARY][ge.INTERIOR],this._matrix[ge.BOUNDARY][ge.BOUNDARY]=t._matrix[ge.BOUNDARY][ge.BOUNDARY],this._matrix[ge.BOUNDARY][ge.EXTERIOR]=t._matrix[ge.BOUNDARY][ge.EXTERIOR],this._matrix[ge.EXTERIOR][ge.INTERIOR]=t._matrix[ge.EXTERIOR][ge.INTERIOR],this._matrix[ge.EXTERIOR][ge.BOUNDARY]=t._matrix[ge.EXTERIOR][ge.BOUNDARY],this._matrix[ge.EXTERIOR][ge.EXTERIOR]=t._matrix[ge.EXTERIOR][ge.EXTERIOR]}};class me{constructor(){me.constructor_.apply(this,arguments)}static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=me.PI_TIMES_2;for(;t<=-Math.PI;)t+=me.PI_TIMES_2;return t}static angle(){if(1===arguments.length){let t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){let r=arguments[0],n=arguments[1];var t=n.x-r.x,e=n.y-r.y;return Math.atan2(e,t)}}static isAcute(t,e,r){var n=t.x-e.x,i=t.y-e.y;return n*(r.x-e.x)+i*(r.y-e.y)>0}static isObtuse(t,e,r){var n=t.x-e.x,i=t.y-e.y;return n*(r.x-e.x)+i*(r.y-e.y)<0}static interiorAngle(t,e,r){var n=me.angle(e,t),i=me.angle(e,r);return Math.abs(i-n)}static normalizePositive(t){if(t<0){for(;t<0;)t+=me.PI_TIMES_2;t>=me.PI_TIMES_2&&(t=0)}else{for(;t>=me.PI_TIMES_2;)t-=me.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,r){var n=me.angle(e,t),i=me.angle(e,r);return me.diff(n,i)}static diff(t,e){var r=null;return(r=t<e?e-t:t-e)>Math.PI&&(r=2*Math.PI-r),r}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){var r=Math.sin(e-t);return r>0?me.COUNTERCLOCKWISE:r<0?me.CLOCKWISE:me.NONE}static angleBetweenOriented(t,e,r){var n=me.angle(e,t),i=me.angle(e,r)-n;return i<=-Math.PI?i+me.PI_TIMES_2:i>Math.PI?i-me.PI_TIMES_2:i}getClass(){return me}get interfaces_(){return[]}}me.constructor_=function(){},me.PI_TIMES_2=2*Math.PI,me.PI_OVER_2=Math.PI/2,me.PI_OVER_4=Math.PI/4,me.COUNTERCLOCKWISE=j.COUNTERCLOCKWISE,me.CLOCKWISE=j.CLOCKWISE,me.NONE=j.COLLINEAR;class _e{constructor(){_e.constructor_.apply(this,arguments)}static area(t,e,r){return Math.abs(((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2)}static signedArea(t,e,r){return((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2}static det(t,e,r,n){return t*n-e*r}static interpolateZ(t,e,r,n){var i=e.x,o=e.y,s=r.x-i,a=n.x-i,l=r.y-o,u=n.y-o,c=s*u-a*l,h=t.x-i,f=t.y-o,p=(u*h-a*f)/c,d=(-l*h+s*f)/c;return e.z+p*(r.z-e.z)+d*(n.z-e.z)}static longestSideLength(t,e,r){var n=t.distance(e),i=e.distance(r),o=r.distance(t),s=n;return i>s&&(s=i),o>s&&(s=o),s}static isAcute(t,e,r){return!!me.isAcute(t,e,r)&&!!me.isAcute(e,r,t)&&!!me.isAcute(r,t,e)}static circumcentre(t,e,r){var n=r.x,i=r.y,o=t.x-n,s=t.y-i,a=e.x-n,l=e.y-i,u=2*_e.det(o,s,a,l),c=_e.det(s,o*o+s*s,l,a*a+l*l),h=_e.det(o,o*o+s*s,a,a*a+l*l);return new _(n-c/u,i+h/u)}static perpendicularBisector(t,e){var r=e.x-t.x,n=e.y-t.y,i=new z(t.x+r/2,t.y+n/2,1),o=new z(t.x-n+r/2,t.y+r+n/2,1);return new z(i,o)}static angleBisector(t,e,r){var n=e.distance(t),i=n/(n+e.distance(r)),o=r.x-t.x,s=r.y-t.y;return new _(t.x+i*o,t.y+i*s)}static area3D(t,e,r){var n=e.x-t.x,i=e.y-t.y,o=e.z-t.z,s=r.x-t.x,a=r.y-t.y,l=r.z-t.z,u=i*l-o*a,c=o*s-n*l,h=n*a-i*s,f=u*u+c*c+h*h;return Math.sqrt(f)/2}static centroid(t,e,r){var n=(t.x+e.x+r.x)/3,i=(t.y+e.y+r.y)/3;return new _(n,i)}static inCentre(t,e,r){var n=e.distance(r),i=t.distance(r),o=t.distance(e),s=n+i+o,a=(n*t.x+i*e.x+o*r.x)/s,l=(n*t.y+i*e.y+o*r.y)/s;return new _(a,l)}area(){return _e.area(this.p0,this.p1,this.p2)}signedArea(){return _e.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new r("Supplied point is null.");return _e.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return _e.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return _e.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return _e.circumcentre(this.p0,this.p1,this.p2)}area3D(){return _e.area3D(this.p0,this.p1,this.p2)}centroid(){return _e.centroid(this.p0,this.p1,this.p2)}inCentre(){return _e.inCentre(this.p0,this.p1,this.p2)}getClass(){return _e}get interfaces_(){return[]}}_e.constructor_=function(){this.p0=null,this.p1=null,this.p2=null;let t=arguments[0],e=arguments[1],r=arguments[2];this.p0=t,this.p1=e,this.p2=r};var ve=Object.freeze({Coordinate:_,CoordinateList:P,Envelope:R,LineSegment:de,GeometryFactory:se,Geometry:W,Point:jt,LineString:Ft,LinearRing:Vt,Polygon:Ut,GeometryCollection:Et,MultiPoint:Bt,MultiLineString:St,MultiPolygon:qt,Dimension:bt,IntersectionMatrix:ye,PrecisionModel:ie,Location:ge,Triangle:_e});class be{constructor(){be.constructor_.apply(this,arguments)}getCoordinates(){return this._pt}getCoordinate(t){return this._pt[t]}setMinimum(){if(1===arguments.length){let t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){let e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var t=e.distance(r);t<this._distance&&this.initialize(e,r,t)}}initialize(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=r,this._isNull=!1}}toString(){return he.toLineString(this._pt[0],this._pt[1])}getDistance(){return this._distance}setMaximum(){if(1===arguments.length){let t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){let e=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(e,r),null;var t=e.distance(r);t>this._distance&&this.initialize(e,r,t)}}getClass(){return be}get interfaces_(){return[]}}be.constructor_=function(){this._pt=[new _,new _],this._distance=i.NaN,this._isNull=!0};class we{constructor(){we.constructor_.apply(this,arguments)}static computeDistance(){if(arguments[2]instanceof be&&arguments[0]instanceof Ft&&arguments[1]instanceof _){let i=arguments[0],o=arguments[1],s=arguments[2];for(var t=new de,e=i.getCoordinates(),r=0;r<e.length-1;r++){t.setCoordinates(e[r],e[r+1]);var n=t.closestPoint(o);s.setMinimum(n,o)}}else if(arguments[2]instanceof be&&arguments[0]instanceof Ut&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1],n=arguments[2];for(we.computeDistance(t.getExteriorRing(),e,n),r=0;r<t.getNumInteriorRing();r++)we.computeDistance(t.getInteriorRingN(r),e,n)}else if(arguments[2]instanceof be&&arguments[0]instanceof W&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1],n=arguments[2];if(t instanceof Ft)we.computeDistance(t,e,n);else if(t instanceof Ut)we.computeDistance(t,e,n);else if(t instanceof Et){var i=t;for(r=0;r<i.getNumGeometries();r++){var o=i.getGeometryN(r);we.computeDistance(o,e,n)}}else n.setMinimum(t.getCoordinate(),e)}else if(arguments[2]instanceof be&&arguments[0]instanceof de&&arguments[1]instanceof _){let t=arguments[1],e=arguments[2];n=arguments[0].closestPoint(t),e.setMinimum(n,t)}}getClass(){return we}get interfaces_(){return[]}}we.constructor_=function(){};class xe{constructor(){xe.constructor_.apply(this,arguments)}static distance(){if(2===arguments.length)return(t=new xe(arguments[0],arguments[1])).distance();if(3===arguments.length){let e=arguments[2];var t;return(t=new xe(arguments[0],arguments[1])).setDensifyFraction(e),t.distance()}}getCoordinates(){return this._ptDist.getCoordinates()}setDensifyFraction(t){if(t>1||t<=0)throw new r("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t}compute(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)}distance(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}computeOrientedDistance(t,e,r){var n=new Ee(e);if(t.apply(n),r.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var i=new Se(e,this._densifyFrac);t.apply(i),r.setMaximum(i.getMaxPointDistance())}}orientedDistance(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}getClass(){return xe}get interfaces_(){return[]}}class Ee{constructor(){Ee.constructor_.apply(this,arguments)}filter(t){this._minPtDist.initialize(),we.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}getMaxPointDistance(){return this._maxPtDist}getClass(){return Ee}get interfaces_(){return[X]}}Ee.constructor_=function(){this._maxPtDist=new be,this._minPtDist=new be,this._euclideanDist=new we,this._geom=null;let t=arguments[0];this._geom=t};class Se{constructor(){Se.constructor_.apply(this,arguments)}filter(t,e){if(0===e)return null;for(var r=t.getCoordinate(e-1),n=t.getCoordinate(e),i=(n.x-r.x)/this._numSubSegs,o=(n.y-r.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=r.x+s*i,l=r.y+s*o,u=new _(a,l);this._minPtDist.initialize(),we.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}isDone(){return!1}isGeometryChanged(){return!1}getMaxPointDistance(){return this._maxPtDist}getClass(){return Se}get interfaces_(){return[xt]}}Se.constructor_=function(){this._maxPtDist=new be,this._minPtDist=new be,this._geom=null,this._numSubSegs=0;let t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))},xe.MaxPointDistanceFilter=Ee,xe.MaxDensifiedByFractionDistanceFilter=Se,xe.constructor_=function(){this._g0=null,this._g1=null,this._ptDist=new be,this._densifyFrac=0;let t=arguments[0],e=arguments[1];this._g0=t,this._g1=e};var Ie=Object.freeze({DiscreteHausdorffDistance:xe,DistanceToPoint:we,PointPairDistance:be});class Oe{constructor(){Oe.constructor_.apply(this,arguments)}visitItem(t){}getClass(){return Oe}get interfaces_(){return[]}}Oe.constructor_=function(){};class Ce{constructor(){Ce.constructor_.apply(this,arguments)}locate(t){}getClass(){return Ce}get interfaces_(){return[]}}Ce.constructor_=function(){};class Te{constructor(){Te.constructor_.apply(this,arguments)}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return he.toLineString(new _(this._min,0),new _(this._max,0))}getClass(){return Te}get interfaces_(){return[]}}class Pe{constructor(){Pe.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e,i=(r._min+r._max)/2,o=(n._min+n._max)/2;return i<o?-1:i>o?1:0}getClass(){return Pe}get interfaces_(){return[p]}}Pe.constructor_=function(){},Te.NodeComparator=Pe,Te.constructor_=function(){this._min=i.POSITIVE_INFINITY,this._max=i.NEGATIVE_INFINITY};class Re extends Te{constructor(){super(),Re.constructor_.apply(this,arguments)}query(t,e,r){if(!this.intersects(t,e))return null;r.visitItem(this._item)}getClass(){return Re}get interfaces_(){return[]}}Re.constructor_=function(){this._item=null;let t=arguments[0],e=arguments[1],r=arguments[2];this._min=t,this._max=e,this._item=r};const Le={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return Le.sort(t),t.get(0)},sort:function(t,e){const r=t.toArray();e?vt.sort(r,e):vt.sort(r);const n=t.iterator();for(let t=0,e=r.length;t<e;t++)n.next(),n.set(r[t])},singletonList:function(t){const e=new C;return e.add(t),e}};class Me extends Te{constructor(){super(),Me.constructor_.apply(this,arguments)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,r){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,r),null!==this._node2&&this._node2.query(t,e,r)}getClass(){return Me}get interfaces_(){return[]}}Me.constructor_=function(){this._node1=null,this._node2=null;let t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)};class ke{constructor(){ke.constructor_.apply(this,arguments)}buildTree(){Le.sort(this._leaves,new Te.NodeComparator);for(var t=this._leaves,e=null,r=new C;;){if(this.buildLevel(t,r),1===r.size())return r.get(0);e=t,t=r,r=e}}insert(t,e,r){if(null!==this._root)throw new IllegalStateException("Index cannot be added to once it has been queried");this._leaves.add(new Re(t,e,r))}query(t,e,r){this.init(),this._root.query(t,e,r)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){G.out.println(he.toLineString(new _(t._min,this._level),new _(t._max,this._level)))}init(){if(null!==this._root)return null;this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(var r=0;r<t.size();r+=2){var n=t.get(r);if(null===(r+1<t.size()?t.get(r):null))e.add(n);else{var i=new Me(t.get(r),t.get(r+1));e.add(i)}}}getClass(){return ke}get interfaces_(){return[]}}ke.constructor_=function(){this._leaves=new C,this._root=null,this._level=0};class Ne{constructor(){Ne.constructor_.apply(this,arguments)}static getGeometry(){if(1===arguments.length){let t=arguments[0];return t.getFactory().buildGeometry(Ne.getLines(t))}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(Ne.getLines(t,e))}}static getLines(){if(1===arguments.length){let t=arguments[0];return Ne.getLines(t,!1)}if(2===arguments.length){if(b(arguments[0],x)&&b(arguments[1],x)){let r=arguments[1];for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();Ne.getLines(e,r)}return r}if(arguments[0]instanceof W&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];var r=new C;return t.apply(new Ne(r,e)),r}if(arguments[0]instanceof W&&b(arguments[1],x)){let t=arguments[0],e=arguments[1];return t instanceof Ft?e.add(t):t.apply(new Ne(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&b(arguments[0],x)&&b(arguments[1],x)){let r=arguments[1],n=arguments[2];for(t=arguments[0].iterator();t.hasNext();)e=t.next(),Ne.getLines(e,r,n);return r}if("boolean"==typeof arguments[2]&&arguments[0]instanceof W&&b(arguments[1],x)){let t=arguments[1],e=arguments[2];return arguments[0].apply(new Ne(t,e)),t}}}filter(t){if(this._isForcedToLineString&&t instanceof Vt){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Ft&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}getClass(){return Ne}get interfaces_(){return[Y]}}Ne.constructor_=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){let t=arguments[0];this._lines=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}};class Ae{constructor(){Ae.constructor_.apply(this,arguments)}visitItem(t){this._items.add(t)}getItems(){return this._items}getClass(){return Ae}get interfaces_(){return[Oe]}}Ae.constructor_=function(){this._items=new C};class Fe{constructor(){Fe.constructor_.apply(this,arguments)}static locatePointInRing(){if(arguments[0]instanceof _&&b(arguments[1],V)){let i=arguments[1];for(var t=new Fe(arguments[0]),e=new _,r=new _,n=1;n<i.size();n++)if(i.getCoordinate(n,e),i.getCoordinate(n-1,r),t.countSegment(e,r),t.isOnSegment())return t.getLocation();return t.getLocation()}if(arguments[0]instanceof _&&arguments[1]instanceof Array){let i=arguments[1];for(t=new Fe(arguments[0]),n=1;n<i.length;n++)if(e=i[n],r=i[n-1],t.countSegment(e,r),t.isOnSegment())return t.getLocation();return t.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var r=t.x,n=e.x;return r>n&&(r=e.x,n=t.x),this._p.x>=r&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=j.index(t,e,this._p);if(i===j.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(i=-i),i===j.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==ge.EXTERIOR}getLocation(){return this._isPointOnSegment?ge.BOUNDARY:this._crossingCount%2==1?ge.INTERIOR:ge.EXTERIOR}isOnSegment(){return this._isPointOnSegment}getClass(){return Fe}get interfaces_(){return[]}}Fe.constructor_=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;let t=arguments[0];this._p=t};class De{constructor(){De.constructor_.apply(this,arguments)}locate(t){var e=new Fe(t),r=new je(e);return this._index.query(t.y,t.y,r),e.getLocation()}getClass(){return De}get interfaces_(){return[Ce]}}class je{constructor(){je.constructor_.apply(this,arguments)}visitItem(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}getClass(){return je}get interfaces_(){return[Oe]}}je.constructor_=function(){this._counter=null;let t=arguments[0];this._counter=t};class Ge{constructor(){Ge.constructor_.apply(this,arguments)}init(t){for(var e=Ne.getLines(t).iterator();e.hasNext();){var r=e.next().getCoordinates();this.addLine(r)}}addLine(t){for(var e=1;e<t.length;e++){var r=new de(t[e-1],t[e]),n=Math.min(r.p0.y,r.p1.y),i=Math.max(r.p0.y,r.p1.y);this._index.insert(n,i,r)}}query(){if(2===arguments.length){let e=arguments[0],r=arguments[1];var t=new Ae;return this._index.query(e,r,t),t.getItems()}if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._index.query(t,e,r)}}getClass(){return Ge}get interfaces_(){return[]}}Ge.constructor_=function(){this._index=new ke;let t=arguments[0];this.init(t)},De.SegmentVisitor=je,De.IntervalIndexedGeometry=Ge,De.constructor_=function(){this._index=null;let t=arguments[0];if(!(b(t,zt)||t instanceof Vt))throw new r("Argument must be Polygonal or LinearRing");this._index=new Ge(t)};class ze{constructor(){ze.constructor_.apply(this,arguments)}static isOnLine(){if(arguments[0]instanceof _&&b(arguments[1],V)){let o=arguments[0],s=arguments[1];for(var t=new pe,e=new _,r=new _,n=s.size(),i=1;i<n;i++)if(s.getCoordinate(i-1,e),s.getCoordinate(i,r),t.computeIntersection(o,e,r),t.hasIntersection())return!0;return!1}if(arguments[0]instanceof _&&arguments[1]instanceof Array){let n=arguments[0],o=arguments[1];for(t=new pe,i=1;i<o.length;i++)if(e=o[i-1],r=o[i],t.computeIntersection(n,e,r),t.hasIntersection())return!0;return!1}}static locateInRing(t,e){return Fe.locatePointInRing(t,e)}static isInRing(t,e){return ze.locateInRing(t,e)!==ge.EXTERIOR}getClass(){return ze}get interfaces_(){return[]}}ze.constructor_=function(){};class Ue{constructor(){Ue.constructor_.apply(this,arguments)}static isAtomic(t){return!(t instanceof Et)}next(){if(this._atStart)return this._atStart=!1,Ue.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new I;var t=this._parent.getGeometryN(this._index++);return t instanceof Et?(this._subcollectionIterator=new Ue(t),this._subcollectionIterator.next()):t}remove(){throw new UnsupportedOperationException(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}getClass(){return Ue}get interfaces_(){return[w]}}Ue.constructor_=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;let t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};class Be{constructor(){Be.constructor_.apply(this,arguments)}static locatePointInPolygon(t,e){if(e.isEmpty())return ge.EXTERIOR;var r=e.getExteriorRing(),n=Be.locatePointInRing(t,r);if(n!==ge.INTERIOR)return n;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=Be.locatePointInRing(t,o);if(s===ge.BOUNDARY)return ge.BOUNDARY;if(s===ge.INTERIOR)return ge.EXTERIOR}return ge.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?ze.locateInRing(t,e.getCoordinates()):ge.EXTERIOR}static containsPointInPolygon(t,e){return ge.EXTERIOR!==Be.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof Ut)return Be.locatePointInPolygon(t,e);if(e instanceof Et)for(var r=new Ue(e);r.hasNext();){var n=r.next();if(n!==e){var i=Be.locateInGeometry(t,n);if(i!==ge.EXTERIOR)return i}}return ge.EXTERIOR}static locate(t,e){return e.isEmpty()?ge.EXTERIOR:Be.locateInGeometry(t,e)}locate(t){return Be.locate(t,this._geom)}getClass(){return Be}get interfaces_(){return[Ce]}}Be.constructor_=function(){this._geom=null;let t=arguments[0];this._geom=t};var Ve=Object.freeze({IndexedPointInAreaLocator:De,PointOnGeometryLocator:Ce,SimplePointInAreaLocator:Be});class qe{constructor(){qe.constructor_.apply(this,arguments)}measure(t,e){}getClass(){return qe}get interfaces_(){return[]}}qe.constructor_=function(){};class Ye{constructor(){Ye.constructor_.apply(this,arguments)}measure(t,e){return t.intersection(e).getArea()/t.union(e).getArea()}getClass(){return Ye}get interfaces_(){return[qe]}}Ye.constructor_=function(){};class We{constructor(){We.constructor_.apply(this,arguments)}static diagonalSize(t){if(t.isNull())return 0;var e=t.getWidth(),r=t.getHeight();return Math.sqrt(e*e+r*r)}measure(t,e){var r=xe.distance(t,e,We.DENSIFY_FRACTION),n=new R(t.getEnvelopeInternal());return n.expandToInclude(e.getEnvelopeInternal()),1-r/We.diagonalSize(n)}getClass(){return We}get interfaces_(){return[qe]}}We.constructor_=function(){},We.DENSIFY_FRACTION=.25;class Xe{constructor(){Xe.constructor_.apply(this,arguments)}static combine(t,e){return Math.min(t,e)}getClass(){return Xe}get interfaces_(){return[]}}Xe.constructor_=function(){};var He=Object.freeze({AreaSimilarityMeasure:Ye,HausdorffSimilarityMeasure:We,SimilarityMeasure:qe,SimilarityMeasureCombiner:Xe});class Ze{constructor(){Ze.constructor_.apply(this,arguments)}static area2(t,e,r){return(e.x-t.x)*(r.y-t.y)-(r.x-t.x)*(e.y-t.y)}static centroid3(t,e,r,n){return n.x=t.x+e.x+r.x,n.y=t.y+e.y+r.y,null}static getCentroid(t){return new Ze(t).getCentroid()}setAreaBasePoint(t){this._areaBasePt=t}addPoint(t){this._ptCount+=1,this._ptCentSum.x+=t.x,this._ptCentSum.y+=t.y}addLineSegments(t){for(var e=0,r=0;r<t.length-1;r++){var n=t[r].distance(t[r+1]);if(0!==n){e+=n;var i=(t[r].x+t[r+1].x)/2;this._lineCentSum.x+=n*i;var o=(t[r].y+t[r+1].y)/2;this._lineCentSum.y+=n*o}}this._totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])}addHole(t){for(var e=j.isCCW(t),r=0;r<t.length-1;r++)this.addTriangle(this._areaBasePt,t[r],t[r+1],e);this.addLineSegments(t)}getCentroid(){var t=new _;if(Math.abs(this._areasum2)>0)t.x=this._cg3.x/3/this._areasum2,t.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)t.x=this._lineCentSum.x/this._totalLength,t.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;t.x=this._ptCentSum.x/this._ptCount,t.y=this._ptCentSum.y/this._ptCount}return t}addShell(t){t.length>0&&this.setAreaBasePoint(t[0]);for(var e=!j.isCCW(t),r=0;r<t.length-1;r++)this.addTriangle(this._areaBasePt,t[r],t[r+1],e);this.addLineSegments(t)}addTriangle(t,e,r,n){var i=n?1:-1;Ze.centroid3(t,e,r,this._triangleCent3);var o=Ze.area2(t,e,r);this._cg3.x+=i*o*this._triangleCent3.x,this._cg3.y+=i*o*this._triangleCent3.y,this._areasum2+=i*o}add(){if(arguments[0]instanceof Ut){let e=arguments[0];this.addShell(e.getExteriorRing().getCoordinates());for(var t=0;t<e.getNumInteriorRing();t++)this.addHole(e.getInteriorRingN(t).getCoordinates())}else if(arguments[0]instanceof W){let n=arguments[0];if(n.isEmpty())return null;if(n instanceof jt)this.addPoint(n.getCoordinate());else if(n instanceof Ft)this.addLineSegments(n.getCoordinates());else if(n instanceof Ut){var e=n;this.add(e)}else if(n instanceof Et){var r=n;for(t=0;t<r.getNumGeometries();t++)this.add(r.getGeometryN(t))}}}getClass(){return Ze}get interfaces_(){return[]}}function Ke(t){this.message=t||""}function $e(){this.array_=[]}Ze.constructor_=function(){this._areaBasePt=null,this._triangleCent3=new _,this._areasum2=0,this._cg3=new _,this._lineCentSum=new _,this._totalLength=0,this._ptCount=0,this._ptCentSum=new _;let t=arguments[0];this._areaBasePt=null,this.add(t)},Ke.prototype=new Error,Ke.prototype.name="EmptyStackException",$e.prototype=new S,$e.prototype.add=function(t){return this.array_.push(t),!0},$e.prototype.get=function(t){if(t<0||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},$e.prototype.push=function(t){return this.array_.push(t),t},$e.prototype.pop=function(t){if(0===this.array_.length)throw new Ke;return this.array_.pop()},$e.prototype.peek=function(){if(0===this.array_.length)throw new Ke;return this.array_[this.array_.length-1]},$e.prototype.empty=function(){return 0===this.array_.length},$e.prototype.isEmpty=function(){return this.empty()},$e.prototype.search=function(t){return this.array_.indexOf(t)},$e.prototype.size=function(){return this.array_.length},$e.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t};class Je{constructor(){Je.constructor_.apply(this,arguments)}static filterCoordinates(t){for(var e=new Je,r=0;r<t.length;r++)e.filter(t[r]);return e.getCoordinates()}filter(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))}getCoordinates(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)}getClass(){return Je}get interfaces_(){return[X]}}Je.constructor_=function(){this.treeSet=new yt,this.list=new C};class Qe{constructor(){Qe.constructor_.apply(this,arguments)}static extractCoordinates(t){var e=new Je;return t.apply(e),e.getCoordinates()}preSort(t){for(var e=null,r=1;r<t.length;r++)(t[r].y<t[0].y||t[r].y===t[0].y&&t[r].x<t[0].x)&&(e=t[0],t[0]=t[r],t[r]=e);return vt.sort(t,1,t.length,new tr(t[0])),t}computeOctRing(t){var e=this.computeOctPts(t),r=new P;return r.add(e,!1),r.size()<3?null:(r.closeRing(),r.toCoordinateArray())}lineOrPolygon(t){if(3===(t=this.cleanRing(t)).length)return this._geomFactory.createLineString([t[0],t[1]]);var e=this._geomFactory.createLinearRing(t);return this._geomFactory.createPolygon(e)}cleanRing(t){m.equals(t[0],t[t.length-1]);for(var e=new C,r=null,n=0;n<=t.length-2;n++){var i=t[n],o=t[n+1];i.equals(o)||null!==r&&this.isBetween(r,i,o)||(e.add(i),r=i)}e.add(t[t.length-1]);var s=new Array(e.size()).fill(null);return e.toArray(s)}isBetween(t,e,r){if(0!==j.index(t,e,r))return!1;if(t.x!==r.x){if(t.x<=e.x&&e.x<=r.x)return!0;if(r.x<=e.x&&e.x<=t.x)return!0}if(t.y!==r.y){if(t.y<=e.y&&e.y<=r.y)return!0;if(r.y<=e.y&&e.y<=t.y)return!0}return!1}reduce(t){var e=this.computeOctRing(t);if(null===e)return t;for(var r=new yt,n=0;n<e.length;n++)r.add(e[n]);for(n=0;n<t.length;n++)ze.isInRing(t[n],e)||r.add(t[n]);var i=Q.toCoordinateArray(r);return i.length<3?this.padArray3(i):i}getConvexHull(){if(0===this._inputPts.length)return this._geomFactory.createGeometryCollection();if(1===this._inputPts.length)return this._geomFactory.createPoint(this._inputPts[0]);if(2===this._inputPts.length)return this._geomFactory.createLineString(this._inputPts);var t=this._inputPts;this._inputPts.length>50&&(t=this.reduce(this._inputPts));var e=this.preSort(t),r=this.grahamScan(e),n=this.toCoordinateArray(r);return this.lineOrPolygon(n)}padArray3(t){for(var e=new Array(3).fill(null),r=0;r<e.length;r++)r<t.length?e[r]=t[r]:e[r]=t[0];return e}computeOctPts(t){for(var e=new Array(8).fill(null),r=0;r<e.length;r++)e[r]=t[0];for(var n=1;n<t.length;n++)t[n].x<e[0].x&&(e[0]=t[n]),t[n].x-t[n].y<e[1].x-e[1].y&&(e[1]=t[n]),t[n].y>e[2].y&&(e[2]=t[n]),t[n].x+t[n].y>e[3].x+e[3].y&&(e[3]=t[n]),t[n].x>e[4].x&&(e[4]=t[n]),t[n].x-t[n].y>e[5].x-e[5].y&&(e[5]=t[n]),t[n].y<e[6].y&&(e[6]=t[n]),t[n].x+t[n].y<e[7].x+e[7].y&&(e[7]=t[n]);return e}toCoordinateArray(t){for(var e=new Array(t.size()).fill(null),r=0;r<t.size();r++){var n=t.get(r);e[r]=n}return e}grahamScan(t){var e=null,r=new $e;r.push(t[0]),r.push(t[1]),r.push(t[2]);for(var n=3;n<t.length;n++){for(e=r.pop();!r.empty()&&j.index(r.peek(),e,t[n])>0;)e=r.pop();r.push(e),r.push(t[n])}return r.push(t[0]),r}getClass(){return Qe}get interfaces_(){return[]}}class tr{constructor(){tr.constructor_.apply(this,arguments)}static polarCompare(t,e,r){var n=e.x-t.x,i=e.y-t.y,o=r.x-t.x,s=r.y-t.y,a=j.index(t,e,r);if(a===j.COUNTERCLOCKWISE)return 1;if(a===j.CLOCKWISE)return-1;var l=n*n+i*i,u=o*o+s*s;return l<u?-1:l>u?1:0}compare(t,e){var r=t,n=e;return tr.polarCompare(this._origin,r,n)}getClass(){return tr}get interfaces_(){return[p]}}tr.constructor_=function(){this._origin=null;let t=arguments[0];this._origin=t},Qe.RadialComparator=tr,Qe.constructor_=function(){if(this._geomFactory=null,this._inputPts=null,1===arguments.length){let t=arguments[0];Qe.constructor_.call(this,Qe.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputPts=Je.filterCoordinates(t),this._geomFactory=e}};class er{constructor(){er.constructor_.apply(this,arguments)}static centre(t){return new _(er.avg(t.getMinX(),t.getMaxX()),er.avg(t.getMinY(),t.getMaxY()))}static avg(t,e){return(t+e)/2}addPolygon(t){if(t.isEmpty())return null;var e=null,r=null,n=this.horizontalBisector(t);if(0===n.getLength())r=0,e=n.getCoordinate();else{var i=n.intersection(t),o=this.widestGeometry(i);r=o.getEnvelopeInternal().getWidth(),e=er.centre(o.getEnvelopeInternal())}(null===this._interiorPoint||r>this._maxWidth)&&(this._interiorPoint=e,this._maxWidth=r)}getInteriorPoint(){return this._interiorPoint}widestGeometry(){if(arguments[0]instanceof Et){let r=arguments[0];if(r.isEmpty())return r;for(var t=r.getGeometryN(0),e=1;e<r.getNumGeometries();e++)r.getGeometryN(e).getEnvelopeInternal().getWidth()>t.getEnvelopeInternal().getWidth()&&(t=r.getGeometryN(e));return t}if(arguments[0]instanceof W){let t=arguments[0];return t instanceof Et?this.widestGeometry(t):t}}horizontalBisector(t){var e=t.getEnvelopeInternal(),r=rr.getBisectorY(t);return this._factory.createLineString([new _(e.getMinX(),r),new _(e.getMaxX(),r)])}add(t){if(t instanceof Ut)this.addPolygon(t);else if(t instanceof Et)for(var e=t,r=0;r<e.getNumGeometries();r++)this.add(e.getGeometryN(r))}getClass(){return er}get interfaces_(){return[]}}class rr{constructor(){rr.constructor_.apply(this,arguments)}static getBisectorY(t){return new rr(t).getBisectorY()}updateInterval(t){t<=this._centreY?t>this._loY&&(this._loY=t):t>this._centreY&&t<this._hiY&&(this._hiY=t)}getBisectorY(){this.process(this._poly.getExteriorRing());for(var t=0;t<this._poly.getNumInteriorRing();t++)this.process(this._poly.getInteriorRingN(t));return er.avg(this._hiY,this._loY)}process(t){for(var e=t.getCoordinateSequence(),r=0;r<e.size();r++){var n=e.getY(r);this.updateInterval(n)}}getClass(){return rr}get interfaces_(){return[]}}rr.constructor_=function(){this._poly=null,this._centreY=null,this._hiY=i.MAX_VALUE,this._loY=-i.MAX_VALUE;let t=arguments[0];this._poly=t,this._hiY=t.getEnvelopeInternal().getMaxY(),this._loY=t.getEnvelopeInternal().getMinY(),this._centreY=er.avg(this._loY,this._hiY)},er.SafeBisectorFinder=rr,er.constructor_=function(){this._factory=null,this._interiorPoint=null,this._maxWidth=0;let t=arguments[0];this._factory=t.getFactory(),this.add(t)};class nr{constructor(){nr.constructor_.apply(this,arguments)}addEndpoints(){if(arguments[0]instanceof W){let r=arguments[0];if(r instanceof Ft)this.addEndpoints(r.getCoordinates());else if(r instanceof Et)for(var t=r,e=0;e<t.getNumGeometries();e++)this.addEndpoints(t.getGeometryN(e))}else if(arguments[0]instanceof Array){let t=arguments[0];this.add(t[0]),this.add(t[t.length-1])}}getInteriorPoint(){return this._interiorPoint}addInterior(){if(arguments[0]instanceof W){let r=arguments[0];if(r instanceof Ft)this.addInterior(r.getCoordinates());else if(r instanceof Et)for(var t=r,e=0;e<t.getNumGeometries();e++)this.addInterior(t.getGeometryN(e))}else if(arguments[0]instanceof Array){let t=arguments[0];for(e=1;e<t.length-1;e++)this.add(t[e])}}add(t){var e=t.distance(this._centroid);e<this._minDistance&&(this._interiorPoint=new _(t),this._minDistance=e)}getClass(){return nr}get interfaces_(){return[]}}nr.constructor_=function(){this._centroid=null,this._minDistance=i.MAX_VALUE,this._interiorPoint=null;let t=arguments[0];this._centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this._interiorPoint&&this.addEndpoints(t)};class ir{constructor(){ir.constructor_.apply(this,arguments)}getInteriorPoint(){return this._interiorPoint}add(){if(arguments[0]instanceof W){let r=arguments[0];if(r instanceof jt)this.add(r.getCoordinate());else if(r instanceof Et)for(var t=r,e=0;e<t.getNumGeometries();e++)this.add(t.getGeometryN(e))}else if(arguments[0]instanceof _){let t=arguments[0];var r=t.distance(this._centroid);r<this._minDistance&&(this._interiorPoint=new _(t),this._minDistance=r)}}getClass(){return ir}get interfaces_(){return[]}}ir.constructor_=function(){this._centroid=null,this._minDistance=i.MAX_VALUE,this._interiorPoint=null;let t=arguments[0];this._centroid=t.getCentroid().getCoordinate(),this.add(t)};class or{constructor(){or.constructor_.apply(this,arguments)}static pointWitMinAngleWithX(t,e){for(var r=i.MAX_VALUE,n=null,o=0;o<t.length;o++){var s=t[o];if(s!==e){var a=s.x-e.x,l=s.y-e.y;l<0&&(l=-l);var u=l/Math.sqrt(a*a+l*l);u<r&&(r=u,n=s)}}return n}static lowestPoint(t){for(var e=t[0],r=1;r<t.length;r++)t[r].y<e.y&&(e=t[r]);return e}static pointWithMinAngleWithSegment(t,e,r){for(var n=i.MAX_VALUE,o=null,s=0;s<t.length;s++){var a=t[s];if(a!==e&&a!==r){var l=me.angleBetween(e,a,r);l<n&&(n=l,o=a)}}return o}getRadius(){return this.compute(),this._radius}getDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[1];return this._input.getFactory().createLineString([t,e])}getExtremalPoints(){return this.compute(),this._extremalPts}computeCirclePoints(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(1===this._input.getNumPoints()){var t=this._input.getCoordinates();return this._extremalPts=[new _(t[0])],null}var e=this._input.convexHull().getCoordinates();if(t=e,e[0].equals2D(e[e.length-1])&&(t=new Array(e.length-1).fill(null),Q.copyDeep(e,0,t,0,e.length-1)),t.length<=2)return this._extremalPts=Q.copyDeep(t),null;for(var r=or.lowestPoint(t),n=or.pointWitMinAngleWithX(t,r),i=0;i<t.length;i++){var o=or.pointWithMinAngleWithSegment(t,r,n);if(me.isObtuse(r,o,n))return this._extremalPts=[new _(r),new _(n)],null;if(me.isObtuse(o,r,n))r=o;else{if(!me.isObtuse(o,n,r))return this._extremalPts=[new _(r),new _(n),new _(o)],null;n=o}}m.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}compute(){if(null!==this._extremalPts)return null;this.computeCirclePoints(),this.computeCentre(),null!==this._centre&&(this._radius=this._centre.distance(this._extremalPts[0]))}getFarthestPoints(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[this._extremalPts.length-1];return this._input.getFactory().createLineString([t,e])}getCircle(){if(this.compute(),null===this._centre)return this._input.getFactory().createPolygon();var t=this._input.getFactory().createPoint(this._centre);return 0===this._radius?t:t.buffer(this._radius)}getCentre(){return this.compute(),this._centre}computeCentre(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new _((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=_e.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}getClass(){return or}get interfaces_(){return[]}}or.constructor_=function(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;let t=arguments[0];this._input=t};class sr{constructor(){sr.constructor_.apply(this,arguments)}static nextIndex(t,e){return++e>=t.length&&(e=0),e}static computeC(t,e,r){return t*r.y-e*r.x}static getMinimumDiameter(t){return new sr(t).getDiameter()}static getMinimumRectangle(t){return new sr(t).getMinimumRectangle()}static computeSegmentForLine(t,e,r){var n=null,i=null;return Math.abs(e)>Math.abs(t)?(n=new _(0,r/e),i=new _(1,r/e-t/e)):(n=new _(r/t,0),i=new _(r/t-e/t,1)),new de(n,i)}getWidthCoordinate(){return this.computeMinimumDiameter(),this._minWidthPt}getSupportingSegment(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}getDiameter(){if(this.computeMinimumDiameter(),null===this._minWidthPt)return this._inputGeom.getFactory().createLineString();var t=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([t,this._minWidthPt])}computeWidthConvex(t){this._convexHullPts=t instanceof Ut?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):1===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):2===this._convexHullPts.length||3===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}computeConvexRingMinDiameter(t){this._minWidth=i.MAX_VALUE;for(var e=1,r=new de,n=0;n<t.length-1;n++)r.p0=t[n],r.p1=t[n+1],e=this.findMaxPerpDistance(t,r,e)}computeMinimumDiameter(){if(null!==this._minWidthPt)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{var t=new Qe(this._inputGeom).getConvexHull();this.computeWidthConvex(t)}}getLength(){return this.computeMinimumDiameter(),this._minWidth}findMaxPerpDistance(t,e,r){for(var n=e.distancePerpendicular(t[r]),i=n,o=r,s=o;i>=n;)n=i,o=s,s=sr.nextIndex(t,o),i=e.distancePerpendicular(t[s]);return n<this._minWidth&&(this._minPtIndex=o,this._minWidth=n,this._minWidthPt=t[this._minPtIndex],this._minBaseSeg=new de(e)),o}getMinimumRectangle(){if(this.computeMinimumDiameter(),0===this._minWidth)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());for(var t=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,e=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y,r=i.MAX_VALUE,n=-i.MAX_VALUE,o=i.MAX_VALUE,s=-i.MAX_VALUE,a=0;a<this._convexHullPts.length;a++){var l=sr.computeC(t,e,this._convexHullPts[a]);l>n&&(n=l),l<r&&(r=l);var u=sr.computeC(-e,t,this._convexHullPts[a]);u>s&&(s=u),u<o&&(o=u)}var c=sr.computeSegmentForLine(-t,-e,s),h=sr.computeSegmentForLine(-t,-e,o),f=sr.computeSegmentForLine(-e,t,n),p=sr.computeSegmentForLine(-e,t,r),d=f.lineIntersection(c),g=p.lineIntersection(c),y=p.lineIntersection(h),m=f.lineIntersection(h),_=this._inputGeom.getFactory().createLinearRing([d,g,y,m,d]);return this._inputGeom.getFactory().createPolygon(_)}getClass(){return sr}get interfaces_(){return[]}}sr.constructor_=function(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new de,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,1===arguments.length){let t=arguments[0];sr.constructor_.call(this,t,!1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputGeom=t,this._isConvex=e}};var ar=Object.freeze({distance:Ie,locate:Ve,match:He,Angle:me,Area:Gt,Centroid:Ze,ConvexHull:Qe,Distance:B,InteriorPointArea:er,InteriorPointLine:nr,InteriorPointPoint:ir,Length:Ct,Orientation:j,PointLocation:ze,RobustLineIntersector:pe,MinimumBoundingCircle:or,MinimumDiameter:sr});class lr{constructor(){lr.constructor_.apply(this,arguments)}transformPoint(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}transformPolygon(t,e){var r=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof Vt&&!n.isEmpty()||(r=!1);for(var i=new C,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof Vt||(r=!1),i.add(s))}if(r)return this._factory.createPolygon(n,i.toArray([]));var a=new C;return null!==n&&a.add(n),a.addAll(i),this._factory.buildGeometry(a)}createCoordinateSequence(t){return this._factory.getCoordinateSequenceFactory().create(t)}getInputGeometry(){return this._inputGeom}transformMultiLineString(t,e){for(var r=new C,n=0;n<t.getNumGeometries();n++){var i=this.transformLineString(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)}transformCoordinates(t,e){return this.copy(t)}transformLineString(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}transformMultiPoint(t,e){for(var r=new C,n=0;n<t.getNumGeometries();n++){var i=this.transformPoint(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)}transformMultiPolygon(t,e){for(var r=new C,n=0;n<t.getNumGeometries();n++){var i=this.transformPolygon(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||r.add(i))}return this._factory.buildGeometry(r)}copy(t){return t.copy()}transformGeometryCollection(t,e){for(var r=new C,n=0;n<t.getNumGeometries();n++){var i=this.transform(t.getGeometryN(n));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||r.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(se.toGeometryArray(r)):this._factory.buildGeometry(r)}transform(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof jt)return this.transformPoint(t,null);if(t instanceof Bt)return this.transformMultiPoint(t,null);if(t instanceof Vt)return this.transformLinearRing(t,null);if(t instanceof Ft)return this.transformLineString(t,null);if(t instanceof St)return this.transformMultiLineString(t,null);if(t instanceof Ut)return this.transformPolygon(t,null);if(t instanceof qt)return this.transformMultiPolygon(t,null);if(t instanceof Et)return this.transformGeometryCollection(t,null);throw new r("Unknown Geometry subtype: "+t.getClass().getName())}transformLinearRing(t,e){var r=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===r)return this._factory.createLinearRing(null);var n=r.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)}getClass(){return lr}get interfaces_(){return[]}}lr.constructor_=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};class ur{constructor(){ur.constructor_.apply(this,arguments)}static densifyPoints(t,e,r){for(var n=new de,i=new P,o=0;o<t.length-1;o++){n.p0=t[o],n.p1=t[o+1],i.add(n.p0,!1);var s=n.getLength(),a=Math.trunc(s/e)+1;if(a>1)for(var l=s/a,u=1;u<a;u++){var c=u*l/s,h=n.pointAlong(c);r.makePrecise(h),i.add(h,!1)}}return i.add(t[t.length-1],!1),i.toCoordinateArray()}static densify(t,e){var r=new ur(t);return r.setDistanceTolerance(e),r.getResultGeometry()}getResultGeometry(){return new cr(this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<=0)throw new r("Tolerance must be positive");this._distanceTolerance=t}getClass(){return ur}get interfaces_(){return[]}}class cr extends lr{constructor(){super(),cr.constructor_.apply(this,arguments)}transformMultiPolygon(t,e){var r=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(r)}transformPolygon(t,e){var r=super.transformPolygon.call(this,t,e);return e instanceof qt?r:this.createValidArea(r)}transformCoordinates(t,e){var r=t.toCoordinateArray(),n=ur.densifyPoints(r,this.distanceTolerance,e.getPrecisionModel());return e instanceof Ft&&1===n.length&&(n=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(n)}createValidArea(t){return t.buffer(0)}getClass(){return cr}get interfaces_(){return[]}}cr.constructor_=function(){this.distanceTolerance=null;let t=arguments[0];this.distanceTolerance=t},ur.DensifyTransformer=cr,ur.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null;let t=arguments[0];this._inputGeom=t};var hr=Object.freeze({Densifier:ur});class fr{constructor(){fr.constructor_.apply(this,arguments)}static isNorthern(t){return t===fr.NE||t===fr.NW}static isOpposite(t,e){return t!==e&&2==(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var r=t<e?t:e;return 0===r&&3===(t>e?t:e)?3:r}static isInHalfPlane(t,e){return e===fr.SE?t===fr.SE||t===fr.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new r("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?fr.NE:fr.SE:e>=0?fr.NW:fr.SW}if(arguments[0]instanceof _&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new r("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?fr.NE:fr.SE:e.y>=t.y?fr.NW:fr.SW}}getClass(){return fr}get interfaces_(){return[]}}fr.constructor_=function(){},fr.NE=0,fr.NW=1,fr.SW=2,fr.SE=3;class pr{constructor(){pr.constructor_.apply(this,arguments)}static init(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t}static create(t,e){var r=new pr(t),n=new pr(e);return r.init(n),r}find(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null}dest(){return this._sym._orig}oNext(){return this._sym._next}insert(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),r=this;do{var n=r.oNext();if(n.compareTo(t)!==e||n===this)return r.insertAfter(t),null;r=n}while(r!==this);m.shouldNeverReachHere()}insertAfter(t){m.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)}degree(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t}equals(){if(2===arguments.length&&arguments[1]instanceof _&&arguments[0]instanceof _){let t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}}deltaY(){return this._sym._orig.y-this._orig.y}sym(){return this._sym}prev(){return this._sym.next()._sym}compareAngularDirection(t){var e=this.deltaX(),r=this.deltaY(),n=t.deltaX(),i=t.deltaY();if(e===n&&r===i)return 0;var o=fr.quadrant(e,r),s=fr.quadrant(n,i);return o>s?1:o<s?-1:j.index(t._orig,t.dest(),this.dest())}prevNode(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t}compareTo(t){var e=t;return this.compareAngularDirection(e)}next(){return this._next}setSym(t){this._sym=t}orig(){return this._orig}toString(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}setNext(t){this._next=t}init(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)}deltaX(){return this._sym._orig.x-this._orig.x}getClass(){return pr}get interfaces_(){return[]}}pr.constructor_=function(){this._orig=null,this._sym=null,this._next=null;let t=arguments[0];this._orig=t};class dr extends pr{constructor(){super(),dr.constructor_.apply(this,arguments)}static setMarkBoth(t,e){t.setMark(e),t.sym().setMark(e)}static isMarked(t){return t.isMarked()}static setMark(t,e){t.setMark(e)}static markBoth(t){t.mark(),t.sym().mark()}static mark(t){t.mark()}mark(){this._isMarked=!0}setMark(t){this._isMarked=t}isMarked(){return this._isMarked}getClass(){return dr}get interfaces_(){return[]}}dr.constructor_=function(){this._isMarked=!1;let t=arguments[0];pr.constructor_.call(this,t)};class gr{constructor(){gr.constructor_.apply(this,arguments)}static isValidEdge(t,e){return 0!==e.compareTo(t)}insert(t,e,r){var n=this.create(t,e);null!==r?r.insert(n):this._vertexMap.put(t,n);var i=this._vertexMap.get(e);return null!==i?i.insert(n.sym()):this._vertexMap.put(e,n.sym()),n}create(t,e){var r=this.createEdge(t),n=this.createEdge(e);return pr.init(r,n),r}createEdge(t){return new pr(t)}addEdge(t,e){if(!gr.isValidEdge(t,e))return null;var r=this._vertexMap.get(t),n=null;return null!==r&&(n=r.find(e)),null!==n?n:this.insert(t,e,r)}getVertexEdges(){return this._vertexMap.values()}findEdge(t,e){var r=this._vertexMap.get(t);return null===r?null:r.find(e)}getClass(){return gr}get interfaces_(){return[]}}gr.constructor_=function(){this._vertexMap=new ne};class yr extends dr{constructor(){super(),yr.constructor_.apply(this,arguments)}setStart(){this._isStart=!0}isStart(){return this._isStart}getClass(){return yr}get interfaces_(){return[]}}yr.constructor_=function(){this._isStart=!1;let t=arguments[0];dr.constructor_.call(this,t)};class mr extends gr{constructor(){super(),mr.constructor_.apply(this,arguments)}createEdge(t){return new yr(t)}getClass(){return mr}get interfaces_(){return[]}}mr.constructor_=function(){};class _r{constructor(){_r.constructor_.apply(this,arguments)}static dissolve(t){var e=new _r;return e.add(t),e.getResult()}addLine(t){this._lines.add(this._factory.createLineString(t.toCoordinateArray()))}updateRingStartEdge(t){return t.isStart()||(t=t.sym()).isStart()?null===this._ringStartEdge?(this._ringStartEdge=t,null):void(t.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=t)):null}getResult(){return null===this._result&&this.computeResult(),this._result}process(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()}buildRing(t){var e=new P,r=t;for(e.add(r.orig().copy(),!1);2===r.sym().degree();){var n=r.next();if(n===t)break;e.add(n.orig().copy(),!1),r=n}e.add(r.dest().copy(),!1),this.addLine(e)}buildLine(t){var e=new P,r=t;for(this._ringStartEdge=null,dr.markBoth(r),e.add(r.orig().copy(),!1);2===r.sym().degree();){this.updateRingStartEdge(r);var n=r.next();if(n===t)return this.buildRing(this._ringStartEdge),null;e.add(n.orig().copy(),!1),r=n,dr.markBoth(r)}e.add(r.dest().clone(),!1),this.stackEdges(r.sym()),this.addLine(e)}stackEdges(t){var e=t;do{dr.isMarked(e)||this._nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)}computeResult(){for(var t=this._graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();dr.isMarked(e)||this.process(e)}this._result=this._factory.buildGeometry(this._lines)}buildLines(){for(;!this._nodeEdgeStack.empty();){var t=this._nodeEdgeStack.pop();dr.isMarked(t)||this.buildLine(t)}}add(){if(arguments[0]instanceof W)arguments[0].apply(new class{get interfaces_(){return[Y]}filter(t){t instanceof Ft&&this.add(t)}});else if(b(arguments[0],x))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){let e=arguments[0];null===this._factory&&(this._factory=e.getFactory());var r=e.getCoordinateSequence(),n=!1;for(t=1;t<r.size();t++){var i=this._graph.addEdge(r.getCoordinate(t-1),r.getCoordinate(t));null!==i&&(n||(i.setStart(),n=!0))}}}getClass(){return _r}get interfaces_(){return[]}}_r.constructor_=function(){this._result=null,this._factory=null,this._graph=null,this._lines=new C,this._nodeEdgeStack=new $e,this._ringStartEdge=null,this._graph=new mr};var vr=Object.freeze({LineDissolver:_r});class br{constructor(){br.constructor_.apply(this,arguments)}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?ze.locateInRing(t,e.getCoordinates()):ge.EXTERIOR}intersects(t,e){return this.locate(t,e)!==ge.EXTERIOR}updateLocationInfo(t){t===ge.INTERIOR&&(this._isIn=!0),t===ge.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof jt&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof Ft)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof Ut)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof St)for(var r=e,n=0;n<r.getNumGeometries();n++){var i=r.getGeometryN(n);this.updateLocationInfo(this.locateOnLineString(t,i))}else if(e instanceof qt){var o=e;for(n=0;n<o.getNumGeometries();n++){var s=o.getGeometryN(n);this.updateLocationInfo(this.locateInPolygon(t,s))}}else if(e instanceof Et)for(var a=new Ue(e);a.hasNext();){var l=a.next();l!==e&&this.computeLocation(t,l)}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?ge.INTERIOR:ge.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return ge.EXTERIOR;var r=e.getCoordinateSequence();return e.isClosed()||!t.equals(r.getCoordinate(0))&&!t.equals(r.getCoordinate(r.size()-1))?ze.isOnLine(t,r)?ge.INTERIOR:ge.EXTERIOR:ge.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return ge.EXTERIOR;var r=e.getExteriorRing(),n=this.locateInPolygonRing(t,r);if(n===ge.EXTERIOR)return ge.EXTERIOR;if(n===ge.BOUNDARY)return ge.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=this.locateInPolygonRing(t,o);if(s===ge.INTERIOR)return ge.EXTERIOR;if(s===ge.BOUNDARY)return ge.BOUNDARY}return ge.INTERIOR}locate(t,e){return e.isEmpty()?ge.EXTERIOR:e instanceof Ft?this.locateOnLineString(t,e):e instanceof Ut?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?ge.BOUNDARY:this._numBoundaries>0||this._isIn?ge.INTERIOR:ge.EXTERIOR)}getClass(){return br}get interfaces_(){return[]}}br.constructor_=function(){if(this._boundaryRule=H.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];if(null===t)throw new r("Rule must be non-null");this._boundaryRule=t}};class wr{constructor(){wr.constructor_.apply(this,arguments)}static opposite(t){return t===wr.LEFT?wr.RIGHT:t===wr.RIGHT?wr.LEFT:t}getClass(){return wr}get interfaces_(){return[]}}wr.constructor_=function(){},wr.ON=0,wr.LEFT=1,wr.RIGHT=2;class xr{constructor(){xr.constructor_.apply(this,arguments)}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}getClass(){return xr}get interfaces_(){return[]}}xr.constructor_=function(){this.mce=null,this.chainIndex=null;let t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};class Er{constructor(){Er.constructor_.apply(this,arguments)}isDelete(){return this._eventType===Er.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===Er.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}getClass(){return Er}get interfaces_(){return[h]}}Er.constructor_=function(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._eventType=Er.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._eventType=Er.INSERT,this._label=t,this._xValue=e,this._obj=r}},Er.INSERT=1,Er.DELETE=2;class Sr{constructor(){Sr.constructor_.apply(this,arguments)}getClass(){return Sr}get interfaces_(){return[]}}Sr.constructor_=function(){};class Ir{constructor(){Ir.constructor_.apply(this,arguments)}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,r,n){if(t===r&&1===this._li.getIntersectionNum()){if(Ir.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(var r=e.iterator();r.hasNext();){var n=r.next().getCoordinate();if(t.isIntersection(n))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,r,n){if(t===r&&e===n)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=r.getCoordinates()[n],a=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,r,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),r.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}getClass(){return Ir}get interfaces_(){return[]}}Ir.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;let t=arguments[0],e=arguments[1],r=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=r};class Or extends Sr{constructor(){super(),Or.constructor_.apply(this,arguments)}prepareEvents(){Le.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){let r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var t=0;t<this.events.size();t++){var e=this.events.get(t);if(e.isInsert()&&this.processOverlaps(t,e.getDeleteEventIndex(),e,r),r.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Ir&&b(arguments[0],S)&&b(arguments[1],S)){let t=arguments[0],e=arguments[1],r=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(r)}else if("boolean"==typeof arguments[2]&&b(arguments[0],S)&&arguments[1]instanceof Ir){let t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){for(var r=t.getMonotoneChainEdge(),n=r.getStartIndexes(),i=0;i<n.length-1;i++){var o=new xr(r,i),s=new Er(e,r.getMinX(i),o);this.events.add(s),this.events.add(new Er(r.getMaxX(i),s))}}processOverlaps(t,e,r,n){for(var i=r.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();r.isSameLabel(s)||(i.computeIntersections(a,n),this.nOverlaps++)}}}addEdges(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length){let r=arguments[1];for(t=arguments[0].iterator();t.hasNext();)e=t.next(),this.addEdge(e,r)}}getClass(){return Or}get interfaces_(){return[]}}Or.constructor_=function(){this.events=new C,this.nOverlaps=null};class Cr{constructor(){Cr.constructor_.apply(this,arguments)}setAllLocations(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==ge.NONE)return!1;return!0}setAllLocationsIfNull(t){for(var e=0;e<this.location.length;e++)this.location[e]===ge.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[wr.ON]=this.location[wr.ON],e[wr.LEFT]=ge.NONE,e[wr.RIGHT]=ge.NONE,this.location=e}for(var r=0;r<this.location.length;r++)this.location[r]===ge.NONE&&r<t.location.length&&(this.location[r]=t.location[r])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;var t=this.location[wr.LEFT];this.location[wr.LEFT]=this.location[wr.RIGHT],this.location[wr.RIGHT]=t}toString(){var t=new k;return this.location.length>1&&t.append(ge.toLocationSymbol(this.location[wr.LEFT])),t.append(ge.toLocationSymbol(this.location[wr.ON])),this.location.length>1&&t.append(ge.toLocationSymbol(this.location[wr.RIGHT])),t.toString()}setLocations(t,e,r){this.location[wr.ON]=t,this.location[wr.LEFT]=e,this.location[wr.RIGHT]=r}get(t){return t<this.location.length?this.location[t]:ge.NONE}isArea(){return this.location.length>1}isAnyNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]===ge.NONE)return!0;return!1}setLocation(){if(1===arguments.length){let t=arguments[0];this.setLocation(wr.ON,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(ge.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}getClass(){return Cr}get interfaces_(){return[]}}Cr.constructor_=function(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){let t=arguments[0];this.init(1),this.location[wr.ON]=t}else if(arguments[0]instanceof Cr){let e=arguments[0];if(this.init(e.location.length),null!==e)for(var t=0;t<this.location.length;t++)this.location[t]=e.location[t]}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.init(3),this.location[wr.ON]=t,this.location[wr.LEFT]=e,this.location[wr.RIGHT]=r}};class Tr{constructor(){Tr.constructor_.apply(this,arguments)}static toLineLabel(t){for(var e=new Tr(ge.NONE),r=0;r<2;r++)e.setLocation(r,t.getLocation(r));return e}getGeometryCount(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){let t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Cr(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){let t=arguments[0];return this.elt[t].get(wr.ON)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){var t=new k;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){let t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setLocation(wr.ON,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.elt[t].setLocation(e,r)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new Cr(this.elt[t].location[0]))}getClass(){return Tr}get interfaces_(){return[]}}Tr.constructor_=function(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){let t=arguments[0];this.elt[0]=new Cr(t),this.elt[1]=new Cr(t)}else if(arguments[0]instanceof Tr){let t=arguments[0];this.elt[0]=new Cr(t.elt[0]),this.elt[1]=new Cr(t.elt[1])}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[0]=new Cr(ge.NONE),this.elt[1]=new Cr(ge.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.elt[0]=new Cr(t,e,r),this.elt[1]=new Cr(t,e,r)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.elt[0]=new Cr(ge.NONE,ge.NONE,ge.NONE),this.elt[1]=new Cr(ge.NONE,ge.NONE,ge.NONE),this.elt[t].setLocations(e,r,n)}};class Pr{constructor(){Pr.constructor_.apply(this,arguments)}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){var e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}getClass(){return Pr}get interfaces_(){return[h]}}Pr.constructor_=function(){this.coord=null,this.segmentIndex=null,this.dist=null;let t=arguments[0],e=arguments[1],r=arguments[2];this.coord=new _(t),this.segmentIndex=e,this.dist=r};class Rr{constructor(){Rr.constructor_.apply(this,arguments)}print(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();for(var e=this.iterator(),r=e.next();e.hasNext();){var n=e.next(),i=this.createSplitEdge(r,n);t.add(i),r=n}}addEndpoints(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){var r=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(n);i||r--;var o=new Array(r).fill(null),s=0;o[s++]=new _(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return i&&(o[s]=e.coord),new Ar(o,new Tr(this.edge._label))}add(t,e,r){var n=new Pr(t,e,r),i=this._nodeMap.get(n);return null!==i?i:(this._nodeMap.put(n,n),n)}isIntersection(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}getClass(){return Rr}get interfaces_(){return[]}}Rr.constructor_=function(){this._nodeMap=new pt,this.edge=null;let t=arguments[0];this.edge=t};class Lr{constructor(){Lr.constructor_.apply(this,arguments)}static toIntArray(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e}getChainStartIndices(t){var e=0,r=new C;r.add(new N(e));do{var n=this.findChainEnd(t,e);r.add(new N(n)),e=n}while(e<t.length-1);return Lr.toIntArray(r)}findChainEnd(t,e){for(var r=fr.quadrant(t[e],t[e+1]),n=e+1;n<t.length&&fr.quadrant(t[n-1],t[n])===r;)n++;return n-1}getClass(){return Lr}get interfaces_(){return[]}}Lr.constructor_=function(){};class Mr{constructor(){Mr.constructor_.apply(this,arguments)}getCoordinates(){return this.pts}getMaxX(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e>r?e:r}getMinX(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e<r?e:r}computeIntersectsForChain(){if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[r],e.startIndex[r+1],n)}else if(6===arguments.length){let r=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3],s=arguments[4],a=arguments[5];if(n-r==1&&s-o==1)return a.addIntersections(this.e,r,i.e,o),null;if(!this.overlaps(r,n,i,o,s))return null;var t=Math.trunc((r+n)/2),e=Math.trunc((o+s)/2);r<t&&(o<e&&this.computeIntersectsForChain(r,t,i,o,e,a),e<s&&this.computeIntersectsForChain(r,t,i,e,s,a)),t<n&&(o<e&&this.computeIntersectsForChain(t,n,i,o,e,a),e<s&&this.computeIntersectsForChain(t,n,i,e,s,a))}}overlaps(t,e,r,n,i){return R.intersects(this.pts[t],this.pts[e],r.pts[n],r.pts[i])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(var r=0;r<this.startIndex.length-1;r++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(r,t,n,e)}getClass(){return Mr}get interfaces_(){return[]}}Mr.constructor_=function(){this.e=null,this.pts=null,this.startIndex=null;let t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Lr;this.startIndex=e.getChainStartIndices(this.pts)};class kr{constructor(){kr.constructor_.apply(this,arguments)}static depthAtLocation(t){return t===ge.EXTERIOR?0:t===ge.INTERIOR?1:kr.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,r){this._depth[t][e]=r}isNull(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==kr.NULL_VALUE)return!1;return!0}if(1===arguments.length){let t=arguments[0];return this._depth[t][1]===kr.NULL_VALUE}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this._depth[t][e]===kr.NULL_VALUE}}normalize(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var r=1;r<3;r++){var n=0;this._depth[t][r]>e&&(n=1),this._depth[t][r]=n}}}getDelta(t){return this._depth[t][wr.RIGHT]-this._depth[t][wr.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?ge.EXTERIOR:ge.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<2;t++)for(var e=1;e<3;e++){var r=n.getLocation(t,e);r!==ge.EXTERIOR&&r!==ge.INTERIOR||(this.isNull(t,e)?this._depth[t][e]=kr.depthAtLocation(r):this._depth[t][e]+=kr.depthAtLocation(r))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1];arguments[2]===ge.INTERIOR&&this._depth[t][e]++}}getClass(){return kr}get interfaces_(){return[]}}kr.constructor_=function(){this._depth=Array(2).fill().map(()=>Array(3));for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=kr.NULL_VALUE},kr.NULL_VALUE=-1;class Nr{constructor(){Nr.constructor_.apply(this,arguments)}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){m.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}getClass(){return Nr}get interfaces_(){return[]}}Nr.constructor_=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._label=t}};class Ar extends Nr{constructor(){super(),Ar.constructor_.apply(this,arguments)}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof ye&&arguments[0]instanceof Tr))return super.updateIM.apply(this,arguments);{let t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,wr.ON),t.getLocation(1,wr.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,wr.LEFT),t.getLocation(1,wr.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,wr.RIGHT),t.getLocation(1,wr.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Ar(t,Tr.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof Ar))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var r=!0,n=!0,i=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(r=!1),this.pts[o].equals2D(e.pts[--i])||(n=!1),!r&&!n)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){let t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){Ar.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new Mr(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new R;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,r,n){var i=new _(t.getIntersection(n)),o=e,s=t.getEdgeDistance(r,n),a=o+1;if(a<this.pts.length){var l=this.pts[a];i.equals2D(l)&&(o=a,s=0)}this.eiList.add(i,o,s)}toString(){var t=new Nt;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,r){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,r,n)}getClass(){return Ar}get interfaces_(){return[]}}Ar.constructor_=function(){if(this.pts=null,this._env=null,this.eiList=new Rr(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new kr,this._depthDelta=0,1===arguments.length){let t=arguments[0];Ar.constructor_.call(this,t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.pts=t,this._label=e}};class Fr extends Nr{constructor(){super(),Fr.constructor_.apply(this,arguments)}isIncidentEdgeInResult(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){var r=ge.NONE;if(r=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);r!==ge.BOUNDARY&&(r=n)}return r}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{let t=arguments[0],e=arguments[1];null===this._label?this._label=new Tr(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof Fr){let t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Tr){let r=arguments[0];for(var t=0;t<2;t++){var e=this.computeMergedLocation(r,t);this._label.getLocation(t)===ge.NONE&&this._label.setLocation(t,e)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;var e=ge.NONE;null!==this._label&&(e=this._label.getLocation(t));var r=null;switch(e){case ge.BOUNDARY:r=ge.INTERIOR;break;case ge.INTERIOR:default:r=ge.BOUNDARY}this._label.setLocation(t,r)}getClass(){return Fr}get interfaces_(){return[]}}Fr.constructor_=function(){this._coord=null,this._edges=null;let t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Tr(0,ge.NONE)};class Dr{constructor(){Dr.constructor_.apply(this,arguments)}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof _){let e=arguments[0];return null===(t=this.nodeMap.get(e))&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof Fr){let e=arguments[0];var t;return null===(t=this.nodeMap.get(e.getCoordinate()))?(this.nodeMap.put(e.getCoordinate(),e),e):(t.mergeLabel(e),t)}}print(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){for(var e=new C,r=this.iterator();r.hasNext();){var n=r.next();n.getLabel().getLocation(t)===ge.BOUNDARY&&e.add(n)}return e}add(t){var e=t.getCoordinate();this.addNode(e).add(t)}getClass(){return Dr}get interfaces_(){return[]}}Dr.constructor_=function(){this.nodeMap=new pt,this.nodeFact=null;let t=arguments[0];this.nodeFact=t};class jr{constructor(){jr.constructor_.apply(this,arguments)}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:j.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){var e=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),n=r.lastIndexOf("."),i=r.substring(n+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){var e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),r=e.lastIndexOf(".");return"  "+e.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=fr.quadrant(this._dx,this._dy),m.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}getClass(){return jr}get interfaces_(){return[h]}}jr.constructor_=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){let t=arguments[0];this._edge=t}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];jr.constructor_.call(this,t,e,r,null)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];jr.constructor_.call(this,t),this.init(e,r),this._label=n}};class Gr extends g{constructor(){if(1===arguments.length){let t=arguments[0];super(t),g.call(this,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];super(Gr.msgWithCoord(t,e)),this.name="TopologyException",this.pt=new _(e)}}getCoordinate(){return this.pt}get interfaces_(){return[]}getClass(){return Gr}static msgWithCoord(t,e){return null!==e?t+" [ "+e+" ]":t}}class zr extends jr{constructor(){super(),zr.constructor_.apply(this,arguments)}static depthFactor(t,e){return t===ge.EXTERIOR&&e===ge.INTERIOR?1:t===ge.INTERIOR&&e===ge.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new Tr(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Gr("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,wr.LEFT)===ge.INTERIOR&&this._label.getLocation(e,wr.RIGHT)===ge.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[wr.LEFT]+"/"+this._depth[wr.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,ge.EXTERIOR),r=!this._label.isArea(1)||this._label.allPositionsEqual(1,ge.EXTERIOR);return t&&e&&r}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){var r=this.getEdge().getDepthDelta();this._isForward||(r=-r);var n=1;t===wr.LEFT&&(n=-1);var i=wr.opposite(t),o=e+r*n;this.setDepth(t,e),this.setDepth(i,o)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}getClass(){return zr}get interfaces_(){return[]}}zr.constructor_=function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];let t=arguments[0],e=arguments[1];if(jr.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()};class Ur{constructor(){Ur.constructor_.apply(this,arguments)}createNode(t){return new Fr(t,null)}getClass(){return Ur}get interfaces_(){return[]}}Ur.constructor_=function(){};class Br{constructor(){Br.constructor_.apply(this,arguments)}static linkResultDirectedEdges(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}printEdges(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var r=this._edges.get(e);r.print(t),r.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof Fr){let t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof _){let t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}debugPrintln(t){G.out.println(t)}isBoundaryNode(t,e){var r=this._nodes.find(e);if(null===r)return!1;var n=r.getLabel();return null!==n&&n.getLocation(t)===ge.BOUNDARY}linkAllDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}matchInSameDirection(t,e,r,n){return!!t.equals(r)&&j.index(t,e,n)===j.COLLINEAR&&fr.quadrant(t,e)===fr.quadrant(r,n)}getEdgeEnds(){return this._edgeEndList}debugPrint(t){G.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(var r=0;r<this._edges.size();r++){var n=this._edges.get(r),i=n.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return n;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return n}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var r=e.next();if(r.getEdge()===t)return r}return null}addEdges(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this._edges.add(r);var n=new zr(r,!0),i=new zr(r,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(var r=0;r<this._edges.size();r++){var n=this._edges.get(r),i=n.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return n}return null}getClass(){return Br}get interfaces_(){return[]}}Br.constructor_=function(){if(this._edges=new C,this._nodes=null,this._edgeEndList=new C,0===arguments.length)this._nodes=new Dr(new Ur);else if(1===arguments.length){let t=arguments[0];this._nodes=new Dr(t)}};class Vr extends Br{constructor(){super(),Vr.constructor_.apply(this,arguments)}static determineBoundary(t,e){return t.isInBoundary(e)?ge.BOUNDARY:ge.INTERIOR}insertBoundaryPoint(t,e){var r=this._nodes.addNode(e).getLabel(),n=1;ge.NONE,r.getLocation(t,wr.ON)===ge.BOUNDARY&&n++;var i=Vr.determineBoundary(this._boundaryNodeRule,n);r.setLocation(t,i)}computeSelfNodes(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){let i=arguments[1],o=arguments[2];var t=new Ir(arguments[0],!0,!1);t.setIsDoneIfProperInt(o);var e=this.createEdgeSetIntersector(),r=this._parentGeom instanceof Vt||this._parentGeom instanceof Ut||this._parentGeom instanceof qt,n=i||!r;return e.computeIntersections(this._edges,t,n),this.addSelfIntersectionNodes(this._argIndex),t}}computeSplitEdges(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)}computeEdgeIntersections(t,e,r){var n=new Ir(e,r,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof jt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,ge.INTERIOR)}else if(arguments[0]instanceof _){let t=arguments[0];this.insertPoint(this._argIndex,t,ge.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),ge.EXTERIOR,ge.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var r=t.getInteriorRingN(e);this.addPolygonRing(r,ge.INTERIOR,ge.EXTERIOR)}}addEdge(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],ge.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],ge.BOUNDARY)}addLineString(t){var e=Q.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var r=new Ar(e,new Tr(this._argIndex,ge.INTERIOR));this._lineEdgeMap.put(t,r),this.insertEdge(r),m.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),r=0,n=t.iterator();n.hasNext();){var i=n.next();e[r++]=i.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,r){if(this.isBoundaryNode(t,e))return null;r===ge.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,r)}addPolygonRing(t,e,r){if(t.isEmpty())return null;var n=Q.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var i=e,o=r;j.isCCW(n)&&(i=r,o=e);var s=new Ar(n,new Tr(this._argIndex,ge.BOUNDARY,i,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,n[0],ge.BOUNDARY)}insertPoint(t,e,r){var n=this._nodes.addNode(e),i=n.getLabel();null===i?n._label=new Tr(t,r):i.setLocation(t,r)}createEdgeSetIntersector(){return new Or}addSelfIntersectionNodes(t){for(var e=this._edges.iterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,n)}}add(){if(!(1===arguments.length&&arguments[0]instanceof W))return super.add.apply(this,arguments);{let t=arguments[0];if(t.isEmpty())return null;if(t instanceof qt&&(this._useBoundaryDeterminationRule=!1),t instanceof Ut)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof jt)this.addPoint(t);else if(t instanceof Bt)this.addCollection(t);else if(t instanceof St)this.addCollection(t);else if(t instanceof qt)this.addCollection(t);else{if(!(t instanceof Et))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}}}addCollection(t){for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);this.add(r)}}locate(t){return b(this._parentGeom,zt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new De(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof Ft){let t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}getClass(){return Vr}get interfaces_(){return[]}}Vr.constructor_=function(){if(this._parentGeom=null,this._lineEdgeMap=new ne,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new br,2===arguments.length){let t=arguments[0],e=arguments[1];Vr.constructor_.call(this,t,e,H.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=r,null!==e&&this.add(e)}};var qr=Object.freeze({GeometryGraph:Vr});class Yr{constructor(){Yr.constructor_.apply(this,arguments)}visit(t){}getClass(){return Yr}get interfaces_(){return[]}}Yr.constructor_=function(){};class Wr{constructor(){Wr.constructor_.apply(this,arguments)}isRepeated(){return this._count>1}getRight(){return this._right}getCoordinate(){return this._p}setLeft(t){this._left=t}getX(){return this._p.x}getData(){return this._data}getCount(){return this._count}getLeft(){return this._left}getY(){return this._p.y}increment(){this._count=this._count+1}setRight(t){this._right=t}getClass(){return Wr}get interfaces_(){return[]}}Wr.constructor_=function(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._p=new _(t),this._left=null,this._right=null,this._count=1,this._data=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._p=new _(t,e),this._left=null,this._right=null,this._count=1,this._data=r}};class Xr{constructor(){Xr.constructor_.apply(this,arguments)}static toCoordinates(){if(1===arguments.length){let t=arguments[0];return Xr.toCoordinates(t,!1)}if(2===arguments.length){let o=arguments[0],s=arguments[1];for(var t=new P,e=o.iterator();e.hasNext();)for(var r=e.next(),n=s?r.getCount():1,i=0;i<n;i++)t.add(r.getCoordinate(),!0);return t.toCoordinateArray()}}insert(){if(1===arguments.length){let t=arguments[0];return this.insert(t,null)}if(2===arguments.length){let e=arguments[0],r=arguments[1];if(null===this._root)return this._root=new Wr(e,r),this._root;if(this._tolerance>0){var t=this.findBestMatchNode(e);if(null!==t)return t.increment(),t}return this.insertExact(e,r)}}query(){if(1===arguments.length){let e=arguments[0];var t=new C;return this.query(e,t),t}if(2===arguments.length)if(arguments[0]instanceof R&&b(arguments[1],S)){let t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,new class{get interfaces_(){return[Yr]}visit(t){e.add(t)}})}else if(arguments[0]instanceof R&&b(arguments[1],Yr)){let t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,e)}}queryNode(t,e,r,n){if(null===t)return null;var i=null,o=null,s=null;r?(i=e.getMinX(),o=e.getMaxX(),s=t.getX()):(i=e.getMinY(),o=e.getMaxY(),s=t.getY());var a=s<=o;i<s&&this.queryNode(t.getLeft(),e,!r,n),e.contains(t.getCoordinate())&&n.visit(t),a&&this.queryNode(t.getRight(),e,!r,n)}findBestMatchNode(t){var e=new Hr(t,this._tolerance);return this.query(e.queryEnvelope(),e),e.getNode()}isEmpty(){return null===this._root}insertExact(t,e){for(var r=this._root,n=this._root,i=!0,o=!0;null!==r;){if(null!==r&&t.distance(r.getCoordinate())<=this._tolerance)return r.increment(),r;o=i?t.x<r.getX():t.y<r.getY(),n=r,r=o?r.getLeft():r.getRight(),i=!i}this._numberOfNodes=this._numberOfNodes+1;var s=new Wr(t,e);return o?n.setLeft(s):n.setRight(s),s}getClass(){return Xr}get interfaces_(){return[]}}class Hr{constructor(){Hr.constructor_.apply(this,arguments)}visit(t){var e=this._p.distance(t.getCoordinate());if(!(e<=this._tolerance))return null;var r=!1;(null===this._matchNode||e<this._matchDist||null!==this._matchNode&&e===this._matchDist&&t.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(r=!0),r&&(this._matchNode=t,this._matchDist=e)}queryEnvelope(){var t=new R(this._p);return t.expandBy(this._tolerance),t}getNode(){return this._matchNode}getClass(){return Hr}get interfaces_(){return[Yr]}}Hr.constructor_=function(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;let t=arguments[0],e=arguments[1];this._p=t,this._tolerance=e},Xr.BestMatchVisitor=Hr,Xr.constructor_=function(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,0===arguments.length)Xr.constructor_.call(this,0);else if(1===arguments.length){let t=arguments[0];this._tolerance=t}};var Zr=Object.freeze({KdTree:Xr});class Kr{constructor(){Kr.constructor_.apply(this,arguments)}static getSubnodeIndex(t,e,r){var n=-1;return t.getMinX()>=e&&(t.getMinY()>=r&&(n=3),t.getMaxY()<=r&&(n=1)),t.getMaxX()<=e&&(t.getMinY()>=r&&(n=2),t.getMaxY()<=r&&(n=0)),n}hasChildren(){for(var t=0;t<4;t++)if(null!==this._subnode[t])return!0;return!1}isPrunable(){return!(this.hasChildren()||this.hasItems())}addAllItems(t){t.addAll(this._items);for(var e=0;e<4;e++)null!==this._subnode[e]&&this._subnode[e].addAllItems(t);return t}getNodeCount(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+1}size(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+this._items.size()}addAllItemsFromOverlapping(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this._items);for(var r=0;r<4;r++)null!==this._subnode[r]&&this._subnode[r].addAllItemsFromOverlapping(t,e)}visitItems(t,e){for(var r=this._items.iterator();r.hasNext();)e.visitItem(r.next())}hasItems(){return!this._items.isEmpty()}remove(t,e){if(!this.isSearchMatch(t))return!1;for(var r=!1,n=0;n<4;n++)if(null!==this._subnode[n]&&(r=this._subnode[n].remove(t,e))){this._subnode[n].isPrunable()&&(this._subnode[n]=null);break}return r||this._items.remove(e)}visit(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var r=0;r<4;r++)null!==this._subnode[r]&&this._subnode[r].visit(t,e)}getItems(){return this._items}depth(){for(var t=0,e=0;e<4;e++)if(null!==this._subnode[e]){var r=this._subnode[e].depth();r>t&&(t=r)}return t+1}isEmpty(){var t=!0;if(this._items.isEmpty()){for(var e=0;e<4;e++)if(null!==this._subnode[e]&&!this._subnode[e].isEmpty()){t=!1;break}}else t=!1;return t}add(t){this._items.add(t)}getClass(){return Kr}get interfaces_(){return[d]}}function $r(){}Kr.constructor_=function(){this._items=new C,this._subnode=new Array(4).fill(null)},$r.exponent=function(t){return function(t,e){var r,n,i,o,s={32:8,64:11}[t];if(o||(r=e<0||1/e<0,isFinite(e)||(o={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}}[t],r&&(o.d+=1<<t/4-1),n=Math.pow(2,s)-1,i=0)),!o){for(n={32:127,64:1023}[t],i=Math.abs(e);i>=2;)n++,i/=2;for(;i<1&&n>0;)n--,i*=2;n<=0&&(i/=2),32===t&&n>254&&(o={d:r?255:127,c:128,b:0,a:0},n=Math.pow(2,s)-1,i=0)}return n}(64,t)-1023},$r.powerOf2=function(t){return Math.pow(2,t)};class Jr{constructor(){Jr.constructor_.apply(this,arguments)}static computeQuadLevel(t){var e=t.getWidth(),r=t.getHeight(),n=e>r?e:r;return $r.exponent(n)+1}getLevel(){return this._level}computeKey(){if(1===arguments.length){let t=arguments[0];for(this._level=Jr.computeQuadLevel(t),this._env=new R,this.computeKey(this._level,t);!this._env.contains(t);)this._level+=1,this.computeKey(this._level,t)}else if(2===arguments.length){let e=arguments[0],r=arguments[1];var t=$r.powerOf2(e);this._pt.x=Math.floor(r.getMinX()/t)*t,this._pt.y=Math.floor(r.getMinY()/t)*t,this._env.init(this._pt.x,this._pt.x+t,this._pt.y,this._pt.y+t)}}getEnvelope(){return this._env}getCentre(){return new _((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}getPoint(){return this._pt}getClass(){return Jr}get interfaces_(){return[]}}Jr.constructor_=function(){this._pt=new _,this._level=0,this._env=null;let t=arguments[0];this.computeKey(t)};class Qr extends Kr{constructor(){super(),Qr.constructor_.apply(this,arguments)}static createNode(t){var e=new Jr(t);return new Qr(e.getEnvelope(),e.getLevel())}static createExpanded(t,e){var r=new R(e);null!==t&&r.expandToInclude(t._env);var n=Qr.createNode(r);return null!==t&&n.insertNode(t),n}find(t){var e=Kr.getSubnodeIndex(t,this._centrex,this._centrey);return-1===e?this:null!==this._subnode[e]?this._subnode[e].find(t):this}isSearchMatch(t){return null!==t&&this._env.intersects(t)}getSubnode(t){return null===this._subnode[t]&&(this._subnode[t]=this.createSubnode(t)),this._subnode[t]}getEnvelope(){return this._env}getNode(t){var e=Kr.getSubnodeIndex(t,this._centrex,this._centrey);return-1!==e?this.getSubnode(e).getNode(t):this}createSubnode(t){var e=0,r=0,n=0,i=0;switch(t){case 0:e=this._env.getMinX(),r=this._centrex,n=this._env.getMinY(),i=this._centrey;break;case 1:e=this._centrex,r=this._env.getMaxX(),n=this._env.getMinY(),i=this._centrey;break;case 2:e=this._env.getMinX(),r=this._centrex,n=this._centrey,i=this._env.getMaxY();break;case 3:e=this._centrex,r=this._env.getMaxX(),n=this._centrey,i=this._env.getMaxY()}var o=new R(e,r,n,i);return new Qr(o,this._level-1)}insertNode(t){m.isTrue(null===this._env||this._env.contains(t._env));var e=Kr.getSubnodeIndex(t._env,this._centrex,this._centrey);if(t._level===this._level-1)this._subnode[e]=t;else{var r=this.createSubnode(e);r.insertNode(t),this._subnode[e]=r}}getClass(){return Qr}get interfaces_(){return[]}}Qr.constructor_=function(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;let t=arguments[0],e=arguments[1];this._env=t,this._level=e,this._centrex=(t.getMinX()+t.getMaxX())/2,this._centrey=(t.getMinY()+t.getMaxY())/2};class tn{constructor(){tn.constructor_.apply(this,arguments)}static isZeroWidth(t,e){var r=e-t;if(0===r)return!0;var n=r/Math.max(Math.abs(t),Math.abs(e));return $r.exponent(n)<=tn.MIN_BINARY_EXPONENT}getClass(){return tn}get interfaces_(){return[]}}tn.constructor_=function(){},tn.MIN_BINARY_EXPONENT=-50;class en extends Kr{constructor(){super(),en.constructor_.apply(this,arguments)}insert(t,e){var r=Kr.getSubnodeIndex(t,en.origin.x,en.origin.y);if(-1===r)return this.add(e),null;var n=this._subnode[r];if(null===n||!n.getEnvelope().contains(t)){var i=Qr.createExpanded(n,t);this._subnode[r]=i}this.insertContained(this._subnode[r],t,e)}isSearchMatch(t){return!0}insertContained(t,e,r){m.isTrue(t.getEnvelope().contains(e));var n=tn.isZeroWidth(e.getMinX(),e.getMaxX()),i=tn.isZeroWidth(e.getMinY(),e.getMaxY());(n||i?t.find(e):t.getNode(e)).add(r)}getClass(){return en}get interfaces_(){return[]}}en.constructor_=function(){},en.origin=new _(0,0);class rn{constructor(){rn.constructor_.apply(this,arguments)}insert(t,e){}remove(t,e){}query(){}getClass(){return rn}get interfaces_(){return[]}}rn.constructor_=function(){};class nn{constructor(){nn.constructor_.apply(this,arguments)}static ensureExtent(t,e){var r=t.getMinX(),n=t.getMaxX(),i=t.getMinY(),o=t.getMaxY();return r!==n&&i!==o?t:(r===n&&(n=(r-=e/2)+e/2),i===o&&(o=(i-=e/2)+e/2),new R(r,n,i,o))}size(){return null!==this._root?this._root.size():0}insert(t,e){this.collectStats(t);var r=nn.ensureExtent(t,this._minExtent);this._root.insert(r,e)}query(){if(1===arguments.length){let e=arguments[0];var t=new Ae;return this.query(e,t),t.getItems()}if(2===arguments.length){let t=arguments[0],e=arguments[1];this._root.visit(t,e)}}queryAll(){var t=new C;return this._root.addAllItems(t),t}remove(t,e){var r=nn.ensureExtent(t,this._minExtent);return this._root.remove(r,e)}collectStats(t){var e=t.getWidth();e<this._minExtent&&e>0&&(this._minExtent=e);var r=t.getHeight();r<this._minExtent&&r>0&&(this._minExtent=r)}depth(){return null!==this._root?this._root.depth():0}isEmpty(){return null===this._root||this._root.isEmpty()}getClass(){return nn}get interfaces_(){return[rn,d]}}nn.constructor_=function(){this._root=null,this._minExtent=1,this._root=new en},nn.serialVersionUID=-0x678b60c967a25400;var on=Object.freeze({Quadtree:nn});class sn{constructor(){sn.constructor_.apply(this,arguments)}getBounds(){}getClass(){return sn}get interfaces_(){return[]}}sn.constructor_=function(){};class an{constructor(){an.constructor_.apply(this,arguments)}getItem(){return this._item}getBounds(){return this._bounds}getClass(){return an}get interfaces_(){return[sn,d]}}an.constructor_=function(){this._bounds=null,this._item=null;let t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};class ln{constructor(){ln.constructor_.apply(this,arguments)}poll(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){for(var e=null,r=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(r)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,r)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}getClass(){return ln}get interfaces_(){return[]}}ln.constructor_=function(){this._size=null,this._items=null,this._size=0,this._items=new C,this._items.add(null)};class un{constructor(){un.constructor_.apply(this,arguments)}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){m.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}getClass(){return un}get interfaces_(){return[sn,d]}}un.constructor_=function(){if(this._childBoundables=new C,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._level=t}},un.serialVersionUID=0x5a1e55ec41369800;class cn{constructor(){cn.constructor_.apply(this,arguments)}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof un}expandToQueue(t,e){var n=cn.isComposite(this._boundable1),i=cn.isComposite(this._boundable2);if(n&&i)return cn.area(this._boundable1)>cn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new r("neither boundable is composite")}isLeaves(){return!(cn.isComposite(this._boundable1)||cn.isComposite(this._boundable2))}compareTo(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,r,n){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),s=new cn(o,e,this._itemDistance);s.getDistance()<n&&r.add(s)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}getClass(){return cn}get interfaces_(){return[h]}}cn.constructor_=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;let t=arguments[0],e=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=r,this._distance=this.distance()};class hn{constructor(){hn.constructor_.apply(this,arguments)}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if(b(arguments[2],Oe)&&arguments[0]instanceof Object&&arguments[1]instanceof un){let n=arguments[0],i=arguments[2];for(var t=arguments[1].getChildBoundables(),e=0;e<t.size();e++){var r=t.get(e);this.getIntersectsOp().intersects(r.getBounds(),n)&&(r instanceof un?this.queryInternal(n,r,i):r instanceof an?i.visitItem(r.getItem()):m.shouldNeverReachHere())}}else if(b(arguments[2],S)&&arguments[0]instanceof Object&&arguments[1]instanceof un){let n=arguments[0],i=arguments[2];for(t=arguments[1].getChildBoundables(),e=0;e<t.size();e++)r=t.get(e),this.getIntersectsOp().intersects(r.getBounds(),n)&&(r instanceof un?this.queryInternal(n,r,i):r instanceof an?i.add(r.getItem()):m.shouldNeverReachHere())}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var r=e.next();r instanceof un?t+=this.size(r):r instanceof an&&(t+=1)}return t}}removeItem(t,e){for(var r=null,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();i instanceof an&&i.getItem()===e&&(r=i)}return null!==r&&(t.getChildBoundables().remove(r),!0)}itemsTree(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new C:t}if(1===arguments.length){let t=arguments[0];for(var e=new C,r=t.getChildBoundables().iterator();r.hasNext();){var n=r.next();if(n instanceof un){var i=this.itemsTree(n);null!==i&&e.add(i)}else n instanceof an?e.add(n.getItem()):m.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){m.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new an(t,e))}boundablesAtLevel(){if(1===arguments.length){let e=arguments[0];var t=new C;return this.boundablesAtLevel(e,this._root,t),t}if(3===arguments.length){let t=arguments[0],n=arguments[1],i=arguments[2];if(m.isTrue(t>-2),n.getLevel()===t)return i.add(n),null;for(var e=n.getChildBoundables().iterator();e.hasNext();){var r=e.next();r instanceof un?this.boundablesAtLevel(t,r,i):(m.isTrue(r instanceof an),-1===t&&i.add(r))}return null}}query(){if(1===arguments.length){let e=arguments[0];this.build();var t=new C;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,t),t}if(2===arguments.length){let t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){let i=arguments[0],o=arguments[1],s=arguments[2];var t=this.removeItem(o,s);if(t)return!0;for(var e=null,r=o.getChildBoundables().iterator();r.hasNext();){var n=r.next();if(this.getIntersectsOp().intersects(n.getBounds(),i)&&n instanceof un&&(t=this.remove(i,n,s))){e=n;break}}return null!==e&&e.getChildBoundables().isEmpty()&&o.getChildBoundables().remove(e),t}}createHigherLevels(t,e){m.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,e+1);return 1===r.size()?r.get(0):this.createHigherLevels(r,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var r=e.next();if(r instanceof un){var n=this.depth(r);n>t&&(t=n)}}return t+1}}createParentBoundables(t,e){m.isTrue(!t.isEmpty());var r=new C;r.add(this.createNode(e));var n=new C(t);Le.sort(n,this.getComparator());for(var i=n.iterator();i.hasNext();){var o=i.next();this.lastNode(r).getChildBoundables().size()===this.getNodeCapacity()&&r.add(this.createNode(e)),this.lastNode(r).addChildBoundable(o)}return r}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}getClass(){return hn}get interfaces_(){return[d]}}hn.IntersectsOp=function(){},hn.constructor_=function(){if(this._root=null,this._built=!1,this._itemBoundables=new C,this._nodeCapacity=null,0===arguments.length)hn.constructor_.call(this,hn.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){let t=arguments[0];m.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}},hn.serialVersionUID=-0x35ef64c82d4c5400,hn.DEFAULT_NODE_CAPACITY=10;class fn{constructor(){fn.constructor_.apply(this,arguments)}distance(t,e){}getClass(){return fn}get interfaces_(){return[]}}fn.constructor_=function(){};class pn extends hn{constructor(){super(),pn.constructor_.apply(this,arguments)}static centreX(t){return pn.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){for(var e=new Array(t.size()).fill(null),r=0;!t.isEmpty();){var n=t.poll();e[r]=n.getBoundable(0).getItem(),r++}return e}static centreY(t){return pn.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){m.isTrue(t.length>0);for(var r=new C,n=0;n<t.length;n++)r.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return r}createNode(t){return new dn(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof R))return super.insert.apply(this,arguments);{let t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return pn.intersectsOp}verticalSlices(t,e){for(var r=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){n[o]=new C;for(var s=0;i.hasNext()&&s<r;){var a=i.next();n[o].add(a),s++}}return n}query(){if(1===arguments.length){let t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return pn.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof R){let t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){m.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),n=new C(t);Le.sort(n,pn.xComparator);var i=this.verticalSlices(n,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(i,e)}nearestNeighbour(){if(1===arguments.length){if(b(arguments[0],fn)){let e=arguments[0];var t=new cn(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(t)}if(arguments[0]instanceof cn){let t=arguments[0];return this.nearestNeighbour(t,i.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof pn&&b(arguments[1],fn)){let e=arguments[0],r=arguments[1];return t=new cn(this.getRoot(),e.getRoot(),r),this.nearestNeighbour(t)}if(arguments[0]instanceof cn&&"number"==typeof arguments[1]){let t=arguments[0];var e=arguments[1],r=null;for((o=new ln).add(t);!o.isEmpty()&&e>0&&!((l=(a=o.poll()).getDistance())>=e);)a.isLeaves()?(e=l,r=a):a.expandToQueue(o,e);return[r.getBoundable(0).getItem(),r.getBoundable(1).getItem()]}if(arguments[0]instanceof cn&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1];return this.nearestNeighbour(t,i.POSITIVE_INFINITY,e)}}else if(3===arguments.length){if(b(arguments[2],fn)&&arguments[0]instanceof R&&arguments[1]instanceof Object){let e=arguments[2];var n=new an(arguments[0],arguments[1]);return t=new cn(this.getRoot(),n,e),this.nearestNeighbour(t)[0]}if(Number.isInteger(arguments[2])&&arguments[0]instanceof cn&&"number"==typeof arguments[1]){let t=arguments[0],r=arguments[2];var o;e=arguments[1],(o=new ln).add(t);for(var s=new ln;!o.isEmpty()&&e>=0;){var a,l;if((l=(a=o.poll()).getDistance())>=e)break;a.isLeaves()?s.size()<r?s.add(a):(s.peek().getDistance()>l&&(s.poll(),s.add(a)),e=s.peek().getDistance()):a.expandToQueue(o,e)}return pn.getItems(s)}}else if(4===arguments.length){let e=arguments[2],r=arguments[3];return n=new an(arguments[0],arguments[1]),t=new cn(this.getRoot(),n,e),this.nearestNeighbour(t,r)}}getClass(){return pn}get interfaces_(){return[rn,d]}}class dn extends un{constructor(){super(),dn.constructor_.apply(this,arguments)}computeBounds(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var r=e.next();null===t?t=new R(r.getBounds()):t.expandToInclude(r.getBounds())}return t}getClass(){return dn}get interfaces_(){return[]}}dn.constructor_=function(){let t=arguments[0];un.constructor_.call(this,t)},pn.STRtreeNode=dn,pn.constructor_=function(){if(0===arguments.length)pn.constructor_.call(this,pn.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){let t=arguments[0];hn.constructor_.call(this,t)}},pn.serialVersionUID=0x39920f7d5f261e0,pn.xComparator=new class{get interfaces_(){return[p]}compare(t,e){return hn.compareDoubles(pn.centreX(t.getBounds()),pn.centreX(e.getBounds()))}},pn.yComparator=new class{get interfaces_(){return[p]}compare(t,e){return hn.compareDoubles(pn.centreY(t.getBounds()),pn.centreY(e.getBounds()))}},pn.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},pn.DEFAULT_NODE_CAPACITY=10;var gn=Object.freeze({STRtree:pn}),yn=Object.freeze({kdtree:Zr,quadtree:on,strtree:gn});const mn=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class _n{constructor(t){this.geometryFactory=t||new se}read(t){let e;const r=(e="string"==typeof t?JSON.parse(t):t).type;if(!vn[r])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==mn.indexOf(r)?vn[r].call(this,e.coordinates):"GeometryCollection"===r?vn[r].call(this,e.geometries):vn[r].call(this,e)}write(t){const e=t.getGeometryType();if(!bn[e])throw new Error("Geometry is not supported");return bn[e].call(this,t)}}const vn={Feature:function(t){const e={};for(let r in t)e[r]=t[r];if(t.geometry){const r=t.geometry.type;if(!vn[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=vn.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let r=0;r<t.features.length;++r)e.features.push(this.read(t.features[r]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(new _(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new _(t[0],t[1]),new _(t[2],t[1]),new _(t[2],t[3]),new _(t[0],t[3]),new _(t[0],t[1])])},Point:function(t){const e=new _(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let r=0;r<t.length;++r)e.push(vn.Point.call(this,t[r]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=vn.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let r=0;r<t.length;++r)e.push(vn.LineString.call(this,t[r]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=vn.coordinates.call(this,t[0]),r=this.geometryFactory.createLinearRing(e),n=[];for(let e=1;e<t.length;++e){var i=t[e],o=vn.coordinates.call(this,i),s=this.geometryFactory.createLinearRing(o);n.push(s)}return this.geometryFactory.createPolygon(r,n)},MultiPolygon:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(vn.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},bn={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:bn.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=bn.Point.call(this,n);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],r=t.getCoordinates();for(let t=0;t<r.length;++t){const n=r[t];e.push(bn.coordinate.call(this,n))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=bn.LineString.call(this,n);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],r=bn.LineString.call(this,t._shell);e.push(r.coordinates);for(let r=0;r<t._holes.length;++r){const n=t._holes[r],i=bn.LineString.call(this,n);e.push(i.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=bn.Polygon.call(this,n);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=n.getGeometryType();e.push(bn[i].call(this,n))}return{type:"GeometryCollection",geometries:e}}};function wn(t){return[t.x,t.y]}var xn=Object.freeze({GeoJSONReader:class{constructor(t){this.parser=new _n(t||new se)}read(t){return this.parser.read(t)}},GeoJSONWriter:class{constructor(){this.parser=new _n(this.geometryFactory)}write(t){return this.parser.write(t)}},OL3Parser:class{constructor(t,e){this.geometryFactory=t||new se,this.ol=e||"undefined"!=typeof ol&&ol}inject(t,e,r,n,i,o,s,a){this.ol={geom:{Point:t,LineString:e,LinearRing:r,Polygon:n,MultiPoint:i,MultiLineString:o,MultiPolygon:s,GeometryCollection:a}}}read(t){const e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0}convertFromPoint(t){const e=t.getCoordinates();return this.geometryFactory.createPoint(new _(e[0],e[1]))}convertFromLineString(t){return this.geometryFactory.createLineString(t.getCoordinates().map((function(t){return new _(t[0],t[1])})))}convertFromLinearRing(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map((function(t){return new _(t[0],t[1])})))}convertFromPolygon(t){const e=t.getLinearRings();var r=null,n=[];for(let t=0;t<e.length;t++){const i=this.convertFromLinearRing(e[t]);0===t?r=i:n.push(i)}return this.geometryFactory.createPolygon(r,n)}convertFromMultiPoint(t){const e=t.getPoints().map((function(t){return this.convertFromPoint(t)}),this);return this.geometryFactory.createMultiPoint(e)}convertFromMultiLineString(t){const e=t.getLineStrings().map((function(t){return this.convertFromLineString(t)}),this);return this.geometryFactory.createMultiLineString(e)}convertFromMultiPolygon(t){const e=t.getPolygons().map((function(t){return this.convertFromPolygon(t)}),this);return this.geometryFactory.createMultiPolygon(e)}convertFromCollection(t){const e=t.getGeometries().map((function(t){return this.read(t)}),this);return this.geometryFactory.createGeometryCollection(e)}write(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0}convertToPoint(t){return new this.ol.geom.Point([t.x,t.y])}convertToLineString(t){var e=t._points._coordinates.map(wn);return new this.ol.geom.LineString(e)}convertToLinearRing(t){var e=t._points._coordinates.map(wn);return new this.ol.geom.LinearRing(e)}convertToPolygon(t){var e=[t._shell._points._coordinates.map(wn)];for(let r=0;r<t._holes.length;r++)e.push(t._holes[r]._points._coordinates.map(wn));return new this.ol.geom.Polygon(e)}convertToMultiPoint(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(wn))}convertToMultiLineString(t){var e=[];for(let r=0;r<t._geometries.length;r++)e.push(this.convertToLineString(t._geometries[r]).getCoordinates());return new this.ol.geom.MultiLineString(e)}convertToMultiPolygon(t){var e=[];for(let r=0;r<t._geometries.length;r++)e.push(this.convertToPolygon(t._geometries[r]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}convertToCollection(t){var e=[];for(let n=0;n<t._geometries.length;n++){var r=t._geometries[n];e.push(this.write(r))}return new this.ol.geom.GeometryCollection(e)}},WKTReader:class{constructor(t){this.parser=new le(t||new se)}read(t){return this.parser.read(t)}},WKTWriter:he});class En{constructor(){En.constructor_.apply(this,arguments)}static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,r){if(e.equals2D(r))return 0;var n=En.relativeSign(e.x,r.x),i=En.relativeSign(e.y,r.y);switch(t){case 0:return En.compareValue(n,i);case 1:return En.compareValue(i,n);case 2:return En.compareValue(i,-n);case 3:return En.compareValue(-n,i);case 4:return En.compareValue(-n,-i);case 5:return En.compareValue(-i,-n);case 6:return En.compareValue(-i,n);case 7:return En.compareValue(n,-i)}return m.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}getClass(){return En}get interfaces_(){return[]}}En.constructor_=function(){};class Sn{constructor(){Sn.constructor_.apply(this,arguments)}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:En.compare(this._segmentOctant,this.coord,e.coord)}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}isInterior(){return this._isInterior}getClass(){return Sn}get interfaces_(){return[h]}}Sn.constructor_=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this._segString=t,this.coord=new _(e),this.segmentIndex=r,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(r))};class In{constructor(){In.constructor_.apply(this,arguments)}getSplitCoordinates(){var t=new P;this.addEndpoints();for(var e=this.iterator(),r=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(r,n,t),r=n}return t.toCoordinateArray()}addCollapsedNodes(){var t=new C;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var r=e.next().intValue();this.add(this._edge.getCoordinate(r),r)}}print(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}findCollapsesFromExistingVertices(t){for(var e=0;e<this._edge.size()-2;e++){var r=this._edge.getCoordinate(e),n=(this._edge.getCoordinate(e+1),this._edge.getCoordinate(e+2));r.equals2D(n)&&t.add(new N(e+1))}}addEdgeCoordinates(t,e,r){e.segmentIndex,t.segmentIndex;var n=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(n);r.add(new _(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)r.add(this._edge.getCoordinate(o));i&&r.add(new _(e.coord))}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),r=e.next();e.hasNext();){var n=e.next(),i=this.createSplitEdge(r,n);t.add(i),r=n}}findCollapseIndex(t,e,r){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(r[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){for(var e=new Array(1).fill(null),r=this.iterator(),n=r.next();r.hasNext();){var i=r.next();this.findCollapseIndex(n,i,e)&&t.add(new N(e[0])),n=i}}getEdge(){return this._edge}addEndpoints(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){var r=e.segmentIndex-t.segmentIndex+2,n=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(n);i||r--;var o=new Array(r).fill(null),s=0;o[s++]=new _(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return i&&(o[s]=new _(e.coord)),new Pn(o,this._edge.getData())}add(t,e){var r=new Sn(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(r);return null!==n?(m.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(r,r),r)}checkSplitEdgesCorrectness(t){var e=this._edge.getCoordinates(),r=t.get(0).getCoordinate(0);if(!r.equals2D(e[0]))throw new g("bad split edge start point at "+r);var n=t.get(t.size()-1).getCoordinates(),i=n[n.length-1];if(!i.equals2D(e[e.length-1]))throw new g("bad split edge end point at "+i)}getClass(){return In}get interfaces_(){return[]}}In.constructor_=function(){this._nodeMap=new pt,this._edge=null;let t=arguments[0];this._edge=t};class On{constructor(){On.constructor_.apply(this,arguments)}static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let n=arguments[0],i=arguments[1];if(0===n&&0===i)throw new r("Cannot compute the octant for point ( "+n+", "+i+" )");var t=Math.abs(n),e=Math.abs(i);return n>=0?i>=0?t>=e?0:1:t>=e?7:6:i>=0?t>=e?3:2:t>=e?4:5}if(arguments[0]instanceof _&&arguments[1]instanceof _){let t=arguments[0],e=arguments[1];var n=e.x-t.x,i=e.y-t.y;if(0===n&&0===i)throw new r("Cannot compute the octant for two identical points "+t);return On.octant(n,i)}}getClass(){return On}get interfaces_(){return[]}}On.constructor_=function(){};class Cn{constructor(){Cn.constructor_.apply(this,arguments)}getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}getClass(){return Cn}get interfaces_(){return[]}}Cn.constructor_=function(){};class Tn{constructor(){Tn.constructor_.apply(this,arguments)}addIntersection(t,e){}getClass(){return Tn}get interfaces_(){return[Cn]}}Tn.constructor_=function(){};class Pn{constructor(){Pn.constructor_.apply(this,arguments)}static getNodedSubstrings(){if(1===arguments.length){let e=arguments[0];var t=new C;return Pn.getNodedSubstrings(e,t),t}if(2===arguments.length){let t=arguments[1];for(var e=arguments[0].iterator();e.hasNext();)e.next().getNodeList().addSplitEdges(t)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:On.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){let e=arguments[1],r=arguments[3];var t=new _(arguments[0].getIntersection(r));this.addIntersection(t,e)}}toString(){return he.toLineString(new Kt(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){var r=e,n=r+1;if(n<this._pts.length){var i=this._pts[n];t.equals2D(i)&&(r=n)}return this._nodeList.add(t,r)}addIntersections(t,e,r){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,r,n)}getClass(){return Pn}get interfaces_(){return[Tn]}}Pn.constructor_=function(){this._nodeList=new In(this),this._pts=null,this._data=null;let t=arguments[0],e=arguments[1];this._pts=t,this._data=e};class Rn{constructor(){Rn.constructor_.apply(this,arguments)}overlap(){if(2===arguments.length);else if(4===arguments.length){let t=arguments[1],e=arguments[2],r=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}getClass(){return Rn}get interfaces_(){return[]}}Rn.constructor_=function(){this._overlapSeg1=new de,this._overlapSeg2=new de};class Ln{constructor(){Ln.constructor_.apply(this,arguments)}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,r,n){var i=this._pts[e],o=this._pts[r];if(r-e==1)return n.select(this,e),null;if(!t.intersects(i,o))return null;var s=Math.trunc((e+r)/2);e<s&&this.computeSelect(t,e,s,n),s<r&&this.computeSelect(t,s,r,n)}getCoordinates(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,r=this._start;r<=this._end;r++)t[e++]=this._pts[r];return t}computeOverlaps(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){let r=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3],s=arguments[4],a=arguments[5];if(n-r==1&&s-o==1)return a.overlap(this,r,i,o),null;if(!this.overlaps(r,n,i,o,s))return null;var t=Math.trunc((r+n)/2),e=Math.trunc((o+s)/2);r<t&&(o<e&&this.computeOverlaps(r,t,i,o,e,a),e<s&&this.computeOverlaps(r,t,i,e,s,a)),t<n&&(o<e&&this.computeOverlaps(t,n,i,o,e,a),e<s&&this.computeOverlaps(t,n,i,e,s,a))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new R(t,e)}return this._env}overlaps(t,e,r,n,i){return R.intersects(this._pts[t],this._pts[e],r._pts[n],r._pts[i])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}getClass(){return Ln}get interfaces_(){return[]}}Ln.constructor_=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=r,this._context=n};class Mn{constructor(){Mn.constructor_.apply(this,arguments)}static getChainStartIndices(t){var e=0,r=new C;r.add(new N(e));do{var n=Mn.findChainEnd(t,e);r.add(new N(n)),e=n}while(e<t.length-1);return Mn.toIntArray(r)}static findChainEnd(t,e){for(var r=e;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var n=fr.quadrant(t[r],t[r+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||fr.quadrant(t[i-1],t[i])===n);)i++;return i-1}static getChains(){if(1===arguments.length){let t=arguments[0];return Mn.getChains(t,null)}if(2===arguments.length){let i=arguments[0],o=arguments[1];for(var t=new C,e=Mn.getChainStartIndices(i),r=0;r<e.length-1;r++){var n=new Ln(i,e[r],e[r+1],o);t.add(n)}return t}}static toIntArray(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e}getClass(){return Mn}get interfaces_(){return[]}}Mn.constructor_=function(){};class kn{constructor(){kn.constructor_.apply(this,arguments)}computeNodes(t){}getNodedSubstrings(){}getClass(){return kn}get interfaces_(){return[]}}kn.constructor_=function(){};class Nn{constructor(){Nn.constructor_.apply(this,arguments)}setSegmentIntersector(t){this._segInt=t}getClass(){return Nn}get interfaces_(){return[kn]}}Nn.constructor_=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.setSegmentIntersector(t)}};class An extends Nn{constructor(){super(),An.constructor_.apply(this,arguments)}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return Pn.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(var e=Mn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var r=e.next();r.setId(this._idCounter++),this._index.insert(r.getEnvelope(),r),this._monoChains.add(r)}}computeNodes(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){for(var t=new Fn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var r=e.next(),n=this._index.query(r.getEnvelope()).iterator();n.hasNext();){var i=n.next();if(i.getId()>r.getId()&&(r.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}}getClass(){return An}get interfaces_(){return[]}}class Fn extends Rn{constructor(){super(),Fn.constructor_.apply(this,arguments)}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{let r=arguments[1],n=arguments[2],i=arguments[3];var t=arguments[0].getContext(),e=n.getContext();this._si.processIntersections(t,r,e,i)}}getClass(){return Fn}get interfaces_(){return[]}}Fn.constructor_=function(){this._si=null;let t=arguments[0];this._si=t},An.SegmentOverlapAction=Fn,An.constructor_=function(){if(this._monoChains=new C,this._index=new pn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){let t=arguments[0];Nn.constructor_.call(this,t)}};class Dn{constructor(){Dn.constructor_.apply(this,arguments)}rescale(){if(b(arguments[0],x))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){let e=arguments[0];for(2===e.length&&(new _(e[0]),new _(e[1])),t=0;t<e.length;t++)e[t].x=e[t].x/this._scaleFactor+this._offsetX,e[t].y=e[t].y/this._scaleFactor+this._offsetY;2===e.length&&e[0].equals2D(e[1])&&G.out.println(e)}}scale(){if(b(arguments[0],x)){let n=arguments[0];for(var t=new C(n.size()),e=n.iterator();e.hasNext();){var r=e.next();t.add(new Pn(this.scale(r.getCoordinates()),r.getData()))}return t}if(arguments[0]instanceof Array){let t=arguments[0];var n=new Array(t.length).fill(null);for(e=0;e<t.length;e++)n[e]=new _(Math.round((t[e].x-this._offsetX)*this._scaleFactor),Math.round((t[e].y-this._offsetY)*this._scaleFactor),t[e].z);return Q.removeRepeatedPoints(n)}}isIntegerPrecision(){return 1===this._scaleFactor}getNodedSubstrings(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}computeNodes(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}getClass(){return Dn}get interfaces_(){return[kn]}}Dn.constructor_=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){let t=arguments[0],e=arguments[1];Dn.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){let t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._isScaled=!this.isIntegerPrecision()}};var jn=Object.freeze({MCIndexNoder:An,ScaledNoder:Dn,SegmentString:Cn});class Gn{constructor(){Gn.constructor_.apply(this,arguments)}static isSimple(){return 1===arguments.length?new Gn(arguments[0]).isSimple():2===arguments.length?new Gn(arguments[0],arguments[1]).isSimple():void 0}isSimpleMultiPoint(t){if(t.isEmpty())return!0;for(var e=new yt,r=0;r<t.getNumGeometries();r++){var n=t.getGeometryN(r).getCoordinate();if(e.contains(n))return this._nonSimpleLocation=n,!1;e.add(n)}return!0}isSimplePolygonal(t){for(var e=Ne.getLines(t).iterator();e.hasNext();){var r=e.next();if(!this.isSimpleLinearGeometry(r))return!1}return!0}hasClosedEndpointIntersection(t){for(var e=new pt,r=t.getEdgeIterator();r.hasNext();){var n=r.next(),i=(n.getMaximumSegmentIndex(),n.isClosed()),o=n.getCoordinate(0);this.addEndpoint(e,o,i);var s=n.getCoordinate(n.getNumPoints()-1);this.addEndpoint(e,s,i)}for(r=e.values().iterator();r.hasNext();){var a=r.next();if(a.isClosed&&2!==a.degree)return this._nonSimpleLocation=a.getCoordinate(),!0}return!1}getNonSimpleLocation(){return this._nonSimpleLocation}isSimpleLinearGeometry(t){if(t.isEmpty())return!0;var e=new Vr(0,t),r=new pe,n=e.computeSelfNodes(r,!0);return!(n.hasIntersection()&&(n.hasProperIntersection()?(this._nonSimpleLocation=n.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this._isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))}hasNonEndpointIntersection(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var r=e.next(),n=r.getMaximumSegmentIndex(),i=r.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next();if(!o.isEndPoint(n))return this._nonSimpleLocation=o.getCoordinate(),!0}return!1}addEndpoint(t,e,r){var n=t.get(e);null===n&&(n=new zn(e),t.put(e,n)),n.addEndpoint(r)}computeSimple(t){return this._nonSimpleLocation=null,!!t.isEmpty()||(t instanceof Ft||t instanceof St?this.isSimpleLinearGeometry(t):t instanceof Bt?this.isSimpleMultiPoint(t):b(t,zt)?this.isSimplePolygonal(t):!(t instanceof Et)||this.isSimpleGeometryCollection(t))}isSimple(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}isSimpleGeometryCollection(t){for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);if(!this.computeSimple(r))return!1}return!0}getClass(){return Gn}get interfaces_(){return[]}}class zn{constructor(){zn.constructor_.apply(this,arguments)}addEndpoint(t){this.degree++,this.isClosed|=t}getCoordinate(){return this.pt}getClass(){return zn}get interfaces_(){return[]}}zn.constructor_=function(){this.pt=null,this.isClosed=null,this.degree=null;let t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0},Gn.EndpointInfo=zn,Gn.constructor_=function(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,1===arguments.length){let t=arguments[0];this._inputGeom=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputGeom=t,this._isClosedEndpointsInInterior=!e.isInBoundary(2)}};class Un{constructor(){Un.constructor_.apply(this,arguments)}static bufferDistanceError(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Un.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Un.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Un.JOIN_ROUND&&(this._quadrantSegments=Un.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}getClass(){return Un}get interfaces_(){return[]}}Un.constructor_=function(){if(this._quadrantSegments=Un.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=Un.CAP_ROUND,this._joinStyle=Un.JOIN_ROUND,this._mitreLimit=Un.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=Un.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(r),this.setMitreLimit(n)}},Un.CAP_ROUND=1,Un.CAP_FLAT=2,Un.CAP_SQUARE=3,Un.JOIN_ROUND=1,Un.JOIN_MITRE=2,Un.JOIN_BEVEL=3,Un.DEFAULT_QUADRANT_SEGMENTS=8,Un.DEFAULT_MITRE_LIMIT=5,Un.DEFAULT_SIMPLIFY_FACTOR=.01;class Bn{constructor(){Bn.constructor_.apply(this,arguments)}getCoordinate(){return this._minCoord}getRightmostSide(t,e){var r=this.getRightmostSideOfSegment(t,e);return r<0&&(r=this.getRightmostSideOfSegment(t,e-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),r}findRightmostEdgeAtVertex(){var t=this._minDe.getEdge().getCoordinates();m.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],r=t[this._minIndex+1],n=j.index(this._minCoord,r,e),i=!1;(e.y<this._minCoord.y&&r.y<this._minCoord.y&&n===j.COUNTERCLOCKWISE||e.y>this._minCoord.y&&r.y>this._minCoord.y&&n===j.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){var r=t.getEdge().getCoordinates();if(e<0||e+1>=r.length)return-1;if(r[e].y===r[e+1].y)return-1;var n=wr.LEFT;return r[e].y<r[e+1].y&&(n=wr.RIGHT),n}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){for(var e=t.getEdge().getCoordinates(),r=0;r<e.length-1;r++)(null===this._minCoord||e[r].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=r,this._minCoord=e[r])}findRightmostEdgeAtNode(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(var e=t.iterator();e.hasNext();){var r=e.next();r.isForward()&&this.checkForRightmostCoordinate(r)}m.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===wr.LEFT&&(this._orientedDe=this._minDe.getSym())}getClass(){return Bn}get interfaces_(){return[]}}function Vn(){this.array_=[]}Bn.constructor_=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},Vn.prototype.addLast=function(t){this.array_.push(t)},Vn.prototype.removeFirst=function(){return this.array_.shift()},Vn.prototype.isEmpty=function(){return 0===this.array_.length};class qn{constructor(){qn.constructor_.apply(this,arguments)}clearVisitedEdges(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){for(var e=null,r=t.getEdges().iterator();r.hasNext();)if((n=r.next()).isVisited()||n.getSym().isVisited()){e=n;break}if(null===e)throw new Gr("unable to find edge to compute depths at "+t.getCoordinate());for(t.getEdges().computeDepths(e),r=t.getEdges().iterator();r.hasNext();){var n;(n=r.next()).setVisited(!0),this.copySymDepths(n)}}computeDepth(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(wr.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(wr.RIGHT)>=1&&e.getDepth(wr.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){var e=new ot,r=new Vn,n=t.getNode();for(r.addLast(n),e.add(n),t.setVisited(!0);!r.isEmpty();){var i=r.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(r.addLast(a),e.add(a))}}}}compareTo(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){for(var t=new R,e=this._dirEdgeList.iterator();e.hasNext();)for(var r=e.next().getEdge().getCoordinates(),n=0;n<r.length-1;n++)t.expandToInclude(r[n]);this._env=t}return this._env}addReachable(t){var e=new $e;for(e.add(t);!e.empty();){var r=e.pop();this.add(r,e)}}copySymDepths(t){var e=t.getSym();e.setDepth(wr.LEFT,t.getDepth(wr.RIGHT)),e.setDepth(wr.RIGHT,t.getDepth(wr.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(var r=t.getEdges().iterator();r.hasNext();){var n=r.next();this._dirEdgeList.add(n);var i=n.getSym().getNode();i.isVisited()||e.push(i)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}getClass(){return qn}get interfaces_(){return[h]}}qn.constructor_=function(){this._finder=null,this._dirEdgeList=new C,this._nodes=new C,this._rightMostCoord=null,this._env=null,this._finder=new Bn};class Yn{constructor(){Yn.constructor_.apply(this,arguments)}computeRing(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=j.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;var e=t,r=!0;do{if(null===e)throw new Gr("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Gr("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var n=e.getLabel();m.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),r),r=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,r){var n=t.getCoordinates();if(e){var i=1;r&&(i=0);for(var o=i;o<n.length;o++)this._pts.add(n[o])}else for(i=n.length-2,r&&(i=n.length-1),o=i;o>=0;o--)this._pts.add(n[o])}isHole(){return this._isHole}setInResult(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!ze.isInRing(t,e.getCoordinates()))return!1;for(var r=this._holes.iterator();r.hasNext();)if(r.next().containsPoint(t))return!1;return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){let t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){let e=arguments[1];var t=arguments[0].getLocation(e,wr.RIGHT);if(t===ge.NONE)return null;if(this._label.getLocation(e)===ge.NONE)return this._label.setLocation(e,t),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){for(var e=new Array(this._holes.size()).fill(null),r=0;r<this._holes.size();r++)e[r]=this._holes.get(r).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}getClass(){return Yn}get interfaces_(){return[]}}Yn.constructor_=function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new C,this._pts=new C,this._label=new Tr(ge.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new C,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}};class Wn extends Yn{constructor(){super(),Wn.constructor_.apply(this,arguments)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}getClass(){return Wn}get interfaces_(){return[]}}Wn.constructor_=function(){let t=arguments[0],e=arguments[1];Yn.constructor_.call(this,t,e)};class Xn extends Yn{constructor(){super(),Xn.constructor_.apply(this,arguments)}buildMinimalRings(){var t=new C,e=this._startDe;do{if(null===e.getMinEdgeRing()){var r=new Wn(e,this._geometryFactory);t.add(r)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}getClass(){return Xn}get interfaces_(){return[]}}Xn.constructor_=function(){let t=arguments[0],e=arguments[1];Yn.constructor_.call(this,t,e)};class Hn{constructor(){Hn.constructor_.apply(this,arguments)}sortShellsAndHoles(t,e,r){for(var n=t.iterator();n.hasNext();){var i=n.next();i.isHole()?r.add(i):e.add(i)}}computePolygons(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next().toPolygon(this._geometryFactory);e.add(n)}return e}placeFreeHoles(t,e){for(var r=e.iterator();r.hasNext();){var n=r.next();if(null===n.getShell()){var i=this.findEdgeRingContaining(n,t);if(null===i)throw new Gr("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(i)}}}buildMinimalEdgeRings(t,e,r){for(var n=new C,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):r.addAll(s)}else n.add(o)}return n}containsPoint(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1}buildMaximalEdgeRings(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var i=new Xn(n,this._geometryFactory);e.add(i),i.setInResult()}}return e}placePolygonHoles(t,e){for(var r=e.iterator();r.hasNext();){var n=r.next();n.isHole()&&n.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findEdgeRingContaining(t,e){for(var r=t.getLinearRing(),n=r.getEnvelopeInternal(),i=r.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(n)&&ze.isInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o}findShell(t){for(var e=0,r=null,n=t.iterator();n.hasNext();){var i=n.next();i.isHole()||(r=i,e++)}return m.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),r}add(){if(1===arguments.length){let t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){let n=arguments[0],i=arguments[1];Br.linkResultDirectedEdges(i);var t=this.buildMaximalEdgeRings(n),e=new C,r=this.buildMinimalEdgeRings(t,this._shellList,e);this.sortShellsAndHoles(r,this._shellList,e),this.placeFreeHoles(this._shellList,e)}}getClass(){return Hn}get interfaces_(){return[]}}Hn.constructor_=function(){this._geometryFactory=null,this._shellList=new C;let t=arguments[0];this._geometryFactory=t};class Zn{constructor(){Zn.constructor_.apply(this,arguments)}static simplify(t,e){return new Zn(t).simplify(e)}isDeletable(t,e,r,n){var i=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[r];return!!this.isConcave(i,o,s)&&!!this.isShallow(i,o,s,n)&&this.isShallowSampled(i,o,t,r,n)}deleteShallowConcavities(){for(var t=1,e=(this._inputLine.length,this.findNextNonDeletedIndex(t)),r=this.findNextNonDeletedIndex(e),n=!1;r<this._inputLine.length;){var i=!1;this.isDeletable(t,e,r,this._distanceTol)&&(this._isDeleted[e]=Zn.DELETE,i=!0,n=!0),t=i?r:e,e=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(e)}return n}isShallowConcavity(t,e,r,n){return j.index(t,e,r)===this._angleOrientation&&B.pointToSegment(e,t,r)<n}isShallowSampled(t,e,r,n,i){var o=Math.trunc((n-r)/Zn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=r;s<n;s+=o)if(!this.isShallow(t,e,this._inputLine[s],i))return!1;return!0}isConcave(t,e,r){return j.index(t,e,r)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=j.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Zn.DELETE;)e++;return e}isShallow(t,e,r,n){return B.pointToSegment(e,t,r)<n}collapseLine(){for(var t=new P,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Zn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}getClass(){return Zn}get interfaces_(){return[]}}Zn.constructor_=function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=j.COUNTERCLOCKWISE;let t=arguments[0];this._inputLine=t},Zn.INIT=0,Zn.DELETE=1,Zn.KEEP=1,Zn.NUM_PTS_TO_CHECK=10;class Kn{constructor(){Kn.constructor_.apply(this,arguments)}getCoordinates(){return this._ptList.toArray(Kn.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){var e=new _(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(var r=0;r<t.length;r++)this.addPt(t[r]);else for(r=t.length-1;r>=0;r--)this.addPt(t[r])}isRedundant(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new se).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;var t=new _(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(this._ptList.size()>=2&&this._ptList.get(this._ptList.size()-2),t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}getClass(){return Kn}get interfaces_(){return[]}}Kn.constructor_=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new C},Kn.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class $n{constructor(){$n.constructor_.apply(this,arguments)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=j.index(this._s0,this._s1,this._s2),n=r===j.CLOCKWISE&&this._side===wr.LEFT||r===j.COUNTERCLOCKWISE&&this._side===wr.RIGHT;0===r?this.addCollinear(e):n?this.addOutsideTurn(r,e):this.addInsideTurn(r,e)}addLineEndCap(t,e){var r=new de(t,e),n=new de;this.computeOffsetSegment(r,wr.LEFT,this._distance,n);var i=new de;this.computeOffsetSegment(r,wr.RIGHT,this._distance,i);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case Un.CAP_ROUND:this._segList.addPt(n.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,j.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case Un.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(i.p1);break;case Un.CAP_SQUARE:var l=new _;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new _(n.p1.x+l.x,n.p1.y+l.y),c=new _(i.p1.x+l.x,i.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,r,n){var i=!0,o=null;try{o=z.intersection(e.p0,e.p1,r.p0,r.p1),(n<=0?1:o.distance(t)/Math.abs(n))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof M))throw t;o=new _(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,r,n,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*$n.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Un.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Un.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new _(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new _(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new _(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new _(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,r,n,i){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=r.x-t.x,u=r.y-t.y,c=Math.atan2(u,l);n===j.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,c,n,i),this._segList.addPt(r)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,r){this._s1=t,this._s2=e,this._side=r,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)}addLimitedMitreJoin(t,e,r,n){var i=this._seg0.p1,o=me.angle(i,this._seg0.p0),s=(me.angle(i,this._seg1.p1),me.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2),a=me.normalize(o+s),l=me.normalize(a+Math.PI),u=n*r,c=r-u*Math.abs(Math.sin(s)),h=i.x+u*Math.cos(l),f=i.y+u*Math.sin(l),p=new _(h,f),d=new de(i,p),g=d.pointAlongOffset(1,c),y=d.pointAlongOffset(1,-c);this._side===wr.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))}addDirectedFillet(t,e,r,n,i){var o,s=n===j.CLOCKWISE?-1:1,a=Math.abs(e-r),l=Math.trunc(a/this._filletAngleQuantum+.5);if(l<1)return null;o=a/l;for(var u=0,c=new _;u<a;){var h=e+s*u;c.x=t.x+i*Math.cos(h),c.y=t.y+i*Math.sin(h),this._segList.addPt(c),u+=o}}computeOffsetSegment(t,e,r,n){var i=e===wr.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=i*r*o/a,u=i*r*s/a;n.p0.x=t.p0.x-u,n.p0.y=t.p0.y+l,n.p1.x=t.p1.x-u,n.p1.y=t.p1.y+l}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*$n.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new _((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var n=new _((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){var e=new _(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Kn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*$n.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Un.JOIN_BEVEL||this._bufParams.getJoinStyle()===Un.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,j.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}getClass(){return $n}get interfaces_(){return[]}}$n.constructor_=function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new de,this._seg1=new de,this._offset0=new de,this._offset1=new de,this._side=0,this._hasNarrowConcaveAngle=!1;let t=arguments[0],e=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new pe,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Un.JOIN_ROUND&&(this._closingSegLengthFactor=$n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},$n.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,$n.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,$n.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,$n.MAX_CLOSING_SEG_LEN_FACTOR=80;class Jn{constructor(){Jn.constructor_.apply(this,arguments)}static copyCoordinates(t){for(var e=new Array(t.length).fill(null),r=0;r<e.length;r++)e[r]=new _(t[r]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;var r=e<0,n=Math.abs(e),i=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,r,i);var o=i.getCoordinates();return r&&Q.reverse(o),o}computeSingleSidedBufferCurve(t,e,r){var n=this.simplifyTolerance(this._distance);if(e){r.addSegments(t,!0);var i=Zn.simplify(t,-n),o=i.length-1;r.initSideSegments(i[o],i[o-1],wr.LEFT),r.addFirstSegment();for(var s=o-2;s>=0;s--)r.addNextSegment(i[s],!0)}else{r.addSegments(t,!1);var a=Zn.simplify(t,n),l=a.length-1;for(r.initSideSegments(a[0],a[1],wr.LEFT),r.addFirstSegment(),s=2;s<=l;s++)r.addNextSegment(a[s],!0)}r.addLastSegment(),r.closeRing()}computeRingBufferCurve(t,e,r){var n=this.simplifyTolerance(this._distance);e===wr.RIGHT&&(n=-n);var i=Zn.simplify(t,n),o=i.length-1;r.initSideSegments(i[o-1],i[0],e);for(var s=1;s<=o;s++){var a=1!==s;r.addNextSegment(i[s],a)}r.closeRing()}computeLineBufferCurve(t,e){var r=this.simplifyTolerance(this._distance),n=Zn.simplify(t,r),i=n.length-1;e.initSideSegments(n[0],n[1],wr.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(n[o],!0);e.addLastSegment(),e.addLineEndCap(n[i-1],n[i]);var s=Zn.simplify(t,-r),a=s.length-1;for(e.initSideSegments(s[a],s[a-1],wr.LEFT),o=a-2;o>=0;o--)e.addNextSegment(s[o],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case Un.CAP_ROUND:e.createCircle(t);break;case Un.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var r=Math.abs(e),n=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(0===r)return Jn.copyCoordinates(t);var n=this.getSegGen(r);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()}computeOffsetCurve(t,e,r){var n=this.simplifyTolerance(this._distance);if(e){var i=Zn.simplify(t,-n),o=i.length-1;r.initSideSegments(i[o],i[o-1],wr.LEFT),r.addFirstSegment();for(var s=o-2;s>=0;s--)r.addNextSegment(i[s],!0)}else{var a=Zn.simplify(t,n),l=a.length-1;for(r.initSideSegments(a[0],a[1],wr.LEFT),r.addFirstSegment(),s=2;s<=l;s++)r.addNextSegment(a[s],!0)}r.addLastSegment()}getSegGen(t){return new $n(this._precisionModel,this._bufParams,t)}getClass(){return Jn}get interfaces_(){return[]}}Jn.constructor_=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;let t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};class Qn{constructor(){Qn.constructor_.apply(this,arguments)}findStabbedSegments(){if(1===arguments.length){let i=arguments[0];for(var t=new C,e=this._subgraphs.iterator();e.hasNext();){var r=e.next(),n=r.getEnvelope();i.y<n.getMinY()||i.y>n.getMaxY()||this.findStabbedSegments(i,r.getDirectedEdges(),t)}return t}if(3===arguments.length)if(b(arguments[2],S)&&arguments[0]instanceof _&&arguments[1]instanceof zr){let t=arguments[0],r=arguments[1],n=arguments[2];var i=r.getEdge().getCoordinates();for(e=0;e<i.length-1;e++)if(this._seg.p0=i[e],this._seg.p1=i[e+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<t.x||this._seg.isHorizontal()||t.y<this._seg.p0.y||t.y>this._seg.p1.y||j.index(this._seg.p0,this._seg.p1,t)===j.RIGHT)){var o=r.getDepth(wr.LEFT);this._seg.p0.equals(i[e])||(o=r.getDepth(wr.RIGHT));var s=new ti(this._seg,o);n.add(s)}}else if(b(arguments[2],S)&&arguments[0]instanceof _&&b(arguments[1],S)){let t=arguments[0],r=arguments[2];for(e=arguments[1].iterator();e.hasNext();){var a=e.next();a.isForward()&&this.findStabbedSegments(t,a,r)}}}getDepth(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Le.min(e)._leftDepth}getClass(){return Qn}get interfaces_(){return[]}}class ti{constructor(){ti.constructor_.apply(this,arguments)}compareTo(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==r||0!=(r=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?r:this._upwardSeg.compareTo(e._upwardSeg)}compareX(t,e){var r=t.p0.compareTo(e.p0);return 0!==r?r:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}getClass(){return ti}get interfaces_(){return[h]}}ti.constructor_=function(){this._upwardSeg=null,this._leftDepth=null;let t=arguments[0],e=arguments[1];this._upwardSeg=new de(t),this._leftDepth=e},Qn.DepthSegment=ti,Qn.constructor_=function(){this._subgraphs=null,this._seg=new de;let t=arguments[0];this._subgraphs=t};class ei{constructor(){ei.constructor_.apply(this,arguments)}addPoint(t){if(this._distance<=0)return null;var e=t.getCoordinates(),r=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(r,ge.EXTERIOR,ge.INTERIOR)}addPolygon(t){var e=this._distance,r=wr.LEFT;this._distance<0&&(e=-this._distance,r=wr.RIGHT);var n=t.getExteriorRing(),i=Q.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,r,ge.EXTERIOR,ge.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Q.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,wr.opposite(r),ge.INTERIOR,ge.EXTERIOR)}}isTriangleErodedCompletely(t,e){var r=new _e(t[0],t[1],t[2]),n=r.inCentre();return B.pointToSegment(n,r.p0,r.p1)<Math.abs(e)}addLineString(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Q.removeRepeatedPoints(t.getCoordinates()),r=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(r,ge.EXTERIOR,ge.INTERIOR)}addCurve(t,e,r){if(null===t||t.length<2)return null;var n=new Pn(t,new Tr(0,ge.BOUNDARY,e,r));this._curveList.add(n)}getCurves(){return this.add(this._inputGeom),this._curveList}addPolygonRing(t,e,r,n,i){if(0===e&&t.length<Vt.MINIMUM_VALID_SIZE)return null;var o=n,s=i;t.length>=Vt.MINIMUM_VALID_SIZE&&j.isCCW(t)&&(o=i,s=n,r=wr.opposite(r));var a=this._curveBuilder.getRingCurve(t,r,e);this.addCurve(a,o,s)}add(t){if(t.isEmpty())return null;if(t instanceof Ut)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof jt)this.addPoint(t);else if(t instanceof Bt)this.addCollection(t);else if(t instanceof St)this.addCollection(t);else if(t instanceof qt)this.addCollection(t);else{if(!(t instanceof Et))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}}isErodedCompletely(t,e){var r=t.getCoordinates();if(r.length<4)return e<0;if(4===r.length)return this.isTriangleErodedCompletely(r,e);var n=t.getEnvelopeInternal(),i=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>i}addCollection(t){for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);this.add(r)}}getClass(){return ei}get interfaces_(){return[]}}ei.constructor_=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new C;let t=arguments[0],e=arguments[1],r=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=r};class ri{constructor(){ri.constructor_.apply(this,arguments)}getNextCW(t){this.getEdges();var e=this._edgeList.indexOf(t),r=e-1;return 0===e&&(r=this._edgeList.size()-1),this._edgeList.get(r)}propagateSideLabels(t){for(var e=ge.NONE,r=this.iterator();r.hasNext();)(o=(i=r.next()).getLabel()).isArea(t)&&o.getLocation(t,wr.LEFT)!==ge.NONE&&(e=o.getLocation(t,wr.LEFT));if(e===ge.NONE)return null;var n=e;for(r=this.iterator();r.hasNext();){var i,o;if((o=(i=r.next()).getLabel()).getLocation(t,wr.ON)===ge.NONE&&o.setLocation(t,wr.ON,n),o.isArea(t)){var s=o.getLocation(t,wr.LEFT),a=o.getLocation(t,wr.RIGHT);if(a!==ge.NONE){if(a!==n)throw new Gr("side location conflict",i.getCoordinate());s===ge.NONE&&m.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),n=s}else m.isTrue(o.getLocation(t,wr.LEFT)===ge.NONE,"found single null side"),o.setLocation(t,wr.RIGHT,n),o.setLocation(t,wr.LEFT,n)}}}getCoordinate(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}print(t){G.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){var e=this.getEdges();if(e.size()<=0)return!0;var r=e.size()-1,n=e.get(r).getLabel().getLocation(t,wr.LEFT);m.isTrue(n!==ge.NONE,"Found unlabelled area edge");for(var i=n,o=this.iterator();o.hasNext();){var s=o.next().getLabel();m.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,wr.LEFT),l=s.getLocation(t,wr.RIGHT);if(a===l)return!1;if(l!==i)return!1;i=a}return!0}findIndex(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new C(this._edgeMap.values())),this._edgeList}getLocation(t,e,r){return this._ptInAreaLocation[t]===ge.NONE&&(this._ptInAreaLocation[t]=Be.locate(e,r[t].getGeometry())),this._ptInAreaLocation[t]}toString(){var t=new k;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var r=e.next();t.append(r),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],r=this.iterator();r.hasNext();)for(var n=(o=r.next()).getLabel(),i=0;i<2;i++)n.isLine(i)&&n.getLocation(i)===ge.BOUNDARY&&(e[i]=!0);for(r=this.iterator();r.hasNext();){var o;for(n=(o=r.next()).getLabel(),i=0;i<2;i++)if(n.isAnyNull(i)){var s=ge.NONE;if(e[i])s=ge.EXTERIOR;else{var a=o.getCoordinate();s=this.getLocation(i,a,t)}n.setAllLocationsIfNull(i,s)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}getClass(){return ri}get interfaces_(){return[]}}ri.constructor_=function(){this._edgeMap=new pt,this._edgeList=null,this._ptInAreaLocation=[ge.NONE,ge.NONE]};class ni extends ri{constructor(){super(),ni.constructor_.apply(this,arguments)}linkResultDirectedEdges(){this.getResultAreaEdges();for(var t=null,e=null,r=this._SCANNING_FOR_INCOMING,n=0;n<this._resultAreaEdgeList.size();n++){var i=this._resultAreaEdgeList.get(n),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),r){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),r=this._SCANNING_FOR_INCOMING}}if(r===this._LINKING_TO_OUTGOING){if(null===t)throw new Gr("no outgoing dirEdge found",this.getCoordinate());m.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){var e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){var t=this.getEdges(),e=t.size();if(e<1)return null;var r=t.get(0);if(1===e)return r;var n=t.get(e-1),i=r.getQuadrant(),o=n.getQuadrant();return fr.isNorthern(i)&&fr.isNorthern(o)?r:fr.isNorthern(i)||fr.isNorthern(o)?0!==r.getDy()?r:0!==n.getDy()?n:(m.shouldNeverReachHere("found two horizontal edges incident on node"),null):n}print(t){G.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var r=e.next();t.print("out "),r.print(t),t.println(),t.print("in "),r.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new C;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(var e=this.iterator();e.hasNext();){var r=e.next().getLabel();r.setAllLocationsIfNull(0,t.getLocation(0)),r.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();for(var t=null,e=null,r=this._edgeList.size()-1;r>=0;r--){var n=this._edgeList.get(r),i=n.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=n}e.setNext(t)}computeDepths(){if(1===arguments.length){let i=arguments[0];var t=this.findIndex(i),e=(i.getLabel(),i.getDepth(wr.LEFT)),r=i.getDepth(wr.RIGHT),n=this.computeDepths(t+1,this._edgeList.size(),e);if(this.computeDepths(0,t,n)!==r)throw new Gr("depth mismatch at "+i.getCoordinate())}else if(3===arguments.length){let t=arguments[1];for(var i=arguments[2],o=arguments[0];o<t;o++){var s=this._edgeList.get(o);s.getLabel(),s.setEdgeDepths(wr.RIGHT,i),i=s.getDepth(wr.LEFT)}return i}}mergeSymLabels(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){for(var e=null,r=null,n=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),n){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;r=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;r.setNextMin(o),n=this._SCANNING_FOR_INCOMING}}n===this._LINKING_TO_OUTGOING&&(m.isTrue(null!==e,"found null for first outgoing dirEdge"),m.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),r.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){let r=arguments[0];for(t=0,e=this.iterator();e.hasNext();)e.next().getEdgeRing()===r&&t++;return t}}getLabel(){return this._label}findCoveredLineEdges(){for(var t=ge.NONE,e=this.iterator();e.hasNext();){var r=(i=e.next()).getSym();if(!i.isLineEdge()){if(i.isInResult()){t=ge.INTERIOR;break}if(r.isInResult()){t=ge.EXTERIOR;break}}}if(t===ge.NONE)return null;var n=t;for(e=this.iterator();e.hasNext();){var i;r=(i=e.next()).getSym(),i.isLineEdge()?i.getEdge().setCovered(n===ge.INTERIOR):(i.isInResult()&&(n=ge.EXTERIOR),r.isInResult()&&(n=ge.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new Tr(ge.NONE);for(var e=this.iterator();e.hasNext();)for(var r=e.next().getEdge().getLabel(),n=0;n<2;n++){var i=r.getLocation(n);i!==ge.INTERIOR&&i!==ge.BOUNDARY||this._label.setLocation(n,ge.INTERIOR)}}getClass(){return ni}get interfaces_(){return[]}}ni.constructor_=function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2};class ii extends Ur{constructor(){super(),ii.constructor_.apply(this,arguments)}createNode(t){return new Fr(t,new ni)}getClass(){return ii}get interfaces_(){return[]}}ii.constructor_=function(){};class oi{constructor(){oi.constructor_.apply(this,arguments)}static orientation(t){return 1===Q.increasingDirection(t)}static compareOriented(t,e,r,n){for(var i=e?1:-1,o=n?1:-1,s=e?t.length:-1,a=n?r.length:-1,l=e?0:t.length-1,u=n?0:r.length-1;;){var c=t[l].compareTo(r[u]);if(0!==c)return c;var h=(l+=i)===s,f=(u+=o)===a;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}}compareTo(t){var e=t;return oi.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}getClass(){return oi}get interfaces_(){return[h]}}oi.constructor_=function(){this._pts=null,this._orientation=null;let t=arguments[0];this._pts=t,this._orientation=oi.orientation(t)};class si{constructor(){si.constructor_.apply(this,arguments)}print(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var r=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var n=r.getCoordinates(),i=0;i<n.length;i++)i>0&&t.print(","),t.print(n[i].x+" "+n[i].y);t.println(")")}t.print(")  ")}addAll(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){var e=new oi(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);var e=new oi(t.getCoordinates());this._ocaMap.put(e,t)}getClass(){return si}get interfaces_(){return[]}}si.constructor_=function(){this._edges=new C,this._ocaMap=new pt};class ai{constructor(){ai.constructor_.apply(this,arguments)}processIntersections(t,e,r,n){}isDone(){}getClass(){return ai}get interfaces_(){return[]}}ai.constructor_=function(){};class li{constructor(){li.constructor_.apply(this,arguments)}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,r,n){if(t===r&&1===this._li.getIntersectionNum()){if(li.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,r,n){if(t===r&&e===n)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=r.getCoordinates()[n],a=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,r,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),r.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}getClass(){return li}get interfaces_(){return[ai]}}li.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;let t=arguments[0];this._li=t};class ui{constructor(){ui.constructor_.apply(this,arguments)}static depthDelta(t){var e=t.getLocation(0,wr.LEFT),r=t.getLocation(0,wr.RIGHT);return e===ge.INTERIOR&&r===ge.EXTERIOR?1:e===ge.EXTERIOR&&r===ge.INTERIOR?-1:0}static convertSegStrings(t){for(var e=new se,r=new C;t.hasNext();){var n=t.next(),i=e.createLineString(n.getCoordinates());r.add(i)}return e.buildGeometry(r)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var r=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Tr(t.getLabel())).flip(),r.merge(n);var i=ui.depthDelta(n),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ui.depthDelta(t.getLabel()))}buildSubgraphs(t,e){for(var r=new C,n=t.iterator();n.hasNext();){var i=n.next(),o=i.getRightmostCoordinate(),s=new Qn(r).getDepth(o);i.computeDepth(s),i.findResultEdges(),r.add(i),e.add(i.getDirectedEdges(),i.getNodes())}}createSubgraphs(t){for(var e=new C,r=t.getNodes().iterator();r.hasNext();){var n=r.next();if(!n.isVisited()){var i=new qn;i.create(n),e.add(i)}}return Le.sort(e,Le.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;var e=new An,r=new pe;return r.setPrecisionModel(t),e.setSegmentIntersector(new li(r)),e}buffer(t,e){var r=this._workingPrecisionModel;null===r&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var n=new Jn(r,this._bufParams),i=new ei(t,e,n).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,r),this._graph=new Br(new ii),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Hn(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){var r=this.getNoder(e);r.computeNodes(t);for(var n=r.getNodedSubstrings().iterator();n.hasNext();){var i=n.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=i.getData(),a=new Ar(i.getCoordinates(),new Tr(s));this.insertUniqueEdge(a)}}}setNoder(t){this._workingNoder=t}getClass(){return ui}get interfaces_(){return[]}}ui.constructor_=function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new si;let t=arguments[0];this._bufParams=t};class ci{constructor(){ci.constructor_.apply(this,arguments)}checkEndPtVertexIntersections(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length){let n=arguments[0];for(t=arguments[1].iterator();t.hasNext();){e=t.next().getCoordinates();for(var r=1;r<e.length-1;r++)if(e[r].equals(n))throw new g("found endpt/interior pt intersection at index "+r+" :pt "+n)}}}checkInteriorIntersections(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),r=this._segStrings.iterator();r.hasNext();){var n=r.next();this.checkInteriorIntersections(e,n)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];for(var i=t.getCoordinates(),o=e.getCoordinates(),s=0;s<i.length-1;s++)for(var a=0;a<o.length-1;a++)this.checkInteriorIntersections(t,s,e,a)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];if(t===r&&e===n)return null;var l=t.getCoordinates()[e],u=t.getCoordinates()[e+1],c=r.getCoordinates()[n],h=r.getCoordinates()[n+1];if(this._li.computeIntersection(l,u,c,h),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,l,u)||this.hasInteriorIntersection(this._li,c,h)))throw new g("found non-noded intersection at "+l+"-"+u+" and "+c+"-"+h)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length){var r=arguments[0].getCoordinates();for(t=0;t<r.length-2;t++)this.checkCollapse(r[t],r[t+1],r[t+2])}}hasInteriorIntersection(t,e,r){for(var n=0;n<t.getIntersectionNum();n++){var i=t.getIntersection(n);if(!i.equals(e)&&!i.equals(r))return!0}return!1}checkCollapse(t,e,r){if(t.equals(r))throw new g("found non-noded collapse at "+ci.fact.createLineString([t,e,r]))}getClass(){return ci}get interfaces_(){return[]}}ci.constructor_=function(){this._li=new pe,this._segStrings=null;let t=arguments[0];this._segStrings=t},ci.fact=new se;class hi{constructor(){hi.constructor_.apply(this,arguments)}intersectsScaled(t,e){var r=Math.min(t.x,e.x),n=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<r||this._minx>n||this._maxy<i||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return m.isTrue(!(s&&a),"Found bad envelope test"),a}initCorners(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new _(this._maxx,this._maxy),this._corner[1]=new _(this._minx,this._maxy),this._corner[2]=new _(this._minx,this._miny),this._corner[3]=new _(this._maxx,this._miny)}intersects(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(t){return Math.round(t*this._scaleFactor)}getCoordinate(){return this._originalPt}copyScaled(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}getSafeEnvelope(){if(null===this._safeEnv){var t=hi.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new R(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}intersectsPixelClosure(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))}intersectsToleranceSquare(t,e){var r=!1,n=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||r&&n||t.equals(this._pt)||e.equals(this._pt)))))}addSnappedNode(t,e){var r=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(r,n)&&(t.addIntersection(this.getCoordinate(),e),!0)}getClass(){return hi}get interfaces_(){return[]}}hi.constructor_=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;let t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new r("Scale factor must be non-zero");1!==e&&(this._pt=new _(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new _,this._p1Scaled=new _),this.initCorners(this._pt)},hi.SAFE_ENV_EXPANSION_FACTOR=.75;class fi{constructor(){fi.constructor_.apply(this,arguments)}select(){if(1===arguments.length);else if(2===arguments.length){let t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}getClass(){return fi}get interfaces_(){return[]}}fi.constructor_=function(){this.selectedSegment=new de};class pi{constructor(){pi.constructor_.apply(this,arguments)}snap(){if(1===arguments.length){let t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){let r=arguments[0],n=arguments[1],i=arguments[2];var t=r.getSafeEnvelope(),e=new di(r,n,i);return this._index.query(t,new class{get interfaces_(){return[Oe]}visitItem(r){r.select(t,e)}}),e.isNodeAdded()}}getClass(){return pi}get interfaces_(){return[]}}class di extends fi{constructor(){super(),di.constructor_.apply(this,arguments)}isNodeAdded(){return this._isNodeAdded}select(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof Ln))return super.select.apply(this,arguments);{let e=arguments[1];var t=arguments[0].getContext();if(null!==this._parentEdge&&t===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(t,e)}}getClass(){return di}get interfaces_(){return[]}}di.constructor_=function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;let t=arguments[0],e=arguments[1],r=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=r},pi.HotPixelSnapAction=di,pi.constructor_=function(){this._index=null;let t=arguments[0];this._index=t};class gi{constructor(){gi.constructor_.apply(this,arguments)}processIntersections(t,e,r,n){if(t===r&&e===n)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=r.getCoordinates()[n],a=r.getCoordinates()[n+1];if(this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),r.addIntersections(this._li,n,1)}}isDone(){return!1}getInteriorIntersections(){return this._interiorIntersections}getClass(){return gi}get interfaces_(){return[ai]}}gi.constructor_=function(){this._li=null,this._interiorIntersections=null;let t=arguments[0];this._li=t,this._interiorIntersections=new C};class yi{constructor(){yi.constructor_.apply(this,arguments)}checkCorrectness(t){var e=Pn.getNodedSubstrings(t),r=new ci(e);try{r.checkValid()}catch(t){if(!(t instanceof L))throw t;t.printStackTrace()}}getNodedSubstrings(){return Pn.getNodedSubstrings(this._nodedSegStrings)}snapRound(t,e){var r=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(r),this.computeVertexSnaps(t)}findInteriorIntersections(t,e){var r=new gi(e);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(t),r.getInteriorIntersections()}computeVertexSnaps(){if(b(arguments[0],x))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Pn){let t=arguments[0];for(var r=t.getCoordinates(),n=0;n<r.length;n++){var i=new hi(r[n],this._scaleFactor,this._li);this._pointSnapper.snap(i,t,n)&&t.addIntersection(r[n],n)}}}computeNodes(t){this._nodedSegStrings=t,this._noder=new An,this._pointSnapper=new pi(this._noder.getIndex()),this.snapRound(t,this._li)}computeIntersectionSnaps(t){for(var e=t.iterator();e.hasNext();){var r=e.next(),n=new hi(r,this._scaleFactor,this._li);this._pointSnapper.snap(n)}}getClass(){return yi}get interfaces_(){return[kn]}}yi.constructor_=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;let t=arguments[0];this._pm=t,this._li=new pe,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};class mi{constructor(){mi.constructor_.apply(this,arguments)}static bufferOp(){if(2===arguments.length){let t=arguments[1];return new mi(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof W&&"number"==typeof arguments[1]){let e=arguments[1],r=arguments[2];return(t=new mi(arguments[0])).setQuadrantSegments(r),t.getResultGeometry(e)}if(arguments[2]instanceof Un&&arguments[0]instanceof W&&"number"==typeof arguments[1]){let e=arguments[1];return(t=new mi(arguments[0],arguments[2])).getResultGeometry(e)}}else if(4===arguments.length){let e=arguments[1],r=arguments[2],n=arguments[3];var t;return(t=new mi(arguments[0])).setQuadrantSegments(r),t.setEndCapStyle(n),t.getResultGeometry(e)}}static precisionScaleFactor(t,e,r){var n=t.getEnvelopeInternal(),i=U.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(e>0?e:0),o=r-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)}bufferFixedPrecision(t){var e=new Dn(new yi(new ie(1)),t.getScale()),r=new ui(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(e),this._resultGeometry=r.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(0===arguments.length){for(var t=mi.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof Gr))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){let t=arguments[0];var e=mi.precisionScaleFactor(this._argGeom,this._distance,t),r=new ie(e);this.bufferFixedPrecision(r)}}computeGeometry(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===ie.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}setQuadrantSegments(t){this._bufParams.setQuadrantSegments(t)}bufferOriginalPrecision(){try{var t=new ui(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof g))throw t;this._saveException=t}}getResultGeometry(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}setEndCapStyle(t){this._bufParams.setEndCapStyle(t)}getClass(){return mi}get interfaces_(){return[]}}mi.constructor_=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Un,this._resultGeometry=null,this._saveException=null,1===arguments.length){let t=arguments[0];this._argGeom=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._argGeom=t,this._bufParams=e}},mi.CAP_ROUND=Un.CAP_ROUND,mi.CAP_BUTT=Un.CAP_FLAT,mi.CAP_FLAT=Un.CAP_FLAT,mi.CAP_SQUARE=Un.CAP_SQUARE,mi.MAX_PRECISION_DIGITS=12;var _i=Object.freeze({BufferOp:mi,BufferParameters:Un});class vi{constructor(){vi.constructor_.apply(this,arguments)}static getPolygons(){if(1===arguments.length){let t=arguments[0];return vi.getPolygons(t,new C)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t instanceof Ut?e.add(t):t instanceof Et&&t.apply(new vi(e)),e}}filter(t){t instanceof Ut&&this._comps.add(t)}getClass(){return vi}get interfaces_(){return[wt]}}vi.constructor_=function(){this._comps=null;let t=arguments[0];this._comps=t};class bi{constructor(){bi.constructor_.apply(this,arguments)}isInsideArea(){return this._segIndex===bi.INSIDE_AREA}getCoordinate(){return this._pt}getGeometryComponent(){return this._component}getSegmentIndex(){return this._segIndex}getClass(){return bi}get interfaces_(){return[]}}bi.constructor_=function(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){let t=arguments[0],e=arguments[1];bi.constructor_.call(this,t,bi.INSIDE_AREA,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._component=t,this._segIndex=e,this._pt=r}},bi.INSIDE_AREA=-1;class wi{constructor(){wi.constructor_.apply(this,arguments)}static getPoints(){if(1===arguments.length){let t=arguments[0];return t instanceof jt?Le.singletonList(t):wi.getPoints(t,new C)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t instanceof jt?e.add(t):t instanceof Et&&t.apply(new wi(e)),e}}filter(t){t instanceof jt&&this._pts.add(t)}getClass(){return wi}get interfaces_(){return[wt]}}wi.constructor_=function(){this._pts=null;let t=arguments[0];this._pts=t};class xi{constructor(){xi.constructor_.apply(this,arguments)}static getLocations(t){var e=new C;return t.apply(new xi(e)),e}filter(t){(t instanceof jt||t instanceof Ft||t instanceof Ut)&&this._locations.add(new bi(t,0,t.getCoordinate()))}getClass(){return xi}get interfaces_(){return[wt]}}xi.constructor_=function(){this._locations=null;let t=arguments[0];this._locations=t};class Ei{constructor(){Ei.constructor_.apply(this,arguments)}static distance(t,e){return new Ei(t,e).distance()}static isWithinDistance(t,e,r){return!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>r)&&new Ei(t,e,r).distance()<=r}static nearestPoints(t,e){return new Ei(t,e).nearestPoints()}computeContainmentDistance(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){let t=arguments[0],o=arguments[1];var e=this._geom[t];if(e.getDimension()<2)return null;var r=1-t,n=vi.getPolygons(e);if(n.size()>0){var i=xi.getLocations(this._geom[r]);if(this.computeContainmentDistance(i,n,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=o[0],this._minDistanceLocation[t]=o[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&b(arguments[0],S)&&b(arguments[1],S)){let t=arguments[0],e=arguments[1],r=arguments[2];for(var o=0;o<t.size();o++)for(var s=t.get(o),a=0;a<e.size();a++)if(this.computeContainmentDistance(s,e.get(a),r),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof bi&&arguments[1]instanceof Ut){let t=arguments[0],e=arguments[1],r=arguments[2];var l=t.getCoordinate();if(ge.EXTERIOR!==this._ptLocator.locate(l,e))return this._minDistance=0,r[0]=t,r[1]=new bi(e,l),null}}computeMinDistanceLinesPoints(t,e,r){for(var n=0;n<t.size();n++)for(var i=t.get(n),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,r),this._minDistance<=this._terminateDistance)return null}}computeFacetDistance(){var t=new Array(2).fill(null),e=Ne.getLines(this._geom[0]),r=Ne.getLines(this._geom[1]),n=wi.getPoints(this._geom[0]),i=wi.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(r,n,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,i,t),void this.updateMinDistance(t,!1))))}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof jt){let i=arguments[0],o=arguments[1],a=arguments[2];if(i.getEnvelopeInternal().distance(o.getEnvelopeInternal())>this._minDistance)return null;for(var t=i.getCoordinates(),e=o.getCoordinate(),r=0;r<t.length-1;r++){if((s=B.pointToSegment(e,t[r],t[r+1]))<this._minDistance){this._minDistance=s;var n=new de(t[r],t[r+1]).closestPoint(e);a[0]=new bi(i,r,n),a[1]=new bi(o,0,e)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof Ft){let e=arguments[0],n=arguments[1],c=arguments[2];if(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>this._minDistance)return null;t=e.getCoordinates();var i=n.getCoordinates();for(r=0;r<t.length-1;r++)for(var o=0;o<i.length-1;o++){var s;if((s=B.segmentToSegment(t[r],t[r+1],i[o],i[o+1]))<this._minDistance){this._minDistance=s;var a=new de(t[r],t[r+1]),l=new de(i[o],i[o+1]),u=a.closestPoints(l);c[0]=new bi(e,r,u[0]),c[1]=new bi(n,o,u[1])}if(this._minDistance<=this._terminateDistance)return null}}}computeMinDistancePoints(t,e,r){for(var n=0;n<t.size();n++)for(var i=t.get(n),o=0;o<e.size();o++){var s=e.get(o),a=i.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,r[0]=new bi(i,0,i.getCoordinate()),r[1]=new bi(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}distance(){if(null===this._geom[0]||null===this._geom[1])throw new r("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(t,e,r){for(var n=0;n<t.size();n++)for(var i=t.get(n),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,r),this._minDistance<=this._terminateDistance)return null}}getClass(){return Ei}get interfaces_(){return[]}}Ei.constructor_=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new br,this._minDistanceLocation=null,this._minDistance=i.MAX_VALUE,2===arguments.length){let t=arguments[0],e=arguments[1];Ei.constructor_.call(this,t,e,0)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e,this._terminateDistance=r}};var Si=Object.freeze({DistanceOp:Ei});class Ii{constructor(){Ii.constructor_.apply(this,arguments)}getCoordinates(){if(null===this._coordinates){for(var t=0,e=0,r=new P,n=this._directedEdges.iterator();n.hasNext();){var i=n.next();i.getEdgeDirection()?t++:e++,r.add(i.getEdge().getLine().getCoordinates(),!1,i.getEdgeDirection())}this._coordinates=r.toCoordinateArray(),e>t&&Q.reverse(this._coordinates)}return this._coordinates}toLineString(){return this._factory.createLineString(this.getCoordinates())}add(t){this._directedEdges.add(t)}getClass(){return Ii}get interfaces_(){return[]}}Ii.constructor_=function(){this._factory=null,this._directedEdges=new C,this._coordinates=null;let t=arguments[0];this._factory=t};class Oi{constructor(){Oi.constructor_.apply(this,arguments)}static getComponentWithVisitedState(t,e){for(;t.hasNext();){var r=t.next();if(r.isVisited()===e)return r}return null}static setVisited(t,e){for(;t.hasNext();)t.next().setVisited(e)}static setMarked(t,e){for(;t.hasNext();)t.next().setMarked(e)}setVisited(t){this._isVisited=t}isMarked(){return this._isMarked}setData(t){this._data=t}getData(){return this._data}setMarked(t){this._isMarked=t}getContext(){return this._data}isVisited(){return this._isVisited}setContext(t){this._data=t}getClass(){return Oi}get interfaces_(){return[]}}Oi.constructor_=function(){this._isMarked=!1,this._isVisited=!1,this._data=null};class Ci extends Oi{constructor(){super(),Ci.constructor_.apply(this,arguments)}static toEdges(t){for(var e=new C,r=t.iterator();r.hasNext();)e.add(r.next()._parentEdge);return e}isRemoved(){return null===this._parentEdge}compareDirection(t){return this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:j.index(t._p0,t._p1,this._p1)}getCoordinate(){return this._from.getCoordinate()}print(t){var e=this.getClass().getName(),r=e.lastIndexOf("."),n=e.substring(r+1);t.print("  "+n+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}getDirectionPt(){return this._p1}getAngle(){return this._angle}compareTo(t){var e=t;return this.compareDirection(e)}getFromNode(){return this._from}getSym(){return this._sym}setEdge(t){this._parentEdge=t}remove(){this._sym=null,this._parentEdge=null}getEdge(){return this._parentEdge}getQuadrant(){return this._quadrant}setSym(t){this._sym=t}getToNode(){return this._to}getEdgeDirection(){return this._edgeDirection}getClass(){return Ci}get interfaces_(){return[h]}}Ci.constructor_=function(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,0===arguments.length);else if(4===arguments.length){let r=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3];this._from=r,this._to=n,this._edgeDirection=o,this._p0=r.getCoordinate(),this._p1=i;var t=this._p1.x-this._p0.x,e=this._p1.y-this._p0.y;this._quadrant=fr.quadrant(t,e),this._angle=Math.atan2(e,t)}};class Ti extends Ci{constructor(){super(),Ti.constructor_.apply(this,arguments)}getNext(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(m.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}getClass(){return Ti}get interfaces_(){return[]}}Ti.constructor_=function(){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];Ci.constructor_.call(this,t,e,r,n)};class Pi extends Oi{constructor(){super(),Pi.constructor_.apply(this,arguments)}isRemoved(){return null===this._dirEdge}setDirectedEdges(t,e){this._dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)}getDirEdge(){if(Number.isInteger(arguments[0])){let t=arguments[0];return this._dirEdge[t]}if(arguments[0]instanceof Li){let t=arguments[0];return this._dirEdge[0].getFromNode()===t?this._dirEdge[0]:this._dirEdge[1].getFromNode()===t?this._dirEdge[1]:null}}remove(){this._dirEdge=null}getOppositeNode(t){return this._dirEdge[0].getFromNode()===t?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===t?this._dirEdge[1].getToNode():null}getClass(){return Pi}get interfaces_(){return[]}}Pi.constructor_=function(){if(this._dirEdge=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}};class Ri{constructor(){Ri.constructor_.apply(this,arguments)}getNextEdge(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e+1))}getCoordinate(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}iterator(){return this.sortEdges(),this._outEdges.iterator()}sortEdges(){this._sorted||(Le.sort(this._outEdges),this._sorted=!0)}remove(t){this._outEdges.remove(t)}getEdges(){return this.sortEdges(),this._outEdges}getNextCWEdge(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e-1))}getIndex(){if(arguments[0]instanceof Pi){let e=arguments[0];this.sortEdges();for(var t=0;t<this._outEdges.size();t++)if(this._outEdges.get(t).getEdge()===e)return t;return-1}if(arguments[0]instanceof Ci){let e=arguments[0];for(this.sortEdges(),t=0;t<this._outEdges.size();t++)if(this._outEdges.get(t)===e)return t;return-1}if(Number.isInteger(arguments[0])){var e=arguments[0]%this._outEdges.size();return e<0&&(e+=this._outEdges.size()),e}}add(t){this._outEdges.add(t),this._sorted=!1}getDegree(){return this._outEdges.size()}getClass(){return Ri}get interfaces_(){return[]}}Ri.constructor_=function(){this._outEdges=new C,this._sorted=!1};class Li extends Oi{constructor(){super(),Li.constructor_.apply(this,arguments)}static getEdgesBetween(t,e){var r=new ot(Ci.toEdges(t.getOutEdges().getEdges())),n=Ci.toEdges(e.getOutEdges().getEdges());return r.retainAll(n),r}isRemoved(){return null===this._pt}addOutEdge(t){this._deStar.add(t)}getCoordinate(){return this._pt}getOutEdges(){return this._deStar}remove(){if(0===arguments.length)this._pt=null;else if(1===arguments.length){let t=arguments[0];this._deStar.remove(t)}}getIndex(t){return this._deStar.getIndex(t)}getDegree(){return this._deStar.getDegree()}getClass(){return Li}get interfaces_(){return[]}}Li.constructor_=function(){if(this._pt=null,this._deStar=null,1===arguments.length){let t=arguments[0];Li.constructor_.call(this,t,new Ri)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._pt=t,this._deStar=e}};class Mi extends Pi{constructor(){super(),Mi.constructor_.apply(this,arguments)}getLine(){return this._line}getClass(){return Mi}get interfaces_(){return[]}}Mi.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class ki{constructor(){ki.constructor_.apply(this,arguments)}find(t){return this._nodeMap.get(t)}iterator(){return this._nodeMap.values().iterator()}remove(t){return this._nodeMap.remove(t)}values(){return this._nodeMap.values()}add(t){return this._nodeMap.put(t.getCoordinate(),t),t}getClass(){return ki}get interfaces_(){return[]}}ki.constructor_=function(){this._nodeMap=new pt};class Ni{constructor(){Ni.constructor_.apply(this,arguments)}findNodesOfDegree(t){for(var e=new C,r=this.nodeIterator();r.hasNext();){var n=r.next();n.getDegree()===t&&e.add(n)}return e}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}remove(){if(arguments[0]instanceof Pi){let t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this._edges.remove(t),t.remove()}else if(arguments[0]instanceof Ci){let t=arguments[0];null!==(e=t.getSym())&&e.setSym(null),t.getFromNode().remove(t),t.remove(),this._dirEdges.remove(t)}else if(arguments[0]instanceof Li){let i=arguments[0];for(var t=i.getOutEdges().getEdges().iterator();t.hasNext();){var e,r=t.next();null!==(e=r.getSym())&&this.remove(e),this._dirEdges.remove(r);var n=r.getEdge();null!==n&&this._edges.remove(n)}this._nodeMap.remove(i.getCoordinate()),i.remove()}}findNode(t){return this._nodeMap.find(t)}getEdges(){return this._edges}nodeIterator(){return this._nodeMap.iterator()}contains(){if(arguments[0]instanceof Pi){let t=arguments[0];return this._edges.contains(t)}if(arguments[0]instanceof Ci){let t=arguments[0];return this._dirEdges.contains(t)}}add(){if(arguments[0]instanceof Li){let t=arguments[0];this._nodeMap.add(t)}else if(arguments[0]instanceof Pi){let t=arguments[0];this._edges.add(t),this.add(t.getDirEdge(0)),this.add(t.getDirEdge(1))}else if(arguments[0]instanceof Ci){let t=arguments[0];this._dirEdges.add(t)}}getNodes(){return this._nodeMap.values()}getClass(){return Ni}get interfaces_(){return[]}}Ni.constructor_=function(){this._edges=new ot,this._dirEdges=new ot,this._nodeMap=new ki};class Ai extends Ni{constructor(){super(),Ai.constructor_.apply(this,arguments)}addEdge(t){if(t.isEmpty())return null;var e=Q.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var r=e[0],n=e[e.length-1],i=this.getNode(r),o=this.getNode(n),s=new Ti(i,o,e[1],!0),a=new Ti(o,i,e[e.length-2],!1),l=new Mi(t);l.setDirectedEdges(s,a),this.add(l)}getNode(t){var e=this.findNode(t);return null===e&&(e=new Li(t),this.add(e)),e}getClass(){return Ai}get interfaces_(){return[]}}Ai.constructor_=function(){};class Fi{constructor(){Fi.constructor_.apply(this,arguments)}buildEdgeStringsForUnprocessedNodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(m.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForNonDegree2Nodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForObviousStartNodes(){this.buildEdgeStringsForNonDegree2Nodes()}getMergedLineStrings(){return this.merge(),this._mergedLineStrings}buildEdgeStringsStartingAt(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var r=e.next();r.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(r))}}merge(){if(null!==this._mergedLineStrings)return null;Oi.setMarked(this._graph.nodeIterator(),!1),Oi.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new C,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new C;for(var t=this._edgeStrings.iterator();t.hasNext();){var e=t.next();this._mergedLineStrings.add(e.toLineString())}}buildEdgeStringStartingWith(t){var e=new Ii(this._factory),r=t;do{e.add(r),r.getEdge().setMarked(!0),r=r.getNext()}while(null!==r&&r!==t);return e}add(){if(arguments[0]instanceof W)arguments[0].apply(new class{get interfaces_(){return[Y]}filter(t){t instanceof Ft&&this.add(t)}});else if(b(arguments[0],x)){let r=arguments[0];this._mergedLineStrings=null;for(var t=r.iterator();t.hasNext();){var e=t.next();this.add(e)}}else if(arguments[0]instanceof Ft){let t=arguments[0];null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t)}}buildEdgeStringsForIsolatedLoops(){this.buildEdgeStringsForUnprocessedNodes()}getClass(){return Fi}get interfaces_(){return[]}}Fi.constructor_=function(){this._graph=new Ai,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null};var Di=Object.freeze({LineMerger:Fi});class ji{constructor(){ji.constructor_.apply(this,arguments)}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:On.octant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}getData(){return this._data}toString(){return he.toLineString(new Kt(this._pts))}getClass(){return ji}get interfaces_(){return[Cn]}}ji.constructor_=function(){this._pts=null,this._data=null;let t=arguments[0],e=arguments[1];this._pts=t,this._data=e};class Gi{constructor(){Gi.constructor_.apply(this,arguments)}static createAllIntersectionsFinder(t){var e=new Gi(t);return e.setFindAllIntersections(!0),e}static createAnyIntersectionFinder(t){return new Gi(t)}static createIntersectionCounter(t){var e=new Gi(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}getInteriorIntersection(){return this._interiorIntersection}setCheckEndSegmentsOnly(t){this._isCheckEndSegmentsOnly=t}getIntersectionSegments(){return this._intSegments}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(t){this._findAllIntersections=t}setKeepIntersections(t){this._keepIntersections=t}processIntersections(t,e,r,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===r&&e===n)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(r,n))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=r.getCoordinates()[n],a=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}isEndSegment(t,e){return 0===e||e>=t.size()-2}hasIntersection(){return null!==this._interiorIntersection}isDone(){return!this._findAllIntersections&&null!==this._interiorIntersection}getClass(){return Gi}get interfaces_(){return[ai]}}Gi.constructor_=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new C,this._intersectionCount=0,this._keepIntersections=!0;let t=arguments[0];this._li=t,this._interiorIntersection=null};class zi{constructor(){zi.constructor_.apply(this,arguments)}static computeIntersections(t){var e=new zi(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()}execute(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(t){this._findAllIntersections=t}checkInteriorIntersections(){this._isValid=!0,this._segInt=new Gi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new An;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new Gr(this.getErrorMessage(),this._segInt.getInteriorIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+he.toLineString(t[0],t[1])+" and "+he.toLineString(t[2],t[3])}getClass(){return zi}get interfaces_(){return[]}}zi.constructor_=function(){this._li=new pe,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;let t=arguments[0];this._segStrings=t};class Ui{constructor(){Ui.constructor_.apply(this,arguments)}static toSegmentStrings(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next();e.add(new ji(n.getCoordinates(),n))}return e}static checkValid(t){new Ui(t).checkValid()}checkValid(){this._nv.checkValid()}getClass(){return Ui}get interfaces_(){return[]}}Ui.constructor_=function(){this._nv=null;let t=arguments[0];this._nv=new zi(Ui.toSegmentStrings(t))};class Bi{constructor(){Bi.constructor_.apply(this,arguments)}static map(t,e){return new Bi(e).map(t)}map(t){for(var e=new C,r=0;r<t.getNumGeometries();r++){var n=this._mapOp.map(t.getGeometryN(r));n.isEmpty()||e.add(n)}return t.getFactory().createGeometryCollection(se.toGeometryArray(e))}getClass(){return Bi}get interfaces_(){return[]}}Bi.constructor_=function(){this._mapOp=null;let t=arguments[0];this._mapOp=t};class Vi{constructor(){Vi.constructor_.apply(this,arguments)}collectLines(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var r=e.next();this.collectLineEdge(r,t,this._lineEdgesList),this.collectBoundaryTouchEdge(r,t,this._lineEdgesList)}}labelIsolatedLine(t,e){var r=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,r)}build(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}collectLineEdge(t,e,r){var n=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!eo.isResultOfOp(n,e)||i.isCovered()||(r.add(i),t.setVisitedEdge(!0)))}findCoveredLineEdges(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var r=e.next(),n=r.getEdge();if(r.isLineEdge()&&!n.isCoveredSet()){var i=this._op.isCoveredByA(r.getCoordinate());n.setCovered(i)}}}labelIsolatedLines(t){for(var e=t.iterator();e.hasNext();){var r=e.next(),n=r.getLabel();r.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(r,0):this.labelIsolatedLine(r,1))}}buildLines(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var r=e.next(),n=(r.getLabel(),this._geometryFactory.createLineString(r.getCoordinates()));this._resultLineList.add(n),r.setInResult(!0)}}collectBoundaryTouchEdge(t,e,r){var n=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(m.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(eo.isResultOfOp(n,e)&&e===eo.INTERSECTION&&(r.add(t.getEdge()),t.setVisitedEdge(!0))))}getClass(){return Vi}get interfaces_(){return[]}}Vi.constructor_=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new C,this._resultLineList=new C;let t=arguments[0],e=arguments[1],r=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=r};class qi{constructor(){qi.constructor_.apply(this,arguments)}filterCoveredNodeToPoint(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var r=this._geometryFactory.createPoint(e);this._resultPointList.add(r)}}extractNonCoveredResultNodes(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var r=e.next();if(!(r.isInResult()||r.isIncidentEdgeInResult()||0!==r.getEdges().getDegree()&&t!==eo.INTERSECTION)){var n=r.getLabel();eo.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(r)}}}build(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}getClass(){return qi}get interfaces_(){return[]}}qi.constructor_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new C;let t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};class Yi{constructor(){Yi.constructor_.apply(this,arguments)}static isClosed(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}snapVertices(t,e){for(var r=this._isClosed?t.size()-1:t.size(),n=0;n<r;n++){var i=t.get(n),o=this.findSnapForVertex(i,e);null!==o&&(t.set(n,new _(o)),0===n&&this._isClosed&&t.set(t.size()-1,new _(o)))}}findSnapForVertex(t,e){for(var r=0;r<e.length;r++){if(t.equals2D(e[r]))return null;if(t.distance(e[r])<this._snapTolerance)return e[r]}return null}snapTo(t){var e=new P(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()}snapSegments(t,e){if(0===e.length)return null;var r=e.length;e[0].equals2D(e[e.length-1])&&(r=e.length-1);for(var n=0;n<r;n++){var i=e[n],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new _(i),!1)}}findSegmentIndexToSnap(t,e){for(var r=i.MAX_VALUE,n=-1,o=0;o<e.size()-1;o++){if(this._seg.p0=e.get(o),this._seg.p1=e.get(o+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var s=this._seg.distance(t);s<this._snapTolerance&&s<r&&(r=s,n=o)}return n}setAllowSnappingToSourceVertices(t){this._allowSnappingToSourceVertices=t}getClass(){return Yi}get interfaces_(){return[]}}Yi.constructor_=function(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new de,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Ft&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];Yi.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];this._srcPts=t,this._isClosed=Yi.isClosed(t),this._snapTolerance=e}};class Wi{constructor(){Wi.constructor_.apply(this,arguments)}static snap(t,e,r){var n=new Array(2).fill(null),i=new Wi(t);n[0]=i.snapTo(e,r);var o=new Wi(e);return n[1]=o.snapTo(n[0],r),n}static computeOverlaySnapTolerance(){if(1===arguments.length){let n=arguments[0];var t=Wi.computeSizeBasedSnapTolerance(n),e=n.getPrecisionModel();if(e.getType()===ie.FIXED){var r=1/e.getScale()*2/1.415;r>t&&(t=r)}return t}if(2===arguments.length){let t=arguments[0],e=arguments[1];return Math.min(Wi.computeOverlaySnapTolerance(t),Wi.computeOverlaySnapTolerance(e))}}static computeSizeBasedSnapTolerance(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Wi.SNAP_PRECISION_FACTOR}static snapToSelf(t,e,r){return new Wi(t).snapToSelf(e,r)}snapTo(t,e){var r=this.extractTargetCoordinates(t);return new Xi(e,r).transform(this._srcGeom)}snapToSelf(t,e){var r=this.extractTargetCoordinates(this._srcGeom),n=new Xi(t,r,!0).transform(this._srcGeom),i=n;return e&&b(i,zt)&&(i=n.buffer(0)),i}computeSnapTolerance(t){return this.computeMinimumSegmentLength(t)/10}extractTargetCoordinates(t){for(var e=new yt,r=t.getCoordinates(),n=0;n<r.length;n++)e.add(r[n]);return e.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(t){for(var e=i.MAX_VALUE,r=0;r<t.length-1;r++){var n=t[r].distance(t[r+1]);n<e&&(e=n)}return e}getClass(){return Wi}get interfaces_(){return[]}}Wi.constructor_=function(){this._srcGeom=null;let t=arguments[0];this._srcGeom=t},Wi.SNAP_PRECISION_FACTOR=1e-9;class Xi extends lr{constructor(){super(),Xi.constructor_.apply(this,arguments)}snapLine(t,e){var r=new Yi(t,this._snapTolerance);return r.setAllowSnappingToSourceVertices(this._isSelfSnap),r.snapTo(e)}transformCoordinates(t,e){var r=t.toCoordinateArray(),n=this.snapLine(r,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)}getClass(){return Xi}get interfaces_(){return[]}}Xi.constructor_=function(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){let t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._snapTolerance=t,this._snapPts=e,this._isSelfSnap=r}};class Hi{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new n,this._commonSignExp=null}getCommon(){return i.longBitsToDouble(this._commonBits)}add(t){var e=i.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Hi.signExpBits(this._commonBits),this._isFirst=!1,null):Hi.signExpBits(e)!==this._commonSignExp?(this._commonBits.high=0,this._commonBits.low=0,null):(this._commonMantissaBitsCount=Hi.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Hi.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))}toString(){if(1===arguments.length){let o=arguments[0];var t=i.longBitsToDouble(o),e="0000000000000000000000000000000000000000000000000000000000000000"+n.toBinaryString(o),r=e.substring(e.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+t+" ]"}}getClass(){return Hi}get interfaces_(){return[]}static getBit(t,e){var r=1<<e%32;return e<32?0!=(t.low&r)?1:0:0!=(t.high&r)?1:0}static signExpBits(t){return t.high>>>20}static zeroLowerBits(t,e){var r="low";if(e>32&&(t.low=0,e%=32,r="high"),e>0){var n=e<32?~((1<<e)-1):0;t[r]&=n}return t}static numCommonMostSigMantissaBits(t,e){for(var r=0,n=52;n>=0;n--){if(Hi.getBit(t,n)!==Hi.getBit(e,n))return r;r++}return 52}}class Zi{constructor(){Zi.constructor_.apply(this,arguments)}addCommonBits(t){var e=new $i(this._commonCoord);t.apply(e),t.geometryChanged()}removeCommonBits(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new _(this._commonCoord);e.x=-e.x,e.y=-e.y;var r=new $i(e);return t.apply(r),t.geometryChanged(),t}getCommonCoordinate(){return this._commonCoord}add(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}getClass(){return Zi}get interfaces_(){return[]}}class Ki{constructor(){Ki.constructor_.apply(this,arguments)}filter(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}getCommonCoordinate(){return new _(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}getClass(){return Ki}get interfaces_(){return[X]}}Ki.constructor_=function(){this._commonBitsX=new Hi,this._commonBitsY=new Hi};class $i{constructor(){$i.constructor_.apply(this,arguments)}filter(t,e){var r=t.getOrdinate(e,0)+this.trans.x,n=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,r),t.setOrdinate(e,1,n)}isDone(){return!1}isGeometryChanged(){return!0}getClass(){return $i}get interfaces_(){return[xt]}}$i.constructor_=function(){this.trans=null;let t=arguments[0];this.trans=t},Zi.CommonCoordinateFilter=Ki,Zi.Translater=$i,Zi.constructor_=function(){this._commonCoord=null,this._ccFilter=new Ki};class Ji{constructor(){Ji.constructor_.apply(this,arguments)}static overlayOp(t,e,r){return new Ji(t,e).getResultGeometry(r)}static union(t,e){return Ji.overlayOp(t,e,eo.UNION)}static intersection(t,e){return Ji.overlayOp(t,e,eo.INTERSECTION)}static symDifference(t,e){return Ji.overlayOp(t,e,eo.SYMDIFFERENCE)}static difference(t,e){return Ji.overlayOp(t,e,eo.DIFFERENCE)}selfSnap(t){return new Wi(t).snapTo(t,this._snapTolerance)}removeCommonBits(t){this._cbr=new Zi,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}prepareResult(t){return this._cbr.addCommonBits(t),t}getResultGeometry(t){var e=this.snap(this._geom),r=eo.overlayOp(e[0],e[1],t);return this.prepareResult(r)}checkValid(t){t.isValid()||G.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=Wi.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(t){var e=this.removeCommonBits(t);return Wi.snap(e[0],e[1],this._snapTolerance)}getClass(){return Ji}get interfaces_(){return[]}}Ji.constructor_=function(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;let t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};class Qi{constructor(){Qi.constructor_.apply(this,arguments)}static overlayOp(t,e,r){return new Qi(t,e).getResultGeometry(r)}static union(t,e){return Qi.overlayOp(t,e,eo.UNION)}static intersection(t,e){return Qi.overlayOp(t,e,eo.INTERSECTION)}static symDifference(t,e){return Qi.overlayOp(t,e,eo.SYMDIFFERENCE)}static difference(t,e){return Qi.overlayOp(t,e,eo.DIFFERENCE)}getResultGeometry(t){var e=null,r=!1,n=null;try{e=eo.overlayOp(this._geom[0],this._geom[1],t),r=!0}catch(t){if(!(t instanceof g))throw t;n=t}if(!r)try{e=Ji.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof g?n:t}return e}getClass(){return Qi}get interfaces_(){return[]}}Qi.constructor_=function(){this._geom=new Array(2).fill(null);let t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e};class to{constructor(){to.constructor_.apply(this,arguments)}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}getClass(){return to}get interfaces_(){return[]}}to.constructor_=function(){if(this._li=new pe,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){let t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Vr(0,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];to.constructor_.call(this,t,e,H.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Vr(0,t,r),this._arg[1]=new Vr(1,e,r)}};class eo extends to{constructor(){super(),eo.constructor_.apply(this,arguments)}static overlayOp(t,e,r){return new eo(t,e).getResultGeometry(r)}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return eo.createEmptyResult(eo.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new r("This method does not support GeometryCollection arguments");return Qi.overlayOp(t,e,eo.UNION)}static intersection(t,e){if(t.isEmpty()||e.isEmpty())return eo.createEmptyResult(eo.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Bi.map(t,new class{get interfaces_(){return[MapOp]}map(t){return t.intersection(n)}})}if(t.isGeometryCollection()||e.isGeometryCollection())throw new r("This method does not support GeometryCollection arguments");return Qi.overlayOp(t,e,eo.INTERSECTION)}static symDifference(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return eo.createEmptyResult(eo.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new r("This method does not support GeometryCollection arguments");return Qi.overlayOp(t,e,eo.SYMDIFFERENCE)}static resultDimension(t,e,r){var n=e.getDimension(),i=r.getDimension(),o=-1;switch(t){case eo.INTERSECTION:o=Math.min(n,i);break;case eo.UNION:o=Math.max(n,i);break;case eo.DIFFERENCE:o=n;break;case eo.SYMDIFFERENCE:o=Math.max(n,i)}return o}static createEmptyResult(t,e,r,n){var i=null;switch(eo.resultDimension(t,e,r)){case-1:i=n.createGeometryCollection();break;case 0:i=n.createPoint();break;case 1:i=n.createLineString();break;case 2:i=n.createPolygon()}return i}static difference(t,e){if(t.isEmpty())return eo.createEmptyResult(eo.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new r("This method does not support GeometryCollection arguments");return Qi.overlayOp(t,e,eo.DIFFERENCE)}static isResultOfOp(){if(2===arguments.length){let r=arguments[0],n=arguments[1];var t=r.getLocation(0),e=r.getLocation(1);return eo.isResultOfOp(t,e,n)}if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];switch(t===ge.BOUNDARY&&(t=ge.INTERIOR),e===ge.BOUNDARY&&(e=ge.INTERIOR),r){case eo.INTERSECTION:return t===ge.INTERIOR&&e===ge.INTERIOR;case eo.UNION:return t===ge.INTERIOR||e===ge.INTERIOR;case eo.DIFFERENCE:return t===ge.INTERIOR&&e!==ge.INTERIOR;case eo.SYMDIFFERENCE:return t===ge.INTERIOR&&e!==ge.INTERIOR||t!==ge.INTERIOR&&e===ge.INTERIOR}return!1}}insertUniqueEdge(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var r=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Tr(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(r),i.add(n),r.merge(n)}else this._edgeList.add(t)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),r=e.getSym();e.isInResult()&&r.isInResult()&&(e.setInResult(!1),r.setInResult(!1))}}isCoveredByLA(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}computeGeometry(t,e,r,n){var i=new C;return i.addAll(t),i.addAll(e),i.addAll(r),i.isEmpty()?eo.createEmptyResult(n,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(i)}mergeSymLabels(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()}isCovered(t,e){for(var r=e.iterator();r.hasNext();){var n=r.next();if(this._ptLocator.locate(t,n)!==ge.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){for(var t=new C,e=this._edgeList.iterator();e.hasNext();){var r=e.next();r.isCollapsed()&&(e.remove(),t.add(r.getCollapsedEdge()))}this._edgeList.addAll(t)}updateNodeLabelling(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),r=e.getEdges().getLabel();e.getLabel().merge(r)}}getResultGeometry(t){return this.computeOverlay(t),this._resultGeom}insertUniqueEdges(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this.insertUniqueEdge(r)}}computeOverlay(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new C;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Ui.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var r=new Hn(this._geomFact);r.add(this._graph),this._resultPolyList=r.getPolygons();var n=new Vi(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(t);var i=new qi(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}labelIncompleteNode(t,e){var r=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,r)}copyPoints(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var r=e.next();this._graph.addNode(r.getCoordinate()).setLabel(t,r.getLabel().getLocation(t))}}findResultAreaEdges(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var r=e.next(),n=r.getLabel();n.isArea()&&!r.isInteriorAreaEdge()&&eo.isResultOfOp(n.getLocation(0,wr.RIGHT),n.getLocation(1,wr.RIGHT),t)&&r.setInResult(!0)}}computeLabelsFromDepths(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),r=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var i=0;i<2;i++)r.isNull(i)||!r.isArea()||n.isNull(i)||(0===n.getDelta(i)?r.toLine(i):(m.isTrue(!n.isNull(i,wr.LEFT),"depth of LEFT side has not been initialized"),r.setLocation(i,wr.LEFT,n.getLocation(i,wr.LEFT)),m.isTrue(!n.isNull(i,wr.RIGHT),"depth of RIGHT side has not been initialized"),r.setLocation(i,wr.RIGHT,n.getLocation(i,wr.RIGHT))))}}}computeLabelling(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),r=e.getLabel();e.isIsolated()&&(r.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(r)}}isCoveredByA(t){return!!this.isCovered(t,this._resultPolyList)}getClass(){return eo}get interfaces_(){return[]}}eo.constructor_=function(){this._ptLocator=new br,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new si,this._resultPolyList=new C,this._resultLineList=new C,this._resultPointList=new C;let t=arguments[0],e=arguments[1];to.constructor_.call(this,t,e),this._graph=new Br(new ii),this._geomFact=t.getFactory()},eo.INTERSECTION=1,eo.UNION=2,eo.DIFFERENCE=3,eo.SYMDIFFERENCE=4;var ro=Object.freeze({OverlayOp:eo});class no extends Ci{constructor(){super(),no.constructor_.apply(this,arguments)}getNext(){return this._next}isInRing(){return null!==this._edgeRing}setRing(t){this._edgeRing=t}setLabel(t){this._label=t}getLabel(){return this._label}setNext(t){this._next=t}getRing(){return this._edgeRing}getClass(){return no}get interfaces_(){return[]}}no.constructor_=function(){this._edgeRing=null,this._next=null,this._label=-1;let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];Ci.constructor_.call(this,t,e,r,n)};class io extends Pi{constructor(){super(),io.constructor_.apply(this,arguments)}getLine(){return this._line}getClass(){return io}get interfaces_(){return[]}}io.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class oo{constructor(){oo.constructor_.apply(this,arguments)}static findDirEdgesInRing(t){var e=t,r=new C;do{r.add(e),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return r}static addEdge(t,e,r){if(e)for(var n=0;n<t.length;n++)r.add(t[n],!1);else for(n=t.length-1;n>=0;n--)r.add(t[n],!1)}static findEdgeRingContaining(t,e){for(var r=t.getRing(),n=r.getEnvelopeInternal(),i=r.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getRing(),c=u.getEnvelopeInternal();if(!c.equals(n)&&c.contains(n)){i=Q.ptNotInList(r.getCoordinates(),u.getCoordinates());var h=!1;ze.isInRing(i,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(s=(o=l).getRing().getEnvelopeInternal())}}return o}isIncluded(){return this._isIncluded}getCoordinates(){if(null===this._ringPts){for(var t=new P,e=this._deList.iterator();e.hasNext();){var r=e.next(),n=r.getEdge();oo.addEdge(n.getLine().getCoordinates(),r.getEdgeDirection(),t)}this._ringPts=t.toCoordinateArray()}return this._ringPts}isIncludedSet(){return this._isIncludedSet}isValid(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),this._ring.isValid())}build(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)}isOuterHole(){return!!this._isHole&&!this.hasShell()}getPolygon(){var t=null;if(null!==this._holes){t=new Array(this._holes.size()).fill(null);for(var e=0;e<this._holes.size();e++)t[e]=this._holes.get(e)}return this._factory.createPolygon(this._ring,t)}isHole(){return this._isHole}isProcessed(){return this._isProcessed}addHole(){if(arguments[0]instanceof Vt){let t=arguments[0];null===this._holes&&(this._holes=new C),this._holes.add(t)}else if(arguments[0]instanceof oo){let e=arguments[0];e.setShell(this);var t=e.getRing();null===this._holes&&(this._holes=new C),this._holes.add(t)}}setIncluded(t){this._isIncluded=t,this._isIncludedSet=!0}getOuterHole(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null}computeHole(){var t=this.getRing();this._isHole=j.isCCW(t.getCoordinates())}hasShell(){return null!==this._shell}isOuterShell(){return null!==this.getOuterHole()}getLineString(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}toString(){return he.toLineString(new Kt(this.getCoordinates()))}getShell(){return this.isHole()?this._shell:this}add(t){this._deList.add(t)}getRing(){if(null!==this._ring)return this._ring;this.getCoordinates(),this._ringPts.length<3&&G.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(t){if(!(t instanceof L))throw t;G.out.println(this._ringPts)}return this._ring}updateIncluded(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}}setShell(t){this._shell=t}setProcessed(t){this._isProcessed=t}getClass(){return oo}get interfaces_(){return[]}}class so{constructor(){so.constructor_.apply(this,arguments)}compare(t,e){var r=e;return t.getRing().getEnvelope().compareTo(r.getRing().getEnvelope())}getClass(){return so}get interfaces_(){return[p]}}so.constructor_=function(){},oo.EnvelopeComparator=so,oo.constructor_=function(){this._factory=null,this._deList=new C,this._lowestEdge=null,this._ring=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;let t=arguments[0];this._factory=t};class ao extends Ni{constructor(){super(),ao.constructor_.apply(this,arguments)}static findLabeledEdgeRings(t){for(var e=new C,r=1,n=t.iterator();n.hasNext();){var i=n.next();if(!(i.isMarked()||i.getLabel()>=0)){e.add(i);var o=oo.findDirEdgesInRing(i);ao.label(o,r),r++}}return e}static getDegreeNonDeleted(t){for(var e=0,r=t.getOutEdges().getEdges().iterator();r.hasNext();)r.next().isMarked()||e++;return e}static deleteAllEdges(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var r=e.next();r.setMarked(!0);var n=r.getSym();null!==n&&n.setMarked(!0)}}static label(t,e){for(var r=t.iterator();r.hasNext();)r.next().setLabel(e)}static computeNextCWEdges(t){for(var e=null,r=null,n=t.getOutEdges().getEdges().iterator();n.hasNext();){var i=n.next();i.isMarked()||(null===e&&(e=i),null!==r&&r.getSym().setNext(i),r=i)}null!==r&&r.getSym().setNext(e)}static computeNextCCWEdges(t,e){for(var r=null,n=null,i=t.getOutEdges().getEdges(),o=i.size()-1;o>=0;o--){var s=i.get(o),a=s.getSym(),l=null;s.getLabel()===e&&(l=s);var u=null;a.getLabel()===e&&(u=a),null===l&&null===u||(null!==u&&(n=u),null!==l&&(null!==n&&(n.setNext(l),n=null),null===r&&(r=l)))}null!==n&&(m.isTrue(null!==r),n.setNext(r))}static getDegree(t,e){for(var r=0,n=t.getOutEdges().getEdges().iterator();n.hasNext();)n.next().getLabel()===e&&r++;return r}static findIntersectionNodes(t,e){var r=t,n=null;do{var i=r.getFromNode();ao.getDegree(i,e)>1&&(null===n&&(n=new C),n.add(i)),r=r.getNext(),m.isTrue(null!==r,"found null DE in ring"),m.isTrue(r===t||!r.isInRing(),"found DE already in ring")}while(r!==t);return n}findEdgeRing(t){var e=new oo(this._factory);return e.build(t),e}computeDepthParity(){if(0===arguments.length)for(;;)return null}computeNextCWEdges(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();ao.computeNextCWEdges(e)}}addEdge(t){if(t.isEmpty())return null;var e=Q.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var r=e[0],n=e[e.length-1],i=this.getNode(r),o=this.getNode(n),s=new no(i,o,e[1],!0),a=new no(o,i,e[e.length-2],!1),l=new io(t);l.setDirectedEdges(s,a),this.add(l)}deleteCutEdges(){this.computeNextCWEdges(),ao.findLabeledEdgeRings(this._dirEdges);for(var t=new C,e=this._dirEdges.iterator();e.hasNext();){var r=e.next();if(!r.isMarked()){var n=r.getSym();if(r.getLabel()===n.getLabel()){r.setMarked(!0),n.setMarked(!0);var i=r.getEdge();t.add(i.getLine())}}}return t}getEdgeRings(){this.computeNextCWEdges(),ao.label(this._dirEdges,-1);var t=ao.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new C,r=this._dirEdges.iterator();r.hasNext();){var n=r.next();if(!n.isMarked()&&!n.isInRing()){var i=this.findEdgeRing(n);e.add(i)}}return e}getNode(t){var e=this.findNode(t);return null===e&&(e=new Li(t),this.add(e)),e}convertMaximalToMinimalEdgeRings(t){for(var e=t.iterator();e.hasNext();){var r=e.next(),n=r.getLabel(),i=ao.findIntersectionNodes(r,n);if(null!==i)for(var o=i.iterator();o.hasNext();){var s=o.next();ao.computeNextCCWEdges(s,n)}}}deleteDangles(){for(var t=this.findNodesOfDegree(1),e=new ot,r=new $e,n=t.iterator();n.hasNext();)r.push(n.next());for(;!r.isEmpty();){var i=r.pop();for(ao.deleteAllEdges(i),n=i.getOutEdges().getEdges().iterator();n.hasNext();){var o=n.next();o.setMarked(!0);var s=o.getSym();null!==s&&s.setMarked(!0);var a=o.getEdge();e.add(a.getLine());var l=o.getToNode();1===ao.getDegreeNonDeleted(l)&&r.push(l)}}return e}getClass(){return ao}get interfaces_(){return[]}}ao.constructor_=function(){this._factory=null;let t=arguments[0];this._factory=t};class lo{constructor(){lo.constructor_.apply(this,arguments)}static findOuterShells(t){for(var e=t.iterator();e.hasNext();){var r=e.next(),n=r.getOuterHole();null===n||n.isProcessed()||(r.setIncluded(!0),n.setProcessed(!0))}}static extractPolygons(t,e){for(var r=new C,n=t.iterator();n.hasNext();){var i=n.next();(e||i.isIncluded())&&r.add(i.getPolygon())}return r}static assignHolesToShells(t,e){for(var r=t.iterator();r.hasNext();){var n=r.next();lo.assignHoleToShell(n,e)}}static assignHoleToShell(t,e){var r=oo.findEdgeRingContaining(t,e);null!==r&&r.addHole(t)}static findDisjointShells(t){lo.findOuterShells(t);var e=null;do{e=!1;for(var r=t.iterator();r.hasNext();){var n=r.next();n.isIncludedSet()||(n.updateIncluded(),n.isIncludedSet()||(e=!0))}}while(e)}getGeometry(){return null===this._geomFactory&&(this._geomFactory=new se),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(se.toGeometryArray(this._polyList))}getInvalidRingLines(){return this.polygonize(),this._invalidRingLines}findValidRings(t,e,r){for(var n=t.iterator();n.hasNext();){var i=n.next();i.isValid()?e.add(i):r.add(i.getLineString())}}polygonize(){if(null!==this._polyList)return null;if(this._polyList=new C,null===this._graph)return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();var t=this._graph.getEdgeRings(),e=new C;this._invalidRingLines=new C,this._isCheckingRingsValid?this.findValidRings(t,e,this._invalidRingLines):e=t,this.findShellsAndHoles(e),lo.assignHolesToShells(this._holeList,this._shellList),Le.sort(this._shellList,new oo.EnvelopeComparator);var r=!0;this._extractOnlyPolygonal&&(lo.findDisjointShells(this._shellList),r=!1),this._polyList=lo.extractPolygons(this._shellList,r)}getDangles(){return this.polygonize(),this._dangles}getCutEdges(){return this.polygonize(),this._cutEdges}getPolygons(){return this.polygonize(),this._polyList}add(){if(b(arguments[0],x))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){let t=arguments[0];this._geomFactory=t.getFactory(),null===this._graph&&(this._graph=new ao(this._geomFactory)),this._graph.addEdge(t)}else arguments[0]instanceof W&&arguments[0].apply(this._lineStringAdder)}setCheckRingsValid(t){this._isCheckingRingsValid=t}findShellsAndHoles(t){this._holeList=new C,this._shellList=new C;for(var e=t.iterator();e.hasNext();){var r=e.next();r.computeHole(),r.isHole()?this._holeList.add(r):this._shellList.add(r)}}getClass(){return lo}get interfaces_(){return[]}}class uo{constructor(){uo.constructor_.apply(this,arguments)}filter(t){t instanceof Ft&&this.p.add(t)}getClass(){return uo}get interfaces_(){return[Y]}}uo.constructor_=function(){this.p=null;let t=arguments[0];this.p=t},lo.LineStringAdder=uo,lo.constructor_=function(){if(this._lineStringAdder=new uo(this),this._graph=null,this._dangles=new C,this._cutEdges=new C,this._invalidRingLines=new C,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,0===arguments.length)lo.constructor_.call(this,!1);else if(1===arguments.length){let t=arguments[0];this._extractOnlyPolygonal=t}};var co=Object.freeze({Polygonizer:lo});class ho{constructor(){ho.constructor_.apply(this,arguments)}createEdgeEndForNext(t,e,r,n){var i=r.segmentIndex+1;if(i>=t.getNumPoints()&&null===n)return null;var o=t.getCoordinate(i);null!==n&&n.segmentIndex===r.segmentIndex&&(o=n.coord);var s=new jr(t,r.coord,o,new Tr(t.getLabel()));e.add(s)}createEdgeEndForPrev(t,e,r,n){var i=r.segmentIndex;if(0===r.dist){if(0===i)return null;i--}var o=t.getCoordinate(i);null!==n&&n.segmentIndex>=i&&(o=n.coord);var s=new Tr(t.getLabel());s.flip();var a=new jr(t,r.coord,o,s);e.add(a)}computeEdgeEnds(){if(1===arguments.length){let n=arguments[0];for(var t=new C,e=n;e.hasNext();){var r=e.next();this.computeEdgeEnds(r,t)}return t}if(2===arguments.length){let t=arguments[0],e=arguments[1];var n=t.getEdgeIntersectionList();n.addEndpoints();var i=n.iterator(),o=null,s=null;if(!i.hasNext())return null;var a=i.next();do{o=s,s=a,a=null,i.hasNext()&&(a=i.next()),null!==s&&(this.createEdgeEndForPrev(t,e,s,o),this.createEdgeEndForNext(t,e,s,a))}while(null!==s)}}getClass(){return ho}get interfaces_(){return[]}}ho.constructor_=function(){};class fo extends jr{constructor(){super(),fo.constructor_.apply(this,arguments)}insert(t){this._edgeEnds.add(t)}print(t){t.println("EdgeEndBundle--\x3e Label: "+this._label);for(var e=this.iterator();e.hasNext();)e.next().print(t),t.println()}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(t,e){for(var r=0,n=!1,i=this.iterator();i.hasNext();)(o=i.next().getLabel().getLocation(t))===ge.BOUNDARY&&r++,o===ge.INTERIOR&&(n=!0);var o=ge.NONE;n&&(o=ge.INTERIOR),r>0&&(o=Vr.determineBoundary(e,r)),this._label.setLocation(t,o)}computeLabelSide(t,e){for(var r=this.iterator();r.hasNext();){var n=r.next();if(n.getLabel().isArea()){var i=n.getLabel().getLocation(t,e);if(i===ge.INTERIOR)return this._label.setLocation(t,e,ge.INTERIOR),null;i===ge.EXTERIOR&&this._label.setLocation(t,e,ge.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(t){this.computeLabelSide(t,wr.LEFT),this.computeLabelSide(t,wr.RIGHT)}updateIM(t){Ar.updateIM(this._label,t)}computeLabel(t){for(var e=!1,r=this.iterator();r.hasNext();)r.next().getLabel().isArea()&&(e=!0);this._label=e?new Tr(ge.NONE,ge.NONE,ge.NONE):new Tr(ge.NONE);for(var n=0;n<2;n++)this.computeLabelOn(n,t),e&&this.computeLabelSides(n)}getClass(){return fo}get interfaces_(){return[]}}fo.constructor_=function(){if(this._edgeEnds=new C,1===arguments.length){let t=arguments[0];fo.constructor_.call(this,null,t)}else if(2===arguments.length){let t=arguments[1];jr.constructor_.call(this,t.getEdge(),t.getCoordinate(),t.getDirectedCoordinate(),new Tr(t.getLabel())),this.insert(t)}};class po extends ri{constructor(){super(),po.constructor_.apply(this,arguments)}updateIM(t){for(var e=this.iterator();e.hasNext();)e.next().updateIM(t)}insert(t){var e=this._edgeMap.get(t);null===e?(e=new fo(t),this.insertEdgeEnd(t,e)):e.insert(t)}getClass(){return po}get interfaces_(){return[]}}po.constructor_=function(){};class go extends Fr{constructor(){super(),go.constructor_.apply(this,arguments)}updateIMFromEdges(t){this._edges.updateIM(t)}computeIM(t){t.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}getClass(){return go}get interfaces_(){return[]}}go.constructor_=function(){let t=arguments[0],e=arguments[1];Fr.constructor_.call(this,t,e)};class yo extends Ur{constructor(){super(),yo.constructor_.apply(this,arguments)}createNode(t){return new go(t,new po)}getClass(){return yo}get interfaces_(){return[]}}yo.constructor_=function(){};class mo{constructor(){mo.constructor_.apply(this,arguments)}insertEdgeEnds(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this._nodes.add(r)}}computeProperIntersectionIM(t,e){var r=this._arg[0].getGeometry().getDimension(),n=this._arg[1].getGeometry().getDimension(),i=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===r&&2===n?i&&e.setAtLeast("212101212"):2===r&&1===n?(i&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===r&&2===n?(i&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===r&&1===n&&o&&e.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(t,e){for(var r=this._arg[t].getEdgeIterator();r.hasNext();){var n=r.next();n.isIsolated()&&(this.labelIsolatedEdge(n,e,this._arg[e].getGeometry()),this._isolatedEdges.add(n))}}labelIsolatedEdge(t,e,r){if(r.getDimension()>0){var n=this._ptLocator.locate(t.getCoordinate(),r);t.getLabel().setAllLocations(e,n)}else t.getLabel().setAllLocations(e,ge.EXTERIOR)}computeIM(){var t=new ye;if(t.set(ge.EXTERIOR,ge.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);var e=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var r=new ho,n=r.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(n);var i=r.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(i),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t}labelNodeEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg)}copyNodesAndLabels(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var r=e.next();this._nodes.addNode(r.getCoordinate()).setLabel(t,r.getLabel().getLocation(t))}}labelIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),s=this._nodes.find(o.coord);s.getLabel().isNull(t)&&(n===ge.BOUNDARY?s.setLabelBoundary(t):s.setLabel(t,ge.INTERIOR))}}labelIsolatedNode(t,e){var r=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setAllLocations(e,r)}computeIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),s=this._nodes.addNode(o.coord);n===ge.BOUNDARY?s.setLabelBoundary(t):s.getLabel().isNull(t)&&s.setLabel(t,ge.INTERIOR)}}labelIsolatedNodes(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next(),r=e.getLabel();m.isTrue(r.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(r.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}}updateIM(t){for(var e=this._isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(var r=this._nodes.iterator();r.hasNext();){var n=r.next();n.updateIM(t),n.updateIMFromEdges(t)}}computeDisjointIM(t){var e=this._arg[0].getGeometry();e.isEmpty()||(t.set(ge.INTERIOR,ge.EXTERIOR,e.getDimension()),t.set(ge.BOUNDARY,ge.EXTERIOR,e.getBoundaryDimension()));var r=this._arg[1].getGeometry();r.isEmpty()||(t.set(ge.EXTERIOR,ge.INTERIOR,r.getDimension()),t.set(ge.EXTERIOR,ge.BOUNDARY,r.getBoundaryDimension()))}getClass(){return mo}get interfaces_(){return[]}}mo.constructor_=function(){this._li=new pe,this._ptLocator=new br,this._arg=null,this._nodes=new Dr(new yo),this._im=null,this._isolatedEdges=new C,this._invalidPoint=null;let t=arguments[0];this._arg=t};class _o{constructor(){_o.constructor_.apply(this,arguments)}static contains(t,e){return new _o(t).contains(e)}isContainedInBoundary(t){if(t instanceof Ut)return!1;if(t instanceof jt)return this.isPointContainedInBoundary(t);if(t instanceof Ft)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);if(!this.isContainedInBoundary(r))return!1}return!0}isLineSegmentContainedInBoundary(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(t){for(var e=t.getCoordinateSequence(),r=new _,n=new _,i=0;i<e.size()-1;i++)if(e.getCoordinate(i,r),e.getCoordinate(i+1,n),!this.isLineSegmentContainedInBoundary(r,n))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof jt){let t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof _){let t=arguments[0];return t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX()||t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()}}contains(t){return!!this._rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)}getClass(){return _o}get interfaces_(){return[]}}_o.constructor_=function(){this._rectEnv=null;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal()};class vo{constructor(){vo.constructor_.apply(this,arguments)}intersects(t,e){var r=new R(t,e);if(!this._rectEnv.intersects(r))return!1;if(this._rectEnv.intersects(t))return!0;if(this._rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var n=t;t=e,e=n}var i=!1;return e.y>t.y&&(i=!0),i?this._li.computeIntersection(t,e,this._diagDown0,this._diagDown1):this._li.computeIntersection(t,e,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}getClass(){return vo}get interfaces_(){return[]}}vo.constructor_=function(){this._li=new pe,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;let t=arguments[0];this._rectEnv=t,this._diagUp0=new _(t.getMinX(),t.getMinY()),this._diagUp1=new _(t.getMaxX(),t.getMaxY()),this._diagDown0=new _(t.getMinX(),t.getMaxY()),this._diagDown1=new _(t.getMaxX(),t.getMinY())};class bo{constructor(){bo.constructor_.apply(this,arguments)}applyTo(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var r=t.getGeometryN(e);if(r instanceof Et)this.applyTo(r);else if(this.visit(r),this.isDone())return this._isDone=!0,null}}getClass(){return bo}get interfaces_(){return[]}}bo.constructor_=function(){this._isDone=!1};class wo{constructor(){wo.constructor_.apply(this,arguments)}static intersects(t,e){return new wo(t).intersects(e)}intersects(t){if(!this._rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new xo(this._rectEnv);if(e.applyTo(t),e.intersects())return!0;var r=new Eo(this._rectangle);if(r.applyTo(t),r.containsPoint())return!0;var n=new So(this._rectangle);return n.applyTo(t),!!n.intersects()}getClass(){return wo}get interfaces_(){return[]}}wo.constructor_=function(){this._rectangle=null,this._rectEnv=null;let t=arguments[0];this._rectangle=t,this._rectEnv=t.getEnvelopeInternal()};class xo extends bo{constructor(){super(),xo.constructor_.apply(this,arguments)}isDone(){return!0===this._intersects}visit(t){var e=t.getEnvelopeInternal();return this._rectEnv.intersects(e)?this._rectEnv.contains(e)||e.getMinX()>=this._rectEnv.getMinX()&&e.getMaxX()<=this._rectEnv.getMaxX()||e.getMinY()>=this._rectEnv.getMinY()&&e.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}intersects(){return this._intersects}getClass(){return xo}get interfaces_(){return[]}}xo.constructor_=function(){this._rectEnv=null,this._intersects=!1;let t=arguments[0];this._rectEnv=t};class Eo extends bo{constructor(){super(),Eo.constructor_.apply(this,arguments)}isDone(){return!0===this._containsPoint}visit(t){if(!(t instanceof Ut))return null;var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;for(var r=new _,n=0;n<4;n++)if(this._rectSeq.getCoordinate(n,r),e.contains(r)&&Be.containsPointInPolygon(r,t))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}getClass(){return Eo}get interfaces_(){return[]}}Eo.constructor_=function(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;let t=arguments[0];this._rectSeq=t.getExteriorRing().getCoordinateSequence(),this._rectEnv=t.getEnvelopeInternal()};class So extends bo{constructor(){super(),So.constructor_.apply(this,arguments)}intersects(){return this._hasIntersection}isDone(){return!0===this._hasIntersection}visit(t){var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;var r=Ne.getLines(t);this.checkIntersectionWithLineStrings(r)}checkIntersectionWithLineStrings(t){for(var e=t.iterator();e.hasNext();){var r=e.next();if(this.checkIntersectionWithSegments(r),this._hasIntersection)return null}}checkIntersectionWithSegments(t){for(var e=t.getCoordinateSequence(),r=1;r<e.size();r++)if(e.getCoordinate(r-1,this._p0),e.getCoordinate(r,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}getClass(){return So}get interfaces_(){return[]}}So.constructor_=function(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new _,this._p1=new _;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal(),this._rectIntersector=new vo(this._rectEnv)};class Io extends to{constructor(){super(),Io.constructor_.apply(this,arguments)}static covers(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||new Io(t,e).getIntersectionMatrix().isCovers())}static intersects(t,e){if(!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal()))return!1;if(t.isRectangle())return wo.intersects(t,e);if(e.isRectangle())return wo.intersects(e,t);if(t.isGeometryCollection()||e.isGeometryCollection()){for(var r=0;r<t.getNumGeometries();r++)for(var n=0;n<e.getNumGeometries();n++)if(t.getGeometryN(r).intersects(e.getGeometryN(n)))return!0;return!1}return new Io(t,e).getIntersectionMatrix().isIntersects()}static touches(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Io(t,e).getIntersectionMatrix().isTouches(t.getDimension(),e.getDimension())}static relate(){return 2===arguments.length?new Io(arguments[0],arguments[1]).getIntersectionMatrix():3===arguments.length?new Io(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix():void 0}static overlaps(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Io(t,e).getIntersectionMatrix().isOverlaps(t.getDimension(),e.getDimension())}static crosses(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Io(t,e).getIntersectionMatrix().isCrosses(t.getDimension(),e.getDimension())}static contains(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?_o.contains(t,e):new Io(t,e).getIntersectionMatrix().isContains())}getIntersectionMatrix(){return this._relate.computeIM()}getClass(){return Io}get interfaces_(){return[]}}Io.constructor_=function(){if(this._relate=null,2===arguments.length){let t=arguments[0],e=arguments[1];to.constructor_.call(this,t,e),this._relate=new mo(this._arg)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];to.constructor_.call(this,t,e,r),this._relate=new mo(this._arg)}};var Oo=Object.freeze({RelateOp:Io});class Co{constructor(){Co.constructor_.apply(this,arguments)}static combine(){if(1===arguments.length)return new Co(arguments[0]).combine();if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Co(Co.createList(t,e)).combine()}if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];return new Co(Co.createList(t,e,r)).combine()}}static extractFactory(t){return t.isEmpty()?null:t.iterator().next().getFactory()}static createList(){if(2===arguments.length){let e=arguments[0],r=arguments[1];return(t=new C).add(e),t.add(r),t}if(3===arguments.length){let e=arguments[0],r=arguments[1],n=arguments[2];var t;return(t=new C).add(e),t.add(r),t.add(n),t}}extractElements(t,e){if(null===t)return null;for(var r=0;r<t.getNumGeometries();r++){var n=t.getGeometryN(r);this._skipEmpty&&n.isEmpty()||e.add(n)}}combine(){for(var t=new C,e=this._inputGeoms.iterator();e.hasNext();){var r=e.next();this.extractElements(r,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(t)}getClass(){return Co}get interfaces_(){return[]}}Co.constructor_=function(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;let t=arguments[0];this._geomFactory=Co.extractFactory(t),this._inputGeoms=t};class To{constructor(){To.constructor_.apply(this,arguments)}static union(t,e){return new To(t,e).union()}union(){for(var t=new br,e=new yt,r=0;r<this._pointGeom.getNumGeometries();r++){var n=this._pointGeom.getGeometryN(r).getCoordinate();t.locate(n,this._otherGeom)===ge.EXTERIOR&&e.add(n)}if(0===e.size())return this._otherGeom;var i=null,o=Q.toCoordinateArray(e);return i=1===o.length?this._geomFact.createPoint(o[0]):this._geomFact.createMultiPointFromCoords(o),Co.combine(i,this._otherGeom)}getClass(){return To}get interfaces_(){return[]}}To.constructor_=function(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;let t=arguments[0],e=arguments[1];this._pointGeom=t,this._otherGeom=e,this._geomFact=e.getFactory()};class Po{constructor(){Po.constructor_.apply(this,arguments)}static isOfType(t,e){return t.getGeometryType()===e||e===W.TYPENAME_LINESTRING&&t.getGeometryType()===W.TYPENAME_LINEARRING}static extract(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return Po.extract(t,e,new C)}if(3===arguments.length){if(b(arguments[2],S)&&arguments[0]instanceof W&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1],r=arguments[2];return t.getGeometryType()===e?r.add(t):t instanceof Et&&t.apply(new Po(e,r)),r}if(b(arguments[2],S)&&arguments[0]instanceof W&&arguments[1]instanceof Class){let t=arguments[0],e=arguments[1],r=arguments[2];return Po.extract(t,Po.toGeometryType(e),r)}}}filter(t){(null===this._geometryType||Po.isOfType(t,this._geometryType))&&this._comps.add(t)}getClass(){return Po}get interfaces_(){return[wt]}}Po.constructor_=function(){this._geometryType=null,this._comps=null;let t=arguments[0],e=arguments[1];this._geometryType=t,this._comps=e};class Ro{constructor(){Ro.constructor_.apply(this,arguments)}static restrictToPolygons(t){if(b(t,zt))return t;var e=vi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(se.toPolygonArray(e))}static getGeometry(t,e){return e>=t.size()?null:t.get(e)}static union(t){return new Ro(t).union()}reduceToGeometries(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next(),i=null;b(n,S)?i=this.unionTree(n):n instanceof W&&(i=n),e.add(i)}return e}extractByEnvelope(t,e,r){for(var n=new C,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?n.add(o):r.add(o)}return this._geomFactory.buildGeometry(n)}unionOptimized(t,e){var r=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!r.intersects(n))return Co.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=r.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,i)}union(){if(null===this._inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new pn(Ro.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var r=e.next();t.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var n=t.itemsTree();return this.unionTree(n)}binaryUnion(){if(1===arguments.length){let t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){let n=arguments[0],i=arguments[1],o=arguments[2];if(o-i<=1){var t=Ro.getGeometry(n,i);return this.unionSafe(t,null)}if(o-i==2)return this.unionSafe(Ro.getGeometry(n,i),Ro.getGeometry(n,i+1));var e=Math.trunc((o+i)/2),r=(t=this.binaryUnion(n,i,e),this.binaryUnion(n,e,o));return this.unionSafe(t,r)}}repeatedUnion(t){for(var e=null,r=t.iterator();r.hasNext();){var n=r.next();e=null===e?n.copy():e.union(n)}return e}unionSafe(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)}unionActual(t,e){return Ro.restrictToPolygons(t.union(e))}unionTree(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)}unionUsingEnvelopeIntersection(t,e,r){var n=new C,i=this.extractByEnvelope(r,t,n),o=this.extractByEnvelope(r,e,n),s=this.unionActual(i,o);return n.add(s),Co.combine(n)}bufferUnion(){if(1===arguments.length){let t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t.getFactory().createGeometryCollection([t,e]).buffer(0)}}getClass(){return Ro}get interfaces_(){return[]}}Ro.constructor_=function(){this._inputPolys=null,this._geomFactory=null;let t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new C)},Ro.STRTREE_NODE_CAPACITY=4;class Lo{constructor(){Lo.constructor_.apply(this,arguments)}static union(){if(1===arguments.length){if(b(arguments[0],x))return new Lo(arguments[0]).union();if(arguments[0]instanceof W)return new Lo(arguments[0]).union()}else if(2===arguments.length)return new Lo(arguments[0],arguments[1]).union()}unionNoOpt(t){var e=this._geomFact.createPoint();return Qi.overlayOp(t,e,eo.UNION)}unionWithNull(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)}extract(){if(b(arguments[0],x))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.extract(e)}else if(arguments[0]instanceof W){let t=arguments[0];null===this._geomFact&&(this._geomFact=t.getFactory()),Po.extract(t,W.TYPENAME_POLYGON,this._polygons),Po.extract(t,W.TYPENAME_LINESTRING,this._lines),Po.extract(t,W.TYPENAME_POINT,this._points)}}union(){if(null===this._geomFact)return null;var t=null;if(this._points.size()>0){var e=this._geomFact.buildGeometry(this._points);t=this.unionNoOpt(e)}var r=null;if(this._lines.size()>0){var n=this._geomFact.buildGeometry(this._lines);r=this.unionNoOpt(n)}var i=null;this._polygons.size()>0&&(i=Ro.union(this._polygons));var o=this.unionWithNull(r,i),s=null;return null===(s=null===t?o:null===o?t:To.union(t,o))?this._geomFact.createGeometryCollection():s}getClass(){return Lo}get interfaces_(){return[]}}Lo.constructor_=function(){if(this._polygons=new C,this._lines=new C,this._points=new C,this._geomFact=null,1===arguments.length){if(b(arguments[0],x)){let t=arguments[0];this.extract(t)}else if(arguments[0]instanceof W){let t=arguments[0];this.extract(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geomFact=e,this.extract(t)}};var Mo=Object.freeze({UnaryUnionOp:Lo});class ko{constructor(){ko.constructor_.apply(this,arguments)}static findDifferentPoint(t,e){for(var r=0;r<t.length;r++)if(!t[r].equals(e))return t[r];return null}visitInteriorRing(t,e){var r=t.getCoordinates(),n=r[0],i=ko.findDifferentPoint(r,n),o=e.findEdgeInSameDirection(n,i),s=e.findEdgeEnd(o),a=null;s.getLabel().getLocation(0,wr.RIGHT)===ge.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,wr.RIGHT)===ge.INTERIOR&&(a=s.getSym()),m.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)}visitShellInteriors(t,e){if(t instanceof Ut){var r=t;this.visitInteriorRing(r.getExteriorRing(),e)}if(t instanceof qt)for(var n=t,i=0;i<n.getNumGeometries();i++)r=n.getGeometryN(i),this.visitInteriorRing(r.getExteriorRing(),e)}getCoordinate(){return this._disconnectedRingcoord}setInteriorEdgesInResult(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var r=e.next();r.getLabel().getLocation(0,wr.RIGHT)===ge.INTERIOR&&r.setInResult(!0)}}visitLinkedDirectedEdges(t){var e=t,r=t;do{m.isTrue(null!==r,"found null Directed Edge"),r.setVisited(!0),r=r.getNext()}while(r!==e)}buildEdgeRings(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next();if(n.isInResult()&&null===n.getEdgeRing()){var i=new Xn(n,this._geometryFactory);i.linkDirectedEdgesForMinimalEdgeRings();var o=i.buildMinimalRings();e.addAll(o)}}return e}hasUnvisitedShellEdge(t){for(var e=0;e<t.size();e++){var r=t.get(e);if(!r.isHole()){var n=r.getEdges(),i=n.get(0);if(i.getLabel().getLocation(0,wr.RIGHT)===ge.INTERIOR)for(var o=0;o<n.size();o++)if(!(i=n.get(o)).isVisited())return this._disconnectedRingcoord=i.getCoordinate(),!0}}return!1}isInteriorsConnected(){var t=new C;this._geomGraph.computeSplitEdges(t);var e=new Br(new ii);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var r=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(r)}getClass(){return ko}get interfaces_(){return[]}}ko.constructor_=function(){this._geometryFactory=new se,this._geomGraph=null,this._disconnectedRingcoord=null;let t=arguments[0];this._geomGraph=t};class No{constructor(){No.constructor_.apply(this,arguments)}insertEdgeEnds(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this._nodes.add(r)}}getNodeIterator(){return this._nodes.iterator()}copyNodesAndLabels(t,e){for(var r=t.getNodeIterator();r.hasNext();){var n=r.next();this._nodes.addNode(n.getCoordinate()).setLabel(e,n.getLabel().getLocation(e))}}build(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new ho).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)}computeIntersectionNodes(t,e){for(var r=t.getEdgeIterator();r.hasNext();)for(var n=r.next(),i=n.getLabel().getLocation(e),o=n.getEdgeIntersectionList().iterator();o.hasNext();){var s=o.next(),a=this._nodes.addNode(s.coord);i===ge.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,ge.INTERIOR)}}getClass(){return No}get interfaces_(){return[]}}No.constructor_=function(){this._nodes=new Dr(new yo)};class Ao{constructor(){Ao.constructor_.apply(this,arguments)}isNodeEdgeAreaLabelsConsistent(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=e.getCoordinate().copy(),!1}return!0}getInvalidPoint(){return this._invalidPoint}hasDuplicateRings(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var r=e.next();if(r.getEdgeEnds().size()>1)return this._invalidPoint=r.getEdge().getCoordinate(0),!0}return!1}isNodeConsistentArea(){var t=this._geomGraph.computeSelfNodes(this._li,!0,!0);return t.hasProperIntersection()?(this._invalidPoint=t.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}getClass(){return Ao}get interfaces_(){return[]}}Ao.constructor_=function(){this._li=new pe,this._geomGraph=null,this._nodeGraph=new No,this._invalidPoint=null;let t=arguments[0];this._geomGraph=t};class Fo{constructor(){Fo.constructor_.apply(this,arguments)}buildIndex(){this._index=new pn;for(var t=0;t<this._rings.size();t++){var e=this._rings.get(t),r=e.getEnvelopeInternal();this._index.insert(r,e)}}getNestedPoint(){return this._nestedPt}isNonNested(){this.buildIndex();for(var t=0;t<this._rings.size();t++)for(var e=this._rings.get(t),r=e.getCoordinates(),n=this._index.query(e.getEnvelopeInternal()),i=0;i<n.size();i++){var o=n.get(i),s=o.getCoordinates();if(e!==o&&e.getEnvelopeInternal().intersects(o.getEnvelopeInternal())){var a=jo.findPtNotNode(r,o,this._graph);if(null!==a&&ze.isInRing(a,s))return this._nestedPt=a,!1}}return!0}add(t){this._rings.add(t),this._totalEnv.expandToInclude(t.getEnvelopeInternal())}getClass(){return Fo}get interfaces_(){return[]}}Fo.constructor_=function(){this._graph=null,this._rings=new C,this._totalEnv=new R,this._index=null,this._nestedPt=null;let t=arguments[0];this._graph=t};class Do{constructor(){Do.constructor_.apply(this,arguments)}getErrorType(){return this._errorType}getMessage(){return Do.errMsg[this._errorType]}getCoordinate(){return this._pt}toString(){var t="";return null!==this._pt&&(t=" at or near point "+this._pt),this.getMessage()+t}getClass(){return Do}get interfaces_(){return[]}}Do.constructor_=function(){if(this._errorType=null,this._pt=null,1===arguments.length){let t=arguments[0];Do.constructor_.call(this,t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._errorType=t,null!==e&&(this._pt=e.copy())}},Do.ERROR=0,Do.REPEATED_POINT=1,Do.HOLE_OUTSIDE_SHELL=2,Do.NESTED_HOLES=3,Do.DISCONNECTED_INTERIOR=4,Do.SELF_INTERSECTION=5,Do.RING_SELF_INTERSECTION=6,Do.NESTED_SHELLS=7,Do.DUPLICATE_RINGS=8,Do.TOO_FEW_POINTS=9,Do.INVALID_COORDINATE=10,Do.RING_NOT_CLOSED=11,Do.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];class jo{constructor(){jo.constructor_.apply(this,arguments)}static findPtNotNode(t,e,r){for(var n=r.findEdge(e).getEdgeIntersectionList(),i=0;i<t.length;i++){var o=t[i];if(!n.isIntersection(o))return o}return null}static isValid(){if(arguments[0]instanceof W)return new jo(arguments[0]).isValid();if(arguments[0]instanceof _){let t=arguments[0];return!(i.isNaN(t.x)||i.isInfinite(t.x)||i.isNaN(t.y)||i.isInfinite(t.y))}}checkInvalidCoordinates(){if(arguments[0]instanceof Array){let e=arguments[0];for(var t=0;t<e.length;t++)if(!jo.isValid(e[t]))return this._validErr=new Do(Do.INVALID_COORDINATE,e[t]),null}else if(arguments[0]instanceof Ut){let e=arguments[0];if(this.checkInvalidCoordinates(e.getExteriorRing().getCoordinates()),null!==this._validErr)return null;for(t=0;t<e.getNumInteriorRing();t++)if(this.checkInvalidCoordinates(e.getInteriorRingN(t).getCoordinates()),null!==this._validErr)return null}}checkHolesNotNested(t,e){for(var r=new Fo(e),n=0;n<t.getNumInteriorRing();n++){var i=t.getInteriorRingN(n);r.add(i)}r.isNonNested()||(this._validErr=new Do(Do.NESTED_HOLES,r.getNestedPoint()))}checkConsistentArea(t){var e=new Ao(t);if(!e.isNodeConsistentArea())return this._validErr=new Do(Do.SELF_INTERSECTION,e.getInvalidPoint()),null;e.hasDuplicateRings()&&(this._validErr=new Do(Do.DUPLICATE_RINGS,e.getInvalidPoint()))}isValid(){return this.checkValid(this._parentGeometry),null===this._validErr}checkShellInsideHole(t,e,r){var n=t.getCoordinates(),i=e.getCoordinates(),o=jo.findPtNotNode(n,e,r);if(null!==o&&!ze.isInRing(o,i))return o;var s=jo.findPtNotNode(i,t,r);return null!==s?ze.isInRing(s,n)?s:null:(m.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}checkNoSelfIntersectingRings(t){for(var e=t.getEdgeIterator();e.hasNext();){var r=e.next();if(this.checkNoSelfIntersectingRing(r.getEdgeIntersectionList()),null!==this._validErr)return null}}checkConnectedInteriors(t){var e=new ko(t);e.isInteriorsConnected()||(this._validErr=new Do(Do.DISCONNECTED_INTERIOR,e.getCoordinate()))}checkNoSelfIntersectingRing(t){for(var e=new yt,r=!0,n=t.iterator();n.hasNext();){var i=n.next();if(r)r=!1;else{if(e.contains(i.coord))return this._validErr=new Do(Do.RING_SELF_INTERSECTION,i.coord),null;e.add(i.coord)}}}checkHolesInShell(t,e){for(var r=t.getExteriorRing(),n=new De(r),i=0;i<t.getNumInteriorRing();i++){var o=t.getInteriorRingN(i),s=jo.findPtNotNode(o.getCoordinates(),r,e);if(null===s)return null;if(ge.EXTERIOR===n.locate(s))return this._validErr=new Do(Do.HOLE_OUTSIDE_SHELL,s),null}}checkTooFewPoints(t){if(t.hasTooFewPoints())return this._validErr=new Do(Do.TOO_FEW_POINTS,t.getInvalidPoint()),null}getValidationError(){return this.checkValid(this._parentGeometry),this._validErr}checkValid(){if(arguments[0]instanceof jt){let t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Bt){let t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Vt){let r=arguments[0];if(this.checkInvalidCoordinates(r.getCoordinates()),null!==this._validErr)return null;if(this.checkClosedRing(r),null!==this._validErr)return null;var t=new Vr(0,r);if(this.checkTooFewPoints(t),null!==this._validErr)return null;var e=new pe;t.computeSelfNodes(e,!0,!0),this.checkNoSelfIntersectingRings(t)}else if(arguments[0]instanceof Ft){let e=arguments[0];if(this.checkInvalidCoordinates(e.getCoordinates()),null!==this._validErr)return null;t=new Vr(0,e),this.checkTooFewPoints(t)}else if(arguments[0]instanceof Ut){let e=arguments[0];if(this.checkInvalidCoordinates(e),null!==this._validErr)return null;if(this.checkClosedRings(e),null!==this._validErr)return null;if(t=new Vr(0,e),this.checkTooFewPoints(t),null!==this._validErr)return null;if(this.checkConsistentArea(t),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(t),null!==this._validErr))return null;if(this.checkHolesInShell(e,t),null!==this._validErr)return null;if(this.checkHolesNotNested(e,t),null!==this._validErr)return null;this.checkConnectedInteriors(t)}else if(arguments[0]instanceof qt){let e=arguments[0];for(var r=0;r<e.getNumGeometries();r++){var n=e.getGeometryN(r);if(this.checkInvalidCoordinates(n),null!==this._validErr)return null;if(this.checkClosedRings(n),null!==this._validErr)return null}if(t=new Vr(0,e),this.checkTooFewPoints(t),null!==this._validErr)return null;if(this.checkConsistentArea(t),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(t),null!==this._validErr))return null;for(r=0;r<e.getNumGeometries();r++)if(n=e.getGeometryN(r),this.checkHolesInShell(n,t),null!==this._validErr)return null;for(r=0;r<e.getNumGeometries();r++)if(n=e.getGeometryN(r),this.checkHolesNotNested(n,t),null!==this._validErr)return null;if(this.checkShellsNotNested(e,t),null!==this._validErr)return null;this.checkConnectedInteriors(t)}else if(arguments[0]instanceof Et){let t=arguments[0];for(r=0;r<t.getNumGeometries();r++){var i=t.getGeometryN(r);if(this.checkValid(i),null!==this._validErr)return null}}else if(arguments[0]instanceof W){let t=arguments[0];if(this._validErr=null,t.isEmpty())return null;if(t instanceof jt)this.checkValid(t);else if(t instanceof Bt)this.checkValid(t);else if(t instanceof Vt)this.checkValid(t);else if(t instanceof Ft)this.checkValid(t);else if(t instanceof Ut)this.checkValid(t);else if(t instanceof qt)this.checkValid(t);else{if(!(t instanceof Et))throw new UnsupportedOperationException(t.getClass().getName());this.checkValid(t)}}}setSelfTouchingRingFormingHoleValid(t){this._isSelfTouchingRingFormingHoleValid=t}checkShellNotNested(t,e,r){var n=t.getCoordinates(),i=e.getExteriorRing(),o=i.getCoordinates(),s=jo.findPtNotNode(n,i,r);if(null===s)return null;if(!ze.isInRing(s,o))return null;if(e.getNumInteriorRing()<=0)return this._validErr=new Do(Do.NESTED_SHELLS,s),null;for(var a=null,l=0;l<e.getNumInteriorRing();l++){var u=e.getInteriorRingN(l);if(null===(a=this.checkShellInsideHole(t,u,r)))return null}this._validErr=new Do(Do.NESTED_SHELLS,a)}checkClosedRings(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this._validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this._validErr)return null}checkClosedRing(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this._validErr=new Do(Do.RING_NOT_CLOSED,e)}}checkShellsNotNested(t,e){for(var r=0;r<t.getNumGeometries();r++)for(var n=t.getGeometryN(r).getExteriorRing(),i=0;i<t.getNumGeometries();i++)if(r!==i){var o=t.getGeometryN(i);if(this.checkShellNotNested(n,o,e),null!==this._validErr)return null}}getClass(){return jo}get interfaces_(){return[]}}jo.constructor_=function(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;let t=arguments[0];this._parentGeometry=t};var Go=Object.freeze({IsValidOp:jo,ConsistentAreaTester:Ao}),zo=Object.freeze({BoundaryOp:It,IsSimpleOp:Gn,buffer:_i,distance:Si,linemerge:Di,overlay:ro,polygonize:co,relate:Oo,union:Mo,valid:Go});class Uo extends Yt.CoordinateOperation{constructor(){super(),Uo.constructor_.apply(this,arguments)}edit(){if(2===arguments.length&&arguments[1]instanceof W&&arguments[0]instanceof Array){let s=arguments[0],a=arguments[1];if(0===s.length)return null;for(var t=new Array(s.length).fill(null),e=0;e<s.length;e++){var r=new _(s[e]);this._targetPM.makePrecise(r),t[e]=r}var n=new P(t,!1).toCoordinateArray(),i=0;a instanceof Ft&&(i=2),a instanceof Vt&&(i=4);var o=t;return this._removeCollapsed&&(o=null),n.length<i?o:n}return super.edit.apply(this,arguments)}getClass(){return Uo}get interfaces_(){return[]}}Uo.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0;let t=arguments[0],e=arguments[1];this._targetPM=t,this._removeCollapsed=e};class Bo{constructor(){Bo.constructor_.apply(this,arguments)}static reduce(t,e){return new Bo(e).reduce(t)}static reducePointwise(t,e){var r=new Bo(e);return r.setPointwise(!0),r.reduce(t)}fixPolygonalTopology(t){var e=t;this._changePrecisionModel||(e=this.changePM(t,this._targetPM));var r=mi.bufferOp(e,0),n=r;return this._changePrecisionModel||(n=r.copy(),this.changePM(n,t.getPrecisionModel())),n}reducePointwise(t){var e=null;if(this._changePrecisionModel){var r=this.createFactory(t.getFactory(),this._targetPM);e=new Yt(r)}else e=new Yt;var n=this._removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new Uo(this._targetPM,n))}changePM(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Yt.NoOpGeometryOperation)}setRemoveCollapsedComponents(t){this._removeCollapsed=t}createFactory(t,e){return new se(e,t.getSRID(),t.getCoordinateSequenceFactory())}setChangePrecisionModel(t){this._changePrecisionModel=t}reduce(t){var e=this.reducePointwise(t);return this._isPointwise?e:b(e,zt)?jo.isValid(e)?e:this.fixPolygonalTopology(e):e}setPointwise(t){this._isPointwise=t}createEditor(t,e){if(t.getPrecisionModel()===e)return new Yt;var r=this.createFactory(t,e);return new Yt(r)}getClass(){return Bo}get interfaces_(){return[]}}Bo.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;let t=arguments[0];this._targetPM=t};var Vo=Object.freeze({GeometryPrecisionReducer:Bo});class qo{constructor(){qo.constructor_.apply(this,arguments)}static simplify(t,e){var r=new qo(t);return r.setDistanceTolerance(e),r.simplify()}simplifySection(t,e){if(t+1===e)return null;this._seg.p0=this._pts[t],this._seg.p1=this._pts[e];for(var r=-1,n=t,i=t+1;i<e;i++){var o=this._seg.distance(this._pts[i]);o>r&&(r=o,n=i)}if(r<=this._distanceTolerance)for(i=t+1;i<e;i++)this._usePt[i]=!1;else this.simplifySection(t,n),this.simplifySection(n,e)}setDistanceTolerance(t){this._distanceTolerance=t}simplify(){this._usePt=new Array(this._pts.length).fill(null);for(var t=0;t<this._pts.length;t++)this._usePt[t]=!0;this.simplifySection(0,this._pts.length-1);var e=new P;for(t=0;t<this._pts.length;t++)this._usePt[t]&&e.add(new _(this._pts[t]));return e.toCoordinateArray()}getClass(){return qo}get interfaces_(){return[]}}qo.constructor_=function(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new de;let t=arguments[0];this._pts=t};class Yo{constructor(){Yo.constructor_.apply(this,arguments)}static simplify(t,e){var r=new Yo(t);return r.setDistanceTolerance(e),r.getResultGeometry()}setEnsureValid(t){this._isEnsureValidTopology=t}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new Wo(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<0)throw new r("Tolerance must be non-negative");this._distanceTolerance=t}getClass(){return Yo}get interfaces_(){return[]}}class Wo extends lr{constructor(){super(),Wo.constructor_.apply(this,arguments)}transformPolygon(t,e){if(t.isEmpty())return null;var r=super.transformPolygon.call(this,t,e);return e instanceof qt?r:this.createValidArea(r)}createValidArea(t){return this._isEnsureValidTopology?t.buffer(0):t}transformCoordinates(t,e){var r=t.toCoordinateArray(),n=null;return n=0===r.length?new Array(0).fill(null):qo.simplify(r,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(n)}transformMultiPolygon(t,e){var r=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(r)}transformLinearRing(t,e){var r=e instanceof Ut,n=super.transformLinearRing.call(this,t,e);return!r||n instanceof Vt?n:null}getClass(){return Wo}get interfaces_(){return[]}}Wo.constructor_=function(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;let t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e},Yo.DPTransformer=Wo,Yo.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;let t=arguments[0];this._inputGeom=t};class Xo extends de{constructor(){super(),Xo.constructor_.apply(this,arguments)}getIndex(){return this._index}getParent(){return this._parent}getClass(){return Xo}get interfaces_(){return[]}}Xo.constructor_=function(){if(this._parent=null,this._index=null,2===arguments.length){let t=arguments[0],e=arguments[1];Xo.constructor_.call(this,t,e,null,-1)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];de.constructor_.call(this,t,e),this._parent=r,this._index=n}};class Ho{constructor(){Ho.constructor_.apply(this,arguments)}static extractCoordinates(t){for(var e=new Array(t.size()+1).fill(null),r=null,n=0;n<t.size();n++)r=t.get(n),e[n]=r.p0;return e[e.length-1]=r.p1,e}addToResult(t){this._resultSegs.add(t)}asLineString(){return this._parentLine.getFactory().createLineString(Ho.extractCoordinates(this._resultSegs))}getResultSize(){var t=this._resultSegs.size();return 0===t?0:t+1}getParent(){return this._parentLine}getSegment(t){return this._segs[t]}getParentCoordinates(){return this._parentLine.getCoordinates()}getMinimumSize(){return this._minimumSize}asLinearRing(){return this._parentLine.getFactory().createLinearRing(Ho.extractCoordinates(this._resultSegs))}getSegments(){return this._segs}init(){var t=this._parentLine.getCoordinates();this._segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var r=new Xo(t[e],t[e+1],this._parentLine,e);this._segs[e]=r}}getResultCoordinates(){return Ho.extractCoordinates(this._resultSegs)}getClass(){return Ho}get interfaces_(){return[]}}Ho.constructor_=function(){if(this._parentLine=null,this._segs=null,this._resultSegs=new C,this._minimumSize=null,1===arguments.length){let t=arguments[0];Ho.constructor_.call(this,t,2)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._parentLine=t,this._minimumSize=e,this.init()}};class Zo{constructor(){Zo.constructor_.apply(this,arguments)}remove(t){this._index.remove(new R(t.p0,t.p1),t)}add(){if(arguments[0]instanceof Ho)for(var t=arguments[0].getSegments(),e=0;e<t.length;e++){var r=t[e];this.add(r)}else if(arguments[0]instanceof de){let t=arguments[0];this._index.insert(new R(t.p0,t.p1),t)}}query(t){var e=new R(t.p0,t.p1),r=new Ko(t);return this._index.query(e,r),r.getItems()}getClass(){return Zo}get interfaces_(){return[]}}Zo.constructor_=function(){this._index=new nn};class Ko{constructor(){Ko.constructor_.apply(this,arguments)}visitItem(t){var e=t;R.intersects(e.p0,e.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(t)}getItems(){return this._items}getClass(){return Ko}get interfaces_(){return[Oe]}}Ko.constructor_=function(){this._querySeg=null,this._items=new C;let t=arguments[0];this._querySeg=t};class $o{constructor(){$o.constructor_.apply(this,arguments)}static isInLineSection(t,e,r){if(r.getParent()!==t.getParent())return!1;var n=r.getIndex();return n>=e[0]&&n<e[1]}flatten(t,e){var r=this._linePts[t],n=this._linePts[e],i=new de(r,n);return this.remove(this._line,t,e),this._outputIndex.add(i),i}hasBadIntersection(t,e,r){return!!this.hasBadOutputIntersection(r)||!!this.hasBadInputIntersection(t,e,r)}setDistanceTolerance(t){this._distanceTolerance=t}simplifySection(t,e,r){r+=1;var n=new Array(2).fill(null);if(t+1===e){var i=this._line.getSegment(t);return this._line.addToResult(i),null}var o=!0;this._line.getResultSize()<this._line.getMinimumSize()&&r+1<this._line.getMinimumSize()&&(o=!1);var s=new Array(1).fill(null),a=this.findFurthestPoint(this._linePts,t,e,s);s[0]>this._distanceTolerance&&(o=!1);var l=new de;if(l.p0=this._linePts[t],l.p1=this._linePts[e],n[0]=t,n[1]=e,this.hasBadIntersection(this._line,n,l)&&(o=!1),o)return i=this.flatten(t,e),this._line.addToResult(i),null;this.simplifySection(t,a,r),this.simplifySection(a,e,r)}hasBadOutputIntersection(t){for(var e=this._outputIndex.query(t).iterator();e.hasNext();){var r=e.next();if(this.hasInteriorIntersection(r,t))return!0}return!1}findFurthestPoint(t,e,r,n){var i=new de;i.p0=t[e],i.p1=t[r];for(var o=-1,s=e,a=e+1;a<r;a++){var l=t[a],u=i.distance(l);u>o&&(o=u,s=a)}return n[0]=o,s}simplify(t){this._line=t,this._linePts=t.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}remove(t,e,r){for(var n=e;n<r;n++){var i=t.getSegment(n);this._inputIndex.remove(i)}}hasInteriorIntersection(t,e){return this._li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this._li.isInteriorIntersection()}hasBadInputIntersection(t,e,r){for(var n=this._inputIndex.query(r).iterator();n.hasNext();){var i=n.next();if(this.hasInteriorIntersection(i,r)){if($o.isInLineSection(t,e,i))continue;return!0}}return!1}getClass(){return $o}get interfaces_(){return[]}}$o.constructor_=function(){this._li=new pe,this._inputIndex=new Zo,this._outputIndex=new Zo,this._line=null,this._linePts=null,this._distanceTolerance=0;let t=arguments[0],e=arguments[1];this._inputIndex=t,this._outputIndex=e};class Jo{constructor(){Jo.constructor_.apply(this,arguments)}setDistanceTolerance(t){this._distanceTolerance=t}simplify(t){for(var e=t.iterator();e.hasNext();)this._inputIndex.add(e.next());for(e=t.iterator();e.hasNext();){var r=new $o(this._inputIndex,this._outputIndex);r.setDistanceTolerance(this._distanceTolerance),r.simplify(e.next())}}getClass(){return Jo}get interfaces_(){return[]}}Jo.constructor_=function(){this._inputIndex=new Zo,this._outputIndex=new Zo,this._distanceTolerance=0};class Qo{constructor(){Qo.constructor_.apply(this,arguments)}static simplify(t,e){var r=new Qo(t);return r.setDistanceTolerance(e),r.getResultGeometry()}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new ne,this._inputGeom.apply(new es(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new ts(this._linestringMap).transform(this._inputGeom))}setDistanceTolerance(t){if(t<0)throw new r("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(t)}getClass(){return Qo}get interfaces_(){return[]}}class ts extends lr{constructor(){super(),ts.constructor_.apply(this,arguments)}transformCoordinates(t,e){if(0===t.size())return null;if(e instanceof Ft){var r=this._linestringMap.get(e);return this.createCoordinateSequence(r.getResultCoordinates())}return super.transformCoordinates.call(this,t,e)}getClass(){return ts}get interfaces_(){return[]}}ts.constructor_=function(){this._linestringMap=null;let t=arguments[0];this._linestringMap=t};class es{constructor(){es.constructor_.apply(this,arguments)}filter(t){if(t instanceof Ft){var e=t;if(e.isEmpty())return null;var r=e.isClosed()?4:2,n=new Ho(e,r);this.tps._linestringMap.put(e,n)}}getClass(){return es}get interfaces_(){return[Y]}}es.constructor_=function(){this.tps=null;let t=arguments[0];this.tps=t},Qo.LineStringTransformer=ts,Qo.LineStringMapBuilderFilter=es,Qo.constructor_=function(){this._inputGeom=null,this._lineSimplifier=new Jo,this._linestringMap=null;let t=arguments[0];this._inputGeom=t};var rs=Object.freeze({DouglasPeuckerSimplifier:Yo,TopologyPreservingSimplifier:Qo});class ns{constructor(){ns.constructor_.apply(this,arguments)}static pointAlongReverse(t,e){var r=new _;return r.x=t.p1.x-e*(t.p1.x-t.p0.x),r.y=t.p1.y-e*(t.p1.y-t.p0.y),r}splitAt(){if(1===arguments.length){let e=arguments[0];var t=this._minimumLen/this._segLen;if(e.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(t),null;if(e.distance(this._seg.p1)<this._minimumLen)return this._splitPt=ns.pointAlongReverse(this._seg,t),null;this._splitPt=e}else if(2===arguments.length){let t=arguments[0],r=arguments[1];var e=this.getConstrainedLength(t)/this._segLen;r.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(e):this._splitPt=ns.pointAlongReverse(this._seg,e)}}setMinimumLength(t){this._minimumLen=t}getConstrainedLength(t){return t<this._minimumLen?this._minimumLen:t}getSplitPoint(){return this._splitPt}getClass(){return ns}get interfaces_(){return[]}}ns.constructor_=function(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;let t=arguments[0];this._seg=t,this._segLen=t.getLength()};class is{constructor(){is.constructor_.apply(this,arguments)}findSplitPoint(t,e){}getClass(){return is}get interfaces_(){return[]}}is.constructor_=function(){};class os{constructor(){os.constructor_.apply(this,arguments)}static projectedSplitPoint(t,e){return t.getLineSegment().project(e)}findSplitPoint(t,e){var r=t.getLineSegment(),n=r.getLength()/2,i=new ns(r),o=os.projectedSplitPoint(t,e),s=2*o.distance(e)*.8;return s>n&&(s=n),i.setMinimumLength(s),i.splitAt(o),i.getSplitPoint()}getClass(){return os}get interfaces_(){return[is]}}os.constructor_=function(){};class ss{constructor(){ss.constructor_.apply(this,arguments)}static triArea(t,e,r){return(e.x-t.x)*(r.y-t.y)-(e.y-t.y)*(r.x-t.x)}static isInCircleDDNormalized(t,e,r,n){var i=F.valueOf(t.x).selfSubtract(n.x),o=F.valueOf(t.y).selfSubtract(n.y),s=F.valueOf(e.x).selfSubtract(n.x),a=F.valueOf(e.y).selfSubtract(n.y),l=F.valueOf(r.x).selfSubtract(n.x),u=F.valueOf(r.y).selfSubtract(n.y),c=i.multiply(a).selfSubtract(s.multiply(o)),h=s.multiply(u).selfSubtract(l.multiply(a)),f=l.multiply(o).selfSubtract(i.multiply(u)),p=i.multiply(i).selfAdd(o.multiply(o)),d=s.multiply(s).selfAdd(a.multiply(a)),g=l.multiply(l).selfAdd(u.multiply(u));return p.selfMultiply(h).selfAdd(d.selfMultiply(f)).selfAdd(g.selfMultiply(c)).doubleValue()>0}static checkRobustInCircle(t,e,r,n){var i=ss.isInCircleNonRobust(t,e,r,n),o=ss.isInCircleDDSlow(t,e,r,n),s=ss.isInCircleCC(t,e,r,n),a=_e.circumcentre(t,e,r);G.out.println("p radius diff a = "+Math.abs(n.distance(a)-t.distance(a))/t.distance(a)),i===o&&i===s||(G.out.println("inCircle robustness failure (double result = "+i+", DD result = "+o+", CC result = "+s+")"),G.out.println(he.toLineString(new Kt([t,e,r,n]))),G.out.println("Circumcentre = "+he.toPoint(a)+" radius = "+t.distance(a)),G.out.println("p radius diff a = "+Math.abs(n.distance(a)/t.distance(a)-1)),G.out.println("p radius diff b = "+Math.abs(n.distance(a)/e.distance(a)-1)),G.out.println("p radius diff c = "+Math.abs(n.distance(a)/r.distance(a)-1)),G.out.println())}static isInCircleDDFast(t,e,r,n){var i=F.sqr(t.x).selfAdd(F.sqr(t.y)).selfMultiply(ss.triAreaDDFast(e,r,n)),o=F.sqr(e.x).selfAdd(F.sqr(e.y)).selfMultiply(ss.triAreaDDFast(t,r,n)),s=F.sqr(r.x).selfAdd(F.sqr(r.y)).selfMultiply(ss.triAreaDDFast(t,e,n)),a=F.sqr(n.x).selfAdd(F.sqr(n.y)).selfMultiply(ss.triAreaDDFast(t,e,r));return i.selfSubtract(o).selfAdd(s).selfSubtract(a).doubleValue()>0}static isInCircleCC(t,e,r,n){var i=_e.circumcentre(t,e,r),o=t.distance(i);return n.distance(i)-o<=0}static isInCircleNormalized(t,e,r,n){var i=t.x-n.x,o=t.y-n.y,s=e.x-n.x,a=e.y-n.y,l=r.x-n.x,u=r.y-n.y;return(i*i+o*o)*(s*u-l*a)+(s*s+a*a)*(l*o-i*u)+(l*l+u*u)*(i*a-s*o)>0}static isInCircleDDSlow(t,e,r,n){var i=F.valueOf(n.x),o=F.valueOf(n.y),s=F.valueOf(t.x),a=F.valueOf(t.y),l=F.valueOf(e.x),u=F.valueOf(e.y),c=F.valueOf(r.x),h=F.valueOf(r.y),f=s.multiply(s).add(a.multiply(a)).multiply(ss.triAreaDDSlow(l,u,c,h,i,o)),p=l.multiply(l).add(u.multiply(u)).multiply(ss.triAreaDDSlow(s,a,c,h,i,o)),d=c.multiply(c).add(h.multiply(h)).multiply(ss.triAreaDDSlow(s,a,l,u,i,o)),g=i.multiply(i).add(o.multiply(o)).multiply(ss.triAreaDDSlow(s,a,l,u,c,h));return f.subtract(p).add(d).subtract(g).doubleValue()>0}static isInCircleNonRobust(t,e,r,n){return(t.x*t.x+t.y*t.y)*ss.triArea(e,r,n)-(e.x*e.x+e.y*e.y)*ss.triArea(t,r,n)+(r.x*r.x+r.y*r.y)*ss.triArea(t,e,n)-(n.x*n.x+n.y*n.y)*ss.triArea(t,e,r)>0}static isInCircleRobust(t,e,r,n){return ss.isInCircleNormalized(t,e,r,n)}static triAreaDDSlow(t,e,r,n,i,o){return r.subtract(t).multiply(o.subtract(e)).subtract(n.subtract(e).multiply(i.subtract(t)))}static triAreaDDFast(t,e,r){var n=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(r.y).selfSubtract(t.y)),i=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(r.x).selfSubtract(t.x));return n.selfSubtract(i)}getClass(){return ss}get interfaces_(){return[]}}ss.constructor_=function(){};class as{constructor(){as.constructor_.apply(this,arguments)}static interpolateZ(){if(3===arguments.length){let n=arguments[0],i=arguments[1],o=arguments[2];var t=i.distance(o),e=n.distance(i),r=o.z-i.z;return i.z+r*(e/t)}if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],d=arguments[3];var n=e.x,i=e.y,o=r.x-n,s=d.x-n,a=r.y-i,l=d.y-i,u=o*l-s*a,c=t.x-n,h=t.y-i,f=(l*c-s*h)/u,p=(-a*c+o*h)/u;return e.z+f*(r.z-e.z)+p*(d.z-e.z)}}circleCenter(t,e){var r=new as(this.getX(),this.getY()),n=this.bisector(r,t),i=this.bisector(t,e),o=new z(n,i),s=null;try{s=new as(o.getX(),o.getY())}catch(n){if(!(n instanceof M))throw n;G.err.println("a: "+r+"  b: "+t+"  c: "+e),G.err.println(n)}return s}dot(t){return this._p.x*t.getX()+this._p.y*t.getY()}magn(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}getZ(){return this._p.z}bisector(t,e){var r=e.getX()-t.getX(),n=e.getY()-t.getY(),i=new z(t.getX()+r/2,t.getY()+n/2,1),o=new z(t.getX()-n+r/2,t.getY()+r+n/2,1);return new z(i,o)}equals(){if(1===arguments.length){let t=arguments[0];return this._p.x===t.getX()&&this._p.y===t.getY()}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this._p.distance(t.getCoordinate())<e}}getCoordinate(){return this._p}isInCircle(t,e,r){return ss.isInCircleRobust(t._p,e._p,r._p,this._p)}interpolateZValue(t,e,r){var n=t.getX(),i=t.getY(),o=e.getX()-n,s=r.getX()-n,a=e.getY()-i,l=r.getY()-i,u=o*l-s*a,c=this.getX()-n,h=this.getY()-i,f=(l*c-s*h)/u,p=(-a*c+o*h)/u;return t.getZ()+f*(e.getZ()-t.getZ())+p*(r.getZ()-t.getZ())}midPoint(t){var e=(this._p.x+t.getX())/2,r=(this._p.y+t.getY())/2,n=(this._p.z+t.getZ())/2;return new as(e,r,n)}rightOf(t){return this.isCCW(t.dest(),t.orig())}isCCW(t,e){return(t._p.x-this._p.x)*(e._p.y-this._p.y)-(t._p.y-this._p.y)*(e._p.x-this._p.x)>0}getX(){return this._p.x}crossProduct(t){return this._p.x*t.getY()-this._p.y*t.getX()}setZ(t){this._p.z=t}times(t){return new as(t*this._p.x,t*this._p.y)}cross(){return new as(this._p.y,-this._p.x)}leftOf(t){return this.isCCW(t.orig(),t.dest())}toString(){return"POINT ("+this._p.x+" "+this._p.y+")"}sub(t){return new as(this._p.x-t.getX(),this._p.y-t.getY())}getY(){return this._p.y}classify(t,e){var r=e.sub(t),n=this.sub(t),i=r.crossProduct(n);return i>0?as.LEFT:i<0?as.RIGHT:r.getX()*n.getX()<0||r.getY()*n.getY()<0?as.BEHIND:r.magn()<n.magn()?as.BEYOND:t.equals(this)?as.ORIGIN:e.equals(this)?as.DESTINATION:as.BETWEEN}sum(t){return new as(this._p.x+t.getX(),this._p.y+t.getY())}distance(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))}circumRadiusRatio(t,e){var r=this.circleCenter(t,e),n=this.distance(r,t),i=this.distance(this,t),o=this.distance(t,e);return o<i&&(i=o),(o=this.distance(e,this))<i&&(i=o),n/i}getClass(){return as}get interfaces_(){return[]}}as.constructor_=function(){if(this._p=null,1===arguments.length){let t=arguments[0];this._p=new _(t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._p=new _(t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._p=new _(t,e,r)}},as.LEFT=0,as.RIGHT=1,as.BEYOND=2,as.BEHIND=3,as.BETWEEN=4,as.ORIGIN=5,as.DESTINATION=6;class ls extends as{constructor(){super(),ls.constructor_.apply(this,arguments)}getConstraint(){return this._constraint}setOnConstraint(t){this._isOnConstraint=t}merge(t){t._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=t._constraint)}isOnConstraint(){return this._isOnConstraint}setConstraint(t){this._isOnConstraint=!0,this._constraint=t}getClass(){return ls}get interfaces_(){return[]}}ls.constructor_=function(){this._isOnConstraint=null,this._constraint=null;let t=arguments[0];as.constructor_.call(this,t)};class us{constructor(){us.constructor_.apply(this,arguments)}static makeEdge(t,e){var r=new us,n=new us,i=new us,o=new us;r._rot=n,n._rot=i,i._rot=o,o._rot=r,r.setNext(r),n.setNext(o),i.setNext(i),o.setNext(n);var s=r;return s.setOrig(t),s.setDest(e),s}static swap(t){var e=t.oPrev(),r=t.sym().oPrev();us.splice(t,e),us.splice(t.sym(),r),us.splice(t,e.lNext()),us.splice(t.sym(),r.lNext()),t.setOrig(e.dest()),t.setDest(r.dest())}static splice(t,e){var r=t.oNext().rot(),n=e.oNext().rot(),i=e.oNext(),o=t.oNext(),s=n.oNext(),a=r.oNext();t.setNext(i),e.setNext(o),r.setNext(s),n.setNext(a)}static connect(t,e){var r=us.makeEdge(t.dest(),e.orig());return us.splice(r,t.lNext()),us.splice(r.sym(),e),r}equalsNonOriented(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())}toLineSegment(){return new de(this._vertex.getCoordinate(),this.dest().getCoordinate())}dest(){return this.sym().orig()}oNext(){return this._next}equalsOriented(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))}dNext(){return this.sym().oNext().sym()}lPrev(){return this._next.sym()}rPrev(){return this.sym().oNext()}rot(){return this._rot}oPrev(){return this._rot._next._rot}sym(){return this._rot._rot}setOrig(t){this._vertex=t}lNext(){return this.invRot().oNext().rot()}getLength(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}invRot(){return this._rot.sym()}setDest(t){this.sym().setOrig(t)}setData(t){this._data=t}getData(){return this._data}delete(){this._rot=null}orig(){return this._vertex}rNext(){return this._rot._next.invRot()}toString(){var t=this._vertex.getCoordinate(),e=this.dest().getCoordinate();return he.toLineString(t,e)}isLive(){return null!==this._rot}getPrimary(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}dPrev(){return this.invRot().oNext().invRot()}setNext(t){this._next=t}getClass(){return us}get interfaces_(){return[]}}us.constructor_=function(){this._rot=null,this._vertex=null,this._next=null,this._data=null};class cs{constructor(){cs.constructor_.apply(this,arguments)}insertSite(t){var e=this._subdiv.locate(t);if(this._subdiv.isVertexOfEdge(e,t))return e;this._subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this._subdiv.delete(e.oNext()));var r=this._subdiv.makeEdge(e.orig(),t);us.splice(r,e);var n=r;do{e=(r=this._subdiv.connect(e,r.sym())).oPrev()}while(e.lNext()!==n);for(;;){var i=e.oPrev();if(i.dest().rightOf(e)&&t.isInCircle(e.orig(),i.dest(),e.dest()))us.swap(e),e=e.oPrev();else{if(e.oNext()===n)return r;e=e.oNext().lPrev()}}}insertSites(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this.insertSite(r)}}getClass(){return cs}get interfaces_(){return[]}}cs.constructor_=function(){this._subdiv=null,this._isUsingTolerance=!1;let t=arguments[0];this._subdiv=t,this._isUsingTolerance=t.getTolerance()>0};class hs{constructor(){hs.constructor_.apply(this,arguments)}locate(t){}getClass(){return hs}get interfaces_(){return[]}}hs.constructor_=function(){};class fs{constructor(){fs.constructor_.apply(this,arguments)}init(){this._lastEdge=this.findEdge()}locate(t){this._lastEdge.isLive()||this.init();var e=this._subdiv.locateFromEdge(t,this._lastEdge);return this._lastEdge=e,e}findEdge(){return this._subdiv.getEdges().iterator().next()}getClass(){return fs}get interfaces_(){return[hs]}}fs.constructor_=function(){this._subdiv=null,this._lastEdge=null;let t=arguments[0];this._subdiv=t,this.init()};class ps extends g{constructor(){super(),ps.constructor_.apply(this,arguments)}static msgWithSpatial(t,e){return null!==e?t+" [ "+e+" ]":t}getSegment(){return this._seg}getClass(){return ps}get interfaces_(){return[]}}ps.constructor_=function(){if(this._seg=null,1===arguments.length){if("string"==typeof arguments[0]){let t=arguments[0];g.constructor_.call(this,t)}else if(arguments[0]instanceof de){let t=arguments[0];g.constructor_.call(this,"Locate failed to converge (at edge: "+t+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new de(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];g.constructor_.call(this,ps.msgWithSpatial(t,e)),this._seg=new de(e)}};class ds{constructor(){ds.constructor_.apply(this,arguments)}visit(t){}getClass(){return ds}get interfaces_(){return[]}}ds.constructor_=function(){};class gs{constructor(){gs.constructor_.apply(this,arguments)}static getTriangleEdges(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new r("Edges do not form a triangle")}getTriangleVertices(t){var e=new _s;return this.visitTriangles(e,t),e.getTriangleVertices()}isFrameVertex(t){return!!t.equals(this._frameVertex[0])||!!t.equals(this._frameVertex[1])||!!t.equals(this._frameVertex[2])}isVertexOfEdge(t,e){return!(!e.equals(t.orig(),this._tolerance)&&!e.equals(t.dest(),this._tolerance))}connect(t,e){var r=us.connect(t,e);return this._quadEdges.add(r),r}getVoronoiCellPolygon(t,e){var r=new C,n=t;do{var i=t.rot().orig().getCoordinate();r.add(i),t=t.oPrev()}while(t!==n);var o=new P;o.addAll(r,!1),o.closeRing(),o.size()<4&&(G.out.println(o),o.add(o.get(o.size()-1),!0));var s=o.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(s)),l=n.orig();return a.setUserData(l.getCoordinate()),a}setLocator(t){this._locator=t}initSubdiv(){var t=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),e=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);us.splice(t.sym(),e);var r=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return us.splice(e.sym(),r),us.splice(r.sym(),t),t}isFrameBorderEdge(t){var e=new Array(3).fill(null);gs.getTriangleEdges(t,e);var r=new Array(3).fill(null);gs.getTriangleEdges(t.sym(),r);var n=t.lNext().dest();if(this.isFrameVertex(n))return!0;var i=t.sym().lNext().dest();return!!this.isFrameVertex(i)}makeEdge(t,e){var r=us.makeEdge(t,e);return this._quadEdges.add(r),r}visitTriangles(t,e){this._visitedKey++;var r=new $e;r.push(this._startingEdge);for(var n=new ot;!r.empty();){var i=r.pop();if(!n.contains(i)){var o=this.fetchTriangleToVisit(i,r,e,n);null!==o&&t.visit(o)}}}isFrameEdge(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))}isOnEdge(t,e){return this._seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this._seg.distance(e)<this._edgeCoincidenceTolerance}getEnvelope(){return new R(this._frameEnv)}createFrame(t){var e=t.getWidth(),r=t.getHeight(),n=0;n=e>r?10*e:10*r,this._frameVertex[0]=new as((t.getMaxX()+t.getMinX())/2,t.getMaxY()+n),this._frameVertex[1]=new as(t.getMinX()-n,t.getMinY()-n),this._frameVertex[2]=new as(t.getMaxX()+n,t.getMinY()-n),this._frameEnv=new R(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}getTriangleCoordinates(t){var e=new vs;return this.visitTriangles(e,t),e.getTriangles()}getVertices(t){for(var e=new ot,r=this._quadEdges.iterator();r.hasNext();){var n=r.next(),i=n.orig();!t&&this.isFrameVertex(i)||e.add(i);var o=n.dest();!t&&this.isFrameVertex(o)||e.add(o)}return e}fetchTriangleToVisit(t,e,r,n){var i=t,o=0,s=!1;do{this._triEdges[o]=i,this.isFrameEdge(i)&&(s=!0);var a=i.sym();n.contains(a)||e.push(a),n.add(i),o++,i=i.lNext()}while(i!==t);return s&&!r?null:this._triEdges}getEdges(){if(0===arguments.length)return this._quadEdges;if(1===arguments.length){let o=arguments[0];for(var t=this.getPrimaryEdges(!1),e=new Array(t.size()).fill(null),r=0,n=t.iterator();n.hasNext();){var i=n.next();e[r++]=o.createLineString([i.orig().getCoordinate(),i.dest().getCoordinate()])}return o.createMultiLineString(e)}}getVertexUniqueEdges(t){for(var e=new C,r=new ot,n=this._quadEdges.iterator();n.hasNext();){var i=n.next(),o=i.orig();r.contains(o)||(r.add(o),!t&&this.isFrameVertex(o)||e.add(i));var s=i.sym(),a=s.orig();r.contains(a)||(r.add(a),!t&&this.isFrameVertex(a)||e.add(s))}return e}getTriangleEdges(t){var e=new ms;return this.visitTriangles(e,t),e.getTriangleEdges()}getPrimaryEdges(t){this._visitedKey++;var e=new C,r=new $e;r.push(this._startingEdge);for(var n=new ot;!r.empty();){var i=r.pop();if(!n.contains(i)){var o=i.getPrimary();!t&&this.isFrameEdge(o)||e.add(o),r.push(i.oNext()),r.push(i.sym().oNext()),n.add(i),n.add(i.sym())}}return e}delete(t){us.splice(t,t.oPrev()),us.splice(t.sym(),t.sym().oPrev());var e=t.sym(),r=t.rot(),n=t.rot().sym();this._quadEdges.remove(t),this._quadEdges.remove(e),this._quadEdges.remove(r),this._quadEdges.remove(n),t.delete(),e.delete(),r.delete(),n.delete()}locateFromEdge(t,e){for(var r=0,n=this._quadEdges.size(),i=e;;){if(++r>n)throw new ps(i.toLineSegment());if(t.equals(i.orig())||t.equals(i.dest()))break;if(t.rightOf(i))i=i.sym();else if(t.rightOf(i.oNext())){if(t.rightOf(i.dPrev()))break;i=i.dPrev()}else i=i.oNext()}return i}getTolerance(){return this._tolerance}getVoronoiCellPolygons(t){this.visitTriangles(new ys,!0);for(var e=new C,r=this.getVertexUniqueEdges(!1).iterator();r.hasNext();){var n=r.next();e.add(this.getVoronoiCellPolygon(n,t))}return e}getVoronoiDiagram(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(se.toGeometryArray(e))}getTriangles(t){for(var e=this.getTriangleCoordinates(!1),r=new Array(e.size()).fill(null),n=0,i=e.iterator();i.hasNext();){var o=i.next();r[n++]=t.createPolygon(t.createLinearRing(o))}return t.createGeometryCollection(r)}insertSite(t){var e=this.locate(t);if(t.equals(e.orig(),this._tolerance)||t.equals(e.dest(),this._tolerance))return e;var r=this.makeEdge(e.orig(),t);us.splice(r,e);var n=r;do{e=(r=this.connect(e,r.sym())).oPrev()}while(e.lNext()!==n);return n}locate(){if(1===arguments.length){if(arguments[0]instanceof as){let t=arguments[0];return this._locator.locate(t)}if(arguments[0]instanceof _){let t=arguments[0];return this._locator.locate(new as(t))}}else if(2===arguments.length){let n=arguments[0],i=arguments[1];var t=this._locator.locate(new as(n));if(null===t)return null;var e=t;t.dest().getCoordinate().equals2D(n)&&(e=t.sym());var r=e;do{if(r.dest().getCoordinate().equals2D(i))return r;r=r.oNext()}while(r!==e);return null}}getClass(){return gs}get interfaces_(){return[]}}class ys{constructor(){ys.constructor_.apply(this,arguments)}visit(t){for(var e=t[0].orig().getCoordinate(),r=t[1].orig().getCoordinate(),n=t[2].orig().getCoordinate(),i=_e.circumcentre(e,r,n),o=new as(i),s=0;s<3;s++)t[s].rot().setOrig(o)}getClass(){return ys}get interfaces_(){return[ds]}}ys.constructor_=function(){};class ms{constructor(){ms.constructor_.apply(this,arguments)}getTriangleEdges(){return this._triList}visit(t){this._triList.add(t)}getClass(){return ms}get interfaces_(){return[ds]}}ms.constructor_=function(){this._triList=new C};class _s{constructor(){_s.constructor_.apply(this,arguments)}visit(t){this._triList.add([t[0].orig(),t[1].orig(),t[2].orig()])}getTriangleVertices(){return this._triList}getClass(){return _s}get interfaces_(){return[ds]}}_s.constructor_=function(){this._triList=new C};class vs{constructor(){vs.constructor_.apply(this,arguments)}checkTriangleSize(t){t.length>=2?he.toLineString(t[0],t[1]):t.length>=1&&he.toPoint(t[0])}visit(t){this._coordList.clear();for(var e=0;e<3;e++){var r=t[e].orig();this._coordList.add(r.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();var n=this._coordList.toCoordinateArray();if(4!==n.length)return null;this._triCoords.add(n)}}getTriangles(){return this._triCoords}getClass(){return vs}get interfaces_(){return[ds]}}vs.constructor_=function(){this._coordList=new P,this._triCoords=new C},gs.TriangleCircumcentreVisitor=ys,gs.TriangleEdgesListVisitor=ms,gs.TriangleVertexListVisitor=_s,gs.TriangleCoordinatesVisitor=vs,gs.constructor_=function(){this._visitedKey=0,this._quadEdges=new C,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new de,this._triEdges=new Array(3).fill(null);let t=arguments[0],e=arguments[1];this._tolerance=e,this._edgeCoincidenceTolerance=e/gs.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this._startingEdge=this.initSubdiv(),this._locator=new fs(this)},gs.EDGE_COINCIDENCE_TOL_FACTOR=1e3;class bs{constructor(){bs.constructor_.apply(this,arguments)}getLineSegment(){return this._ls}getEndZ(){return this._ls.getCoordinate(1).z}getStartZ(){return this._ls.getCoordinate(0).z}intersection(t){return this._ls.intersection(t.getLineSegment())}getStart(){return this._ls.getCoordinate(0)}getEnd(){return this._ls.getCoordinate(1)}getEndY(){return this._ls.getCoordinate(1).y}getStartX(){return this._ls.getCoordinate(0).x}equalsTopo(t){return this._ls.equalsTopo(t.getLineSegment())}getStartY(){return this._ls.getCoordinate(0).y}setData(t){this._data=t}getData(){return this._data}getEndX(){return this._ls.getCoordinate(1).x}toString(){return this._ls.toString()}getClass(){return bs}get interfaces_(){return[]}}bs.constructor_=function(){if(this._ls=null,this._data=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._ls=new de(t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._ls=new de(t,e),this._data=r}else if(6===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3],i=arguments[4],o=arguments[5];bs.constructor_.call(this,new _(t,e,r),new _(n,i,o))}else if(7===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3],i=arguments[4],o=arguments[5],s=arguments[6];bs.constructor_.call(this,new _(t,e,r),new _(n,i,o),s)}};class ws{constructor(){ws.constructor_.apply(this,arguments)}static computeVertexEnvelope(t){for(var e=new R,r=t.iterator();r.hasNext();){var n=r.next();e.expandToInclude(n.getCoordinate())}return e}getInitialVertices(){return this._initialVertices}getKDT(){return this._kdt}enforceConstraints(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this._segments),t++}while(e>0&&t<ws.MAX_SPLIT_ITER)}insertSites(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this.insertSite(r)}}getVertexFactory(){return this._vertexFactory}getPointArray(){for(var t=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null),e=0,r=this._initialVertices.iterator();r.hasNext();){var n=r.next();t[e++]=n.getCoordinate()}for(var i=this._segVertices.iterator();i.hasNext();)n=i.next(),t[e++]=n.getCoordinate();return t}setConstraints(t,e){this._segments=t,this._segVertices=e}computeConvexHull(){var t=new se,e=this.getPointArray(),r=new Qe(e,t);this._convexHull=r.getConvexHull()}addConstraintVertices(){this.computeConvexHull(),this.insertSites(this._segVertices)}findNonGabrielPoint(t){var e=t.getStart(),r=t.getEnd(),n=new _((e.x+r.x)/2,(e.y+r.y)/2),o=e.distance(n),s=new R(n);s.expandBy(o);for(var a=this._kdt.query(s),l=null,u=i.MAX_VALUE,c=a.iterator();c.hasNext();){var h=c.next().getCoordinate();if(!h.equals2D(e)&&!h.equals2D(r)){var f=n.distance(h);f<o&&(null===l||f<u)&&(l=h,u=f)}}return l}getConstraintSegments(){return this._segments}setSplitPointFinder(t){this._splitFinder=t}getConvexHull(){return this._convexHull}getTolerance(){return this._tolerance}enforceGabriel(t){for(var e=new C,r=0,n=new C,i=t.iterator();i.hasNext();){var o=i.next(),s=this.findNonGabrielPoint(o);if(null!==s){this._splitPt=this._splitFinder.findSplitPoint(o,s);var a=this.createVertex(this._splitPt,o);this.insertSite(a).getCoordinate().equals2D(this._splitPt);var l=new bs(o.getStartX(),o.getStartY(),o.getStartZ(),a.getX(),a.getY(),a.getZ(),o.getData()),u=new bs(a.getX(),a.getY(),a.getZ(),o.getEndX(),o.getEndY(),o.getEndZ(),o.getData());e.add(l),e.add(u),n.add(o),r+=1}}return t.removeAll(n),t.addAll(e),r}createVertex(){if(1===arguments.length){let e=arguments[0];var t=null;return null!==this._vertexFactory?this._vertexFactory.createVertex(e,null):new ls(e)}if(2===arguments.length){let e=arguments[0],r=arguments[1];return t=null,(t=null!==this._vertexFactory?this._vertexFactory.createVertex(e,r):new ls(e)).setOnConstraint(!0),t}}getSubdivision(){return this._subdiv}computeBoundingBox(){var t=ws.computeVertexEnvelope(this._initialVertices),e=ws.computeVertexEnvelope(this._segVertices),r=new R(t);r.expandToInclude(e);var n=.2*r.getWidth(),i=.2*r.getHeight(),o=Math.max(n,i);this._computeAreaEnv=new R(r),this._computeAreaEnv.expandBy(o)}setVertexFactory(t){this._vertexFactory=t}formInitialDelaunay(){this.computeBoundingBox(),this._subdiv=new gs(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new fs(this._subdiv)),this._incDel=new cs(this._subdiv),this.insertSites(this._initialVertices)}insertSite(){if(arguments[0]instanceof ls){let r=arguments[0];var t=this._kdt.insert(r.getCoordinate(),r);if(t.isRepeated()){var e=t.getData();return e.merge(r),e}return this._incDel.insertSite(r),r}if(arguments[0]instanceof _){let t=arguments[0];this.insertSite(this.createVertex(t))}}getClass(){return ws}get interfaces_(){return[]}}ws.constructor_=function(){this._initialVertices=null,this._segVertices=null,this._segments=new C,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new os,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;let t=arguments[0],e=arguments[1];this._initialVertices=new C(t),this._tolerance=e,this._kdt=new Xr(e)},ws.MAX_SPLIT_ITER=99;class xs{constructor(){xs.constructor_.apply(this,arguments)}static extractUniqueCoordinates(t){if(null===t)return new P;var e=t.getCoordinates();return xs.unique(e)}static envelope(t){for(var e=new R,r=t.iterator();r.hasNext();){var n=r.next();e.expandToInclude(n)}return e}static unique(t){var e=Q.copyDeep(t);return vt.sort(e),new P(e,!1)}static toVertices(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next();e.add(new as(n))}return e}create(){if(null!==this._subdiv)return null;var t=xs.envelope(this._siteCoords),e=xs.toVertices(this._siteCoords);this._subdiv=new gs(t,this._tolerance),new cs(this._subdiv).insertSites(e)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof W){let t=arguments[0];this._siteCoords=xs.extractUniqueCoordinates(t)}else if(b(arguments[0],x)){let t=arguments[0];this._siteCoords=xs.unique(Q.toCoordinateArray(t))}}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}getClass(){return xs}get interfaces_(){return[]}}xs.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null};class Es{constructor(){Es.constructor_.apply(this,arguments)}static createConstraintSegments(){if(1===arguments.length){let i=arguments[0];for(var t=Ne.getLines(i),e=new C,r=t.iterator();r.hasNext();){var n=r.next();Es.createConstraintSegments(n,e)}return e}if(2===arguments.length){let t=arguments[1];var i=arguments[0].getCoordinates();for(r=1;r<i.length;r++)t.add(new bs(i[r-1],i[r]))}}createSiteVertices(t){for(var e=new C,r=t.iterator();r.hasNext();){var n=r.next();this._constraintVertexMap.containsKey(n)||e.add(new ls(n))}return e}create(){if(null!==this._subdiv)return null;var t=xs.envelope(this._siteCoords),e=new C;null!==this._constraintLines&&(t.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),e=Es.createConstraintSegments(this._constraintLines));var r=this.createSiteVertices(this._siteCoords),n=new ws(r,this._tolerance);n.setConstraints(e,new C(this._constraintVertexMap.values())),n.formInitialDelaunay(),n.enforceConstraints(),this._subdiv=n.getSubdivision()}setTolerance(t){this._tolerance=t}setConstraints(t){this._constraintLines=t}setSites(t){this._siteCoords=xs.extractUniqueCoordinates(t)}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}createVertices(t){for(var e=t.getCoordinates(),r=0;r<e.length;r++){var n=new ls(e[r]);this._constraintVertexMap.put(e[r],n)}}getClass(){return Es}get interfaces_(){return[]}}Es.constructor_=function(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new pt};class Ss{constructor(){Ss.constructor_.apply(this,arguments)}static clipGeometryCollection(t,e){for(var r=t.getFactory().toGeometry(e),n=new C,i=0;i<t.getNumGeometries();i++){var o=t.getGeometryN(i),s=null;e.contains(o.getEnvelopeInternal())?s=o:e.intersects(o.getEnvelopeInternal())&&(s=r.intersection(o)).setUserData(o.getUserData()),null===s||s.isEmpty()||n.add(s)}return t.getFactory().createGeometryCollection(se.toGeometryArray(n))}create(){if(null!==this._subdiv)return null;var t=xs.envelope(this._siteCoords);this._diagramEnv=t;var e=Math.max(this._diagramEnv.getWidth(),this._diagramEnv.getHeight());this._diagramEnv.expandBy(e),null!==this._clipEnv&&this._diagramEnv.expandToInclude(this._clipEnv);var r=xs.toVertices(this._siteCoords);this._subdiv=new gs(t,this._tolerance),new cs(this._subdiv).insertSites(r)}getDiagram(t){this.create();var e=this._subdiv.getVoronoiDiagram(t);return Ss.clipGeometryCollection(e,this._diagramEnv)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof W){let t=arguments[0];this._siteCoords=xs.extractUniqueCoordinates(t)}else if(b(arguments[0],x)){let t=arguments[0];this._siteCoords=xs.unique(Q.toCoordinateArray(t))}}setClipEnvelope(t){this._clipEnv=t}getSubdivision(){return this.create(),this._subdiv}getClass(){return Ss}get interfaces_(){return[]}}Ss.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null};var Is=Object.freeze({Vertex:as}),Os=Object.freeze({ConformingDelaunayTriangulationBuilder:Es,DelaunayTriangulationBuilder:xs,VoronoiDiagramBuilder:Ss,quadedge:Is});class Cs{constructor(){Cs.constructor_.apply(this,arguments)}static getEndLocation(t){var e=new Cs;return e.setToEnd(t),e}static pointAlongSegmentByFraction(t,e,r){if(r<=0)return t;if(r>=1)return e;var n=(e.x-t.x)*r+t.x,i=(e.y-t.y)*r+t.y,o=(e.z-t.z)*r+t.z;return new _(n,i,o)}static compareLocationValues(t,e,r,n,i,o){return t<n?-1:t>n?1:e<i?-1:e>i?1:r<o?-1:r>o?1:0}getSegmentIndex(){return this._segmentIndex}getComponentIndex(){return this._componentIndex}isEndpoint(t){var e=t.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex>=e||this._segmentIndex===e&&this._segmentFraction>=1}isValid(t){if(this._componentIndex<0||this._componentIndex>=t.getNumGeometries())return!1;var e=t.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>e.getNumPoints()||this._segmentIndex===e.getNumPoints()&&0!==this._segmentFraction||this._segmentFraction<0||this._segmentFraction>1)}normalize(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),1===this._segmentFraction&&(this._segmentFraction=0,this._segmentIndex+=1)}toLowest(t){var e=t.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex<e?this:new Cs(this._componentIndex,e,1,!1)}getCoordinate(t){var e=t.getGeometryN(this._componentIndex),r=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=e.getNumPoints()-1)return r;var n=e.getCoordinateN(this._segmentIndex+1);return Cs.pointAlongSegmentByFraction(r,n,this._segmentFraction)}getSegmentFraction(){return this._segmentFraction}getSegment(t){var e=t.getGeometryN(this._componentIndex),r=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=e.getNumPoints()-1){var n=e.getCoordinateN(e.getNumPoints()-2);return new de(n,r)}var i=e.getCoordinateN(this._segmentIndex+1);return new de(r,i)}clamp(t){if(this._componentIndex>=t.getNumGeometries())return this.setToEnd(t),null;if(this._segmentIndex>=t.getNumPoints()){var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}}setToEnd(t){this._componentIndex=t.getNumGeometries()-1;var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}compareTo(t){var e=t;return this._componentIndex<e._componentIndex?-1:this._componentIndex>e._componentIndex?1:this._segmentIndex<e._segmentIndex?-1:this._segmentIndex>e._segmentIndex?1:this._segmentFraction<e._segmentFraction?-1:this._segmentFraction>e._segmentFraction?1:0}copy(){return new Cs(this._componentIndex,this._segmentIndex,this._segmentFraction)}toString(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}isOnSameSegment(t){return this._componentIndex===t._componentIndex&&(this._segmentIndex===t._segmentIndex||t._segmentIndex-this._segmentIndex==1&&0===t._segmentFraction||this._segmentIndex-t._segmentIndex==1&&0===this._segmentFraction)}snapToVertex(t,e){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;var r=this.getSegmentLength(t),n=this._segmentFraction*r,i=r-n;n<=i&&n<e?this._segmentFraction=0:i<=n&&i<e&&(this._segmentFraction=1)}compareLocationValues(t,e,r){return this._componentIndex<t?-1:this._componentIndex>t?1:this._segmentIndex<e?-1:this._segmentIndex>e?1:this._segmentFraction<r?-1:this._segmentFraction>r?1:0}getSegmentLength(t){var e=t.getGeometryN(this._componentIndex),r=this._segmentIndex;this._segmentIndex>=e.getNumPoints()-1&&(r=e.getNumPoints()-2);var n=e.getCoordinateN(r),i=e.getCoordinateN(r+1);return n.distance(i)}isVertex(){return this._segmentFraction<=0||this._segmentFraction>=1}getClass(){return Cs}get interfaces_(){return[h]}}Cs.constructor_=function(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._componentIndex=t._componentIndex,this._segmentIndex=t._segmentIndex,this._segmentFraction=t._segmentFraction}else if(2===arguments.length){let t=arguments[0],e=arguments[1];Cs.constructor_.call(this,0,t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=r,this.normalize()}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=r,n&&this.normalize()}};class Ts{constructor(){Ts.constructor_.apply(this,arguments)}static segmentEndVertexIndex(t){return t.getSegmentFraction()>0?t.getSegmentIndex()+1:t.getSegmentIndex()}getComponentIndex(){return this._componentIndex}getLine(){return this._currentLine}getVertexIndex(){return this._vertexIndex}getSegmentEnd(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}next(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}loadCurrentLine(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}getSegmentStart(){return this._currentLine.getCoordinateN(this._vertexIndex)}isEndOfLine(){return!(this._componentIndex>=this._numLines||this._vertexIndex<this._currentLine.getNumPoints()-1)}hasNext(){return!(this._componentIndex>=this._numLines||this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}getClass(){return Ts}get interfaces_(){return[]}}Ts.constructor_=function(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,1===arguments.length){let t=arguments[0];Ts.constructor_.call(this,t,0,0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];Ts.constructor_.call(this,t,e.getComponentIndex(),Ts.segmentEndVertexIndex(e))}else if(3===arguments.length){let t=arguments[0],e=arguments[1],n=arguments[2];if(!b(t,dt))throw new r("Lineal geometry is required");this._linearGeom=t,this._numLines=t.getNumGeometries(),this._componentIndex=e,this._vertexIndex=n,this.loadCurrentLine()}};class Ps{constructor(){Ps.constructor_.apply(this,arguments)}static indexOf(t,e){return new Ps(t).indexOf(e)}static indexOfAfter(t,e,r){return new Ps(t).indexOfAfter(e,r)}indexOf(t){return this.indexOfFromStart(t,null)}indexOfFromStart(t,e){for(var r=i.MAX_VALUE,n=0,o=0,s=-1,a=new de,l=new Ts(this._linearGeom);l.hasNext();l.next())if(!l.isEndOfLine()){a.p0=l.getSegmentStart(),a.p1=l.getSegmentEnd();var u=a.distance(t),c=a.segmentFraction(t),h=l.getComponentIndex(),f=l.getVertexIndex();u<r&&(null===e||e.compareLocationValues(h,f,c)<0)&&(n=h,o=f,s=c,r=u)}return r===i.MAX_VALUE?new Cs(e):new Cs(n,o,s)}indexOfAfter(t,e){if(null===e)return this.indexOf(t);var r=Cs.getEndLocation(this._linearGeom);if(r.compareTo(e)<=0)return r;var n=this.indexOfFromStart(t,e);return m.isTrue(n.compareTo(e)>=0,"computed location is before specified minimum location"),n}getClass(){return Ps}get interfaces_(){return[]}}Ps.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class Rs{constructor(){Rs.constructor_.apply(this,arguments)}static indicesOf(t,e){return new Rs(t).indicesOf(e)}indicesOf(t){var e=t.getGeometryN(0).getCoordinateN(0),r=t.getGeometryN(t.getNumGeometries()-1),n=r.getCoordinateN(r.getNumPoints()-1),i=new Ps(this._linearGeom),o=new Array(2).fill(null);return o[0]=i.indexOf(e),0===t.getLength()?o[1]=o[0].copy():o[1]=i.indexOfAfter(n,o[0]),o}getClass(){return Rs}get interfaces_(){return[]}}Rs.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class Ls{constructor(){Ls.constructor_.apply(this,arguments)}getGeometry(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}getLastCoordinate(){return this._lastPt}endLine(){if(null===this._coordList)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;var t=this._coordList.toCoordinateArray(),e=t;this._fixInvalidLines&&(e=this.validCoordinateSequence(t)),this._coordList=null;var n=null;try{n=this._geomFact.createLineString(e)}catch(t){if(!(t instanceof r))throw t;if(!this._ignoreInvalidLines)throw t}null!==n&&this._lines.add(n)}setFixInvalidLines(t){this._fixInvalidLines=t}add(){if(1===arguments.length){let t=arguments[0];this.add(t,!0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];null===this._coordList&&(this._coordList=new P),this._coordList.add(t,e),this._lastPt=t}}setIgnoreInvalidLines(t){this._ignoreInvalidLines=t}validCoordinateSequence(t){return t.length>=2?t:[t[0],t[0]]}getClass(){return Ls}get interfaces_(){return[]}}Ls.constructor_=function(){this._geomFact=null,this._lines=new C,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;let t=arguments[0];this._geomFact=t};class Ms{constructor(){Ms.constructor_.apply(this,arguments)}static extract(t,e,r){return new Ms(t).extract(e,r)}computeLinear(t,e){var r=new Ls(this._line.getFactory());r.setFixInvalidLines(!0),t.isVertex()||r.add(t.getCoordinate(this._line));for(var n=new Ts(this._line,t);n.hasNext()&&!(e.compareLocationValues(n.getComponentIndex(),n.getVertexIndex(),0)<0);n.next()){var i=n.getSegmentStart();r.add(i),n.isEndOfLine()&&r.endLine()}return e.isVertex()||r.add(e.getCoordinate(this._line)),r.getGeometry()}computeLine(t,e){var r=this._line.getCoordinates(),n=new P,i=t.getSegmentIndex();t.getSegmentFraction()>0&&(i+=1);var o=e.getSegmentIndex();1===e.getSegmentFraction()&&(o+=1),o>=r.length&&(o=r.length-1),t.isVertex()||n.add(t.getCoordinate(this._line));for(var s=i;s<=o;s++)n.add(r[s]);e.isVertex()||n.add(e.getCoordinate(this._line)),n.size()<=0&&n.add(t.getCoordinate(this._line));var a=n.toCoordinateArray();return a.length<=1&&(a=[a[0],a[0]]),this._line.getFactory().createLineString(a)}extract(t,e){return e.compareTo(t)<0?this.reverse(this.computeLinear(e,t)):this.computeLinear(t,e)}reverse(t){return t instanceof Ft||t instanceof St?t.reverse():(m.shouldNeverReachHere("non-linear geometry encountered"),null)}getClass(){return Ms}get interfaces_(){return[]}}Ms.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class ks{constructor(){ks.constructor_.apply(this,arguments)}clampIndex(t){var e=t.copy();return e.clamp(this._linearGeom),e}project(t){return Ps.indexOf(this._linearGeom,t)}checkGeometryType(){if(!(this._linearGeom instanceof Ft||this._linearGeom instanceof St))throw new r("Input geometry must be linear")}extractPoint(){if(1===arguments.length)return arguments[0].getCoordinate(this._linearGeom);if(2===arguments.length){let e=arguments[1];var t=arguments[0].toLowest(this._linearGeom);return t.getSegment(this._linearGeom).pointAlongOffset(t.getSegmentFraction(),e)}}isValidIndex(t){return t.isValid(this._linearGeom)}getEndIndex(){return Cs.getEndLocation(this._linearGeom)}getStartIndex(){return new Cs}indexOfAfter(t,e){return Ps.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){return Ms.extract(this._linearGeom,t,e)}indexOf(t){return Ps.indexOf(this._linearGeom,t)}indicesOf(t){return Rs.indicesOf(this._linearGeom,t)}getClass(){return ks}get interfaces_(){return[]}}ks.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t,this.checkGeometryType()};class Ns{constructor(){Ns.constructor_.apply(this,arguments)}static indexOf(t,e){return new Ns(t).indexOf(e)}static indexOfAfter(t,e,r){return new Ns(t).indexOfAfter(e,r)}indexOf(t){return this.indexOfFromStart(t,-1)}indexOfFromStart(t,e){for(var r=i.MAX_VALUE,n=e,o=0,s=new de,a=new Ts(this._linearGeom);a.hasNext();){if(!a.isEndOfLine()){s.p0=a.getSegmentStart(),s.p1=a.getSegmentEnd();var l=s.distance(t),u=this.segmentNearestMeasure(s,t,o);l<r&&u>e&&(n=u,r=l),o+=s.getLength()}a.next()}return n}indexOfAfter(t,e){if(e<0)return this.indexOf(t);var r=this._linearGeom.getLength();if(r<e)return r;var n=this.indexOfFromStart(t,e);return m.isTrue(n>=e,"computed index is before specified minimum index"),n}segmentNearestMeasure(t,e,r){var n=t.projectionFactor(e);return n<=0?r:n<=1?r+n*t.getLength():r+t.getLength()}getClass(){return Ns}get interfaces_(){return[]}}Ns.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class As{constructor(){As.constructor_.apply(this,arguments)}static getLength(t,e){return new As(t).getLength(e)}static getLocation(){if(2===arguments.length){let t=arguments[1];return new As(arguments[0]).getLocation(t)}if(3===arguments.length){let t=arguments[1],e=arguments[2];return new As(arguments[0]).getLocation(t,e)}}getLength(t){for(var e=0,r=new Ts(this._linearGeom);r.hasNext();){if(!r.isEndOfLine()){var n=r.getSegmentStart(),i=r.getSegmentEnd().distance(n);if(t.getComponentIndex()===r.getComponentIndex()&&t.getSegmentIndex()===r.getVertexIndex())return e+i*t.getSegmentFraction();e+=i}r.next()}return e}resolveHigher(t){if(!t.isEndpoint(this._linearGeom))return t;var e=t.getComponentIndex();if(e>=this._linearGeom.getNumGeometries()-1)return t;do{e++}while(e<this._linearGeom.getNumGeometries()-1&&0===this._linearGeom.getGeometryN(e).getLength());return new Cs(e,0,0)}getLocation(){if(1===arguments.length){let t=arguments[0];return this.getLocation(t,!0)}if(2===arguments.length){let r=arguments[0],n=arguments[1];var t=r;r<0&&(t=this._linearGeom.getLength()+r);var e=this.getLocationForward(t);return n?e:this.resolveHigher(e)}}getLocationForward(t){if(t<=0)return new Cs;for(var e=0,r=new Ts(this._linearGeom);r.hasNext();){if(r.isEndOfLine()){if(e===t){var n=r.getComponentIndex(),i=r.getVertexIndex();return new Cs(n,i,0)}}else{var o=r.getSegmentStart(),s=r.getSegmentEnd().distance(o);if(e+s>t){var a=(t-e)/s;return n=r.getComponentIndex(),i=r.getVertexIndex(),new Cs(n,i,a)}e+=s}r.next()}return Cs.getEndLocation(this._linearGeom)}getClass(){return As}get interfaces_(){return[]}}As.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class Fs{constructor(){Fs.constructor_.apply(this,arguments)}clampIndex(t){var e=this.positiveIndex(t),r=this.getStartIndex();if(e<r)return r;var n=this.getEndIndex();return e>n?n:e}locationOf(){if(1===arguments.length){let t=arguments[0];return As.getLocation(this._linearGeom,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return As.getLocation(this._linearGeom,t,e)}}project(t){return Ns.indexOf(this._linearGeom,t)}positiveIndex(t){return t>=0?t:this._linearGeom.getLength()+t}extractPoint(){if(1===arguments.length){let t=arguments[0];return As.getLocation(this._linearGeom,t).getCoordinate(this._linearGeom)}if(2===arguments.length){let e=arguments[0],r=arguments[1];var t=As.getLocation(this._linearGeom,e).toLowest(this._linearGeom);return t.getSegment(this._linearGeom).pointAlongOffset(t.getSegmentFraction(),r)}}isValidIndex(t){return t>=this.getStartIndex()&&t<=this.getEndIndex()}getEndIndex(){return this._linearGeom.getLength()}getStartIndex(){return 0}indexOfAfter(t,e){return Ns.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){new ks(this._linearGeom);var r=this.clampIndex(t),n=this.clampIndex(e),i=r===n,o=this.locationOf(r,i),s=this.locationOf(n);return Ms.extract(this._linearGeom,o,s)}indexOf(t){return Ns.indexOf(this._linearGeom,t)}indicesOf(t){var e=Rs.indicesOf(this._linearGeom,t);return[As.getLength(this._linearGeom,e[0]),As.getLength(this._linearGeom,e[1])]}getClass(){return Fs}get interfaces_(){return[]}}Fs.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};var Ds=Object.freeze({LengthIndexedLine:Fs,LengthLocationMap:As,LinearGeometryBuilder:Ls,LinearIterator:Ts,LinearLocation:Cs,LocationIndexedLine:ks});class js{get interfaces_(){return[]}getClass(){return js}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return eo.createEmptyResult(eo.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Qi.overlayOp(t,e,eo.UNION)}}W.prototype.equalsTopo=function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&Io.relate(this,t).isEquals(this.getDimension(),t.getDimension())},W.prototype.union=function(){if(0===arguments.length)return Lo.union(this);if(1===arguments.length){let t=arguments[0];return js.union(this,t)}},W.prototype.isValid=function(){return jo.isValid(this)},W.prototype.intersection=function(t){if(this.isEmpty()||t.isEmpty())return eo.createEmptyResult(eo.INTERSECTION,this,t,this._factory);if(this.isGeometryCollection()){var e=t;return Bi.map(this,{interfaces_:[MapOp],map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Qi.overlayOp(this,t,eo.INTERSECTION)},W.prototype.covers=function(t){return Io.covers(this,t)},W.prototype.coveredBy=function(t){return Io.covers(t,this)},W.prototype.touches=function(t){return Io.touches(this,t)},W.prototype.intersects=function(t){return Io.intersects(this,t)},W.prototype.within=function(t){return Io.contains(t,this)},W.prototype.overlaps=function(t){return Io.overlaps(this,t)},W.prototype.disjoint=function(t){return Io.disjoint(this,t)},W.prototype.crosses=function(t){return Io.crosses(this,t)},W.prototype.buffer=function(){if(1===arguments.length){let t=arguments[0];return mi.bufferOp(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return mi.bufferOp(this,t,e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];return mi.bufferOp(this,t,e,r)}},W.prototype.convexHull=function(){return new Qe(this).getConvexHull()},W.prototype.relate=function(...t){if(1===arguments.length){let t=arguments[0];return Io.relate(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return Io.relate(this,t).matches(e)}},W.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();var t=Ze.getCentroid(this);return this.createPointFromInternalCoord(t,this)},W.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();var t=null,e=this.getDimension();return t=0===e?new ir(this).getInteriorPoint():1===e?new nr(this).getInteriorPoint():new er(this).getInteriorPoint(),this.createPointFromInternalCoord(t,this)},W.prototype.symDifference=function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return eo.createEmptyResult(eo.SYMDIFFERENCE,this,t,this._factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Qi.overlayOp(this,t,eo.SYMDIFFERENCE)},W.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},W.prototype.toText=function(){return(new he).write(this)},W.prototype.toString=function(){this.toText()},W.prototype.contains=function(t){return Io.contains(this,t)},W.prototype.difference=function(t){return this.isEmpty()?eo.createEmptyResult(eo.DIFFERENCE,this,t,this._factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Qi.overlayOp(this,t,eo.DIFFERENCE))},W.prototype.isSimple=function(){return new Gn(this).isSimple()},W.prototype.isWithinDistance=function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&Ei.isWithinDistance(this,t,e)},W.prototype.distance=function(t){return Ei.distance(this,t)},W.prototype.isEquivalentClass=function(t){return this.getClass()===t.getClass()},t.version="2.0.2 (f363091)",t.algorithm=ar,t.densify=hr,t.dissolve=vr,t.geom=ve,t.geomgraph=qr,t.index=yn,t.io=xn,t.noding=jn,t.operation=zo,t.precision=Vo,t.simplify=rs,t.triangulate=Os,t.linearref=Ds,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"easeIn",(function(){return Pu})),r.d(n,"easeOut",(function(){return Ru})),r.d(n,"inAndOut",(function(){return Lu})),r.d(n,"linear",(function(){return Mu})),r.d(n,"upAndDown",(function(){return ku}));var i={};r.r(i),r.d(i,"TOP",(function(){return Gb})),r.d(i,"MIDDLE",(function(){return zb})),r.d(i,"BOTTOM",(function(){return Ub})),r.d(i,"ALPHABETIC",(function(){return Bb})),r.d(i,"HANGING",(function(){return Vb})),r.d(i,"IDEOGRAPHIC",(function(){return qb}));var o={};r.r(o),r.d(o,"LEFT",(function(){return Yb})),r.d(o,"CENTER",(function(){return Wb})),r.d(o,"RIGHT",(function(){return Xb})),r.d(o,"JUSTIFY",(function(){return Hb}));var s={};r.r(s),r.d(s,"show",(function(){return UO})),r.d(s,"info",(function(){return BO})),r.d(s,"error",(function(){return VO})),r.d(s,"success",(function(){return qO}));var a={};r.r(a),r.d(a,"POINT",(function(){return yG})),r.d(a,"LINE",(function(){return mG})),r.d(a,"POLYGON",(function(){return _G})),r.d(a,"MPOINT",(function(){return vG})),r.d(a,"MLINE",(function(){return bG})),r.d(a,"MPOLYGON",(function(){return wG}));var l=r(3),u=r.n(l),c={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},h={9001:c.METERS,9002:c.FEET,9003:c.USFEET,9101:c.RADIANS,9102:c.DEGREES};function f(t){return h[t]}var p={};p[c.RADIANS]=6370997/(2*Math.PI),p[c.DEGREES]=2*Math.PI*6370997/360,p[c.FEET]=.3048,p[c.METERS]=1,p[c.USFEET]=1200/3937;var d=c,g=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||p[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();function y(t,e,r){return Math.min(Math.max(t,e),r)}var m="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},_="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function v(t,e,r,n,i,o){var s=i-r,a=o-n;if(0!==s||0!==a){var l=((t-r)*s+(e-n)*a)/(s*s+a*a);l>1?(r=i,n=o):l>0&&(r+=s*l,n+=a*l)}return b(t,e,r,n)}function b(t,e,r,n){var i=r-t,o=n-e;return i*i+o*o}function w(t){return 180*t/Math.PI}function x(t){return t*Math.PI/180}function E(t,e){var r=t%e;return r*e<0?r+e:r}function S(t,e,r){return t+r*(e-t)}var I,O=(I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}I(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),C=6378137,T=Math.PI*C,P=[-T,-T,T,T],R=[-180,-85,180,85],L=C*Math.log(Math.tan(Math.PI/2)),k=function(t){function e(e){return t.call(this,{code:e,units:d.METERS,extent:P,global:!0,worldExtent:R,getPointResolution:function(t,e){return t/m(e[1]/C)}})||this}return O(e,t),e}(g),N=[new k("EPSG:3857"),new k("EPSG:102100"),new k("EPSG:102113"),new k("EPSG:900913"),new k("http://www.opengis.net/def/crs/EPSG/0/3857"),new k("http://www.opengis.net/gml/srs/epsg.xml#3857")];function A(t,e,r){var n=t.length,i=r>1?r:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(n));for(var s=0;s<n;s+=i){o[s]=T*t[s]/180;var a=C*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));a>L?a=L:a<-L&&(a=-L),o[s+1]=a}return o}function F(t,e,r){var n=t.length,i=r>1?r:2,o=e;void 0===o&&(o=i>2?t.slice():new Array(n));for(var s=0;s<n;s+=i)o[s]=180*t[s]/T,o[s+1]=360*Math.atan(Math.exp(t[s+1]/C))/Math.PI-90;return o}var D=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),j=[-180,-90,180,90],G=6378137*Math.PI/180,z=function(t){function e(e,r){return t.call(this,{code:e,units:d.DEGREES,extent:j,axisOrientation:r,global:!0,metersPerUnit:G,worldExtent:j})||this}return D(e,t),e}(g),U=[new z("CRS:84"),new z("EPSG:4326","neu"),new z("urn:ogc:def:crs:OGC:1.3:CRS84"),new z("urn:ogc:def:crs:OGC:2:84"),new z("http://www.opengis.net/def/crs/OGC/1.3/CRS84","neu"),new z("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new z("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],B={};var V="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1,i=arguments.length;n<i;++n){var o=arguments[n];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(r[s]=o[s])}return r};function q(t){for(var e in t)delete t[e]}var Y="function"==typeof Object.values?Object.values:function(t){var e=[];for(var r in t)e.push(t[r]);return e};function W(t){var e;for(e in t)return!1;return!e}var X={};function H(t,e,r){var n=t.getCode(),i=e.getCode();n in X||(X[n]={}),X[n][i]=r}function Z(t,e){var r;return t in X&&e in X[t]&&(r=X[t][e]),r}var K="bottom-left",$="bottom-right",J="top-left",Q="top-right",tt=0,et=1,rt=2,nt=4,it=8,ot=16,st=r(0),at=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lt=function(t){function e(e){var r=this,n="Assertion failed. See https://openlayers.org/en/"+("latest"===st.a?st.a:"v"+st.a.split("-")[0])+"/doc/errors/#"+e+" for details.";return(r=t.call(this,n)||this).code=e,r.name="AssertionError",r.message=n,r}return at(e,t),e}(Error);function ut(t,e){if(!t)throw new lt(e)}function ct(t){for(var e=_t(),r=0,n=t.length;r<n;++r)It(e,t[r]);return e}function ht(t,e,r){return r?(r[0]=t[0]-e,r[1]=t[1]-e,r[2]=t[2]+e,r[3]=t[3]+e,r):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function ft(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function pt(t,e,r){var n,i;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(i=r<t[1]?t[1]-r:t[3]<r?r-t[3]:0)*i}function dt(t,e){return yt(t,e[0],e[1])}function gt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function yt(t,e,r){return t[0]<=e&&e<=t[2]&&t[1]<=r&&r<=t[3]}function mt(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],s=e[0],a=e[1],l=tt;return s<r?l|=ot:s>i&&(l|=nt),a<n?l|=it:a>o&&(l|=rt),l===tt&&(l=et),l}function _t(){return[1/0,1/0,-1/0,-1/0]}function vt(t,e,r,n,i){return i?(i[0]=t,i[1]=e,i[2]=r,i[3]=n,i):[t,e,r,n]}function bt(t){return vt(1/0,1/0,-1/0,-1/0,t)}function wt(t,e){var r=t[0],n=t[1];return vt(r,n,r,n,e)}function xt(t,e,r,n,i){return Ot(bt(i),t,e,r,n)}function Et(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function St(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function It(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ot(t,e,r,n,i){for(;r<n;r+=i)Ct(t,e[r],e[r+1]);return t}function Ct(t,e,r){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],r),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],r)}function Tt(t,e){var r;return(r=e(Rt(t)))||(r=e(Lt(t)))||(r=e(jt(t)))?r:(r=e(Dt(t)))||!1}function Pt(t){var e=0;return Ut(t)||(e=Gt(t)*At(t)),e}function Rt(t){return[t[0],t[1]]}function Lt(t){return[t[2],t[1]]}function Mt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function kt(t,e){var r;return e===K?r=Rt(t):e===$?r=Lt(t):e===J?r=Dt(t):e===Q?r=jt(t):ut(!1,13),r}function Nt(t,e,r,n,i){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(r),l=Math.sin(r),u=o*a,c=o*l,h=s*a,f=s*l,p=t[0],d=t[1],g=p-u+f,y=p-u-f,m=p+u-f,_=p+u+f,v=d-c-h,b=d-c+h,w=d+c+h,x=d+c-h;return vt(Math.min(g,y,m,_),Math.min(v,b,w,x),Math.max(g,y,m,_),Math.max(v,b,w,x),i)}function At(t){return t[3]-t[1]}function Ft(t,e,r){var n=r||[1/0,1/0,-1/0,-1/0];return zt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):bt(n),n}function Dt(t){return[t[0],t[3]]}function jt(t){return[t[2],t[3]]}function Gt(t){return t[2]-t[0]}function zt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ut(t){return t[2]<t[0]||t[3]<t[1]}function Bt(t,e){var r=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=r,t[2]+=r,t[1]-=n,t[3]+=n}function Vt(t,e,r,n){var i=[];if(n>1)for(var o=t[2]-t[0],s=t[3]-t[1],a=0;a<n;++a)i.push(t[0]+o*a/n,t[1],t[2],t[1]+s*a/n,t[2]-o*a/n,t[3],t[0],t[3]-s*a/n);else i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(i,i,2);for(var l=[],u=[],c=(a=0,i.length);a<c;a+=2)l.push(i[a]),u.push(i[a+1]);return function(t,e,r){return vt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),r)}(l,u,r)}function qt(t,e){var r=e.getExtent(),n=Mt(t);if(e.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])){var i=Gt(r),o=Math.floor((n[0]-r[0])/i)*i;t[0]-=o,t[2]-=o}return t}var Yt={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Wt=6371008.8;function Xt(t,e,r){var n=r||Wt,i=x(t[1]),o=x(e[1]),s=(o-i)/2,a=x(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(i)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function Ht(t,e){for(var r=0,n=0,i=t.length;n<i-1;++n)r+=Xt(t[n],t[n+1],e);return r}function Zt(t,e){for(var r=0,n=t.length,i=t[n-1][0],o=t[n-1][1],s=0;s<n;s++){var a=t[s][0],l=t[s][1];r+=x(a-i)*(2+Math.sin(x(o))+Math.sin(x(l))),i=a,o=l}return r*e*e/2}function Kt(t,e,r,n){var i=n||Wt,o=x(t[1]),s=x(t[0]),a=e/i,l=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(r));return[w(s+Math.atan2(Math.sin(r)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(l))),w(l)]}function $t(t,e,r){var n=void 0!==r?t.toFixed(r):""+t,i=n.indexOf(".");return(i=-1===i?n.length:i)>e?n:new Array(1+e-i).join("0")+n}function Jt(t,e){for(var r=(""+t).split("."),n=(""+e).split("."),i=0;i<Math.max(r.length,n.length);i++){var o=parseInt(r[i]||"0",10),s=parseInt(n[i]||"0",10);if(o>s)return 1;if(s>o)return-1}return 0}function Qt(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function te(t,e){var r,n,i=t[0],o=t[1],s=e[0],a=e[1],l=s[0],u=s[1],c=a[0],h=a[1],f=c-l,p=h-u,d=0===f&&0===p?0:(f*(i-l)+p*(o-u))/(f*f+p*p||0);return d<=0?(r=l,n=u):d>=1?(r=c,n=h):(r=l+d*f,n=u+d*p),[r,n]}function ee(t){return function(e){return ce(e,t)}}function re(t,e,r){var n=E(e+180,360)-180,i=Math.abs(3600*n),o=r||0,s=Math.pow(10,o),a=Math.floor(i/3600),l=Math.floor((i-3600*a)/60),u=i-3600*a-60*l;return(u=Math.ceil(u*s)/s)>=60&&(u=0,l+=1),l>=60&&(l=0,a+=1),a+"° "+$t(l,2)+"′ "+$t(u,2,o)+"″"+(0==n?"":" "+t.charAt(n<0?1:0))}function ne(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function ie(t,e){for(var r=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){r=!1;break}return r}function oe(t,e){var r=Math.cos(e),n=Math.sin(e),i=t[0]*r-t[1]*n,o=t[1]*r+t[0]*n;return t[0]=i,t[1]=o,t}function se(t,e){return t[0]*=e,t[1]*=e,t}function ae(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function le(t,e){return Math.sqrt(ae(t,e))}function ue(t,e){return ae(t,te(t,e))}function ce(t,e){return ne(t,"{x}, {y}",e)}function he(t,e){if(e.canWrapX()){var r=Gt(e.getExtent()),n=fe(t,e,r);n&&(t[0]-=n*r)}return t}function fe(t,e,r){var n=e.getExtent(),i=0;if(e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])){var o=r||Gt(n);i=Math.floor((t[0]-n[0])/o)}return i}function pe(t,e,r){var n;if(void 0!==e){for(var i=0,o=t.length;i<o;++i)e[i]=t[i];n=e}else n=t.slice();return n}function de(t,e,r){if(void 0!==e&&t!==e){for(var n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function ge(t){!function(t,e){B[t]=e}(t.getCode(),t),H(t,t,pe)}function ye(t){return"string"==typeof t?B[e=t]||B[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function me(t,e,r,n){var i,o=(t=ye(t)).getPointResolutionFunc();if(o){if(i=o(e,r),n&&n!==t.getUnits())(a=t.getMetersPerUnit())&&(i=i*a/p[n])}else{var s=t.getUnits();if(s==d.DEGREES&&!n||n==d.DEGREES)i=e;else{var a,l=Se(t,ye("EPSG:4326"));if(l===de&&s!==d.DEGREES)i=e*t.getMetersPerUnit();else{var u=[r[0]-e/2,r[1],r[0]+e/2,r[1],r[0],r[1]-e/2,r[0],r[1]+e/2];i=(Xt((u=l(u,u,2)).slice(0,2),u.slice(2,4))+Xt(u.slice(4,6),u.slice(6,8)))/2}void 0!==(a=n?p[n]:t.getMetersPerUnit())&&(i/=a)}}return i}function _e(t){!function(t){t.forEach(ge)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&H(e,t,pe)}))}))}function ve(t,e){return t?"string"==typeof t?ye(t):t:ye(e)}function be(t){return function(e,r,n){for(var i=e.length,o=void 0!==n?n:2,s=void 0!==r?r:new Array(i),a=0;a<i;a+=o){var l=t([e[a],e[a+1]]);s[a]=l[0],s[a+1]=l[1];for(var u=o-1;u>=2;--u)s[a+u]=e[a+u]}return s}}function we(t,e,r,n){var i=ye(t),o=ye(e);H(i,o,be(r)),H(o,i,be(n))}function xe(t,e){return Oe(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function Ee(t,e){if(t===e)return!0;var r=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Se(t,e)===pe)&&r}function Se(t,e){var r=Z(t.getCode(),e.getCode());return r||(r=de),r}function Ie(t,e){return Se(ye(t),ye(e))}function Oe(t,e,r){return Ie(e,r)(t,void 0,t.length)}function Ce(t,e,r,n){return Vt(t,Ie(e,r),void 0,n)}var Te,Pe,Re,Le=null;function Me(){return Le}function ke(t,e){return Le?Oe(t,e,Le):t}function Ne(t,e){return Le?Oe(t,Le,e):t}function Ae(t,e){return Le?Ce(t,e,Le):t}function Fe(t,e){return Le?Ce(t,Le,e):t}function De(t,e){if(!Le)return t;var r=ye(e).getUnits(),n=Le.getUnits();return r&&n?t*p[r]/p[n]:t}function je(t,e,r){return function(n){var i,o,s=n[0],a=n[1];if(t.canWrapX()){var l=t.getExtent(),u=Gt(l);(o=fe(n,t,u))&&(s-=o*u),s=y(s,l[0],l[2]),a=y(a,l[1],l[3]),i=r([s,a])}else i=r(n);return o&&e.canWrapX()&&(i[0]+=o*Gt(e.getExtent())),i}}_e(N),_e(U),Te=N,Pe=A,Re=F,U.forEach((function(t){Te.forEach((function(e){H(t,e,Pe),H(e,t,Re)}))}));var Ge=function(t,e,r){return Oe(t,ye(e),ye(r))};function ze(t,e){return t>e?1:t<e?-1:0}function Ue(t,e){return t.indexOf(e)>=0}function Be(t,e,r){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var i=void 0;if(r>0){for(i=1;i<n;++i)if(t[i]<e)return i-1}else if(r<0){for(i=1;i<n;++i)if(t[i]<=e)return i}else for(i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return"function"==typeof r?r(e,t[i-1],t[i])>0?i-1:i:t[i-1]-e<e-t[i]?i-1:i}return n-1}function Ve(t,e,r){for(;e<r;){var n=t[e];t[e]=t[r],t[r]=n,++e,--r}}function qe(t,e){for(var r=Array.isArray(e)?e:[e],n=r.length,i=0;i<n;i++)t[t.length]=r[i]}function Ye(t,e){for(var r,n=t.length>>>0,i=0;i<n;i++)if(e(r=t[i],i,t))return r;return null}function We(t,e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Xe(t,e){var r;return!t.every((function(n,i){return r=i,!e(n,i,t)}))?r:-1}var He="http://www.w3.org/2001/XMLSchema-instance";function Ze(t,e){return mr().createElementNS(t,e)}function Ke(t,e){return $e(t,e,[]).join("")}function $e(t,e,r){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n=void 0;for(n=t.firstChild;n;n=n.nextSibling)$e(n,e,r)}return r}function Je(t){return"documentElement"in t}function Qe(t){return(new DOMParser).parseFromString(t,"application/xml")}function tr(t,e){return function(r,n){var i=t.call(void 0!==e?e:this,r,n);void 0!==i&&qe(n[n.length-1],i)}}function er(t,e){return function(r,n){var i=t.call(void 0!==e?e:this,r,n);void 0!==i&&n[n.length-1].push(i)}}function rr(t,e){return function(r,n){var i=t.call(void 0!==e?e:this,r,n);void 0!==i&&(n[n.length-1]=i)}}function nr(t,e,r){return function(n,i){var o=t.call(void 0!==r?r:this,n,i);if(void 0!==o){var s=i[i.length-1],a=void 0!==e?e:n.localName,l=void 0;a in s?l=s[a]:(l=[],s[a]=l),l.push(o)}}}function ir(t,e,r){return function(n,i){var o=t.call(void 0!==r?r:this,n,i);void 0!==o&&(i[i.length-1][void 0!==e?e:n.localName]=o)}}function or(t,e){return function(r,n,i){t.call(void 0!==e?e:this,r,n,i),i[i.length-1].node.appendChild(r)}}function sr(t,e){var r,n;return function(e,i,o){if(void 0===r){r={};var s={};s[e.localName]=t,r[e.namespaceURI]=s,n=ar(e.localName)}pr(r,n,i,o)}}function ar(t,e){var r=t;return function(t,n,i){var o=n[n.length-1].node,s=r;return void 0===s&&(s=i),Ze(void 0!==e?e:o.namespaceURI,s)}}var lr=ar();function ur(t,e){for(var r=e.length,n=new Array(r),i=0;i<r;++i)n[i]=t[e[i]];return n}function cr(t,e,r){var n,i,o=void 0!==r?r:{};for(n=0,i=t.length;n<i;++n)o[t[n]]=e;return o}function hr(t,e,r,n){var i;for(i=e.firstElementChild;i;i=i.nextElementSibling){var o=t[i.namespaceURI];if(void 0!==o){var s=o[i.localName];void 0!==s&&s.call(n,i,r)}}}function fr(t,e,r,n,i){return n.push(t),hr(e,r,n,i),n.pop()}function pr(t,e,r,n,i,o){for(var s,a,l=(void 0!==i?i:r).length,u=0;u<l;++u)void 0!==(s=r[u])&&void 0!==(a=e.call(void 0!==o?o:this,s,n,void 0!==i?i[u]:void 0))&&t[a.namespaceURI][a.localName].call(o,a,s,n)}function dr(t,e,r,n,i,o,s){return i.push(t),pr(e,r,n,i,o,s),i.pop()}var gr=void 0;var yr=void 0;function mr(){return void 0===yr&&"undefined"!=typeof document&&(yr=document.implementation.createDocument("","",null)),yr}var _r=function(){function t(){}return t.prototype.read=function(t){if(t){if("string"==typeof t){var e=Qe(t);return this.readFromDocument(e)}return Je(t)?this.readFromDocument(t):this.readFromNode(t)}return null},t.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},t.prototype.readFromNode=function(t){},t}();function vr(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}function br(t){return wr(Ke(t,!1))}function wr(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?void 0!==e[1]||!1:void 0}function xr(t){var e=Ke(t,!1),r=Date.parse(e);return isNaN(r)?void 0:r/1e3}function Er(t){return Sr(Ke(t,!1))}function Sr(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function Ir(t){return Or(Ke(t,!1))}function Or(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function Cr(t){return Ke(t,!1).trim()}function Tr(t,e){Lr(t,e?"1":"0")}function Pr(t,e){var r=e.toPrecision();t.appendChild(mr().createTextNode(r))}function Rr(t,e){var r=e.toString();t.appendChild(mr().createTextNode(r))}function Lr(t,e){t.appendChild(mr().createTextNode(e))}var Mr=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kr=[null,"http://www.opengis.net/ows/1.1"],Nr=cr(kr,{ServiceIdentification:ir((function(t,e){return fr({},Xr,t,e)})),ServiceProvider:ir((function(t,e){return fr({},Hr,t,e)})),OperationsMetadata:ir((function(t,e){return fr({},Vr,t,e)}))}),Ar=function(t){function e(){return t.call(this)||this}return Mr(e,t),e.prototype.readFromNode=function(t){var e=fr({},Nr,t,[]);return e||null},e}(_r),Fr=cr(kr,{DeliveryPoint:ir(Cr),City:ir(Cr),AdministrativeArea:ir(Cr),PostalCode:ir(Cr),Country:ir(Cr),ElectronicMailAddress:ir(Cr)}),Dr=cr(kr,{Value:nr((function(t,e){return Cr(t)}))}),jr=cr(kr,{AllowedValues:ir((function(t,e){return fr({},Dr,t,e)}))}),Gr=cr(kr,{Phone:ir((function(t,e){return fr({},qr,t,e)})),Address:ir((function(t,e){return fr({},Fr,t,e)}))}),zr=cr(kr,{HTTP:ir((function(t,e){return fr({},Ur,t,e)}))}),Ur=cr(kr,{Get:nr((function(t,e){var r=vr(t);if(!r)return;return fr({href:r},Yr,t,e)})),Post:void 0}),Br=cr(kr,{DCP:ir((function(t,e){return fr({},zr,t,e)}))}),Vr=cr(kr,{Operation:function(t,e){var r=t.getAttribute("name"),n=fr({},Br,t,e);if(!n)return;e[e.length-1][r]=n}}),qr=cr(kr,{Voice:ir(Cr),Facsimile:ir(Cr)}),Yr=cr(kr,{Constraint:nr((function(t,e){var r=t.getAttribute("name");if(!r)return;return fr({name:r},jr,t,e)}))}),Wr=cr(kr,{IndividualName:ir(Cr),PositionName:ir(Cr),ContactInfo:ir((function(t,e){return fr({},Gr,t,e)}))}),Xr=cr(kr,{Abstract:ir(Cr),AccessConstraints:ir(Cr),Fees:ir(Cr),Title:ir(Cr),ServiceTypeVersion:ir(Cr),ServiceType:ir(Cr)}),Hr=cr(kr,{ProviderName:ir(Cr),ProviderSite:ir(vr),ServiceContact:ir((function(t,e){return fr({},Wr,t,e)}))});var Zr=Ar,Kr=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$r=[null,"http://www.opengis.net/wmts/1.0"],Jr=[null,"http://www.opengis.net/ows/1.1"],Qr=cr($r,{Contents:ir((function(t,e){return fr({},en,t,e)}))}),tn=function(t){function e(){var e=t.call(this)||this;return e.owsParser_=new Zr,e}return Kr(e,t),e.prototype.readFromNode=function(t){var e=t.getAttribute("version");e&&(e=e.trim());var r=this.owsParser_.readFromNode(t);return r?(r.version=e,(r=fr(r,Qr,t,[]))||null):null},e}(_r),en=cr($r,{Layer:nr((function(t,e){return fr({},rn,t,e)})),TileMatrixSet:nr((function(t,e){return fr({},cn,t,e)}))}),rn=cr($r,{Style:nr((function(t,e){var r=fr({},nn,t,e);if(!r)return;var n="true"===t.getAttribute("isDefault");return r.isDefault=n,r})),Format:nr(Cr),TileMatrixSetLink:nr((function(t,e){return fr({},on,t,e)})),Dimension:nr((function(t,e){return fr({},ln,t,e)})),ResourceURL:nr((function(t,e){var r=t.getAttribute("format"),n=t.getAttribute("template"),i=t.getAttribute("resourceType"),o={};r&&(o.format=r);n&&(o.template=n);i&&(o.resourceType=i);return o}))},cr(Jr,{Title:ir(Cr),Abstract:ir(Cr),WGS84BoundingBox:ir(fn),Identifier:ir(Cr)})),nn=cr($r,{LegendURL:nr((function(t,e){var r={};return r.format=t.getAttribute("format"),r.href=vr(t),r}))},cr(Jr,{Title:ir(Cr),Identifier:ir(Cr)})),on=cr($r,{TileMatrixSet:ir(Cr),TileMatrixSetLimits:ir((function(t,e){return fr([],sn,t,e)}))}),sn=cr($r,{TileMatrixLimits:er((function(t,e){return fr({},an,t,e)}))}),an=cr($r,{TileMatrix:ir(Cr),MinTileRow:ir(Ir),MaxTileRow:ir(Ir),MinTileCol:ir(Ir),MaxTileCol:ir(Ir)}),ln=cr($r,{Default:ir(Cr),Value:nr(Cr)},cr(Jr,{Identifier:ir(Cr)})),un=cr(Jr,{LowerCorner:er(pn),UpperCorner:er(pn)}),cn=cr($r,{WellKnownScaleSet:ir(Cr),TileMatrix:nr((function(t,e){return fr({},hn,t,e)}))},cr(Jr,{SupportedCRS:ir(Cr),Identifier:ir(Cr),BoundingBox:ir(fn)})),hn=cr($r,{TopLeftCorner:ir(pn),ScaleDenominator:ir(Er),TileWidth:ir(Ir),TileHeight:ir(Ir),MatrixWidth:ir(Ir),MatrixHeight:ir(Ir)},cr(Jr,{Identifier:ir(Cr)}));function fn(t,e){var r=fr([],un,t,e);if(2==r.length)return ct(r)}function pn(t,e){var r=Cr(t).split(/\s+/);if(r&&2==r.length){var n=+r[0],i=+r[1];if(!isNaN(n)&&!isNaN(i))return[n,i]}}var dn=tn,gn=(r(69),r(71),r(73),484813681109536e-20),yn=Math.PI/2,mn=1e-10,_n=.017453292519943295,vn=57.29577951308232,bn=Math.PI/4,wn=2*Math.PI,xn=3.14159265359,En={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Sn={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},In=/[\s_\-\/\(\)]/g;function On(t,e){if(t[e])return t[e];for(var r,n=Object.keys(t),i=e.toLowerCase().replace(In,""),o=-1;++o<n.length;)if((r=n[o]).toLowerCase().replace(In,"")===i)return t[r]}var Cn=function(t){var e,r,n,i={},o=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var r=e.split("=");return r.push(!0),t[r[0].toLowerCase()]=r[1],t}),{}),s={proj:"projName",datum:"datumCode",rf:function(t){i.rf=parseFloat(t)},lat_0:function(t){i.lat0=t*_n},lat_1:function(t){i.lat1=t*_n},lat_2:function(t){i.lat2=t*_n},lat_ts:function(t){i.lat_ts=t*_n},lon_0:function(t){i.long0=t*_n},lon_1:function(t){i.long1=t*_n},lon_2:function(t){i.long2=t*_n},alpha:function(t){i.alpha=parseFloat(t)*_n},lonc:function(t){i.longc=t*_n},x_0:function(t){i.x0=parseFloat(t)},y_0:function(t){i.y0=parseFloat(t)},k_0:function(t){i.k0=parseFloat(t)},k:function(t){i.k0=parseFloat(t)},a:function(t){i.a=parseFloat(t)},b:function(t){i.b=parseFloat(t)},r_a:function(){i.R_A=!0},zone:function(t){i.zone=parseInt(t,10)},south:function(){i.utmSouth=!0},towgs84:function(t){i.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){i.to_meter=parseFloat(t)},units:function(t){i.units=t;var e=On(Sn,t);e&&(i.to_meter=e.to_meter)},from_greenwich:function(t){i.from_greenwich=t*_n},pm:function(t){var e=On(En,t);i.from_greenwich=(e||parseFloat(t))*_n},nadgrids:function(t){"@null"===t?i.datumCode="none":i.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(i.axis=t)}};for(e in o)r=o[e],e in s?"function"==typeof(n=s[e])?n(r):i[n]=r:i[e]=r;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},Tn=function(t){return new Nn(t).output()},Pn=/\s/,Rn=/[A-Za-z]/,Ln=/[A-Za-z84]/,Mn=/[,\]]/,kn=/[\d\.E\-\+]/;function Nn(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function An(t,e,r){Array.isArray(e)&&(r.unshift(e),e=null);var n=e?{}:t,i=r.reduce((function(t,e){return Fn(e,t),t}),n);e&&(t[e]=i)}function Fn(t,e){if(Array.isArray(t)){var r,n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void Fn(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n)switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Fn(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Fn(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void An(e,n,t);default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Fn(t,e[n]);return An(e,n,t)}else e[n]=t;else e[n]=!0}else e[t]=!0}Nn.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Pn.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Nn.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Mn.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Nn.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Nn.prototype.number=function(t){if(!kn.test(t)){if(Mn.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Nn.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Nn.prototype.keyword=function(t){if(Ln.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!Mn.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Nn.prototype.neutral=function(t){if(Rn.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(kn.test(t))return this.word=t,void(this.state=3);if(!Mn.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Nn.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Dn(t){return.017453292519943295*t}var jn=function(t){var e=Tn(t),r=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",r]);var i={};return Fn(e,i),function(t){"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var e=t.GEOGCS;function r(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(e=t),e&&(e.DATUM?t.datumCode=e.DATUM.name.toLowerCase():t.datumCode=e.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),e.DATUM&&e.DATUM.SPHEROID&&(t.ellps=e.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=e.DATUM.SPHEROID.a,t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)),e.DATUM&&e.DATUM.TOWGS84&&(t.datum_params=e.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Dn],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Dn],["x0","false_easting",r],["y0","false_northing",r],["long0","central_meridian",Dn],["lat0","latitude_of_origin",Dn],["lat0","standard_parallel_1",Dn],["lat1","standard_parallel_1",Dn],["lat2","standard_parallel_2",Dn],["azimuth","Azimuth"],["alpha","azimuth",Dn],["srsCode","name"]].forEach((function(e){return r=t,i=(n=e)[0],o=n[1],void(!(i in r)&&o in r&&(r[i]=r[o],3===n.length&&(r[i]=n[2](r[i]))));var r,n,i,o})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=Dn(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(i),i};function Gn(t){var e=this;if(2===arguments.length){var r=arguments[1];"string"==typeof r?"+"===r.charAt(0)?Gn[t]=Cn(arguments[1]):Gn[t]=jn(arguments[1]):Gn[t]=r}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Gn.apply(e,t):Gn(t)}));if("string"==typeof t){if(t in Gn)return Gn[t]}else"EPSG"in t?Gn["EPSG:"+t.EPSG]=t:"ESRI"in t?Gn["ESRI:"+t.ESRI]=t:"IAU2000"in t?Gn["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Gn);var zn=Gn;var Un=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var Bn=["3857","900913","3785","102113"];var Vn=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in zn}(t))return zn[t];if(function(t){return Un.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=jn(t);if(function(t){var e=On(t,"authority");if(e){var r=On(e,"epsg");return r&&Bn.indexOf(r)>-1}}(e))return zn["EPSG:3857"];var r=function(t){var e=On(t,"extension");if(e)return On(e,"proj4")}(e);return r?Cn(r):e}return function(t){return"+"===t[0]}(t)?Cn(t):void 0},qn=function(t,e){var r,n;if(t=t||{},!e)return t;for(n in e)void 0!==(r=e[n])&&(t[n]=r);return t},Yn=function(t,e,r){var n=t*e;return r/Math.sqrt(1-n*n)},Wn=function(t){return t<0?-1:1},Xn=function(t){return Math.abs(t)<=xn?t:t-Wn(t)*wn},Hn=function(t,e,r){var n=t*r,i=.5*t;return n=Math.pow((1-n)/(1+n),i),Math.tan(.5*(yn-e))/n},Zn=function(t,e){for(var r,n,i=.5*t,o=yn-2*Math.atan(e),s=0;s<=15;s++)if(r=t*Math.sin(o),o+=n=yn-2*Math.atan(e*Math.pow((1-r)/(1+r),i))-o,Math.abs(n)<=1e-10)return o;return-9999};function Kn(t){return t}var $n=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Yn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,r,n=t.x,i=t.y;if(i*vn>90&&i*vn<-90&&n*vn>180&&n*vn<-180)return null;if(Math.abs(Math.abs(i)-yn)<=mn)return null;if(this.sphere)e=this.x0+this.a*this.k0*Xn(n-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(bn+.5*i));else{var o=Math.sin(i),s=Hn(this.e,i,o);e=this.x0+this.a*this.k0*Xn(n-this.long0),r=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=r,t},inverse:function(t){var e,r,n=t.x-this.x0,i=t.y-this.y0;if(this.sphere)r=yn-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(r=Zn(this.e,o)))return null}return e=Xn(this.long0+n/(this.a*this.k0)),t.x=e,t.y=r,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Kn,inverse:Kn,names:["longlat","identity"]}],Jn={},Qn=[];function ti(t,e){var r=Qn.length;return t.names?(Qn[r]=t,t.names.forEach((function(t){Jn[t.toLowerCase()]=r})),this):(console.log(e),!0)}var ei={start:function(){$n.forEach(ti)},add:ti,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Jn[e]&&Qn[Jn[e]]?Qn[Jn[e]]:void 0}},ri={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ni=ri.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};ri.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var ii={};ii.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ii.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ii.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},ii.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},ii.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},ii.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},ii.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},ii.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ii.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ii.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},ii.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},ii.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},ii.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},ii.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},ii.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},ii.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},ii.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var oi=function(t,e,r,n,i,o){var s={};return s.datum_type=void 0===t||"none"===t?5:4,e&&(s.datum_params=e.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=1),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=2,s.datum_params[3]*=gn,s.datum_params[4]*=gn,s.datum_params[5]*=gn,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=r,s.b=n,s.es=i,s.ep2=o,s};function si(t,e){if(!(this instanceof si))return new si(t);e=e||function(t){if(t)throw t};var r=Vn(t);if("object"==typeof r){var n=si.projections.get(r.projName);if(n){if(r.datumCode&&"none"!==r.datumCode){var i=On(ii,r.datumCode);i&&(r.datum_params=i.towgs84?i.towgs84.split(","):null,r.ellps=i.ellipse,r.datumName=i.datumName?i.datumName:r.datumCode)}r.k0=r.k0||1,r.axis=r.axis||"enu",r.ellps=r.ellps||"wgs84";var o,s,a,l,u,c,h,f=function(t,e,r,n,i){if(!t){var o=On(ri,n);o||(o=ni),t=o.a,e=o.b,r=o.rf}return r&&!e&&(e=(1-1/r)*t),(0===r||Math.abs(t-e)<mn)&&(i=!0,e=t),{a:t,b:e,rf:r,sphere:i}}(r.a,r.b,r.rf,r.ellps,r.sphere),p=(o=f.a,s=f.b,f.rf,a=r.R_A,c=((l=o*o)-(u=s*s))/l,h=0,a?(l=(o*=1-c*(.16666666666666666+c*(.04722222222222222+.022156084656084655*c)))*o,c=0):h=Math.sqrt(c),{es:c,e:h,ep2:(l-u)/u}),d=r.datum||oi(r.datumCode,r.datum_params,f.a,f.b,p.es,p.ep2);qn(this,r),qn(this,n),this.a=f.a,this.b=f.b,this.rf=f.rf,this.sphere=f.sphere,this.es=p.es,this.e=p.e,this.ep2=p.ep2,this.datum=d,this.init(),e(null,this)}else e(t)}else e(t)}si.projections=ei,si.projections.start();var ai=si;function li(t){return 1===t||2===t}var ui=function(t,e,r){return function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e)||5===t.datum_type||5===e.datum_type?r:t.es!==e.es||t.a!==e.a||li(t.datum_type)||li(e.datum_type)?(r=function(t,e,r){var n,i,o,s,a=t.x,l=t.y,u=t.z?t.z:0;if(l<-yn&&l>-1.001*yn)l=-yn;else if(l>yn&&l<1.001*yn)l=yn;else{if(l<-yn)return{x:-1/0,y:-1/0,z:t.z};if(l>yn)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),i=Math.sin(l),s=Math.cos(l),o=i*i,{x:((n=r/Math.sqrt(1-e*o))+u)*s*Math.cos(a),y:(n+u)*s*Math.sin(a),z:(n*(1-e)+u)*i}}(r,t.es,t.a),li(t.datum_type)&&(r=function(t,e,r){if(1===e)return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]};if(2===e){var n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],u=r[6];return{x:u*(t.x-l*t.y+a*t.z)+n,y:u*(l*t.x+t.y-s*t.z)+i,z:u*(-a*t.x+s*t.y+t.z)+o}}}(r,t.datum_type,t.datum_params)),li(e.datum_type)&&(r=function(t,e,r){if(1===e)return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]};if(2===e){var n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],u=r[6],c=(t.x-n)/u,h=(t.y-i)/u,f=(t.z-o)/u;return{x:c+l*h-a*f,y:-l*c+h+s*f,z:a*c-s*h+f}}}(r,e.datum_type,e.datum_params)),function(t,e,r,n){var i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v=1e-12,b=t.x,w=t.y,x=t.z?t.z:0;if(i=Math.sqrt(b*b+w*w),o=Math.sqrt(b*b+w*w+x*x),i/r<v){if(m=0,o/r<v)return _=-n,{x:t.x,y:t.y,z:t.z}}else m=Math.atan2(w,b);s=x/o,h=(a=i/o)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*a*a)),f=s*l,y=0;do{y++,u=e*(c=r/Math.sqrt(1-e*f*f))/(c+(_=i*h+x*f-c*(1-e*f*f))),g=(d=s*(l=1/Math.sqrt(1-u*(2-u)*a*a)))*h-(p=a*(1-u)*l)*f,h=p,f=d}while(g*g>1e-24&&y<30);return{x:m,y:Math.atan(d/Math.abs(p)),z:_}}(r,e.es,e.a,e.b)):r},ci=function(t,e,r){var n,i,o,s=r.x,a=r.y,l=r.z||0,u={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==r.z)switch(0===o?(n=s,i="x"):1===o?(n=a,i="y"):(n=l,i="z"),t.axis[o]){case"e":u[i]=n;break;case"w":u[i]=-n;break;case"n":u[i]=n;break;case"s":u[i]=-n;break;case"u":void 0!==r[i]&&(u.z=n);break;case"d":void 0!==r[i]&&(u.z=-n);break;default:return null}return u},hi=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e};function fi(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function pi(t,e,r){var n;return Array.isArray(r)&&(r=hi(r)),function(t){fi(t.x),fi(t.y)}(r),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(r=pi(t,n=new ai("WGS84"),r),t=n),"enu"!==t.axis&&(r=ci(t,!1,r)),"longlat"===t.projName?r={x:r.x*_n,y:r.y*_n}:(t.to_meter&&(r={x:r.x*t.to_meter,y:r.y*t.to_meter}),r=t.inverse(r)),t.from_greenwich&&(r.x+=t.from_greenwich),r=ui(t.datum,e.datum,r),e.from_greenwich&&(r={x:r.x-e.from_greenwich,y:r.y}),"longlat"===e.projName?r={x:r.x*vn,y:r.y*vn}:(r=e.forward(r),e.to_meter&&(r={x:r.x/e.to_meter,y:r.y/e.to_meter})),"enu"!==e.axis?ci(e,!0,r):r}var di=ai("WGS84");function gi(t,e,r){var n,i,o;return Array.isArray(r)?(n=pi(t,e,r),3===r.length?[n.x,n.y,n.z]:[n.x,n.y]):(i=pi(t,e,r),2===(o=Object.keys(r)).length||o.forEach((function(t){"x"!==t&&"y"!==t&&(i[t]=r[t])})),i)}function yi(t){return t instanceof ai?t:t.oProj?t.oProj:ai(t)}var mi=function(t,e,r){t=yi(t);var n,i=!1;return void 0===e?(e=t,t=di,i=!0):(void 0!==e.x||Array.isArray(e))&&(r=e,e=t,t=di,i=!0),e=yi(e),r?gi(t,e,r):(n={forward:function(r){return gi(t,e,r)},inverse:function(r){return gi(e,t,r)}},i&&(n.oProj=e),n)},_i="AJSAJS",vi="AFAFAF",bi=65,wi=73,xi=79,Ei=86,Si=90,Ii={forward:Oi,inverse:function(t){var e=Ri(ki(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:Ci};function Oi(t,e){return e=e||5,function(t,e){var r="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(p=t.easting,d=t.northing,g=t.zoneNumber,y=Mi(g),m=Math.floor(p/1e5),_=Math.floor(d/1e5)%20,i=m,o=_,s=y,a=s-1,l=_i.charCodeAt(a),u=vi.charCodeAt(a),c=l+i-1,h=u+o,f=!1,c>Si&&(c=c-Si+bi-1,f=!0),(c===wi||l<wi&&c>wi||(c>wi||l<wi)&&f)&&c++,(c===xi||l<xi&&c>xi||(c>xi||l<xi)&&f)&&++c===wi&&c++,c>Si&&(c=c-Si+bi-1),h>Ei?(h=h-Ei+bi-1,f=!0):f=!1,(h===wi||u<wi&&h>wi||(h>wi||u<wi)&&f)&&h++,(h===xi||u<xi&&h>xi||(h>xi||u<xi)&&f)&&++h===wi&&h++,h>Ei&&(h=h-Ei+bi-1),String.fromCharCode(c)+String.fromCharCode(h))+r.substr(r.length-5,e)+n.substr(n.length-5,e);var i,o,s,a,l,u,c,h,f;var p,d,g,y,m,_}(function(t){var e,r,n,i,o,s,a,l,u=t.lat,c=t.lon,h=6378137,f=.00669438,p=.9996,d=Ti(u),g=Ti(c);l=Math.floor((c+180)/6)+1,180===c&&(l=60);u>=56&&u<64&&c>=3&&c<12&&(l=32);u>=72&&u<84&&(c>=0&&c<9?l=31:c>=9&&c<21?l=33:c>=21&&c<33?l=35:c>=33&&c<42&&(l=37));a=Ti(6*(l-1)-180+3),e=f/(1-f),r=h/Math.sqrt(1-f*Math.sin(d)*Math.sin(d)),n=Math.tan(d)*Math.tan(d),i=e*Math.cos(d)*Math.cos(d),o=Math.cos(d)*(g-a),s=h*((1-f/4-3*f*f/64-5*f*f*f/256)*d-(3*f/8+3*f*f/32+45*f*f*f/1024)*Math.sin(2*d)+(15*f*f/256+45*f*f*f/1024)*Math.sin(4*d)-35*f*f*f/3072*Math.sin(6*d));var y=p*r*(o+(1-n+i)*o*o*o/6+(5-18*n+n*n+72*i-58*e)*o*o*o*o*o/120)+5e5,m=p*(s+r*Math.tan(d)*(o*o/2+(5-n+9*i+4*i*i)*o*o*o*o/24+(61-58*n+n*n+600*i-330*e)*o*o*o*o*o*o/720));u<0&&(m+=1e7);return{northing:Math.round(m),easting:Math.round(y),zoneNumber:l,zoneLetter:Li(u)}}({lat:t[1],lon:t[0]}),e)}function Ci(t){var e=Ri(ki(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Ti(t){return t*(Math.PI/180)}function Pi(t){return t/Math.PI*180}function Ri(t){var e=t.northing,r=t.easting,n=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var o,s,a,l,u,c,h,f,p,d=.9996,g=6378137,y=.00669438,m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),_=r-5e5,v=e;n<"N"&&(v-=1e7),h=6*(i-1)-180+3,o=.006739496752268451,p=(f=v/d/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*f)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*f)+151*m*m*m/96*Math.sin(6*f),s=g/Math.sqrt(1-y*Math.sin(p)*Math.sin(p)),a=Math.tan(p)*Math.tan(p),l=o*Math.cos(p)*Math.cos(p),u=.99330562*g/Math.pow(1-y*Math.sin(p)*Math.sin(p),1.5),c=_/(s*d);var b=p-s*Math.tan(p)/u*(c*c/2-(5+3*a+10*l-4*l*l-9*o)*c*c*c*c/24+(61+90*a+298*l+45*a*a-1.6983531815716497-3*l*l)*c*c*c*c*c*c/720);b=Pi(b);var w,x=(c-(1+2*a+l)*c*c*c/6+(5-2*l+28*a-3*l*l+8*o+24*a*a)*c*c*c*c*c/120)/Math.cos(p);if(x=h+Pi(x),t.accuracy){var E=Ri({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});w={top:E.lat,right:E.lon,bottom:b,left:x}}else w={lat:b,lon:x};return w}function Li(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Mi(t){var e=t%6;return 0===e&&(e=6),e}function ki(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,r=t.length,n=null,i="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;i+=e,o++}var s=parseInt(i,10);if(0===o||o+3>r)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(o,o+=2);for(var l=Mi(s),u=function(t,e){var r=_i.charCodeAt(e-1),n=1e5,i=!1;for(;r!==t.charCodeAt(0);){if(++r===wi&&r++,r===xi&&r++,r>Si){if(i)throw"Bad character: "+t;r=bi,i=!0}n+=1e5}return n}(n.charAt(0),l),c=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var r=vi.charCodeAt(e-1),n=0,i=!1;for(;r!==t.charCodeAt(0);){if(++r===wi&&r++,r===xi&&r++,r>Ei){if(i)throw"Bad character: "+t;r=bi,i=!0}n+=1e5}return n}(n.charAt(1),l);c<Ni(a);)c+=2e6;var h=r-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var f,p,d,g=h/2,y=0,m=0;return g>0&&(f=1e5/Math.pow(10,g),p=t.substring(o,o+g),y=parseFloat(p)*f,d=t.substring(o+g),m=parseFloat(d)*f),{easting:y+u,northing:m+c,zoneLetter:a,zoneNumber:s,accuracy:f}}function Ni(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Ai(t,e,r){if(!(this instanceof Ai))return new Ai(t,e,r);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ai.fromMGRS=function(t){return new Ai(Ci(t))},Ai.prototype.toMGRS=function(t){return Oi([this.x,this.y],t)};var Fi=Ai,Di=r(27),ji=.046875,Gi=.01953125,zi=.01068115234375,Ui=function(t){var e=[];e[0]=1-t*(.25+t*(ji+t*(Gi+t*zi))),e[1]=t*(.75-t*(ji+t*(Gi+t*zi)));var r=t*t;return e[2]=r*(.46875-t*(.013020833333333334+.007120768229166667*t)),r*=t,e[3]=r*(.3645833333333333-.005696614583333333*t),e[4]=r*t*.3076171875,e},Bi=function(t,e,r,n){return r*=e,e*=e,n[0]*t-r*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))},Vi=function(t,e,r){for(var n=1/(1-e),i=t,o=20;o;--o){var s=Math.sin(i),a=1-e*s*s;if(i-=a=(Bi(i,s,Math.cos(i),r)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<mn)return i}return i};var qi={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Ui(this.es),this.ml0=Bi(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,r,n,i=t.x,o=t.y,s=Xn(i-this.long0),a=Math.sin(o),l=Math.cos(o);if(this.es){var u=l*s,c=Math.pow(u,2),h=this.ep2*Math.pow(l,2),f=Math.pow(h,2),p=Math.abs(l)>mn?Math.tan(o):0,d=Math.pow(p,2),g=Math.pow(d,2);e=1-this.es*Math.pow(a,2),u/=Math.sqrt(e);var y=Bi(o,a,l,this.en);r=this.a*(this.k0*u*(1+c/6*(1-d+h+c/20*(5-18*d+g+14*h-58*d*h+c/42*(61+179*g-g*d-479*d)))))+this.x0,n=this.a*(this.k0*(y-this.ml0+a*s*u/2*(1+c/12*(5-d+9*h+4*f+c/30*(61+g-58*d+270*h-330*d*h+c/56*(1385+543*g-g*d-3111*d))))))+this.y0}else{var m=l*Math.sin(s);if(Math.abs(Math.abs(m)-1)<mn)return 93;if(r=.5*this.a*this.k0*Math.log((1+m)/(1-m))+this.x0,n=l*Math.cos(s)/Math.sqrt(1-Math.pow(m,2)),(m=Math.abs(n))>=1){if(m-1>mn)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=r,t.y=n,t},inverse:function(t){var e,r,n,i,o=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,r=Vi(e,this.es,this.en),Math.abs(r)<yn){var a=Math.sin(r),l=Math.cos(r),u=Math.abs(l)>mn?Math.tan(r):0,c=this.ep2*Math.pow(l,2),h=Math.pow(c,2),f=Math.pow(u,2),p=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var d=o*Math.sqrt(e)/this.k0,g=Math.pow(d,2);n=r-(e*=u)*g/(1-this.es)*.5*(1-g/12*(5+3*f-9*c*f+c-4*h-g/30*(61+90*f-252*c*f+45*p+46*c-g/56*(1385+3633*f+4095*p+1574*p*f)))),i=Xn(this.long0+d*(1-g/6*(1+2*f+c-g/20*(5+28*f+24*p+8*c*f+6*c-g/42*(61+662*f+1320*p+720*p*f))))/l)}else n=yn*Wn(s),i=0;else{var y=Math.exp(o/this.k0),m=.5*(y-1/y),_=this.lat0+s/this.k0,v=Math.cos(_);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(m,2))),n=Math.asin(e),s<0&&(n=-n),i=0===m&&0===v?0:Xn(Math.atan2(m,v)+this.long0)}return t.x=i,t.y=n,t},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Yi=function(t){var e=Math.exp(t);return e=(e-1/e)/2},Wi=function(t,e){t=Math.abs(t),e=Math.abs(e);var r=Math.max(t,e),n=Math.min(t,e)/(r||1);return r*Math.sqrt(1+Math.pow(n,2))},Xi=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,r=e-1;return 0===r?t:t*Math.log(e)/r}(e*(1+e/(Wi(1,e)+1))),t<0?-e:e},Hi=function(t,e){for(var r,n=2*Math.cos(2*e),i=t.length-1,o=t[i],s=0;--i>=0;)r=n*o-s+t[i],s=o,o=r;return e+r*Math.sin(2*e)},Zi=function(t,e,r){for(var n,i,o=Math.sin(e),s=Math.cos(e),a=Yi(r),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(r),u=2*s*l,c=-2*o*a,h=t.length-1,f=t[h],p=0,d=0,g=0;--h>=0;)n=d,i=p,f=u*(d=f)-n-c*(p=g)+t[h],g=c*d-i+u*p;return[(u=o*l)*f-(c=s*a)*g,u*g+c*f]};var Ki={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),r=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),r*=e,this.cgb[1]=r*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=r*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),r*=e,this.cgb[2]=r*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=r*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),r*=e,this.cgb[3]=r*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=r*(1237/630+e*(e*(-24832/14175)-2.4)),r*=e,this.cgb[4]=r*(4174/315+e*(-144838/6237)),this.cbg[4]=r*(-734/315+e*(109598/31185)),r*=e,this.cgb[5]=r*(601676/22275),this.cbg[5]=r*(444337/155925),r=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+r*(1/4+r*(1/64+r/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=r*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=r*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),r*=e,this.utg[2]=r*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=r*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),r*=e,this.utg[3]=r*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=r*(49561/161280+e*(-179/168+e*(6601661/7257600))),r*=e,this.utg[4]=r*(-4583/161280+e*(108847/3991680)),this.gtu[4]=r*(34729/80640+e*(-3418889/1995840)),r*=e,this.utg[5]=r*(-20648693/638668800),this.gtu[5]=.6650675310896665*r;var n=Hi(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var r,n=2*Math.cos(e),i=t.length-1,o=t[i],s=0;--i>=0;)r=n*o-s+t[i],s=o,o=r;return Math.sin(e)*r}(this.gtu,2*n))},forward:function(t){var e=Xn(t.x-this.long0),r=t.y;r=Hi(this.cbg,r);var n=Math.sin(r),i=Math.cos(r),o=Math.sin(e),s=Math.cos(e);r=Math.atan2(n,s*i),e=Math.atan2(o*i,Wi(n,i*s)),e=Xi(Math.tan(e));var a,l,u=Zi(this.gtu,2*r,2*e);return r+=u[0],e+=u[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*r+this.Zb)+this.y0):(a=1/0,l=1/0),t.x=a,t.y=l,t},inverse:function(t){var e,r,n=(t.x-this.x0)*(1/this.a),i=(t.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var o=Zi(this.utg,2*i,2*n);i+=o[0],n+=o[1],n=Math.atan(Yi(n));var s=Math.sin(i),a=Math.cos(i),l=Math.sin(n),u=Math.cos(n);i=Math.atan2(s*u,Wi(l,u*a)),n=Math.atan2(l,u*a),e=Xn(n+this.long0),r=Hi(this.cgb,i)}else e=1/0,r=1/0;return t.x=e,t.y=r,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]};var $i={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Xn(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*_n,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Ki.init.apply(this),this.forward=Ki.forward,this.inverse=Ki.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Ji=function(t,e){return Math.pow((1-t)/(1+t),e)};var Qi={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+bn)/(Math.pow(Math.tan(.5*this.lat0+bn),this.C)*Ji(this.e*t,this.ratexp))},forward:function(t){var e=t.x,r=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+bn),this.C)*Ji(this.e*Math.sin(r),this.ratexp))-yn,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,r=t.y,n=Math.pow(Math.tan(.5*r+bn)/this.K,1/this.C),i=20;i>0&&(r=2*Math.atan(n*Ji(this.e*Math.sin(t.y),-.5*this.e))-yn,!(Math.abs(r-t.y)<1e-14));--i)t.y=r;return i?(t.x=e,t.y=r,t):null},names:["gauss"]};var to={init:function(){Qi.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,r,n,i;return t.x=Xn(t.x-this.long0),Qi.forward.apply(this,[t]),e=Math.sin(t.y),r=Math.cos(t.y),n=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*n),t.x=i*r*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*r*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,r,n,i,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),r=Math.cos(s),i=Math.asin(r*this.sinc0+t.y*e*this.cosc0/o),n=Math.atan2(t.x*e,o*this.cosc0*r-t.y*this.sinc0*e)}else i=this.phic0,n=0;return t.x=n,t.y=i,Qi.inverse.apply(this,[t]),t.x=Xn(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var eo={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=mn&&(this.k0=.5*(1+Wn(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=mn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=mn&&(this.k0=.5*this.cons*Yn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Hn(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Yn(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-yn,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,r,n,i,o,s,a=t.x,l=t.y,u=Math.sin(l),c=Math.cos(l),h=Xn(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=mn&&Math.abs(l+this.lat0)<=mn?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*u+this.coslat0*c*Math.cos(h)),t.x=this.a*e*c*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*u-this.sinlat0*c*Math.cos(h))+this.y0,t):(r=2*Math.atan(this.ssfn_(l,u,this.e))-yn,i=Math.cos(r),n=Math.sin(r),Math.abs(this.coslat0)<=mn?(o=Hn(this.e,l*this.con,this.con*u),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<mn?(e=2*this.a*this.k0/(1+i*Math.cos(h)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*i*Math.cos(h))),t.y=e*(this.cosX0*n-this.sinX0*i*Math.cos(h))+this.y0),t.x=e*i*Math.sin(h)+this.x0,t))},inverse:function(t){var e,r,n,i,o;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,r=this.lat0,s<=mn?(t.x=e,t.y=r,t):(r=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),e=Math.abs(this.coslat0)<mn?this.lat0>0?Xn(this.long0+Math.atan2(t.x,-1*t.y)):Xn(this.long0+Math.atan2(t.x,t.y)):Xn(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=r,t)}if(Math.abs(this.coslat0)<=mn){if(s<=mn)return r=this.lat0,e=this.long0,t.x=e,t.y=r,t;t.x*=this.con,t.y*=this.con,n=s*this.cons/(2*this.a*this.k0),r=this.con*Zn(this.e,n),e=this.con*Xn(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=mn?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/s),e=Xn(this.long0+Math.atan2(t.x*Math.sin(i),s*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),r=-1*Zn(this.e,Math.tan(.5*(yn+o)));return t.x=e,t.y=r,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,r){return e*=r,Math.tan(.5*(yn+t))*Math.pow((1-e)/(1+e),.5*r)}};var ro={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),r=this.a,n=1/this.rf,i=2*n-Math.pow(n,2),o=this.e=Math.sqrt(i);this.R=this.k0*r*Math.sqrt(1-i)/(1-i*Math.pow(e,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+o*e)/(1-o*e));this.K=s-this.alpha*a+this.alpha*o/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+r)+this.K,i=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,r=t.y-this.y0,n=e/this.R,i=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+s/this.alpha,l=0,u=o,c=-1e3,h=0;Math.abs(u-c)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),c=u,u=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=u,t},names:["somerc"]};var no={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),r=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-r*r);var n,i,o=Hn(this.e,this.lat0,t),s=this.bl/e*Math.sqrt((1-this.es)/(1-r*r));if(s*s<1&&(s=1),isNaN(this.longc)){var a=Hn(this.e,this.lat1,Math.sin(this.lat1)),l=Hn(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var u=Math.pow(a,this.bl),c=Math.pow(l,this.bl);i=.5*((n=this.el/u)-1/n);var h=(this.el*this.el-c*u)/(this.el*this.el+c*u),f=(c-u)/(c+u),p=Xn(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*p)/f)/this.bl,this.long0=Xn(this.long0);var d=Xn(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/i),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else n=this.lat0>=0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=n*Math.pow(o,this.bl),i=.5*(n-1/n),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},forward:function(t){var e,r,n,i=t.x,o=t.y,s=Xn(i-this.long0);if(Math.abs(Math.abs(o)-yn)<=mn)n=o>0?-1:1,r=this.al/this.bl*Math.log(Math.tan(bn+n*this.gamma0*.5)),e=-1*n*yn*this.al/this.bl;else{var a=Hn(this.e,o,Math.sin(o)),l=this.el/Math.pow(a,this.bl),u=.5*(l-1/l),c=.5*(l+1/l),h=Math.sin(this.bl*s),f=(u*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/c;r=Math.abs(Math.abs(f)-1)<=mn?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-f)/(1+f))/this.bl,e=Math.abs(Math.cos(this.bl*s))<=mn?this.al*this.bl*s:this.al*Math.atan2(u*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+r):(e-=this.uc,t.x=this.x0+r*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-r*Math.sin(this.alpha)),t},inverse:function(t){var e,r;this.no_rot?(r=t.y-this.y0,e=t.x-this.x0):(r=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var n=Math.exp(-1*this.bl*r/this.al),i=.5*(n-1/n),o=.5*(n+1/n),s=Math.sin(this.bl*e/this.al),a=(s*Math.cos(this.gamma0)+i*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<mn?(t.x=this.long0,t.y=yn):Math.abs(a+1)<mn?(t.x=this.long0,t.y=-1*yn):(t.y=Zn(this.e,l),t.x=Xn(this.long0-Math.atan2(i*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};var io={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<mn)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),r=Math.cos(this.lat1),n=Yn(this.e,e,r),i=Hn(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Yn(this.e,o,s),l=Hn(this.e,this.lat2,o),u=Hn(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>mn?this.ns=Math.log(n/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,r=t.y;Math.abs(2*Math.abs(r)-Math.PI)<=mn&&(r=Wn(r)*(yn-2e-10));var n,i,o=Math.abs(Math.abs(r)-yn);if(o>mn)n=Hn(this.e,r,Math.sin(r)),i=this.a*this.f0*Math.pow(n,this.ns);else{if((o=r*this.ns)<=0)return null;i=0}var s=this.ns*Xn(e-this.long0);return t.x=this.k0*(i*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-i*Math.cos(s))+this.y0,t},inverse:function(t){var e,r,n,i,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),r=1):(e=-Math.sqrt(s*s+a*a),r=-1);var l=0;if(0!==e&&(l=Math.atan2(r*s,r*a)),0!==e||this.ns>0){if(r=1/this.ns,n=Math.pow(e/(this.a*this.f0),r),-9999===(i=Zn(this.e,n)))return null}else i=-yn;return o=Xn(l/this.ns+this.long0),t.x=o,t.y=i,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};var oo={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,r,n,i,o,s,a,l=t.x,u=t.y,c=Xn(l-this.long0);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),n=-c*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n)),o=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(i)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,r,n,i,o,s,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),r=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(e)),t.x=this.long0-r/this.alfa,s=e,a=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(a=1),s=t.y,u+=1}while(0===a&&u<15);return u>=15?null:t},names:["Krovak","krovak"]},so=function(t,e,r,n,i){return t*i-e*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)},ao=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},lo=function(t){return.375*t*(1+.25*t*(1+.46875*t))},uo=function(t){return.05859375*t*t*(1+.75*t)},co=function(t){return t*t*t*(35/3072)},ho=function(t,e,r){var n=e*r;return t/Math.sqrt(1-n*n)},fo=function(t){return Math.abs(t)<yn?t:t-Wn(t)*Math.PI},po=function(t,e,r,n,i){var o,s;o=t/e;for(var a=0;a<15;a++)if(o+=s=(t-(e*o-r*Math.sin(2*o)+n*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*n*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(s)<=1e-10)return o;return NaN};var go={init:function(){this.sphere||(this.e0=ao(this.es),this.e1=lo(this.es),this.e2=uo(this.es),this.e3=co(this.es),this.ml0=this.a*so(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,r,n=t.x,i=t.y;if(n=Xn(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(n)),r=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0);else{var o=Math.sin(i),s=Math.cos(i),a=ho(this.a,this.e,o),l=Math.tan(i)*Math.tan(i),u=n*Math.cos(i),c=u*u,h=this.es*s*s/(1-this.es);e=a*u*(1-c*l*(1/6-(8-l+8*h)*c/120)),r=this.a*so(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+a*o/s*c*(.5+(5-l+6*h)*c/24)}return t.x=e+this.x0,t.y=r+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,r,n=t.x/this.a,i=t.y/this.a;if(this.sphere){var o=i+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(n)),r=Math.atan2(Math.tan(n),Math.cos(o))}else{var s=this.ml0/this.a+i,a=po(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-yn)<=mn)return t.x=this.long0,t.y=yn,i<0&&(t.y*=-1),t;var l=ho(this.a,this.e,Math.sin(a)),u=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(a),2),h=n*this.a/l,f=h*h;e=a-l*Math.tan(a)/u*h*h*(.5-(1+3*c)*h*h/24),r=h*(1-f*(c/3+(1+3*c)*c*f/15))/Math.cos(a)}return t.x=Xn(r+this.long0),t.y=fo(e),t},names:["Cassini","Cassini_Soldner","cass"]},yo=function(t,e){var r;return t>1e-7?(1-t*t)*(e/(1-(r=t*e)*r)-.5/t*Math.log((1-r)/(1+r))):2*e};var mo=.3333333333333333,_o=.17222222222222222,vo=.10257936507936508,bo=.06388888888888888,wo=.0664021164021164,xo=.016415012942191543;var Eo={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-yn)<mn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<mn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=yo(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,r=[];return r[0]=t*mo,e=t*t,r[0]+=e*_o,r[1]=e*bo,e*=t,r[0]+=e*vo,r[1]+=e*wo,r[2]=e*xo,r}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=yo(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,r,n,i,o,s,a,l,u,c,h=t.x,f=t.y;if(h=Xn(h-this.long0),this.sphere){if(o=Math.sin(f),c=Math.cos(f),n=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((r=this.mode===this.EQUIT?1+c*n:1+this.sinph0*o+this.cosph0*c*n)<=mn)return null;e=(r=Math.sqrt(2/r))*c*Math.sin(h),r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(f+this.phi0)<mn)return null;r=bn-.5*f,e=(r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r)))*Math.sin(h),r*=n}}else{switch(a=0,l=0,u=0,n=Math.cos(h),i=Math.sin(h),o=Math.sin(f),s=yo(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:u=1+this.sinb1*a+this.cosb1*l*n;break;case this.EQUIT:u=1+l*n;break;case this.N_POLE:u=yn+f,s=this.qp-s;break;case this.S_POLE:u=f-yn,s=this.qp+s}if(Math.abs(u)<mn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),r=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*a-this.sinb1*l*n):(u=Math.sqrt(2/(1+l*n)))*a*this.ymf,e=this.xmf*u*l*i;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(u=Math.sqrt(s))*i,r=n*(this.mode===this.S_POLE?u:-u)):e=r=0}}return t.x=this.a*e+this.x0,t.y=this.a*r+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,r,n,i,o,s,a,l,u,c,h=t.x/this.a,f=t.y/this.a;if(this.sphere){var p,d=0,g=0;if((r=.5*(p=Math.sqrt(h*h+f*f)))>1)return null;switch(r=2*Math.asin(r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(r),d=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(p)<=mn?0:Math.asin(f*g/p),h*=g,f=d*p;break;case this.OBLIQ:r=Math.abs(p)<=mn?this.phi0:Math.asin(d*this.sinph0+f*g*this.cosph0/p),h*=g*this.cosph0,f=(d-Math.sin(r)*this.sinph0)*p;break;case this.N_POLE:f=-f,r=yn-r;break;case this.S_POLE:r-=yn}e=0!==f||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(h,f):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h/=this.dd,f*=this.dd,(s=Math.sqrt(h*h+f*f))<mn)return t.x=0,t.y=this.phi0,t;i=2*Math.asin(.5*s/this.rq),n=Math.cos(i),h*=i=Math.sin(i),this.mode===this.OBLIQ?(a=n*this.sinb1+f*i*this.cosb1/s,o=this.qp*a,f=s*this.cosb1*n-f*this.sinb1*i):(a=f*i/s,o=this.qp*a,f=s*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),!(o=h*h+f*f))return t.x=0,t.y=this.phi0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(h,f),l=Math.asin(a),u=this.apa,c=l+l,r=l+u[0]*Math.sin(c)+u[1]*Math.sin(c+c)+u[2]*Math.sin(c+c+c)}return t.x=Xn(this.long0+e),t.y=r,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},So=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)};var Io={init:function(){Math.abs(this.lat1+this.lat2)<mn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Yn(this.e3,this.sin_po,this.cos_po),this.qs1=yo(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Yn(this.e3,this.sin_po,this.cos_po),this.qs2=yo(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=yo(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>mn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,r=t.y;this.sin_phi=Math.sin(r),this.cos_phi=Math.cos(r);var n=yo(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*Xn(e-this.long0),s=i*Math.sin(o)+this.x0,a=this.rh-i*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,r,n,i,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),i=0,0!==e&&(i=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-n*n)/(2*this.ns0)):(r=(this.c-n*n)/this.ns0,s=this.phi1z(this.e3,r)),o=Xn(i/this.ns0+this.long0),t.x=o,t.y=s,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var r,n,i,o,s=So(.5*e);if(t<mn)return s;for(var a=t*t,l=1;l<=25;l++)if(s+=o=.5*(i=1-(n=t*(r=Math.sin(s)))*n)*i/Math.cos(s)*(e/(1-a)-r/i+.5/t*Math.log((1-n)/(1+n))),Math.abs(o)<=1e-7)return s;return null}};var Oo={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,r,n,i,o,s,a,l=t.x,u=t.y;return n=Xn(l-this.long0),e=Math.sin(u),r=Math.cos(u),i=Math.cos(n),1,(o=this.sin_p14*e+this.cos_p14*r*i)>0||Math.abs(o)<=mn?(s=this.x0+1*this.a*r*Math.sin(n)/o,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*r*i)/o):(s=this.x0+this.infinity_dist*r*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*i)),t.x=s,t.y=a,t},inverse:function(t){var e,r,n,i,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),r=Math.sin(i),n=Math.cos(i),s=So(n*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.atan2(t.x*r,e*this.cos_p14*n-t.y*this.sin_p14*r),o=Xn(this.long0+o)):(s=this.phic0,o=0),t.x=o,t.y=s,t},names:["gnom"]};var Co={init:function(){this.sphere||(this.k0=Yn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,r,n=t.x,i=t.y,o=Xn(n-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var s=yo(this.e,Math.sin(i));e=this.x0+this.a*this.k0*o,r=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=r,t},inverse:function(t){var e,r;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Xn(this.long0+t.x/this.a/Math.cos(this.lat_ts)),r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(r=function(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6)return e<0?-1*yn:yn;for(var n,i,o,s,a=Math.asin(.5*e),l=0;l<30;l++)if(i=Math.sin(a),o=Math.cos(a),s=t*i,a+=n=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-i/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Xn(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=r,t},names:["cea"]};var To={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,r=t.y,n=Xn(e-this.long0),i=fo(r-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*i,t},inverse:function(t){var e=t.x,r=t.y;return t.x=Xn(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=fo(this.lat0+(r-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var Po={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ao(this.es),this.e1=lo(this.es),this.e2=uo(this.es),this.e3=co(this.es),this.ml0=this.a*so(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,r,n,i=t.x,o=t.y,s=Xn(i-this.long0);if(n=s*Math.sin(o),this.sphere)Math.abs(o)<=mn?(e=this.a*s,r=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(o),r=this.a*(fo(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=mn)e=this.a*s,r=-1*this.ml0;else{var a=ho(this.a,this.e,Math.sin(o))/Math.tan(o);e=a*Math.sin(n),r=this.a*so(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(n))}return t.x=e+this.x0,t.y=r+this.y0,t},inverse:function(t){var e,r,n,i,o,s,a,l,u;if(n=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=mn)e=Xn(n/this.a+this.long0),r=0;else{var c;for(s=this.lat0+i/this.a,a=n*n/this.a/this.a+s*s,l=s,o=20;o;--o)if(l+=u=-1*(s*(l*(c=Math.tan(l))+1)-l-.5*(l*l+a)*c)/((l-s)/c-1),Math.abs(u)<=mn){r=l;break}e=Xn(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(r))}else if(Math.abs(i+this.ml0)<=mn)r=0,e=Xn(this.long0+n/this.a);else{var h,f,p,d,g;for(s=(this.ml0+i)/this.a,a=n*n/this.a/this.a+s*s,l=s,o=20;o;--o)if(g=this.e*Math.sin(l),h=Math.sqrt(1-g*g)*Math.tan(l),f=this.a*so(this.e0,this.e1,this.e2,this.e3,l),p=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=u=(s*(h*(d=f/this.a)+1)-d-.5*h*(d*d+a))/(this.es*Math.sin(2*l)*(d*d+a-2*s*d)/(4*h)+(s-d)*(h*p-2/Math.sin(2*l))-p),Math.abs(u)<=mn){r=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r),e=Xn(this.long0+Math.asin(n*h/this.a)/Math.sin(r))}return t.x=e,t.y=r,t},names:["Polyconic","poly"]};var Ro={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,r=t.x,n=t.y-this.lat0,i=r-this.long0,o=n/gn*1e-5,s=i,a=1,l=0;for(e=1;e<=10;e++)a*=o,l+=this.A[e]*a;var u,c=l,h=s,f=1,p=0,d=0,g=0;for(e=1;e<=6;e++)u=p*c+f*h,f=f*c-p*h,p=u,d=d+this.B_re[e]*f-this.B_im[e]*p,g=g+this.B_im[e]*f+this.B_re[e]*p;return t.x=g*this.a+this.x0,t.y=d*this.a+this.y0,t},inverse:function(t){var e,r,n=t.x,i=t.y,o=n-this.x0,s=(i-this.y0)/this.a,a=o/this.a,l=1,u=0,c=0,h=0;for(e=1;e<=6;e++)r=u*s+l*a,l=l*s-u*a,u=r,c=c+this.C_re[e]*l-this.C_im[e]*u,h=h+this.C_im[e]*l+this.C_re[e]*u;for(var f=0;f<this.iterations;f++){var p,d=c,g=h,y=s,m=a;for(e=2;e<=6;e++)p=g*c+d*h,d=d*c-g*h,g=p,y+=(e-1)*(this.B_re[e]*d-this.B_im[e]*g),m+=(e-1)*(this.B_im[e]*d+this.B_re[e]*g);d=1,g=0;var _=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)p=g*c+d*h,d=d*c-g*h,g=p,_+=e*(this.B_re[e]*d-this.B_im[e]*g),v+=e*(this.B_im[e]*d+this.B_re[e]*g);var b=_*_+v*v;c=(y*_+m*v)/b,h=(m*_-y*v)/b}var w=c,x=h,E=1,S=0;for(e=1;e<=9;e++)E*=w,S+=this.D[e]*E;var I=this.lat0+S*gn*1e5,O=this.long0+x;return t.x=O,t.y=I,t},names:["New_Zealand_Map_Grid","nzmg"]};var Lo={init:function(){},forward:function(t){var e=t.x,r=t.y,n=Xn(e-this.long0),i=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;return t.x=i,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Xn(this.long0+t.x/this.a),r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=r,t},names:["Miller_Cylindrical","mill"]};var Mo={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Ui(this.es)},forward:function(t){var e,r,n=t.x,i=t.y;if(n=Xn(n-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),s=20;s;--s){var a=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<mn)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;e=this.a*this.C_x*n*(this.m+Math.cos(i)),r=this.a*this.C_y*i}else{var l=Math.sin(i),u=Math.cos(i);r=this.a*Bi(i,l,u,this.en),e=this.a*n*u/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=r,t},inverse:function(t){var e,r,n,i;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=So((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=So(Math.sin(e)/this.n)),n=Xn(n+this.long0),e=fo(e)):(e=Vi(t.y/this.a,this.es,this.en),(i=Math.abs(e))<yn?(i=Math.sin(e),r=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),n=Xn(r)):i-mn<yn&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]};var ko={init:function(){},forward:function(t){for(var e=t.x,r=t.y,n=Xn(e-this.long0),i=r,o=Math.PI*Math.sin(r);;){var s=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=s,Math.abs(s)<mn)break}i/=2,Math.PI/2-Math.abs(r)<mn&&(n=0);var a=.900316316158*this.a*n*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,r;t.x-=this.x0,t.y-=this.y0,r=t.y/(1.4142135623731*this.a),Math.abs(r)>.999999999999&&(r=.999999999999),e=Math.asin(r);var n=Xn(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),r=(2*e+Math.sin(2*e))/Math.PI,Math.abs(r)>1&&(r=1);var i=Math.asin(r);return t.x=n,t.y=i,t},names:["Mollweide","moll"]};var No={init:function(){Math.abs(this.lat1+this.lat2)<mn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ao(this.es),this.e1=lo(this.es),this.e2=uo(this.es),this.e3=co(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Yn(this.e,this.sinphi,this.cosphi),this.ml1=so(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<mn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Yn(this.e,this.sinphi,this.cosphi),this.ml2=so(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=so(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,r=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var i=so(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-i)}var o=this.ns*Xn(r-this.long0),s=this.x0+e*Math.sin(o),a=this.y0+this.rh-e*Math.cos(o);return t.x=s,t.y=a,t},inverse:function(t){var e,r,n,i;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(r=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(r=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==r&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=Xn(this.long0+o/this.ns),n=fo(this.g-r/this.a),t.x=i,t.y=n,t;var s=this.g-r/this.a;return n=po(s,this.e0,this.e1,this.e2,this.e3),i=Xn(this.long0+o/this.ns),t.x=i,t.y=n,t},names:["Equidistant_Conic","eqdc"]};var Ao={init:function(){this.R=this.a},forward:function(t){var e,r,n=t.x,i=t.y,o=Xn(n-this.long0);Math.abs(i)<=mn&&(e=this.x0+this.R*o,r=this.y0);var s=So(2*Math.abs(i/Math.PI));(Math.abs(o)<=mn||Math.abs(Math.abs(i)-yn)<=mn)&&(e=this.x0,r=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),l=a*a,u=Math.sin(s),c=Math.cos(s),h=c/(u+c-1),f=h*h,p=h*(2/u-1),d=p*p,g=Math.PI*this.R*(a*(h-d)+Math.sqrt(l*(h-d)*(h-d)-(d+l)*(f-d)))/(d+l);o<0&&(g=-g),e=this.x0+g;var y=l+h;return g=Math.PI*this.R*(p*y-a*Math.sqrt((d+l)*(l+1)-y*y))/(d+l),r=i>=0?this.y0+g:this.y0-g,t.x=e,t.y=r,t},inverse:function(t){var e,r,n,i,o,s,a,l,u,c,h,f;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,o=(n=t.x/h)*n+(i=t.y/h)*i,h=3*(i*i/(l=-2*(s=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(a=s-2*i*i+n*n)*a*a/l/l/l-9*s*a/l/l)/27)/(u=(s-a*a/3/l)/l)/(c=2*Math.sqrt(-u/3)),Math.abs(h)>1&&(h=h>=0?1:-1),f=Math.acos(h)/3,r=t.y>=0?(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:-(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(n)<mn?this.long0:Xn(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-i*i)+o*o))/2/n),t.x=e,t.y=r,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var Fo={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,x,E=t.x,S=t.y,I=Math.sin(t.y),O=Math.cos(t.y),C=Xn(E-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=mn?(t.x=this.x0+this.a*(yn-S)*Math.sin(C),t.y=this.y0-this.a*(yn-S)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=mn?(t.x=this.x0+this.a*(yn+S)*Math.sin(C),t.y=this.y0+this.a*(yn+S)*Math.cos(C),t):(_=this.sin_p12*I+this.cos_p12*O*Math.cos(C),m=(y=Math.acos(_))/Math.sin(y),t.x=this.x0+this.a*m*O*Math.sin(C),t.y=this.y0+this.a*m*(this.cos_p12*I-this.sin_p12*O*Math.cos(C)),t):(e=ao(this.es),r=lo(this.es),n=uo(this.es),i=co(this.es),Math.abs(this.sin_p12-1)<=mn?(o=this.a*so(e,r,n,i,yn),s=this.a*so(e,r,n,i,S),t.x=this.x0+(o-s)*Math.sin(C),t.y=this.y0-(o-s)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=mn?(o=this.a*so(e,r,n,i,yn),s=this.a*so(e,r,n,i,S),t.x=this.x0+(o+s)*Math.sin(C),t.y=this.y0+(o+s)*Math.cos(C),t):(a=I/O,l=ho(this.a,this.e,this.sin_p12),u=ho(this.a,this.e,I),c=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(u*O)),v=0===(h=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(C)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(h)-Math.PI)<=mn?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(C)*Math.cos(c)/Math.sin(h)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),y=l*v*(1-(b=v*v)*(g=(p=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*p)*(1-g)/6+(w=b*v)/8*(d=f*p)*(1-2*g)+(x=w*v)/120*(g*(4-7*g)-3*f*f*(1-7*g))-x*v/48*d),t.x=this.x0+y*Math.sin(h),t.y=this.y0+y*Math.cos(h),t))},inverse:function(t){var e,r,n,i,o,s,a,l,u,c,h,f,p,d,g,y,m,_,v,b,w,x;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*yn*this.a)return;return r=e/this.a,n=Math.sin(r),i=Math.cos(r),o=this.long0,Math.abs(e)<=mn?s=this.lat0:(s=So(i*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-yn,o=Math.abs(a)<=mn?this.lat0>=0?Xn(this.long0+Math.atan2(t.x,-t.y)):Xn(this.long0-Math.atan2(-t.x,t.y)):Xn(this.long0+Math.atan2(t.x*n,e*this.cos_p12*i-t.y*this.sin_p12*n))),t.x=o,t.y=s,t}return l=ao(this.es),u=lo(this.es),c=uo(this.es),h=co(this.es),Math.abs(this.sin_p12-1)<=mn?(f=this.a*so(l,u,c,h,yn),e=Math.sqrt(t.x*t.x+t.y*t.y),s=po((f-e)/this.a,l,u,c,h),o=Xn(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=s,t):Math.abs(this.sin_p12+1)<=mn?(f=this.a*so(l,u,c,h,yn),e=Math.sqrt(t.x*t.x+t.y*t.y),s=po((e-f)/this.a,l,u,c,h),o=Xn(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=s,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),p=ho(this.a,this.e,this.sin_p12),y=Math.cos(g),_=-(m=this.e*this.cos_p12*y)*m/(1-this.es),v=3*this.es*(1-_)*this.sin_p12*this.cos_p12*y/(1-this.es),x=1-_*(w=(b=e/p)-_*(1+_)*Math.pow(b,3)/6-v*(1+3*_)*Math.pow(b,4)/24)*w/2-b*w*w*w/6,d=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*y),o=Xn(this.long0+Math.asin(Math.sin(g)*Math.sin(w)/Math.cos(d))),s=Math.atan((1-this.es*x*this.sin_p12/Math.sin(d))*Math.tan(d)/(1-this.es)),t.x=o,t.y=s,t)},names:["Azimuthal_Equidistant","aeqd"]};var Do={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,r,n,i,o,s,a,l=t.x,u=t.y;return n=Xn(l-this.long0),e=Math.sin(u),r=Math.cos(u),i=Math.cos(n),1,((o=this.sin_p14*e+this.cos_p14*r*i)>0||Math.abs(o)<=mn)&&(s=1*this.a*r*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*r*i)),t.x=s,t.y=a,t},inverse:function(t){var e,r,n,i,o,s,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),r=So(e/this.a),n=Math.sin(r),i=Math.cos(r),s=this.long0,Math.abs(e)<=mn?(a=this.lat0,t.x=s,t.y=a,t):(a=So(i*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.abs(this.lat0)-yn,Math.abs(o)<=mn?(s=this.lat0>=0?Xn(this.long0+Math.atan2(t.x,-t.y)):Xn(this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=a,t):(s=Xn(this.long0+Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n)),t.x=s,t.y=a,t))},names:["ortho"]},jo=1,Go=2,zo=3,Uo=4,Bo=5,Vo=6,qo=1,Yo=2,Wo=3,Xo=4;function Ho(t,e,r,n){var i;return t<mn?(n.value=qo,i=0):(i=Math.atan2(e,r),Math.abs(i)<=bn?n.value=qo:i>bn&&i<=yn+bn?(n.value=Yo,i-=yn):i>yn+bn||i<=-(yn+bn)?(n.value=Wo,i=i>=0?i-xn:i+xn):(n.value=Xo,i+=yn)),i}function Zo(t,e){var r=t+e;return r<-xn?r+=wn:r>+xn&&(r-=wn),r}var Ko={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=yn-bn/2?this.face=Bo:this.lat0<=-(yn-bn/2)?this.face=Vo:Math.abs(this.long0)<=bn?this.face=jo:Math.abs(this.long0)<=yn+bn?this.face=this.long0>0?Go:Uo:this.face=zo,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,r,n,i,o,s,a={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,r=t.x,this.face===Bo)i=yn-e,r>=bn&&r<=yn+bn?(l.value=qo,n=r-yn):r>yn+bn||r<=-(yn+bn)?(l.value=Yo,n=r>0?r-xn:r+xn):r>-(yn+bn)&&r<=-bn?(l.value=Wo,n=r+yn):(l.value=Xo,n=r);else if(this.face===Vo)i=yn+e,r>=bn&&r<=yn+bn?(l.value=qo,n=-r+yn):r<bn&&r>=-bn?(l.value=Yo,n=-r):r<-bn&&r>=-(yn+bn)?(l.value=Wo,n=-r-yn):(l.value=Xo,n=r>0?-r+xn:-r-xn);else{var u,c,h,f,p,d;this.face===Go?r=Zo(r,+yn):this.face===zo?r=Zo(r,+xn):this.face===Uo&&(r=Zo(r,-yn)),f=Math.sin(e),p=Math.cos(e),d=Math.sin(r),u=p*Math.cos(r),c=p*d,h=f,this.face===jo?n=Ho(i=Math.acos(u),h,c,l):this.face===Go?n=Ho(i=Math.acos(c),h,-u,l):this.face===zo?n=Ho(i=Math.acos(-u),h,-c,l):this.face===Uo?n=Ho(i=Math.acos(-c),h,u,l):(i=n=0,l.value=qo)}return s=Math.atan(12/xn*(n+Math.acos(Math.sin(n)*Math.cos(bn))-yn)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(n))))),l.value===Yo?s+=yn:l.value===Wo?s+=xn:l.value===Xo&&(s+=1.5*xn),a.x=o*Math.cos(s),a.y=o*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,r,n,i,o,s,a,l,u,c,h,f,p={lam:0,phi:0},d={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?d.value=qo:t.y>=0&&t.y>=Math.abs(t.x)?(d.value=Yo,e-=yn):t.x<0&&-t.x>=Math.abs(t.y)?(d.value=Wo,e=e<0?e+xn:e-xn):(d.value=Xo,e+=yn),u=xn/12*Math.tan(e),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(n=Math.cos(e))*n*(i=Math.tan(r))*i*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),this.face===Bo)l=Math.acos(a),p.phi=yn-l,d.value===qo?p.lam=s+yn:d.value===Yo?p.lam=s<0?s+xn:s-xn:d.value===Wo?p.lam=s-yn:p.lam=s;else if(this.face===Vo)l=Math.acos(a),p.phi=l-yn,d.value===qo?p.lam=-s+yn:d.value===Yo?p.lam=-s:d.value===Wo?p.lam=-s-yn:p.lam=s<0?-s-xn:-s+xn;else{var g,y,m;u=(g=a)*g,y=(u+=(m=u>=1?0:Math.sqrt(1-u)*Math.sin(s))*m)>=1?0:Math.sqrt(1-u),d.value===Yo?(u=y,y=-m,m=u):d.value===Wo?(y=-y,m=-m):d.value===Xo&&(u=y,y=m,m=-u),this.face===Go?(u=g,g=-y,y=u):this.face===zo?(g=-g,y=-y):this.face===Uo&&(u=g,g=y,y=-u),p.phi=Math.acos(-m)-yn,p.lam=Math.atan2(y,g),this.face===Go?p.lam=Zo(p.lam,-yn):this.face===zo?p.lam=Zo(p.lam,-xn):this.face===Uo&&(p.lam=Zo(p.lam,+yn))}return 0!==this.es&&(c=p.phi<0?1:0,h=Math.tan(p.phi),f=this.b/Math.sqrt(h*h+this.one_minus_f_squared),p.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),c&&(p.phi=-p.phi)),p.lam+=this.long0,t.x=p.lam,t.y=p.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},$o=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Jo=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Qo=.8487,ts=1.3523,es=vn/5,rs=18,ns=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var is,os={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Xn(t.x-this.long0),r=Math.abs(t.y),n=Math.floor(r*es);n<0?n=0:n>=rs&&(n=17);var i={x:ns($o[n],r=vn*(r-.08726646259971647*n))*e,y:ns(Jo[n],r)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*Qo+this.x0,i.y=i.y*this.a*ts+this.y0,i},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*Qo),y:Math.abs(t.y-this.y0)/(this.a*ts)};if(e.y>=1)e.x/=$o[18][0],e.y=t.y<0?-yn:yn;else{var r=Math.floor(e.y*rs);for(r<0?r=0:r>=rs&&(r=17);;)if(Jo[r][0]>e.y)--r;else{if(!(Jo[r+1][0]<=e.y))break;++r}var n=Jo[r],i=5*(e.y-n[0])/(Jo[r+1][0]-n[0]);i=function(t,e,r,n){for(var i=e;n;--n){var o=t(i);if(i-=o,Math.abs(o)<r)break}return i}((function(t){return(ns(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),i,mn,100),e.x/=ns($o[r],i),e.y=(5*r+i)*_n,t.y<0&&(e.y=-e.y)}return e.x=Xn(e.x+this.long0),e},names:["Robinson","robin"]};mi.defaultDatum="WGS84",mi.Proj=ai,mi.WGS84=new mi.Proj("WGS84"),mi.Point=Fi,mi.toPoint=hi,mi.defs=zn,mi.transform=pi,mi.mgrs=Ii,mi.version=Di.a,(is=mi).Proj.projections.add(qi),is.Proj.projections.add(Ki),is.Proj.projections.add($i),is.Proj.projections.add(to),is.Proj.projections.add(eo),is.Proj.projections.add(ro),is.Proj.projections.add(no),is.Proj.projections.add(io),is.Proj.projections.add(oo),is.Proj.projections.add(go),is.Proj.projections.add(Eo),is.Proj.projections.add(Io),is.Proj.projections.add(Oo),is.Proj.projections.add(Co),is.Proj.projections.add(To),is.Proj.projections.add(Po),is.Proj.projections.add(Ro),is.Proj.projections.add(Lo),is.Proj.projections.add(Mo),is.Proj.projections.add(ko),is.Proj.projections.add(No),is.Proj.projections.add(Ao),is.Proj.projections.add(Fo),is.Proj.projections.add(Do),is.Proj.projections.add(Ko),is.Proj.projections.add(os);var ss=mi;function as(t){var e,r,n=Object.keys(t.defs),i=n.length;for(e=0;e<i;++e){var o=n[e];if(!ye(o)){var s=t.defs(o),a=s.units;a||"longlat"!==s.projName||(a=d.DEGREES),ge(new g({code:o,axisOrientation:s.axis,metersPerUnit:s.to_meter,units:a}))}}for(e=0;e<i;++e){var l=n[e],u=ye(l);for(r=0;r<i;++r){var c=n[r],h=ye(c);if(!Z(l,c))if(t.defs[l]===t.defs[c])_e([u,h]);else{var f=t(l,c);we(u,h,je(u,h,f.forward),je(h,u,f.inverse))}}}}var ls=function(t){var e=t;Array.isArray(e)||(e=[e]),e.forEach((function(t){t.codes.forEach((function(e){ss.defs(e,t.def)})),_e(t.codes.map((function(e){return new g({code:e,extent:t.extent,worldExtent:t.worldExtent,units:t.units,metersPerUnit:t.metersPerUnit,axisOrientation:t.axisOrientation,global:t.global})})))}))};ls([{def:"+proj=utm +zone=30 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",extent:[-729785.83,3715125.82,940929.67,9518470.69],codes:["EPSG:25830","EPSG:3042","urn:ogc:def:crs:EPSG::25830","urn:ogc:def:crs:EPSG::3042","http://www.opengis.net/gml/srs/epsg.xml#25830","http://www.opengis.net/gml/srs/epsg.xml#3042"],units:"m",metersPerUnit:1},{def:"+proj=utm +zone=30 +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs",extent:[-99844.71,3879626.63,1682737.72,8251830.8],codes:["EPSG:23030","urn:ogc:def:crs:EPSG::23030","http://www.opengis.net/gml/srs/epsg.xml#23030"],units:"m"},{def:"+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs",extent:[-16.1,32.88,39.65,84.17],codes:["EPSG:4258","urn:ogc:def:crs:EPSG::4258","http://www.opengis.net/gml/srs/epsg.xml#4258"],units:"d",metersPerUnit:111319.49079327358},{def:"+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",extent:[-164850.78,3660417.01,988728.57,9567111.85],codes:["EPSG:25829","urn:ogc:def:crs:EPSG::25829","http://www.opengis.net/gml/srs/epsg.xml#25829"],units:"m"},{def:"+proj=utm +zone=29 +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs",extent:[448933.91,3860083.93,1860436.11,8381369.16],codes:["EPSG:23029","urn:ogc:def:crs:EPSG::23029","http://www.opengis.net/gml/srs/epsg.xml#23029"],units:"m"},{def:"+proj=longlat +ellps=intl +no_defs",extent:[-16.09882145355955,25.711114310330917,48.60999527749605,84.16977336415472],codes:["EPSG:4230","urn:ogc:def:crs:EPSG::4230","http://www.opengis.net/gml/srs/epsg.xml#4230"],units:"d",metersPerUnit:111319.49079327358},{def:"+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs",extent:[166021.44317933178,0,833978.5568206678,9329005.18301614],codes:["EPSG:32628","urn:ogc:def:crs:EPSG::32628","http://www.opengis.net/gml/srs/epsg.xml#32628"],units:"m"},{def:"+proj=longlat +datum=WGS84 +no_defs",extent:[-180,-90,180,90],codes:["EPSG:4326","urn:ogc:def:crs:EPSG::4326","urn:ogc:def:crs:OGC:1.3:CRS84","http://www.opengis.net/def/crs/OGC/1.3/CRS84"],units:"d",metersPerUnit:111319.49079327358,axisOrientation:"neu"},{def:"+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",extent:[397101.09,3638520.14,1034670.43,9625438.82],codes:["EPSG:25828","urn:ogc:def:crs:EPSG::25828","http://www.opengis.net/gml/srs/epsg.xml#25828"],units:"m"},{def:"+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",extent:[-1300111.74,3804640.43,893164.13,9478718.31],codes:["EPSG:25831","urn:ogc:def:crs:EPSG::25831","http://www.opengis.net/gml/srs/epsg.xml#25831"],units:"m"},{def:"+proj=utm +zone=28 +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs",extent:[997517.95,3873475.61,2024693.05,8529441.99],codes:["EPSG:23028","urn:ogc:def:crs:EPSG::23028","http://www.opengis.net/gml/srs/epsg.xml#23028"],units:"m"},{def:"+proj=utm +zone=31 +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs",extent:[-650883.16,3932764.97,1493695.91,8141744.84],codes:["EPSG:23031","urn:ogc:def:crs:EPSG::23031","http://www.opengis.net/gml/srs/epsg.xml#23031"],units:"m"},{def:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",extent:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],worldExtent:[-180,-85,180,85],codes:["EPSG:3857","EPSG:102100","EPSG:102113","EPSG:900913","urn:ogc:def:crs:EPSG:6.18:3:3857","urn:ogc:def:crs:EPSG::3857","http://www.opengis.net/gml/srs/epsg.xml#3857"],units:"m",metersPerUnit:1,global:!0},{def:"+proj=longlat +datum=WGS84 +no_defs",extent:[-180,-90,180,90],codes:["CRS:84"],units:"d",metersPerUnit:111319.49079327358,axisOrientation:"enu"}]),as(ss);var us=ls,cs=r(32),hs=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function fs(){return!0}function ps(){return!1}function ds(){}var gs,ys="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",ms=-1!==ys.indexOf("firefox"),_s=(-1!==ys.indexOf("safari")&&ys.indexOf("chrom"),-1!==ys.indexOf("webkit")&&-1==ys.indexOf("edge")),vs=-1!==ys.indexOf("macintosh"),bs="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,ws="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,xs="undefined"!=typeof Image&&Image.prototype.decode,Es=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}(),Ss=new Array(6);function Is(t){return Cs(t,1,0,0,1,0,0)}function Os(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],f=e[4],p=e[5];return t[0]=r*l+i*u,t[1]=n*l+o*u,t[2]=r*c+i*h,t[3]=n*c+o*h,t[4]=r*f+i*p+s,t[5]=n*f+o*p+a,t}function Cs(t,e,r,n,i,o,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=s,t}function Ts(t,e){var r=e[0],n=e[1];return e[0]=t[0]*r+t[2]*n+t[4],e[1]=t[1]*r+t[3]*n+t[5],e}function Ps(t,e,r){return Os(t,Cs(Ss,e,0,0,r,0,0))}function Rs(t,e,r,n,i,o,s,a){var l=Math.sin(o),u=Math.cos(o);return t[0]=n*u,t[1]=i*l,t[2]=-n*l,t[3]=i*u,t[4]=s*n*u-a*n*l+e,t[5]=s*i*l+a*i*u+r,t}function Ls(t,e){var r,n=(r=e)[0]*r[3]-r[1]*r[2];ut(0!==n,32);var i=e[0],o=e[1],s=e[2],a=e[3],l=e[4],u=e[5];return t[0]=a/n,t[1]=-o/n,t[2]=-s/n,t[3]=i/n,t[4]=(s*u-a*l)/n,t[5]=-(i*u-o*l)/n,t}function Ms(t){var e="matrix("+t.join(", ")+")";if(ws)return e;var r=gs||(gs=document.createElement("div"));return r.style.transform=e,r.style.transform}var ks=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Ns=/^([a-z]*)$|^hsla?\(.*\)$/i;function As(t){return"string"==typeof t?t:Bs(t)}function Fs(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var r=getComputedStyle(e).color;return document.body.removeChild(e),r}return""}var Ds,js,Gs=(Ds={},js=0,function(t){var e;if(Ds.hasOwnProperty(t))e=Ds[t];else{if(js>=1024){var r=0;for(var n in Ds)0==(3&r++)&&(delete Ds[n],--js)}e=function(t){var e,r,n,i,o;if(Ns.exec(t)&&(t=Fs(t)),ks.exec(t)){var s=t.length-1,a=void 0;a=s<=4?1:2;var l=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),r=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),i=l?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,r=(r<<4)+r,n=(n<<4)+n,l&&(i=(i<<4)+i)),o=[e,r,n,i/255]}else 0==t.indexOf("rgba(")?Us(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),Us(o)):ut(!1,14);return o}(t),Ds[t]=e,++js}return e});function zs(t){return Array.isArray(t)?t:Gs(t)}function Us(t){return t[0]=y(t[0]+.5|0,0,255),t[1]=y(t[1]+.5|0,0,255),t[2]=y(t[2]+.5|0,0,255),t[3]=y(t[3],0,1),t}function Bs(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var r=t[1];r!=(0|r)&&(r=r+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+r+","+n+","+(void 0===t[3]?1:t[3])+")"}var Vs=function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var r=this.cache_[e];0!=(3&t++)||r.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,r){var n=qs(t,e,r);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,r,n){var i=qs(t,e,r);this.cache_[i]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}();function qs(t,e,r){return e+":"+t+":"+(r?As(r):"null")}var Ys=new Vs;function Ws(t){t.stopPropagation()}var Xs=function(){function t(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.defaultPrevented=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),Hs="propertychange",Zs=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ks=function(t){function e(e){var r=t.call(this)||this;return r.eventTarget_=e,r.pendingRemovals_=null,r.dispatching_=null,r.listeners_=null,r}return Zs(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var r=this.listeners_||(this.listeners_={}),n=r[t]||(r[t]=[]);-1===n.indexOf(e)&&n.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Xs(t):t,r=e.type;e.target||(e.target=this.eventTarget_||this);var n,i=this.listeners_&&this.listeners_[r];if(i){var o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,s[r]=0),++o[r];for(var a=0,l=i.length;a<l;++a)if(!1===(n="handleEvent"in i[a]?i[a].handleEvent(e):i[a].call(this,e))||e.propagationStopped){n=!1;break}if(--o[r],0===o[r]){var u=s[r];for(delete s[r];u--;)this.removeEventListener(r,ds);delete o[r]}return n}},e.prototype.disposeInternal=function(){this.listeners_&&q(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)},e.prototype.removeEventListener=function(t,e){var r=this.listeners_&&this.listeners_[t];if(r){var n=r.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(r[n]=ds,++this.pendingRemovals_[t]):(r.splice(n,1),0===r.length&&delete this.listeners_[t]))}},e}(hs),$s="change",Js="error",Qs="clear",ta="contextmenu",ea="click",ra="dblclick",na="dragenter",ia="dragover",oa="drop",sa="keydown",aa="keypress",la="load",ua="resize",ca="touchmove",ha="wheel";function fa(t,e,r,n,i){if(n&&n!==t&&(r=r.bind(n)),i){var o=r;r=function(){t.removeEventListener(e,r),o.apply(this,arguments)}}var s={target:t,type:e,listener:r};return t.addEventListener(e,r),s}function pa(t,e,r,n){return fa(t,e,r,n,!0)}function da(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),q(t))}var ga=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ya=function(t){function e(){var e=t.call(this)||this;return e.on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e}return ga(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent($s)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),i=0;i<r;++i)n[i]=fa(this,t[i],e);return n}return fa(this,t,e)},e.prototype.onceInternal=function(t,e){var r;if(Array.isArray(t)){var n=t.length;r=new Array(n);for(var i=0;i<n;++i)r[i]=pa(this,t[i],e)}else r=pa(this,t,e);return e.ol_key=r,r},e.prototype.unInternal=function(t,e){var r=e.ol_key;if(r)ma(r);else if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)},e}(Ks);function ma(t){if(Array.isArray(t))for(var e=0,r=t.length;e<r;++e)da(t[e]);else da(t)}ya.prototype.on,ya.prototype.once,ya.prototype.un;var _a=ya,va=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ba=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.key=r,i.oldValue=n,i}return va(e,t),e}(Xs),wa=function(t){function e(e){var r=t.call(this)||this;return r.on,r.once,r.un,Object(st.c)(r),r.values_=null,void 0!==e&&r.setProperties(e),r}return va(e,t),e.prototype.get=function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&V({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,e){var r;r="change:"+t,this.dispatchEvent(new ba(r,t,e)),r=Hs,this.dispatchEvent(new ba(r,t,e))},e.prototype.addChangeListener=function(t,e){this.addEventListener("change:"+t,e)},e.prototype.removeChangeListener=function(t,e){this.removeEventListener("change:"+t,e)},e.prototype.set=function(t,e,r){var n=this.values_||(this.values_={});if(r)n[t]=e;else{var i=n[t];n[t]=e,i!==e&&this.notify(t,i)}},e.prototype.setProperties=function(t,e){for(var r in t)this.set(r,t[r],e)},e.prototype.applyProperties=function(t){t.values_&&V(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,e){if(this.values_&&t in this.values_){var r=this.values_[t];delete this.values_[t],W(this.values_)&&(this.values_=null),e||this.notify(t,r)}},e}(_a),xa="opacity",Ea="visible",Sa="extent",Ia="zIndex",Oa="maxResolution",Ca="minResolution",Ta="maxZoom",Pa="minZoom",Ra="source";function La(t){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Ma=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ka=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n=V({},e);return"object"===La(e.properties)&&(delete n.properties,V(n,e.properties)),n[xa]=void 0!==e.opacity?e.opacity:1,ut("number"==typeof n[xa],64),n[Ea]=void 0===e.visible||e.visible,n[Ia]=e.zIndex,n[Oa]=void 0!==e.maxResolution?e.maxResolution:1/0,n[Ca]=void 0!==e.minResolution?e.minResolution:0,n[Pa]=void 0!==e.minZoom?e.minZoom:-1/0,n[Ta]=void 0!==e.maxZoom?e.maxZoom:1/0,r.className_=void 0!==n.className?e.className:"ol-layer",delete n.className,r.setProperties(n),r.state_=null,r}return Ma(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},r=this.getZIndex();return e.opacity=y(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==r||e.managed?r:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return Object(st.b)()},e.prototype.getLayerStatesArray=function(t){return Object(st.b)()},e.prototype.getExtent=function(){return this.get(Sa)},e.prototype.getMaxResolution=function(){return this.get(Oa)},e.prototype.getMinResolution=function(){return this.get(Ca)},e.prototype.getMinZoom=function(){return this.get(Pa)},e.prototype.getMaxZoom=function(){return this.get(Ta)},e.prototype.getOpacity=function(){return this.get(xa)},e.prototype.getSourceState=function(){return Object(st.b)()},e.prototype.getVisible=function(){return this.get(Ea)},e.prototype.getZIndex=function(){return this.get(Ia)},e.prototype.setExtent=function(t){this.set(Sa,t)},e.prototype.setMaxResolution=function(t){this.set(Oa,t)},e.prototype.setMinResolution=function(t){this.set(Ca,t)},e.prototype.setMaxZoom=function(t){this.set(Ta,t)},e.prototype.setMinZoom=function(t){this.set(Pa,t)},e.prototype.setOpacity=function(t){ut("number"==typeof t,64),this.set(xa,t)},e.prototype.setVisible=function(t){this.set(Ea,t)},e.prototype.setZIndex=function(t){this.set(Ia,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(wa),Na="prerender",Aa="postrender",Fa="precompose",Da="postcompose",ja="rendercomplete",Ga="undefined",za="loading",Ua="ready",Ba="error",Va=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function qa(t,e){if(!t.visible)return!1;var r=e.resolution;if(r<t.minResolution||r>t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var Ya=function(t){function e(e){var r=this,n=V({},e);delete n.source,(r=t.call(this,n)||this).on,r.once,r.un,r.mapPrecomposeKey_=null,r.mapRenderKey_=null,r.sourceChangeKey_=null,r.renderer_=null,e.render&&(r.render=e.render),e.map&&r.setMap(e.map),r.addChangeListener(Ra,r.handleSourcePropertyChange_);var i=e.source?e.source:null;return r.setSource(i),r}return Va(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Ra)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Ga},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(da(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=fa(t,$s,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise((function(t){return t([])}))},e.prototype.render=function(t,e){var r=this.getRenderer();if(r.prepareFrame(t))return r.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(da(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(da(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=fa(t,Fa,(function(t){var e=t.frameState.layerStatesArray,r=this.getLayerState(!1);ut(!e.some((function(t){return t.layer===r.layer})),67),e.push(r)}),this),this.mapRenderKey_=fa(this,$s,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Ra,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),t.prototype.disposeInternal.call(this)},e}(ka),Wa=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Xa(t,e){Ys.expire()}var Ha=function(t){function e(e){var r=t.call(this)||this;return r.map_=e,r}return Wa(e,t),e.prototype.dispatchRenderEvent=function(t,e){Object(st.b)()},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,r=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Rs(r,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Ls(n,r)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i,o,s,a){var l,u=e.viewState;function c(t,e,r,n){return i.call(o,e,t?r:null,n)}var h=u.projection,f=he(t.slice(),h),p=[[0,0]];if(h.canWrapX()&&n){var d=Gt(h.getExtent());p.push([-d,0],[d,0])}for(var g=e.layerStatesArray,y=g.length,m=[],_=[],v=0;v<p.length;v++)for(var b=y-1;b>=0;--b){var w=g[b],x=w.layer;if(x.hasRenderer()&&qa(w,u)&&s.call(a,x)){var E=x.getRenderer(),S=x.getSource();if(E&&S){var I=S.getWrapX()?f:t,O=c.bind(null,w.managed);_[0]=I[0]+p[v][0],_[1]=I[1]+p[v][1],l=E.forEachFeatureAtCoordinate(_,e,r,O,m)}if(l)return l}}if(0!==m.length){var C=1/m.length;return m.forEach((function(t,e){return t.distanceSq+=e*C})),m.sort((function(t,e){return t.distanceSq-e.distanceSq})),m.some((function(t){return l=t.callback(t.feature,t.layer,t.geometry)})),l}},e.prototype.forEachLayerAtPixel=function(t,e,r,n,i){return Object(st.b)()},e.prototype.hasFeatureAtCoordinate=function(t,e,r,n,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,r,n,fs,this,i,o)},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){Object(st.b)()},e.prototype.scheduleExpireIconCache=function(t){Ys.canExpireCache()&&t.postRenderFunctions.push(Xa)},e}(hs),Za=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ka=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.inversePixelTransform=r,o.frameState=n,o.context=i,o}return Za(e,t),e}(Xs),$a="ol-hidden",Ja="ol-unselectable",Qa="ol-control",tl="ol-collapsed",el=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),rl=["style","variant","weight","size","lineHeight","family"],nl=function(t){var e=t.match(el);if(!e)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,i=rl.length;n<i;++n){var o=e[n+1];void 0!==o&&(r[rl[n]]=o)}return r.families=r.family.split(/,\s?/),r};function il(t){return 1===t?"":String(Math.round(100*t)/100)}function ol(t,e,r,n){var i;return r&&r.length?i=r.shift():ws?i=new OffscreenCanvas(t||300,e||300):(i=document.createElement("canvas")).style.all="unset",t&&(i.width=t),e&&(i.height=e),i.getContext("2d",n)}function sl(t){var e=t.offsetWidth,r=getComputedStyle(t);return e+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function al(t){var e=t.offsetHeight,r=getComputedStyle(t);return e+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function ll(t,e){var r=e.parentNode;r&&r.replaceChild(t,e)}function ul(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function cl(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var hl="10px sans-serif",fl="#000",pl="round",dl=[],gl="round",yl="#000",ml="center",_l="middle",vl=[0,0,0,0],bl=new wa,wl=new Ks;wl.setSize=function(){console.warn("labelCache is deprecated.")};var xl,El,Sl=null,Il={},Ol=function(){var t,e,r="32px ",n=["monospace","serif"],i=n.length,o="wmytzilWMYTZIL@#/&?$%10";function s(t,s,a){for(var l=!0,u=0;u<i;++u){var c=n[u];if(e=Pl(t+" "+s+" "+r+c,o),a!=c){var h=Pl(t+" "+s+" "+r+a+","+c,o);l=l&&h!=e}}return!!l}function a(){for(var e=!0,r=bl.getKeys(),n=0,i=r.length;n<i;++n){var o=r[n];bl.get(o)<100&&(s.apply(this,o.split("\n"))?(q(Il),Sl=null,xl=void 0,bl.set(o,100)):(bl.set(o,bl.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var r=nl(e);if(r)for(var n=r.families,i=0,o=n.length;i<o;++i){var l=n[i],u=r.style+"\n"+r.weight+"\n"+l;void 0===bl.get(u)&&(bl.set(u,100,!0),s(r.style,r.weight,l)||(bl.set(u,0,!0),void 0===t&&(t=setInterval(a,32))))}}}(),Cl=function(t){var e=Il[t];if(null==e){if(ws){var r=nl(t),n=Tl(t,"Žg");e=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else El||((El=document.createElement("div")).innerHTML="M",El.style.minHeight="0",El.style.maxHeight="none",El.style.height="auto",El.style.padding="0",El.style.border="none",El.style.position="absolute",El.style.display="block",El.style.left="-99999px"),El.style.font=t,document.body.appendChild(El),e=El.offsetHeight,document.body.removeChild(El);Il[t]=e}return e};function Tl(t,e){return Sl||(Sl=ol(1,1)),t!=xl&&(Sl.font=t,xl=Sl.font),Sl.measureText(e)}function Pl(t,e){return Tl(t,e).width}function Rl(t,e,r){if(e in r)return r[e];var n=Pl(t,e);return r[e]=n,n}function Ll(t,e,r,n,i,o,s,a,l,u,c){t.save(),1!==r&&(t.globalAlpha*=r),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(l,u),t.scale(c[0],c[1]),function(t,e){for(var r=t.contextInstructions,n=0,i=r.length;n<i;n+=2)Array.isArray(r[n+1])?e[r[n]].apply(e,r[n+1]):e[r[n]]=r[n+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(l,u),t.scale(c[0],c[1]),t.drawImage(n,i,o,s,a,0,0,s,a)):t.drawImage(n,i,o,s,a,l,u,s*c[0],a*c[1]),t.restore()}var Ml=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kl=function(t){function e(e){var r=t.call(this,e)||this;r.fontChangeListenerKey_=fa(bl,Hs,e.redrawText.bind(e)),r.element_=document.createElement("div");var n=r.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",r.element_.className="ol-unselectable ol-layers";var i=e.getViewport();return i.insertBefore(r.element_,i.firstChild||null),r.children_=[],r.renderedVisible_=!0,r}return Ml(e,t),e.prototype.dispatchRenderEvent=function(t,e){var r=this.getMap();if(r.hasListener(t)){var n=new Ka(t,void 0,e);r.dispatchEvent(n)}},e.prototype.disposeInternal=function(){da(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),t.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(Fa,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),r=t.viewState;this.children_.length=0;for(var n=[],i=null,o=0,s=e.length;o<s;++o){var a=e[o];if(t.layerIndex=o,qa(a,r)&&(a.sourceState==Ua||a.sourceState==Ga)){var l=a.layer,u=l.render(t,i);u&&(u!==i&&(this.children_.push(u),i=u),"getDeclutter"in l&&n.push(l))}}for(o=n.length-1;o>=0;--o)n[o].renderDeclutter(t);!function(t,e){for(var r=t.childNodes,n=0;;++n){var i=r[n],o=e[n];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--n):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(Da,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,r,n,i){for(var o=e.viewState,s=e.layerStatesArray,a=s.length-1;a>=0;--a){var l=s[a],u=l.layer;if(u.hasRenderer()&&qa(l,o)&&i(u)){var c=u.getRenderer().getDataAtPixel(t,e,r);if(c){var h=n(u,c);if(h)return h}}}},e}(Ha),Nl="add",Al="remove",Fl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dl="length",jl=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.element=r,i.index=n,i}return Fl(e,t),e}(Xs),Gl=function(t){function e(e,r){var n=t.call(this)||this;n.on,n.once,n.un;var i=r||{};if(n.unique_=!!i.unique,n.array_=e||[],n.unique_)for(var o=0,s=n.array_.length;o<s;++o)n.assertUnique_(n.array_[o],o);return n.updateLength_(),n}return Fl(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,r=t.length;e<r;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)t(e[r],r,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Dl)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new jl(Nl,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)if(e[r]===t)return this.removeAt(r)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new jl(Al,e,t)),e},e.prototype.setAt=function(t,e){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new jl(Al,n,t)),this.dispatchEvent(new jl(Nl,e,t))}else{for(var i=r;i<t;++i)this.insertAt(i,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Dl,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===t&&r!==e)throw new lt(58)},e}(wa),zl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ul="layers",Bl=function(t){function e(e){var r=this,n=e||{},i=V({},n);delete i.layers;var o=n.layers;return(r=t.call(this,i)||this).on,r.once,r.un,r.layersListenerKeys_=[],r.listenerKeys_={},r.addChangeListener(Ul,r.handleLayersChanged_),o?Array.isArray(o)?o=new Gl(o.slice(),{unique:!0}):ut("function"==typeof o.getArray,43):o=new Gl(void 0,{unique:!0}),r.setLayers(o),r}return zl(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(da),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(fa(t,Nl,this.handleLayersAdd_,this),fa(t,Al,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(da);q(this.listenerKeys_);for(var r=t.getArray(),n=0,i=r.length;n<i;n++){var o=r[n];this.listenerKeys_[Object(st.c)(o)]=[fa(o,Hs,this.handleLayerChange_,this),fa(o,$s,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[Object(st.c)(e)]=[fa(e,Hs,this.handleLayerChange_,this),fa(e,$s,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=t.element,r=Object(st.c)(e);this.listenerKeys_[r].forEach(da),delete this.listenerKeys_[r],this.changed()},e.prototype.getLayers=function(){return this.get(Ul)},e.prototype.setLayers=function(t){this.set(Ul,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],r=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var n=this.getLayerState(),i=n.zIndex;t||void 0!==n.zIndex||(i=0);for(var o=r,s=e.length;o<s;o++){var a=e[o];a.opacity*=n.opacity,a.visible=a.visible&&n.visible,a.maxResolution=Math.min(a.maxResolution,n.maxResolution),a.minResolution=Math.max(a.minResolution,n.minResolution),a.minZoom=Math.max(a.minZoom,n.minZoom),a.maxZoom=Math.min(a.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==a.extent?a.extent=Ft(a.extent,n.extent):a.extent=n.extent),void 0===a.zIndex&&(a.zIndex=i)}return e},e.prototype.getSourceState=function(){return Ua},e}(ka),Vl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ql=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.map=r,i.frameState=void 0!==n?n:null,i}return Vl(e,t),e}(Xs),Yl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wl=function(t){function e(e,r,n,i,o){var s=t.call(this,e,r,o)||this;return s.originalEvent=n,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==i&&i,s}return Yl(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(ql),Xl={SINGLECLICK:"singleclick",CLICK:ea,DBLCLICK:ra,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Hl="pointermove",Zl="pointerdown",Kl="pointerup",$l="pointerout",Jl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ql=function(t){function e(e,r){var n=t.call(this,e)||this;n.map_=e,n.clickTimeoutId_,n.emulateClicks_=!1,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=void 0===r?1:r,n.down_=null;var i=n.map_.getViewport();return n.activePointers_=0,n.trackedTouches_={},n.element_=i,n.pointerdownListenerKey_=fa(i,Zl,n.handlePointerDown_,n),n.originalPointerMoveEvent_,n.relayedListenerKey_=fa(i,Hl,n.relayEvent_,n),n.boundHandleTouchMove_=n.handleTouchMove_.bind(n),n.element_.addEventListener(ca,n.boundHandleTouchMove_,!!Es&&{passive:!1}),n}return Jl(e,t),e.prototype.emulateClick_=function(t){var e=new Wl(Xl.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Wl(Xl.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Wl(Xl.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Xl.POINTERUP||e.type==Xl.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Xl.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Wl(Xl.POINTERUP,this.map_,t);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(da),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=0===this.activePointers_,this.updateActivePointers_(t);var e=new Wl(Xl.POINTERDOWN,this.map_,t);for(var r in this.dispatchEvent(e),this.down_={},t){var n=t[r];this.down_[r]="function"==typeof n?ds:n}if(0===this.dragListenerKeys_.length){var i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(fa(i,Xl.POINTERMOVE,this.handlePointerMove_,this),fa(i,Xl.POINTERUP,this.handlePointerUp_,this),fa(this.element_,Xl.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(fa(this.element_.getRootNode(),Xl.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Wl(Xl.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Wl(t.type,this.map_,t,e))},e.prototype.handleTouchMove_=function(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(da(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ca,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(da(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(da),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(Ks),tu="postrender",eu="movestart",ru="moveend",nu="layergroup",iu="size",ou="target",su="view",au=1/0,lu=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,q(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,r=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(r);return delete this.queuedElements_[n],r},t.prototype.enqueue=function(t){ut(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=au&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,r=this.priorities_,n=e.length,i=e[t],o=r[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&r[l]<r[a]?l:a;e[t]=e[u],r[t]=r[u],t=u}e[t]=i,r[t]=o,this.siftDown_(s,t)},t.prototype.siftDown_=function(t,e){for(var r=this.elements_,n=this.priorities_,i=r[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;r[e]=r[s],n[e]=n[s],e=s}r[e]=i,n[e]=o},t.prototype.reprioritize=function(){var t,e,r,n=this.priorityFunction_,i=this.elements_,o=this.priorities_,s=0,a=i.length;for(e=0;e<a;++e)(r=n(t=i[e]))==au?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=r,i[s++]=t);i.length=s,o.length=s,this.heapify_()},t}(),uu=0,cu=1,hu=2,fu=3,pu=4,du=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gu=function(t){function e(e,r){var n=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=r,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return du(e,t),e.prototype.enqueue=function(e){var r=t.prototype.enqueue.call(this,e);r&&e[0].addEventListener($s,this.boundHandleTileChange_);return r},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,r=e.getState();if(r===hu||r===fu||r===pu){e.removeEventListener($s,this.boundHandleTileChange_);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var r,n,i=0;this.tilesLoading_<t&&i<e&&this.getCount()>0;)n=(r=this.dequeue()[0]).getKey(),r.getState()!==uu||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++i,r.load())},e}(lu);var yu=0,mu=1,_u="center",vu="resolution",bu="rotation",wu=256;function xu(t,e,r){return function(n,i,o,s,a){if(n){var l=e?0:o[0]*i,u=e?0:o[1]*i,c=a?a[0]:0,h=a?a[1]:0,f=t[0]+l/2+c,p=t[2]-l/2+c,d=t[1]+u/2+h,g=t[3]-u/2+h;f>p&&(p=f=(p+f)/2),d>g&&(g=d=(g+d)/2);var m=y(n[0],f,p),_=y(n[1],d,g),v=30*i;return s&&r&&(m+=-v*Math.log(1+Math.max(0,f-n[0])/v)+v*Math.log(1+Math.max(0,n[0]-p)/v),_+=-v*Math.log(1+Math.max(0,d-n[1])/v)+v*Math.log(1+Math.max(0,n[1]-g)/v)),[m,_]}}}function Eu(t){return t}function Su(t,e,r,n){var i=Gt(e)/r[0],o=At(e)/r[1];return n?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function Iu(t,e,r){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,r&&(n=Math.max(n,r),n/=Math.log(1+50*Math.max(0,r/t-1))/50+1),y(n,r/2,2*e)}function Ou(t,e,r,n,i){return function(o,s,a,l){if(void 0!==o){var u=n?Su(t,n,a,i):t;return(void 0===r||r)&&l?Iu(o,u,e):y(o,e,u)}}}function Cu(t){return void 0!==t?0:void 0}function Tu(t){return void 0!==t?t:void 0}function Pu(t){return Math.pow(t,3)}function Ru(t){return 1-Pu(1-t)}function Lu(t){return 3*t*t-2*t*t*t}function Mu(t){return t}function ku(t){return t<.5?Lu(2*t):1-Lu(2*(t-.5))}var Nu="XY",Au="XYZ",Fu="XYM",Du="XYZM";function ju(t,e,r,n,i,o){for(var s=o||[],a=0,l=e;l<r;l+=n){var u=t[l],c=t[l+1];s[a++]=i[0]*u+i[2]*c+i[4],s[a++]=i[1]*u+i[3]*c+i[5]}return o&&s.length!=a&&(s.length=a),s}function Gu(t,e,r,n,i,o,s){for(var a=s||[],l=Math.cos(i),u=Math.sin(i),c=o[0],h=o[1],f=0,p=e;p<r;p+=n){var d=t[p]-c,g=t[p+1]-h;a[f++]=c+d*l-g*u,a[f++]=h+d*u+g*l;for(var y=p+2;y<p+n;++y)a[f++]=t[y]}return s&&a.length!=f&&(a.length=f),a}function zu(t,e,r,n,i,o,s){for(var a=s||[],l=0,u=e;u<r;u+=n){a[l++]=t[u]+i,a[l++]=t[u+1]+o;for(var c=u+2;c<u+n;++c)a[l++]=t[c]}return s&&a.length!=l&&(a.length=l),a}var Uu=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bu=[1,0,0,1,0,0],Vu=function(t){function e(){var e,r,n,i,o,s=t.call(this)||this;return s.extent_=[1/0,1/0,-1/0,-1/0],s.extentRevision_=-1,s.simplifiedGeometryMaxMinSquaredTolerance=0,s.simplifiedGeometryRevision=0,s.simplifyTransformedInternal=(e=function(t,e,r){if(!r)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(r),n.getSimplifiedGeometry(e)},o=!1,function(){var t=Array.prototype.slice.call(arguments);return o&&this===i&&We(t,n)||(o=!0,i=this,n=t,r=e.apply(this,arguments)),r}),s}return Uu(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return Object(st.b)()},e.prototype.closestPointXY=function(t,e,r,n){return Object(st.b)()},e.prototype.containsXY=function(t,e){var r=this.getClosestPoint([t,e]);return r[0]===t&&r[1]===e},e.prototype.getClosestPoint=function(t,e){var r=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],r,1/0),r},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Object(st.b)()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&bt(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){Object(st.b)()},e.prototype.scale=function(t,e,r){Object(st.b)()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Object(st.b)()},e.prototype.getType=function(){return Object(st.b)()},e.prototype.applyTransform=function(t){Object(st.b)()},e.prototype.intersectsExtent=function(t){return Object(st.b)()},e.prototype.translate=function(t,e){Object(st.b)()},e.prototype.transform=function(t,e){var r=ye(t),n=r.getUnits()==d.TILE_PIXELS?function(t,n,i){var o=r.getExtent(),s=r.getWorldExtent(),a=At(s)/At(o);return Rs(Bu,s[0],s[3],a,-a,0,0,0),ju(t,0,t.length,i,Bu,n),Ie(r,e)(t,n,i)}:Ie(r,e);return this.applyTransform(n),this},e}(wa),qu=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Yu(t){var e;return t==Nu?e=2:t==Au||t==Fu?e=3:t==Du&&(e=4),e}var Wu=function(t){function e(){var e=t.call(this)||this;return e.layout=Nu,e.stride=2,e.flatCoordinates=null,e}return qu(e,t),e.prototype.computeExtent=function(t){return xt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Object(st.b)()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Yu(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){Object(st.b)()},e.prototype.setLayout=function(t,e,r){var n;if(t)n=Yu(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout=Nu,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=Nu:3==t?e=Au:4==t&&(e=Du);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();Gu(r,0,r.length,n,t,e,r),this.changed()}},e.prototype.scale=function(t,e,r){var n=e;void 0===n&&(n=t);var i=r;i||(i=Mt(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,r,n,i,o,s,a){for(var l=a||[],u=s[0],c=s[1],h=0,f=e;f<r;f+=n){var p=t[f]-u,d=t[f+1]-c;l[h++]=u+i*p,l[h++]=c+o*d;for(var g=f+2;g<f+n;++g)l[h++]=t[g]}a&&l.length!=h&&(l.length=h)}(o,0,o.length,s,t,n,i,o),this.changed()}},e.prototype.translate=function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();zu(r,0,r.length,n,t,e,r),this.changed()}},e}(Vu);function Xu(t,e,r,n,i,o,s){var a,l=t[e],u=t[e+1],c=t[r]-l,h=t[r+1]-u;if(0===c&&0===h)a=e;else{var f=((i-l)*c+(o-u)*h)/(c*c+h*h);if(f>1)a=r;else{if(f>0){for(var p=0;p<n;++p)s[p]=S(t[e+p],t[r+p],f);return void(s.length=n)}a=e}}for(p=0;p<n;++p)s[p]=t[a+p];s.length=n}function Hu(t,e,r,n,i){var o=t[e],s=t[e+1];for(e+=n;e<r;e+=n){var a=t[e],l=t[e+1],u=b(o,s,a,l);u>i&&(i=u),o=a,s=l}return i}function Zu(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){var a=r[o];i=Hu(t,e,a,n,i),e=a}return i}function Ku(t,e,r,n,i,o,s,a,l,u,c){if(e==r)return u;var h,f;if(0===i){if((f=b(s,a,t[e],t[e+1]))<u){for(h=0;h<n;++h)l[h]=t[e+h];return l.length=n,f}return u}for(var p=c||[NaN,NaN],d=e+n;d<r;)if(Xu(t,d-n,d,n,s,a,p),(f=b(s,a,p[0],p[1]))<u){for(u=f,h=0;h<n;++h)l[h]=p[h];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(u))/i|0,1);if(o&&(Xu(t,r-n,e,n,s,a,p),(f=b(s,a,p[0],p[1]))<u)){for(u=f,h=0;h<n;++h)l[h]=p[h];l.length=n}return u}function $u(t,e,r,n,i,o,s,a,l,u,c){for(var h=c||[NaN,NaN],f=0,p=r.length;f<p;++f){var d=r[f];u=Ku(t,e,d,n,i,o,s,a,l,u,h),e=d}return u}function Ju(t,e,r,n){for(var i=0,o=r.length;i<o;++i)t[e++]=r[i];return e}function Qu(t,e,r,n){for(var i=0,o=r.length;i<o;++i)for(var s=r[i],a=0;a<n;++a)t[e++]=s[a];return e}function tc(t,e,r,n,i){for(var o=i||[],s=0,a=0,l=r.length;a<l;++a){var u=Qu(t,e,r[a],n);o[s++]=u,e=u}return o.length=s,o}function ec(t,e,r,n,i,o,s){var a=(r-e)/n;if(a<3){for(;e<r;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var u=[e,r-n],c=0;u.length>0;){for(var h=u.pop(),f=u.pop(),p=0,d=t[f],g=t[f+1],y=t[h],m=t[h+1],_=f+n;_<h;_+=n){var b=v(t[_],t[_+1],d,g,y,m);b>p&&(c=_,p=b)}p>i&&(l[(c-e)/n]=1,f+n<c&&u.push(f,c),c+n<h&&u.push(c,h))}for(_=0;_<a;++_)l[_]&&(o[s++]=t[e+_*n],o[s++]=t[e+_*n+1]);return s}function rc(t,e,r,n,i,o,s,a){for(var l=0,u=r.length;l<u;++l){var c=r[l];s=ec(t,e,c,n,i,o,s),a.push(s),e=c}return s}function nc(t,e){return e*Math.round(t/e)}function ic(t,e,r,n,i,o,s){if(e==r)return s;var a,l,u=nc(t[e],i),c=nc(t[e+1],i);e+=n,o[s++]=u,o[s++]=c;do{if(a=nc(t[e],i),l=nc(t[e+1],i),(e+=n)==r)return o[s++]=a,o[s++]=l,s}while(a==u&&l==c);for(;e<r;){var h=nc(t[e],i),f=nc(t[e+1],i);if(e+=n,h!=a||f!=l){var p=a-u,d=l-c,g=h-u,y=f-c;p*y==d*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(d<0&&y<d||d==y||d>0&&y>d)?(a=h,l=f):(o[s++]=a,o[s++]=l,u=a,c=l,a=h,l=f)}}return o[s++]=a,o[s++]=l,s}function oc(t,e,r,n,i,o,s,a){for(var l=0,u=r.length;l<u;++l){var c=r[l];s=ic(t,e,c,n,i,o,s),a.push(s),e=c}return s}function sc(t,e,r,n,i){for(var o=void 0!==i?i:[],s=0,a=e;a<r;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function ac(t,e,r,n,i){for(var o=void 0!==i?i:[],s=0,a=0,l=r.length;a<l;++a){var u=r[a];o[s++]=sc(t,e,u,n,o[s]),e=u}return o.length=s,o}function lc(t,e,r,n,i){for(var o=void 0!==i?i:[],s=0,a=0,l=r.length;a<l;++a){var u=r[a];o[s++]=ac(t,e,u,n,o[s]),e=u[u.length-1]}return o.length=s,o}function uc(t,e,r,n){for(var i=0,o=t[r-n],s=t[r-n+1];e<r;e+=n){var a=t[e],l=t[e+1];i+=s*a-o*l,o=a,s=l}return i/2}function cc(t,e,r,n){for(var i=0,o=0,s=r.length;o<s;++o){var a=r[o];i+=uc(t,e,a,n),e=a}return i}var hc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fc=function(t){function e(e,r){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===r||Array.isArray(e[0])?n.setCoordinates(e,r):n.setFlatCoordinates(r,e),n}return hc(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,n){return n<pt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ku(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,n))},e.prototype.getArea=function(){return uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=ec(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,Nu)},e.prototype.getType=function(){return Yt.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Wu),pc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dc=function(t){function e(e,r){var n=t.call(this)||this;return n.setCoordinates(e,r),n}return pc(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){var i=this.flatCoordinates,o=b(t,e,i[0],i[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)r[a]=i[a];return r.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return wt(this.flatCoordinates,t)},e.prototype.getType=function(){return Yt.POINT},e.prototype.intersectsExtent=function(t){return yt(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ju(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Wu);function gc(t,e,r,n,i){return!Tt(i,(function(i){return!yc(t,e,r,n,i[0],i[1])}))}function yc(t,e,r,n,i,o){for(var s=0,a=t[r-n],l=t[r-n+1];e<r;e+=n){var u=t[e],c=t[e+1];l<=o?c>o&&(u-a)*(o-l)-(i-a)*(c-l)>0&&s++:c<=o&&(u-a)*(o-l)-(i-a)*(c-l)<0&&s--,a=u,l=c}return 0!==s}function mc(t,e,r,n,i,o){if(0===r.length)return!1;if(!yc(t,e,r[0],n,i,o))return!1;for(var s=1,a=r.length;s<a;++s)if(yc(t,r[s-1],r[s],n,i,o))return!1;return!0}function _c(t,e,r,n,i,o,s){for(var a,l,u,c,h,f,p,d=i[o+1],g=[],y=0,m=r.length;y<m;++y){var _=r[y];for(c=t[_-n],f=t[_-n+1],a=e;a<_;a+=n)h=t[a],p=t[a+1],(d<=f&&p<=d||f<=d&&d<=p)&&(u=(d-f)/(p-f)*(h-c)+c,g.push(u)),c=h,f=p}var v=NaN,b=-1/0;for(g.sort(ze),c=g[0],a=1,l=g.length;a<l;++a){h=g[a];var w=Math.abs(h-c);w>b&&mc(t,e,r,n,u=(c+h)/2,d)&&(v=u,b=w),c=h}return isNaN(v)&&(v=i[o]),s?(s.push(v,d,b),s):[v,d,b]}function vc(t,e,r,n,i){for(var o=[],s=0,a=r.length;s<a;++s){var l=r[s];o=_c(t,e,l,n,i,2*s,o),e=l[l.length-1]}return o}function bc(t,e,r,n,i){var o;for(e+=n;e<r;e+=n)if(o=i(t.slice(e-n,e),t.slice(e,e+n)))return o;return!1}function wc(t,e,r,n,i){var o=Ot([1/0,1/0,-1/0,-1/0],t,e,r,n);return!!zt(i,o)&&(!!gt(i,o)||(o[0]>=i[0]&&o[2]<=i[2]||(o[1]>=i[1]&&o[3]<=i[3]||bc(t,e,r,n,(function(t,e){return function(t,e,r){var n=!1,i=mt(t,e),o=mt(t,r);if(i===et||o===et)n=!0;else{var s=t[0],a=t[1],l=t[2],u=t[3],c=e[0],h=e[1],f=r[0],p=r[1],d=(p-h)/(f-c),g=void 0,y=void 0;o&rt&&!(i&rt)&&(n=(g=f-(p-u)/d)>=s&&g<=l),n||!(o&nt)||i&nt||(n=(y=p-(f-l)*d)>=a&&y<=u),n||!(o&it)||i&it||(n=(g=f-(p-a)/d)>=s&&g<=l),n||!(o&ot)||i&ot||(n=(y=p-(f-s)*d)>=a&&y<=u)}return n}(i,t,e)})))))}function xc(t,e,r,n,i){if(!function(t,e,r,n,i){return!!(wc(t,e,r,n,i)||yc(t,e,r,n,i[0],i[1])||yc(t,e,r,n,i[0],i[3])||yc(t,e,r,n,i[2],i[1])||yc(t,e,r,n,i[2],i[3]))}(t,e,r[0],n,i))return!1;if(1===r.length)return!0;for(var o=1,s=r.length;o<s;++o)if(gc(t,r[o-1],r[o],n,i)&&!wc(t,r[o-1],r[o],n,i))return!1;return!0}function Ec(t,e,r,n){for(;e<r-n;){for(var i=0;i<n;++i){var o=t[e+i];t[e+i]=t[r-n+i],t[r-n+i]=o}e+=n,r-=n}}function Sc(t,e,r,n){for(var i=0,o=t[r-n],s=t[r-n+1];e<r;e+=n){var a=t[e],l=t[e+1];i+=(a-o)*(l+s),o=a,s=l}return 0===i?void 0:i>0}function Ic(t,e,r,n,i){for(var o=void 0!==i&&i,s=0,a=r.length;s<a;++s){var l=r[s],u=Sc(t,e,l,n);if(0===s){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function Oc(t,e,r,n,i){for(var o=void 0!==i&&i,s=0,a=r.length;s<a;++s){var l=r[s],u=Sc(t,e,l,n);(0===s?o&&u||!o&&!u:o&&!u||!o&&u)&&Ec(t,e,l,n),e=l}return e}function Cc(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o)e=Oc(t,e,r[o],n,i);return e}var Tc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Pc=function(t){function e(e,r,n){var i=t.call(this)||this;return i.ends_=[],i.flatInteriorPointRevision_=-1,i.flatInteriorPoint_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,void 0!==r&&n?(i.setFlatCoordinates(r,e),i.ends_=n):i.setCoordinates(e,r),i}return Tc(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?qe(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){return n<pt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zu(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$u(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,n))},e.prototype.containsXY=function(t,e){return mc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return cc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Oc(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,ac(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Mt(this.getExtent());this.flatInteriorPoint_=_c(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new dc(this.getFlatInteriorPoint(),Fu)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new fc(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,n=[],i=0,o=0,s=r.length;o<s;++o){var a=r[o],l=new fc(e.slice(i,a),t);n.push(l),i=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ic(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Oc(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],n=[];return r.length=oc(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,n),new e(r,Nu,n)},e.prototype.getType=function(){return Yt.POLYGON},e.prototype.intersectsExtent=function(t){return xc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=tc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Wu),Rc=Pc;function Lc(t,e,r,n){for(var i=r||32,o=[],s=0;s<i;++s)qe(o,Kt(t,e,2*Math.PI*s/i,n));return o.push(o[0],o[1]),new Pc(o,Nu,[o.length])}function Mc(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=[e,r,e,i,n,i,n,r,e,r];return new Pc(o,Nu,[o.length])}function kc(t,e,r){for(var n=e||32,i=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=i*(n+1),l=new Array(a),u=0;u<a;u+=i){l[u]=0,l[u+1]=0;for(var c=2;c<i;c++)l[u+c]=s[c]}var h=[l.length],f=new Pc(l,o,h);return Nc(f,s,t.getRadius(),r),f}function Nc(t,e,r,n){for(var i=t.getFlatCoordinates(),o=t.getStride(),s=i.length/o-1,a=n||0,l=0;l<=s;++l){var u=l*o,c=a+2*E(l,s)*Math.PI/s;i[u]=e[0]+r*Math.cos(c),i[u+1]=e[1]+r*Math.sin(c)}t.changed()}var Ac=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Fc(t,e){setTimeout((function(){t(e)}),0)}function Dc(t){return!(t.sourceCenter&&t.targetCenter&&!ie(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function jc(t,e,r,n,i){var o=Math.cos(-i),s=Math.sin(-i),a=t[0]*o-t[1]*s,l=t[1]*o+t[0]*s;return[(a+=(e[0]/2-r[0])*n)*o-(l+=(r[1]-e[1]/2)*n)*(s=-s),l*o+a*s]}var Gc=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n=V({},e);return r.hints_=[0,0],r.animations_=[],r.updateAnimationKey_,r.projection_=ve(n.projection,"EPSG:3857"),r.viewportSize_=[100,100],r.targetCenter_=null,r.targetResolution_,r.targetRotation_,r.nextCenter_=null,r.nextResolution_,r.nextRotation_,r.cancelAnchor_=void 0,n.center&&(n.center=Ne(n.center,r.projection_)),n.extent&&(n.extent=Fe(n.extent,r.projection_)),r.applyOptions_(n),r}return Ac(e,t),e.prototype.applyOptions_=function(t){var e=function(t){var e,r,n,i=28,o=2,s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:i,l=void 0!==t.zoomFactor?t.zoomFactor:o,u=void 0!==t.multiWorld&&t.multiWorld,c=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,h=void 0!==t.showFullExtent&&t.showFullExtent,f=ve(t.projection,"EPSG:3857"),g=f.getExtent(),m=t.constrainOnlyCenter,_=t.extent;u||_||!f.isGlobal()||(m=!1,_=g);if(void 0!==t.resolutions){var v=t.resolutions;r=v[s],n=void 0!==v[a]?v[a]:v[v.length-1],e=t.constrainResolution?function(t,e,r,n){return function(i,o,s,a){if(void 0!==i){var l=t[0],u=t[t.length-1],c=r?Su(l,r,s,n):l;if(a)return void 0===e||e?Iu(i,c,u):y(i,u,c);var h=Math.min(c,i),f=Math.floor(Be(t,h,o));return t[f]>c&&f<t.length-1?t[f+1]:t[f]}}}(v,c,!m&&_,h):Ou(r,n,c,!m&&_,h)}else{var b=(g?Math.max(Gt(g),At(g)):360*p[d.DEGREES]/f.getMetersPerUnit())/wu/Math.pow(o,0),w=b/Math.pow(o,i-0);void 0!==(r=t.maxResolution)?s=0:r=b/Math.pow(l,s),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?r/Math.pow(l,a):b/Math.pow(l,a):w),a=s+Math.floor(Math.log(r/n)/Math.log(l)),n=r/Math.pow(l,a-s),e=t.constrainResolution?function(t,e,r,n,i,o){return function(s,a,l,u){if(void 0!==s){var c=i?Su(e,i,l,o):e,h=void 0!==r?r:0;if(u)return void 0===n||n?Iu(s,c,h):y(s,h,c);var f=Math.ceil(Math.log(e/c)/Math.log(t)-1e-9),p=-a*(.5-1e-9)+.5,d=Math.min(c,s),g=Math.floor(Math.log(e/d)/Math.log(t)+p),m=Math.max(f,g);return y(e/Math.pow(t,m),h,c)}}}(l,r,n,c,!m&&_,h):Ou(r,n,c,!m&&_,h)}return{constraint:e,maxResolution:r,minResolution:n,minZoom:s,zoomFactor:l}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=e.minZoom;var r=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return xu(t.extent,t.constrainOnlyCenter,e)}var r=ve(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&r.isGlobal()){var n=r.getExtent().slice();return n[0]=-1/0,n[2]=1/0,xu(n,!1,!1)}return Eu}(t),n=e.constraint,i=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=i||x(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=o?0:t:void 0}):!1===e?Tu:"number"==typeof e?(r=e,n=2*Math.PI/r,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):Tu}return Cu;var r,n;var i,o}(t);this.constraints_={center:r,resolution:n,rotation:i},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var r=this.getCenter();if(r){var n=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),o=i/2*(n[3]-e[3]+e[1]-n[1]),s=i/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([r[0]+o,r[1]-s])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var e=V({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),V({},e,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),r=0;r<e.length;++r){var n=arguments[r];n.center&&((n=V({},n)).center=Ne(n.center,this.getProjection())),n.anchor&&((n=V({},n)).anchor=Ne(n.anchor,this.getProjection())),e[r]=n}this.animateInternal.apply(this,e)},e.prototype.animateInternal=function(t){var e,r=arguments.length;r>1&&"function"==typeof arguments[r-1]&&(e=arguments[r-1],--r);for(var n=0;n<r&&!this.isDef();++n){var i=arguments[n];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(n!==r){for(var o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_,u=[];n<r;++n){var c=arguments[n],h={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||Lu,callback:e};if(c.center&&(h.sourceCenter=s,h.targetCenter=c.center.slice(),s=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),void 0!==c.rotation){h.sourceRotation=l;var f=E(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}Dc(h)?h.complete=!0:o+=h.duration,u.push(h)}this.animations_.push(u),this.setHint(yu,1),this.updateAnimations_()}else e&&Fc(e,!0)},e.prototype.getAnimating=function(){return this.hints_[yu]>0},e.prototype.getInteracting=function(){return this.hints_[mu]>0},e.prototype.cancelAnimations=function(){var t;this.setHint(yu,-this.hints_[yu]);for(var e=0,r=this.animations_.length;e<r;++e){var n=this.animations_[e];if(n[0].callback&&Fc(n[0].callback,!1),!t)for(var i=0,o=n.length;i<o;++i){var s=n[i];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,r=this.animations_.length-1;r>=0;--r){for(var n=this.animations_[r],i=!0,o=0,s=n.length;o<s;++o){var a=n[o];if(!a.complete){var l=t-a.start,u=a.duration>0?l/a.duration:1;u>=1?(a.complete=!0,u=1):i=!1;var c=a.easing(u);if(a.sourceCenter){var h=a.sourceCenter[0],f=a.sourceCenter[1],p=a.targetCenter[0],d=a.targetCenter[1];this.nextCenter_=a.targetCenter;var g=h+c*(p-h),y=f+c*(d-f);this.targetCenter_=[g,y]}if(a.sourceResolution&&a.targetResolution){var m=1===c?a.targetResolution:a.sourceResolution+c*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(m,0,_,!0);this.targetCenter_=this.calculateCenterZoom(v,a.anchor)}this.nextResolution_=a.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var b=1===c?E(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+c*(a.targetRotation-a.sourceRotation);if(a.anchor){var w=this.constraints_.rotation(b,!0);this.targetCenter_=this.calculateCenterRotate(w,a.anchor)}this.nextRotation_=a.targetRotation,this.targetRotation_=b}if(this.applyTargetState_(!0),e=!0,!a.complete)break}}if(i){this.animations_[r]=null,this.setHint(yu,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var x=n[0].callback;x&&Fc(x,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,e){var r,n=this.getCenterInternal();return void 0!==n&&(oe(r=[n[0]-e[0],n[1]-e[1]],t-this.getRotation()),Qt(r,e)),r},e.prototype.calculateCenterZoom=function(t,e){var r,n=this.getCenterInternal(),i=this.getResolution();void 0!==n&&void 0!==i&&(r=[e[0]-t*(e[0]-n[0])/i,e[1]-t*(e[1]-n[1])/i]);return r},e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var r=e[0],n=e[1];return[Math.abs(r*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t?ke(t,this.getProjection()):t},e.prototype.getCenterInternal=function(){return this.get(_u)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){return Ae(this.calculateExtentInternal(t),this.getProjection())},e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSizeMinusPadding_(),r=this.getCenterInternal();ut(r,1);var n=this.getResolution();ut(void 0!==n,2);var i=this.getRotation();return ut(void 0!==i,3),Nt(r,n,i,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(vu)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(Fe(t,this.getProjection()),e)},e.prototype.getResolutionForExtentInternal=function(t,e){var r=e||this.getViewportSizeMinusPadding_(),n=Gt(t)/r[0],i=At(t)/r[1];return Math.max(n,i)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,r=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(r/n)/Math.log(e);return function(t){return r/Math.pow(e,t*i)}},e.prototype.getRotation=function(){return this.get(bu)},e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),r=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(r/n)/e;return function(t){return Math.log(r/t)/e/i}},e.prototype.getViewportSizeMinusPadding_=function(t){var e=this.getViewportSize_(t),r=this.padding_;return r&&(e=[e[0]-r[1]-r[3],e[1]-r[0]-r[2]]),e},e.prototype.getState=function(){var t=this.getProjection(),e=this.getResolution(),r=this.getRotation(),n=this.getCenterInternal(),i=this.padding_;if(i){var o=this.getViewportSizeMinusPadding_();n=jc(n,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,r)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,r,n=this.minZoom_||0;if(this.resolutions_){var i=Be(this.resolutions_,t,1);n=i,e=this.resolutions_[i],r=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,r=this.zoomFactor_;return n+Math.log(e/t)/Math.log(r)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=y(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(r,y(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,e){var r;if(ut(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))ut(!Ut(t),25),r=Mc(n=Fe(t,this.getProjection()));else if(t.getType()===Yt.CIRCLE){var n;(r=Mc(n=Fe(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),Mt(n))}else{var i=Me();r=i?t.clone().transform(i,this.getProjection()):t}this.fitInternal(r,e)},e.prototype.rotatedExtentForGeometry=function(t){for(var e=this.getRotation(),r=Math.cos(e),n=Math.sin(-e),i=t.getFlatCoordinates(),o=t.getStride(),s=1/0,a=1/0,l=-1/0,u=-1/0,c=0,h=i.length;c<h;c+=o){var f=i[c]*r-i[c+1]*n,p=i[c]*n+i[c+1]*r;s=Math.min(s,f),a=Math.min(a,p),l=Math.max(l,f),u=Math.max(u,p)}return[s,a,l,u]},e.prototype.fitInternal=function(t,e){var r=e||{},n=r.size;n||(n=this.getViewportSizeMinusPadding_());var i,o=void 0!==r.padding?r.padding:[0,0,0,0],s=void 0!==r.nearest&&r.nearest;i=void 0!==r.minResolution?r.minResolution:void 0!==r.maxZoom?this.getResolutionForZoom(r.maxZoom):0;var a=this.rotatedExtentForGeometry(t),l=this.getResolutionForExtentInternal(a,[n[0]-o[1]-o[3],n[1]-o[0]-o[2]]);l=isNaN(l)?i:Math.max(l,i),l=this.getConstrainedResolution(l,s?0:1);var u=this.getRotation(),c=Math.sin(u),h=Math.cos(u),f=Mt(a);f[0]+=(o[1]-o[3])/2*l,f[1]+=(o[0]-o[2])/2*l;var p=f[0]*h-f[1]*c,d=f[1]*h+f[0]*c,g=this.getConstrainedCenter([p,d],l),y=r.callback?r.callback:ds;void 0!==r.duration?this.animateInternal({resolution:l,center:g,duration:r.duration,easing:r.easing},y):(this.targetResolution_=l,this.targetCenter_=g,this.applyTargetState_(!1,!0),Fc(y,!0))},e.prototype.centerOn=function(t,e,r){this.centerOnInternal(Ne(t,this.getProjection()),e,r)},e.prototype.centerOnInternal=function(t,e,r){this.setCenterInternal(jc(t,e,r,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,e,r,n){var i,o=this.padding_;if(o&&t){var s=this.getViewportSizeMinusPadding_(-r),a=jc(t,n,[s[0]/2+o[3],s[1]/2+o[0]],e,r);i=[t[0]-a[0],t[1]-a[1]]}return i},e.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},e.prototype.adjustCenter=function(t){var e=ke(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustResolution=function(t,e){var r=e&&Ne(e,this.getProjection());this.adjustResolutionInternal(t,r)},e.prototype.adjustResolutionInternal=function(t,e){var r=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,n,r);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},e.prototype.adjustRotation=function(t,e){e&&(e=Ne(e,this.getProjection())),this.adjustRotationInternal(t,e)},e.prototype.adjustRotationInternal=function(t,e){var r=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,r);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(Ne(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,e){var r=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,r),i=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,i,r),s=this.constraints_.center(this.targetCenter_,o,i,r,this.calculateCenterShift(this.targetCenter_,o,n,i));this.get(bu)!==n&&this.set(bu,n),this.get(vu)!==o&&this.set(vu,o),this.get(_u)&&ie(this.get(_u),s)||this.set(_u,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,e,r){var n=void 0!==t?t:200,i=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,i,s),l=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(0===n&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,void this.applyTargetState_();var u=r||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===o&&this.getCenterInternal()&&ie(this.getCenterInternal(),l)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:n,easing:Ru,anchor:u}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(mu,1)},e.prototype.endInteraction=function(t,e,r){var n=r&&Ne(r,this.getProjection());this.endInteractionInternal(t,e,n)},e.prototype.endInteractionInternal=function(t,e,r){this.setHint(mu,-1),this.resolveConstraints(t,e,r)},e.prototype.getConstrainedCenter=function(t,e){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),r)},e.prototype.getConstrainedZoom=function(t,e){var r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,e))},e.prototype.getConstrainedResolution=function(t,e){var r=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,n)},e}(wa);function zc(t,e,r){return void 0===r&&(r=[0,0]),r[0]=t[0]+2*e,r[1]=t[1]+2*e,r}function Uc(t){return t[0]>0&&t[1]>0}function Bc(t,e,r){return void 0===r&&(r=[0,0]),r[0]=t[0]*e+.5|0,r[1]=t[1]*e+.5|0,r}function Vc(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var qc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var Yc=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var r,n,i,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Bl({layers:t.layers});o[nu]=s,o[ou]=t.target,o[su]=t.view instanceof Gc?t.view:new Gc,void 0!==t.controls&&(Array.isArray(t.controls)?r=new Gl(t.controls.slice()):(ut("function"==typeof t.controls.getArray,47),r=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new Gl(t.interactions.slice()):(ut("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?i=new Gl(t.overlays.slice()):(ut("function"==typeof t.overlays.getArray,49),i=t.overlays):i=new Gl;return{controls:r,interactions:n,keyboardEventTarget:e,overlays:i,values:o}}(e);r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,r.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:bs,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(r),r.coordinateToPixelTransform_=[1,0,0,1,0,0],r.pixelToCoordinateTransform_=[1,0,0,1,0,0],r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.style.pointerEvents="none",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.style.pointerEvents="none",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=null,r.moveTolerance_=e.moveTolerance,r.keyboardEventTarget_=n.keyboardEventTarget,r.keyHandlerKeys_=null,r.controls=n.controls||new Gl,r.interactions=n.interactions||new Gl,r.overlays_=n.overlays,r.overlayIdIndex_={},r.renderer_=null,r.handleResize_,r.postRenderFunctions_=[],r.tileQueue_=new gu(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addChangeListener(nu,r.handleLayerGroupChanged_),r.addChangeListener(su,r.handleViewChanged_),r.addChangeListener(iu,r.handleSizeChanged_),r.addChangeListener(ou,r.handleTargetChanged_),r.setProperties(n.values);var i=r;return!e.view||e.view instanceof Gc||e.view.then((function(t){i.setView(new Gc(t))})),r.controls.addEventListener(Nl,function(t){t.element.setMap(this)}.bind(r)),r.controls.addEventListener(Al,function(t){t.element.setMap(null)}.bind(r)),r.interactions.addEventListener(Nl,function(t){t.element.setMap(this)}.bind(r)),r.interactions.addEventListener(Al,function(t){t.element.setMap(null)}.bind(r)),r.overlays_.addEventListener(Nl,function(t){this.addOverlayInternal_(t.element)}.bind(r)),r.overlays_.addEventListener(Al,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(r)),r.controls.forEach(function(t){t.setMap(this)}.bind(r)),r.interactions.forEach(function(t){t.setMap(this)}.bind(r)),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r}return qc(e,t),e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,r){if(this.frameState_){var n=this.getCoordinateFromPixelInternal(t),i=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance:0,o=void 0!==r.layerFilter?r.layerFilter:fs,s=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,i,s,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var r=[];return this.forEachFeatureAtPixel(t,(function(t){r.push(t)}),e),r},e.prototype.forEachLayerAtPixel=function(t,e,r){if(this.frameState_){var n=r||{},i=void 0!==n.hitTolerance?n.hitTolerance:0,o=n.layerFilter||fs;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,i,e,o)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var r=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:fs,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,i,o,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),r="changedTouches"in t?t.changedTouches[0]:t;return[r.clientX-e.left,r.clientY-e.top]},e.prototype.getTarget=function(){return this.get(ou)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return ke(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?Ts(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(nu)},e.prototype.setLayers=function(t){var e=this.getLayerGroup();if(t instanceof Gl)e.setLayers(t);else{var r=e.getLayers();r.clear(),r.extend(t)}},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,r=t.length;e<r;++e){var n=t[e].layer.getSource();if(n&&n.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var e=Ne(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?Ts(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(iu)},e.prototype.getView=function(){return this.get(su)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,e,r,n){return function(t,e,r,n,i){if(!t||!(r in t.wantedTiles))return au;if(!t.wantedTiles[r][e.getKey()])return au;var o=t.viewState.center,s=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(s*s+a*a)/i}(this.frameState_,t,e,r,n)},e.prototype.handleBrowserEvent=function(t,e){var r=e||t.type,n=new Wl(r,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var e=t.originalEvent,r=e.type;if(r===Zl||r===ha||r===sa){var n=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(i===n?n.documentElement:i).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var s=this.getInteractions().getArray().slice(),a=s.length-1;a>=0;a--){var l=s[a];if(l.getMap()===this&&l.getActive()&&this.getTargetElement())if(!l.handleEvent(t)||t.propagationStopped)break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var r=this.maxTilesLoading_,n=r;if(t){var i=t.viewHints;if(i[yu]||i[mu]){var o=Date.now()-t.time>8;r=o?0:8,n=o?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,n))}!t||!this.hasListener(ja)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(ja,t);for(var s=this.postRenderFunctions_,a=0,l=s.length;a<l;++a)s[a](this,t);s.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(var e=0,r=this.keyHandlerKeys_.length;e<r;++e)da(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(ta,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ha,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(ua,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,ul(this.viewport_)}if(t){for(var n in t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new Ql(this,this.moveTolerance_),Xl)this.mapBrowserEventHandler_.addEventListener(Xl[n],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ta,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ha,this.boundHandleBrowserEvent_,!!Es&&{passive:!1});var i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[fa(i,sa,this.handleBrowserEvent,this),fa(i,aa,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(ua,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(da(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(da(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=fa(t,Hs,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=fa(t,$s,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(da),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[fa(t,Hs,this.render,this),fa(t,$s,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,r=t.length;e<r;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e=this,r=this.getSize(),n=this.getView(),i=this.frameState_,o=null;if(void 0!==r&&Uc(r)&&n&&n.isDef()){var s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Nt(a.center,a.resolution,a.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{}},a.nextCenter&&a.nextResolution){var l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;o.nextExtent=Nt(a.nextCenter,a.nextResolution,l,r)}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i)(!this.previousExtent_||!Ut(this.previousExtent_)&&!Et(o.extent,this.previousExtent_))&&(this.dispatchEvent(new ql(eu,this,i)),this.previousExtent_=bt(this.previousExtent_));this.previousExtent_&&!o.viewHints[yu]&&!o.viewHints[mu]&&!Et(o.extent,this.previousExtent_)&&(this.dispatchEvent(new ql(ru,this,o)),ft(o.extent,this.previousExtent_))}this.dispatchEvent(new ql(tu,this,o)),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()}),0))},e.prototype.setLayerGroup=function(t){this.set(nu,t)},e.prototype.setSize=function(t){this.set(iu,t)},e.prototype.setTarget=function(t){this.set(ou,t)},e.prototype.setView=function(t){if(!t||t instanceof Gc)this.set(su,t);else{this.set(su,new Gc);var e=this;t.then((function(t){e.setView(new Gc(t))}))}},e.prototype.updateSize=function(){var t=this.getTargetElement(),e=void 0;if(t){var r=getComputedStyle(t),n=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),i=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);isNaN(n)||isNaN(i)||!Uc(e=[n,i])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")}this.setSize(e),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(e=[parseInt(r.width,10),parseInt(r.height,10)]),t.setViewportSize(e)}},e}(wa),Wc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xc=function(t){function e(e){var r=t.call(this)||this,n=e.element;return!n||e.target||n.style.pointerEvents||(n.style.pointerEvents="auto"),r.element=n||null,r.target_=null,r.map_=null,r.listenerKeys=[],e.render&&(r.render=e.render),e.target&&r.setTarget(e.target),r}return Wc(e,t),e.prototype.disposeInternal=function(){ul(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&ul(this.element);for(var e=0,r=this.listenerKeys.length;e<r;++e)da(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==ds&&this.listenerKeys.push(fa(t,tu,this.render,this)),t.render())},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(wa),Hc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zc=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this).ulElement_=document.createElement("ul"),r.collapsed_=void 0===n.collapsed||n.collapsed,r.userCollapsed_=r.collapsed_,r.overrideCollapsible_=void 0!==n.collapsible,r.collapsible_=void 0===n.collapsible||n.collapsible,r.collapsible_||(r.collapsed_=!1);var i=void 0!==n.className?n.className:"ol-attribution",o=void 0!==n.tipLabel?n.tipLabel:"Attributions",s=void 0!==n.expandClassName?n.expandClassName:i+"-expand",a=void 0!==n.collapseLabel?n.collapseLabel:"›",l=void 0!==n.collapseClassName?n.collapseClassName:i+"-collpase";"string"==typeof a?(r.collapseLabel_=document.createElement("span"),r.collapseLabel_.textContent=a,r.collapseLabel_.className=l):r.collapseLabel_=a;var u=void 0!==n.label?n.label:"i";"string"==typeof u?(r.label_=document.createElement("span"),r.label_.textContent=u,r.label_.className=s):r.label_=u;var c=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;r.toggleButton_=document.createElement("button"),r.toggleButton_.setAttribute("type","button"),r.toggleButton_.setAttribute("aria-expanded",String(!r.collapsed_)),r.toggleButton_.title=o,r.toggleButton_.appendChild(c),r.toggleButton_.addEventListener(ea,r.handleClick_.bind(r),!1);var h=i+" "+"ol-unselectable "+Qa+(r.collapsed_&&r.collapsible_?" ol-collapsed":"")+(r.collapsible_?"":" ol-uncollapsible"),f=r.element;return f.className=h,f.appendChild(r.toggleButton_),f.appendChild(r.ulElement_),r.renderedAttributions_=[],r.renderedVisible_=!0,r}return Hc(e,t),e.prototype.collectSourceAttributions_=function(t){for(var e={},r=[],n=!0,i=t.layerStatesArray,o=0,s=i.length;o<s;++o){var a=i[o];if(qa(a,t.viewState)){var l=a.layer.getSource();if(l){var u=l.getAttributions();if(u){var c=u(t);if(c)if(n=n&&!1!==l.getAttributionsCollapsible(),Array.isArray(c))for(var h=0,f=c.length;h<f;++h)c[h]in e||(r.push(c[h]),e[c[h]]=!0);else c in e||(r.push(c),e[c]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(n),r},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),r=e.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!We(e,this.renderedAttributions_)){cl(this.ulElement_);for(var n=0,i=e.length;n<i;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(tl),this.collapsed_?ll(this.collapseLabel_,this.label_):ll(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Xc),Kc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$c=function(t){function e(e){var r=this,n=e||{};r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var i=void 0!==n.className?n.className:"ol-rotate",o=void 0!==n.label?n.label:"⇧",s=void 0!==n.compassClassName?n.compassClassName:"ol-compass";r.label_=null,"string"==typeof o?(r.label_=document.createElement("span"),r.label_.className=s,r.label_.textContent=o):(r.label_=o,r.label_.classList.add(s));var a=n.tipLabel?n.tipLabel:"Reset rotation",l=document.createElement("button");l.className=i+"-reset",l.setAttribute("type","button"),l.title=a,l.appendChild(r.label_),l.addEventListener(ea,r.handleClick_.bind(r),!1);var u=i+" "+"ol-unselectable "+Qa,c=r.element;return c.className=u,c.appendChild(l),r.callResetNorth_=n.resetNorth?n.resetNorth:void 0,r.duration_=void 0!==n.duration?n.duration:250,r.autoHide_=void 0===n.autoHide||n.autoHide,r.rotation_=void 0,r.autoHide_&&r.element.classList.add($a),r}return Kc(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Ru}):t.setRotation(0))}},e.prototype.render=function(t){var e=t.frameState;if(e){var r=e.viewState.rotation;if(r!=this.rotation_){var n="rotate("+r+"rad)";if(this.autoHide_){var i=this.element.classList.contains($a);i||0!==r?i&&0!==r&&this.element.classList.remove($a):this.element.classList.add($a)}this.label_.style.transform=n}this.rotation_=r}},e}(Xc),Jc=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qc=function(t){function e(e){var r=this,n=e||{};r=t.call(this,{element:document.createElement("div"),target:n.target})||this;var i=void 0!==n.className?n.className:"ol-zoom",o=void 0!==n.delta?n.delta:1,s=void 0!==n.zoomInClassName?n.zoomInClassName:i+"-in",a=void 0!==n.zoomOutClassName?n.zoomOutClassName:i+"-out",l=void 0!==n.zoomInLabel?n.zoomInLabel:"+",u=void 0!==n.zoomOutLabel?n.zoomOutLabel:"–",c=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",h=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",f=document.createElement("button");f.className=s,f.setAttribute("type","button"),f.title=c,f.appendChild("string"==typeof l?document.createTextNode(l):l),f.addEventListener(ea,r.handleClick_.bind(r,o),!1);var p=document.createElement("button");p.className=a,p.setAttribute("type","button"),p.title=h,p.appendChild("string"==typeof u?document.createTextNode(u):u),p.addEventListener(ea,r.handleClick_.bind(r,-o),!1);var d=i+" "+"ol-unselectable "+Qa,g=r.element;return g.className=d,g.appendChild(f),g.appendChild(p),r.duration_=void 0!==n.duration?n.duration:250,r}return Jc(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var r=e.getZoom();if(void 0!==r){var n=e.getConstrainedZoom(r+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Ru})):e.setZoom(n)}}},e}(Xc);function th(t){var e=t||{},r=new Gl;return(void 0===e.zoom||e.zoom)&&r.push(new Qc(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&r.push(new $c(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&r.push(new Zc(e.attributionOptions)),r}var eh="active",rh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function nh(t,e,r,n){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),s=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:r,duration:void 0!==n?n:250,easing:Ru})}}var ih=function(t){function e(e){var r=t.call(this)||this;return r.on,r.once,r.un,e&&e.handleEvent&&(r.handleEvent=e.handleEvent),r.map_=null,r.setActive(!0),r}return rh(e,t),e.prototype.getActive=function(){return this.get(eh)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(eh,t)},e.prototype.setMap=function(t){this.map_=t},e}(wa),oh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sh=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.delta_=n.delta?n.delta:1,r.duration_=void 0!==n.duration?n.duration:250,r}return oh(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==Xl.DBLCLICK){var r=t.originalEvent,n=t.map,i=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_;nh(n.getView(),o,i,this.duration_),r.preventDefault(),e=!0}return!e},e}(ih),ah=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function lh(t){for(var e=t.length,r=0,n=0,i=0;i<e;i++)r+=t[i].clientX,n+=t[i].clientY;return[r/e,n/e]}var uh=function(t){function e(e){var r=this,n=e||{};return r=t.call(this,n)||this,n.handleDownEvent&&(r.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(r.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(r.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(r.handleUpEvent=n.handleUpEvent),n.stopDown&&(r.stopDown=n.stopDown),r.handlingDownUpSequence=!1,r.trackedPointers_={},r.targetPointers=[],r}return ah(e,t),e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Xl.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Xl.POINTERUP){var r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(t.type==Xl.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Xl.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Xl.POINTERDOWN||e===Xl.POINTERDRAG||e===Xl.POINTERUP}(t)){var e=t.originalEvent,r=e.pointerId.toString();t.type==Xl.POINTERUP?delete this.trackedPointers_[r]:(t.type==Xl.POINTERDOWN||r in this.trackedPointers_)&&(this.trackedPointers_[r]=e),this.targetPointers=Y(this.trackedPointers_)}},e}(ih);function ch(t){var e=arguments;return function(t){for(var r=!0,n=0,i=e.length;n<i&&(r=r&&e[n](t));++n);return r}}var hh=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},fh=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ph=function(t){return t.target.getTargetElement().contains(document.activeElement)},dh=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||ph(t)},gh=fs,yh=function(t){var e=t.originalEvent;return 0==e.button&&!(_s&&vs&&e.ctrlKey)},mh=ps,_h=function(t){return t.type==Xl.SINGLECLICK},vh=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},bh=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},wh=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},xh=function(t){var e=t.originalEvent;return ut(void 0!==e,56),"mouse"==e.pointerType},Eh=function(t){var e=t.originalEvent;return ut(void 0!==e,56),e.isPrimary&&0===e.button},Sh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ih=function(t){function e(e){var r=t.call(this,{stopDown:ps})||this,n=e||{};r.kinetic_=n.kinetic,r.lastCentroid=null,r.lastPointersCount_,r.panning_=!1;var i=n.condition?n.condition:ch(vh,Eh);return r.condition_=n.onFocusOnly?ch(dh,i):i,r.noKinetic_=!1,r}return Sh(e,t),e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,r=lh(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){var n=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],i=t.map.getView();se(n,i.getResolution()),oe(n,i.getRotation()),i.adjustCenterInternal(n)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var e=t.map,r=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=r.getCenterInternal(),s=e.getPixelFromCoordinateInternal(o),a=e.getCoordinateFromPixelInternal([s[0]-n*Math.cos(i),s[1]-n*Math.sin(i)]);r.animateInternal({center:r.getConstrainedCenter(a),duration:500,easing:Ru})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(uh),Oh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ch=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{stopDown:ps})||this).condition_=n.condition?n.condition:fh,r.lastAngle_=void 0,r.duration_=void 0!==n.duration?n.duration:250,r}return Oh(e,t),e.prototype.handleDragEvent=function(t){if(xh(t)){var e=t.map,r=e.getView();if(r.getConstraints().rotation!==Cu){var n=e.getSize(),i=t.pixel,o=Math.atan2(n[1]/2-i[1],i[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_;r.adjustRotationInternal(-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){return!xh(t)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){return!!xh(t)&&(!(!yh(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},e}(uh),Th=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ph=function(t){function e(e){var r=t.call(this)||this;return r.geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.style.pointerEvents="auto",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return Th(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,r="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+r,n.top=Math.min(t[1],e[1])+r,n.width=Math.abs(e[0]-t[0])+r,n.height=Math.abs(e[1]-t[1])+r},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new Rc([r])},e.prototype.getGeometry=function(){return this.geometry_},e}(hs),Rh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lh="boxstart",Mh="boxdrag",kh="boxend",Nh="boxcancel",Ah=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.coordinate=r,i.mapBrowserEvent=n,i}return Rh(e,t),e}(Xs),Fh=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n=e||{};return r.box_=new Ph(n.className||"ol-dragbox"),r.minArea_=void 0!==n.minArea?n.minArea:64,n.onBoxEnd&&(r.onBoxEnd=n.onBoxEnd),r.startPixel_=null,r.condition_=n.condition?n.condition:yh,r.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:r.defaultBoxEndCondition,r}return Rh(e,t),e.prototype.defaultBoxEndCondition=function(t,e,r){var n=r[0]-e[0],i=r[1]-e[1];return n*n+i*i>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ah(Mh,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ah(e?kh:Nh,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ah(Lh,t.coordinate,t)),!0)},e.prototype.onBoxEnd=function(t){},e}(uh),Dh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jh=function(t){function e(e){var r=this,n=e||{},i=n.condition?n.condition:bh;return(r=t.call(this,{condition:i,className:n.className||"ol-dragzoom",minArea:n.minArea})||this).duration_=void 0!==n.duration?n.duration:200,r.out_=void 0!==n.out&&n.out,r}return Dh(e,t),e.prototype.onBoxEnd=function(t){var e=this.getMap().getView(),r=this.getGeometry();if(this.out_){var n=e.rotatedExtentForGeometry(r),i=e.getResolutionForExtentInternal(n),o=e.getResolution()/i;(r=r.clone()).scale(o*o)}e.fitInternal(r,{duration:this.duration_,easing:Ru})},e}(Fh),Gh=37,zh=38,Uh=39,Bh=40,Vh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qh=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.defaultCondition_=function(t){return vh(t)&&wh(t)},r.condition_=void 0!==n.condition?n.condition:r.defaultCondition_,r.duration_=void 0!==n.duration?n.duration:100,r.pixelDelta_=void 0!==n.pixelDelta?n.pixelDelta:128,r}return Vh(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==sa){var r=t.originalEvent,n=r.keyCode;if(this.condition_(t)&&(n==Bh||n==Gh||n==Uh||n==zh)){var i=t.map.getView(),o=i.getResolution()*this.pixelDelta_,s=0,a=0;n==Bh?a=-o:n==Gh?s=-o:n==Uh?s=o:a=o;var l=[s,a];oe(l,i.getRotation()),function(t,e,r){var n=t.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==r?r:250,easing:Mu,center:t.getConstrainedCenter(i)})}}(i,l,this.duration_),r.preventDefault(),e=!0}}return!e},e}(ih),Yh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wh=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.condition_=n.condition?n.condition:wh,r.delta_=n.delta?n.delta:1,r.duration_=void 0!==n.duration?n.duration:100,r}return Yh(e,t),e.prototype.handleEvent=function(t){var e=!1;if(t.type==sa||t.type==aa){var r=t.originalEvent,n=r.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map,o=n=="+".charCodeAt(0)?this.delta_:-this.delta_;nh(i.getView(),o,void 0,this.duration_),r.preventDefault(),e=!0}}return!e},e}(ih),Xh=function(){function t(t,e,r){this.decay_=t,this.minVelocity_=e,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var r=e-3;r>0&&this.points_[r+2]>t;)r-=3;var n=this.points_[e+2]-this.points_[r+2];if(n<1e3/60)return!1;var i=this.points_[e]-this.points_[r],o=this.points_[e+1]-this.points_[r+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/n,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}(),Hh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Zh="trackpad",Kh="wheel",$h=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,n)||this).totalDelta_=0,r.lastDelta_=0,r.maxDelta_=void 0!==n.maxDelta?n.maxDelta:1,r.duration_=void 0!==n.duration?n.duration:250,r.timeout_=void 0!==n.timeout?n.timeout:80,r.useAnchor_=void 0===n.useAnchor||n.useAnchor,r.constrainResolution_=void 0!==n.constrainResolution&&n.constrainResolution;var i=n.condition?n.condition:gh;return r.condition_=n.onFocusOnly?ch(dh,i):i,r.lastAnchor_=null,r.startTime_=void 0,r.timeoutId_,r.mode_=void 0,r.trackpadEventGap_=400,r.trackpadTimeoutId_,r.deltaPerZoom_=300,r}return Hh(e,t),e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;if(t.type!==ha)return!0;var e,r=t.map,n=t.originalEvent;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==ha&&(e=n.deltaY,ms&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=bs),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?Zh:Kh);var o=r.getView();if(this.mode_===Zh&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var s=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),s),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var r=-y(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),nh(e,r,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(ih),Jh=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qh=function(t){function e(e){var r=this,n=e||{},i=n;return i.stopDown||(i.stopDown=ps),(r=t.call(this,i)||this).anchor_=null,r.lastAngle_=void 0,r.rotating_=!1,r.rotationDelta_=0,r.threshold_=void 0!==n.threshold?n.threshold:.3,r.duration_=void 0!==n.duration?n.duration:250,r}return Jh(e,t),e.prototype.handleDragEvent=function(t){var e=0,r=this.targetPointers[0],n=this.targetPointers[1],i=Math.atan2(n.clientY-r.clientY,n.clientX-r.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Cu){var l=s.getViewport().getBoundingClientRect(),u=lh(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixelInternal(u),this.rotating_&&(s.render(),a.adjustRotationInternal(e,this.anchor_))}},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(uh),tf=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ef=function(t){function e(e){var r=this,n=e||{},i=n;return i.stopDown||(i.stopDown=ps),(r=t.call(this,i)||this).anchor_=null,r.duration_=void 0!==n.duration?n.duration:400,r.lastDistance_=void 0,r.lastScaleDelta_=1,r}return tf(e,t),e.prototype.handleDragEvent=function(t){var e=1,r=this.targetPointers[0],n=this.targetPointers[1],i=r.clientX-n.clientX,o=r.clientY-n.clientY,s=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e);var u=a.getViewport().getBoundingClientRect(),c=lh(this.targetPointers);c[0]-=u.left,c[1]-=u.top,this.anchor_=a.getCoordinateFromPixelInternal(c),a.render(),l.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(uh);function rf(t){var e=t||{},r=new Gl,n=new Xh(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&r.push(new Ch),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&r.push(new sh({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&r.push(new Ih({onFocusOnly:e.onFocusOnly,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&r.push(new Qh),(void 0===e.pinchZoom||e.pinchZoom)&&r.push(new ef({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(r.push(new qh),r.push(new Wh({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&r.push(new $h({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&r.push(new jh({duration:e.zoomDuration})),r}var nf=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),of=function(t){function e(e){return(e=V({},e)).controls||(e.controls=th()),e.interactions||(e.interactions=rf({onFocusOnly:!0})),t.call(this,e)||this}return nf(e,t),e.prototype.createRenderer=function(){return new kl(this)},e}(Yc);function sf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function af(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var lf=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];sf(this,t),this._listener=e,this._scope=r,this.eventKey_=CV(),this.once_=n}var e,r,n;return e=t,(r=[{key:"fire",value:function(t){var e=t;mV(e)||(e=[e]),this._listener.apply(this._scope,e)}},{key:"getEventKey",value:function(){return this.eventKey_}},{key:"isOnce",value:function(){return this.once_}},{key:"has",value:function(t,e){var r=!1;return r=vV(t)?this._listener===t&&this._scope===e:this.eventKey_===t,r}}])&&af(e.prototype,r),n&&af(e,n),t}();function uf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var cf=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.events_={}}var e,r,n;return e=t,(r=[{key:"add",value:function(t,e,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!_V(t)&&vV(e)&&(_V(this.events_[t])&&(this.events_[t]=[]),-1===this.indexOf(t,e,r))){var o=new lf(e,r,i);this.events_[t].push(o),n=o.getEventKey()}return n}},{key:"remove",value:function(t,e,r){var n=this.events_[t];if(!_V(n)){var i=this.indexOf(t,e,r);-1!==i&&n.splice(i,1)}}},{key:"removeByKey",value:function(t,e){var r=this.events_[t];if(!_V(r)){var n=r.map((function(t,r){var n=-1;return t.getEventKey()===e&&(n=r),n}));-1!==n&&r.splice(n,1)}}},{key:"fire",value:function(t,e){var r=this,n=[].concat(this.events_[t]);_V(n)||n.forEach((function(n){n.fire(e),!0===n.isOnce()&&r.remove(t,n.getEventKey())}))}},{key:"indexOf",value:function(t,e,r){var n=-1,i=this.events_[t];if(!_V(i))for(var o=0,s=i.length;o<s;o+=1)if(i[o].has(e,r)){n=o;break}return n}}])&&uf(e.prototype,r),n&&uf(e,n),t}();function hf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var ff=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventsManager_=new cf}var e,r,n;return e=t,(r=[{key:"on",value:function(t,e,r){return this.eventsManager_.add(t,e,r)}},{key:"once",value:function(t,e,r){return this.eventsManager_.add(t,e,r,!0)}},{key:"un",value:function(t,e,r){this.eventsManager_.remove(t,e,r)}},{key:"unByKey",value:function(t,e){this.eventsManager_.remove(t,e)}},{key:"fire",value:function(t,e){var r=e;_V(r)&&(r=[this]),this.eventsManager_.fire(t,r)}}])&&hf(e.prototype,r),n&&hf(e,n),t}(),pf=r(33),df=r.n(pf),gf=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yf=0,mf=1,_f=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{element:document.createElement("div"),render:n.render})||this).dragListenerKeys_=[],r.currentResolution_=void 0,r.direction_=yf,r.dragging_,r.heightLimit_=0,r.widthLimit_=0,r.startX_,r.startY_,r.thumbSize_=null,r.sliderInitialized_=!1,r.duration_=void 0!==n.duration?n.duration:200;var i=void 0!==n.className?n.className:"ol-zoomslider",o=document.createElement("button");o.setAttribute("type","button"),o.className=i+"-thumb "+Ja;var s=r.element;return s.className=i+" "+"ol-unselectable "+Qa,s.appendChild(o),s.addEventListener(Zl,r.handleDraggerStart_.bind(r),!1),s.addEventListener(Hl,r.handleDraggerDrag_.bind(r),!1),s.addEventListener(Kl,r.handleDraggerEnd_.bind(r),!1),s.addEventListener(ea,r.handleContainerClick_.bind(r),!1),o.addEventListener(ea,Ws,!1),r}return gf(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&e.render()},e.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,r=t.offsetHeight;if(0===e&&0===r)return this.sliderInitialized_=!1;var n=getComputedStyle(t);e-=parseFloat(n.paddingRight)+parseFloat(n.paddingLeft),r-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom);var i=t.firstElementChild,o=getComputedStyle(i),s=i.offsetWidth+parseFloat(o.marginRight)+parseFloat(o.marginLeft),a=i.offsetHeight+parseFloat(o.marginTop)+parseFloat(o.marginBottom);return this.thumbSize_=[s,a],e>r?(this.direction_=mf,this.widthLimit_=e-s):(this.direction_=yf,this.heightLimit_=r-a),this.sliderInitialized_=!0},e.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),r=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),n=this.getResolutionForPosition_(r),i=e.getConstrainedZoom(e.getZoomForResolution(n));e.animateInternal({zoom:i,duration:this.duration_,easing:Ru})},e.prototype.handleDraggerStart_=function(t){if(!this.dragging_&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var r=this.handleDraggerDrag_,n=this.handleDraggerEnd_,i=this.getMap().getOwnerDocument();this.dragListenerKeys_.push(fa(i,Hl,r,this),fa(i,Kl,n,this))}}},e.prototype.handleDraggerDrag_=function(t){if(this.dragging_){var e=t.clientX-this.startX_,r=t.clientY-this.startY_,n=this.getRelativePosition_(e,r);this.currentResolution_=this.getResolutionForPosition_(n),this.getMap().getView().setResolution(this.currentResolution_)}},e.prototype.handleDraggerEnd_=function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(da),this.dragListenerKeys_.length=0)},e.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),r=this.element.firstElementChild;this.direction_==mf?r.style.left=this.widthLimit_*e+"px":r.style.top=this.heightLimit_*e+"px"},e.prototype.getRelativePosition_=function(t,e){return y(this.direction_===mf?t/this.widthLimit_:e/this.heightLimit_,0,1)},e.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},e.prototype.getPositionForResolution_=function(t){return y(1-this.getMap().getView().getValueForResolutionFunction()(t),0,1)},e.prototype.render=function(t){if(t.frameState&&(this.sliderInitialized_||this.initSlider_())){var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}},e}(Xc);function vf(t){return(vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wf(t,e){return(wf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Sf(t);if(e){var i=Sf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ef(this,r)}}function Ef(t,e){return!e||"object"!==vf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sf(t){return(Sf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var If=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wf(t,e)}(o,t);var e,r,n,i=xf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,GV({},t,!0))).facadeMap_=null,e}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,t.getMapImpl().addControl(this)}},{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&bf(e.prototype,r),n&&bf(e,n),o}(_f),Of=function(t){throw new Error(t)};function Cf(t){return(Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pf(t,e){return(Pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kf(t);if(e){var i=kf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Lf(this,r)}}function Lf(t,e){return!e||"object"!==Cf(e)&&"function"!=typeof e?Mf(t):e}function Mf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kf(t){return(kf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pf(t,e)}(o,t);var e,r,n,i=Rf(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).impl_=t,!_V(e.impl_)&&vV(e.impl_.setFacadeObj)&&e.impl_.setFacadeObj(Mf(e)),e}return e=o,(r=[{key:"getImpl",value:function(){return this.impl_}},{key:"setImpl",value:function(t){this.impl_=t}},{key:"destroy",value:function(){!_V(this.impl_)&&vV(this.impl_.destroy)&&this.impl_.destroy()}}])&&Tf(e.prototype,r),n&&Tf(e,n),o}(ff),Af="added:map",Ff="added:panel",Df="added:layer",jf="added:wmc",Gf="added:kml",zf="added:wms",Uf="added:wfs",Bf="added:vectortile",Vf="removed:layer",qf="removed:map",Yf="added:wmts",Wf="activated",Xf="deactivated",Hf="show",Zf="hide",Kf="destroy",$f="select:features",Jf="unselect:features",Qf="hover:features",tp="leave:features",ep="load",rp="completed",np="change",ip="change:wmc",op="change:proj",sp="change:style",ap="change:zoom",lp="change:rotation",up="click",cp="move",hp={translations:{en:r(34),es:r(35)},lang:"es"},fp=function(t){return hp.translations[t]},pp=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hp.lang;return fp(e)[t]};function dp(t){return(dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yp(t,e){return(yp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=vp(t);if(e){var i=vp(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _p(this,r)}}function _p(t,e){return!e||"object"!==dp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vp(t){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yp(t,e)}(o,t);var e,r,n,i=mp(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=t;return r=i.call(this,n),dV(n.addTo)&&Of(pp("exception").addto_method),dV(n.getElement)&&Of(pp("exception").getelement_method),dV(n.isByDefault)&&(n.isByDefault=!0),r.name=e,r.map_=null,r.element_=null,r.activationBtn_=null,r.activated=!1,r.panel_=null,r.controls_=null,r}return e=o,(r=[{key:"setImpl",value:function(t){var e=t;dV(e.addTo)&&Of(pp("exception").addto_method),dV(e.getElement)&&Of(pp("exception").getelement_method),dV(e.isByDefault)&&(e.isByDefault=!0)}},{key:"addTo",value:function(t){var e=this;this.map_=t;var r=this.getImpl(),n=this.createView(t);n instanceof Promise?n.then((function(n){e.manageActivation(n),r.addTo(t,n),e.fire(Af)})):(this.manageActivation(n),r.addTo(t,n),this.fire(Af))}},{key:"createView",value:function(t){}},{key:"manageActivation",value:function(t){var e=this;this.element_=t,this.activationBtn_=this.getActivationButton(this.element_),_V(this.activationBtn_)||this.activationBtn_.addEventListener("click",(function(t){t.preventDefault(),e.activated?(e.deactivate(),e.activated=!1):(e.activate(),e.activated=!0)}),!1)}},{key:"getActivationButton",value:function(t){}},{key:"activate",value:function(){_V(this.element_)||this.element_.classList.add("activated"),dV(this.getImpl().activate)||this.getImpl().activate(),this.activated=!0,this.fire(Wf)}},{key:"deactivate",value:function(){_V(this.element_)||this.element_.classList.remove("activated"),dV(this.getImpl().deactivate)||this.getImpl().deactivate(),this.activated=!1,this.fire(Xf)}},{key:"getElement",value:function(){return this.getImpl().getElement()}},{key:"setPanel",value:function(t){this.panel_=t}},{key:"getPanel",value:function(){return this.panel_}},{key:"destroy",value:function(){rq(this.getElement())}}])&&gp(e.prototype,r),n&&gp(e,n),o}(Nf),wp=r(8),xp=r.n(wp);xp.a.registerHelper("gt",(function(t,e,r){return t>e?r.fn(this):r.inverse(this)})),xp.a.registerHelper("lt",(function(t,e,r){return t<e?r.fn(this):r.inverse(this)})),xp.a.registerHelper("eq",(function(t,e,r){return Object.equals(t,e)?r.fn(this):r.inverse(this)})),xp.a.registerHelper("oneword",(function(t,e){return/\s/g.test(YV(t))?e.inverse(this):e.fn(this)}));var Ep={},Sp=function(t,e){var r,n={};dV(e)||(n=HV(n,e.vars),r=e.parseToHtml);var i=xp.a.compile(t)(n);return!1!==r?NV(i):i},Ip=function(t,e){var r;return dV(e)||(r=e.scope),new Promise((function(n,i){var o=Ep[t];if(dV(o)){var s=t;dV(e)||!0!==e.jsonp||(s=function(t){var e=null;return _V(t)||(e=(e=M.config.MAPEA_URL.concat(M.config.TEMPLATES_PATH)).concat(t)),e}(t));var a=_V(e)&&!0===e.jsonp;uV(s,null,{jsonp:a}).then((function(e){o=xp.a.compile(e.text),Ep[t]=o,n.call(r,o)}))}else n.call(r,o)}))};function Op(t){return(Op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Mp(t);if(e){var i=Mp(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Lp(this,r)}}function Lp(t,e){return!e||"object"!==Op(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mp(t){return(Mp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pp(t,e)}(o,t);var e,r,n,i=Rp(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Cp(this,o);var r=new If(e);return t=i.call(this,r,o.NAME),dV(If)&&Of(pp("exception").panzoombar_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(df.a)}},{key:"equals",value:function(t){var e=t instanceof o;return e}}])&&Tp(e.prototype,r),n&&Tp(e,n),o}(bp);kp.NAME="panzoombar";var Np=kp,Ap="WMC",Fp="KML",Dp="WMS",jp="WFS",Gp="WMTS",zp="OSM",Up="Mapbox",Bp="GeoJSON",Vp="Vector",qp="MVT",Yp={WMC:Ap,KML:Fp,WMS:Dp,WFS:jp,WMTS:Gp,OSM:zp,Mapbox:Up,GeoJSON:Bp,Vector:Vp,MVT:qp},Wp=function(t){var e=SV(t,!0);return e="WMS_FULL"===e?Dp:"WFST"===e?jp:Object.keys(Yp).find((function(t){var r=Yp[t];return wV(r)&&SV(r,!0)===e})),Yp[e]},Xp=function(t){return-1!==[Ap,Fp,Dp,jp,Gp,qp].indexOf(Wp(t))};function Hp(t){return(Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Zp=/WMS\*.*/,Kp=/WMS_FULL\*.*/,$p=function(t){var e=t.parameter,r=t.attr,n=t.type,i=t.separator,o=t.normalized,s=void 0!==o&&o;return function(t,o){var a,l={boolean:function(t){return/^1|(true)$/i.test(t)},string:function(t){return t},int:function(t){return Number.parseInt(t,10)},float:function(t){return Number.parseFloat(t,10)},array_number:function(t){return t.split(i||"").map((function(t){return t.trim()})).map((function(t){return Number.parseFloat(t)}))}};if(wV(e)&&t.test(e)){var u=e.split("*")[o];_V(u)||(a=l[n](u))}else bV(e)?a=e[r]:Of("El parámetro no es de un tipo soportado: ".concat(Hp(e)));return wV(a)&&(a=a.trim()),!0===s&&(a=SV(a)),a}},Jp=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(t){var e=$p({parameter:t,type:"string",attr:"name"}),r=$p({parameter:t,type:"string",attr:"url"}),n=$p({parameter:t,type:"string",attr:"legend"}),i=$p({parameter:t,type:"boolean",attr:"transparent"}),o=$p({parameter:t,type:"boolean",attr:"tiled"}),s=$p({parameter:t,type:"array_number",attr:"maxExtent",separator:"_"}),a=$p({parameter:t,type:"string",attr:"version"});return Zp.test(t)||bV(t)?{type:"WMS",name:e(Zp,3),tiled:o(Zp,5),url:r(Zp,2),legend:n(Zp,1),transparent:i(Zp,4),maxExtent:s(Zp,6),version:a(Zp,7)}:{type:"WMS",url:r(Kp,1)}})),mV(t)||(e=e[0]),e};function Qp(t){return(Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var td=/KML\*.*/,ed=function(t){var e=t.parameter,r=t.attr,n=t.type,i=t.valueCmp,o=void 0===i?/^1|true/i:i,s=t.separator,a=t.normalized,l=void 0!==a&&a;return function(t,i){var a,u={boolean:function(t){return o.test(t)},boolean_eql:function(t){return void 0===t||"true"===t},string:function(t){return t},int:function(t){return Number.parseInt(t,10)},float:function(t){return Number.parseFloat(t,10)},array_number:function(t){return t.split(s||"").map((function(t){return t.trim()})).map((function(t){return Number.parseFloat(t)}))}};if(wV(e)&&t.test(e)){var c=e.split("*"),h=c[i];a=u[n](h),"extract"===r&&(a="false"!==(h=c.slice(-2,-1)[0])),"label"===r&&(a="false"!==(h=c.slice(-1)[0])),"url"!==r||"true"!==a&&"false"!==a&&void 0!==a||(a="")}else bV(e)?a=e[r]:Of("El parámetro no es de un tipo soportado: ".concat(Qp(e)));return wV(a)&&(a=a.trim()),!0===l&&(a=SV(a)),a}},rd=function(t){var e=t,r=[];_V(e)&&Of(pp("exception").no_param);var n=e;return mV(n)||(n=[n]),r=n.map((function(t){var e=ed({parameter:t,type:"string",attr:"name"}),r=ed({parameter:t,type:"string",attr:"url"}),n=ed({parameter:t,type:"boolean",attr:"extract"}),i=ed({parameter:t,type:"boolean_eql",attr:"label"});return td.test(t)?{type:Fp,name:e(td,1),url:r(td,2)+r(td,3),extract:n(td,4),label:i(td,5)}:{type:Fp,name:e(td),url:r(td),extract:n(td),label:i(td)}})),mV(e)||(r=r[0]),r};function nd(t){return(nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var id=/MAPBOX\*.*/,od=function(t){var e=t.parameter,r=t.attr,n=t.type,i=t.separator,o=t.normalized,s=void 0!==o&&o;return function(t,o){var a,l={boolean:function(t){return/^1|(true)$/i.test(t)},string:function(t){return t},int:function(t){return Number.parseInt(t,10)},float:function(t){return Number.parseFloat(t,10)},array_number:function(t){return t.split(i||"").map((function(t){return t.trim()})).map((function(t){return Number.parseFloat(t)}))}};if(wV(e)&&t.test(e)){var u=e.split("*")[o];_V(u)||(a=l[n](u))}else bV(e)?a=e[r]:Of("El parámetro no es de un tipo soportado: ".concat(nd(e)));return wV(a)&&(a=a.trim()),!0===s&&(a=SV(a)),a}},sd=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(t){var e=od({parameter:t,type:"string",attr:"name"})(id,1),r=od({parameter:t,type:"string",attr:"legend"})(id,3),n=od({parameter:t,type:"boolean",attr:"transparent"})(id,2),i=function(t){var e;return wV(t)?e=null:bV(t)&&!_V(t.accessToken)?e=t.accessToken.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(nd(t))),e}(t);return{type:Up,name:e,legend:r,transparent:n,accessToken:i}})),mV(t)||(e=e[0]),e};function ad(t){return(ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ld=/OSM\.*/,ud=function(t){var e=t.parameter,r=t.attr,n=t.type,i=t.separator,o=t.normalized,s=void 0!==o&&o;return function(t,o){var a,l={boolean:function(t){return/^1|(true)$/i.test(t)},string:function(t){return t},int:function(t){return Number.parseInt(t,10)},float:function(t){return Number.parseFloat(t,10)},array_number:function(t){return t.split(i||"").map((function(t){return t.trim()})).map((function(t){return Number.parseFloat(t)}))}};if(wV(e)&&t.test(e)){var u=e.split("*")[o];_V(u)||(a=l[n](u))}else bV(e)?a=e[r]:Of("El parámetro no es de un tipo soportado: ".concat(ad(e)));return wV(a)&&(a=a.trim()),!0===s&&(a=SV(a)),a}},cd=function(t){var e=t,r=[];_V(e)&&(e={type:zp,name:"osm"});var n=e;return mV(n)||(n=[n]),r=n.map((function(t){return{type:"OSM",transparent:ud({parameter:t,type:"string",attr:"name"})(ld,1),legend:ud({parameter:t,type:"string",name:"legend"})(ld,2)}})),mV(e)||(r=r[0]),r};function hd(t){return(hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var fd=/^GeoJSON(T)?\*.*/,pd=function(t){var e=t.parameter,r=t.attr,n=t.type,i=t.separator,o=t.normalized,s=void 0!==o&&o;return function(t,o){var a,l={boolean:function(t){return/^1|(true)$/i.test(t)},string:function(t){return t},int:function(t){return Number.parseInt(t,10)},float:function(t){return Number.parseFloat(t,10)},array_number:function(t){return t.split(i||"").map((function(t){return t.trim()})).map((function(t){return Number.parseFloat(t)}))}};if(wV(e)&&t.test(e)){var u=e.split("*")[o];_V(u)||(a=l[n](u))}else bV(e)?a=e[r]:Of("El parámetro no es de un tipo soportado: ".concat(hd(e)));return wV(a)&&(a=a.trim()),!0===s&&(a=SV(a)),a}},dd=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(t){return{type:"GeoJSON",name:pd({parameter:t,type:"string",attr:"name"})(fd,1),url:pd({parameter:t,type:"string",attr:"name"})(fd,2),extract:pd({parameter:t,type:"boolean",attr:"extract"})(fd,3),style:pd({parameter:t,type:"string",attr:"style"})(fd,4)}})),mV(t)||(e=e[0]),e};function gd(t){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var yd=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(t){var e,r,n={};return n.type=Ap,n.name=(wV(e=t)?/^\w{3,7}\*[^*]+\*[^*]+$/.test(e)?r=e.split(/\*/)[2].trim():/^\w{3,7}\*[^*]$/.test(e)||/^[^*]+\*[^*]+$/.test(e)?r=e.split(/\*/)[1].trim():/^[^*]+$/.test(e)&&!xV(e)&&(r=e):bV(e)?r=SV(e.name):Of("El parámetro no es de un tipo soportado: ".concat(gd(e))),xV(r)&&(r=null),r),n.url=function(t){var e;if(wV(t)){var r=t.match(/^([^*]*\*)*(https?:\/\/[^*]+)([^*]*\*?)*$/i);r&&r.length>2&&(e=r[2])}else bV(t)?e=t.url:Of("El parámetro no es de un tipo soportado: ".concat(gd(t)));return e}(t),n.options=function(t){var e;return wV(t)||(bV(t)?e=t.options:Of("El parámetro no es de un tipo soportado: ".concat(gd(t)))),e}(t),n})),mV(t)||(e=e[0]),e};function md(t){return(md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _d=function(t){var e=t,r={};if(_V(e)&&Of(pp("exception").no_center),wV(e))if(e=SV(e),/^-?\d+(\.\d+)?[,;]-?\d+(\.\d+)?([*](true|false))?$/i.test(e)){var n=e.split(/\*/),i=n[0],o=n[1],s=i.split(/[,;]+/);2===s.length?(r.x=Number.parseFloat(s[0]),r.y=Number.parseFloat(s[1])):Of(pp("exception").invalid_center_param),r.draw=/^1|(true)$/i.test(o)}else Of(pp("exception").invalid_center_param);else mV(e)?2===e.length||3===e.length?(wV(e[0])&&(e[0]=Number.parseFloat(e[0])),wV(e[1])&&(e[1]=Number.parseFloat(e[1])),r.x=e[0],r.y=e[1]):Of(pp("exception").invalid_center_param):bV(e)?(yV(e.x)?Of(pp("exception").invalid_center_param):(wV(e.x)&&(e.x=Number.parseFloat(e.x)),r.x=e.x),yV(e.y)?Of(pp("exception").invalid_center_param):(wV(e.y)&&(e.y=Number.parseFloat(e.y)),r.y=e.y),yV(e.draw)?r.draw=!1:r.draw=/^true$/.test(e.draw)):Of("El parámetro no es de un tipo soportado: ".concat("undefined"==typeof maxExtentParameter?"undefined":md(maxExtentParameter)));return(Number.isNaN(r.x)||Number.isNaN(r.y))&&Of(pp("exception").invalid_center_param),r},vd=function(t){var e,r=t;if(!_V(r)){if(e={x:{},y:{}},_V(r)&&Of(pp("exception").no_maxextent),wV(r))if(/^\s*-?\d+(\.\d+)?\s*[,;]\s*-?\d+(\.\d+)?\s*[,;]\s*-?\d+(\.\d+)?\s*[,;]\s*-?\d+(\.\d+)?$/.test(r)){var n=r.split(/[,;]+/);4===n.length?(e.x.min=Number.parseFloat(n[0]),e.y.min=Number.parseFloat(n[1]),e.x.max=Number.parseFloat(n[2]),e.y.max=Number.parseFloat(n[3])):Of(pp("exception").invalid_maxextent_param)}else Of(pp("exception").invalid_maxextent_param);else mV(r)?4===r.length?(wV(r[0])&&(r[0]=Number.parseFloat(r[0])),wV(r[1])&&(r[1]=Number.parseFloat(r[1])),wV(r[2])&&(r[2]=Number.parseFloat(r[2])),wV(r[3])&&(r[3]=Number.parseFloat(r[3])),e.x.min=r[0],e.y.min=r[1],e.x.max=r[2],e.y.max=r[3]):Of(pp("exception").invalid_maxextent_param):bV(r)?(yV(r.left)?yV(r.x.min)?Of(pp("exception").invalid_maxextent_param):(wV(r.x.min)&&(r.x.min=Number.parseFloat(r.x.min)),e.x.min=r.x.min):(wV(r.left)&&(r.left=Number.parseFloat(r.left)),e.x.min=r.left),yV(r.bottom)?yV(r.y.min)?Of(pp("exception").invalid_maxextent_param):(wV(r.y.min)&&(r.y.min=Number.parseFloat(r.y.min)),e.y.min=r.y.min):(wV(r.bottom)&&(r.bottom=Number.parseFloat(r.bottom)),e.y.min=r.bottom),yV(r.right)?yV(r.x.max)?Of(pp("exception").invalid_maxextent_param):(wV(r.x.max)&&(r.x.max=Number.parseFloat(r.x.max)),e.x.max=r.x.max):(wV(r.right)&&(r.right=Number.parseFloat(r.right)),e.x.max=r.right),yV(r.top)?yV(r.y.max)?Of(pp("exception").invalid_maxextent_param):(wV(r.y.max)&&(r.y.max=Number.parseFloat(r.y.max)),e.y.max=r.y.max):(wV(r.top)&&(r.top=Number.parseFloat(r.top)),e.y.max=r.top)):Of("El parámetro no es de un tipo soportado: ".concat(md(r)));(Number.isNaN(e.x.min)||Number.isNaN(e.y.min)||Number.isNaN(e.x.max)||Number.isNaN(e.y.max))&&Of(pp("exception").invalid_maxextent_param)}return e},bd=function(t){var e={code:null,units:null};if(_V(t)&&Of(pp("exception").no_projection),wV(t))if(/^(EPSG:)?\d+\*((d(egrees)?)|(m(eters)?))$/i.test(t)){var r=t.split(/\*/);e.code=r[0],e.units=SV(r[1].substring(0,1))}else Of("El formato del parámetro projection no es correcto. </br>Se usará la proyección por defecto: ".concat(M.config.DEFAULT_PROJ));else bV(t)?yV(t.code)||yV(t.units)?Of("El formato del parámetro projection no es correcto. </br>Se usará la proyección por defecto: ".concat(M.config.DEFAULT_PROJ)):(e.code=t.code,e.units=SV(t.units.substring(0,1))):Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return"m"!==e.units&&"d"!==e.units&&Of('La unidad "'.concat(t.units,'" del parámetro projection no es válida. Las disponibles son: "m" o "d"')),e},wd=function(t){var e=t,r=[];_V(e)&&Of(pp("exception").no_resolutions),wV(e)&&(/^\d+(\.\d+)?([,;]\d+(\.\d+)?)*$/.test(e)?e=e.split(/[,;]+/):Of(pp("exception").invalid_resolutions_param)),mV(e)?r=e.map((function(t){return wV(t)?Number.parseFloat(t):t})):Of("El parámetro no es de un tipo soportado: ".concat(md(e)));for(var n=!0,i=0,o=r.length;i<o&&n;i+=1)n=!Number.isNaN(r[i]);return n||Of(pp("exception").invalid_resolutions_param),r},xd=function(t){var e,r=t;return _V(r)&&Of(pp("exception").no_zoom),wV(r)?e=Number.parseInt(r,10):"number"==typeof r?e=r:Of("El parámetro no es de un tipo soportado: ".concat(md(r))),Number.isNaN(e)&&Of(pp("exception").invalid_zoom_param),e},Ed=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(e){var r,n,i={};return i.type=jp,i.name=(wV(r=e)?/^WFS(T)?\*.+/i.test(r)?/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+/i.test(r)||/^[^*]*\*[^*]+:[^*]+/.test(r)?n=r.split(/\*/)[3].trim().split(":")[1]:/^WFS(T)?\*[^*]*\*[^*]+[^*]+/i.test(r)&&(n=r.split(/\*/)[3].trim()):/^[^*]*\*[^*]+:[^*]+/.test(r)&&(n=r.split(/\*/)[1].trim().split(":")[1]):bV(r)&&!_V(r.name)?n=r.name.trim():bV(r)||Of("El parámetro no es de un tipo soportado: ".concat(md(r))),(xV(n)||/^(true|false)$/i.test(n))&&(n=null),n),i.url=function(t){var e;if(wV(t)){var r=t.match(/^([^*]*\*)*(https?:\/\/[^*]+)([^*]*\*?)*$/i);r&&r.length>2&&(e=r[2])}else bV(t)?e=t.url:Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(e),i.namespace=function(t){var e;return wV(t)?/^WFS(T)?\*.+/i.test(t)?/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+/i.test(t)&&(e=t.split(/\*/)[3].trim().split(":")[0]):/^[^*]*\*[^*]+:[^*]+/.test(t)&&(e=t.split(/\*/)[1].trim().split(":")[0]):bV(t)&&!_V(t.namespace)?e=t.namespace.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(xV(e)||/^(true|false)$/i.test(e))&&(e=null),e}(e),i.legend=function(t){var e;return wV(t)?/^WFS(T)?\*[^*]/i.test(t)?e=t.split(/\*/)[1].trim():/^[^*]+\*[^*]+:[^*]+\*[^*]+/.test(t)&&(e=t.split(/\*/)[2].trim()):bV(t)&&!_V(t.legend)?e=t.legend.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(xV(e)||/^(true|false)$/i.test(e))&&(e=null),e}(e),i.cql=function(t){var e;return wV(t)?(/^[^*]+\*[^*]+:[^*]+\*[^*]+\*[^*]+/i.test(t)&&(e=t.split(/\*/)[3].trim()),/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+\*[^*]+\*[^*]*\*[^*]*/i.test(t)&&(e=t.split(/\*/)[6].trim())):bV(t)&&!_V(t.cql)||!_V(t.ecql)?e=t.cql?t.cql.trim():t.ecql.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(/^(true|false)$/i.test(e)||/^\d\.\d\.\d$/.test(e))&&(e=void 0),e}(e),i.geometry=function(t){var e;return wV(t)?/^WFS(T)?\*.+/i.test(t)&&(/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+\*[^*]+/i.test(t)||/^WFS(T)?\*[^*]*\*[^*][^*]+\*[^*]+/i.test(t))&&(e=t.split(/\*/)[4].trim()):bV(t)&&!_V(t.geometry)?e=t.geometry.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(xV(e)||/^(true|false)$/i.test(e))&&(e=null),e}(e),i.ids=function(t){var e;return wV(t)?/^WFS(T)?\*.+/i.test(t)&&(/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+\*[^*]+\*(.-?)+$/i.test(t)||/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+\*[^*]+\*(.-?)+$/i.test(t))&&(e=t.split(/\*/)[5].trim().split("-")):bV(t)&&!_V(t.ids)?e=t.ids:bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),xV(e)&&(e=null),_V(e)||mV(e)||(e=[e]),e}(e),i.version=function(t){var e;return wV(t)?/(\d\.\d\.\d)$/.test(t)&&(e=t.match(/\d\.\d\.\d$/)[0]):bV(t)?e=t.version:Of("El parámetro no es de un tipo soportado: ".concat(md(t))),e}(e),i.style=function(t){var e;return wV(t)?/^WFS(T)?\*.+/i.test(t)&&/^WFS(T)?\*[^*]*\*[^*]+\*[^*]+:[^*]+\*[^*]+\*[^*]*\*[^*]*\*[^*]*/i.test(t)&&(e=t.split(/\*/)[7].trim()):bV(t)&&!_V(t.style)?e=t.style:bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),e}(e),i.options=function(t){var e;return wV(t)||(bV(t)?e=t.options:Of("El parámetro no es de un tipo soportado: ".concat(md(t)))),e}(e),i.outputFormat=t.outputFormat,i})),mV(t)||(e=e[0]),e},Sd=function(t){var e=[];_V(t)&&Of("No ha especificado ningún parámetro");var r=t;return mV(r)||(r=[r]),e=r.map((function(t){var e={};return e.type=qp,e.name=function(t){var e;if(wV(t)){if(/^MVT\*.+/i.test(t)){var r=t.match(/.*\*(https?:\/\/[^*]+)\*([^*]+)/i);r&&r.length>2&&(e=r[2])}}else bV(t)&&!_V(t.name)?e=t.name.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(t),e.url=function(t){var e;if(wV(t)){if(/^MVT\*.+/i.test(t)){var r=t.match(/.*\*(https?:\/\/[^*]+).*/i);r&&r.length>1&&(e=r[1])}}else bV(t)&&!_V(t.url)?e=t.url.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(t),e.mode=function(t){var e;if(wV(t)){if(/^MVT\*.+/i.test(t)){var r=t.match(/.*\*(https?:\/\/[^*]+)\*([^*]+)\*([^*]+)/i);r&&r.length>3&&(e=r[3])}}else bV(t)&&!_V(t.mode)?e=t.mode.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(t),e.projection=function(t){var e;if(wV(t)){if(/^MVT\*.+/i.test(t)){var r=t.match(/.*\*(https?:\/\/[^*]+)\*([^*]+)\*([^*]+)\*([^*]+)/i);r&&r.length>4&&(e=r[4])}}else bV(t)&&!_V(t.proj)?e=t.proj.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(t),e})),mV(t)||(e=e[0]),e},Id=function(t){var e=[];_V(t)&&Of(pp("exception").no_param);var r=t;return mV(r)||(r=[r]),e=r.map((function(t){var e,r,n={};return n.type=Gp,n.name=(wV(e=t)?/^WMTS\*.+/i.test(e)?/^WMTS\*[^*]+\*[^*]+/i.test(e)&&(r=e.split(/\*/)[2].trim()):/^[^*]*\*[^*]+/.test(e)&&(r=e.split(/\*/)[1].trim()):bV(e)&&!_V(e.name)?r=e.name.trim():bV(e)||Of("El parámetro no es de un tipo soportado: ".concat(md(e))),(xV(r)||/^(true|false)$/i.test(r))&&(r=null),r),n.url=function(t){var e;if(wV(t)){var r=t.match(/^([^*]*\*)*(https?:\/\/[^*]+)([^*]*\*?)*$/i);r&&r.length>2&&(e=r[2])}else bV(t)?e=t.url:Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return e}(t),n.matrixSet=function(t){var e,r;return wV(t)?/^WMTS\*[^*]+\*[^*]+(\*[^*]])*/i.test(t)?e=(r=t.split(/\*/))[3]?r[3].trim():null:/^[^*]+\*[^*]+\*[^*]+/.test(t)&&(e=(r=t.split(/\*/))[2].trim()):bV(t)&&!_V(t.matrixSet)?e=t.matrixSet.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(xV(e)||/^(true|false)$/i.test(e))&&(e=null),e}(t),n.legend=function(t){var e;return wV(t)?/^WMTS\*.+/i.test(t)?/^WMTS\*[^*]+\*[^*]+\*[^*]*\*[^*]+/i.test(t)&&(e=t.split(/\*/)[4].trim()):/^[^*]+\*[^*]+\*[^*]*\*[^*]+/.test(t)&&(e=t.split(/\*/)[3].trim()):bV(t)&&!_V(t.legend)?e=t.legend.trim():bV(t)||Of("El parámetro no es de un tipo soportado: ".concat(md(t))),(xV(e)||/^(true|false)$/i.test(e))&&(e=null),e}(t),n.options=function(t){var e;return wV(t)||(bV(t)?e=t.options:Of("El parámetro no es de un tipo soportado: ".concat(md(t)))),e}(t),n.transparent=function(t){var e;return wV(t)?/^WMTS\*[^*]+\*[^*]+\*[^*]*\*[^*]*\*(true|false)/i.test(t)?e=t.split(/\*/)[5].trim():/^WMS_FULL\*[^*]+(\*(true|false))?/i.test(t)?(t.split(/\*/),e=!0):/^[^*]+\*[^*]+\*[^*]+\*(true|false)/i.test(t)?e=t.split(/\*/)[3].trim():/^[^*]+\*[^*]+\*(true|false)/i.test(t)&&(e=t.split(/\*/)[2].trim()):bV(t)?e=SV(t.transparent):Of("El parámetro no es de un tipo soportado: ".concat(md(t))),_V(e)||(e=/^1|(true)$/i.test(e)),e}(t),n})),mV(t)||(e=e[0]),e},Od={kml:rd,mapbox:sd,osm:cd,wfs:Ed,wmc:yd,wms:Jp,wmts:Id,geojson:dd,mvt:Sd},Cd=function(t,e){var r=[];_V(t)&&Of(pp("exception").no_param);var n=t;return mV(n)||(n=[n]),r=n.map((function(t){var r=null;if(bV(t)&&t instanceof Ad)r=t;else{var n=function(t,e){var r;if(wV(t))if(/^\s*osm\s*$/i.test(t))r=zp;else if(/^\s*mapbox\*.+$/i.test(t))r=Up;else{var n=t.match(/^(\w+)\*.+$/);n&&n.length>1&&(r=Wp(n[1]),dV(r)&&Of("No se reconoce el tipo de capa ".concat(n[1]))),dV(r)&&!_V(e)?r=e:dV(r)&&Of("No se reconoce el tipo de capa ".concat(r))}else bV(t)?_V(t.type)||(r=Wp(t.type),dV(r)&&Of("No se reconoce el tipo de capa ".concat(r))):Of("El parámetro no es de un tipo soportado: ".concat(md(t)));return _V(r)||_V(e)||r===e||Of("El tipo de la capa (".concat(r).concat(") no era el esperado (").concat(e).concat(")")),_V(r)&&!_V(e)&&(r=e),r}(t,e);n=SV(n),r=vV(Od[n])?Od[n](t):t}return r})),mV(t)||(r=r[0]),r};function Td(t){return(Td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pd(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rd(t,e){return(Rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ld(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kd(t);if(e){var i=kd(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Md(this,r)}}function Md(t,e){return!e||"object"!==Td(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kd(t){return(kd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rd(t,e)}(o,t);var e,r,n,i=Ld(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r=i.call(this,e);var n=Cd(t);return r.type=n.type,r.url=n.url,r.name=n.name,r.transparent=n.transparent,r.maxExtent_=null,r.zindex_=null,r.minScale_=t.minScale,r.maxScale_=t.maxScale,r.map_=null,r.userMaxExtent=n.maxExtent,r.legend=n.legend,r.layerGroup_=null,r}return e=o,(r=[{key:"getLegend",value:function(){return this.getImpl().legend}},{key:"setLegend",value:function(t){this.legend=t,this.getImpl().legend=t}},{key:"getMaxExtent",value:function(){var t=this.userMaxExtent;return _V(t)&&(t=this.map_.userMaxExtent,_V(t)&&(t=this.map_.getProjection().getExtent())),t}},{key:"calculateMaxExtent",value:function(){var t=this;return new Promise((function(e){return e(t.getMaxExtent())}))}},{key:"setMaxExtent",value:function(t){this.userMaxExtent=t,!mV(t)&&bV(t)&&(this.userMaxExtent=[t.x.min,t.y.min,t.x.max,t.y.max]),vV(this.getImpl().setMaxExtent)&&(_V(t)?this.resetMaxExtent():this.getImpl().setMaxExtent(t))}},{key:"resetMaxExtent",value:function(){var t=this;this.userMaxExtent=null,this.calculateMaxExtent().then((function(e){vV(t.getImpl().setMaxExtent)&&t.getImpl().setMaxExtent(e)}))}},{key:"setMap",value:function(t){this.map_=t}},{key:"getLayerGroup",value:function(){return this.layerGroup_}},{key:"setLayerGroup",value:function(t){this.layerGroup_=t}},{key:"isVisible",value:function(){return dV(this.getImpl().isVisible)&&Of(pp("exception").isvisible_method),this.getImpl().isVisible()}},{key:"isQueryable",value:function(){return dV(this.getImpl().isQueryable)&&Of(pp("exception").isqueryable_method),this.getImpl().isQueryable()}},{key:"setVisible",value:function(t){var e=t;_V(e)&&Of(pp("exception").visibility_param),wV(e)||gV(e)||Of(pp("exception").visibility_param),dV(this.getImpl().setVisible)&&Of(pp("exception").setvisible_method),e=/^1|(true)$/i.test(e),this.getImpl().setVisible(e)}},{key:"inRange",value:function(){return dV(this.getImpl().inRange)&&Of(pp("exception").inrage_method),this.getImpl().inRange()}},{key:"getLegendURL",value:function(){return this.getImpl().getLegendURL()}},{key:"setLegendURL",value:function(t){var e=t;_V(e)&&(e=DV([M.config.THEME_URL,o.LEGEND_DEFAULT])),this.getImpl().setLegendURL(e)}},{key:"getZIndex",value:function(){return this.zindex_}},{key:"setZIndex",value:function(t){this.zindex_=t,this.getImpl().setZIndex(t)}},{key:"getMinScale",value:function(){return this.minScale_}},{key:"setMinScale",value:function(t){this.minScale_=t,this.getImpl().setMinScale(t)}},{key:"getMaxScale",value:function(){return this.maxScale_}},{key:"setMaxScale",value:function(t){this.maxScale_=t,this.getImpl().setMaxScale(t)}},{key:"getOpacity",value:function(){return this.getImpl().getOpacity()}},{key:"setOpacity",value:function(t){this.getImpl().setOpacity(t)}},{key:"refresh",value:function(){!dV(this.getImpl().refresh)&&vV(this.getImpl().refresh)&&this.getImpl().refresh()}},{key:"generateName_",value:function(){this.name=CV("layer_","_".concat(this.type))}},{key:"url",get:function(){return this.getImpl().url},set:function(t){this.getImpl().url=t}},{key:"name",get:function(){return this.getImpl().name},set:function(t){this.getImpl().name=t}},{key:"transparent",get:function(){return this.getImpl().transparent},set:function(t){_V(t)?this.getImpl().transparent=!0:wV(t)?this.getImpl().transparent="true"===SV(t):this.getImpl().transparent=t}},{key:"displayInLayerSwitcher",get:function(){return this.getImpl().displayInLayerSwitcher},set:function(t){_V(t)?this.getImpl().displayInLayerSwitcher=!0:wV(t)?this.getImpl().displayInLayerSwitcher="true"===SV(t):this.getImpl().displayInLayerSwitcher=t}}])&&Pd(e.prototype,r),n&&Pd(e,n),o}(Nf);Nd.LEGEND_DEFAULT="/img/legend-default.png",Nd.LEGEND_ERROR="/img/legend-error.png";var Ad=Nd,Fd="preload",Dd="useInterimTilesOnError",jd=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gd=function(t){function e(e){var r=this,n=e||{},i=V({},n);return delete i.preload,delete i.useInterimTilesOnError,(r=t.call(this,i)||this).on,r.once,r.un,r.setPreload(void 0!==n.preload?n.preload:0),r.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),r}return jd(e,t),e.prototype.getPreload=function(){return this.get(Fd)},e.prototype.setPreload=function(t){this.set(Fd,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Dd)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Dd,t)},e}(Ya),zd=0,Ud=1,Bd=2,Vd=3,qd=4,Yd=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wd=function(t){function e(e){var r=t.call(this)||this;return r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r.declutterExecutorGroup=null,r}return Yd(e,t),e.prototype.getFeatures=function(t){return Object(st.b)()},e.prototype.prepareFrame=function(t){return Object(st.b)()},e.prototype.renderFrame=function(t,e){return Object(st.b)()},e.prototype.loadedTileCallback=function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,e,r){return function(n,i){var o=this.loadedTileCallback.bind(this,r,n);return t.forEachLoadedTile(e,n,i,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){},e.prototype.getDataAtPixel=function(t,e,r){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===Bd&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=Bd&&e!=Vd&&t.addEventListener($s,this.boundHandleImageChange_),e==zd&&(t.load(),e=t.getState()),e==Bd},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Ua&&t.changed()},e}(_a),Xd=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hd=function(t){function e(e){var r=t.call(this,e)||this;return r.container=null,r.renderedResolution,r.tempTransform=[1,0,0,1,0,0],r.pixelTransform=[1,0,0,1,0,0],r.inversePixelTransform=[1,0,0,1,0,0],r.context=null,r.containerReused=!1,r}return Xd(e,t),e.prototype.useContainer=function(t,e,r){var n,i,o=this.getLayer().getClassName();t&&t.style.opacity===il(r)&&t.className===o&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(i=a.getContext("2d")));if(i&&i.canvas.style.transform===e?(this.container=t,this.context=i,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=o;var s=n.style;s.position="absolute",s.width="100%",s.height="100%";var a=(i=ol()).canvas;n.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=n,this.context=i}},e.prototype.clipUnrotated=function(t,e,r){var n=Dt(r),i=jt(r),o=Lt(r),s=Rt(r);Ts(e.coordinateToPixelTransform,n),Ts(e.coordinateToPixelTransform,i),Ts(e.coordinateToPixelTransform,o),Ts(e.coordinateToPixelTransform,s);var a=this.inversePixelTransform;Ts(a,n),Ts(a,i),Ts(a,o),Ts(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,r){var n=this.getLayer();if(n.hasListener(t)){var i=new Ka(t,this.inversePixelTransform,r,e);n.dispatchEvent(i)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Na,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Aa,t,e)},e.prototype.getRenderTransform=function(t,e,r,n,i,o,s){var a=i/2,l=o/2,u=n/e,c=-u,h=-t[0]+s,f=-t[1];return Rs(this.tempTransform,a,l,u,c,-r,h,f)},e.prototype.getDataAtPixel=function(t,e,r){var n,i=Ts(this.inversePixelTransform,t.slice()),o=this.context,s=this.getLayer().getExtent();if(s&&!dt(s,Ts(e.pixelToCoordinateTransform,t.slice())))return null;try{var a=Math.round(i[0]),l=Math.round(i[1]),u=document.createElement("canvas"),c=u.getContext("2d");u.width=1,u.height=1,c.clearRect(0,0,1,1),c.drawImage(o.canvas,a,l,1,1,0,0,1,1),n=c.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e}(Wd),Zd=function(){function t(t,e,r,n){this.minX=t,this.maxX=e,this.minY=r,this.maxY=n}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Kd(t,e,r,n,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=r,i.maxY=n,i):new Zd(t,e,r,n)}var $d=Zd,Jd=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qd=function(t){function e(e){var r=t.call(this,e)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=[1/0,1/0,-1/0,-1/0],r.tmpTileRange_=new $d(0,0,0,0),r}return Jd(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),r=t.getState(),n=e.getUseInterimTilesOnError();return r==hu||r==pu||r==fu&&!n},e.prototype.getTile=function(t,e,r,n){var i=n.pixelRatio,o=n.viewState.projection,s=this.getLayer(),a=s.getSource().getTile(t,e,r,i,o);return a.getState()==fu&&(s.getUseInterimTilesOnError()?s.getPreload()>0&&(this.newTiles_=!0):a.setState(hu)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},e.prototype.loadedTileCallback=function(e,r,n){return!!this.isDrawableTile(n)&&t.prototype.loadedTileCallback.call(this,e,r,n)},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,e){var r=t.layerStatesArray[t.layerIndex],n=t.viewState,i=n.projection,o=n.resolution,s=n.center,a=n.rotation,l=t.pixelRatio,u=this.getLayer(),c=u.getSource(),h=c.getRevision(),f=c.getTileGridForProjection(i),p=f.getZForResolution(o,c.zDirection),d=f.getResolution(p),g=t.extent,y=r.extent&&Fe(r.extent,i);y&&(g=Ft(g,Fe(r.extent,i)));var m=c.getTilePixelRatio(l),_=Math.round(t.size[0]*m),v=Math.round(t.size[1]*m);if(a){var b=Math.round(Math.sqrt(_*_+v*v));_=b,v=b}var w=d*_/2/m,x=d*v/2/m,E=[s[0]-w,s[1]-x,s[0]+w,s[1]+x],S=f.getTileRangeForExtentAndZ(g,p),I={};I[p]={};var O=this.createLoadedTileFinder(c,i,I),C=this.tmpExtent,T=this.tmpTileRange_;this.newTiles_=!1;for(var P=S.minX;P<=S.maxX;++P)for(var R=S.minY;R<=S.maxY;++R){var L=this.getTile(p,P,R,t);if(this.isDrawableTile(L)){var M=Object(st.c)(this);if(L.getState()==hu){I[p][L.tileCoord.toString()]=L;var k=L.inTransition(M);this.newTiles_||!k&&-1!==this.renderedTiles.indexOf(L)||(this.newTiles_=!0)}if(1===L.getAlpha(M,t.time))continue}var N=f.getTileCoordChildTileRange(L.tileCoord,T,C),A=!1;N&&(A=O(p+1,N)),A||f.forEachTileCoordParentTileRange(L.tileCoord,O,T,C)}var F=d/o;Rs(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,a,-_/2,-v/2);var D=Ms(this.pixelTransform);this.useContainer(e,D,r.opacity);var j=this.context,G=j.canvas;Ls(this.inversePixelTransform,this.pixelTransform),Rs(this.tempTransform,_/2,v/2,F,F,0,-_/2,-v/2),G.width!=_||G.height!=v?(G.width=_,G.height=v):this.containerReused||j.clearRect(0,0,_,v),y&&this.clipUnrotated(j,t,y),V(j,c.getContextOptions()),this.preRender(j,t),this.renderedTiles.length=0;var z,U,B,q=Object.keys(I).map(Number);q.sort(ze),1!==r.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(z=[],U=[]):q=q.reverse();for(var Y=q.length-1;Y>=0;--Y){var W=q[Y],X=c.getTilePixelSize(W,l,i),H=f.getResolution(W)/d,Z=X[0]*H*F,K=X[1]*H*F,$=f.getTileCoordForCoordAndZ(Dt(E),W),J=f.getTileCoordExtent($),Q=Ts(this.tempTransform,[m*(J[0]-E[0])/d,m*(E[3]-J[3])/d]),tt=m*c.getGutterForProjection(i),et=I[W];for(var rt in et){var nt=(L=et[rt]).tileCoord,it=$[1]-nt[1],ot=Math.round(Q[0]-(it-1)*Z),at=$[2]-nt[2],lt=Math.round(Q[1]-(at-1)*K),ut=ot-(P=Math.round(Q[0]-it*Z)),ct=lt-(R=Math.round(Q[1]-at*K)),ht=p===W;if(!(k=ht&&1!==L.getAlpha(Object(st.c)(this),t.time)))if(z){j.save(),B=[P,R,P+ut,R,P+ut,R+ct,P,R+ct];for(var ft=0,pt=z.length;ft<pt;++ft)if(p!==W&&W<U[ft]){var dt=z[ft];j.beginPath(),j.moveTo(B[0],B[1]),j.lineTo(B[2],B[3]),j.lineTo(B[4],B[5]),j.lineTo(B[6],B[7]),j.moveTo(dt[6],dt[7]),j.lineTo(dt[4],dt[5]),j.lineTo(dt[2],dt[3]),j.lineTo(dt[0],dt[1]),j.clip()}z.push(B),U.push(W)}else j.clearRect(P,R,ut,ct);this.drawTileImage(L,t,P,R,ut,ct,tt,ht),z&&!k?(j.restore(),this.renderedTiles.unshift(L)):this.renderedTiles.push(L),this.updateUsedTiles(t.usedTiles,c,L)}}this.renderedRevision=h,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Et(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=l,this.renderedProjection=i,this.manageTilePyramid(t,c,f,l,i,g,p,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(j,t),r.extent&&j.restore(),D!==G.style.transform&&(G.style.transform=D);var gt=il(r.opacity),yt=this.container;return gt!==yt.style.opacity&&(yt.style.opacity=gt),this.container},e.prototype.drawTileImage=function(t,e,r,n,i,o,s,a){var l=this.getTileImage(t);if(l){var u=Object(st.c)(this),c=a?t.getAlpha(u,e.time):1,h=c!==this.context.globalAlpha;h&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(l,s,s,l.width-2*s,l.height-2*s,r,n,i,o),h&&this.context.restore(),1!==c?e.animate=!0:a&&t.endTransition(u)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var r=function(t,e,r){var n=Object(st.c)(t);n in r.usedTiles&&t.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(r)}},e.prototype.updateUsedTiles=function(t,e,r){var n=Object(st.c)(e);n in t||(t[n]={}),t[n][r.getKey()]=!0},e.prototype.manageTilePyramid=function(t,e,r,n,i,o,s,a,l){var u=Object(st.c)(e);u in t.wantedTiles||(t.wantedTiles[u]={});var c,h,f,p,d,g,y=t.wantedTiles[u],m=t.tileQueue,_=0;for(g=r.getMinZoom();g<=s;++g)for(h=r.getTileRangeForExtentAndZ(o,g,h),f=r.getResolution(g),p=h.minX;p<=h.maxX;++p)for(d=h.minY;d<=h.maxY;++d)s-g<=a?(++_,(c=e.getTile(g,p,d,n,i)).getState()==uu&&(y[c.getKey()]=!0,m.isKeyQueued(c.getKey())||m.enqueue([c,u,r.getTileCoordCenter(c.tileCoord),f])),void 0!==l&&l(c)):e.useTile(g,p,d,i);e.updateCacheSize(_,i)},e}(Hd);Qd.prototype.getLayer;var tg=Qd,eg=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rg=function(t){function e(e){return t.call(this,e)||this}return eg(e,t),e.prototype.createRenderer=function(){return new tg(this)},e}(Gd),ng=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ig=function(t){function e(e){var r=e||{};return t.call(this,r)||this}return ng(e,t),e}(Ya),og=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sg=function(t){function e(e){var r=t.call(this,e)||this;return r.image_=null,r}return og(e,t),e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],r=t.pixelRatio,n=t.viewState,i=n.resolution,o=this.getLayer().getSource(),s=t.viewHints,a=t.extent;if(void 0!==e.extent&&(a=Ft(a,Fe(e.extent,n.projection))),!s[yu]&&!s[mu]&&!Ut(a))if(o){var l=n.projection,u=o.getImage(a,i,r,l);u&&this.loadImage(u)&&(this.image_=u)}else this.image_=null;return!!this.image_},e.prototype.renderFrame=function(t,e){var r=this.image_,n=r.getExtent(),i=r.getResolution(),o=r.getPixelRatio(),s=t.layerStatesArray[t.layerIndex],a=t.pixelRatio,l=t.viewState,u=l.center,c=l.resolution,h=t.size,f=a*i/(c*o),p=Math.round(h[0]*a),d=Math.round(h[1]*a),g=l.rotation;if(g){var y=Math.round(Math.sqrt(p*p+d*d));p=y,d=y}Rs(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/a,1/a,g,-p/2,-d/2),Ls(this.inversePixelTransform,this.pixelTransform);var m=Ms(this.pixelTransform);this.useContainer(e,m,s.opacity);var _=this.context,v=_.canvas;v.width!=p||v.height!=d?(v.width=p,v.height=d):this.containerReused||_.clearRect(0,0,p,d);var b=!1,w=!0;if(s.extent){var x=Fe(s.extent,l.projection);(b=(w=zt(x,t.extent))&&!gt(x,t.extent))&&this.clipUnrotated(_,t,x)}var E=r.getImage(),S=Rs(this.tempTransform,p/2,d/2,f,f,0,o*(n[0]-u[0])/i,o*(u[1]-n[3])/i);this.renderedResolution=i*a/o;var I=E.width*S[0],O=E.height*S[3];if(V(_,this.getLayer().getSource().getContextOptions()),this.preRender(_,t),w&&I>=.5&&O>=.5){var C=S[4],T=S[5],P=s.opacity,R=void 0;1!==P&&(R=_.globalAlpha,_.globalAlpha=P),_.drawImage(E,0,0,+E.width,+E.height,Math.round(C),Math.round(T),Math.round(I),Math.round(O)),1!==P&&(_.globalAlpha=R)}return this.postRender(_,t),b&&_.restore(),m!==v.style.transform&&(v.style.transform=m),this.container},e}(Hd),ag=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lg=function(t){function e(e){return t.call(this,e)||this}return ag(e,t),e.prototype.createRenderer=function(){return new sg(this)},e}(ig);function ug(t,e,r,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=r,n):[t,e,r]}function cg(t,e,r){return t+"/"+e+"/"+r}function hg(t){return cg(t[0],t[1],t[2])}function fg(t){return t.split("/").map(Number)}function pg(t){return(t[1]<<t[0])+t[2]}var dg=[0,0,0],gg=function(){function t(t){var e,r,n,i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,ut((e=this.resolutions_,r=!0,n=function(t,e){return e-t}||ze,e.every((function(t,i){if(0===i)return!0;var o=n(e[i-1],t);return!(o>0||r&&0===o)}))),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(i){if(this.resolutions_[o]/this.resolutions_[o+1]!==i){i=void 0;break}}else i=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,ut(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=Dt(a)),ut(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,ut(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:wu,ut(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){var r=new $d(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(a){var n=this.getTileRangeForExtentAndZ(a,e);r.minX=Math.max(n.minX,r.minX),r.maxX=Math.min(n.maxX,r.maxX),r.minY=Math.max(n.minY,r.minY),r.maxY=Math.min(n.maxY,r.maxY)}return r}),this):a&&this.calculateTileRanges_(a)}return t.prototype.forEachTileCoord=function(t,e,r){for(var n=this.getTileRangeForExtentAndZ(t,e),i=n.minX,o=n.maxX;i<=o;++i)for(var s=n.minY,a=n.maxY;s<=a;++s)r([e,i,s])},t.prototype.forEachTileCoordParentTileRange=function(t,e,r,n){var i,o,s=null,a=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):s=this.getTileCoordExtent(t,n);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?Kd(i=Math.floor(i/2),i,o=Math.floor(o/2),o,r):this.getTileRangeForExtentAndZ(s,a,r)))return!0;--a}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,r){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],i=2*t[2];return Kd(n,n+1,i,i+1,e)}var o=this.getTileCoordExtent(t,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},t.prototype.getTileRangeForTileCoordAndZ=function(t,e,r){if(e>this.maxZoom||e<this.minZoom)return null;var n=t[0],i=t[1],o=t[2];if(e===n)return Kd(i,o,i,o,r);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,e-n),a=Math.floor(i*s),l=Math.floor(o*s);return e<n?Kd(a,a,l,l,r):Kd(a,Math.floor(s*(i+1))-1,l,Math.floor(s*(o+1))-1,r)}var u=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e,r)},t.prototype.getTileRangeExtent=function(t,e,r){var n=this.getOrigin(t),i=this.getResolution(t),o=Vc(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*i,a=n[0]+(e.maxX+1)*o[0]*i;return vt(s,n[1]+e.minY*o[1]*i,a,n[1]+(e.maxY+1)*o[1]*i,r)},t.prototype.getTileRangeForExtentAndZ=function(t,e,r){var n=dg;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var i=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),Kd(i,n[1],o,n[2],r)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),r=this.getResolution(t[0]),n=Vc(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*r,e[1]-(t[2]+.5)*n[1]*r]},t.prototype.getTileCoordExtent=function(t,e){var r=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=Vc(this.getTileSize(t[0]),this.tmpSize_),o=r[0]+t[1]*i[0]*n,s=r[1]-(t[2]+1)*i[1]*n;return vt(o,s,o+i[0]*n,s+i[1]*n,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,r){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,r)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,r,n,i){var o=this.getZForResolution(r),s=r/this.getResolution(o),a=this.getOrigin(o),l=Vc(this.getTileSize(o),this.tmpSize_),u=n?.5:0,c=n?.5:0,h=Math.floor((t-a[0])/r+u),f=Math.floor((a[1]-e)/r+c),p=s*h/l[0],d=s*f/l[1];return n?(p=Math.ceil(p)-1,d=Math.ceil(d)-1):(p=Math.floor(p),d=Math.floor(d)),ug(o,p,d,i)},t.prototype.getTileCoordForXYAndZ_=function(t,e,r,n,i){var o=this.getOrigin(r),s=this.getResolution(r),a=Vc(this.getTileSize(r),this.tmpSize_),l=n?.5:0,u=n?.5:0,c=Math.floor((t-o[0])/s+l),h=Math.floor((o[1]-e)/s+u),f=c/a[0],p=h/a[1];return n?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),ug(r,f,p,i)},t.prototype.getTileCoordForCoordAndZ=function(t,e,r){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,r)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null},t.prototype.getZForResolution=function(t,e){return y(Be(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,r=new Array(e),n=this.minZoom;n<e;++n)r[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=r},t}(),yg="Geometry",mg="LineString",_g="Polygon",vg="MultiPoint",bg="MultiLineString",wg="MultiPolygon",xg="LinearRing",Eg="Point",Sg="GeometryCollection",Ig="Circle",Og=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var Cg=function(t){function e(e){var r=t.call(this)||this;if(r.on,r.once,r.un,r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addChangeListener(r.geometryName_,r.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;r.setGeometry(n)}else{var i=e;r.setProperties(i)}return r}return Og(e,t),e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&t.setGeometry(r.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(da(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=fa(t,$s,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(ut("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(wa);function Tg(t,e,r,n,i,o,s){var a,l,u=(r-e)/n;if(1===u)a=e;else if(2===u)a=e,l=i;else if(0!==u){for(var c=t[e],h=t[e+1],f=0,p=[0],d=e+n;d<r;d+=n){var g=t[d],y=t[d+1];f+=Math.sqrt((g-c)*(g-c)+(y-h)*(y-h)),p.push(f),c=g,h=y}var m=i*f,_=function(t,e,r){for(var n,i,o=r||ze,s=0,a=t.length,l=!1;s<a;)(i=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,l=!i);return l?s:~s}(p,m);_<0?(l=(m-p[-_-2])/(p[-_-1]-p[-_-2]),a=e+(-_-2)*n):a=e+_*n}var v=s>1?s:2,b=o||new Array(v);for(d=0;d<v;++d)b[d]=void 0===a?NaN:void 0===l?t[a+d]:S(t[a+d],t[a+n+d],l);return b}function Pg(t,e,r,n,i,o){if(r==e)return null;var s;if(i<t[e+n-1])return o?((s=t.slice(e,e+n))[n-1]=i,s):null;if(t[r-1]<i)return o?((s=t.slice(r-n,r))[n-1]=i,s):null;if(i==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,l=r/n;a<l;){var u=a+l>>1;i<t[(u+1)*n-1]?l=u:a=u+1}var c=t[a*n-1];if(i==c)return t.slice((a-1)*n,(a-1)*n+n);var h=(i-c)/(t[(a+1)*n-1]-c);s=[];for(var f=0;f<n-1;++f)s.push(S(t[(a-1)*n+f],t[a*n+f],h));return s.push(i),s}function Rg(t,e,r,n){for(var i=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=r.length;s<a;++s){var l=r[s];o=xt(t,e,l[0],n),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return i}var Lg=[1,0,0,1,0,0],Mg=function(){function t(t,e,r,n,i){this.extent_,this.id_=i,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r,this.properties_=n}return t.prototype.get=function(t){return this.properties_[t]},t.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===Yt.POINT?wt(this.flatCoordinates_):xt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},t.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var t=Mt(this.getExtent());this.flatInteriorPoints_=_c(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_},t.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var t=Rg(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=vc(this.flatCoordinates_,0,this.ends_,2,t)}return this.flatInteriorPoints_},t.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=Tg(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},t.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,r=this.ends_,n=0,i=r.length;n<i;++n){var o=r[n],s=Tg(t,e,o,2,.5);qe(this.flatMidpoints_,s),e=o}}return this.flatMidpoints_},t.prototype.getId=function(){return this.id_},t.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},t.prototype.getGeometry=function(){return this},t.prototype.getSimplifiedGeometry=function(t){return this},t.prototype.simplifyTransformed=function(t,e){return this},t.prototype.getProperties=function(){return this.properties_},t.prototype.getStride=function(){return 2},t.prototype.getStyleFunction=function(){},t.prototype.getType=function(){return this.type_},t.prototype.transform=function(t){var e=(t=ye(t)).getExtent(),r=t.getWorldExtent();if(e&&r){var n=At(r)/At(e);Rs(Lg,r[0],r[3],n,-n,0,0,0),ju(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Lg,this.flatCoordinates_)}},t.prototype.getEnds=function(){return this.ends_},t}();Mg.prototype.getEndss=Mg.prototype.getEnds,Mg.prototype.getFlatCoordinates=Mg.prototype.getOrientedFlatCoordinates;var kg=Mg;function Ng(t,e,r,n){for(var i=t[e],o=t[e+1],s=0,a=e+n;a<r;a+=n){var l=t[a],u=t[a+1];s+=Math.sqrt((l-i)*(l-i)+(u-o)*(u-o)),i=l,o=u}return s}var Ag=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fg=function(t){function e(e,r){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===r||Array.isArray(e[0])?n.setCoordinates(e,r):n.setFlatCoordinates(r,e),n}return Ag(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?qe(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){return n<pt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ku(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,r,n))},e.prototype.forEachSegment=function(t){return bc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=Fu&&this.layout!=Du)return null;var r=void 0!==e&&e;return Pg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r)},e.prototype.getCoordinates=function(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Tg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)},e.prototype.getLength=function(){return Ng(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=ec(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,Nu)},e.prototype.getType=function(){return Yt.LINE_STRING},e.prototype.intersectsExtent=function(t){return wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Wu),Dg=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jg=function(t){function e(e,r){var n=t.call(this)||this;return r&&!Array.isArray(e[0])?n.setFlatCoordinates(r,e):n.setCoordinates(e,r),n}return Dg(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?qe(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){if(n<pt(this.getExtent(),t,e))return n;for(var i=this.flatCoordinates,o=this.stride,s=0,a=i.length;s<a;s+=o){var l=b(t,e,i[s],i[s+1]);if(l<n){n=l;for(var u=0;u<o;++u)r[u]=i[s+u];r.length=o}}return n},e.prototype.getCoordinates=function(){return sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new dc(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,n=[],i=0,o=t.length;i<o;i+=r){var s=new dc(t.slice(i,i+r),e);n.push(s)}return n},e.prototype.getType=function(){return Yt.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,r=this.stride,n=0,i=e.length;n<i;n+=r){if(yt(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Wu),Gg=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zg=function(t){function e(e,r,n){var i=t.call(this)||this;if(i.ends_=[],i.maxDelta_=-1,i.maxDeltaRevision_=-1,Array.isArray(e[0]))i.setCoordinates(e,r);else if(void 0!==r&&n)i.setFlatCoordinates(r,e),i.ends_=n;else{for(var o=i.getLayout(),s=e,a=[],l=[],u=0,c=s.length;u<c;++u){var h=s[u];0===u&&(o=h.getLayout()),qe(a,h.getFlatCoordinates()),l.push(a.length)}i.setFlatCoordinates(o,a),i.ends_=l}return i}return Gg(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?qe(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){return n<pt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zu(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$u(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,n))},e.prototype.getCoordinateAtM=function(t,e,r){if(this.layout!=Fu&&this.layout!=Du||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,i=void 0!==r&&r;return function(t,e,r,n,i,o,s){if(s)return Pg(t,e,r[r.length-1],n,i,o);var a;if(i<t[n-1])return o?((a=t.slice(0,n))[n-1]=i,a):null;if(t[t.length-1]<i)return o?((a=t.slice(t.length-n))[n-1]=i,a):null;for(var l=0,u=r.length;l<u;++l){var c=r[l];if(e!=c){if(i<t[e+n-1])return null;if(i<=t[c-1])return Pg(t,e,c,n,i,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,i)},e.prototype.getCoordinates=function(){return ac(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Fg(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,n=[],i=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new Fg(t.slice(i,a),r);n.push(l),i=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,r=0,n=this.ends_,i=this.stride,o=0,s=n.length;o<s;++o){var a=n[o];qe(t,Tg(e,r,a,i,.5)),r=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],n=[];return r.length=rc(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,n),new e(r,Nu,n)},e.prototype.getType=function(){return Yt.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return function(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){if(wc(t,e,r[o],n,i))return!0;e=r[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=tc(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Wu),Ug=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bg=function(t){function e(e,r,n){var i=t.call(this)||this;if(i.endss_=[],i.flatInteriorPointsRevision_=-1,i.flatInteriorPoints_=null,i.maxDelta_=-1,i.maxDeltaRevision_=-1,i.orientedRevision_=-1,i.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var o=i.getLayout(),s=e,a=[],l=[],u=0,c=s.length;u<c;++u){var h=s[u];0===u&&(o=h.getLayout());for(var f=a.length,p=h.getEnds(),d=0,g=p.length;d<g;++d)p[d]+=f;qe(a,h.getFlatCoordinates()),l.push(p)}r=o,e=a,n=l}return void 0!==r&&n?(i.setFlatCoordinates(r,e),i.endss_=n):i.setCoordinates(e,r),i}return Ug(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var r=this.flatCoordinates.length;qe(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,i=(e=t.getEnds().slice()).length;n<i;++n)e[n]+=r}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,r=new Array(t),n=0;n<t;++n)r[n]=this.endss_[n].slice();var i=new e(this.flatCoordinates.slice(),this.layout,r);return i.applyProperties(this),i},e.prototype.closestPointXY=function(t,e,r,n){return n<pt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){var a=r[o];i=Zu(t,e,a,n,i),e=a[a.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,r,n,i,o,s,a,l,u,c){for(var h=c||[NaN,NaN],f=0,p=r.length;f<p;++f){var d=r[f];u=$u(t,e,d,n,i,o,s,a,l,u,h),e=d[d.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,r,n))},e.prototype.containsXY=function(t,e){return function(t,e,r,n,i,o){if(0===r.length)return!1;for(var s=0,a=r.length;s<a;++s){var l=r[s];if(mc(t,e,l,n,i,o))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,r,n){for(var i=0,o=0,s=r.length;o<s;++o){var a=r[o];i+=cc(t,e,a,n),e=a[a.length-1]}return i}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Cc(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,lc(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=Rg(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=vc(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new jg(this.getFlatInteriorPoints().slice(),Fu)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){var a=r[o];if(!Ic(t,e,a,n,i))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Cc(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],n=[];return r.length=function(t,e,r,n,i,o,s,a){for(var l=0,u=r.length;l<u;++l){var c=r[l],h=[];s=oc(t,e,c,n,i,o,s,h),a.push(h),e=c[c.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),r,0,n),new e(r,Nu,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var r=this.endss_[t-1];e=r[r.length-1]}var n=this.endss_[t].slice(),i=n[n.length-1];if(0!==e)for(var o=0,s=n.length;o<s;++o)n[o]-=e;return new Rc(this.flatCoordinates.slice(e,i),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,r=this.endss_,n=[],i=0,o=0,s=r.length;o<s;++o){var a=r[o].slice(),l=a[a.length-1];if(0!==i)for(var u=0,c=a.length;u<c;++u)a[u]-=i;var h=new Rc(e.slice(i,l),t,a);n.push(h),i=l}return n},e.prototype.getType=function(){return Yt.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return function(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){var a=r[o];if(xc(t,e,a,n,i))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var r=function(t,e,r,n,i){for(var o=i||[],s=0,a=0,l=r.length;a<l;++a){var u=tc(t,e,r[a],n,o[s]);o[s++]=u,e=u[u.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===r.length)this.flatCoordinates.length=0;else{var n=r[r.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(Wu),Vg=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function qg(t){for(var e=[],r=0,n=t.length;r<n;++r)e.push(t[r].clone());return e}var Yg=function(t){function e(e){var r=t.call(this)||this;return r.geometries_=e||null,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return Vg(e,t),e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(da),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(fa(this.geometries_[t],$s,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){if(n<pt(this.getExtent(),t,e))return n;for(var i=this.geometries_,o=0,s=i.length;o<s;++o)n=i[o].closestPointXY(t,e,r,n);return n},e.prototype.containsXY=function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)if(r[n].containsXY(t,e))return!0;return!1},e.prototype.computeExtent=function(t){bt(t);for(var e=this.geometries_,r=0,n=e.length;r<n;++r)St(t,e[r].getExtent());return t},e.prototype.getGeometries=function(){return qg(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.geometries_,r=0,n=e.length;r<n;++r)e[r].getType()===this.getType()?t=t.concat(e[r].getGeometriesArrayRecursive()):t.push(e[r]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],n=this.geometries_,i=!1,o=0,s=n.length;o<s;++o){var a=n[o],l=a.getSimplifiedGeometry(t);r.push(l),l!==a&&(i=!0)}if(i){var u=new e(null);return u.setGeometriesArray(r),u}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return Yt.GEOMETRY_COLLECTION},e.prototype.intersectsExtent=function(t){for(var e=this.geometries_,r=0,n=e.length;r<n;++r)if(e[r].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return 0===this.geometries_.length},e.prototype.rotate=function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].rotate(t,e);this.changed()},e.prototype.scale=function(t,e,r){var n=r;n||(n=Mt(this.getExtent()));for(var i=this.geometries_,o=0,s=i.length;o<s;++o)i[o].scale(t,e,n);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(qg(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var e=this.geometries_,r=0,n=e.length;r<n;++r)e[r].applyTransform(t);this.changed()},e.prototype.translate=function(t,e){for(var r=this.geometries_,n=0,i=r.length;n<i;++n)r[n].translate(t,e);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),t.prototype.disposeInternal.call(this)},e}(Vu),Wg=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xg=function(t){function e(e,r,n){var i=t.call(this)||this;if(void 0!==n&&void 0===r)i.setFlatCoordinates(n,e);else{var o=r||0;i.setCenterAndRadius(e,o,n)}return i}return Wg(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,r,n){var i=this.flatCoordinates,o=t-i[0],s=e-i[1],a=o*o+s*s;if(a<n){if(0===a)for(var l=0;l<this.stride;++l)r[l]=i[l];else{var u=this.getRadius()/Math.sqrt(a);r[0]=i[0]+u*o,r[1]=i[1]+u*s;for(l=2;l<this.stride;++l)r[l]=i[l]}return r.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var r=this.flatCoordinates,n=t-r[0],i=e-r[1];return n*n+i*i<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return vt(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return Yt.CIRCLE},e.prototype.intersectsExtent=function(t){if(zt(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||Tt(t,this.intersectsCoordinate.bind(this)))}return!1},e.prototype.setCenter=function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+r;for(var i=1;i<e;++i)n[e+i]=t[i];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,i=Ju(n,0,t,this.stride);n[i++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[i++]=n[o];n.length=i,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var r=this.getCenter(),n=this.getStride();this.setCenter(Gu(r,0,r.length,n,t,e,r)),this.changed()},e.prototype.translate=function(t,e){var r=this.getCenter(),n=this.getStride();this.setCenter(zu(r,0,r.length,n,t,e,r)),this.changed()},e}(Wu);Xg.prototype.transform;var Hg=Xg;function Zg(t){return function(t){if(Array.isArray(t))return Kg(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Kg(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kg(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kg(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qg(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Jg(Object(r),!0).forEach((function(e){ty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jg(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ey=function(t,e){var r=Ie(e,"EPSG:4326"),n=[],i={};return t.forEach((function(e){var o=[];if(Array.isArray(e.geometry.coordinates[0])&&t.length>1)e.geometry.coordinates.forEach((function(t){if(!Number.isFinite(t[0])&&Array.isArray(t))o.push(t.map((function(t){var e=[];return Number.isFinite(t[0])?e.push(r(t)):t.forEach((function(t){e.push(r(t))})),e}))),i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:o}});else{var n=r(t);o.push(n),i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:o}})}})),n.push(i);else if(3===e.geometry.coordinates.length)e.geometry.coordinates.pop(),i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:r(e.geometry.coordinates)}}),n.push(i);else if(1===t.length)if(e.geometry.coordinates[0].length>2){var s=e.geometry.coordinates[0].map((function(t){return r(t)}));i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:s}}),n.push(i)}else i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:r(e.geometry.coordinates[0])}}),n.push(i);else if(Number.isFinite(e.geometry.coordinates[0])){var a=r(e.geometry.coordinates);i=Qg(Qg({},e),{},{geometry:{type:e.geometry.type,coordinates:a}}),n.push(i)}})),n},ry=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"generateResolutions",value:function(t,e,r,n){var i,o,s,a=[];_V(e)&&(i=t.getExtent());var l=Gt(i)/256;_V(r)&&(o=0),_V(n)&&(s=28);for(var u=s-o,c=0;c<u;c+=1)a[c]=l/Math.pow(2,c);return a}},{key:"addOverlayImage",value:function(t,e){e.getMapImpl().updateSize();var r=e.getMapImpl().getSize(),n=t.screenXY,i=t.screenXUnits,o=t.screenYUnits,s=t.overlayXY,a=t.overlayXUnits,l=t.overlayYUnits,u=t.size,c=t.src,h=document.createElement("img");h.src=c,h.style.width="".concat(u[0],"px"),h.style.height="".concat(u[1],"px");var f=s[0];"fraction"===a&&(f*=u[0]);var p=s[1];"fraction"===l&&(p=u[1]-p*u[1]),h.style.position="absolute";var d=n[0];"fraction"===i&&(d=d*r[0]-f);var g=n[1];return"fraction"===o&&(g=r[1]-g*r[1]-p),h.style.top="".concat(g,"px"),h.style.left="".concat(d,"px"),e.getMapImpl().getOverlayContainerStopEvent().appendChild(h),h}},{key:"getExtentHeight",value:function(t){return t[3]-t[1]}},{key:"getExtentWidth",value:function(t){return t[2]-t[0]}},{key:"getCentroid",value:function(t){return _V(t)?null:t instanceof kg?t:Mt(t.getExtent())}},{key:"getFeaturesExtent",value:function(t,e){var r=t.map((function(t){return t instanceof mq?t.getImpl().getOLFeature():t})),n=r.map((function(t){return t.getGeometry().getExtent().slice(0)}));if(1===n.length){var i=r[0].getGeometry();if("Point"===i.getType()){var o=function(t,e){return e/ye(t).getMetersPerUnit()}(e,1e3),s=i.getCoordinates()[0],a=i.getCoordinates()[1];n=[[s-o,a-o,s+o,a+o]]}}return 0===n.length?null:n.reduce((function(t,e){return St(t,e)}))}},{key:"getCentroidCoordinate",value:function(e){var r,n,i,o,s,a;return e.getType()===Eg?r=e.getCoordinates():e.getType()===mg||e.getType()===xg?r=(n=e.getCoordinates())[i=Math.floor(n.length/2)]:e.getType()===_g?r=t.getCentroidCoordinate(e.getInteriorPoint()):e.getType()===vg?(o=e.getPoints(),i=Math.floor(o.length/2),r=t.getCentroidCoordinate(o[i])):e.getType()===bg?(s=e.getLineStrings(),i=Math.floor(s.length/2),r=t.getCentroidCoordinate(s[i])):e.getType()===wg?(o=e.getInteriorPoints(),r=t.getCentroidCoordinate(o)):e.getType()===Ig?r=e.getCenter():e.getType()===Sg&&(a=e.getGeometries(),i=Math.floor(a.length/2),r=t.getCentroidCoordinate(a[i])),r}},{key:"transformExtent",value:function(t,e,r){var n=wV(e)?ye(e):e,i=wV(r)?ye(r):r,o=n.getExtent();return t.every((function(t,e){return e<2?t<=o[e]:t>=o[e]}))?i.getExtent():Ce(t,n,i)}},{key:"olRenderFeature2olFeature",value:function(t,e,r){var n;if(!_V(t)){var i,o=t.getId(),s=t.getProperties();if(_V(e)&&_V(e))i=this.getGeometryFromRenderFeature(t.getGeometry());else{var a=e.getExtent(),l=e.getWorldExtent();if(!_V(a)&&!_V(l)){var u=this.cloneOLRenderFeature(t);u.transform(e,r),i=this.getGeometryFromRenderFeature(u.getGeometry())}}n=new Cg,_V(o)?n.setId(CV("mapea_feature_")):n.setId(o),n.setProperties(s,!0),n.setGeometry(i)}return n}},{key:"cloneOLRenderFeature",value:function(t){var e=t.getType(),r=t.getFlatCoordinates(),n=t.getEnds(),i=t.getProperties(),o=t.getId(),s=Zg(r),a=Object.assign(i),l=Zg(n);return new kg(e,s,l,a,o)}},{key:"getGeometryFromRenderFeature",value:function(t){var e,r=t.getFlatCoordinates(),n=t.getEnds(),i=t.getEndss();switch(t.getType()){case Yt.POINT:e=new dc(r);break;case Yt.LINE_STRING:e=new Fg(r);break;case Yt.LINEAR_RING:e=new fc(r);break;case Yt.POLYGON:e=new Rc(r);break;case Yt.MULTI_POINT:e=new jg(r);break;case Yt.MULTI_LINE_STRING:e=new zg(r,void 0,n);break;case Yt.MULTI_POLYGON:e=new Bg(r,void 0,i);break;case Yt.GEOMETRY_COLLECTION:var o=t.getGeometries();e=new Yg(o);break;case Yt.CIRCLE:var s=t.getFlatInteriorPoint();e=new Hg(s);break;default:e=null}return e}},{key:"getWMTSScale",value:function(t,e){var r=ye(t.getProjection().code).getMetersPerUnit(),n=t.getMapImpl().getSize(),i=n[0],o=t.getMapImpl().getView().calculateExtent(n),s=r*(o[2]-o[0])/i*1e3/.28;return 1==!e&&(s=s>=1e3&&s<=95e4?1e3*Math.round(s/1e3):s>=95e4?1e6*Math.round(s/1e6):Math.round(s)),Math.trunc(s)}}],(r=null)&&$g(e.prototype,r),n&&$g(e,n),t}();function ny(t){return(ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oy(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sy(t,e){return(sy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ay(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=uy(t);if(e){var i=uy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ly(this,r)}}function ly(t,e){return!e||"object"!==ny(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uy(t){return(uy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sy(t,e)}(o,t);var e,r,n,i=ay(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return iy(this,o),(t=i.call(this,e)).vendorOptions_=r,t.map=null,t.ol3Layer=null,t.options=e,t.visibility=!1!==t.options.visibility,t.displayInLayerSwitcher=!1!==t.options.displayInLayerSwitcher,t.zIndex_=null,t.minScale_=null,t.maxScale_=null,t.opacity_=t.options.opacity||1,t.legendUrl_=DV([M.config.THEME_URL,Ad.LEGEND_DEFAULT]),t}return e=o,(r=[{key:"isVisible",value:function(){return _V(this.ol3Layer)?this.visibility:this.ol3Layer.getVisible()}},{key:"isQueryable",value:function(){return!1}},{key:"inRange",value:function(){var t=!1;if(!_V(this.ol3Layer)){var e=this.map.getMapImpl().getView().getResolution(),r=this.ol3Layer.getMaxResolution();t=e>=this.ol3Layer.getMinResolution()&&e<=r}return t}},{key:"setVisible",value:function(t){this.visibility=t,_V(this.ol3Layer)||this.ol3Layer.setVisible(t)}},{key:"getZIndex",value:function(){return _V(this.getOLLayer())||(this.zIndex_=this.getOLLayer().getZIndex()),this.zIndex_}},{key:"setZIndex",value:function(t){this.zIndex_=t,_V(this.getOLLayer())||this.getOLLayer().setZIndex(t)}},{key:"getMinScale",value:function(){var t=this.map.getProjection().units;return _V(this.getOLLayer())||_V(t)||(this.minScale_=kV(this.getOLLayer().getMinResolution(),t)),this.minScale_}},{key:"setMinScale",value:function(t){this.minScale_=t;var e=this.map.getProjection().units,r=LV(t,e);_V(this.getOLLayer())||_V(r)||_V(e)||this.getOLLayer().setMinResolution(r)}},{key:"getMaxScale",value:function(){var t=this.map.getProjection().units;return _V(this.getOLLayer())||_V(t)||(this.maxScale_=kV(this.getOLLayer().getMaxResolution(),t)),this.maxScale_}},{key:"setMaxScale",value:function(t){this.maxScale_=t;var e=this.map.getProjection().units,r=LV(t,e);_V(this.getOLLayer())||_V(r)||_V(e)||this.getOLLayer().setMaxResolution(r)}},{key:"getOpacity",value:function(){return _V(this.getOLLayer())||(this.opacity_=this.getOLLayer().getOpacity()),this.opacity_}},{key:"setOpacity",value:function(t){this.opacity_=t,_V(this.getOLLayer())||this.getOLLayer().setOpacity(t)}},{key:"getOL3Layer",value:function(){return this.ol3Layer}},{key:"getOLLayer",value:function(){return this.ol3Layer}},{key:"setOL3Layer",value:function(t){var e=this.map.getMapImpl();return e.removeLayer(this.ol3Layer),this.ol3Layer=t,e.addLayer(t),this}},{key:"setOLLayer",value:function(t){var e=this.map.getMapImpl();return e.removeLayer(this.ol3Layer),this.ol3Layer=t,e.addLayer(t),this}},{key:"getMap",value:function(){return this.map}},{key:"getLegendURL",value:function(){return this.legendUrl_}},{key:"setLegendURL",value:function(t){this.legendUrl_=t}},{key:"getNumZoomLevels",value:function(){return 16}},{key:"unselectFeatures",value:function(t,e,r){}},{key:"selectFeatures",value:function(t,e,r){}}])&&oy(e.prototype,r),n&&oy(e,n),o}(ff);function hy(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var fy=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.capabilities_=e,this.projection_=n,this.serviceUrl_=r}var e,r,n;return e=t,(r=[{key:"getLayerExtent",value:function(t,e){var r=this.capabilities_.Capability.Layer,n=this.getExtentRecursive_(r,t,e);return this.transformExtent(n)}},{key:"getExtentRecursive_",value:function(t,e,r){var n,i=null;if(!_V(t))if(mV(t))for(n=0;n<t.length&&null===i;n+=1)i=this.getExtentRecursive_(t[n],e,r);else if(bV(t))if(_V(e)||t.Name===e){var o=r||this.projection_.code;if(_V(t.BoundingBox)){if(!_V(t.LatLonBoundingBox)){var s=t.LatLonBoundingBox[0];this.capabilitiesProj="EPSG:4326";var a=ye("EPSG:4326"),l=ye(this.projection_.code);i=ry.transformExtent(s.extent,a,l)}}else{var u=t.BoundingBox.find((function(t){return t.crs===o}));if(_V(u)){var c=t.BoundingBox[0];this.capabilitiesProj=c.crs;var h=ye(c.crs),f=ye(this.projection_.code);i=ry.transformExtent(c.extent,h,f)}else this.capabilitiesProj=u.crs,i=u.extent}}else dV(t.Layer)||(i=this.getExtentRecursive_(t.Layer,e,r));return i}},{key:"getLayers",value:function(){var t=this.capabilities_.Capability.Layer;return this.getLayersRecursive_(t)}},{key:"getLayersRecursive_",value:function(t){var e=this,r=[];return _V(t.Layer)?mV(t)?t.forEach((function(t){r=r.concat(e.getLayersRecursive_(t))})):r.push(new q_({url:this.serviceUrl_,name:t.Name})):r=this.getLayersRecursive_(t.Layer),r}},{key:"transformExtent",value:function(t){var e=t;if("1.3.0"===this.capabilities_.version&&wV(this.capabilitiesProj)){var r=ye(this.capabilitiesProj).getAxisOrientation();Array.isArray(e)&&"ne"===r.substr(0,2)&&(e=[t[1],t[0],t[3],t[2]])}return e}},{key:"capabilities",get:function(){return this.capabilities_}},{key:"projection",get:function(){return this.projection_}},{key:"serviceUrl",get:function(){return this.serviceUrl_}}])&&hy(e.prototype,r),n&&hy(e,n),t}(),py=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dy=[null,"http://www.opengis.net/wms"],gy=cr(dy,{Service:ir((function(t,e){return fr({},_y,t,e)})),Capability:ir((function(t,e){return fr({},yy,t,e)}))}),yy=cr(dy,{Request:ir((function(t,e){return fr({},Oy,t,e)})),Exception:ir((function(t,e){return fr([],xy,t,e)})),Layer:ir((function(t,e){var r=fr({},Ey,t,e);if(void 0===r.Layer)return Object.assign(r,ky(t,e));return r}))}),my=function(t){function e(){var e=t.call(this)||this;return e.version=void 0,e}return py(e,t),e.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var e=fr({version:this.version},gy,t,[]);return e||null},e}(_r),_y=cr(dy,{Name:ir(Cr),Title:ir(Cr),Abstract:ir(Cr),KeywordList:ir(Dy),OnlineResource:ir(vr),ContactInformation:ir((function(t,e){return fr({},vy,t,e)})),Fees:ir(Cr),AccessConstraints:ir(Cr),LayerLimit:ir(Ir),MaxWidth:ir(Ir),MaxHeight:ir(Ir)}),vy=cr(dy,{ContactPersonPrimary:ir((function(t,e){return fr({},by,t,e)})),ContactPosition:ir(Cr),ContactAddress:ir((function(t,e){return fr({},wy,t,e)})),ContactVoiceTelephone:ir(Cr),ContactFacsimileTelephone:ir(Cr),ContactElectronicMailAddress:ir(Cr)}),by=cr(dy,{ContactPerson:ir(Cr),ContactOrganization:ir(Cr)}),wy=cr(dy,{AddressType:ir(Cr),Address:ir(Cr),City:ir(Cr),StateOrProvince:ir(Cr),PostCode:ir(Cr),Country:ir(Cr)}),xy=cr(dy,{Format:er(Cr)}),Ey=cr(dy,{Name:ir(Cr),Title:ir(Cr),Abstract:ir(Cr),KeywordList:ir(Dy),CRS:nr(Cr),EX_GeographicBoundingBox:ir((function(t,e){var r=fr({},Iy,t,e);if(!r)return;var n=r.westBoundLongitude,i=r.southBoundLatitude,o=r.eastBoundLongitude,s=r.northBoundLatitude;if(void 0===n||void 0===i||void 0===o||void 0===s)return;return[n,i,o,s]})),BoundingBox:nr((function(t,e){var r=[Sr(t.getAttribute("minx")),Sr(t.getAttribute("miny")),Sr(t.getAttribute("maxx")),Sr(t.getAttribute("maxy"))],n=[Sr(t.getAttribute("resx")),Sr(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:r,res:n}})),Dimension:nr((function(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:wr(t.getAttribute("multipleValues")),nearestValue:wr(t.getAttribute("nearestValue")),current:wr(t.getAttribute("current")),values:Cr(t)}})),Attribution:ir((function(t,e){return fr({},Sy,t,e)})),AuthorityURL:nr((function(t,e){var r=Ny(t,e);if(r)return r.name=t.getAttribute("name"),r;return})),Identifier:nr(Cr),MetadataURL:nr((function(t,e){var r=Ny(t,e);if(r)return r.type=t.getAttribute("type"),r;return})),DataURL:nr(Ny),FeatureListURL:nr(Ny),Style:nr((function(t,e){return fr({},Ry,t,e)})),MinScaleDenominator:ir(Er),MaxScaleDenominator:ir(Er),Layer:nr(ky)}),Sy=cr(dy,{Title:ir(Cr),OnlineResource:ir(vr),LogoURL:ir(Fy)}),Iy=cr(dy,{westBoundLongitude:ir(Er),eastBoundLongitude:ir(Er),southBoundLatitude:ir(Er),northBoundLatitude:ir(Er)}),Oy=cr(dy,{GetCapabilities:ir(Ay),GetMap:ir(Ay),GetFeatureInfo:ir(Ay)}),Cy=cr(dy,{Format:nr(Cr),DCPType:nr((function(t,e){return fr({},Ty,t,e)}))}),Ty=cr(dy,{HTTP:ir((function(t,e){return fr({},Py,t,e)}))}),Py=cr(dy,{Get:ir(Ny),Post:ir(Ny)}),Ry=cr(dy,{Name:ir(Cr),Title:ir(Cr),Abstract:ir(Cr),LegendURL:nr(Fy),StyleSheetURL:ir(Ny),StyleURL:ir(Ny)}),Ly=cr(dy,{Format:ir(Cr),OnlineResource:ir(vr)}),My=cr(dy,{Keyword:er(Cr)});function ky(t,e){var r=e[e.length-1],n=fr({},Ey,t,e);if(n){var i=wr(t.getAttribute("queryable"));void 0===i&&(i=r.queryable),n.queryable=void 0!==i&&i;var o=Or(t.getAttribute("cascaded"));void 0===o&&(o=r.cascaded),n.cascaded=o;var s=wr(t.getAttribute("opaque"));void 0===s&&(s=r.opaque),n.opaque=void 0!==s&&s;var a=wr(t.getAttribute("noSubsets"));void 0===a&&(a=r.noSubsets),n.noSubsets=void 0!==a&&a;var l=Sr(t.getAttribute("fixedWidth"));l||(l=r.fixedWidth),n.fixedWidth=l;var u=Sr(t.getAttribute("fixedHeight"));u||(u=r.fixedHeight),n.fixedHeight=u;["Style","CRS","AuthorityURL"].forEach((function(t){if(t in r){var e=n[t]||[];n[t]=e.concat(r[t])}}));return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach((function(t){if(!(t in n)){var e=r[t];n[t]=e}})),n}}function Ny(t,e){return fr({},Ly,t,e)}function Ay(t,e){return fr({},Cy,t,e)}function Fy(t,e){var r=Ny(t,e);if(r){var n=[Or(t.getAttribute("width")),Or(t.getAttribute("height"))];return r.size=n,r}}function Dy(t,e){return fr([],My,t,e)}var jy=my;function Gy(t){return(Gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uy(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function By(t,e){return(By=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Yy(t);if(e){var i=Yy(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return qy(this,r)}}function qy(t,e){return!e||"object"!==Gy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yy(t){return(Yy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wy=["SRS","BoundingBox","ScaleHint","LatLonBoundingBox"],Xy=function(t,e){null!==t&&Wy.forEach((function(r){var n,i;(n=e,i=r,Array.prototype.filter.call(n.children,(function(t){return t.tagName===i})).length>0)||Array.prototype.filter.call(t.children,(function(t){return t.tagName===r})).forEach((function(t){var r=t.cloneNode(!0);e.appendChild(r)}))}))},Hy=function t(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=n,s=e;if(!0===r&&(s=e.querySelector("Layer")),null!==s){Xy(i,s);var a=s.querySelector("Name").innerHTML,l=s.children;Array.prototype.forEach.call(l,(function(e){"Layer"===e.tagName&&(o=t(e,!1,o,s))})),o[a]=s}return o},Zy=[function t(e,r){var n=e,i=r[n.Name];if(_V(i))mV(n.Layer)&&n.Layer.forEach((function(e){return t(e,r)}));else{var o=i.querySelector("SRS");if(null!==o){var s=o.innerHTML;n.SRS=[s]}}},function t(e,r){var n=r[e.Name];if(_V(n))mV(e.Layer)&&e.Layer.forEach((function(e){return t(e,r)}));else if(mV(e.BoundingBox)){var i=Array.prototype.filter.call(n.children,(function(t){return"Layer"===t.tagName})),o=Array.prototype.map.call(n.children,(function(t){return t}));0===(o=o.filter((function(t){return["BoundingBox"].includes(t.tagName)}))).length&&i.length>0?i.forEach((function(r){return t(e,(n={},i=e.Name,o=r,i in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n));var n,i,o})):e.BoundingBox.forEach((function(t,e){var r=t;if(null===r.crs){var n=o[e];if(!_V(n)){var i=n.getAttribute("SRS");_V(i)||(r.crs=i)}}}))}},function t(e,r){var n=e,i=r[e.Name];if(_V(i))mV(e.Layer)&&e.Layer.forEach((function(e){return t(e,r)}));else{n.ScaleHint=[];var o=Array.prototype.map.call(i.children,(function(t){return t}));(o=o.filter((function(t){return"ScaleHint"===t.tagName}))).forEach((function(t){var e={minScale:parseFloat(t.getAttribute("min")),maxScale:parseFloat(t.getAttribute("max"))};n.ScaleHint.push(e)}))}},function t(e,r){var n=e,i=r[e.Name];if(_V(i))mV(n.Layer)&&n.Layer.forEach((function(e){return t(e,r)}));else{n.LatLonBoundingBox=[];var o=Array.prototype.map.call(i.children,(function(t){return t}));(o=o.filter((function(t){return"LatLonBoundingBox"===t.tagName}))).forEach((function(t){var e={crs:"EPSG:4326",extent:[parseFloat(t.getAttribute("minx")),parseFloat(t.getAttribute("miny")),parseFloat(t.getAttribute("maxx")),parseFloat(t.getAttribute("maxy"))]};n.LatLonBoundingBox.push(e)}))}},function(t,e){var r=t;_V(r.BoundingBox)&&!_V(r.LatLonBoundingBox)&&(r.BoundingBox=r.LatLonBoundingBox)},function(t,e){var r=t;_V(r.MaxScaleDenominator)&&!_V(r.ScaleHint)&&(r.MaxScaleDenominator=r.ScaleHint[0].maxScale)},function(t,e){var r=t;_V(r.MinScaleDenominator)&&!_V(r.ScaleHint)&&(r.MinScaleDenominator=r.ScaleHint[0].minScale)}],Ky=function t(e,r){mV(e)?e.forEach((function(e){t(e,r)})):bV(e)&&(!function(t,e){Zy.forEach((function(r){r(t,e)}))}(e,r),t(e.Layer,r))},$y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&By(t,e)}(o,t);var e,r,n,i=Vy(o);function o(){return zy(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"customRead",value:function(t){var e=this.read(t),r=Hy(t),n=e.Capability;return _V(n)||_V(n.Layer)||Ky(n.Layer,r),e}}])&&Uy(e.prototype,r),n&&Uy(e,n),o}(jy),Jy="1.3.0",Qy={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},tm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),em=function(t){function e(e,r,n){var i=t.call(this)||this,o=n||{};return i.tileCoord=e,i.state=r,i.interimTile=null,i.key="",i.transition_=void 0===o.transition?250:o.transition,i.transitionStarts_={},i}return tm(e,t),e.prototype.changed=function(){this.dispatchEvent($s)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==hu)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==hu){t.interimTile=null;break}t.getState()==cu?e=t:t.getState()==uu?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==fu&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Object(st.b)()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var r=this.transitionStarts_[t];if(r){if(-1===r)return 1}else r=e,this.transitionStarts_[t]=r;var n=e-r+1e3/60;return n>=this.transition_?1:Pu(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Ks),rm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),nm=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.extent=e,o.pixelRatio_=n,o.resolution=r,o.state=i,o}return rm(e,t),e.prototype.changed=function(){this.dispatchEvent($s)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Object(st.b)()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Object(st.b)()},e}(Ks),im=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function om(t,e,r){var n=t;if(n.src&&xs){var i=n.decode(),o=!0;return i.then((function(){o&&e()})).catch((function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():r())})),function(){o=!1}}var s=[pa(n,la,e),pa(n,Js,r)];return function(){s.forEach(da)}}var sm=function(t){function e(e,r,n,i,o,s){var a=t.call(this,e,r,n,zd)||this;return a.src_=i,a.image_=new Image,null!==o&&(a.image_.crossOrigin=o),a.unlisten_=null,a.state=zd,a.imageLoadFunction_=s,a}return im(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Vd,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=At(this.extent)/this.image_.height),this.state=Bd,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=zd&&this.state!=Vd||(this.state=Ud,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=om(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=At(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(nm),am=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var lm,um=function(t){function e(e,r,n,i,o,s){var a=t.call(this,e,r,s)||this;return a.crossOrigin_=i,a.src_=n,a.key=n,a.image_=new Image,null!==i&&(a.image_.crossOrigin=i),a.unlisten_=null,a.tileLoadFunction_=o,a}return am(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=hu,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){var t;this.state=fu,this.unlistenImage_(),this.image_=((t=ol(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=hu:this.state=pu,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==fu&&(this.state=uu,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==uu&&(this.state=cu,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=om(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(em),cm=function(){function t(t,e,r,n,i,o){this.sourceProj_=t,this.targetProj_=e;var s={},a=Ie(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=i*i,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Gt(n)==Gt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Gt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Gt(this.targetProj_.getExtent()):null;var l=Dt(r),u=jt(r),c=Lt(r),h=Rt(r),f=this.transformInv_(l),p=this.transformInv_(u),d=this.transformInv_(c),g=this.transformInv_(h),y=10+(o?Math.max(0,Math.ceil(_(Pt(r)/(o*o*256*256)))):0);if(this.addQuad_(l,u,c,h,f,p,d,g,y),this.wrapsXInSource_){var m=1/0;this.triangles_.forEach((function(t,e,r){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-m>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-m>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-m>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var r=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-r<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}s={}}return t.prototype.addTriangle_=function(t,e,r,n,i,o){this.triangles_.push({source:[n,i,o],target:[t,e,r]})},t.prototype.addQuad_=function(t,e,r,n,i,o,s,a,l){var u=ct([i,o,s,a]),c=this.sourceWorldWidth_?Gt(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&c>.5&&c<1,p=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=Gt(ct([t,e,r,n]))/this.targetWorldWidth_>.25||p;!f&&this.sourceProj_.isGlobal()&&c&&(p=c>.25||p)}if(!(!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3]))||zt(u,this.maxSourceExtent_)){var d=0;if(!(p||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)p=!0;else if(1!=(d=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1))&&2!=d&&4!=d&&8!=d)return;if(l>0){if(!p){var g=[(t[0]+r[0])/2,(t[1]+r[1])/2],y=this.transformInv_(g),m=void 0;if(f)m=(E(i[0],h)+E(s[0],h))/2-E(y[0],h);else m=(i[0]+s[0])/2-y[0];var _=(i[1]+s[1])/2-y[1];p=m*m+_*_>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var v=[(e[0]+r[0])/2,(e[1]+r[1])/2],b=this.transformInv_(v),w=[(n[0]+t[0])/2,(n[1]+t[1])/2],x=this.transformInv_(w);this.addQuad_(t,e,v,w,i,o,b,x,l-1),this.addQuad_(w,v,r,n,x,b,s,a,l-1)}else{var S=[(t[0]+e[0])/2,(t[1]+e[1])/2],I=this.transformInv_(S),O=[(r[0]+n[0])/2,(r[1]+n[1])/2],C=this.transformInv_(O);this.addQuad_(t,S,O,n,i,I,C,a,l-1),this.addQuad_(S,e,r,O,I,o,s,C,l-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&d)&&this.addTriangle_(t,r,n,i,s,a),0==(14&d)&&this.addTriangle_(t,r,e,i,s,o),d&&(0==(13&d)&&this.addTriangle_(e,n,t,o,a,i),0==(7&d)&&this.addTriangle_(e,n,r,o,a,s))}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,r,n){var i=e.source;It(t,i[0]),It(t,i[1]),It(t,i[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}();function hm(t,e,r,n,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,r),t.lineTo(n,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(r,i)),t.restore()}function fm(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function pm(t,e,r,n){var i=Oe(r,e,t),o=me(e,n,r),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var l=t.getExtent();if(!l||dt(l,i)){var u=me(t,o,i)/o;isFinite(u)&&u>0&&(o/=u)}return o}function dm(t,e,r,n,i,o,s,a,l,u,c,h){var f=ol(Math.round(r*t),Math.round(r*e));if(V(f,h),0===l.length)return f.canvas;function p(t){return Math.round(t*r)/r}f.scale(r,r),f.globalCompositeOperation="lighter";var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,r){St(d,t.extent)}));var g=Gt(d),y=At(d),m=ol(Math.round(r*g/n),Math.round(r*y/n));V(m,h);var _=r/n;l.forEach((function(t,e,r){var n=t.extent[0]-d[0],i=-(t.extent[3]-d[3]),o=Gt(t.extent),s=At(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,n*_,i*_,o*_,s*_)}));var v=Dt(s);return a.getTriangles().forEach((function(t,e,i){var s=t.source,a=t.target,l=s[0][0],u=s[0][1],c=s[1][0],g=s[1][1],y=s[2][0],_=s[2][1],b=p((a[0][0]-v[0])/o),w=p(-(a[0][1]-v[1])/o),x=p((a[1][0]-v[0])/o),E=p(-(a[1][1]-v[1])/o),S=p((a[2][0]-v[0])/o),I=p(-(a[2][1]-v[1])/o),O=l,C=u;l=0,u=0;var T=function(t){for(var e=t.length,r=0;r<e;r++){for(var n=r,i=Math.abs(t[r][r]),o=r+1;o<e;o++){var s=Math.abs(t[o][r]);s>i&&(i=s,n=o)}if(0===i)return null;var a=t[n];t[n]=t[r],t[r]=a;for(var l=r+1;l<e;l++)for(var u=-t[l][r]/t[r][r],c=r;c<e+1;c++)r==c?t[l][c]=0:t[l][c]+=u*t[r][c]}for(var h=new Array(e),f=e-1;f>=0;f--){h[f]=t[f][e]/t[f][f];for(var p=f-1;p>=0;p--)t[p][e]-=t[p][f]*h[f]}return h}([[c-=O,g-=C,0,0,x-b],[y-=O,_-=C,0,0,S-b],[0,0,c,g,E-w],[0,0,y,_,I-w]]);if(T){if(f.save(),f.beginPath(),function(){if(void 0===lm){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",hm(t,4,5,4,0),hm(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;lm=fm(e,0)||fm(e,4)||fm(e,8)}return lm}()||h===Qy){f.moveTo(x,E);for(var P=b-x,R=w-E,L=0;L<4;L++)f.lineTo(x+p((L+1)*P/4),E+p(L*R/3)),3!=L&&f.lineTo(x+p((L+1)*P/4),E+p((L+1)*R/3));f.lineTo(S,I)}else f.moveTo(x,E),f.lineTo(b,w),f.lineTo(S,I);f.clip(),f.transform(T[0],T[2],T[1],T[3],b,w),f.translate(d[0]-O,d[3]-C),f.scale(n/r,-n/r),f.drawImage(m.canvas,0,0),f.restore()}})),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,r){var n=t.target,i=(n[0][0]-v[0])/o,s=-(n[0][1]-v[1])/o,a=(n[1][0]-v[0])/o,l=-(n[1][1]-v[1])/o,u=(n[2][0]-v[0])/o,c=-(n[2][1]-v[1])/o;f.beginPath(),f.moveTo(a,l),f.lineTo(i,s),f.lineTo(u,c),f.closePath(),f.stroke()})),f.restore()),f.canvas}var gm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ym=function(t){function e(e,r,n,i,o,s,a,l,u,c,h,f){var p=t.call(this,o,uu)||this;p.renderEdges_=void 0!==h&&h,p.contextOptions_=f,p.pixelRatio_=a,p.gutter_=l,p.canvas_=null,p.sourceTileGrid_=r,p.targetTileGrid_=i,p.wrappedTileCoord_=s||o,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var d=i.getTileCoordExtent(p.wrappedTileCoord_),g=p.targetTileGrid_.getExtent(),m=p.sourceTileGrid_.getExtent(),_=g?Ft(d,g):d;if(0===Pt(_))return p.state=pu,p;var v=e.getExtent();v&&(m=m?Ft(m,v):v);var b=i.getResolution(p.wrappedTileCoord_[0]),w=function(t,e,r,n){var i=Mt(r),o=pm(t,e,i,n);return(!isFinite(o)||o<=0)&&Tt(r,(function(r){return o=pm(t,e,r,n),isFinite(o)&&o>0})),o}(e,n,_,b);if(!isFinite(w)||w<=0)return p.state=pu,p;var x=void 0!==c?c:.5;if(p.triangulation_=new cm(e,n,_,m,w*x,b),0===p.triangulation_.getTriangles().length)return p.state=pu,p;p.sourceZ_=r.getZForResolution(w);var E=p.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(E[1]=y(E[1],m[1],m[3]),E[3]=y(E[3],m[1],m[3])):E=Ft(E,m)),Pt(E)){for(var S=r.getTileRangeForExtentAndZ(E,p.sourceZ_),I=S.minX;I<=S.maxX;I++)for(var O=S.minY;O<=S.maxY;O++){var C=u(p.sourceZ_,I,O,a);C&&p.sourceTiles_.push(C)}0===p.sourceTiles_.length&&(p.state=pu)}else p.state=pu;return p}return gm(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,r,n){e&&e.getState()==hu&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=fu;else{var e=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(e),n="number"==typeof r?r:r[0],i="number"==typeof r?r:r[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=dm(n,i,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.contextOptions_),this.state=hu}this.changed()},e.prototype.load=function(){if(this.state==uu){this.state=cu,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,r,n){var i=e.getState();if(i==uu||i==cu){t++;var o=fa(e,$s,(function(r){var n=e.getState();n!=hu&&n!=fu&&n!=pu||(da(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,r){t.getState()==uu&&t.load()}))}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(da),this.sourcesListenerKeys_=null},e}(em),mm=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},t.prototype.get=function(t,e){var r=this.entries_[t];return ut(void 0!==r,15),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_},t.prototype.remove=function(t){var e=this.entries_[t];return ut(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.key_;return e},t.prototype.getValues=function(){var t,e=new Array(this.count_),r=0;for(t=this.newest_;t;t=t.older)e[r++]=t.value_;return e},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},t.prototype.set=function(t,e){ut(!(t in this.entries_),16);var r={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[t]=r,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}(),_m=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _m(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=fg(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(hg(e.tileCoord)),e.release())}.bind(this))}},e}(mm),bm="tileloadstart",wm="tileloadend",xm="tileloaderror",Em=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Sm(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Im=function(t){function e(e){var r=t.call(this)||this;r.projection=ye(e.projection),r.attributions_=Sm(e.attributions),r.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,r.loading=!1,r.state_=void 0!==e.state?e.state:Ua,r.wrapX_=void 0!==e.wrapX&&e.wrapX,r.viewResolver=null,r.viewRejector=null;var n=r;return r.viewPromise_=new Promise((function(t,e){n.viewResolver=t,n.viewRejector=e})),r}return Em(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return Object(st.b)()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getContextOptions=function(){},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Sm(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(wa);function Om(t){var e=t.getDefaultTileGrid();return e||(e=Pm(t),t.setDefaultTileGrid(e)),e}function Cm(t){var e=t||{},r=e.extent||ye("EPSG:3857").getExtent(),n={extent:r,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Tm(r,e.maxZoom,e.tileSize,e.maxResolution)};return new gg(n)}function Tm(t,e,r,n){for(var i=void 0!==e?e:42,o=At(t),s=Gt(t),a=Vc(void 0!==r?r:wu),l=n>0?n:Math.max(s/a[0],o/a[1]),u=i+1,c=new Array(u),h=0;h<u;++h)c[h]=l/Math.pow(2,h);return c}function Pm(t,e,r,n){return function(t,e,r,n){var i=void 0!==n?n:J,o=Tm(t,e,r);return new gg({extent:t,origin:kt(t,i),resolutions:o,tileSize:r})}(Rm(t),e,r,n)}function Rm(t){var e=(t=ye(t)).getExtent();if(!e){var r=180*p[d.DEGREES]/t.getMetersPerUnit();e=vt(-r,-r,r,r)}return e}var Lm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Mm=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;r.on,r.once,r.un,r.opaque_=void 0!==e.opaque&&e.opaque,r.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,r.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var n=e.tileGrid;return n&&Vc(n.getTileSize(n.getMinZoom()),[256,256]),r.tileCache=new vm(e.cacheSize||0),r.tmpSize=[0,0],r.key_=e.key||"",r.tileOptions={transition:e.transition},r.zDirection=e.zDirection?e.zDirection:0,r}return Lm(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var r=this.getTileCacheForProjection(t);r&&r.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,r,n){var i=this.getTileCacheForProjection(t);if(!i)return!1;for(var o,s,a,l=!0,u=r.minX;u<=r.maxX;++u)for(var c=r.minY;c<=r.maxY;++c)s=cg(e,u,c),a=!1,i.containsKey(s)&&(a=(o=i.get(s)).getState()===hu)&&(a=!1!==n(o)),a||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,r,n,i){return Object(st.b)()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Om(t)},e.prototype.getTileCacheForProjection=function(t){return ut(Ee(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,r){var n=this.getTileGridForProjection(r),i=this.getTilePixelRatio(e),o=Vc(n.getTileSize(t),this.tmpSize);return 1==i?o:Bc(o,i,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var r=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(t=function(t,e,r){var n=e[0],i=t.getTileCoordCenter(e),o=Rm(r);if(dt(o,i))return e;var s=Gt(o),a=Math.ceil((o[0]-i[0])/s);return i[0]+=s*a,t.getTileCoordForCoordAndZ(i,n)}(n,t,r)),function(t,e){var r=t[0],n=t[1],i=t[2];if(e.getMinZoom()>r||r>e.getMaxZoom())return!1;var o=e.getFullTileRange(r);return!o||o.containsXY(n,i)}(t,n)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,e){var r=this.getTileCacheForProjection(e);t>r.highWaterMark&&(r.highWaterMark=t)},e.prototype.useTile=function(t,e,r,n){},e}(Im),km=function(t){function e(e,r){var n=t.call(this,e)||this;return n.tile=r,n}return Lm(e,t),e}(Xs),Nm=Mm;function Am(t,e){var r=/\{z\}/g,n=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){return s?t.replace(r,s[0].toString()).replace(n,s[1].toString()).replace(i,s[2].toString()).replace(o,(function(){var t=s[0],r=e.getFullTileRange(t);return ut(r,55),(r.getHeight()-s[2]-1).toString()})):void 0}}function Fm(t,e){for(var r=t.length,n=new Array(r),i=0;i<r;++i)n[i]=Am(t[i],e);return Dm(n)}function Dm(t){return 1===t.length?t[0]:function(e,r,n){if(e){var i=E(pg(e),t.length);return t[i](e,r,n)}}}function jm(t,e,r){}function Gm(t){var e=[],r=/\{([a-z])-([a-z])\}/.exec(t);if(r){var n=r[1].charCodeAt(0),i=r[2].charCodeAt(0),o=void 0;for(o=n;o<=i;++o)e.push(t.replace(r[0],String.fromCharCode(o)));return e}if(r=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(r[2],10),a=parseInt(r[1],10);a<=s;a++)e.push(t.replace(r[0],a.toString()));return e}return e.push(t),e}var zm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Um=function(t){function e(r){var n=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,opaque:r.opaque,projection:r.projection,state:r.state,tileGrid:r.tileGrid,tilePixelRatio:r.tilePixelRatio,wrapX:r.wrapX,transition:r.transition,key:r.key,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection})||this;return n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction,n.tileLoadFunction=r.tileLoadFunction,r.tileUrlFunction&&(n.tileUrlFunction=r.tileUrlFunction),n.urls=null,r.urls?n.setUrls(r.urls):r.url&&n.setUrl(r.url),n.tileLoadingKeys_={},n}return zm(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,r=t.target,n=Object(st.c)(r),i=r.getState();i==cu?(this.tileLoadingKeys_[n]=!0,e=bm):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=i==fu?xm:i==hu?wm:void 0),null!=e&&this.dispatchEvent(new km(e,r))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=Gm(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Fm(t,this.tileGrid),e):this.setKey(e)},e.prototype.tileUrlFunction=function(t,e,r){},e.prototype.useTile=function(t,e,r){var n=cg(t,e,r);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Nm),Bm=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Vm(t,e){t.getImage().src=e}var qm=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Vm,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return r.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,r.tileClass=void 0!==e.tileClass?e.tileClass:um,r.tileCacheForProjection={},r.tileGridForProjection={},r.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,r.contextOptions_=!1===e.imageSmoothing?Qy:void 0,r.renderReprojectionEdges_=!1,r}return Bm(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var r=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==r?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[n];i.expireCache(i==r?e:{})}},e.prototype.getContextOptions=function(){return this.contextOptions_},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Ee(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){return t.prototype.getKey.call(this)+(this.contextOptions_?"\n"+JSON.stringify(this.contextOptions_):"")},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Ee(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Ee(e,t)){var r=Object(st.c)(t);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=Om(t)),this.tileGridForProjection[r]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Ee(e,t))return this.tileCache;var r=Object(st.c)(t);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new vm(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]},e.prototype.createTile_=function(t,e,r,n,i,o){var s=[t,e,r],a=this.getTileCoordForTileUrlFunction(s,i),l=a?this.tileUrlFunction(a,n,i):void 0,u=new this.tileClass(s,void 0!==l?uu:pu,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener($s,this.handleTileChange.bind(this)),u},e.prototype.getTile=function(t,e,r,n,i){var o=this.getProjection();if(o&&i&&!Ee(o,i)){var s=this.getTileCacheForProjection(i),a=[t,e,r],l=void 0,u=hg(a);s.containsKey(u)&&(l=s.get(u));var c=this.getKey();if(l&&l.key==c)return l;var h=this.getTileGridForProjection(o),f=this.getTileGridForProjection(i),p=this.getTileCoordForTileUrlFunction(a,i),d=new ym(o,h,i,f,a,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,r,n){return this.getTileInternal(t,e,r,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);return d.key=c,l?(d.interimTile=l,d.refreshInterimChain(),s.replace(u,d)):s.set(u,d),d}return this.getTileInternal(t,e,r,n,o||i)},e.prototype.getTileInternal=function(t,e,r,n,i){var o=null,s=cg(t,e,r),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var l=o;o=this.createTile_(t,e,r,n,i,a),l.getState()==uu?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,r,n,i,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var r=ye(t);if(r){var n=Object(st.c)(r);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(Um),Ym="carmentaserver",Wm="geoserver",Xm="mapserver",Hm="qgis";function Zm(t,e){var r=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&r.push(t+"="+encodeURIComponent(e[t]))}));var n=r.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+n}var Km=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$m=function(t){function e(e){var r=this,n=e||{},i=n.params||{},o=!("TRANSPARENT"in i)||i.TRANSPARENT;return(r=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,opaque:!o,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileClass:n.tileClass,tileGrid:n.tileGrid,tileLoadFunction:n.tileLoadFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).gutter_=void 0!==n.gutter?n.gutter:0,r.params_=i,r.v13_=!0,r.serverType_=n.serverType,r.hidpi_=void 0===n.hidpi||n.hidpi,r.tmpExtent_=[1/0,1/0,-1/0,-1/0],r.updateV13_(),r.setKey(r.getKeyForParams_()),r}return Km(e,t),e.prototype.getFeatureInfoUrl=function(t,e,r,n){var i=ye(r),o=this.getProjection(),s=this.getTileGrid();s||(s=this.getTileGridForProjection(i));var a=s.getZForResolution(e,this.zDirection),l=s.getTileCoordForCoordAndZ(t,a);if(!(s.getResolutions().length<=l[0])){var u=s.getResolution(l[0]),c=s.getTileCoordExtent(l,this.tmpExtent_),h=Vc(s.getTileSize(l[0]),this.tmpSize),f=this.gutter_;0!==f&&(h=zc(h,f,this.tmpSize),c=ht(c,u*f,c)),o&&o!==i&&(u=pm(o,i,t,u),c=Ce(c,i,o),t=Oe(t,i,o));var p={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};V(p,this.params_,n);var d=Math.floor((t[0]-c[0])/u),g=Math.floor((c[3]-t[1])/u);return p[this.v13_?"I":"X"]=d,p[this.v13_?"J":"Y"]=g,this.getRequestUrl_(l,h,c,1,o||i,p)}},e.prototype.getLegendUrl=function(t,e){if(void 0!==this.urls[0]){var r={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var n=this.params_.LAYERS;if(!(!Array.isArray(n)||1===n.length))return;r.LAYER=n}if(void 0!==t){var i=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=t*i/28e-5}return V(r,e),Zm(this.urls[0],r)}},e.prototype.getGutter=function(){return this.gutter_},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,r,n,i,o){var s=this.urls;if(s){if(o.WIDTH=e[0],o.HEIGHT=e[1],o[this.v13_?"CRS":"SRS"]=i.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=n)switch(this.serverType_){case Wm:var a=90*n+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+a:o.FORMAT_OPTIONS="dpi:"+a;break;case Xm:o.MAP_RESOLUTION=90*n;break;case Ym:case Hm:o.DPI=90*n;break;default:ut(!1,52)}var l,u=i.getAxisOrientation(),c=r;if(this.v13_&&"ne"==u.substr(0,2)){var h=void 0;h=r[0],c[0]=r[1],c[1]=h,h=r[2],c[2]=r[3],c[3]=h}if(o.BBOX=c.join(","),1==s.length)l=s[0];else l=s[E(pg(t),s.length)];return Zm(l,o)}},e.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var r in this.params_)e[t++]=r+"-"+this.params_[r];return e.join("/")},e.prototype.updateParams=function(t){V(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},e.prototype.updateV13_=function(){var t=this.params_.VERSION||Jy;this.v13_=Jt(t,"1.3")>=0},e.prototype.tileUrlFunction=function(t,e,r){var n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(r)),!(n.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var i=n.getResolution(t[0]),o=n.getTileCoordExtent(t,this.tmpExtent_),s=Vc(n.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&(s=zc(s,a,this.tmpSize),o=ht(o,i*a,o)),1!=e&&(s=Bc(s,e,this.tmpSize));var l={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return V(l,this.params_),this.getRequestUrl_(t,s,o,e,r,l)}},e}(qm);function Jm(t){return(Jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e_(t,e,r){return(e_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o_(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function r_(t,e){return(r_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=o_(t);if(e){var i=o_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return i_(this,r)}}function i_(t,e){return!e||"object"!==Jm(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o_(t){return(o_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r_(t,e)}(o,t);var e,r,n,i=n_(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Qm(this,o);var e=t;return _V(t.tileLoadFunction)&&(e.tileLoadFunction=o.tileLoadFunction),i.call(this,e)}return e=o,n=[{key:"tileLoadFunction",value:function(t,e){var r=t;r.getImage().src="".concat(e,"&_=").concat(this.revision_),null!=M.config.ticket&&(r.getImage().src+="&ticket=".concat(M.config.ticket))}}],(r=[{key:"changed",value:function(){_V(this.tileCache)||this.tileCache.clear(),e_(o_(o.prototype),"changed",this).call(this)}}])&&t_(e.prototype,r),n&&t_(e,n),o}($m),a_=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),l_=function(t){function e(e,r,n,i,o,s,a){var l=this,u=e.getExtent(),c=r.getExtent(),h=c?Ft(n,c):n,f=pm(e,r,Mt(h),i),p=new cm(e,r,h,u,.5*f,i),d=s(p.calculateSourceExtent(),f,o),g=d?zd:qd,y=d?d.getPixelRatio():1;return(l=t.call(this,n,i,y,g)||this).targetProj_=r,l.maxSourceExtent_=u,l.triangulation_=p,l.targetResolution_=i,l.targetExtent_=n,l.sourceImage_=d,l.sourcePixelRatio_=y,l.contextOptions_=a,l.canvas_=null,l.sourceListenerKey_=null,l}return a_(e,t),e.prototype.disposeInternal=function(){this.state==Ud&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==Bd){var e=Gt(this.targetExtent_)/this.targetResolution_,r=At(this.targetExtent_)/this.targetResolution_;this.canvas_=dm(e,r,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.contextOptions_)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==zd){this.state=Ud,this.changed();var t=this.sourceImage_.getState();t==Bd||t==Vd?this.reproject_():(this.sourceListenerKey_=fa(this.sourceImage_,$s,(function(t){var e=this.sourceImage_.getState();e!=Bd&&e!=Vd||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){da(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(nm),u_=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c_="imageloadstart",h_="imageloadend",f_="imageloaderror",p_=function(t){function e(e,r){var n=t.call(this,e)||this;return n.image=r,n}return u_(e,t),e}(Xs);function d_(t,e){t.getImage().src=e}var g_=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state})||this;return r.on,r.once,r.un,r.resolutions_=void 0!==e.resolutions?e.resolutions:null,r.reprojectedImage_=null,r.reprojectedRevision_=0,r.contextOptions_=!1===e.imageSmoothing?Qy:void 0,r}return u_(e,t),e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getContextOptions=function(){return this.contextOptions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Be(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,r,n){var i=this.getProjection();if(i&&n&&!Ee(i,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ee(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&Et(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new l_(i,n,t,e,r,function(t,e,r){return this.getImageInternal(t,e,r,i)}.bind(this),this.contextOptions_),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return i&&(n=i),this.getImageInternal(t,e,r,n)},e.prototype.getImageInternal=function(t,e,r,n){return Object(st.b)()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case Ud:this.loading=!0,this.dispatchEvent(new p_(c_,e));break;case Bd:this.loading=!1,this.dispatchEvent(new p_(h_,e));break;case Vd:this.loading=!1,this.dispatchEvent(new p_(f_,e))}},e}(Im),y_=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),m_=[101,101],__=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{attributions:n.attributions,imageSmoothing:n.imageSmoothing,projection:n.projection,resolutions:n.resolutions})||this).crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null,r.url_=n.url,r.imageLoadFunction_=void 0!==n.imageLoadFunction?n.imageLoadFunction:d_,r.params_=n.params||{},r.v13_=!0,r.updateV13_(),r.serverType_=n.serverType,r.hidpi_=void 0===n.hidpi||n.hidpi,r.image_=null,r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==n.ratio?n.ratio:1.5,r}return y_(e,t),e.prototype.getFeatureInfoUrl=function(t,e,r,n){if(void 0!==this.url_){var i=ye(r),o=this.getProjection();o&&o!==i&&(e=pm(o,i,t,e),t=Oe(t,i,o));var s=Nt(t,e,0,m_),a={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};V(a,this.params_,n);var l=Math.floor((t[0]-s[0])/e),u=Math.floor((s[3]-t[1])/e);return a[this.v13_?"I":"X"]=l,a[this.v13_?"J":"Y"]=u,this.getRequestUrl_(s,m_,1,o||i,a)}},e.prototype.getLegendUrl=function(t,e){if(void 0!==this.url_){var r={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){var n=this.params_.LAYERS;if(!(!Array.isArray(n)||1===n.length))return;r.LAYER=n}if(void 0!==t){var i=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=t*i/28e-5}return V(r,e),Zm(this.url_,r)}},e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,r,n){if(void 0===this.url_)return null;e=this.findNearestResolution(e),1==r||this.hidpi_&&void 0!==this.serverType_||(r=1);var i=e/r,o=Mt(t),s=Nt(o,i,0,[Math.ceil(Gt(t)/i),Math.ceil(At(t)/i)]),a=Nt(o,i,0,[Math.ceil(this.ratio_*Gt(t)/i),Math.ceil(this.ratio_*At(t)/i)]),l=this.image_;if(l&&this.renderedRevision_==this.getRevision()&&l.getResolution()==e&&l.getPixelRatio()==r&&gt(l.getExtent(),s))return l;var u={SERVICE:"WMS",VERSION:Jy,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};V(u,this.params_),this.imageSize_[0]=Math.round(Gt(a)/i),this.imageSize_[1]=Math.round(At(a)/i);var c=this.getRequestUrl_(a,this.imageSize_,r,n,u);return this.image_=new sm(a,e,r,c,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener($s,this.handleImageChange.bind(this)),this.image_},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.getRequestUrl_=function(t,e,r,n,i){if(ut(void 0!==this.url_,9),i[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(i.STYLES=""),1!=r)switch(this.serverType_){case Wm:var o=90*r+.5|0;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+o:i.FORMAT_OPTIONS="dpi:"+o;break;case Xm:i.MAP_RESOLUTION=90*r;break;case Ym:case Hm:i.DPI=90*r;break;default:ut(!1,8)}i.WIDTH=e[0],i.HEIGHT=e[1];var s,a=n.getAxisOrientation();return s=this.v13_&&"ne"==a.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,i.BBOX=s.join(","),Zm(this.url_,i)},e.prototype.getUrl=function(){return this.url_},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},e.prototype.updateParams=function(t){V(this.params_,t),this.updateV13_(),this.image_=null,this.changed()},e.prototype.updateV13_=function(){var t=this.params_.VERSION||Jy;this.v13_=Jt(t,"1.3")>=0},e}(g_);function v_(t){return(v_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function x_(t,e,r){return(x_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O_(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function E_(t,e){return(E_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=O_(t);if(e){var i=O_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I_(this,r)}}function I_(t,e){return!e||"object"!==v_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function O_(t){return(O_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E_(t,e)}(o,t);var e,r,n,i=S_(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b_(this,o);var r=e;return(t=i.call(this,r)).imageLoadFunction_=r.imageLoadFunction||t.imageLoadFunction,t}return e=o,(r=[{key:"changed",value:function(){x_(O_(o.prototype),"changed",this).call(this)}},{key:"imageLoadFunction",value:function(t,e){var r=t;r.getImage().src="".concat(e,"&_=").concat(this.revision_),null!=M.config.ticket&&(r.getImage().src+="&ticket=".concat(M.config.ticket))}}])&&w_(e.prototype,r),n&&w_(e,n),o}(__);function T_(t){return(T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function L_(t,e){return(L_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=N_(t);if(e){var i=N_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return k_(this,r)}}function k_(t,e){return!e||"object"!==T_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function N_(t){return(N_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L_(t,e)}(o,t);var e,r,n,i=M_(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return P_(this,o),(t=i.call(this,e,r)).facadeLayer_=null,t.options=e,t.layers=[],t.displayInLayerSwitcher_=!0,t.getCapabilitiesPromise=null,t.extentPromise=null,t.extent=null,t.resolutions_=null,t.extentProj_=null,!1===t.options.visibility&&(t.visibility=!1),_V(t.tiled)&&(t.tiled=!0!==t.options.singleTile),_V(t.options.numZoomLevels)&&(t.options.numZoomLevels=16),_V(t.options.animated)&&(t.options.animated=!1),t.styles=t.options.styles||"",t.sldBody=e.sldBody,t.zIndex_=dv.Z_INDEX.WMS,t}return e=o,(r=[{key:"setVisible",value:function(t){var e=this;if(this.visibility=t,!0===this.inRange())if(!0===t&&!0!==this.transparent){this.map.getBaseLayers().filter((function(t){return!t.equals(e)&&t.isVisible()})).forEach((function(t){return t.setVisible(!1)})),_V(this.ol3Layer)||this.ol3Layer.setVisible(t);var r=this.map.getZoom();this.map.getImpl().updateResolutionsFromBaseLayer(),_V(r)||this.map.setZoom(r)}else _V(this.ol3Layer)||this.ol3Layer.setVisible(t)}},{key:"isQueryable",value:function(){return!1!==this.options.queryable}},{key:"addTo",value:function(t){if(this.map=t,this.fire(Af),!yV(this.options)&&!yV(this.options.minScale)&&!yV(this.options.maxScale)){var e=this.map.getProjection().units;this.options.minResolution=LV(this.options.minScale,e),this.options.maxResolution=LV(this.options.maxScale,e)}_V(this.name)?this.addAllLayers_():this.addSingleLayer_(),this.legendUrl_===DV([M.config.THEME_URL,Ad.LEGEND_DEFAULT])&&(this.legendUrl_=OV(this.url,{SERVICE:"WMS",VERSION:this.version,REQUEST:"GetLegendGraphic",LAYER:this.name,FORMAT:"image/png",EXCEPTIONS:"image/png"}))}},{key:"setResolutions",value:function(t){var e=this;this.resolutions_=t,this.facadeLayer_.calculateMaxExtent().then((function(r){if(!_V(e.ol3Layer)){var n=e.options.minResolution,i=e.options.maxResolution,o=e.createOLSource_(t,n,i,r);e.ol3Layer.setSource(o),e.ol3Layer.setExtent(r)}}))}},{key:"addSingleLayer_",value:function(){var t=this;this.facadeLayer_.calculateMaxExtent().then((function(e){var r=t.options.minResolution,n=t.options.maxResolution,i=t.opacity_,o=t.zIndex_,s=t.visibility&&!1!==t.options.visibility,a=t.map.getResolutions();if(_V(a)&&!_V(t.resolutions_))a=t.resolutions_;else if(_V(a)){var l=t.getNumZoomLevels(),u=t.map.getMapImpl().getSize(),c=t.map.getProjection().units;a=_V(r)||_V(n)?MV(e,u,l,c):RV(r,n,l)}var h=t.createOLSource_(a,r,n,e);!0===t.tiled?t.ol3Layer=new rg(GV({visible:s,source:h,extent:e,minResolution:r,maxResolution:n,opacity:i,zIndex:o},t.vendorOptions_,!0)):t.ol3Layer=new lg(GV({visible:s,source:h,extent:e,minResolution:r,maxResolution:n,opacity:i,zIndex:o},t.vendorOptions_,!0)),t.map.getMapImpl().addLayer(t.ol3Layer),t.facadeLayer_.fire(ep),t.isVisible()&&!t.inRange()?t.setVisible(!1):t.setVisible(t.visibility),null!==o&&t.setZIndex(o),null!==t.resolutions_&&t.setResolutions(t.resolutions_);var f=!1===t.transparent||!0===t.options.animated;t.ol3Layer.set("animated",f)}))}},{key:"createOLSource_",value:function(t,e,r,n){var i=this,o=this.vendorOptions_.source;if(_V(this.vendorOptions_.source)){var s={LAYERS:this.name,TILED:!0,VERSION:this.version,TRANSPARENT:this.transparent,FORMAT:"image/png",STYLES:this.styles};_V(this.sldBody)||(s.SLD_BODY=this.sldBody),_V(this.options.params)||Object.keys(this.options.params).forEach((function(t){s[t.toUpperCase()]=i.options.params[t]}));var a=this.opacity_,l=this.zIndex_;if(!0===this.tiled){var u=Rt(n);o=new s_({url:this.url,params:s,tileGrid:new gg({resolutions:t,extent:n,origin:u}),extent:n,minResolution:e,maxResolution:r,opacity:a,zIndex:l})}else o=new C_({url:this.url,params:s,resolutions:t,extent:n,minResolution:e,maxResolution:r,opacity:a,zIndex:l})}return o}},{key:"addAllLayers_",value:function(){var t=this;this.getCapabilities().then((function(e){e.getLayers().forEach((function(e){var r=new q_({url:t.url,name:e.name,version:e.version,tiled:t.tiled},t.vendorOptions_);t.layers.push(r)})),t.map.addWMS(t.layers);var r=t.layers.length;t.layers.forEach((function(t){t.setZIndex(dv.Z_INDEX.WMS+r),r+=1}))}))}},{key:"getExtent",value:function(){var t=this,e=ye(this.map.getProjection().code);return this.extentPromise=new Promise((function(r,n){_V(t.extent_)?t.getCapabilities().then((function(n){t.extent_=n.getLayerExtent(t.name),t.extentProj_=e,r(t.extent_)})):(t.extent_=ry.transformExtent(t.extent_,t.extentProj_,e),t.extentProj_=e,r(t.extent_))})),this.extentPromise}},{key:"getMinResolution",value:function(){return this.options.minResolution}},{key:"getMaxResolution",value:function(){return this.options.maxResolution}},{key:"updateMinMaxResolution",value:function(t){_V(this.options.minResolution)||(this.options.minResolution=LV(this.options.minScale,t.units),this.ol3Layer.setMinResolution(this.options.minResolution)),_V(this.options.maxResolution)||(this.options.maxResolution=LV(this.options.maxScale,t.units),this.ol3Layer.setMaxResolution(this.options.maxResolution))}},{key:"setMaxExtent",value:function(t){var e=this.options.minResolution,r=this.options.maxResolution,n=this.getOLLayer();if(!_V(n)&&(n.setExtent(t),!0===this.tiled)){var i=this.map.getResolutions();if(_V(i)&&!_V(this.resolutions_)&&(i=this.resolutions_),!_V(i)){var o=this.createOLSource_(i,e,r,t);n.setSource(o)}}}},{key:"getNumZoomLevels",value:function(){return this.options.numZoomLevels}},{key:"getLayers",value:function(){return this.layers}},{key:"getCapabilities",value:function(){if(_V(this.getCapabilitiesPromise)){var t=this.url,e=this.version,r=this.map.getProjection(),n=this.map.getTicket();this.getCapabilitiesPromise=new Promise((function(i,o){var s=TV(t,e,n);uV(s).then((function(e){if("xml"in e&&!_V(e.xml)){var n=e.xml,o=(new $y).customRead(n),a=new fy(o,t,r);i(a)}else uV(s,"",{ticket:!1}).then((function(e){var n=e.xml,o=(new $y).customRead(n),s=new fy(o,t,r);i(s)}))}))}))}return this.getCapabilitiesPromise}},{key:"getLegendURL",value:function(){return this.legendUrl_}},{key:"setLegendURL",value:function(t){this.legendUrl_=t}},{key:"refresh",value:function(){var t=this.getOLLayer();_V(t)||t.getSource().updateParams({time:Date.now()})}},{key:"getExtentFromCapabilities",value:function(t){var e=this.facadeLayer_.name,r=this.map.getProjection().code;return t.getLayerExtent(e,r)}},{key:"setFacadeObj",value:function(t){this.facadeLayer_=t}},{key:"destroy",value:function(){var t=this.map.getMapImpl();_V(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),_V(this.layers)||(this.layers.map(this.map.removeLayers,this.map),this.layers.length=0),this.map=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.cql===t.cql,e=e&&this.version===t.version),e}},{key:"cloneOLLayer",value:function(){var t=null;if(null!=this.ol3Layer){var e=this.ol3Layer.getProperties();t=!0===this.tiled?new rg(e):new lg(e)}return t}}])&&R_(e.prototype,r),n&&R_(e,n),o}(cy);A_.LEGEND_IMAGE=null;var F_=A_;function D_(t){return(D_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function z_(t,e){return(z_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=V_(t);if(e){var i=V_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return B_(this,r)}}function B_(t,e){return!e||"object"!==D_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V_(t){return(V_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var q_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z_(t,e)}(o,t);var e,r,n,i=U_(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;j_(this,o),dV(F_)&&Of(pp("exception").wms_method),_V(t)&&Of(pp("exception").no_param);var s=Cd(t,Dp),a=new F_(r,n);return(e=i.call(this,s,a)).legend=s.legend,e.cql=s.cql,e.version=s.version,_V(s.tiled)||(e.tiled=s.tiled),e.transparent=s.transparent,e.options=r,e.wmcParent_=null,e.getCapabilitiesPromise_=null,e._updateNoCache(),e}return e=o,(r=[{key:"getMaxExtent",value:function(t){var e,r=this;if(_V(this.userMaxExtent))if(_V(this.options.wmcMaxExtent))if(_V(this.map_.userMaxExtent)){var n=this.map_.getWMC().find((function(t){return t.selected}));_V(n)?this.getCapabilities().then((function(e){var n=r.getImpl().getExtentFromCapabilities(e);if(_V(n)){var i=r.map_.getProjection().getExtent();r.maxExtent_=i}else r.maxExtent_=n;vV(t)&&t(r.maxExtent_)})):n.calculateMaxExtent().then((function(e){r.maxExtent_=e,vV(t)&&t(r.maxExtent_)}))}else this.maxExtent_=this.map_.userMaxExtent,e=this.maxExtent_;else this.maxExtent_=this.options.wmcMaxExtent,e=this.maxExtent_;else e=this.userMaxExtent;return!_V(e)&&vV(t)?t(e):_V(e)&&(e=this.maxExtent_),e}},{key:"calculateMaxExtent",value:function(){var t=this;return new Promise((function(e){return t.getMaxExtent(e)}))}},{key:"getCapabilities",value:function(){return _V(this.getCapabilitiesPromise_)&&(this.getCapabilitiesPromise_=this.getImpl().getCapabilities()),this.getCapabilitiesPromise_}},{key:"getNoCacheUrl",value:function(){return this._noCacheUrl}},{key:"getNoCacheName",value:function(){return this._noCacheName}},{key:"setWMCParent",value:function(t){this.wmcParent_=t}},{key:"getWMCParent",value:function(){return this.wmcParent_}},{key:"updateMinMaxResolution",value:function(t){return this.getImpl().updateMinMaxResolution(t)}},{key:"_updateNoCache",value:function(){var t=M.config.tileMappgins.tiledNames.indexOf(this.name);-1!==t&&BV(M.config.tileMappgins.tiledUrls[t],this.url)&&(this._noCacheUrl=M.config.tileMappgins.urls[t],this._noCacheName=M.config.tileMappgins.names[t])}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.cql===t.cql,e=e&&this.version===t.version),e}},{key:"type",get:function(){return Dp},set:function(t){dV(t)||_V(t)||t===Dp||Of("El tipo de capa debe ser '".concat(Dp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"legend",get:function(){return this.getImpl().legend},set:function(t){_V(t)?this.getImpl().legend=this.name:this.getImpl().legend=t}},{key:"tiled",get:function(){return this.getImpl().tiled},set:function(t){_V(t)?this.getImpl().tiled=!0:wV(t)?this.getImpl().tiled="true"===SV(t):this.getImpl().tiled=t}},{key:"cql",get:function(){return this.getImpl().cql},set:function(t){this.getImpl().cql=t}},{key:"version",get:function(){return this.getImpl().version},set:function(t){_V(t)?this.getImpl().version="1.1.0":this.getImpl().version=t}},{key:"options",get:function(){return this.getImpl().options},set:function(t){this.getImpl().options=t}}])&&G_(e.prototype,r),n&&G_(e,n),o}(Ad);function Y_(t){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W_(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X_(t,e){return(X_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function H_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=K_(t);if(e){var i=K_(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Z_(this,r)}}function Z_(t,e){return!e||"object"!==Y_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K_(t){return(K_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X_(t,e)}(o,t);var e,r,n,i=H_(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).userZoom_=null,e}return e=o,(r=[{key:"setUserZoom",value:function(t){this.userZoom_=t,_V(t)||this.setZoom(t)}},{key:"getUserZoom",value:function(){return this.userZoom_}},{key:"setProjection",value:function(t){this.projection_=t}},{key:"getResolutions",value:function(){return this.get("resolutions")}},{key:"setResolutions",value:function(t){this.set("resolutions",t),this.maxResolution_=t[0],this.minResolution_=t[t.length-1],this.setCenter(this.getCenter()),this.applyOptions_({minZoom:this.minZoom_,resolutions:t,zoomFactor:this.zoomFactor_,minResolution:this.minResolution_,maxResolution:this.maxResolution_,projection:this.projection_,center:this.getCenter(),constrainResolution:!0,multiWorld:!0}),_V(this.userZoom_)||this.setZoom(this.userZoom_)}}])&&W_(e.prototype,r),n&&W_(e,n),o}(Gc);r(75),r(77);function J_(t){return(J_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tv(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ev(t){return function(t){if(Array.isArray(t))return rv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return rv(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rv(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rv(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ov(t,e){return(ov=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=lv(t);if(e){var i=lv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return av(this,r)}}function av(t,e){return!e||"object"!==J_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lv(t){return(lv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var uv=[],cv=[],hv=[],fv=[Dp,zp,Up,Gp],pv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ov(t,e)}(o,t);var e,r,n,i=sv(o);function o(t,e){var r;return nv(this,o),(r=i.call(this)).facadeMap_=e,r.layers_=[],r.layerGroups_=[],r.controls_=[],r.initZoom_=!0,r.userResolutions_=null,r.userBbox_=null,r.maxExtentForResolutions_=null,r.envolvedMaxExtent_=null,r._calculatedResolutions=!1,r._resolutionsEnvolvedExtent=!1,r._resolutionsBaseLayer=!1,r.map_=new of({controls:[],target:t.id,view:new $_}),r.registerEvents_(),r.map_.addInteraction(new ih({handleEvent:function(t){return"pointermove"===t.type&&r.onMapMove_(t),!0}})),r}return e=o,n=[{key:"registerExternalFunction",value:function(t,e){var r={getLayers:uv,addLayers:hv,removeLayers:cv}[e];r.find((function(e){return e===t}))&&r.push(t)}},{key:"registerBaseLayerType",value:function(t){!fv.find((function(e){return e===t}))&&fv.push(t)}}],(r=[{key:"getLayers",value:function(t){var e=this,r=this.getWMC(t),n=this.getKML(t),i=this.getWMS(t),o=this.getWFS(t),s=this.getWMTS(t),a=this.getMVT(t),l=this.getUnknowLayers_(t),u=uv.map((function(r){return e[r](t)}));return r.concat(n).concat(i).concat(o).concat(s).concat(a).concat(l).concat(u)}},{key:"getBaseLayers",value:function(){return this.getLayers().filter((function(t){var e=!1;return fv.includes(t.type)&&(e=!0!==t.transparent),e}))}},{key:"addLayers",value:function(t){var e=t.filter((function(t){return!Xp(t.type)})),r=t.filter((function(t){return Xp(t.type)}));return this.addUnknowLayers_(e),this.facadeMap_.addWMC(r.filter((function(t){return t.type===Ap}))),this.facadeMap_.addWMS(r.filter((function(t){return t.type===Dp}))),this.facadeMap_.addWMTS(r.filter((function(t){return t.type===Gp}))),this.facadeMap_.addKML(r.filter((function(t){return t.type===Fp}))),this.facadeMap_.addWFS(r.filter((function(t){return t.type===jp}))),this.facadeMap_.addMVT(r.filter((function(t){return t.type===qp}))),hv.forEach((function(t){return t(e)})),this}},{key:"removeLayers",value:function(t){var e=t.filter((function(t){return!Xp(t.type)})),r=t.filter((function(t){return Xp(t.type)}));return r.length>0&&(this.removeWMC(r),this.removeKML(r),this.removeWMS(r),this.removeWFS(r),this.removeWMTS(r),this.removeMVT(r)),e.length>0&&(this.removeUnknowLayers_(e),cv.forEach((function(t){return t(e)}))),t.forEach((function(t){t.getLayerGroup&&!_V(t.getLayerGroup())&&t.getLayerGroup().deleteChild(t)})),Array.isArray(this.getBaseLayers())&&this.getBaseLayers().length>0||(this._resolutionsBaseLayer=!1),this.facadeMap_.fire(Vf,[t]),this}},{key:"getLayerGroups",value:function(){return this.layerGroups_}},{key:"getGroupedLayers",value:function(){var t=[],e=this.getLayerGroups();return 1===e.length?t=e[0].getAllLayers():e.length>1&&(t=e.reduce((function(t,e){return Array.isArray(t)?t.concat(e.getAllLayers()):t.getAllLayers().concat(e.getAllLayers())}))),t}},{key:"addLayerGroups",value:function(t){var e=this;return t.forEach((function(t){t.addTo(e.facadeMap_),jV(e.layerGroups_,t)||(e.layerGroups_.push(t),t.getAllLayers().forEach((function(t){e.facadeMap_.addLayers(t)})))})),this}},{key:"removeLayerGroups",value:function(t){var e=this;return(Array.isArray(t)?ev(t):[t]).forEach((function(t){e.layerGroups_.remove(t),t.destroy(),t.fire(qf,[t])})),this}},{key:"getWMC",value:function(t){var e=t,r=[],n=this.layers_.filter((function(t){return t.type===Ap}));return _V(e)&&(e=[]),mV(e)||(e=[e]),0===e.length?r=n:e.forEach((function(t){r=r.concat(n.filter((function(e){var n=!0;return r.includes(e)?n=!1:(_V(t.type)||(n=n&&t.type===e.type),_V(t.url)||(n=n&&t.url===e.url),_V(t.name)||(n=n&&t.name===e.name)),n})))}),this),r}},{key:"addWMC",value:function(t){var e=this;return t.forEach((function(t,r){t.type===Ap&&(jV(e.layers_,t)||(t.setZIndex(o.Z_INDEX.WMC),t.getImpl().addTo(e.facadeMap_),e.layers_.push(t)))}),this),this}},{key:"removeWMC",value:function(t){var e=this;return this.getWMC(t).forEach((function(t){!0===t.selected&&!1===t.isLoaded()?t.on(ep,(function(){e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),e.facadeMap_.removeWMS(t.layers),e.facadeMap_.refreshWMCSelectorControl()})):(e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),e.facadeMap_.removeWMS(t.layers)),e.facadeMap_.refreshWMCSelectorControl(),t.fire(qf,[t])}),this),this}},{key:"getKML",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===Fp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name),_V(t.extract)||(n=n&&t.extract===r.extract)),n}));e=e.concat(r)}),this),e}},{key:"addKML",value:function(t){var e=this,r=this.getBaseLayers().length>0;return t.forEach((function(t){if(t.type===Fp&&!jV(e.layers_,t)){if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),null==t.getZIndex()){var n=e.layers_.length+o.Z_INDEX.KML;t.setZIndex(n)}r||e.updateResolutionsFromBaseLayer()}}),this),this}},{key:"removeKML",value:function(t){var e=this;return this.getKML(t).forEach((function(t){e.layers_=e.layers_.filter((function(e){return!t.equals(e)})),t.getImpl().destroy(),t.fire(qf,[t])}),this),this}},{key:"getWMS",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===Dp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:t instanceof q_?n=t===r:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name),_V(t.legend)||(n=n&&t.legend===r.legend),_V(t.transparent)||(n=n&&t.transparent===r.transparent),_V(t.tiled)||(n=n&&t.tiled===r.tiled),_V(t.cql)||(n=n&&t.cql===r.cql),_V(t.version)||(n=n&&t.version===r.version)),n}));e=e.concat(r)}),this),e}},{key:"addWMS",value:function(t){var e=this,r=this.getBaseLayers().length>0,n=[];return t.forEach((function(t){if(t.type===Dp&&!jV(e.layers_,t))if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),n.push(t),!0!==t.transparent)t.setVisible(!r),r=!0,t.setZIndex(o.Z_INDEX_BASELAYER);else if(null==t.getZIndex()){var i=e.layers_.length+o.Z_INDEX.WMS;t.setZIndex(i)}})),(n.length>0&&!r||n.some((function(t){return!0!==t.transparent&&t.isVisible()})))&&this.updateResolutionsFromBaseLayer(),this}},{key:"removeWMS",value:function(t){var e=this;return this.getWMS(t).forEach((function(t){if(e.layers_=e.layers_.filter((function(e){return!t.equals(e)})),t.getImpl().destroy(),t.fire(qf,[t]),!0!==t.transparent){var r=e.facadeMap_.getBaseLayers();r.length>0&&r[0].setVisible(!0)}})),this}},{key:"getGeoJSON",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===Bp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name),_V(t.legend)||(n=n&&t.legend===r.legend)),n}));e=e.concat(r)})),e}},{key:"getWFS",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===jp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name),_V(t.namespace)||(n=n&&t.namespace===r.namespace),_V(t.legend)||(n=n&&t.legend===r.legend),_V(t.cql)||(n=n&&t.cql===r.cql),_V(t.geometry)||(n=n&&t.geometry===r.geometry),_V(t.ids)||(n=n&&t.ids===r.ids),_V(t.version)||(n=n&&t.version===r.version)),n}));e=e.concat(r)})),e}},{key:"addWFS",value:function(t){var e=this,r=this.getBaseLayers().length>0;return t.forEach((function(t){if(t.type===jp&&!jV(e.layers_,t)){if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),t.setZIndex(t.getZIndex()),null==t.getZIndex()){var n=e.layers_.length+o.Z_INDEX.WFS;t.setZIndex(n)}r||e.updateResolutionsFromBaseLayer()}})),this}},{key:"removeWFS",value:function(t){var e=this;return this.getWFS(t).forEach((function(t){e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),t.getImpl().destroy(),t.fire(qf,[t])})),this}},{key:"getWMTS",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===Gp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name),_V(t.matrixSet)||(n=n&&t.matrixSet===r.matrixSet),_V(t.legend)||(n=n&&t.legend===r.legend)),n}));e=e.concat(r)})),e}},{key:"addWMTS",value:function(t){var e=this,r=this.getBaseLayers().length>0;return t.forEach((function(t){if(t.type===Gp&&!jV(e.layers_,t))if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),!0!==t.transparent)t.getImpl().visibility=!r,r=!0,t.isVisible()&&e.updateResolutionsFromBaseLayer(),t.setZIndex(o.Z_INDEX_BASELAYER);else{if(null==t.getZIndex()){var n=e.layers_.length+o.Z_INDEX.WMTS;t.setZIndex(n)}r||e.updateResolutionsFromBaseLayer()}})),this}},{key:"removeWMTS",value:function(t){var e=this;return this.getWMTS(t).forEach((function(t){if(e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),t.getImpl().destroy(),t.fire(qf,[t]),!0!==t.transparent){var r=e.facadeMap_.getBaseLayers();r.length>0&&r[0].setVisible(!0)}})),this}},{key:"getUnknowLayers_",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return!Xp(t.type)}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:t instanceof Ad?n=t.equals(r):(_V(t.type)||(n=n&&t.type===r.type),_V(t.name)||(n=n&&t.name===r.name)),n}));e=e.concat(r)})),e}},{key:"addUnknowLayers_",value:function(t){var e=this,r=this.getBaseLayers().length>0;return t.forEach((function(t){if(!jV(e.layers_,t))if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),!0!==t.transparent)t.setVisible(!r),r=!0,t.isVisible()&&e.updateResolutionsFromBaseLayer(),t.setZIndex(o.Z_INDEX_BASELAYER);else{if(t.setZIndex(t.getZIndex()),null==t.getZIndex()){var n=e.layers_.length+o.Z_INDEX[t.type];t.setZIndex(n)}r||e.updateResolutionsFromBaseLayer()}})),this}},{key:"removeUnknowLayers_",value:function(t){var e=this;t.forEach((function(t){if(jV(e.layers_,t)&&(e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),t.getImpl().destroy(),t.fire(qf,[t]),!0!==t.transparent)){var r=e.facadeMap_.getBaseLayers();r.length>0&&r[0].setVisible(!0)}}))}},{key:"getMVT",value:function(t){var e=[],r=t,n=this.layers_.filter((function(t){return t.type===qp}));return _V(r)&&(r=[]),mV(r)||(r=[r]),0===r.length?e=n:r.forEach((function(t){var r=n.filter((function(r){var n=!0;return e.includes(r)?n=!1:(_V(t.type)||(n=n&&t.type===r.type),_V(t.url)||(n=n&&t.url===r.url),_V(t.name)||(n=n&&t.name===r.name)),n}));e=e.concat(r)})),e}},{key:"removeMVT",value:function(t){var e=this;return this.getMVT(t).forEach((function(t){e.layers_=e.layers_.filter((function(e){return!e.equals(t)})),t.getImpl().destroy(),t.fire(qf,[t])})),this}},{key:"addMVT",value:function(t){var e=this,r=this.getBaseLayers().length>0;return t.forEach((function(t){if(t.type===qp&&!jV(e.layers_,t)){if(t.getImpl().addTo(e.facadeMap_),e.layers_.push(t),t.setZIndex(t.getZIndex()),null==t.getZIndex()){var n=e.layers_.length+o.Z_INDEX.MVT;t.setZIndex(n)}r||e.updateResolutionsFromBaseLayer()}})),this}},{key:"getControls",value:function(t){var e=t,r=[],n=this.facadeMap_.getPanels().map((function(t){return t.getControls()}));n.length>0&&(n=n.reduce((function(t,e){return t.concat(e)})));var i=this.controls_.concat(n);_V(e)&&(e=[]),mV(e)||(e=[e]),0===e.length?r=i:e.forEach((function(t){r=r.concat(i.filter((function(e){var n=!1;return jV(r,e)||(wV(t)?n=t===e.name:t instanceof bp?n=t===e:bV(t)&&(n=t.name===e.name)),n})))}));var o=[];return r.forEach((function(t){o.map((function(t){return t.name})).includes(t.name)||o.push(t)})),o}},{key:"addControls",value:function(t){var e=this;return t.forEach((function(t){t instanceof Np&&e.facadeMap_.addControls("panzoom"),jV(e.controls_,t)||e.controls_.push(t)})),this}},{key:"removeControls",value:function(t){var e=this;return this.getControls(t).forEach((function(t){_V(e.map_)||e.map_.removeControl(t.getImpl()),t.destroy(),e.controls_=e.controls_.filter((function(e){var r=e.constructor===t.constructor;return _V(e.equals)||(r=!e.equals(t)),r}))})),this}},{key:"setMaxExtent",value:function(t,e){var r=t;return _V(r)||mV(r)||!bV(r)||(r=[t.x.min,t.y.min,t.x.max,t.y.max]),this.getMapImpl().getView().set("extent",r),this.updateResolutionsFromBaseLayer(),_V(r)||!1===e||this.setBbox(r),this}},{key:"getMaxExtent",value:function(){var t=this.getMapImpl().getView().get("extent");return _V(t)?this.envolvedMaxExtent_:{x:{min:t[0],max:t[2]},y:{min:t[1],max:t[3]}}}},{key:"setBbox",value:function(t,e){var r;_V(t)&&Of(pp("exception").no_bbox),this.userBbox_=t,mV(t)?r=t:bV(t)&&(r=[t.x.min,t.y.min,t.x.max,t.y.max]);var n=this.getMapImpl();return n.updateSize(),n.getView().fit(r,e),this}},{key:"getBbox",value:function(){var t=null,e=this.getMapImpl(),r=e.getView();if(!_V(r.getCenter())){var n=r.calculateExtent(e.getSize());_V(n)||(t={x:{min:n[0],max:n[2]},y:{min:n[1],max:n[3]}})}return t}},{key:"setZoom",value:function(t){return _V(t)&&Of(pp("exception").no_zoom),this.getMapImpl().getView().setUserZoom(t),this}},{key:"getZoom",value:function(){var t=null,e=this.getMapImpl().getView(),r=e.getResolution(),n=this.getResolutions();if(_V(n))_V(r)||(t=e.getZoomForResolution(r));else for(var i=0,o=n.length;i<o;i+=1)if(n[i]<=r){t=i;break}return t}},{key:"setCenter",value:function(t){_V(t)&&Of(pp("exception").no_center);var e=[t.x,t.y],r=this.getMapImpl().getView(),n=r.getCenter();return _V(n)||this.getMapImpl().getView().animate({duration:250,source:n}),r.setCenter(e),this}},{key:"getCenter",value:function(){var t=null,e=this.getMapImpl().getView().getCenter();return _V(e)||(t={x:e[0],y:e[1]}),t}},{key:"getResolutions",value:function(){return this.getMapImpl().getView().getResolutions()}},{key:"setResolutions",value:function(t,e){_V(t)&&Of(pp("exception").no_resolutions),_V(e)&&(this.userResolutions_=t);var r,n=ye(this.getProjection().code),i=this.getMapImpl(),o=i.getView().getProperties(),s=i.getView().getUserZoom(),a=i.getSize(),l=new $_(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q_(Object(r),!0).forEach((function(e){tv(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({projection:n},o));if(l.setProperties(o),l.setResolutions(t),l.setUserZoom(s),_V(s)){var u=this.facadeMap_.getBbox();if(_V(u))r=t[0];else{var c=l.getResolutionForExtent([u.x.min,u.y.min,u.x.max,u.y.max],a),h=t.map((function(t){return Math.abs(t-c)})),f=h.indexOf(Math.min.apply(Math,ev(h)));r=t[f]}}else r=t[s];return l.setResolution(r),i.setView(l),this.getWMS().forEach((function(e){e.getImpl().setResolutions(t)})),this}},{key:"getScale",value:function(){var t=this.getMapImpl().getView().getResolution(),e=this.getProjection().units,r=kV(t,e);return _V(r)||(r=r>=1e3&&r<=95e4?1e3*Math.round(r/1e3):r>=95e4?1e6*Math.round(r/1e6):Math.round(r)),r}},{key:"getExactScale",value:function(){var t=this.getMapImpl().getView().getResolution(),e=this.getProjection().units,r=kV(t,e);return Math.trunc(r)}},{key:"setProjection",value:function(t){_V(t)&&Of(pp("exception").no_projection);var e=ye(t.code);_V(e)&&(e=new g(t));var r=ye(this.getProjection().code),n=this.facadeMap_.getBbox(),i=this.getMapImpl(),o=i.getView().getUserZoom(),s=new $_({projection:e});if(s.setUserZoom(o),i.setView(s),this.facadeMap_.getWMS().forEach((function(e){e.updateMinMaxResolution(t)})),this.updateResolutionsFromBaseLayer(),!_V(n)){mV(n)||(n=[n.x.min,n.y.min,n.x.max,n.y.max]);var a=ry.transformExtent(n,r,e);this.facadeMap_.setBbox(a,{nearest:!0})}return this}},{key:"getProjection",value:function(){var t=this.getMapImpl().getView().getProjection(),e=null;return _V(t)||(e={code:t.getCode(),units:t.getUnits(),getExtent:function(){return t.getExtent()}}),e}},{key:"getMapImpl",value:function(){return this.map_}},{key:"removePopup",value:function(t){if(!_V(t)){var e=t.getImpl();this.getMapImpl().removeOverlay(e)}return this}},{key:"destroy",value:function(){this.layers_.length=0,this.controls_.length=0,this.popup_=null,this.options_=null,this.map_.setTarget(null),this.map_=null}},{key:"updateResolutionsFromBaseLayer",value:function(){var t=this,e=[],r=16,n=this.getProjection().units,i=this.getBaseLayers().filter((function(t){return t.isVisible()}))[0],o=null,s=null;_V(i)||(s=i.getImpl().getMinResolution(),o=i.getImpl().getMaxResolution(),r=i.getImpl().getNumZoomLevels()),null===this.userResolutions_&&(_V(s)||_V(o)?this.facadeMap_.calculateMaxExtent().then((function(i){if(!t._resolutionsBaseLayer&&null===t.userResolutions_){t.getMapImpl().updateSize();var o=t.getMapImpl().getSize();e=MV(i,o,r,n),t.setResolutions(e,!0),t._resolutionsEnvolvedExtent=!0,!1===t._calculatedResolutions&&(t._calculatedResolutions=!0,t.fire(rp))}})).catch((function(t){throw t})):(e=RV(s,o,r),this.setResolutions(e,!0),this._resolutionsBaseLayer=!0,!1===this._calculatedResolutions&&(this._calculatedResolutions=!0,this.fire(rp))))}},{key:"addLabel",value:function(t){return this.label=t,t.show(this.facadeMap_),this}},{key:"getLabel",value:function(){return this.label}},{key:"removeLabel",value:function(){if(!_V(this.label)){var t=this.label.getPopup();this.removePopup(t),this.label=null}}},{key:"refresh",value:function(){return this.map_.updateSize(),this}},{key:"getContainer",value:function(){return this.map_.getOverlayContainerStopEvent()}},{key:"setFacadeMap",value:function(t){this.facadeMap_=t}},{key:"registerEvents_",value:function(){var t=this;this.facadeMap_.on(rp,(function(){t.map_.updateSize()})),this.map_.on("singleclick",this.onMapClick_.bind(this)),this.map_.getView().on("change:resolution",this.zoomEvent_.bind(this)),this.map_.on("change:view",(function(e){e.oldValue.un("change:resolution",t.zoomEvent_.bind(t)),t.map_.getView().on("change:resolution",t.zoomEvent_.bind(t))}))}},{key:"zoomEvent_",value:function(t){this.getZoom()<=t.target.getZoom()&&this.facadeMap_.fire(ap,t)}},{key:"onMapClick_",value:function(t){var e=t.pixel,r=this.map_.getCoordinateFromPixel(e),n=this.facadeMap_.getLabel();_V(n)||n.hide(),this.facadeMap_.fire(up,[{pixel:e,coord:r,vendor:t}])}},{key:"onMapMove_",value:function(t){var e=t.pixel,r=this.map_.getCoordinateFromPixel(e);this.facadeMap_.fire(cp,[{pixel:e,coord:r,vendor:t}])}},{key:"getRotation",value:function(){var t,e=this.map_.getView();return _V(e)||(t=e.getRotation()),t}},{key:"setRotation",value:function(t){var e=this.map_.getView();_V(e)||e.setRotation(t)}}])&&iv(e.prototype,r),n&&iv(e,n),o}(ff);pv.Z_INDEX={},pv.Z_INDEX_BASELAYER=0,pv.Z_INDEX.WMC=1,pv.Z_INDEX.WMS=1e3,pv.Z_INDEX.WMTS=2e3,pv.Z_INDEX.OSM=2e3,pv.Z_INDEX.Mapbox=2e3,pv.Z_INDEX.KML=3e3,pv.Z_INDEX.WFS=9999,pv.Z_INDEX.Vector=9999,pv.Z_INDEX.MVT=9999,pv.Z_INDEX.GeoJSON=9999;var dv=pv,gv=r(36),yv=r.n(gv);r(79);function mv(t){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vv(t,e){return(vv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xv(t);if(e){var i=xv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wv(this,r)}}function wv(t,e){return!e||"object"!==mv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xv(t){return(xv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ev=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vv(t,e)}(o,t);var e,r,n,i=bv(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,{})).facadeMap_=null,t}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,Xc.call(this,{element:e,target:null}),t.getMapImpl().addControl(this)}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}},{key:"getElement",value:function(){return this.element}}])&&_v(e.prototype,r),n&&_v(e,n),o}(Xc);function Sv(t){return(Sv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ov(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Cv(t,e,r){return(Cv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lv(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function Tv(t,e){return(Tv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lv(t);if(e){var i=Lv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Rv(this,r)}}function Rv(t,e){return!e||"object"!==Sv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lv(t){return(Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tv(t,e)}(o,t);var e,r,n,i=Pv(o);function o(){return Iv(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"addTo",value:function(t,e){e.getElementsByTagName("select")[0].addEventListener("change",(function(e){var r=t.getWMC(e.target.options[e.target.selectedIndex].text)[0],n=t.getZoom();r.select(),t.setZoom(n)})),Cv(Lv(o.prototype),"addTo",this).call(this,t,e)}}])&&Ov(e.prototype,r),n&&Ov(e,n),o}(Ev);function kv(t){return(kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nv(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Av(t,e,r){return(Av="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gv(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function Fv(t,e){return(Fv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gv(t);if(e){var i=Gv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return jv(this,r)}}function jv(t,e){return!e||"object"!==kv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gv(t){return(Gv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fv(t,e)}(o,t);var e,r,n,i=Dv(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new Mv;return t=i.call(this,e,o.NAME),dV(Mv)&&Of(pp("exception").wmcselector_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(yv.a,{vars:{layers:t.getWMC(),title:pp("wmcselector").title}})}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.name===t.name),e}},{key:"destroy",value:function(){Av(Gv(o.prototype),"destroy",this).call(this);var t=this.getPanel();_V(t)||t.removeClassName("m-with-wmcselector")}}])&&Nv(e.prototype,r),n&&Nv(e,n),o}(bp);zv.NAME="wmcselector";var Uv=zv,Bv=(r(81),r(17)),Vv=r.n(Bv);function qv(t){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yv(t,e){return(Yv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Hv(t);if(e){var i=Hv(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Xv(this,r)}}function Xv(t,e){return!e||"object"!==qv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hv(t){return(Hv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yv(t,e)}(r,t);var e=Wv(r);function r(t,n,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(o=e.call(this)).id_=t,o.title_=n,o.order_=i,o.zindex_=null,o}return r}(ff);function Kv(t){return(Kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $v(t){return function(t){if(Array.isArray(t))return Jv(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Jv(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jv(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jv(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Qv(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tb(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rb(t,e){return(rb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ob(t);if(e){var i=ob(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ib(this,r)}}function ib(t,e){return!e||"object"!==Kv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ob(t){return(ob=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rb(t,e)}(o,t);var e,r,n,i=nb(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qv(Object(r),!0).forEach((function(e){tb(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qv(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t);_V(r.id)&&(r.id=CV("mapea_layer_group_")),_V(r.title)&&(r.title="Grupo de capas"),_V(r.zIndex)&&(r.zIndex=1e4),_V(r.order)&&(r.order=0);var n=new Zv(r);return(e=i.call(this,n)).id=r.id,e.title=r.title,e.collapsed=!!r.collapsed,e.order=r.order,e.parent=null,e.children_=[],e.impl_=n,e.zIndex_=r.zIndex,Array.isArray(r.children)&&e.addChildren(r.children),e}return e=o,n=[{key:"findGroupById",value:function(t,e){var r=null;if(mV(e)&&e.length>0&&null==(r=e.find((function(e){return e instanceof o&&e.id===t})))){var n=e.map((function(t){return t.getChildren()})).reduce((function(t,e){return t.concat(e)}),[]).filter((function(t){return t instanceof o}));r=o.findGroupById(t,n)}return r}}],(r=[{key:"addTo",value:function(t){this.map=t,this.fire(Af)}},{key:"setVisible",value:function(t){this.getAllLayers().forEach((function(e){return!0===e.transparent&&e.setVisible(t)}))}},{key:"setZIndex",value:function(t){this.zIndex_=t;var e=$v(this.getChildren()).reverse(),r=t;e.forEach((function(t){t.setZIndex(r),r+=1}))}},{key:"getZIndex",value:function(t){return this.zIndex_}},{key:"addChild",value:function(t,e){var r=this.getZIndex()+this.children_.length,n=t;_V(e)?this.children_.unshift(n):(this.children_.splice(e,0,n),r=this.getZIndex()+e),n instanceof o?n.parent=this:n instanceof Ad&&(n.setLayerGroup(this),n.setZIndex(r),_V(this.map)||this.map.getRootLayers().some((function(t){return t.equals(n)}))||(this.map.addLayers(n),n instanceof o&&this.map.addLayerGroup(n)))}},{key:"deleteChild",value:function(t){var e=t;e instanceof o?(e.parent=null,this.map.removeLayerGroup(e)):e instanceof Ad&&(this.map.removeLayers(e),this.ungroup(t))}},{key:"deleteChildren",value:function(t){t.forEach(this.deleteChild,this)}},{key:"ungroup",value:function(t){t.setLayerGroup(null),this.children_.remove(t)}},{key:"addChildren",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t;Array.isArray(t)||(e=[e]),e.forEach(this.addChild,this)}},{key:"getChildren",value:function(){return this.children_}},{key:"getAllLayers",value:function(){var t=[];return this.getChildren().forEach((function(e){e instanceof Ad?t.push(e):e instanceof o&&(t=t.concat(e.getAllLayers()))})),t}},{key:"destroy",value:function(){this.map.removeLayers(this.getAllLayers())}}])&&eb(e.prototype,r),n&&eb(e,n),o}(ff);function ab(t){return(ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ub(t,e,r){return(ub="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pb(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function cb(t,e){return(cb=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hb(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pb(t);if(e){var i=pb(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fb(this,r)}}function fb(t,e){return!e||"object"!==ab(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pb(t){return(pb=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var db=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cb(t,e)}(o,t);var e,r,n,i=hb(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).mouseoutTimeId=null,t.panel=null,t}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t;var r=t.getMapImpl();this.panel=e.getElementsByTagName("div")[o.PANEL_ID],this.panel.addEventListener("click",this.clickLayer.bind(this),!1),this.panel.addEventListener("input",this.inputLayer.bind(this),!1),this.element=e,this.target_=null,r.addControl(this)}},{key:"inputLayer",value:function(t){var e=t||window.event,r=e.target.getAttribute("data-group-id");if(!_V(e.target)){var n=e.target.getAttribute("data-layer-name");if(!_V(n)){e.stopPropagation();var i=this.facadeMap_.getLayers().filter((function(t){return t.name===n}))[0];if(_V(i)&&!_V(r)&&(i=sb.findGroupById(r,this.facadeMap_.getLayerGroup()).getChildren().find((function(t){return t instanceof Ad&&t.name===n}))),e.target.classList.contains("m-check")){if(!0===i.transparent||!i.isVisible()){var o=e.target.parentElement.parentElement.querySelector("div.tools > input");_V(o)||i.setOpacity(parseFloat(o.value)),i.setVisible(!i.isVisible())}}else e.target.classList.contains("m-layerswitcher-transparency")?i.setOpacity(parseFloat(e.target.value)):e.target.classList.contains("m-layerswitcher-remove")&&this.facadeMap_.removeLayers(i)}}}},{key:"clickLayer",value:function(t){var e=t||window.event,r=e.target.getAttribute("data-group-id"),n=null;if(!_V(e.target)){var i=e.target.getAttribute("data-layer-name");if(_V(i)){if(!_V(r)){var o=e.target.getAttribute("data-group-id");n=sb.findGroupById(o,this.facadeMap_.getLayerGroup()),e.target.classList.contains("m-check")?e.target.classList.contains("g-cartografia-check3")?n.setVisible(!1):n.setVisible(!0):(n.collapsed=!n.collapsed,this.renderPanel())}}else{e.stopPropagation();var s=this.facadeMap_.getLayers().filter((function(t){return t.name===i}))[0];if(_V(s)&&!_V(r)&&(s=(n=sb.findGroupById(r,this.facadeMap_.getLayerGroup())).getChildren().find((function(t){return t instanceof Ad&&t.name===i}))),e.target.classList.contains("m-check")){if(!0===s.transparent||!s.isVisible()){var a=e.target.parentElement.parentElement.querySelector("div.tools > input");_V(a)||s.setOpacity(parseFloat(a.value)),s.setVisible(!s.isVisible())}}else e.target.classList.contains("m-layerswitcher-transparency")?s.setOpacity(parseFloat(e.target.value)):e.target.classList.contains("m-layerswitcher-remove")&&(_V(n)?this.facadeMap_.removeLayers(s):(s.getImpl().destroy(),n.removeChild(s)))}}this.renderPanel()}},{key:"renderPanel",value:function(){var t=this;$C.getTemplateVariables(this.facadeMap_).then((function(e){var r=Sp(Vv.a,{vars:e});t.registerImgErrorEvents_(r);var n=r.querySelector("div#".concat(o.PANEL_ID));t.panel.innerHTML=n.innerHTML}))}},{key:"registerEvents",value:function(){var t=this;if(!_V(this.facadeMap_)){var e=this.facadeMap_.getMapImpl();this.registerViewEvents_(e.getView()),this.registerLayersEvents_(e.getLayers()),e.on("change:view",(function(){return t.onViewChange_.bind(t)}))}}},{key:"unregisterEvents",value:function(){var t=this;if(!_V(this.facadeMap_)){var e=this.facadeMap_.getMapImpl();this.unregisterViewEvents_(e.getView()),this.unregisterLayersEvents_(e.getLayers()),e.un("change:view",(function(){return t.onViewChange_.bind(t)}))}}},{key:"registerViewEvents_",value:function(t){var e=this;t.on("change:resolution",(function(){return e.renderPanel.bind(e)}))}},{key:"registerLayersEvents_",value:function(t){var e=this;t.forEach(this.registerLayerEvents_.bind(this)),t.on("remove",(function(){return e.renderPanel.bind(e)})),t.on("add",(function(){return e.onAddLayer_.bind(e)}))}},{key:"registerLayerEvents_",value:function(t){var e=this;t.on("change:visible",(function(){return e.renderPanel.bind(e)})),t.on("change:extent",(function(){return e.renderPanel.bind(e)}))}},{key:"unregisterViewEvents_",value:function(t){var e=this;t.un("change:resolution",(function(){return e.renderPanel.bind(e)}))}},{key:"unregisterLayersEvents_",value:function(t){var e=this;t.forEach(this.unregisterLayerEvents_.bind(this)),t.un("remove",(function(){return e.renderPanel.bind(e)})),t.un("add",(function(){return e.onAddLayer_.bind(e)}))}},{key:"unregisterLayerEvents_",value:function(t){var e=this;t.un("change:visible",(function(){return e.renderPanel.bind(e)})),t.un("change:extent",(function(){return e.renderPanel.bind(e)}))}},{key:"onViewChange_",value:function(t){this.unregisterViewEvents_(t.oldValue);var e=this.facadeMap_.getMapImpl();this.registerViewEvents_(e.getView())}},{key:"onAddLayer_",value:function(t){this.registerLayerEvents_(t.element),this.renderPanel()}},{key:"registerImgErrorEvents_",value:function(t){var e=this,r=t.querySelectorAll("img");Array.prototype.forEach.call(r,(function(t){t.addEventListener("error",(function(t){var r=t.target.getAttribute("data-layer-name"),n=DV([M.config.THEME_URL,Ad.LEGEND_ERROR]),i=e.facadeMap_.getLayers().filter((function(t){return t.name===r}))[0];_V(i)||i.setLegendURL(n)}))}))}},{key:"setMap",value:function(t){ub(pb(o.prototype),"setMap",this).call(this,t),this.renderPanel()}}])&&lb(e.prototype,r),n&&lb(e,n),o}(Ev);db.PANEL_ID="m-layerswitcher-panel";var gb=db,yb=r(13),mb=r.n(yb),_b=function(){function t(t){this.rbush_=new mb.a(t),this.items_={}}return t.prototype.insert=function(t,e){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(r),this.items_[Object(st.c)(e)]=r},t.prototype.load=function(t,e){for(var r=new Array(e.length),n=0,i=e.length;n<i;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};r[n]=a,this.items_[Object(st.c)(s)]=a}this.rbush_.load(r)},t.prototype.remove=function(t){var e=Object(st.c)(t),r=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(r)},t.prototype.update=function(t,e){var r=this.items_[Object(st.c)(e)];Et([r.minX,r.minY,r.maxX,r.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var r,n=0,i=t.length;n<i;n++)if(r=e(t[n]))return r;return r},t.prototype.isEmpty=function(){return W(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return vt(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),vb="addfeature",bb="changefeature",wb="clear",xb="removefeature",Eb="featuresloadstart",Sb="featuresloadend",Ib="featuresloaderror";function Ob(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Cb="arraybuffer",Tb="json",Pb="text",Rb="xml",Lb=!1;function Mb(t,e,r,n,i,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,n,i):t,!0),e.getType()==Cb&&(a.responseType="arraybuffer"),a.withCredentials=Lb,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var n=e.getType(),l=void 0;n==Tb||n==Pb?l=a.responseText:n==Rb?(l=a.responseXML)||(l=(new DOMParser).parseFromString(a.responseText,"application/xml")):n==Cb&&(l=a.response),l?o(e.readFeatures(l,{extent:r,featureProjection:i}),e.readProjection(l)):s()}else s()},a.onerror=s,a.send()}function kb(t,e){return function(r,n,i,o,s){var a=this;Mb(t,e,r,n,i,(function(t,e){a.addFeatures(t),void 0!==o&&o(t)}),s||ds)}}var Nb=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ab=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.feature=r,i.features=n,i}return Nb(e,t),e}(Xs),Fb=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{attributions:n.attributions,projection:void 0,state:Ua,wrapX:void 0===n.wrapX||n.wrapX})||this).on,r.once,r.un,r.loader_=ds,r.format_=n.format,r.overlaps_=void 0===n.overlaps||n.overlaps,r.url_=n.url,void 0!==n.loader?r.loader_=n.loader:void 0!==r.url_&&(ut(r.format_,7),r.loader_=kb(r.url_,r.format_)),r.strategy_=void 0!==n.strategy?n.strategy:Ob;var i,o,s=void 0===n.useSpatialIndex||n.useSpatialIndex;return r.featuresRtree_=s?new _b:null,r.loadedExtentsRtree_=new _b,r.loadingExtentsCount_=0,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(n.features)?o=n.features:n.features&&(o=(i=n.features).getArray()),s||void 0!==i||(i=new Gl(o)),void 0!==o&&r.addFeaturesInternal(o),void 0!==i&&r.bindFeaturesCollection_(i),r}return Nb(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Object(st.c)(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var r=t.getGeometry();if(r){var n=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ab(vb,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[fa(e,$s,this.handleFeatureChange_,this),fa(e,Hs,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var r=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?r=!1:this.idIndex_[n.toString()]=e),r&&(ut(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),r},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],r=[],n=[],i=0,o=t.length;i<o;i++){var s=t[i],a=Object(st.c)(s);this.addToIndex_(a,s)&&r.push(s)}i=0;for(var l=r.length;i<l;i++){s=r[i],a=Object(st.c)(s);this.setupChangeEvents_(a,s);var u=s.getGeometry();if(u){var c=u.getExtent();e.push(c),n.push(s)}else this.nullGeometryFeatures_[a]=s}this.featuresRtree_&&this.featuresRtree_.load(e,n);i=0;for(var h=r.length;i<h;i++)this.dispatchEvent(new Ab(vb,r[i]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(vb,(function(r){e||(e=!0,t.push(r.feature),e=!1)})),this.addEventListener(xb,(function(r){e||(e=!0,t.remove(r.feature),e=!1)})),t.addEventListener(Nl,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(Al,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(da)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new Ab(wb);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,(function(r){return r.getGeometry().intersectsCoordinate(t)?e(r):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(r){if(r.getGeometry().intersectsExtent(t)){var n=e(r);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),W(this.nullGeometryFeatures_)||qe(t,Y(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var r=t[0],n=t[1],i=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],l=e||fs;return this.featuresRtree_.forEachInExtent(a,(function(t){if(l(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(r,n,o,s))<u){i=t;var c=Math.sqrt(s);a[0]=r-c,a[1]=n-c,a[2]=r+c,a[3]=n+c}}})),i},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,r=Object(st.c)(e),n=e.getGeometry();if(n){var i=n.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,e)):this.featuresRtree_&&this.featuresRtree_.update(i,e)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[r]=e);var o=e.getId();if(void 0!==o){var s=o.toString();this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[r]=e;this.changed(),this.dispatchEvent(new Ab(bb,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Object(st.c)(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&W(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,r){for(var n=this.loadedExtentsRtree_,i=this.strategy_(t,e,r),o=function(t,o){var a=i[t];n.forEachInExtent(a,(function(t){return gt(t.extent,a)}))||(++s.loadingExtentsCount_,s.dispatchEvent(new Ab(Eb)),s.loader_.call(s,a,e,r,function(t){--this.loadingExtentsCount_,this.dispatchEvent(new Ab(Sb,void 0,t))}.bind(s),function(){--this.loadingExtentsCount_,this.dispatchEvent(new Ab(Ib))}.bind(s)),n.insert(a,{extent:a.slice()}))},s=this,a=0,l=i.length;a<l;++a)o(a);this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,r=this.loadedExtentsRtree_;r.forEachInExtent(t,(function(r){if(Et(r.extent,t))return e=r,!0})),e&&r.remove(e)},e.prototype.removeFeature=function(t){var e=Object(st.c)(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=Object(st.c)(t);this.featureChangeKeys_[e].forEach(da),delete this.featureChangeKeys_[e];var r=t.getId();void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Ab(xb,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===t){delete this.idIndex_[r],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){ut(this.format_,7),this.url_=t,this.setLoader(kb(t,this.format_))},e}(Im),Db=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jb=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,wrapX:e.wrapX})||this;return r.resolution=void 0,r.distance=void 0!==e.distance?e.distance:20,r.minDistance=e.minDistance||0,r.interpolationRatio=0,r.features=[],r.geometryFunction=e.geometryFunction||function(t){var e=t.getGeometry();return ut(e.getType()==Yt.POINT,10),e},r.createCustomCluster_=e.createCluster,r.source=null,r.boundRefresh_=r.refresh.bind(r),r.updateDistance(r.distance,r.minDistance),r.setSource(e.source||null),r}return Db(e,t),e.prototype.clear=function(e){this.features.length=0,t.prototype.clear.call(this,e)},e.prototype.getDistance=function(){return this.distance},e.prototype.getSource=function(){return this.source},e.prototype.loadFeatures=function(t,e,r){this.source.loadFeatures(t,e,r),e!==this.resolution&&(this.resolution=e,this.refresh())},e.prototype.setDistance=function(t){this.updateDistance(t,this.minDistance)},e.prototype.setMinDistance=function(t){this.updateDistance(this.distance,t)},e.prototype.getMinDistance=function(){return this.minDistance},e.prototype.setSource=function(t){this.source&&this.source.removeEventListener($s,this.boundRefresh_),this.source=t,t&&t.addEventListener($s,this.boundRefresh_),this.refresh()},e.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},e.prototype.updateDistance=function(t,e){var r=0===t?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==r;this.distance=t,this.minDistance=e,this.interpolationRatio=r,n&&this.refresh()},e.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var t=[1/0,1/0,-1/0,-1/0],e=this.distance*this.resolution,r=this.source.getFeatures(),n={},i=0,o=r.length;i<o;i++){var s=r[i];if(!(Object(st.c)(s)in n)){var a=this.geometryFunction(s);if(a){wt(a.getCoordinates(),t),ht(t,e,t);var l=this.source.getFeaturesInExtent(t).filter((function(t){var e=Object(st.c)(t);return!(e in n)&&(n[e]=!0,!0)}));this.features.push(this.createCluster(l,t))}}}},e.prototype.createCluster=function(t,e){for(var r=[0,0],n=t.length-1;n>=0;--n){var i=this.geometryFunction(t[n]);i?Qt(r,i.getCoordinates()):t.splice(n,1)}se(r,1/t.length);var o=Mt(e),s=this.interpolationRatio,a=new dc([r[0]*(1-s)+o[0]*s,r[1]*(1-s)+o[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(a,t):new Cg({geometry:a,features:t})},e}(Fb),Gb="top",zb="middle",Ub="bottom",Bb="alphabetic",Vb="hanging",qb="ideographic",Yb="left",Wb="center",Xb="right",Hb="justify",Zb=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),Kb=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),$b="point",Jb="line",Qb=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=Vc(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new Kb({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:$b,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=Vc(void 0!==t?t:1)},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}(),tw="fraction",ew="pixels",rw="bottom-left",nw="bottom-right",iw="top-left",ow="top-right",sw=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Vc(t.scale),this.displacement_=t.displacement}return t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return Object(st.b)()},t.prototype.getImage=function(t){return Object(st.b)()},t.prototype.getHitDetectionImage=function(){return Object(st.b)()},t.prototype.getPixelRatio=function(t){return 1},t.prototype.getImageState=function(){return Object(st.b)()},t.prototype.getImageSize=function(){return Object(st.b)()},t.prototype.getOrigin=function(){return Object(st.b)()},t.prototype.getSize=function(){return Object(st.b)()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=Vc(t)},t.prototype.listenImageChange=function(t){Object(st.b)()},t.prototype.load=function(){Object(st.b)()},t.prototype.unlistenImageChange=function(t){Object(st.b)()},t}(),aw=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lw=null,uw=function(t){function e(e,r,n,i,o,s){var a=t.call(this)||this;return a.hitDetectionImage_=null,a.image_=e||new Image,null!==i&&(a.image_.crossOrigin=i),a.canvas_={},a.color_=s,a.unlisten_=null,a.imageState_=o,a.size_=n,a.src_=r,a.tainted_,a}return aw(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===Bd){lw||(lw=ol(1,1)),lw.drawImage(this.image_,0,0);try{lw.getImageData(0,0,1,1),this.tainted_=!1}catch(t){lw=null,this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent($s)},e.prototype.handleImageError_=function(){this.imageState_=Vd,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Bd,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],r=ol(t,e);r.fillRect(0,0,t,e),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==zd){this.imageState_=Ud;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=om(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]&&this.imageState_===Bd){var e=document.createElement("canvas");this.canvas_[t]=e,e.width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var r=e.getContext("2d");if(r.scale(t,t),r.drawImage(this.image_,0,0),r.globalCompositeOperation="multiply","multiply"===r.globalCompositeOperation||this.isTainted_())r.fillStyle=As(this.color_),r.fillRect(0,0,e.width/t,e.height/t),r.globalCompositeOperation="destination-in",r.drawImage(this.image_,0,0);else{for(var n=r.getImageData(0,0,e.width,e.height),i=n.data,o=this.color_[0]/255,s=this.color_[1]/255,a=this.color_[2]/255,l=this.color_[3],u=0,c=i.length;u<c;u+=4)i[u]*=o,i[u+1]*=s,i[u+2]*=a,i[u+3]*=l;r.putImageData(n,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Ks);var cw=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),hw=function(t){function e(e){var r=this,n=e||{},i=void 0!==n.opacity?n.opacity:1,o=void 0!==n.rotation?n.rotation:0,s=void 0!==n.scale?n.scale:1,a=void 0!==n.rotateWithView&&n.rotateWithView;(r=t.call(this,{opacity:i,rotation:o,scale:s,displacement:void 0!==n.displacement?n.displacement:[0,0],rotateWithView:a})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],r.normalizedAnchor_=null,r.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:iw,r.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:tw,r.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:tw,r.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var l=void 0!==n.img?n.img:null,u=void 0!==n.imgSize?n.imgSize:null,c=n.src;ut(!(void 0!==c&&l),4),ut(!l||l&&u,5),void 0!==c&&0!==c.length||!l||(c=l.src||Object(st.c)(l)),ut(void 0!==c&&c.length>0,6);var h=void 0!==n.src?zd:Bd;return r.color_=void 0!==n.color?zs(n.color):null,r.iconImage_=function(t,e,r,n,i,o){var s=Ys.get(e,n,o);return s||(s=new uw(t,e,r,n,i,o),Ys.set(e,n,o,s)),s}(l,c,u,r.crossOrigin_,h,r.color_),r.offset_=void 0!==n.offset?n.offset:[0,0],r.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:iw,r.origin_=null,r.size_=void 0!==n.size?n.size:null,r}return cw(e,t),e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==tw||this.anchorYUnits_==tw){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==tw&&(t[0]*=e[0]),this.anchorYUnits_==tw&&(t[1]*=e[1])}if(this.anchorOrigin_!=iw){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=ow&&this.anchorOrigin_!=nw||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=rw&&this.anchorOrigin_!=nw||(t[1]=-t[1]+e[1])}var r=this.getDisplacement();return t[0]-=r[0],t[1]+=r[1],this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=iw){var e=this.getSize(),r=this.iconImage_.getSize();if(!e||!r)return null;t=t.slice(),this.offsetOrigin_!=ow&&this.offsetOrigin_!=nw||(t[0]=r[0]-e[0]-t[0]),this.offsetOrigin_!=rw&&this.offsetOrigin_!=nw||(t[1]=r[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener($s,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener($s,t)},e}(sw),fw=function(){function t(){}return t.prototype.drawCustom=function(t,e,r,n){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}();function pw(t){return Array.isArray(t)?Bs(t):t}var dw=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gw=function(t){function e(e,r,n,i,o,s,a){var l=t.call(this)||this;return l.context_=e,l.pixelRatio_=r,l.extent_=n,l.transform_=i,l.viewRotation_=o,l.squaredTolerance_=s,l.userTransform_=a,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return dw(e,t),e.prototype.drawImages_=function(t,e,r,n){if(this.image_){var i=ju(t,e,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,c=i.length;u<c;u+=2){var h=i[u]-this.imageAnchorX_,f=i[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var p=h+this.imageAnchorX_,d=f+this.imageAnchorY_;Rs(s,p,d,1,1,l,-p,-d),o.setTransform.apply(o,s),o.translate(p,d),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,f,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,r,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=ju(t,e,r,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<r;e+=n){var a=i[e]+this.textOffsetX_,l=i[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]){var u=Rs(this.tmpLocalTransform_,a,l,1,1,s,-a,-l);o.setTransform.apply(o,u),o.translate(a,l),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,a,l),this.textFillState_&&o.fillText(this.text_,a,l)}}},e.prototype.moveToLineTo_=function(t,e,r,n,i){var o=this.context_,s=ju(t,e,r,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;i&&(a-=2);for(var l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return i&&o.closePath(),r},e.prototype.drawRings_=function(t,e,r,n){for(var i=0,o=r.length;i<o;++i)e=this.moveToLineTo_(t,e,r[i],n,!0);return e},e.prototype.drawCircle=function(t){if(zt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,r){var n=t.getFlatCoordinates();if(n){var i=t.getStride();return ju(n,0,n.length,i,e,r)}return null}(t,this.transform_,this.pixelCoordinates_),r=e[2]-e[0],n=e[3]-e[1],i=Math.sqrt(r*r+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case Yt.POINT:this.drawPoint(t);break;case Yt.LINE_STRING:this.drawLineString(t);break;case Yt.POLYGON:this.drawPolygon(t);break;case Yt.MULTI_POINT:this.drawMultiPoint(t);break;case Yt.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case Yt.MULTI_POLYGON:this.drawMultiPolygon(t);break;case Yt.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case Yt.CIRCLE:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var r=e.getGeometryFunction()(t);r&&zt(this.extent_,r.getExtent())&&(this.setStyle(e),this.drawGeometry(r))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),r=0,n=e.length;r<n;++r)this.drawGeometry(e[r])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(e,0,e.length,r),""!==this.text_&&this.drawText_(e,0,e.length,r)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(e,0,e.length,r),""!==this.text_&&this.drawText_(e,0,e.length,r)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,r=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(r,0,r.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(zt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_,n=t.getFlatCoordinates(),i=0,o=t.getEnds(),s=t.getStride();r.beginPath();for(var a=0,l=o.length;a<l;++a)i=this.moveToLineTo_(n,i,o[a],s,!1);r.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,r=t.getOrientedFlatCoordinates(),n=0,i=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=i.length;s<a;++s){var l=i[s];n=this.drawRings_(r,n,l,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,r=this.contextFillState_;r?r.fillStyle!=t.fillStyle&&(r.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=t.lineCap&&(r.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(We(r.lineDash,t.lineDash)||e.setLineDash(r.lineDash=t.lineDash),r.lineDashOffset!=t.lineDashOffset&&(r.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),r.lineJoin!=t.lineJoin&&(r.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),r.lineWidth!=t.lineWidth&&(r.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),r.miterLimit!=t.miterLimit&&(r.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),r.strokeStyle!=t.strokeStyle&&(r.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,r=this.contextTextState_,n=t.textAlign?t.textAlign:ml;r?(r.font!=t.font&&(r.font=t.font,e.font=t.font),r.textAlign!=n&&(r.textAlign=n,e.textAlign=n),r.textBaseline!=t.textBaseline&&(r.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){var r=this;if(t){var n=t.getColor();this.fillState_={fillStyle:pw(n||fl)}}else this.fillState_=null;if(e){var i=e.getColor(),o=e.getLineCap(),s=e.getLineDash(),a=e.getLineDashOffset(),l=e.getLineJoin(),u=e.getWidth(),c=e.getMiterLimit(),h=s||dl;this.strokeState_={lineCap:void 0!==o?o:pl,lineDash:1===this.pixelRatio_?h:h.map((function(t){return t*r.pixelRatio_})),lineDashOffset:(a||0)*this.pixelRatio_,lineJoin:void 0!==l?l:gl,lineWidth:(void 0!==u?u:1)*this.pixelRatio_,miterLimit:void 0!==c?c:10,strokeStyle:pw(i||yl)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){var e;if(t&&(e=t.getSize())){var r=t.getAnchor(),n=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*this.pixelRatio_,this.imageAnchorY_=r[1]*this.pixelRatio_,this.imageHeight_=e[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=e[0]*this.pixelRatio_}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var r=e.getColor();this.textFillState_={fillStyle:pw(r||fl)}}else this.textFillState_=null;var n=t.getStroke();if(n){var i=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),c=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:pl,lineDash:s||dl,lineDashOffset:a||0,lineJoin:void 0!==l?l:gl,lineWidth:void 0!==u?u:1,miterLimit:void 0!==c?c:10,strokeStyle:pw(i||yl)}}else this.textStrokeState_=null;var h=t.getFont(),f=t.getOffsetX(),p=t.getOffsetY(),d=t.getRotateWithView(),g=t.getRotation(),y=t.getScaleArray(),m=t.getText(),_=t.getTextAlign(),v=t.getTextBaseline();this.textState_={font:void 0!==h?h:hl,textAlign:void 0!==_?_:ml,textBaseline:void 0!==v?v:_l},this.text_=void 0!==m?m:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0!==g?g:0,this.textScale_=[this.pixelRatio_*y[0],this.pixelRatio_*y[1]]}else this.text_=""},e}(fw),yw="Circle",mw="Default",_w="Image",vw="LineString",bw="Polygon",ww="Text",xw={Point:function(t,e,r,n,i){var o,s=r.getImage(),a=r.getText();i&&(t=i,o=s&&a&&a.getText()?{}:void 0);if(s){if(s.getImageState()!=Bd)return;var l=t.getBuilder(r.getZIndex(),_w);l.setImageStyle(s,o),l.drawPoint(e,n)}if(a&&a.getText()){var u=t.getBuilder(r.getZIndex(),ww);u.setTextStyle(a,o),u.drawText(e,n)}},LineString:function(t,e,r,n,i){var o=r.getStroke();if(o){var s=t.getBuilder(r.getZIndex(),vw);s.setFillStrokeStyle(null,o),s.drawLineString(e,n)}var a=r.getText();if(a&&a.getText()){var l=(i||t).getBuilder(r.getZIndex(),ww);l.setTextStyle(a),l.drawText(e,n)}},Polygon:function(t,e,r,n,i){var o=r.getFill(),s=r.getStroke();if(o||s){var a=t.getBuilder(r.getZIndex(),bw);a.setFillStrokeStyle(o,s),a.drawPolygon(e,n)}var l=r.getText();if(l&&l.getText()){var u=(i||t).getBuilder(r.getZIndex(),ww);u.setTextStyle(l),u.drawText(e,n)}},MultiPoint:function(t,e,r,n,i){var o,s=r.getImage(),a=r.getText();i&&(t=i,o=s&&a&&a.getText()?{}:void 0);if(s){if(s.getImageState()!=Bd)return;var l=t.getBuilder(r.getZIndex(),_w);l.setImageStyle(s,o),l.drawMultiPoint(e,n)}if(a&&a.getText()){var u=(i||t).getBuilder(r.getZIndex(),ww);u.setTextStyle(a,o),u.drawText(e,n)}},MultiLineString:function(t,e,r,n,i){var o=r.getStroke();if(o){var s=t.getBuilder(r.getZIndex(),vw);s.setFillStrokeStyle(null,o),s.drawMultiLineString(e,n)}var a=r.getText();if(a&&a.getText()){var l=(i||t).getBuilder(r.getZIndex(),ww);l.setTextStyle(a),l.drawText(e,n)}},MultiPolygon:function(t,e,r,n,i){var o=r.getFill(),s=r.getStroke();if(s||o){var a=t.getBuilder(r.getZIndex(),bw);a.setFillStrokeStyle(o,s),a.drawMultiPolygon(e,n)}var l=r.getText();if(l&&l.getText()){var u=(i||t).getBuilder(r.getZIndex(),ww);u.setTextStyle(l),u.drawText(e,n)}},GeometryCollection:function(t,e,r,n,i){var o,s,a=e.getGeometriesArray();for(o=0,s=a.length;o<s;++o){(0,xw[a[o].getType()])(t,a[o],r,n,i)}},Circle:function(t,e,r,n,i){var o=r.getFill(),s=r.getStroke();if(o||s){var a=t.getBuilder(r.getZIndex(),yw);a.setFillStrokeStyle(o,s),a.drawCircle(e,n)}var l=r.getText();if(l&&l.getText()){var u=(i||t).getBuilder(r.getZIndex(),ww);u.setTextStyle(l),u.drawText(e,n)}}};function Ew(t,e){return parseInt(Object(st.c)(t),10)-parseInt(Object(st.c)(e),10)}function Sw(t,e){var r=Iw(t,e);return r*r}function Iw(t,e){return.5*t/e}function Ow(t,e,r,n,i,o,s){var a=!1,l=r.getImage();if(l){var u=l.getImageState();u==Bd||u==Vd?l.unlistenImageChange(i):(u==zd&&l.load(),u=l.getImageState(),l.listenImageChange(i),a=!0)}return function(t,e,r,n,i,o){var s=r.getGeometryFunction()(e);if(!s)return;var a=s.simplifyTransformed(n,i);if(r.getRenderer())Cw(t,a,r,e);else{(0,xw[a.getType()])(t,a,r,e,o)}}(t,e,r,n,o,s),a}function Cw(t,e,r,n){if(e.getType()!=Yt.GEOMETRY_COLLECTION)t.getBuilder(r.getZIndex(),mw).drawCustom(e,n,r.getRenderer(),r.getHitDetectionRenderer());else for(var i=e.getGeometries(),o=0,s=i.length;o<s;++o)Cw(t,i[o],r,n)}function Tw(t,e){var r=t.canvas,n=e||{},i=n.pixelRatio||bs,o=n.size;o&&(r.width=o[0]*i,r.height=o[1]*i,r.style.width=o[0]+"px",r.style.height=o[1]+"px");var s=[0,0,r.width,r.height],a=Ps([1,0,0,1,0,0],i,i);return new gw(t,i,s,a,0)}function Pw(t){var e,r=t.inversePixelTransform[0],n=t.frameState,i=Os(t.inversePixelTransform.slice(),n.coordinateToPixelTransform),o=Sw(n.viewState.resolution,r),s=Me();return s&&(e=Se(s,n.viewState.projection)),new gw(t.context,r,n.extent,i,n.viewState.rotation,o,e)}function Rw(t){return(Rw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kw(t,e){return(kw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nw(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fw(t);if(e){var i=Fw(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Aw(this,r)}}function Aw(t,e){return!e||"object"!==Rw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fw(t){return(Fw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kw(t,e)}(o,t);var e,r,n,i=Nw(o);function o(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Lw(this,o);var n=document.createElement("canvas"),s=Number(r.scale)>0?Number(r.scale):1,a=s*bs||bs,l=n.getContext("2d");if(r.image){r.image.load();var u=r.image.getImage();u.width?(n.width=Math.round(u.width*a),n.height=Math.round(u.height*a),l.globalAlpha="number"==typeof r.opacity?r.opacity:1,l.drawImage(u,0,0,u.width,u.height,0,0,n.width,n.height),e=l.createPattern(n,"repeat")):(e=[0,0,0,0],u.onload=function(){n.width=Math.round(u.width*a),n.height=Math.round(u.height*a),l.globalAlpha="number"==typeof r.opacity?r.opacity:1,l.drawImage(u,0,0,u.width,u.height,0,0,n.width,n.height),e=l.createPattern(n,"repeat"),this.color_=e,this.checksum_=void 0})}else{var c=o.getPattern(r);if(n.width=Math.round(c.width*a),n.height=Math.round(c.height*a),l.beginPath(),r.fill&&(l.fillStyle=As(r.fill.getColor()),l.fillRect(0,0,n.width,n.height)),l.scale(a,a),l.lineCap="round",l.lineWidth=c.stroke||1,l.fillStyle=As(r.color||"#000"),l.strokeStyle=As(r.color||"#000"),c.circles)for(var h=0;h<c.circles.length;h+=1){var f=c.circles[h];l.beginPath(),l.arc(f[0],f[1],f[2],0,2*Math.PI),c.fill&&l.fill(),c.stroke&&l.stroke()}if(c.repeat||(c.repeat=[[0,0]]),c.char&&(l.font=c.font||"".concat(c.width,"px Arial"),l.textAlign="center",l.textBaseline="middle",c.angle?(l.fillText(c.char,c.width/4,c.height/4),l.fillText(c.char,5*c.width/4,5*c.height/4),l.fillText(c.char,c.width/4,5*c.height/4),l.fillText(c.char,5*c.width/4,c.height/4),l.fillText(c.char,3*c.width/4,3*c.height/4),l.fillText(c.char,-c.width/4,-c.height/4),l.fillText(c.char,3*c.width/4,-c.height/4),l.fillText(c.char,-c.width/4,3*c.height/4)):l.fillText(c.char,c.width/2,c.height/2)),c.lines)for(var p=0;p<c.lines.length;p+=1)for(var d=0;d<c.repeat.length;d+=1){var g=c.lines[p];l.beginPath(),l.moveTo(g[0]+c.repeat[d][0],g[1]+c.repeat[d][1]);for(var y=2;y<g.length;y+=2)l.lineTo(g[y]+c.repeat[d][0],g[y+1]+c.repeat[d][1]);c.fill&&l.fill(),c.stroke&&l.stroke(),l.save(),l.strokeStyle="red",l.strokeWidth=.1,l.restore()}if(e=l.createPattern(n,"repeat"),r.offset){var m=r.offset;if("number"==typeof m&&(m=[m,m]),m instanceof Array){var _=Math.round(m[0]*a),v=Math.round(m[1]*a);l.scale(1/a,1/a),l.clearRect(0,0,n.width,n.height),l.translate(_,v),l.fillStyle=e,l.fillRect(-_,-v,n.width,n.height),e=l.createPattern(n,"repeat")}}}return(t=i.call(this,{color:e})).canvas_=n,t.options_=r,t}return e=o,n=[{key:"getPattern",value:function(t){var e=t,r=o.patterns[e.pattern]||o.patterns.dot,n=Math.round(e.spacing)||10;switch(e.pattern){case"dot":case"circle":var i=0===e.size?0:e.size/2||2;e.angle?(n=Math.round(1.4*n),r.width=n,r.height=n,r.circles=[[n/4,n/4,i],[3*n/4,3*n/4,i]],"circle"===e.pattern&&(r.circles=r.circles.concat([[n/4+n,n/4,i],[n/4,n/4+n,i],[3*n/4-n,3*n/4,i],[3*n/4,3*n/4-n,i],[n/4+n,n/4+n,i],[3*n/4-n,3*n/4-n,i]]))):(r.width=n,r.height=n,r.circles=[[n/2,n/2,i]],"circle"===e.pattern&&(r.circles=r.circles.concat([[n/2+n,n/2,i],[n/2-n,n/2,i],[n/2,n/2+n,i],[n/2,n/2-n,i],[n/2+n,n/2+n,i],[n/2+n,n/2-n,i],[n/2-n,n/2+n,i],[n/2-n,n/2-n,i]])));break;case"tile":case"square":i=0===e.size?0:e.size/2||2,e.angle?(r.width=n,r.height=n,r.lines=[[n/2-i,n/2,n/2,n/2-i,n/2+i,n/2,n/2,n/2+i,n/2-i,n/2]]):(r.width=n,r.height=n,r.lines=[[n/2-i,n/2-i,n/2+i,n/2-i,n/2+i,n/2+i,n/2-i,n/2+i,n/2-i,n/2-i]]),"square"===e.pattern&&(r.repeat=[[0,0],[0,n],[n,0],[0,-n],[-n,0],[-n,-n],[n,n],[-n,n],[n,-n]]);break;case"cross":case"hatch":"cross"===e.pattern&&e.angle&&(e.angle=45);var s=Math.round(((e.angle||0)-90)%360);s>180&&(s-=360),s*=Math.PI/180;var a=Math.cos(s),l=Math.sin(s);if(Math.abs(l)<1e-4)r.width=n,r.height=n,r.lines=[[0,.5,n,.5]],r.repeat=[[0,0],[0,n]];else if(Math.abs(a)<1e-4)r.height=n,r.width=n,r.lines=[[.5,0,.5,n]],r.repeat=[[0,0],[n,0]],"cross"===e.pattern&&(r.lines.push([0,.5,n,.5]),r.repeat.push([0,n]));else{r.width=Math.round(Math.abs(n/l))||1,r.height=Math.round(Math.abs(n/a))||1;var u=r.width,c=r.height;"cross"===e.pattern?(r.lines=[[-u,-c,2*u,2*c],[2*u,-c,-u,2*c]],r.repeat=[[0,0]]):a*l>0?(r.lines=[[-u,-c,2*u,2*c]],r.repeat=[[0,0],[u,0],[0,c]]):(r.lines=[[2*u,-c,-u,2*c]],r.repeat=[[0,0],[-u,0],[0,c]])}r.stroke=0===e.size?0:e.size||4}return r}},{key:"addPattern",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.patterns[t||e.char]={width:e.width||e.size||10,height:e.height||e.size||10,font:e.font,char:e.char,circles:e.circles,lines:e.lines,repeat:e.repeat,stroke:e.stroke,angle:e.angle,fill:e.fill}}}],(r=[{key:"clone",value:function(){return new o(this.options_)}},{key:"getImage",value:function(){return this.canvas_}}])&&Mw(e.prototype,r),n&&Mw(e,n),o}(Kb);function jw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Dw.patterns={hatch:{width:5,height:5,lines:[[0,2.5,5,2.5]],stroke:1},cross:{width:7,height:7,lines:[[0,3,10,3],[3,0,3,10]],stroke:1},dot:{width:8,height:8,circles:[[5,5,2]],stroke:!1,fill:!0},circle:{width:10,height:10,circles:[[5,5,2]],stroke:1,fill:!1},square:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],stroke:1,fill:!1},tile:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],fill:!0},woven:{width:12,height:12,lines:[[3,3,9,9],[0,12,3,9],[9,3,12,0],[-1,1,1,-1],[13,11,11,13]],stroke:1},crosses:{width:8,height:8,lines:[[2,2,6,6],[2,6,6,2]],stroke:1},caps:{width:8,height:8,lines:[[2,6,4,2,6,6]],stroke:1},nylon:{width:20,height:20,lines:[[1,6,1,1,6,1],[6,11,11,11,11,6],[11,16,11,21,16,21],[16,11,21,11,21,16]],repeat:[[0,0],[-20,0],[0,-20]],stroke:1},hexagon:{width:20,height:12,lines:[[0,10,4,4,10,4,14,10,10,16,4,16,0,10]],stroke:1,repeat:[[0,0],[10,6],[10,-6],[-10,-6]]},cemetry:{width:15,height:19,lines:[[0,3.5,7,3.5],[3.5,0,3.5,10]],stroke:1,repeat:[[0,0],[7,9]]},sand:{width:20,height:20,circles:[[1,2,1],[9,3,1],[2,16,1],[7,8,1],[6,14,1],[4,19,1],[14,2,1],[12,10,1],[14,18,1],[18,8,1],[18,14,1]],fill:1},conglomerate:{width:30,height:20,circles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],lines:[[7,5,6,7,9,9,11,8,11,6,9,5,7,5],[16,10,15,13,16,14,19,15,21,13,22,9,20,8,19,8,16,10],[24,6,26,7,27,5,26,4,24,4,24,6]],stroke:1},gravel:{width:15,height:10,circles:[[4,2,1],[5,9,1],[1,7,1]],lines:[[7,5,6,6,7,7,8,7,9,7,10,5,9,4,7,5],[11,2,14,4,14,1,12,1,11,2]],stroke:1},brick:{width:18,height:16,lines:[[0,1,18,1],[0,10,18,10],[6,1,6,10],[12,10,12,18],[12,0,12,1]],stroke:1},dolomite:{width:20,height:16,lines:[[0,1,20,1],[0,9,20,9],[1,9,6,1],[11,9,14,16],[14,0,14.4,1]],stroke:1},coal:{width:20,height:16,lines:[[1,5,7,1,7,7],[11,10,12,5,18,9],[5,10,2,15,9,15],[15,16,15,13,20,16],[15,0,15,2,20,0]],fill:1},breccia:{width:20,height:16,lines:[[1,5,7,1,7,7,1,5],[11,10,12,5,18,9,11,10],[5,10,2,15,9,15,5,10],[15,16,15,13,22,18],[15,0,15,2,20,0]],stroke:1},clay:{width:20,height:20,lines:[[0,0,3,11,0,20],[11,0,10,3,13,13,11,20],[0,0,10,3,20,0],[0,12,3,11,13,13,20,12]],stroke:1},flooded:{width:15,height:10,lines:[[0,1,10,1],[0,6,5,6],[10,6,15,6]],stroke:1},chaos:{width:40,height:40,lines:[[40,2,40,0,38,0,40,2],[4,0,3,2,2,5,0,0,0,3,2,7,5,6,7,7,8,10,9,12,9,13,9,14,8,14,6,15,2,15,0,20,0,22,2,20,5,19,8,15,10,14,11,12.25,10,12,10,10,12,9,13,7,12,6,13,4,16,7,17,4,20,0,18,0,15,3,14,2,14,0,12,1,11,0,10,1,11,4,10,7,9,8,8,5,6,4,5,3,5,1,5,0,4,0],[7,1,7,3,8,3,8,2,7,1],[4,3,5,5,4,5,4,3],[34,5,33,7,38,10,38,8,36,5,34,5],[27,0,23,2,21,8,30,0,27,0],[25,8,26,12,26,16,22.71875,15.375,20,13,18,15,17,18,13,22,17,21,19,22,21,20,19,18,22,17,30,25,26,26,24,28,21.75,33.34375,20,36,18,40,20,40,24,37,25,32,27,31,26,38,27,37,30,32,32,35,36,37,38,40,38,39,40,40,37,36,34,32,37,31,36,29,33,27,34,24,39,21,40,21,40,16,37,20,31,22,32,25,27,20,29,15,30,20,32,20,34,18,33,12,31,11,29,14,26,9,25,8],[39,24,37,26,40,28,39,24],[13,15,9,19,14,18,13,15],[18,23,14,27,16,27,17,25,20,26,18,23],[6,24,2,26,1,28,2,30,5,28,12,30,16,32,18,30,15,30,12,28,9,25,7,27,6,24],[29,27,32,28,33,31,30,29,27,28,29,27],[5,35,1,33,3,36,13,38,15,35,10,36,5,35]],fill:1},grass:{width:27,height:22,lines:[[0,10.5,13,10.5],[2.5,10,1.5,7],[4.5,10,4.5,5,3.5,4],[7,10,7.5,6,8.5,3],[10,10,11,6]],repeat:[[0,0],[14,10]],stroke:1},swamp:{width:24,height:23,lines:[[0,10.5,9.5,10.5],[2.5,10,2.5,7],[4.5,10,4.5,4],[6.5,10,6.5,6],[3,12.5,7,12.5]],repeat:[[0,0],[14,10]],stroke:1},wave:{width:10,height:8,lines:[[0,0,5,4,10,0]],stroke:1},vine:{width:13,height:13,lines:[[3,0,3,6],[9,7,9,13]],stroke:1},forest:{width:55,height:30,circles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],stroke:1},scrub:{width:26,height:20,lines:[[1,4,4,8,6,4]],circles:[[20,13,1.5]],stroke:1},tree:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78]],repeat:[[3,1],[18,16]],stroke:1},pine:{width:30,height:30,lines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49]],repeat:[[3,1],[18,16]],stroke:1},pines:{width:22,height:20,lines:[[1,4,3.5,1,6,4],[1,8,3.5,5,6,8],[3.5,1,3.5,11],[12,14.5,14.5,14,17,14.5],[12,18,17,18],[14.5,12,14.5,18]],repeat:[[2,1]],stroke:1},rock:{width:20,height:20,lines:[[1,0,1,9],[4,0,4,9],[7,0,7,9],[10,1,19,1],[10,4,19,4],[10,7,19,7],[0,11,9,11],[0,14,9,14],[0,17,9,17],[12,10,12,19],[15,10,15,19],[18,10,18,19]],repeat:[[.5,.5]],stroke:1},rocks:{width:20,height:20,lines:[[5,0,3,0,5,4,4,6,0,3,0,5,3,6,5,9,3.75,10,2.5,10,0,9,0,10,4,11,5,14,4,15,0,13,0,13,0,13,0,14,0,14,5,16,5,18,3,19,0,19,-.25,19.9375,5,20,10,19,10,20,11,20,12,19,14,20,15,20,17,19,20,20,20,19,19,16,20,15,20,11,20,10,19,8,20,5,20,0,19,0,20,2,19,4,17,4,16,3,15,0,14,0,15,4,11,5,10,4,11,0,10,0,9,4,6,5,5,0],[18,5,19,6,18,10,16,10,14,9,16,5,18,5],[5,6,9,5,10,6,10,9,6,10,5,6],[14,5,14,8,13,9,12,9,11,7,12,5,14,5],[5,11,8,10,9,11,10,14,6,15,6,15,5,11],[13,10,14,11,15,14,15,14,15,14,11,15,10,11,11,10,13,10],[15,12,16,11,19,11,19,15,16,14,16,14,15,12],[6,16,9,15,10,18,5,19,6,16],[10,16,14,16,14,18,13,19,11,18,10,16],[15,15,18,16,18,18,16,19,15,18,15,15]],stroke:1}};var zw=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};jw(this,t),this.options_=e,this.layer_=null,this.updateFacadeOptions(e)}var e,r,n;return e=t,n=[{key:"getCanvasSize",value:function(){return[100,100]}}],(r=[{key:"updateFacadeOptions",value:function(){}},{key:"applyToLayer",value:function(t){this.layer_=t,t.getFeatures().forEach(this.applyToFeature,this)}},{key:"applyToFeature",value:function(t){t.getImpl().getOLFeature().setStyle(this.olStyleFn_)}},{key:"updateCanvas",value:function(e){var r=t.getCanvasSize(),n=Tw(e.getContext("2d"),{size:r});n.setStyle(this.olStyleFn_()[0]),this.drawGeometryToCanvas(n)}},{key:"drawGeometryToCanvas",value:function(t){}},{key:"clone",value:function(){return new t(Object.assign({},this.options_))}}])&&Gw(e.prototype,r),n&&Gw(e,n),t}();function Uw(t){return(Uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qw(t,e){return(qw=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yw(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xw(t);if(e){var i=Xw(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ww(this,r)}}function Ww(t,e){return!e||"object"!==Uw(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xw(t){return(Xw=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hw=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qw(t,e)}(o,t);var e,r,n,i=Yw(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Bw(this,o),(t=i.call(this,e)).updateFacadeOptions(e),t}return e=o,n=[{key:"getValue",value:function(t,e,r){var n=/^\{\{([^}]+)\}\}$/,i=t;if(n.test(t)||vV(t))if(e instanceof Cg||e instanceof kg){var o=cq.olFeature2Facade(e,!1);if(n.test(t)){var s=t.replace(n,"$1");i=o.getAttribute(s)}else if(vV(t)){var a;_V(r)||(a=r.getImpl().getMap()),i=t(o,a)}}else i=void 0;return _V(i)&&(i=void 0),i}}],(r=[{key:"applyToLayer",value:function(t){this.layer_=t;var e=t.getImpl().getOLLayer();_V(e)||e.setStyle(this.olStyleFn_)}},{key:"applyToFeature",value:function(t){t.getImpl().getOLFeature().setStyle(this.olStyleFn_)}},{key:"olStyleFn",get:function(){return this.olStyleFn_}}])&&Vw(e.prototype,r),n&&Vw(e,n),o}(zw),Zw=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kw=function(t){function e(e){var r=this,n=void 0!==e.rotateWithView&&e.rotateWithView;return(r=t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this).canvas_=void 0,r.hitDetectionCanvas_=null,r.fill_=void 0!==e.fill?e.fill:null,r.origin_=[0,0],r.points_=e.points,r.radius_=void 0!==e.radius?e.radius:e.radius1,r.radius2_=e.radius2,r.angle_=void 0!==e.angle?e.angle:0,r.stroke_=void 0!==e.stroke?e.stroke:null,r.anchor_=null,r.size_=null,r.renderOptions_=null,r.render(),r}return Zw(e,t),e.prototype.clone=function(){var t=this.getScale(),r=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return r.setOpacity(this.getOpacity()),r},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var e=this.canvas_[t];if(!e){var r=this.renderOptions_,n=ol(r.size*t,r.size*t);this.draw_(r,n,t),e=n.canvas,this.canvas_[t]=e}return e},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return Bd},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,e,r){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var n=this.radius_,i=void 0===this.radius2_?n:this.radius2_;if(n<i){var o=n;n=i,i=o}var s=void 0===this.radius2_?this.points_:2*this.points_,a=2*Math.PI/s,l=i*Math.sin(a),u=n-Math.sqrt(i*i-l*l),c=Math.sqrt(l*l+u*u),h=c/l;if("miter"===t&&h<=r)return h*e;var f=e/2/h,p=e/2*(u/c),d=Math.sqrt((n+f)*(n+f)+p*p)-n;if(void 0===this.radius2_||"bevel"===t)return 2*d;var g=n*Math.sin(a),y=i-Math.sqrt(n*n-g*g),m=Math.sqrt(g*g+y*y)/g;if(m<=r){var _=m*e/2-i-n;return 2*Math.max(d,_)}return 2*d},e.prototype.createRenderOptions=function(){var t,e=gl,r=0,n=null,i=0,o=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=yl),t=pw(t),void 0===(o=this.stroke_.getWidth())&&(o=1),n=this.stroke_.getLineDash(),i=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=gl),void 0===(r=this.stroke_.getMiterLimit())&&(r=10));var s=this.calculateLineJoinSize_(e,o,r),a=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*a+s),lineDash:n,lineDashOffset:i,lineJoin:e,miterLimit:r}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size,e=this.getDisplacement();this.canvas_={},this.anchor_=[t/2-e[0],t/2+e[1]],this.size_=[t,t]},e.prototype.draw_=function(t,e,r){if(e.scale(r,r),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var n=this.fill_.getColor();null===n&&(n=fl),e.fillStyle=pw(n),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var e=this.fill_.getColor(),r=0;if("string"==typeof e&&(e=zs(e)),null===e?r=1:Array.isArray(e)&&(r=4===e.length?e[3]:1),0===r){var n=ol(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var e=this.points_,r=this.radius_;if(e===1/0)t.arc(0,0,r,0,2*Math.PI);else{var n=void 0===this.radius2_?r:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var i=this.angle_-Math.PI/2,o=2*Math.PI/e,s=0;s<e;s++){var a=i+s*o,l=s%2==0?r:n;t.lineTo(l*Math.cos(a),l*Math.sin(a))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=fl,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},e}(sw),$w=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jw=function(t){function e(e){var r=e||{};return t.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,scale:void 0!==r.scale?r.scale:1,rotation:void 0!==r.rotation?r.rotation:0,rotateWithView:void 0!==r.rotateWithView&&r.rotateWithView,displacement:void 0!==r.displacement?r.displacement:[0,0]})||this}return $w(e,t),e.prototype.clone=function(){var t=this.getScale(),r=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return r.setOpacity(this.getOpacity()),r},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Kw);function Qw(t){return(Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var tx=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=ix,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"===Qw(e)&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.setHitDetectionRenderer=function(t){this.hitDetectionRenderer_=t},t.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ix,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var ex=null;function rx(t,e){if(!ex){var r=new Kb({color:"rgba(255,255,255,0.4)"}),n=new Zb({color:"#3399CC",width:1.25});ex=[new tx({image:new Jw({fill:r,stroke:n,radius:5}),fill:r,stroke:n})]}return ex}function nx(){var t={},e=[255,255,255,1],r=[0,153,255,1];return t[Yt.POLYGON]=[new tx({fill:new Kb({color:[255,255,255,.5]})})],t[Yt.MULTI_POLYGON]=t[Yt.POLYGON],t[Yt.LINE_STRING]=[new tx({stroke:new Zb({color:e,width:5})}),new tx({stroke:new Zb({color:r,width:3})})],t[Yt.MULTI_LINE_STRING]=t[Yt.LINE_STRING],t[Yt.CIRCLE]=t[Yt.POLYGON].concat(t[Yt.LINE_STRING]),t[Yt.POINT]=[new tx({image:new Jw({radius:6,fill:new Kb({color:r}),stroke:new Zb({color:e,width:1.5})}),zIndex:1/0})],t[Yt.MULTI_POINT]=t[Yt.POINT],t[Yt.GEOMETRY_COLLECTION]=t[Yt.POLYGON].concat(t[Yt.LINE_STRING],t[Yt.POINT]),t}function ix(t){return t.getGeometry()}var ox=tx;function sx(t){return(sx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ax(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ux(t,e){return(ux=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fx(t);if(e){var i=fx(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hx(this,r)}}function hx(t,e){return!e||"object"!==sx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fx(t){return(fx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var px=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ux(t,e)}(o,t);var e,r,n,i=cx(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ax(this,o),i.call(this,t)}return e=o,(r=[{key:"clone",value:function(){var t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new o({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}}])&&lx(e.prototype,r),n&&lx(e,n),o}(ox);function dx(t){return(dx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yx(t,e){return(yx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=vx(t);if(e){var i=vx(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _x(this,r)}}function _x(t,e){return!e||"object"!==dx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vx(t){return(vx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yx(t,e)}(a,t);var e,r,n,s=mx(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).olStyleFn_=e.updateFacadeOptions(t),e}return e=a,n=[{key:"getCanvasSize",value:function(){return[25,15]}}],(r=[{key:"updateFacadeOptions",value:function(t){var e=this;return function(r){var n=r;n instanceof Cg||r instanceof kg||(n=e);var s=new px;if(_V(t.stroke)||s.setStroke(new Zb({color:Hw.getValue(t.stroke.color,n,e.layer_),width:Hw.getValue(t.stroke.width,n,e.layer_),lineDash:Hw.getValue(t.stroke.linedash,n,e.layer_),lineDashOffset:Hw.getValue(t.stroke.linedashoffset,n,e.layer_),lineCap:Hw.getValue(t.stroke.linecap,n,e.layer_),lineJoin:Hw.getValue(t.stroke.linejoin,n,e.layer_),miterLimit:Hw.getValue(t.stroke.miterlimit,n,e.layer_)})),!_V(t.label)){var a=Hw.getValue(t.label.text,n,e.layer_),l=Hw.getValue(t.label.align,n,e.layer_),c=Hw.getValue(t.label.baseline,n,e.layer_),h=!!_V(t.label.overflow,e.layer_)||t.label.overflow;s.setText(new Qb({font:Hw.getValue(t.label.font,n,e.layer_),rotateWithView:Hw.getValue(t.label.rotate,n,e.layer_),scale:Hw.getValue(t.label.scale,n,e.layer_),offsetX:Hw.getValue(t.label.offset?t.label.offset[0]:void 0,n,e.layer_),offsetY:Hw.getValue(t.label.ofsset?t.label.offset[1]:void 0,n,e.layer_),fill:new Kb({color:Hw.getValue(t.label.color||"#000000",n,e.layer_)}),textAlign:Object.values(o).includes(l)?l:"center",textBaseline:Object.values(i).includes(c)?c:"top",text:void 0===a?void 0:String(a),rotation:Hw.getValue(t.label.rotation,n,e.layer_),overflow:Hw.getValue(h,n,e.layer_)})),_V(t.label.stroke)||s.getText().setStroke(new Zb({color:Hw.getValue(t.label.stroke.color,n,e.layer_),width:Hw.getValue(t.label.stroke.width,n,e.layer_),lineCap:Hw.getValue(t.label.stroke.linecap,n,e.layer_),lineJoin:Hw.getValue(t.label.stroke.linejoin,n,e.layer_),lineDash:Hw.getValue(t.label.stroke.linedash,n,e.layer_),lineDashOffset:Hw.getValue(t.label.stroke.linedashoffset,n,e.layer_),miterLimit:Hw.getValue(t.label.stroke.miterlimit,n,e.layer_)}))}if(!_V(t.fill)){var f,p=Hw.getValue(t.fill.color,n,e.layer_),d=Hw.getValue(t.fill.opacity,n,e.layer_);if(d||0===d||(d=1),_V(p)||(f=new Kb({color:u()(p).alpha(d).css()})),_V(t.fill.pattern))s.setFill(f);else{var g="rgba(0,0,0,1)";if(!_V(t.fill.pattern.color)){var y=Hw.getValue(t.fill.pattern.opacity,n,e.layer_)||1;y||0===y||(y=1),g=u()(t.fill.pattern.color).alpha(y).css()}s.setFill(new Dw({pattern:(Hw.getValue(t.fill.pattern.name,n,e.layer_)||"").toLowerCase(),color:g,size:Hw.getValue(t.fill.pattern.size,n,e.layer_),spacing:Hw.getValue(t.fill.pattern.spacing,n,e.layer_),image:"IMAGE"===Hw.getValue(t.fill.pattern.name,n,e.layer_)?new hw({src:Hw.getValue(t.fill.pattern.src,n,e.layer_)}):void 0,angle:Hw.getValue(t.fill.pattern.rotation,n,e.layer_),scale:Hw.getValue(t.fill.pattern.scale,n,e.layer_),offset:Hw.getValue(t.fill.pattern.offset,n,e.layer_),fill:f}))}}return[s]}}},{key:"updateCanvas",value:function(t){this.updateFacadeOptions(this.options_);var e=a.getCanvasSize(),r=Tw(t.getContext("2d"),{size:e}),n=this.olStyleFn_()[0];_V(n.getText())||n.setText(null);var i=n.getStroke();_V(i)||_V(i.getWidth())||i.getWidth()>a.DEFAULT_WIDTH_POLYGON&&n.getStroke().setWidth(a.DEFAULT_WIDTH_POLYGON),r.setStyle(n),this.drawGeometryToCanvas(r)}},{key:"drawGeometryToCanvas",value:function(t){var e=a.getCanvasSize(),r=Math.floor(e[0]),n=Math.floor(e[1]),i=e[0]-r,o=e[1]-n;t.drawGeometry(new Rc([[[i+3,o+3],[r-3,o+3],[r-3,n-3],[i+3,n-3],[i+3,o+3]]]))}}])&&gx(e.prototype,r),n&&gx(e,n),a}(Hw);bx.DEFAULT_WIDTH_POLYGON=3;var wx=bx;function xx(t){return(xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ex(t){return function(t){if(Array.isArray(t))return Sx(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Sx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sx(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ix(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ox(t,e){return(Ox=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Px(t);if(e){var i=Px(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Tx(this,r)}}function Tx(t,e){return!e||"object"!==xx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Px(t){return(Px=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ox(t,e)}(o,t);var e,r,n,i=Cx(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,e)).options_=t,r.canvas_=document.createElement("canvas"),r.updateCanvasPromise_=null,r.layer_=null,r}return e=o,n=[{key:"setValue",value:function(t,e,r){var n=r,i=t,s=mV(e)?e:e.split("."),a=s.length,l=s[0];1===a?(mV(n)?n=Ex(n):bV(n)&&(n=Object.assign({},n)),i[l]=n):a>1&&(_V(i[l])&&(i[l]={}),o.setValue(i[l],s.slice(1,a),n))}},{key:"deserialize",value:function(t){var e=decodeURIComponent(escape(window.atob(t))),r=JSON.parse(e),n=r.parameters,i=r.deserializedMethod;return new Function("serializedParams","return ".concat(i,"(serializedParams)"))(n)}}],(r=[{key:"apply",value:function(t){this.layer_=t,this.getImpl().applyToLayer(t),this.updateCanvas()}},{key:"unapply",value:function(t){}},{key:"get",value:function(t){var e;if(e=this.options_[t],_V(e)){var r=t.split(".");r.length>1&&(e=r.reduce((function(t,e){var r;return _V(t)||(r=t[e],t instanceof o&&(r=t.get(e))),r}),this))}return e}},{key:"set",value:function(t,e){var r=this.get(t);return o.setValue(this.options_,t,e),_V(this.layer_)||this.getImpl().updateFacadeOptions(this.options_),_V(this.feature_)||this.applyToFeature(this.feature_),this.fire(np,[t,r,e]),this.refresh(),this}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(_V(t)||(this.layer_=t),!_V(this.layer_)&&(this.apply(this.layer_),this.updateCanvas(),!_V(this.layer_.getImpl().getMap()))){var e=this.layer_.getImpl().getMap().getControls("layerswitcher")[0];_V(e)||e.render()}}},{key:"getOptions",value:function(){return this.options_}},{key:"toImage",value:function(){var t,e=this;if(_V(this.updateCanvasPromise_))if(_V(this.options_.icon)||_V(this.options_.icon.src))t=this.canvas_.toDataURL("png");else{var r=new Image;r.crossOrigin="Anonymous";var n=this.canvas_;r.onload=function(){n.getContext("2d").drawImage(e,0,0,50,50)},r.src=this.options_.icon.src,t=this.canvas_.toDataURL("png")}else t=this.updateCanvasPromise_.then((function(){return e.canvas_.toDataURL("png")}));return t}},{key:"updateCanvas",value:function(){this.updateCanvasPromise_=this.getImpl().updateCanvas(this.canvas_)}},{key:"equals",value:function(t){return this.constructor===t.constructor}},{key:"clone",value:function(){var t={};HV(t,this.options_);var e=new(0,this.getImpl().constructor)(t);return new this.constructor(t,e)}},{key:"toJSON",value:function(){return{parameters:[JV(this.getOptions())],deserializedMethod:this.getDeserializedMethod_()}}},{key:"serialize",value:function(){return window.btoa(unescape(encodeURIComponent(JSON.stringify(this))))}},{key:"canvas",get:function(){return this.canvas_}}])&&Ix(e.prototype,r),n&&Ix(e,n),o}(Nf);function Lx(t){return(Lx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kx(t,e){return(kx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fx(t);if(e){var i=Fx(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Ax(this,r)}}function Ax(t,e){return!e||"object"!==Lx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fx(t){return(Fx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kx(t,e)}(o,t);var e,r,n,i=Nx(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t,e)).feature_=null,r}return e=o,(r=[{key:"applyToFeature",value:function(t){this.feature_=t,this.getImpl().applyToFeature(t)}}])&&Mx(e.prototype,r),n&&Mx(e,n),o}(Rx);function jx(t){return(jx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gx(t){return function(t){if(Array.isArray(t))return zx(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return zx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zx(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zx(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ux(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vx(t,e,r){return(Vx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xx(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function qx(t,e){return(qx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Xx(t);if(e){var i=Xx(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Wx(this,r)}}function Wx(t,e){return!e||"object"!==jx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xx(t){return(Xx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Hx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qx(t,e)}(o,t);var e,r,n,i=Yx(o);function o(){return Ux(this,o),i.apply(this,arguments)}return e=o,n=[{key:"deserialize",value:function(t,e){var r=QV(t),n=r.map((function(t,e){return"arg".concat(e)})),i=n.reduce((function(t,e){return t.concat(", ").concat(e)}));return new Function(n,"return new ".concat(e,"(").concat(i,")")).apply(void 0,Gx(r))}}],(r=[{key:"apply",value:function(t,e,r){var n=this;this.layer_=t,this.getImpl().applyToLayer(t),!0===e&&(r?t.getFeatures().forEach((function(t){t.style=null})):t.getFeatures().forEach((function(t){t.setStyle(n.clone())}))),this.updateCanvas()}},{key:"toImage",value:function(){var t=Vx(Xx(o.prototype),"toImage",this).call(this),e={fill:this.options_.fill,stroke:this.options_.stroke};return!0===nq(e)&&(t=oq(this.canvas_)),t}},{key:"ORDER",get:function(){return 1}}])&&Bx(e.prototype,r),n&&Bx(e,n),o}(Dx);function Zx(t){return(Zx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jx(t,e){return(Jx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qx(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=eE(t);if(e){var i=eE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return tE(this,r)}}function tE(t,e){return!e||"object"!==Zx(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eE(t){return(eE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jx(t,e)}(o,t);var e,r,n,i=Qx(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Kx(this,o);var r=e,n=new wx(r);return t=i.call(this,r,n),_V(r)&&(r=o.DEFAULT_NULL),r=HV({},r),t}return e=o,(r=[{key:"getDeserializedMethod_",value:function(){return"((serializedParameters) => M.style.Simple.deserialize(serializedParameters, 'M.style.Polygon'))"}}])&&$x(e.prototype,r),n&&$x(e,n),o}(Hx);rE.DEFAULT_NULL={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5}};var nE=rE;function iE(t){return(iE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function aE(t,e){return(aE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=cE(t);if(e){var i=cE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uE(this,r)}}function uE(t,e){return!e||"object"!==iE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cE(t){return(cE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aE(t,e)}(o,t);var e,r,n,i=lE(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};oE(this,o);var r=0;return e.stroke&&(r=e.stroke.getWidth()),t=i.call(this,{radius:e.radius,fill:e.fill,rotation:e.rotation,rotateWithView:e.rotateWithView}),"number"==typeof e.opacity&&t.setOpacity(e.opacity),t.color_=e.color,t.fontSize_=e.fontSize||1,t.stroke_=e.stroke,t.fill_=e.fill,t.radius_=e.radius-r,t.form_=e.form||"none",t.gradient_=e.gradient,t.offset_=[e.offsetX?e.offsetX:0,e.offsetY?e.offsetY:0],t.glyph_=t.getGlyph(e.glyph)||"",t.renderMaker(),t}return e=o,n=[{key:"addDefs",value:function(t,e){var r=t;if("string"==typeof t&&(r={font:t,name:t,copyright:""}),!r.font||"string"!=typeof r.font)throw new Error("bad font def");var n=r.font;o.defs.fonts[n]=r,Object.keys(e).forEach((function(t){var n=e[t];"string"==typeof n&&1===n.length&&(n={char:n}),o.defs.glyphs[t]={font:r.font,char:n.char||"".concat(String.fromCharCode(n.code))||"",theme:n.theme||r.name,name:n.name||t,search:n.search||""}}))}}],(r=[{key:"clone",value:function(){var t=new o({glyph:"",color:this.color_,fontSize:this.fontSize_,stroke:this.stroke_,fill:this.fill_,radius:this.radius_+(this.stroke_?this.stroke_.getWidth():0),form:this.form_,gradient:this.gradient_,offsetX:this.offset_[0],offsetY:this.offset_[1],opacity:this.getOpacity(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return t.setScale(this.getScale()),t.setGlyph(this.getGlyph()),t.renderMaker(),t}},{key:"setGlyph",value:function(t){this.glyph_=t}},{key:"getFill",value:function(){return this.fill_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getGlyph",value:function(t){var e=this.glyph_;return t&&(e=(e=o.defs.glyphs[t])||{font:"none",char:t.charAt(0),theme:"none",name:"none",search:""}),e}},{key:"getGlyphName",value:function(){var t=this,e="";return Object.keys(o.defs.glyphs).forEach((function(r){o.defs.glyph[r]===t.glyph_&&(e=r)})),e}},{key:"getFontInfo",value:function(t){return o.defs.fonts[t.font]}},{key:"renderMaker",value:function(t){var e,r=0;this.stroke_&&(e=As(this.stroke_.getColor()),r=this.stroke_.getWidth());var n=this.getImage(1);n.height+=1,n.width+=1;var i={strokeStyle:e,strokeWidth:r,size:n.width},o=n.getContext("2d");o.clearRect(0,0,n.width,n.height),this.drawMarker_(i,o,0,0);var s=this.getAnchor();s[0]=n.width/2-this.offset_[0],s[1]=n.width/2-this.offset_[1]}},{key:"drawPath_",value:function(t,e){var r=e,n=2*this.radius_+t.strokeWidth,i=t.strokeWidth/2,o=t.size/2,s={fac:1,posX:t.size/2,posY:t.size/2};r.lineJoin="round",r.beginPath();var a=Math.PI;switch(this.form_){case"none":s.fac=1;break;case"circle":case"ban":r.arc(o,o,n/2,0,2*Math.PI,!0);break;case"poi":r.arc(o,o-.4*this.radius_,.6*this.radius_,.15*a,.85*a,!0),r.lineTo(o-.89*.05*n,(.95+.45*.05)*n+i),r.arc(o,.95*n+i,.05*n,.85*Math.PI,.15*Math.PI,!0),s={fac:.45,posX:o,posY:o-.35*this.radius_};break;case"bubble":r.arc(o,o-.2*this.radius_,.8*this.radius_,.4*a,.6*a,!0),r.lineTo(.5*n+i,n+i),s={fac:.7,posX:o,posY:o-.2*this.radius_};break;case"marker":r.arc(o,o-.2*this.radius_,.8*this.radius_,.25*a,.75*a,!0),r.lineTo(.5*n+i,n+i),s={fac:.7,posX:o,posY:o-.2*this.radius_};break;case"coma":r.moveTo(o+.8*this.radius_,o-.2*this.radius_),r.quadraticCurveTo(.95*n+i,.75*n+i,.5*n+i,n+i),r.arc(o,o-.2*this.radius_,.8*this.radius_,.45*a,0,!1),s={fac:.7,posX:o,posY:o-.2*this.radius_};break;default:var l;switch(this.form_){case"shield":l=[.05,0,.95,0,.95,.8,.5,1,.05,.8,.05,0],s.posY=.45*n+i;break;case"blazon":l=[.1,0,.9,0,.9,.8,.6,.8,.5,1,.4,.8,.1,.8,.1,0],s.fac=.8,s.posY=.4*n+i;break;case"bookmark":l=[.05,0,.95,0,.95,1,.5,.8,.05,1,.05,0],s.fac=.9,s.posY=.4*n+i;break;case"hexagon":l=[.05,.2,.5,0,.95,.2,.95,.8,.5,1,.05,.8,.05,.2],s.fac=.9,s.posY=.5*n+i;break;case"diamond":l=[.25,0,.75,0,1,.2,1,.4,.5,1,0,.4,0,.2,.25,0],s.fac=.75,s.posY=.35*n+i;break;case"triangle":l=[0,0,1,0,.5,1,0,0],s.fac=.6,s.posY=.3*n+i;break;case"sign":l=[.5,.05,1,.95,0,.95,.5,.05],s.fac=.7,s.posY=.65*n+i;break;case"lozenge":l=[.5,0,1,.5,.5,1,0,.5,.5,0],s.fac=.7;break;default:l=[0,0,1,0,1,1,0,1,0,0]}for(var u=0;u<l.length;u+=2)r.lineTo(l[u]*n+i,l[u+1]*n+i)}return r.closePath(),s}},{key:"drawMarker_",value:function(t,e,r,n){var i=e,o=this.fill_?this.fill_.getColor():"#000",s=this.stroke_?this.stroke_.getColor():"#000";"none"===this.form_&&this.stroke_&&this.fill_&&(s=this.fill_.getColor(),o=this.stroke_.getColor()),i.setTransform(1,0,0,1,0,0),i.translate(r,n);var a=this.drawPath_(t,i);if(this.fill_){if(this.gradient_&&"none"!==this.form_){var l=i.createLinearGradient(0,0,t.size/2,t.size);l.addColorStop(1,As(o)),l.addColorStop(0,As(s)),i.fillStyle=l}else i.fillStyle=As(o);i.fill()}if(this.stroke_&&t.strokeWidth&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.stroke()),this.glyph_.char){i.font="".concat(2*a.fac*this.radius_*this.fontSize_,"px ").concat(this.glyph_.font),i.strokeStyle=i.fillStyle,i.lineWidth=t.strokeWidth*("none"===this.form_?2:1),i.fillStyle=As(this.color_||s),i.textAlign="center",i.textBaseline="middle";var u=this.glyph_.char;t.strokeWidth&&"transparent"!==s&&i.strokeText(u,a.posX,a.posY),i.fillText(u,a.posX,a.posY)}if("ban"===this.form_&&this.stroke_&&t.strokeWidth){i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth;var c=this.radius_+t.strokeWidth,h=this.radius_*Math.cos(Math.PI/4);i.moveTo(c+h,c-h),i.lineTo(c-h,c+h),i.stroke()}}},{key:"getChecksum",value:function(){var t=null!==this.stroke_?this.stroke_.getChecksum():"-",e=null!==this.fill_?this.fill_.getChecksum():"-";if(null===this.checksums_||t!==this.checksums_[1]||e!==this.checksums_[2]||this.radius_!==this.checksums_[3]||"".concat(this.form_,"-").concat(this.glyphs_!==this.checksums_[4])){var r="c"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+this.form_+"-"+this.glyphs_;this.checksums_=[r,t,e,this.radius_,"".concat(this.form_,"-").concat(this.glyphs_)]}return this.checksums_[0]}}])&&sE(e.prototype,r),n&&sE(e,n),o}(Kw);function fE(t){return(fE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dE(t,e){return(dE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mE(t);if(e){var i=mE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return yE(this,r)}}function yE(t,e){return!e||"object"!==fE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mE(t){return(mE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}hE.defs={fonts:{},glyphs:{}},hE.addDefs({font:"g-cartografia",name:"g-cartografia",prefix:"g-cartografia-"},{"g-cartografia-alerta":{font:"g-cartografia",code:59648,name:"alerta",search:"alerta"},"g-cartografia-ayuda":{font:"g-cartografia",code:59649,name:"ayuda",search:"ayuda"},"g-cartografia-bandera":{font:"g-cartografia",code:59650,name:"bandera",search:"bandera"},"g-cartografia-brujula":{font:"g-cartografia",code:59651,name:"brujula",search:"brujula"},"g-cartografia-cancelar":{font:"g-cartografia",code:59652,name:"cancelar",search:"cancelar"},"g-cartografia-cancelar2":{font:"g-cartografia",code:59653,name:"cancelar2",search:"cancelar2"},"g-cartografia-capas":{font:"g-cartografia",code:59654,name:"capas",search:"capas"},"g-cartografia-capas2":{font:"g-cartografia",code:59655,name:"capas2",search:"capas2"},"g-cartografia-check":{font:"g-cartografia",code:59656,name:"check",search:"check"},"g-cartografia-check2":{font:"g-cartografia",code:59657,name:"check2",search:"check2"},"g-cartografia-check3":{font:"g-cartografia",code:59658,name:"check3",search:"check3"},"g-cartografia-check4":{font:"g-cartografia",code:59659,name:"check4",search:"check4"},"g-cartografia-check5":{font:"g-cartografia",code:59660,name:"check5",search:"check5"},"g-cartografia-comentarios":{font:"g-cartografia",code:59661,name:"comentarios",search:"comentarios"},"g-cartografia-descargar":{font:"g-cartografia",code:59662,name:"descargar",search:"descargar"},"g-cartografia-editar":{font:"g-cartografia",code:59663,name:"editar",search:"editar"},"g-cartografia-editar2":{font:"g-cartografia",code:59664,name:"editar2",search:"editar2"},"g-cartografia-escala":{font:"g-cartografia",code:59665,name:"escala",search:"escala"},"g-cartografia-escala2":{font:"g-cartografia",code:59666,name:"alerta",search:"alerta"},"g-cartografia-escala3":{font:"g-cartografia",code:59667,name:"escala3",search:"escala3"},"g-cartografia-flecha":{font:"g-cartografia",code:59668,name:"flecha",search:"flecha"},"g-cartografia-flecha-abajo":{font:"g-cartografia",code:59669,name:"flecha-abajo",search:"flecha-abajo"},"g-cartografia-flecha-abajo2":{font:"g-cartografia",code:59670,name:"flecha-abajo2",search:"flecha-abajo2"},"g-cartografia-flecha-arriba":{font:"g-cartografia",code:59671,name:"flecha-arriba",search:"flecha-arriba"},"g-cartografia-flecha-arriba2":{font:"g-cartografia",code:59672,name:"alerta",search:"alerta"},"g-cartografia-flecha-derecha":{font:"g-cartografia",code:59673,name:"flecha-derecha",search:"flecha-derecha"},"g-cartografia-flecha-derecha2":{font:"g-cartografia",code:59674,name:"flecha-derecha2",search:"flecha-derecha2"},"g-cartografia-flecha-derecha3":{font:"g-cartografia",code:59675,name:"fleha-derecha3",search:"fleha-derecha3"},"g-cartografia-flecha-deshacer":{font:"g-cartografia",code:59676,name:"flecha-deshacer",search:"flecha-deshacer"},"g-cartografia-flecha-izquierda":{font:"g-cartografia",code:59677,name:"flecha-izquierda",search:"flecha-izquierda"},"g-cartografia-flecha-izquierda2":{font:"g-cartografia",code:59678,name:"flecha-izquierda2",search:"flecha-izquierda2"},"g-cartografia-flecha-izquierda3":{font:"g-cartografia",code:59679,name:"flecha-izquierda3",search:"flecha-izquierda3"},"g-cartografia-flecha-link":{font:"g-cartografia",code:59680,name:"flecha-link",search:"flecha-link"},"g-cartografia-flechas-mover":{font:"g-cartografia",code:59681,name:"flechas-mover",search:"flechas-mover"},"g-cartografia-gps":{font:"g-cartografia",code:59682,name:"gps",search:"gps"},"g-cartografia-gps2":{font:"g-cartografia",code:59683,name:"gps2",search:"gps2"},"g-cartografia-gps3":{font:"g-cartografia",code:59684,name:"gps3",search:"gps3"},"g-cartografia-gps4":{font:"g-cartografia",code:59685,name:"gps4",search:"gps4"},"g-cartografia-guardar":{font:"g-cartografia",code:59686,name:"guardar",search:"guardar"},"g-cartografia-herramienta":{font:"g-cartografia",code:59687,name:"herramienta",search:"herramienta"},"g-cartografia-impresora":{font:"g-cartografia",code:59688,name:"impresora",search:"impresora"},"g-cartografia-info":{font:"g-cartografia",code:59689,name:"info",search:"info"},"g-cartografia-linea":{font:"g-cartografia",code:59690,name:"linea",search:"linea"},"g-cartografia-lineas":{font:"g-cartografia",code:59691,name:"lineas",search:"lineas"},"g-cartografia-lista":{font:"g-cartografia",code:59692,name:"lista",search:"lista"},"g-cartografia-localizacion":{font:"g-cartografia",code:59693,name:"localizacion",search:"localizacion"},"g-cartografia-localizacion2":{font:"g-cartografia",code:59694,name:"localizacion2",search:"localizacion2"},"g-cartografia-localizacion3":{font:"g-cartografia",code:59695,name:"localizacion3",search:"localizacion3"},"g-cartografia-localizacion4":{font:"g-cartografia",code:59696,name:"localizacion4",search:"localizacion4"},"g-cartografia-mano":{font:"g-cartografia",code:59697,name:"mano",search:"mano"},"g-cartografia-mano2":{font:"g-cartografia",code:59698,name:"mano2",search:"mano2"},"g-cartografia-mapa":{font:"g-cartografia",code:59699,name:"mapa",search:"mapa"},"g-cartografia-mas":{font:"g-cartografia",code:59700,name:"mas",search:"mas"},"g-cartografia-mas2":{font:"g-cartografia",code:59701,name:"mas2",search:"mas2"},"g-cartografia-medir-area":{font:"g-cartografia",code:59702,name:"medir-area",search:"medir-area"},"g-cartografia-medir-linea":{font:"g-cartografia",code:59703,name:"medir-linea",search:"medir-linea"},"g-cartografia-menos":{font:"g-cartografia",code:59704,name:"menos",search:"menos"},"g-cartografia-menos2":{font:"g-cartografia",code:59705,name:"alerta",search:"alerta"},"g-cartografia-menu":{font:"g-cartografia",code:59706,name:"menos2",search:"menos2"},"g-cartografia-mundo":{font:"g-cartografia",code:59707,name:"mundo",search:"mundo"},"g-cartografia-mundo2":{font:"g-cartografia",code:59708,name:"mundo2",search:"mundo2"},"g-cartografia-opciones":{font:"g-cartografia",code:59709,name:"opciones",search:"opciones"},"g-cartografia-papelera":{font:"g-cartografia",code:59710,name:"papelera",search:"papelera"},"g-cartografia-pin":{font:"g-cartografia",code:59711,name:"pin",search:"pin"},"g-cartografia-pin2":{font:"g-cartografia",code:59712,name:"pin2",search:"pin2"},"g-cartografia-pin3":{font:"g-cartografia",code:59713,name:"pin3",search:"pin3"},"g-cartografia-pin4":{font:"g-cartografia",code:59714,name:"pin4",search:"pin4"},"g-cartografia-pin-nuevo":{font:"g-cartografia",code:59715,name:"pin-nuevo",search:"pin-nuevo"},"g-cartografia-poligono":{font:"g-cartografia",code:59716,name:"poligono",search:"poligono"},"g-cartografia-posicion":{font:"g-cartografia",code:59717,name:"posicion",search:"posicion"},"g-cartografia-posicion2":{font:"g-cartografia",code:59718,name:"posicion2",search:"posicion2"},"g-cartografia-posicion3":{font:"g-cartografia",code:59719,name:"posicion3",search:"posicion3"},"g-cartografia-posicion4":{font:"g-cartografia",code:59720,name:"posicion4",search:"posicion4"},"g-cartografia-posicion5":{font:"g-cartografia",code:59721,name:"posicion5",search:"posicion5"},"g-cartografia-posicion6":{font:"g-cartografia",code:59722,name:"posicion6",search:"posicion6"},"g-cartografia-posicion7":{font:"g-cartografia",code:59723,name:"posicion7",search:"posicion7"},"g-cartografia-prismaticos":{font:"g-cartografia",code:59724,name:"prismaticos",search:"prismaticos"},"g-cartografia-regla":{font:"g-cartografia",code:59725,name:"regla",search:"regla"},"g-cartografia-reglas":{font:"g-cartografia",code:59726,name:"reglas",search:"reglas"},"g-cartografia-ruta":{font:"g-cartografia",code:59727,name:"ruta",search:"ruta"},"g-cartografia-spinner":{font:"g-cartografia",code:59728,name:"spinner",search:"spinner"},"g-cartografia-spinner2":{font:"g-cartografia",code:59729,name:"spinner2",search:"spinner2"},"g-cartografia-subir":{font:"g-cartografia",code:59739,name:"subir",search:"subir"},"g-cartografia-tamano":{font:"g-cartografia",code:59740,name:"tamano",search:"tamano"},"g-cartografia-temperatura":{font:"g-cartografia",code:59741,name:"temperatura",search:"temperatura"},"g-cartografia-texto":{font:"g-cartografia",code:59742,name:"texto",search:"texto"},"g-cartografia-usuario":{font:"g-cartografia",code:59743,name:"usuario",search:"usuario"},"g-cartografia-usuario2":{font:"g-cartografia",code:59744,name:"usuario2",search:"usuario2"},"g-cartografia-zoom":{font:"g-cartografia",code:59745,name:"zoom",search:"zoom"},"g-cartografia-zoom-extension":{font:"g-cartografia",code:59746,name:"zoom-extension",search:"zoom-extension"},"g-cartografia-zoom-mas":{font:"g-cartografia",code:59747,name:"zoom-mas",search:"zoom-mas"},"g-cartografia-zoom-menos":{font:"g-cartografia",code:59748,name:"zoom-menos",search:"zoom-menos"},"g-cartografia-pin5":{font:"g-cartografia",code:59749,name:"pin5",search:"pin5"},"g-cartografia-pin-nuevo2":{font:"g-cartografia",code:59750,name:"pin-nuevo2",search:"pin-nuevo2"},"g-cartografia-pin-seleccionado":{font:"g-cartografia",code:59751,name:"pin-seleccionado",search:"pin-seleccionado"},"g-cartografia-brujula-norte":{font:"g-cartografia",code:59752,name:"brujula-norte",search:"brujula-norte"}});var _E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dE(t,e)}(r,t);var e=gE(r);function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};pE(this,r);var n=t;return t.anchor||(n.anchor=[]),t.offset||(n.offset=[]),e.call(this,{glyph:t.glyph,color:t.color,fontSize:t.fontSize,stroke:t.stroke,fill:t.fill,radius:t.radius,form:t.form,gradient:t.gradient,offsetX:t.offset[0],offsetY:t.offset[1],opacity:t.opacity,rotation:t.rotation,rotateWithView:t.rotateWithView})}return r}(hE);function vE(t){return(vE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xE(t,e){return(xE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function EE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=IE(t);if(e){var i=IE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return SE(this,r)}}function SE(t,e){return!e||"object"!==vE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function IE(t){return(IE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var OE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xE(t,e)}(o,t);var e,r,n,i=EE(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return bE(this,o),i.call(this,{anchor:t.anchor?t.anchor.slice():void 0,anchorOrigin:t.anchorOrigin,anchorXUnits:t.anchorXUnits,anchorYUnits:t.anchorYUnits,crossOrigin:t.crossOrigin||null,color:t.color&&t.color.slice?t.color.slice():t.color||void 0,src:t.src,offset:t.offset?t.offset.slice():void 0,offsetOrigin:t.offsetOrigin,size:t.size?t.size.slice():void 0,imgSize:t.imgSize,opacity:t.opacity,scale:t.scale,snapToPixel:t.snapToPixel,rotation:t.rotation,rotateWithView:t.rotateWithView})}return e=o,(r=[{key:"clone",value:function(){return new o({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})}},{key:"size",set:function(t){this.size_=Array.isArray(t)?t:null}},{key:"anchor",set:function(t){this.anchor_=Array.isArray(t)?t:null}},{key:"origin",set:function(t){this.origin_=Array.isArray(t)?t:null}}])&&wE(e.prototype,r),n&&wE(e,n),o}(hw);function CE(t){return(CE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function RE(t,e){return(RE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function LE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kE(t);if(e){var i=kE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ME(this,r)}}function ME(t,e){return!e||"object"!==CE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kE(t){return(kE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var NE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&RE(t,e)}(o,t);var e,r,n,i=LE(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return TE(this,o),i.call(this,{points:1/0,fill:t.fill,radius:t.radius,snapToPixel:t.snapToPixel,stroke:t.stroke,atlasManager:t.atlasManager})}return e=o,(r=[{key:"clone",value:function(){var t=new o({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t}}])&&PE(e.prototype,r),n&&PE(e,n),o}(Jw);function AE(t){return(AE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function FE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jE(t,e){return(jE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function GE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=UE(t);if(e){var i=UE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return zE(this,r)}}function zE(t,e){return!e||"object"!==AE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function UE(t){return(UE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var BE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jE(t,e)}(a,t);var e,r,n,s=GE(a);function a(){return FE(this,a),s.apply(this,arguments)}return e=a,(r=[{key:"toImage",value:function(t){var e=null,r={fill:this.options_.fill,stroke:this.options_.stroke,icon:this.options_.icon};if(!0===nq(r))e=oq(t);else{if(_V(this.olStyleFn_))return null;var n=this.olStyleFn_()[1];if(n.getImage&&null!=n.getImage()&&n.getImage()instanceof sw){if(n.getImage()instanceof _E){var i=n.getImage().getImage(1);null!=i&&i&&(e=i.toDataURL())}else if(n.getImage()instanceof OE){var o=n.getImage();if(!_V(o)&&!(e=o.getSrc()).startsWith(window.location.origin)){var s=DV([M.config.PROXY_URL,"/image"]);e=OV(s,{url:e})}}}else{null!=(n=this.olStyleFn_()[0]).getImage()&&null!=n.getImage().getStroke()&&(n.getImage().getStroke().getWidth()>a.DEFAULT_WIDTH_POINT&&n.getImage().getStroke().setWidth(a.DEFAULT_WIDTH_POINT),n.getImage().render());var l=n.getImage().getImage(1);null!=l&&(e=l.toDataURL())}}return e}},{key:"updateFacadeOptions",value:function(t){var e=this;this.olStyleFn_=function(r){var n=r;n instanceof Cg||n instanceof kg||(n=e);var s,a,l=new px({zIndex:Hw.getValue(t.zindex,n,e.layer_),geometry:function(t){var e=null;if("MultiPoint"===t.getGeometry().getType())e=new jg(t.getGeometry().getCoordinates());else{var r=ry.getCentroid(t.getGeometry());e=new dc(r)}return e}}),c=new px({zIndex:Hw.getValue(t.zindex,n,e.layer_),geometry:function(t){var e=null;if("MultiPoint"===t.getGeometry().getType())e=new jg(t.getGeometry().getCoordinates());else{var r=ry.getCentroid(t.getGeometry());e=new dc(r)}return e}});if(n instanceof Cg){var h=function(t){var e=null;if("MultiPoint"===t.getGeometry().getType())e=new jg(t.getGeometry().getCoordinates());else{var r=ry.getCentroid(t.getGeometry());e=new dc(r)}return e};l.setGeometry(h),c.setGeometry(h)}if(!_V(t.fill)){var f=Hw.getValue(t.fill.color,n,e.layer_),p=Hw.getValue(t.fill.opacity,n,e.layer_);p||0===p||(p=1),_V(f)||(s=new Kb({color:u()(f).alpha(p).css()}))}if(!_V(t.stroke)){var d=Hw.getValue(t.stroke.color,n,e.layer_);if(!_V(d)){var g=t.stroke.linedashoffset;a=new Zb({color:d,width:Hw.getValue(t.stroke.width,n,e.layer_),lineDash:Hw.getValue(t.stroke.linedash,n,e.layer_),lineDashOffset:Hw.getValue(g,n,e.layer_),lineCap:Hw.getValue(t.stroke.linecap,n,e.layer_),lineJoin:Hw.getValue(t.stroke.linejoin,n,e.layer_),miterLimit:Hw.getValue(t.stroke.miterlimit,n,e.layer_)})}}if(!_V(t.label)){var y=Hw.getValue(t.label.text,n,e.layer_),m=Hw.getValue(t.label.align,n,e.layer_),_=Hw.getValue(t.label.baseline,n,e.layer_),v=new Qb({font:Hw.getValue(t.label.font,n,e.layer_),rotateWithView:Hw.getValue(t.label.rotate,n,e.layer_),scale:Hw.getValue(t.label.scale,n,e.layer_),offsetX:Hw.getValue(t.label.offset?t.label.offset[0]:void 0,n,e.layer_),offsetY:Hw.getValue(t.label.offset?t.label.offset[1]:void 0,n,e.layer_),fill:new Kb({color:Hw.getValue(t.label.color||"#000000",n,e.layer_)}),textAlign:Object.values(o).includes(m)?m:"center",textBaseline:Object.values(i).includes(_)?_:"top",text:void 0===y?void 0:String(y),rotation:Hw.getValue(t.label.rotation,n,e.layer_)});if(!_V(t.label.stroke)){var b=t.label.stroke,w=b.miterlimit,x=b.linedashoffset;v.setStroke(new Zb({color:Hw.getValue(t.label.stroke.color,n,e.layer_),width:Hw.getValue(t.label.stroke.width,n,e.layer_),lineCap:Hw.getValue(t.label.stroke.linecap,n,e.layer_),lineJoin:Hw.getValue(t.label.stroke.linejoin,n,e.layer_),lineDash:Hw.getValue(t.label.stroke.linedash,n,e.layer_),lineDashOffset:Hw.getValue(x,n,e.layer_),miterLimit:Hw.getValue(w,n,e.layer_)}))}l.setText(v)}return l.setImage(new NE({fill:s,stroke:a,radius:Hw.getValue(t.radius,n,e.layer_),snapToPixel:Hw.getValue(t.snapToPixel,n,e.layer_)})),_V(t.icon)||(_V(t.icon.src)?_V(t.icon.form)||c.setImage(new _E({form:_V(Hw.getValue(t.icon.form,n,e.layer_))?"":Hw.getValue(t.icon.form,n,e.layer_).toLowerCase(),gradient:Hw.getValue(t.icon.gradient,n,e.layer_),glyph:Hw.getValue(t.icon.class,n,e.layer_),fontSize:Hw.getValue(t.icon.fontsize,n,e.layer_),radius:Hw.getValue(t.icon.radius,n,e.layer_),rotation:Hw.getValue(t.icon.rotation,n,e.layer_),rotateWithView:Hw.getValue(t.icon.rotate,n,e.layer_),offsetX:Hw.getValue(t.icon.offset?t.icon.offset[0]:void 0,n,e.layer_),offsetY:Hw.getValue(t.icon.offset?t.icon.offset[1]:void 0,n,e.layer_),fill:new Kb({color:Hw.getValue(void 0!==t.icon.fill?t.icon.fill:"#FFFFFF",n,e.layer_)}),stroke:t.icon.color?new Zb({color:Hw.getValue(t.icon.color,n,e.layer_),width:1}):void 0,anchor:Hw.getValue(t.icon.anchor,n,e.layer_),anchorXUnits:Hw.getValue(t.icon.anchorxunits,n,e.layer_),anchorYUnits:Hw.getValue(t.icon.anchoryunits,n,e.layer_),src:Hw.getValue(t.icon.src,n,e.layer_),opacity:Hw.getValue(t.icon.opacity,n,e.layer_),scale:Hw.getValue(t.icon.scale,n,e.layer_),snapToPixel:Hw.getValue(t.icon.snaptopixel,n,e.layer_),offsetOrigin:Hw.getValue(t.icon.offsetorigin,n,e.layer_),offset:Hw.getValue(t.icon.offset,n,e.layer_),crossOrigin:Hw.getValue(t.icon.crossorigin,n,e.layer_),anchorOrigin:Hw.getValue(t.icon.anchororigin,n,e.layer_),size:Hw.getValue(t.icon.size,n,e.layer_)})):c.setImage(new OE({anchor:Hw.getValue(t.icon.anchor,n,e.layer_),anchorXUnits:Hw.getValue(t.icon.anchorxunits,n,e.layer_),anchorYUnits:Hw.getValue(t.icon.anchoryunits,n,e.layer_),src:Hw.getValue(t.icon.src,n,e.layer_),opacity:Hw.getValue(t.icon.opacity,n,e.layer_),scale:Hw.getValue(t.icon.scale,n,e.layer_),rotation:Hw.getValue(t.icon.rotation,n,e.layer_),rotateWithView:Hw.getValue(t.icon.rotate,n,e.layer_),snapToPixel:Hw.getValue(t.icon.snaptopixel,n,e.layer_),offsetOrigin:Hw.getValue(t.icon.offsetorigin,n,e.layer_),offset:Hw.getValue(t.icon.offset,n,e.layer_),crossOrigin:Hw.getValue(t.icon.crossorigin,n,e.layer_),anchorOrigin:Hw.getValue(t.icon.anchororigin,n,e.layer_),size:Hw.getValue(t.icon.size,n,e.layer_)}))),[l,c]}}},{key:"drawGeometryToCanvas",value:function(t){this.olStyleFn_()[1].getImage()instanceof hE?t.drawGeometry(new dc([10,10])):t.drawCircle(new Hg([this.getCanvasSize()[0]/2,this.getCanvasSize()[1]/2],this.getRadius_()))}},{key:"updateCanvas",value:function(t){if(this.updateFacadeOptions(this.options_),!nq(this.options_)){var e=this.getCanvasSize(),r=Tw(t.getContext("2d"),{size:e}),n=this.olStyleFn_()[0];_V(n.getText())||n.setText(null),!_V(this.olStyleFn_()[1])&&this.olStyleFn_()[1].getImage()instanceof hE&&(n=this.olStyleFn_()[1]);var i=n.getImage().getStroke();_V(i)||_V(i.getWidth())||i.setWidth(3),r.setStyle(n),this.drawGeometryToCanvas(r)}}},{key:"getCanvasSize",value:function(){var t,e=this.olStyleFn_()[1].getImage();if(e instanceof hE)t=[90,90];else{var r=this.getRadius_(e);t=[2*r+4,2*r+4]}return t}},{key:"getRadius_",value:function(t){return t instanceof hw?25:t instanceof hE?t.getRadius():this.olStyleFn_()[0].getImage().getRadius()}}])&&DE(e.prototype,r),n&&DE(e,n),a}(Hw);BE.DEFAULT_WIDTH_POINT=3;var VE=BE;function qE(t){return(qE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function YE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function WE(t,e){return(WE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ZE(t);if(e){var i=ZE(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return HE(this,r)}}function HE(t,e){return!e||"object"!==qE(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ZE(t){return(ZE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var KE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&WE(t,e)}(o,t);var e,r,n,i=XE(o);function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=t;e=_V(e)?o.DEFAULT_NULL:HV(e,o.DEFAULT),e=HV({},e);var r=new VE(e);return i.call(this,e,r)}return e=o,(r=[{key:"toImage",value:function(){return this.getImpl().toImage(this.canvas_)}},{key:"getDeserializedMethod_",value:function(){return"((serializedParameters) => M.style.Simple.deserialize(serializedParameters, 'M.style.Point'))"}}])&&YE(e.prototype,r),n&&YE(e,n),o}(Hx);KE.DEFAULT={radius:5},KE.DEFAULT_NULL={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5},radius:5};var $E=KE,JE=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),QE="renderOrder",tS=function(t){function e(e){var r=this,n=e||{},i=V({},n);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(r=t.call(this,i)||this).declutter_=void 0!==n.declutter&&n.declutter,r.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(n.style),r.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,r.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,r}return JE(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(QE)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new mb.a(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(QE,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:rx,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var r;Array.isArray(t)?r=t:(ut("function"==typeof t.getZIndex,41),r=[t]),e=function(){return r}}return e}(this.style_),this.changed()},e}(Ya),eS={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},rS=[eS.FILL],nS=[eS.STROKE],iS=[eS.BEGIN_PATH],oS=[eS.CLOSE_PATH],sS=eS,aS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lS=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=r,o.pixelRatio=i,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return aS(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatPointCoordinates=function(t,e){for(var r=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,i=this.coordinates,o=i.length,s=0,a=t.length;s<a;s+=e)n[0]=t[s],n[1]=t[s+1],dt(r,n)&&(i[o++]=n[0],i[o++]=n[1]);return o},e.prototype.appendFlatLineCoordinates=function(t,e,r,n,i,o){var s=this.coordinates,a=s.length,l=this.getBufferedMaxExtent();o&&(e+=n);var u,c,h,f=t[e],p=t[e+1],d=this.tmpCoordinate_,g=!0;for(u=e+n;u<r;u+=n)d[0]=t[u],d[1]=t[u+1],(h=mt(l,d))!==c?(g&&(s[a++]=f,s[a++]=p,g=!1),s[a++]=d[0],s[a++]=d[1]):h===et?(s[a++]=d[0],s[a++]=d[1],g=!1):g=!0,f=d[0],p=d[1],c=h;return(i&&g||u===e+n)&&(s[a++]=f,s[a++]=p),a},e.prototype.drawCustomCoordinates_=function(t,e,r,n,i){for(var o=0,s=r.length;o<s;++o){var a=r[o],l=this.appendFlatLineCoordinates(t,e,a,n,!1,!1);i.push(l),e=a}return e},e.prototype.drawCustom=function(t,e,r,n){this.beginGeometry(t,e);var i,o,s,a,l,u=t.getType(),c=t.getStride(),h=this.coordinates.length;switch(u){case Yt.MULTI_POLYGON:i=t.getOrientedFlatCoordinates(),a=[];var f=t.getEndss();l=0;for(var p=0,d=f.length;p<d;++p){var g=[];l=this.drawCustomCoordinates_(i,l,f[p],c,g),a.push(g)}this.instructions.push([sS.CUSTOM,h,a,t,r,lc]),this.hitDetectionInstructions.push([sS.CUSTOM,h,a,t,n||r,lc]);break;case Yt.POLYGON:case Yt.MULTI_LINE_STRING:s=[],i=u==Yt.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),l=this.drawCustomCoordinates_(i,0,t.getEnds(),c,s),this.instructions.push([sS.CUSTOM,h,s,t,r,ac]),this.hitDetectionInstructions.push([sS.CUSTOM,h,s,t,n||r,ac]);break;case Yt.LINE_STRING:case Yt.CIRCLE:i=t.getFlatCoordinates(),o=this.appendFlatLineCoordinates(i,0,i.length,c,!1,!1),this.instructions.push([sS.CUSTOM,h,o,t,r,sc]),this.hitDetectionInstructions.push([sS.CUSTOM,h,o,t,n||r,sc]);break;case Yt.MULTI_POINT:i=t.getFlatCoordinates(),(o=this.appendFlatPointCoordinates(i,c))>h&&(this.instructions.push([sS.CUSTOM,h,o,t,r,sc]),this.hitDetectionInstructions.push([sS.CUSTOM,h,o,t,n||r,sc]));break;case Yt.POINT:i=t.getFlatCoordinates(),this.coordinates.push(i[0],i[1]),o=this.coordinates.length,this.instructions.push([sS.CUSTOM,h,o,t,r]),this.hitDetectionInstructions.push([sS.CUSTOM,h,o,t,n||r])}this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[sS.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[sS.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var r,n,i=e.length,o=-1;for(t=0;t<i;++t)(n=(r=e[t])[0])==sS.END_GEOMETRY?o=t:n==sS.BEGIN_GEOMETRY&&(r[2]=t,Ve(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var r=this.state;if(t){var n=t.getColor();r.fillStyle=pw(n||fl)}else r.fillStyle=void 0;if(e){var i=e.getColor();r.strokeStyle=pw(i||yl);var o=e.getLineCap();r.lineCap=void 0!==o?o:pl;var s=e.getLineDash();r.lineDash=s?s.slice():dl;var a=e.getLineDashOffset();r.lineDashOffset=a||0;var l=e.getLineJoin();r.lineJoin=void 0!==l?l:gl;var u=e.getWidth();r.lineWidth=void 0!==u?u:1;var c=e.getMiterLimit();r.miterLimit=void 0!==c?c:10,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)}else r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,r=[sS.SET_FILL_STYLE,e];return"string"!=typeof e&&r.push(!0),r},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[sS.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var r=t.fillStyle;"string"==typeof r&&t.currentFillStyle==r||(void 0!==r&&this.instructions.push(e.call(this,t)),t.currentFillStyle=r)},e.prototype.updateStrokeStyle=function(t,e){var r=t.strokeStyle,n=t.lineCap,i=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=r||t.currentLineCap!=n||i!=t.currentLineDash&&!We(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==r&&e.call(this,t),t.currentStrokeStyle=r,t.currentLineCap=n,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[sS.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ft(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ht(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(fw),uS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),cS=function(t){function e(e,r,n,i){var o=t.call(this,e,r,n,i)||this;return o.hitDetectionImage_=null,o.image_=null,o.imagePixelRatio_=void 0,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o.declutterImageWithText_=void 0,o}return uS(e,t),e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var r=t.getFlatCoordinates(),n=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(r,n);this.instructions.push([sS.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([sS.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var r=t.getFlatCoordinates(),n=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(r,n);this.instructions.push([sS.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([sS.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var r=t.getAnchor(),n=t.getSize(),i=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=i,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0]*this.imagePixelRatio_,this.originY_=s[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterImageWithText_=e},e}(lS),hS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fS=function(t){function e(e,r,n,i){return t.call(this,e,r,n,i)||this}return hS(e,t),e.prototype.drawFlatCoordinates_=function(t,e,r,n){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,r,n,!1,!1),s=[sS.MOVE_TO_LINE_TO,i,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),r},e.prototype.drawLineString=function(t,e){var r=this.state,n=r.strokeStyle,i=r.lineWidth;if(void 0!==n&&void 0!==i){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([sS.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,dl,0],iS);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(nS),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var r=this.state,n=r.strokeStyle,i=r.lineWidth;if(void 0!==n&&void 0!==i){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([sS.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],iS);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,u=0,c=o.length;u<c;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(nS),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(nS),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(nS),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(iS)},e}(lS),pS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dS=function(t){function e(e,r,n,i){return t.call(this,e,r,n,i)||this}return pS(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,r,n){var i=this.state,o=void 0!==i.fillStyle,s=void 0!==i.strokeStyle,a=r.length;this.instructions.push(iS),this.hitDetectionInstructions.push(iS);for(var l=0;l<a;++l){var u=r[l],c=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,u,n,!0,!s),f=[sS.MOVE_TO_LINE_TO,c,h];this.instructions.push(f),this.hitDetectionInstructions.push(f),s&&(this.instructions.push(oS),this.hitDetectionInstructions.push(oS)),e=u}return o&&(this.instructions.push(rS),this.hitDetectionInstructions.push(rS)),s&&(this.instructions.push(nS),this.hitDetectionInstructions.push(nS)),e},e.prototype.drawCircle=function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([sS.SET_FILL_STYLE,fl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([sS.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,s,!1,!1);var l=[sS.CIRCLE,a];this.instructions.push(iS,l),this.hitDetectionInstructions.push(iS,l),void 0!==r.fillStyle&&(this.instructions.push(rS),this.hitDetectionInstructions.push(rS)),void 0!==r.strokeStyle&&(this.instructions.push(nS),this.hitDetectionInstructions.push(nS)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([sS.SET_FILL_STYLE,fl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([sS.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var r=this.state,n=r.fillStyle,i=r.strokeStyle;if(void 0!==n||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([sS.SET_FILL_STYLE,fl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([sS.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,u=0,c=o.length;u<c;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var r=this.coordinates,n=0,i=r.length;n<i;++n)r[n]=nc(r[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(lS);function gS(t,e,r,n,i){var o,s,a,l,u,c,h,f,p,d=r,g=r,y=0,m=0,_=r;for(o=r;o<n;o+=i){var v=e[o],b=e[o+1];void 0!==l&&(f=v-l,p=b-u,a=Math.sqrt(f*f+p*p),void 0!==c&&(m+=s,Math.acos((c*f+h*p)/(s*a))>t&&(m>y&&(y=m,d=_,g=o),m=0,_=o-i)),s=a,c=f,h=p),l=v,u=b}return(m+=a)>y?[_,o]:[d,g]}var yS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mS={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},_S={Circle:dS,Default:lS,Image:cS,LineString:fS,Polygon:dS,Text:function(t){function e(e,r,n,i){var o=t.call(this,e,r,n,i)||this;return o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o.declutterImageWithText_=void 0,o}return yS(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var r=this.textFillState_,n=this.textStrokeState_,i=this.textState_;if(""!==this.text_&&i&&(r||n)){var o=this.coordinates,s=o.length,a=t.getType(),l=null,u=t.getStride();if(i.placement!==Jb||a!=Yt.LINE_STRING&&a!=Yt.MULTI_LINE_STRING&&a!=Yt.POLYGON&&a!=Yt.MULTI_POLYGON){var c=i.overflow?null:[];switch(a){case Yt.POINT:case Yt.MULTI_POINT:l=t.getFlatCoordinates();break;case Yt.LINE_STRING:l=t.getFlatMidpoint();break;case Yt.CIRCLE:l=t.getCenter();break;case Yt.MULTI_LINE_STRING:l=t.getFlatMidpoints(),u=2;break;case Yt.POLYGON:l=t.getFlatInteriorPoint(),i.overflow||c.push(l[2]/this.resolution),u=3;break;case Yt.MULTI_POLYGON:var h=t.getFlatInteriorPoints();l=[];for(x=0,E=h.length;x<E;x+=3)i.overflow||c.push(h[x+2]/this.resolution),l.push(h[x],h[x+1]);if(0===l.length)return;u=2}if((R=this.appendFlatPointCoordinates(l,u))===s)return;if(c&&(R-s)/2!=l.length/u){var f=s/2;c=c.filter((function(t,e){var r=o[2*(f+e)]===l[e*u]&&o[2*(f+e)+1]===l[e*u+1];return r||--f,r}))}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var p=i.padding;if(p!=vl&&(i.scale[0]<0||i.scale[1]<0)){var d=i.padding[0],g=i.padding[1],y=i.padding[2],m=i.padding[3];i.scale[0]<0&&(g=-g,m=-m),i.scale[1]<0&&(d=-d,y=-y),p=[d,g,y,m]}var _=this.pixelRatio;this.instructions.push([sS.DRAW_IMAGE,s,R,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,p==vl?vl:p.map((function(t){return t*_})),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]);var v=1/_;this.hitDetectionInstructions.push([sS.DRAW_IMAGE,s,R,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[v,v],NaN,this.declutterImageWithText_,p,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]),this.endGeometry(e)}else{if(!zt(this.getBufferedMaxExtent(),t.getExtent()))return;var b=void 0;if(l=t.getFlatCoordinates(),a==Yt.LINE_STRING)b=[l.length];else if(a==Yt.MULTI_LINE_STRING)b=t.getEnds();else if(a==Yt.POLYGON)b=t.getEnds().slice(0,1);else if(a==Yt.MULTI_POLYGON){var w=t.getEndss();b=[];for(var x=0,E=w.length;x<E;++x)b.push(w[x][0])}this.beginGeometry(t,e);for(var S=i.textAlign,I=0,O=void 0,C=0,T=b.length;C<T;++C){if(null==S){var P=gS(i.maxAngle,l,I,b[C],u);I=P[0],O=P[1]}else O=b[C];for(var x=I;x<O;x+=u)o.push(l[x],l[x+1]);var R=o.length;I=b[C],this.drawChars_(s,R),s=R}this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,r=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||ml,textBaseline:e.textBaseline||_l,scale:e.scale});var o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))},e.prototype.drawChars_=function(t,e){var r=this.textStrokeState_,n=this.textState_,i=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();var a=this.pixelRatio,l=mS[n.textBaseline],u=this.textOffsetY_*a,c=this.text_,h=r?r.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([sS.DRAW_CHARS,t,e,l,n.overflow,s,n.maxAngle,a,u,i,h*a,c,o,1]),this.hitDetectionInstructions.push([sS.DRAW_CHARS,t,e,l,n.overflow,s,n.maxAngle,1,u,i,h,c,o,1/a])},e.prototype.setTextStyle=function(t,e){var r,n,i;if(t){var o=t.getFill();o?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=pw(o.getColor()||fl)):(n=null,this.textFillState_=n);var s=t.getStroke();if(s){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var a=s.getLineDash(),l=s.getLineDashOffset(),u=s.getWidth(),c=s.getMiterLimit();i.lineCap=s.getLineCap()||pl,i.lineDash=a?a.slice():dl,i.lineDashOffset=void 0===l?0:l,i.lineJoin=s.getLineJoin()||gl,i.lineWidth=void 0===u?1:u,i.miterLimit=void 0===c?10:c,i.strokeStyle=pw(s.getColor()||yl)}else i=null,this.textStrokeState_=i;r=this.textState_;var h=t.getFont()||hl;Ol(h);var f=t.getScaleArray();r.overflow=t.getOverflow(),r.font=h,r.maxAngle=t.getMaxAngle(),r.placement=t.getPlacement(),r.textAlign=t.getTextAlign(),r.textBaseline=t.getTextBaseline()||_l,r.backgroundFill=t.getBackgroundFill(),r.backgroundStroke=t.getBackgroundStroke(),r.padding=t.getPadding()||vl,r.scale=void 0===f?[1,1]:f;var p=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),y=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===y?0:y,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:Object(st.c)(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Object(st.c)(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e},e}(lS)},vS=function(){function t(t,e,r,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=r,this.buildersByZIndex_={}}return t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var r=this.buildersByZIndex_[e];for(var n in r){var i=r[n].finish();t[e][n]=i}}return t},t.prototype.getBuilder=function(t,e){var r=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[r];void 0===n&&(n={},this.buildersByZIndex_[r]=n);var i=n[e];void 0===i&&(i=new(0,_S[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=i);return i},t}();function bS(t,e,r,n,i,o,s,a,l,u,c,h){var f=t[e],p=t[e+1],d=0,g=0,y=0,m=0;function _(){d=f,g=p,f=t[e+=n],p=t[e+1],m+=y,y=Math.sqrt((f-d)*(f-d)+(p-g)*(p-g))}do{_()}while(e<r-n&&m+y<o);for(var v=0===y?0:(o-m)/y,b=S(d,f,v),w=S(g,p,v),x=e-n,E=m,I=o+a*l(u,i,c);e<r-n&&m+y<I;)_();var O,C=S(d,f,v=0===y?0:(I-m)/y),T=S(g,p,v);if(h){var P=[b,w,C,T];Gu(P,0,4,2,h,P,P),O=P[0]>P[2]}else O=b>C;var R,L=Math.PI,M=[],k=x+n===e;if(y=0,m=E,f=t[e=x],p=t[e+1],k){_(),R=Math.atan2(p-g,f-d),O&&(R+=R>0?-L:L);var N=(C+b)/2,A=(T+w)/2;return M[0]=[N,A,(I-o)/2,R,i],M}for(var F=0,D=i.length;F<D;){_();var j=Math.atan2(p-g,f-d);if(O&&(j+=j>0?-L:L),void 0!==R){var G=j-R;if(G+=G>L?-2*L:G<-L?2*L:0,Math.abs(G)>s)return null}R=j;for(var z=F,U=0;F<D;++F){var B=a*l(u,i[O?D-F-1:F],c);if(e+n<r&&m+y<o+U+B/2)break;U+=B}if(F!==z){var V=O?i.substring(D-z,D-F):i.substring(z,F);N=S(d,f,v=0===y?0:(o+U/2-m)/y),A=S(g,p,v);M.push([N,A,U/2,j,V]),o+=U}}return M}var wS=[1/0,1/0,-1/0,-1/0],xS=[],ES=[],SS=[],IS=[];function OS(t){return t[3].declutterBox}var CS=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function TS(t,e){return"start"!==e&&"end"!==e||CS.test(t)||(e="start"===e?"left":"right"),mS[e]}var PS=function(){function t(t,e,r,n){this.overlaps=r,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,r,n){var i=t+e+r+n;if(this.labels_[i])return this.labels_[i];var o=n?this.strokeStates[n]:null,s=r?this.fillStates[r]:null,a=this.textStates[e],l=this.pixelRatio,u=[a.scale[0]*l,a.scale[1]*l],c=TS(t,a.textAlign||ml),h=n&&o.lineWidth?o.lineWidth:0,f=t.split("\n"),p=f.length,d=[],g=function(t,e,r){for(var n=e.length,i=0,o=0;o<n;++o){var s=Pl(t,e[o]);i=Math.max(i,s),r.push(s)}return i}(a.font,f,d),y=Cl(a.font),m=g+h,_=[],v=(m+2)*u[0],b=(y*p+h)*u[1],w={width:v<0?Math.floor(v):Math.ceil(v),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:_};(1==u[0]&&1==u[1]||_.push("scale",u),_.push("font",a.font),n)&&(_.push("strokeStyle",o.strokeStyle),_.push("lineWidth",h),_.push("lineCap",o.lineCap),_.push("lineJoin",o.lineJoin),_.push("miterLimit",o.miterLimit),(ws?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(_.push("setLineDash",[o.lineDash]),_.push("lineDashOffset",o.lineDashOffset)));r&&_.push("fillStyle",s.fillStyle),_.push("textBaseline","middle"),_.push("textAlign","center");var x,E=.5-c,S=c*m+E*h;if(n)for(x=0;x<p;++x)_.push("strokeText",[f[x],S+E*d[x],.5*(h+y)+x*y]);if(r)for(x=0;x<p;++x)_.push("fillText",[f[x],S+E*d[x],.5*(h+y)+x*y]);return this.labels_[i]=w,w},t.prototype.replayTextBackground_=function(t,e,r,n,i,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,r),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},t.prototype.calculateImageOrLabelDimensions_=function(t,e,r,n,i,o,s,a,l,u,c,h,f,p,d,g){var y,m=r-(s*=h[0]),_=n-(a*=h[1]),v=i+l>t?t-l:i,b=o+u>e?e-u:o,w=p[3]+v*h[0]+p[1],x=p[0]+b*h[1]+p[2],E=m-p[3],S=_-p[0];return(d||0!==c)&&(xS[0]=E,IS[0]=E,xS[1]=S,ES[1]=S,ES[0]=E+w,SS[0]=ES[0],SS[1]=S+x,IS[1]=SS[1]),0!==c?(Ts(y=Rs([1,0,0,1,0,0],r,n,1,1,c,-r,-n),xS),Ts(y,ES),Ts(y,SS),Ts(y,IS),vt(Math.min(xS[0],ES[0],SS[0],IS[0]),Math.min(xS[1],ES[1],SS[1],IS[1]),Math.max(xS[0],ES[0],SS[0],IS[0]),Math.max(xS[1],ES[1],SS[1],IS[1]),wS)):vt(Math.min(E,E+w),Math.min(S,S+x),Math.max(E,E+w),Math.max(S,S+x),wS),f&&(m=Math.round(m),_=Math.round(_)),{drawImageX:m,drawImageY:_,drawImageW:v,drawImageH:b,originX:l,originY:u,declutterBox:{minX:wS[0],minY:wS[1],maxX:wS[2],maxY:wS[3],value:g},canvasTransform:y,scale:h}},t.prototype.replayImageOrLabel_=function(t,e,r,n,i,o,s){var a=!(!o&&!s),l=n.declutterBox,u=t.canvas,c=s?s[2]*n.scale[0]/2:0;return l.minX-c<=u.width/e&&l.maxX+c>=0&&l.minY-c<=u.height/e&&l.maxY+c>=0&&(a&&this.replayTextBackground_(t,xS,ES,SS,IS,o,s),Ll(t,n.canvasTransform,i,r,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0},t.prototype.fill_=function(t){if(this.alignFill_){var e=Ts(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(e[0]%r,e[1]%r),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.drawLabelWithPointPlacement_=function(t,e,r,n){var i=this.textStates[e],o=this.createLabel(t,e,n,r),s=this.strokeStates[r],a=this.pixelRatio,l=TS(t,i.textAlign||ml),u=mS[i.textBaseline||_l],c=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:l*(o.width/a-2*i.scale[0])+2*(.5-l)*c,anchorY:u*o.height/a+2*(.5-u)*c}},t.prototype.execute_=function(t,e,r,n,i,o,s,a){var l,u,c;this.pixelCoordinates_&&We(r,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=ju(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),u=this.renderedTransform_,c=r,u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5]);for(var h,f,p,d,g,y,m,_,v,b,w,x,E,S,I,O,C=0,T=n.length,P=0,R=0,L=0,M=null,k=null,N=this.coordinateCache_,A=this.viewRotation_,F=Math.round(1e12*Math.atan2(-r[1],r[0]))/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},j=this.instructions!=n||this.overlaps?0:200;C<T;){var G=n[C];switch(G[0]){case sS.BEGIN_GEOMETRY:E=G[1],O=G[3],E.getGeometry()?void 0===s||zt(s,O.getExtent())?++C:C=G[2]+1:C=G[2];break;case sS.BEGIN_PATH:R>j&&(this.fill_(t),R=0),L>j&&(t.stroke(),L=0),R||L||(t.beginPath(),d=NaN,g=NaN),++C;break;case sS.CIRCLE:var z=l[P=G[1]],U=l[P+1],B=l[P+2]-z,V=l[P+3]-U,q=Math.sqrt(B*B+V*V);t.moveTo(z+q,U),t.arc(z,U,q,0,2*Math.PI,!0),++C;break;case sS.CLOSE_PATH:t.closePath(),++C;break;case sS.CUSTOM:P=G[1],h=G[2];var Y=G[3],W=G[4],X=6==G.length?G[5]:void 0;D.geometry=Y,D.feature=E,C in N||(N[C]=[]);var H=N[C];X?X(l,P,h,2,H):(H[0]=l[P],H[1]=l[P+1],H.length=2),W(H,D),++C;break;case sS.DRAW_IMAGE:P=G[1],h=G[2],_=G[3],f=G[4],p=G[5];var Z=G[6],K=G[7],$=G[8],J=G[9],Q=G[10],tt=G[11],et=G[12],rt=G[13],nt=G[14];if(!_&&G.length>=19){v=G[18],b=G[19],w=G[20],x=G[21];var it=this.drawLabelWithPointPlacement_(v,b,w,x);_=it.label,G[3]=_;var ot=G[22];f=(it.anchorX-ot)*this.pixelRatio,G[4]=f;var st=G[23];p=(it.anchorY-st)*this.pixelRatio,G[5]=p,Z=_.height,G[6]=Z,rt=_.width,G[13]=rt}var at=void 0;G.length>24&&(at=G[24]);var lt=void 0,ut=void 0,ct=void 0;G.length>16?(lt=G[15],ut=G[16],ct=G[17]):(lt=vl,ut=!1,ct=!1),Q&&F?tt+=A:Q||F||(tt-=A);for(var ht=0;P<h;P+=2)if(!(at&&at[ht++]<rt/this.pixelRatio)){var ft=[t,e,_,Gt=this.calculateImageOrLabelDimensions_(_.width,_.height,l[P],l[P+1],rt,Z,f,p,$,J,tt,et,i,lt,ut||ct,E),K,ut?M:null,ct?k:null],pt=void 0,dt=void 0;if(a&&nt){var gt=h-P;if(!nt[gt]){nt[gt]=ft;continue}if(pt=nt[gt],delete nt[gt],dt=OS(pt),a.collides(dt))continue}a&&a.collides(Gt.declutterBox)||(pt&&(a&&a.insert(dt),this.replayImageOrLabel_.apply(this,pt)),a&&a.insert(Gt.declutterBox),this.replayImageOrLabel_.apply(this,ft))}++C;break;case sS.DRAW_CHARS:var yt=G[1],mt=G[2],_t=G[3],vt=G[4];x=G[5];var bt=G[6],wt=G[7],xt=G[8];w=G[9];var Et=G[10];v=G[11],b=G[12];var St=[G[13],G[13]],It=this.textStates[b],Ot=It.font,Ct=[It.scale[0]*wt,It.scale[1]*wt],Tt=void 0;Ot in this.widths_?Tt=this.widths_[Ot]:(Tt={},this.widths_[Ot]=Tt);var Pt=Ng(l,yt,mt,2),Rt=Math.abs(Ct[0])*Rl(Ot,v,Tt);if(vt||Rt<=Pt){var Lt=this.textStates[b].textAlign,Mt=bS(l,yt,mt,2,v,(Pt-Rt)*mS[Lt],bt,Math.abs(Ct[0]),Rl,Ot,Tt,F?0:this.viewRotation_);t:if(Mt){var kt=[],Nt=void 0,At=void 0,Ft=void 0,Dt=void 0,jt=void 0;if(w)for(Nt=0,At=Mt.length;Nt<At;++Nt){Ft=(jt=Mt[Nt])[4],Dt=this.createLabel(Ft,b,"",w),f=jt[2]+(Ct[0]<0?-Et:Et),p=_t*Dt.height+2*(.5-_t)*Et*Ct[1]/Ct[0]-xt;var Gt=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,jt[0],jt[1],Dt.width,Dt.height,f,p,0,0,jt[3],St,!1,vl,!1,E);if(a&&a.collides(Gt.declutterBox))break t;kt.push([t,e,Dt,Gt,1,null,null])}if(x)for(Nt=0,At=Mt.length;Nt<At;++Nt){Ft=(jt=Mt[Nt])[4],Dt=this.createLabel(Ft,b,x,""),f=jt[2],p=_t*Dt.height-xt;Gt=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,jt[0],jt[1],Dt.width,Dt.height,f,p,0,0,jt[3],St,!1,vl,!1,E);if(a&&a.collides(Gt.declutterBox))break t;kt.push([t,e,Dt,Gt,1,null,null])}a&&a.load(kt.map(OS));for(var Ut=0,Bt=kt.length;Ut<Bt;++Ut)this.replayImageOrLabel_.apply(this,kt[Ut])}}++C;break;case sS.END_GEOMETRY:if(void 0!==o){var Vt=o(E=G[1],O);if(Vt)return Vt}++C;break;case sS.FILL:j?R++:this.fill_(t),++C;break;case sS.MOVE_TO_LINE_TO:for(P=G[1],h=G[2],S=l[P],m=(I=l[P+1])+.5|0,(y=S+.5|0)===d&&m===g||(t.moveTo(S,I),d=y,g=m),P+=2;P<h;P+=2)y=(S=l[P])+.5|0,m=(I=l[P+1])+.5|0,P!=h-2&&y===d&&m===g||(t.lineTo(S,I),d=y,g=m);++C;break;case sS.SET_FILL_STYLE:M=G,this.alignFill_=G[2],R&&(this.fill_(t),R=0,L&&(t.stroke(),L=0)),t.fillStyle=G[1],++C;break;case sS.SET_STROKE_STYLE:k=G,L&&(t.stroke(),L=0),this.setStrokeStyle_(t,G),++C;break;case sS.STROKE:j?L++:t.stroke(),++C;break;default:++C}}R&&this.fill_(t),L&&t.stroke()},t.prototype.execute=function(t,e,r,n,i,o){this.viewRotation_=n,this.execute_(t,e,r,this.instructions,i,void 0,void 0,o)},t.prototype.executeHitDetection=function(t,e,r,n,i){return this.viewRotation_=r,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,i)},t}(),RS=[bw,yw,vw,_w,ww,mw],LS=function(){function t(t,e,r,n,i,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=r,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(i)}return t.prototype.clip=function(t,e){var r=this.getClipCoords(e);t.beginPath(),t.moveTo(r[0],r[1]),t.lineTo(r[2],r[3]),t.lineTo(r[4],r[5]),t.lineTo(r[6],r[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var r=this.executorsByZIndex_[e];void 0===r&&(r={},this.executorsByZIndex_[e]=r);var n=t[e];for(var i in n){var o=n[i];r[i]=new PS(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var r=this.executorsByZIndex_[e],n=0,i=t.length;n<i;++n)if(t[n]in r)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i,o){var s=2*(n=Math.round(n))+1,a=Rs(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-r,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=ol(s,s));var u,c=this.hitDetectionContext_;c.canvas.width!==s||c.canvas.height!==s?(c.canvas.width=s,c.canvas.height=s):l||c.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(It(u=[1/0,1/0,-1/0,-1/0],t),ht(u,e*(this.renderBuffer_+n),u));var h,f=function(t){if(void 0!==MS[t])return MS[t];for(var e=2*t+1,r=t*t,n=new Array(r+1),i=0;i<=t;++i)for(var o=0;o<=t;++o){var s=i*i+o*o;if(s>r)break;var a=n[s];a||(a=[],n[s]=a),a.push(4*((t+i)*e+(t+o))+3),i>0&&a.push(4*((t-i)*e+(t+o))+3),o>0&&(a.push(4*((t+i)*e+(t-o))+3),i>0&&a.push(4*((t-i)*e+(t-o))+3))}for(var l=[],u=(i=0,n.length);i<u;++i)n[i]&&l.push.apply(l,n[i]);return MS[t]=l,l}(n);function p(t,e){for(var r=c.getImageData(0,0,s,s).data,a=0,l=f.length;a<l;a++)if(r[f[a]]>0){if(!o||h!==_w&&h!==ww||-1!==o.indexOf(t)){var u=(f[a]-3)/4,p=n-u%s,d=n-(u/s|0),g=i(t,e,p*p+d*d);if(g)return g}c.clearRect(0,0,s,s);break}}var d,g,y,m,_,v=Object.keys(this.executorsByZIndex_).map(Number);for(v.sort(ze),d=v.length-1;d>=0;--d){var b=v[d].toString();for(y=this.executorsByZIndex_[b],g=RS.length-1;g>=0;--g)if(void 0!==(m=y[h=RS[g]])&&(_=m.executeHitDetection(c,a,r,p,u)))return _}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var r=e[0],n=e[1],i=e[2],o=e[3],s=[r,n,r,o,i,o,i,n];return ju(s,0,8,2,t,s),s},t.prototype.isEmpty=function(){return W(this.executorsByZIndex_)},t.prototype.execute=function(t,e,r,n,i,o,s){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(ze),this.maxExtent_&&(t.save(),this.clip(t,r));var l,u,c,h,f,p,d=o||RS;for(s&&a.reverse(),l=0,u=a.length;l<u;++l){var g=a[l].toString();for(f=this.executorsByZIndex_[g],c=0,h=d.length;c<h;++c){void 0!==(p=f[d[c]])&&p.execute(t,e,r,n,i,s)}}this.maxExtent_&&t.restore()},t}(),MS={};var kS=LS,NS=.5;function AS(t,e,r,n,i,o,s){var a=ol(t[0]*NS,t[1]*NS);a.imageSmoothingEnabled=!1;for(var l=a.canvas,u=new gw(a,NS,i,null,s),c=r.length,h=Math.floor(16777215/c),f={},p=1;p<=c;++p){var d=r[p-1],g=d.getStyleFunction()||n;if(n){var y=g(d,o);if(y){Array.isArray(y)||(y=[y]);for(var m="#"+("000000"+(p*h).toString(16)).slice(-6),_=0,v=y.length;_<v;++_){var b=y[_],w=b.getGeometryFunction()(d);if(w&&zt(i,w.getExtent())){var x=b.clone(),E=x.getFill();E&&E.setColor(m);var S=x.getStroke();S&&(S.setColor(m),S.setLineDash(null)),x.setText(void 0);var I=b.getImage();if(I&&0!==I.getOpacity()){var O=I.getImageSize();if(!O)continue;var C=ol(O[0],O[1],void 0,{alpha:!1}),T=C.canvas;C.fillStyle=m,C.fillRect(0,0,T.width,T.height),x.setImage(new hw({img:T,imgSize:O,anchor:I.getAnchor(),anchorXUnits:ew,anchorYUnits:ew,offset:I.getOrigin(),opacity:1,size:I.getSize(),scale:I.getScale(),rotation:I.getRotation(),rotateWithView:I.getRotateWithView()}))}var P=x.getZIndex()||0;(M=f[P])||(M={},f[P]=M,M[Yt.POLYGON]=[],M[Yt.CIRCLE]=[],M[Yt.LINE_STRING]=[],M[Yt.POINT]=[]),M[w.getType().replace("Multi","")].push(w,x)}}}}}for(var R=Object.keys(f).map(Number).sort(ze),L=(p=0,R.length);p<L;++p){var M=f[R[p]];for(var k in M){var N=M[k];for(_=0,v=N.length;_<v;_+=2){u.setStyle(N[_+1]);for(var A=0,F=e.length;A<F;++A)u.setTransform(e[A]),u.drawGeometry(N[_])}}}return a.getImageData(0,0,l.width,l.height)}function FS(t,e,r){var n=[];if(r){var i=Math.floor(Math.round(t[0])*NS),o=Math.floor(Math.round(t[1])*NS),s=4*(y(i,0,r.width-1)+y(o,0,r.height-1)*r.width),a=r.data[s],l=r.data[s+1],u=r.data[s+2]+256*(l+256*a),c=Math.floor(16777215/e.length);u&&u%c==0&&n.push(e[u/c-1])}return n}var DS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jS=function(t){function e(e){var r=t.call(this,e)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.dirty_=!1,r.hitDetectionImageData_=null,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=[1/0,1/0,-1/0,-1/0],r.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r.declutterExecutorGroup=null,r.clipping=!0,r}return DS(e,t),e.prototype.useContainer=function(e,r,n){n<1&&(e=null),t.prototype.useContainer.call(this,e,r,n)},e.prototype.renderWorlds=function(t,e,r){var n=e.extent,i=e.viewState,o=i.center,s=i.resolution,a=i.projection,l=i.rotation,u=a.getExtent(),c=this.getLayer().getSource(),h=e.pixelRatio,f=e.viewHints,p=!(f[yu]||f[mu]),d=this.context,g=Math.round(e.size[0]*h),y=Math.round(e.size[1]*h),m=c.getWrapX()&&a.canWrapX(),_=m?Gt(u):null,v=m?Math.ceil((n[2]-u[2])/_)+1:1,b=m?Math.floor((n[0]-u[0])/_):0;do{var w=this.getRenderTransform(o,s,l,h,g,y,b*_);t.execute(d,1,w,l,p,void 0,r)}while(++b<v)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,e){var r=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,r){Cs(t,e,0,0,r,0,0)}(this.pixelTransform,1/r,1/r),Ls(this.inversePixelTransform,this.pixelTransform);var i=Ms(this.pixelTransform);this.useContainer(e,i,n.opacity);var o=this.context,s=o.canvas,a=this.replayGroup_,l=this.declutterExecutorGroup;if((!a||a.isEmpty())&&(!l||l.isEmpty()))return null;var u=Math.round(t.size[0]*r),c=Math.round(t.size[1]*r);s.width!=u||s.height!=c?(s.width=u,s.height=c,s.style.transform!==i&&(s.style.transform=i)):this.containerReused||o.clearRect(0,0,u,c),this.preRender(o,t);var h=t.viewState,f=h.projection,p=!1,d=!0;if(n.extent&&this.clipping){var g=Fe(n.extent,f);(p=(d=zt(g,t.extent))&&!gt(g,t.extent))&&this.clipUnrotated(o,t,g)}d&&this.renderWorlds(a,t),p&&o.restore(),this.postRender(o,t);var y=il(n.opacity),m=this.container;return y!==m.style.opacity&&(m.style.opacity=y),this.renderedRotation_!==h.rotation&&(this.renderedRotation_=h.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];Ts(this.pixelTransform,r);var n=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,a=this.wrappedRenderedExtent_,l=this.getLayer(),u=[],c=r[0]*NS,h=r[1]*NS;u.push(this.getRenderTransform(n,i,o,NS,c,h,0).slice());var f=l.getSource(),p=s.getExtent();if(f.getWrapX()&&s.canWrapX()&&!gt(p,a)){for(var d=a[0],g=Gt(p),y=0,m=void 0;d<p[0];)m=g*--y,u.push(this.getRenderTransform(n,i,o,NS,c,h,m).slice()),d+=g;for(y=0,d=a[2];d>p[2];)m=g*++y,u.push(this.getRenderTransform(n,i,o,NS,c,h,m).slice()),d-=g}this.hitDetectionImageData_=AS(r,u,this.renderedFeatures_,l.getStyleFunction(),a,i,o)}e(FS(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){var o=this;if(this.replayGroup_){var s,a=e.viewState.resolution,l=e.viewState.rotation,u=this.getLayer(),c={},h=function(t,e,r){var o=Object(st.c)(t),s=c[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return c[o]=!0,i.splice(i.lastIndexOf(s),1),n(t,u,e);s.geometry=e,s.distanceSq=r}}else{if(0===r)return c[o]=!0,n(t,u,e);i.push(c[o]={feature:t,layer:u,geometry:e,distanceSq:r,callback:n})}},f=[this.replayGroup_];return this.declutterExecutorGroup&&f.push(this.declutterExecutorGroup),f.some((function(n){return s=n.forEachFeatureAtCoordinate(t,a,l,r,h,n===o.declutterExecutorGroup?e.declutterTree.all().map((function(t){return t.value})):null)})),s}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),r=e.getSource();if(!r)return!1;var n=t.viewHints[yu],i=t.viewHints[mu],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&n||!s&&i)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,l=t.viewState,u=l.projection,c=l.resolution,h=t.pixelRatio,f=e.getRevision(),p=e.getRenderBuffer(),d=e.getRenderOrder();void 0===d&&(d=Ew);var g=l.center.slice(),y=ht(a,p*c),m=y.slice(),_=[y.slice()],v=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!gt(v,t.extent)){var b=Gt(v),w=Math.max(Gt(y)/2,b);y[0]=v[0]-w,y[2]=v[2]+w,he(g,u);var x=qt(_[0],u);x[0]<v[0]&&x[2]<v[2]?_.push([x[0]+b,x[1],x[2]+b,x[3]]):x[0]>v[0]&&x[2]>v[2]&&_.push([x[0]-b,x[1],x[2]-b,x[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==d&&gt(this.wrappedRenderedExtent_,y))return We(this.renderedExtent_,m)||(this.hitDetectionImageData_=null,this.renderedExtent_=m),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var E,S=new vS(Iw(c,h),y,c,h);this.getLayer().getDeclutter()&&(E=new vS(Iw(c,h),y,c,h));var I,O=Me();if(O){for(var C=0,T=_.length;C<T;++C){var P=Ae(_[C],u);r.loadFeatures(P,De(c,u),O)}I=Se(O,u)}else for(C=0,T=_.length;C<T;++C)r.loadFeatures(_[C],c,u);var R=Sw(c,h),L=function(t){var r,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(r=n(t,c)),r){var i=this.renderFeature(t,R,r,S,I,E);this.dirty_=this.dirty_||i}}.bind(this),M=Ae(y,u),k=r.getFeaturesInExtent(M);d&&k.sort(d);for(C=0,T=k.length;C<T;++C)L(k[C]);this.renderedFeatures_=k;var N=S.finish(),A=new kS(y,c,h,r.getOverlaps(),N,e.getRenderBuffer());return E&&(this.declutterExecutorGroup=new kS(y,c,h,r.getOverlaps(),E.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=d,this.renderedExtent_=m,this.wrappedRenderedExtent_=y,this.renderedCenter_=g,this.renderedProjection_=u,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,r,n,i,o){if(!r)return!1;var s=!1;if(Array.isArray(r))for(var a=0,l=r.length;a<l;++a)s=Ow(n,t,r[a],e,this.boundHandleStyleImageChange_,i,o)||s;else s=Ow(n,t,r,e,this.boundHandleStyleImageChange_,i,o);return s},e}(Hd),GS=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zS=function(t){function e(e){return t.call(this,e)||this}return GS(e,t),e.prototype.createRenderer=function(){return new jS(this)},e}(tS);function US(t){return(US="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VS(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qS(t,e,r){return(qS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ZS(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function YS(t,e){return(YS=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function WS(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ZS(t);if(e){var i=ZS(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return XS(this,r)}}function XS(t,e){return!e||"object"!==US(e)&&"function"!=typeof e?HS(t):e}function HS(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZS(t){return(ZS=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var KS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YS(t,e)}(o,t);var e,r,n,i=WS(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return BS(this,o),(t=i.call(this,e)).styleCluster_=e.style,t.oldCluster_=new Fb,t.clusters_=[],t.animation_={start:!1},t.set("animationDuration","number"==typeof e.animationDuration?e.animationDuration:700),t.set("animationMethod",e.animationMethod||Ru),t.getSource().on("change",t.saveCluster_.bind(HS(t))),t.on("prerender",t.animate.bind(HS(t))),t.on("postrender",t.postanimate.bind(HS(t))),t.setStyle(e.style),t}return e=o,n=[{key:"getClusterForFeature",value:function(t,e){return e.find((function(e){var r,n=e.get("features");return _V(n)||(r=n.find((function(e){return e===t}))),r}))}}],(r=[{key:"saveCluster_",value:function(){if(this.oldCluster_.clear(),this.get("animationDuration")){var t=this.getSource().getFeatures();t.length&&t[0].get("features")&&(this.oldCluster_.addFeatures(this.clusters_),this.clusters_=t.slice(0),this.sourceChanged=!0)}}},{key:"animate",value:function(t){var e=this,r=t,n=this.get("animationDuration");if(n){if(this.animation_.resolution!==r.frameState.viewState.resolution&&this.sourceChanged){var i=r.frameState.viewState.resolution,o=r.frameState.extent;this.animation_.reverse=this.animation_.resolution>=i,this.prepareAnimation_(o,r.frameState.viewState.resolution),r.frameState.time=this.animation_.start}var s=this.animation_.clustersFrom.length;if(s>0&&s<=1e3&&this.animation_.start){var a=Pw(r),l=(r.frameState.time-this.animation_.start)/n;l>1&&(this.animation_.start=!1,l=1),l=this.get("animationMethod")(l),r.context.save(),r.context.globalAlpha=this.getOpacity(),this.animation_.clustersFrom.forEach((function(t,n){var i=t.getGeometry().getCoordinates(),o=e.animation_.clustersTo[n].getGeometry().getCoordinates();e.animation_.reverse?(i[0]=o[0]+l*(i[0]-o[0]),i[1]=o[1]+l*(i[1]-o[1])):(i[0]+=l*(o[0]-i[0]),i[1]+=l*(o[1]-i[1]));var s=e.getStyle()(t,r.frameState.viewState.resolution),u=new dc(i);_V(s)||s.forEach((function(t){var e=t.getImage();_V(e)||(null==e.getOrigin()&&(e.origin_=[]),null==e.getAnchor()&&(e.normalizedAnchor_=[]),null==e.getSize()&&(e.size_=[])),a.setStyle(t),a.drawGeometry(u)}))})),r.context.restore(),r.frameState.animate=!0,r.context.save(),r.context.beginPath(),r.context.rect(0,0,0,0),r.context.clip(),this.clip_=!0}else this.animation_.clustersFrom.length=0,this.animation_.clustersTo.length=0,this.animation_.start=!1}}},{key:"prepareAnimation_",value:function(t,e){var r=this;this.animation_.clustersFrom=[],this.animation_.clustersTo=[];var n=ht(t,100*e),i=this.oldCluster_.getFeaturesInExtent(n),s=this.getSource().getFeaturesInExtent(n),a=this.animation_.reverse?s:i,l=this.animation_.reverse?i:s;a.forEach((function(t){var e=t.get("features");if(!_V(e)){var n=o.getClusterForFeature(e[0],l);_V(n)||!1===n||(r.animation_.clustersFrom.push(t),r.animation_.clustersTo.push(n))}})),this.animation_.resolution=e,this.sourceChanged=!1,this.animation_.start=(new Date).getTime()}},{key:"postanimate",value:function(t){this.clip_&&(t.context.restore(),this.clip_=!1)}},{key:"setStyle",value:function(t){qS(ZS(o.prototype),"setStyle",this).call(this,this.styleCluster_)}}])&&VS(e.prototype,r),n&&VS(e,n),o}(zS),$S=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),JS="select",QS=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.selected=r,o.deselected=n,o.mapBrowserEvent=i,o}return $S(e,t),e}(Xs),tI={};var eI=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n,i,o=e||{};if(r.boundAddFeature_=r.addFeature_.bind(r),r.boundRemoveFeature_=r.removeFeature_.bind(r),r.condition_=o.condition?o.condition:_h,r.addCondition_=o.addCondition?o.addCondition:mh,r.removeCondition_=o.removeCondition?o.removeCondition:mh,r.toggleCondition_=o.toggleCondition?o.toggleCondition:bh,r.multi_=!!o.multi&&o.multi,r.filter_=o.filter?o.filter:fs,r.hitTolerance_=o.hitTolerance?o.hitTolerance:0,r.style_=void 0!==o.style?o.style:(qe((n=nx())[Yt.POLYGON],n[Yt.LINE_STRING]),qe(n[Yt.GEOMETRY_COLLECTION],n[Yt.LINE_STRING]),function(t){return t.getGeometry()?n[t.getGeometry().getType()]:null}),r.features_=o.features||new Gl,o.layers)if("function"==typeof o.layers)i=o.layers;else{var s=o.layers;i=function(t){return Ue(s,t)}}else i=fs;return r.layerFilter_=i,r.featureLayerAssociation_={},r}return $S(e,t),e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[Object(st.c)(t)]=e},e.prototype.getFeatures=function(){return this.features_},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[Object(st.c)(t)]},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),t.prototype.setMap.call(this,e),e?(this.features_.addEventListener(Nl,this.boundAddFeature_),this.features_.addEventListener(Al,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Nl,this.boundAddFeature_),this.features_.removeEventListener(Al,this.boundRemoveFeature_))},e.prototype.addFeature_=function(t){var e=t.element;this.style_&&this.applySelectedStyle_(e)},e.prototype.removeFeature_=function(t){var e=t.element;this.style_&&this.restorePreviousStyle_(e)},e.prototype.getStyle=function(){return this.style_},e.prototype.applySelectedStyle_=function(t){var e=Object(st.c)(t);e in tI||(tI[e]=t.getStyle()),t.setStyle(this.style_)},e.prototype.restorePreviousStyle_=function(t){for(var r=this.getMap().getInteractions().getArray(),n=r.length-1;n>=0;--n){var i=r[n];if(i!==this&&i instanceof e&&i.getStyle()&&-1!==i.getFeatures().getArray().lastIndexOf(t))return void t.setStyle(i.getStyle())}var o=Object(st.c)(t);t.setStyle(tI[o]),delete tI[o]},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[Object(st.c)(t)]},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),r=this.removeCondition_(t),n=this.toggleCondition_(t),i=!e&&!r&&!n,o=t.map,s=this.getFeatures(),a=[],l=[];if(i){q(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return l.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;u>=0;--u){var c=s.item(u),h=l.indexOf(c);h>-1?l.splice(h,1):(s.remove(c),a.push(c))}0!==l.length&&s.extend(l)}else{o.forEachFeatureAtPixel(t.pixel,function(t,i){if(this.filter_(t,i))return!e&&!n||Ue(s.getArray(),t)?(r||n)&&Ue(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(l.push(t),this.addFeatureLayerAssociation_(t,i)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var f=a.length-1;f>=0;--f)s.remove(a[f]);s.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new QS(JS,l,a,t)),!0},e}(ih);function rI(t){return(rI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function oI(t,e){return(oI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=uI(t);if(e){var i=uI(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return aI(this,r)}}function aI(t,e){return!e||"object"!==rI(e)&&"function"!=typeof e?lI(t):e}function lI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uI(t){return(uI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oI(t,e)}(o,t);var e,r,n,i=sI(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};nI(this,o);var r=e,n=new zS({source:new Fb({features:new Gl,useSpatialIndex:!0}),name:"Cluster overlay",updateWhileAnimating:!0,updateWhileInteracting:!0,displayInLayerSwitcher:!1,style:r.featureStyle});return e.layers.push(n),r.filter=function(t,e){return!(!e&&t.get("selectclusterlink"))},(t=i.call(this,r)).map=r.map,t.pointRadius=r.pointRadius||12,t.circleMaxObjects=r.circleMaxObjects||10,t.maxObjects=r.maxObjects||60,t.spiral=!1!==r.spiral,t.animate=r.animate,t.animationDuration=r.animationDuration||500,t.selectCluster_=!1!==r.selectCluster,t.maxFeaturesToSelect=r.maxFeaturesToSelect,t.facadeLayer_=r.fLayer,t.style_=r.style,t.filter_=r.filter,t.overlayLayer_=n,t.originalHandleEvent=t.handleEvent,t.on("select",t.selectCluster.bind(lI(t)),lI(t)),t}return e=o,(r=[{key:"setMap",value:function(t){var e=this;this.getMap()&&(this.getMap().getView()&&this.getMap().getView().un("change:resolution",this.clear.bind(this)),this.getMap().removeLayer(this.overlayLayer_)),eI.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t),t&&t.getView()&&t.getView().on("change:resolution",this.clear.bind(this)),this.handleEvent=function(t){return e.originalHandleEvent.apply(e,[t]),!0}}},{key:"clear",value:function(){this.getFeatures().clear(),this.overlayLayer_.getSource().clear()}},{key:"getLayer",value:function(){return this.overlayLayer_}},{key:"refreshViewEvents",value:function(){this.getMap()&&this.getMap().getView()&&this.getMap().getView().on("change:resolution",this.clear.bind(this))}},{key:"selectCluster",value:function(t){if(t.selected.length){var e=t.selected[0];if(!e.get("selectclusterfeature")){var r=e.get("features");if(r&&1!==r.length)if(r&&!(r.length>this.maxFeaturesToSelect)||this.facadeLayer_.getImpl().getNumZoomLevels()-this.map.getZoom()==1){this.selectCluster_||this.getFeatures().clear();var n=e.getGeometry().getCoordinates(),i=this.getMap().getView().getResolution(),o=i*this.pointRadius*(.5+r.length/4);!this.spiral||r.length<=this.circleMaxObjects?(this.overlayLayer_.getSource().refresh(),this.drawFeaturesAndLinsInCircle_(r,i,o,n)):(this.overlayLayer_.getSource().refresh(),this.drawFeaturesAndLinsInSpiral_(r,i,n)),this.animate&&this.animateCluster_(n)}else{var s=ry.getFeaturesExtent(r,this.map.getProjection().code);this.map.setBbox(s)}}}else this.clear()}},{key:"drawFeaturesAndLinsInCircle_",value:function(t,e,r,n){for(var i=Math.min(t.length,this.circleMaxObjects),o=0;o<i;o+=1){var s=2*Math.PI*(o/i);2!==i&&4!==i||(s+=Math.PI/4);var a=[n[0]+r*Math.sin(s),n[1]+r*Math.cos(s)];this.drawAnimatedFeatureAndLink_(t[o],e,n,a)}}},{key:"drawFeaturesAndLinsInSpiral_",value:function(t,e,r){for(var n,i=0,o=2*this.pointRadius,s=Math.min(this.maxObjects,t.length),a=0;a<s;a+=1){i+=(o+.1)/(n=o/2+o*i/(2*Math.PI));var l=e*n*Math.sin(i),u=e*n*Math.cos(i),c=[r[0]+l,r[1]+u];this.drawAnimatedFeatureAndLink_(t[a],e,r,c)}}},{key:"drawAnimatedFeatureAndLink_",value:function(t,e,r,n){var i=new Cg;t.getKeys().forEach((function(e){i.set(e,t.get(e))}));var o=t.getStyle();o||(o=this.facadeLayer_.getStyle().getImpl().oldOLLayer.getStyle());var s=o(t,e),a=s.map?s.map((function(t){return t.clone()})):[s.clone()];i.setId(t.getId()),i.setStyle(a),i.set("features",[t]);var l=!0===["Point","MultiPoint"].includes(t.getGeometry().getType())?new dc(n):t.getGeometry(),u=!0===["Point","MultiPoint"].includes(t.getGeometry().getType())?new Fg([r,n]):new Fg([r,ry.getCentroid(t.getGeometry())]);i.set("geometry",l),this.overlayLayer_.getSource().addFeature(i);var c=new Cg({selectclusterlink:!0,geometry:u});this.overlayLayer_.getSource().addFeature(c)}},{key:"animateCluster_",value:function(t,e){var r=this;this.listenerKey_&&(this.overlayLayer_.setVisible(!0),ma(this.listenerKey_));var n=this.overlayLayer_.getSource().getFeatures();if(n.length){this.overlayLayer_.setVisible(!1);var i=this.animationDuration||500,o=(new Date).getTime();this.listenerKey_=this.facadeLayer_.getImpl().getOLLayer().on(["postrender","postcompose"],(function(e){for(var s=Pw(e),a=r.getMap().getView().getResolution(),l=Ru((e.frameState.time-o)/i),u=0;u<n.length;u+=1){if(n[u].get("features")){var c=n[u],h=c.get("features")[0],f=c.getGeometry().getCoordinates();f[0]=t[0]+l*(f[0]-t[0]),f[1]=t[1]+l*(f[1]-t[1]);for(var p=new dc(f),d=r.overlayLayer_.getStyle()(h,a).map((function(t){return t.clone()})),g=0;g<d.length;g+=1){var y=d[g];y.getImage().size||(y.getImage().size=[42,42]),s.setStyle(y),s.drawLineString(new Fg([t,f]))}var m=h.getStyle();m||(m=r.facadeLayer_.getStyle().getImpl().oldOLLayer.getStyle());for(var _=m(h,a),v=_.map?_.map((function(t){return t.clone()})):[_.clone()],b=0;b<v.length;b+=1){var w=v[b],x=w.getImage();if(x instanceof OE){var E=null==x.getOrigin()?[0,0]:x.getOrigin(),S=null==x.getAnchor()?[0,0]:x.getAnchor(),I=null==x.getSize()?[42,42]:x.getSize();x.size=I,x.anchor=S,x.origin=E,w.setImage(x)}s.setStyle(w),s.drawGeometry(p)}}if(l>1)return ma(r.listenerKey_),r.overlayLayer_.setVisible(!0),void r.overlayLayer_.changed();e.frameState.animate=!0}}),this)}}}])&&iI(e.prototype,r),n&&iI(e,n),o}(eI),hI=function(t,e,r){return(t[0]-r[0])*(e[1]-r[1])-(t[1]-r[1])*(e[0]-r[0])<=0},fI=function(t){t.sort((function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}));for(var e=[],r=0;r<t.length;r+=1){for(;e.length>=2&&hI(e[e.length-2],e[e.length-1],t[r]);)e.pop();e.push(t[r])}for(var n=[],i=t.length-1;i>=0;i-=1){for(;n.length>=2&&hI(n[n.length-2],n[n.length-1],t[i]);)n.pop();n.push(t[i])}return n.pop(),e.pop(),e.concat(n)};function pI(t){return(pI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dI(t){return function(t){if(Array.isArray(t))return gI(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return gI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gI(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gI(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mI(t,e){return(mI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bI(t);if(e){var i=bI(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vI(this,r)}}function vI(t,e){return!e||"object"!==pI(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bI(t){return(bI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mI(t,e)}(s,t);var e,r,i,o=_I(s);function s(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=o.call(this,{})).convexHullLayer_=null,r.oldOLLayer_=null,r.optionsVendor_=e,r.options_=t,r.clusterLayer_=null,r.selectClusterInteraction_=null,r.hoverInteraction_=null,r}return e=s,i=[{key:"updateRangeImpl",value:function(t,e,r,n,i){var o=i.getOptions().ranges.find((function(r){return r.min===t&&r.max===e}))||!1;return o&&(o.style=r),o}}],(r=[{key:"applyToLayer",value:function(t,e){this.layer_=t,this.options_=this.updateLastRange_(),_V(this.selectClusterInteraction_)||this.selectClusterInteraction_.clear(),this.updateCanvas();var r=t.getFeatures();r.length>0?this.clusterize_(r):this.layer_.on(ep,this.clusterize_.bind(this),this)}},{key:"clusterize_",value:function(t){var e=t.map((function(t){return t.getImpl().getOLFeature()}));this.clusterLayer_=new KS({name:"Cluster",source:new jb({distance:this.options_.distance,geometryFunction:function(t){return new dc(Mt(t.getGeometry().getExtent()))},source:new Fb({features:e})}),animationDuration:this.optionsVendor_.animationDuration,style:this.clusterStyleFn_.bind(this),animationMethod:n[this.optionsVendor_.animationMethod]}),!1===this.options_.animated&&this.clusterLayer_.set("animationDuration",void 0),this.clusterLayer_.setZIndex(99999);var r=this.layer_.getImpl().getOLLayer();r instanceof KS||(this.oldOLLayer_=r),this.clusterLayer_.setMaxResolution(this.oldOLLayer_.getMaxResolution()),this.clusterLayer_.setMinResolution(this.oldOLLayer_.getMinResolution()),this.layer_.getImpl().setOLLayer(this.clusterLayer_),_V(this.options_.ranges)&&(this.options_.ranges=this.getDefaultRanges_()),!1!==this.options_.hoverInteraction&&this.addCoverInteraction_(),!1!==this.options_.selectInteraction&&this.addSelectInteraction_()}},{key:"setRanges",value:function(t){_V(t)?this.options_.ranges=this.getDefaultRanges_():this.options_.ranges=t}},{key:"updateLastRange_",value:function(){var t=HV({},this.options_);if(!_V(this.options_)&&!_V(this.options_.ranges)){var e=t.ranges;if(e.length>0){var r=(e=e.sort((function(t,e){return t.min-e.min}))).pop();if(_V(r.max)){var n=this.layer_.getFeatures().length;r.max=n}t.ranges.push(r)}}return t}},{key:"setAnimated",value:function(t,e,r){return r.getOptions().animated=t,!1===t?this.clusterLayer_.set("animationDuration",void 0):this.clusterLayer_.set("animationDuration",this.optionsVendor_.animationDuration),this}},{key:"addSelectInteraction_",value:function(){var t=this,e=this.layer_.getImpl().getMap();this.selectClusterInteraction_=new cI({fLayer:this.layer_,map:e,maxFeaturesToSelect:this.options_.maxFeaturesToSelect,pointRadius:this.optionsVendor_.distanceSelectFeatures,animate:!0,layers:[this.clusterLayer_]}),this.selectClusterInteraction_.on("select",this.selectClusterFeature_.bind(this),this),e.getMapImpl().addInteraction(this.selectClusterInteraction_),e.getMapImpl().on("change:view",(function(e){return t.selectClusterInteraction_.refreshViewEvents(e)}))}},{key:"removeSelectInteraction_",value:function(){this.layer_.getImpl().getMap().getMapImpl().removeInteraction(this.selectClusterInteraction_)}},{key:"hoverFeatureFn_",value:function(t,e){if(!_V(t)){var r=[];t.forEach((function(t){t instanceof Eq?r=r.concat(t.getAttribute("features")):r.push(t)}));var n=r.map((function(t){return t.getImpl().getOLFeature().getGeometry().getCoordinates()})),i=fI(n);if(i.length>2){var o=new Cg(new Rc([i])),s=cq.olFeature2Facade(o);_V(this.convexHullLayer_)?(this.convexHullLayer_=new UC({name:"cluster_cover_".concat(this.layer_.name),extract:!1},{displayInLayerSwitcher:!1,style:new nE(this.optionsVendor_.convexHullStyle)}),this.convexHullLayer_.addFeatures(s),this.layer_.getImpl().getMap().addLayers(this.convexHullLayer_),this.layer_.getImpl().getMap().getMapImpl().getView().on("change:resolution",this.clearConvexHull.bind(this),this),this.convexHullLayer_.setStyle(new nE(this.optionsVendor_.convexHullStyle)),this.convexHullLayer_.setZIndex(99990)):(this.convexHullLayer_.removeFeatures(this.convexHullLayer_.getFeatures()),this.convexHullLayer_.addFeatures(s))}}}},{key:"leaveFeatureFn_",value:function(t,e){_V(this.convexHullLayer_)||this.convexHullLayer_.removeFeatures(this.convexHullLayer_.getFeatures())}},{key:"addCoverInteraction_",value:function(){this.hoverKey_=this.layer_.on(Qf,this.hoverFeatureFn_.bind(this)),this.leaveKey_=this.layer_.on(tp,this.leaveFeatureFn_.bind(this))}},{key:"removeCoverInteraction_",value:function(){this.layer_.unByKey(Qf,this.hoverKey_),this.layer_.unByKey(tp,this.leaveKey_)}},{key:"clusterStyleFn_",value:function(t,e,r){var n,i=t.get("features");if(!i)return new px;var o=i.length,s=this.options_.ranges.find((function(t){return t.min<=o&&t.max>=o}));if(_V(s)){if(1===o){var a=i[0].getStyle();a||(a=this.oldOLLayer_.getStyle()),(n=a(i[0],e))[0].setGeometry(i[0].getGeometry())}}else{var l=s.style.clone();if(r)l.set("fill.opacity",.33);else if(this.options_.displayAmount){l.set("label",this.options_.label);var u=l.get("label.color");if(_V(u)){var c=l.get("fill.color");u=_V(c)?"#000":XV(c),l.set("label.color",u)}}n=l.getImpl().olStyleFn(t,e)}return n}},{key:"getDefaultRanges_",value:function(){var t=this.layer_.getFeatures().length,e=Math.floor(t/3),r=[{min:2,max:e=Math.max(e,3),style:new $E(zI.RANGE_1_DEFAULT)},{min:e,max:2*e,style:new $E(zI.RANGE_2_DEFAULT)},{min:2*e,max:t+1,style:new $E(zI.RANGE_3_DEFAULT)}];return this.options_.ranges=r,r}},{key:"selectClusterFeature_",value:function(t){this.clearConvexHull()}},{key:"unapply",value:function(){_V(this.clusterLayer_)?_V(this.layer_)||this.layer_.un(ep,this.clusterize_.bind(this),this):(this.layer_.getImpl().setOLLayer(this.oldOLLayer_),this.oldOLLayer_.setMaxResolution(this.clusterLayer_.getMaxResolution()),this.oldOLLayer_.setMinResolution(this.clusterLayer_.getMinResolution()),this.removeCoverInteraction_(),this.removeSelectInteraction_(),this.clearConvexHull(),this.deactivateChangeResolutionEvent(),this.layer_.redraw(),this.deactivateChangeEvent())}},{key:"clearConvexHull",value:function(){null!==this.convexHullLayer_&&(this.layer_.getImpl().getMap().removeLayers(this.convexHullLayer_),this.convexHullLayer_=null)}},{key:"updateCanvas",value:function(){}},{key:"activateChangeEvent",value:function(){if(null!==this.clusterLayer_){var t=this.clusterLayer_.getSource(),e=jb.prototype.refresh;t.getSource().on("change",e)}}},{key:"deactivateChangeEvent",value:function(){if(null!==this.clusterLayer_){var t=this.clusterLayer_.getSource();ma({bindTo:void 0,callOnce:!1,listener:jb.prototype.refresh,target:t.getSource(),type:"change"})}}},{key:"deactivateChangeResolutionEvent",value:function(){if(!_V(this.layer_)&&!_V(this.layer_.getImpl())){var t=this.layer_.getImpl().getMap();if(!_V(t)&&!_V(t.getMapImpl())){var e=t.getMapImpl().getView();ma({type:"change:resolution",bindTo:void 0,listener:this.clearConvexHull,target:e,callOnce:!1})}}}},{key:"deactivateTemporarilyChangeEvent",value:function(t,e){this.deactivateChangeEvent(),vV(t)&&(null==e?t():t.apply(void 0,dI(e)))}},{key:"selectClusterInteraction",get:function(){return this.selectClusterInteraction_}},{key:"oldOLLayer",get:function(){return this.oldOLLayer_}}])&&yI(e.prototype,r),i&&yI(e,i),s}(zw);function xI(t){return(xI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function EI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function SI(t,e){return(SI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function II(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=CI(t);if(e){var i=CI(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return OI(this,r)}}function OI(t,e){return!e||"object"!==xI(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function CI(t){return(CI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var TI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SI(t,e)}(o,t);var e,r,n,i=II(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t,e)).styles_=[],r}return e=o,(r=[{key:"apply",value:function(t){this.layer_=t,_V(t)||this.updateInternal_(t)}},{key:"add",value:function(t){var e=this,r=t,n=this.layer_;return this.unapplyInternal(this.layer_),mV(r)||(r=[r]),(r=r.filter((function(t){return t.constructor!==e.constructor}))).forEach((function(t){e.styles_=e.styles_.filter((function(e){return e.constructor!==t.constructor}))})),this.styles_=this.styles_.concat(r),_V(n)||this.updateInternal_(n),this}},{key:"remove",value:function(t){var e=t,r=this.layer_;mV(e)||(e=[e]),_V(this.layer_)||this.unapplyInternal(this.layer_),this.styles_=this.styles_.filter((function(t){return!e.includes(t)})),r.setStyle(this.oldStyle_,!0),r.setStyle(this)}},{key:"getStyles",value:function(){return this.styles_}},{key:"getOldStyle",value:function(){return this.oldStyle_}},{key:"clear",value:function(){this.remove(this.styles_)}},{key:"unapplyInternal",value:function(t){this.styles_.concat(this).sort((function(t,e){return KV(e,t)})).forEach((function(e){e instanceof o&&e.unapplySoft(t)}))}},{key:"unapplySoft",value:function(t){}},{key:"unapply",value:function(t){this.unapplyInternal(t),this.layer_=null}},{key:"updateInternal_",value:function(t){this.styles_.concat(this).sort((function(t,e){return KV(t,e)})).forEach((function(e){e instanceof o?e.applyInternal(t):e instanceof Rx&&e.apply(t,!0)}))}}])&&EI(e.prototype,r),n&&EI(e,n),o}(Rx);function PI(t){return(PI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function RI(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return LI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LI(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function LI(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function MI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NI(t,e,r){return(NI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jI(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function AI(t,e){return(AI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function FI(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=jI(t);if(e){var i=jI(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return DI(this,r)}}function DI(t,e){return!e||"object"!==PI(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jI(t){return(jI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var GI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&AI(t,e)}(o,t);var e,r,n,i=FI(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};MI(this,o);var n=new wI(e,r);return t=i.call(this,e,n),HV(e,o.DEFAULT),HV(r,o.DEFAULT_VENDOR),t.optsVendor_=r,t.oldStyle_=null,t}return e=o,n=[{key:"deserialize",value:function(t){var e=RI(t,3),r=e[0],n=e[1],i=e[2],o=r;o.ranges.forEach((function(t){t.style=Rx.deserialize(t.style)})),o=QV(r);var s=QV(n),a=new Function(["options","optsVendor"],"return new M.style.Cluster(options, optsVendor)")(o,s),l=i.map((function(t){return Rx.deserialize(t)}));return a.add(l),a}}],(r=[{key:"apply",value:function(t){NI(jI(o.prototype),"apply",this).call(this,t);var e=t.getStyle();this.oldStyle_=e instanceof o?e.getOldStyle():e}},{key:"unapplySoft",value:function(t){this.getImpl().unapply()}},{key:"add",value:function(t){return _V(this.layer_)||this.unapplySoft(this.layer_),NI(jI(o.prototype),"add",this).call(this,t)}},{key:"applyInternal",value:function(t){this.layer_=t,this.getImpl().applyToLayer(t),this.updateCanvas()}},{key:"getOldStyle",value:function(){return this.oldStyle_}},{key:"getRanges",value:function(){return this.options_.ranges}},{key:"getOptions",value:function(){return this.options_}},{key:"setRanges",value:function(t){return this.getImpl().ranges=t,this.unapply(this.layer_),this.layer_.style=this,this}},{key:"getRange",value:function(t,e){return this.options_.ranges.find((function(r){return r.min===t&&r.max===e}))}},{key:"updateRange",value:function(t,e,r){return wI.updateRangeImpl(t,e,r,this.layer_,this),this.unapply(this.layer_),this.layer_.style=this,this}},{key:"setAnimated",value:function(t){return this.getImpl().setAnimated(t,this.layer_,this)}},{key:"isAnimated",value:function(){return this.options_.animated}},{key:"toImage",value:function(){return this.oldStyle_ instanceof Rx?this.oldStyle_.toImage():NI(jI(o.prototype),"toImage",this).call(this)}},{key:"refresh",value:function(){if(!_V(this.layer_)){var t=this.layer_;this.unapply(this.layer_),this.apply(t),this.updateCanvas()}}},{key:"toJSON",value:function(){var t=HV({},this.getOptions());t.ranges=this.getRanges().map((function(t){var e=HV({},t);return e.style=t.style.serialize(),e})),t=JV(t);var e=HV({},this.optsVendor_);return{parameters:[t,e=JV(e),this.getStyles().map((function(t){return t.serialize()}))],deserializedMethod:"M.style.Cluster.deserialize"}}},{key:"ORDER",get:function(){return 4}}])&&kI(e.prototype,r),n&&kI(e,n),o}(TI);GI.DEFAULT={ranges:[],hoverInteraction:!0,displayAmount:!0,selectInteraction:!0,distance:60,animated:!0,maxFeaturesToSelect:15,label:{text:function(t){var e,r=t.getAttribute("features");return r.length&&(e=r.length.toString()),e},color:"#fff",font:"bold 15px Arial",baseline:"middle",align:"center"}},GI.DEFAULT_VENDOR={animationDuration:250,animationMethod:"linear",distanceSelectFeatures:15,convexHullStyle:{fill:{color:"#fff",opacity:.25},stroke:{color:"#7b98bc"}}},GI.RANGE_1_DEFAULT={fill:{color:"#81c89a"},stroke:{color:"#6eb988",width:3},radius:15},GI.RANGE_2_DEFAULT={fill:{color:"#85b9d2"},stroke:{color:"#6da4be",width:3},radius:20},GI.RANGE_3_DEFAULT={fill:{color:"#938fcf"},stroke:{color:"#827ec5",width:3},radius:25};var zI=GI,UI="bottom-left",BI="bottom-center",VI="bottom-right",qI="center-left",YI="center-center",WI="center-right",XI="top-left",HI="top-center",ZI="top-right";function KI(t){return(KI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var $I=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),JI="element",QI="map",tO="offset",eO="position",rO="positioning",nO=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un,r.options=e,r.id=e.id,r.insertFirst=void 0===e.insertFirst||e.insertFirst,r.stopEvent=void 0===e.stopEvent||e.stopEvent,r.element=document.createElement("div"),r.element.className=void 0!==e.className?e.className:"ol-overlay-container ol-selectable",r.element.style.position="absolute",r.element.style.pointerEvents="auto";var n=e.autoPan;return n&&"object"!==KI(n)&&(n={animation:e.autoPanAnimation,margin:e.autoPanMargin}),r.autoPan=n||!1,r.rendered={transform_:"",visible:!0},r.mapPostrenderListenerKey=null,r.addChangeListener(JI,r.handleElementChanged),r.addChangeListener(QI,r.handleMapChanged),r.addChangeListener(tO,r.handleOffsetChanged),r.addChangeListener(eO,r.handlePositionChanged),r.addChangeListener(rO,r.handlePositioningChanged),void 0!==e.element&&r.setElement(e.element),r.setOffset(void 0!==e.offset?e.offset:[0,0]),r.setPositioning(void 0!==e.positioning?e.positioning:XI),void 0!==e.position&&r.setPosition(e.position),r}return $I(e,t),e.prototype.getElement=function(){return this.get(JI)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(QI)},e.prototype.getOffset=function(){return this.get(tO)},e.prototype.getPosition=function(){return this.get(eO)},e.prototype.getPositioning=function(){return this.get(rO)},e.prototype.handleElementChanged=function(){cl(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(ul(this.element),da(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=fa(t,tu,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(JI,t)},e.prototype.setMap=function(t){this.set(QI,t)},e.prototype.setOffset=function(t){this.set(tO,t)},e.prototype.setPosition=function(t){this.set(eO,t)},e.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},e.prototype.panIntoView=function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(eO)){var r=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),i=this.getRect(n,[sl(n),al(n)]),o=t||{},s=void 0===o.margin?20:o.margin;if(!gt(r,i)){var a=i[0]-r[0],l=r[2]-i[2],u=i[1]-r[1],c=r[3]-i[3],h=[0,0];if(a<0?h[0]=a-s:l<0&&(h[0]=Math.abs(l)+s),u<0?h[1]=u-s:c<0&&(h[1]=Math.abs(c)+s),0!==h[0]||0!==h[1]){var f=e.getView().getCenterInternal(),p=e.getPixelFromCoordinateInternal(f);if(!p)return;var d=[p[0]+h[0],p[1]+h[1]],g=o.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(d),duration:g.duration,easing:g.easing})}}}},e.prototype.getRect=function(t,e){var r=t.getBoundingClientRect(),n=r.left+window.pageXOffset,i=r.top+window.pageYOffset;return[n,i,n+e[0],i+e[1]]},e.prototype.setPositioning=function(t){this.set(rO,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var r=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(r,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var r=this.element.style,n=this.getOffset(),i=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+n[0])+"px",s=Math.round(t[1]+n[1])+"px",a="0%",l="0%";i==VI||i==WI||i==ZI?a="-100%":i!=BI&&i!=YI&&i!=HI||(a="-50%"),i==UI||i==BI||i==VI?l="-100%":i!=qI&&i!=YI&&i!=WI||(l="-50%");var u="translate("+a+", "+l+") translate("+o+", "+s+")";this.rendered.transform_!=u&&(this.rendered.transform_=u,r.transform=u,r.msTransform=u)},e.prototype.getOptions=function(){return this.options},e}(wa);function iO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var oO=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"listen",value:function(){t.WIDTH=window.innerWidth,t.HEIGHT=window.innerHeight,window.addEventListener("resize",(function(e){t.WIDTH=e.target.innerWidth,t.HEIGHT=e.target.innerHeight}))}}],(r=null)&&iO(e.prototype,r),n&&iO(e,n),t}();oO.WIDTH=window.innerWidth,oO.HEIGHT=window.innerHeight,oO.listen();var sO=oO;function aO(t){return(aO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cO(t,e){return(cO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pO(t);if(e){var i=pO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fO(this,r)}}function fO(t,e){return!e||"object"!==aO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pO(t){return(pO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cO(t,e)}(o,t);var e,r,n,i=hO(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return lO(this,o),(t=i.call(this,{})).panMapIfOutOfView=e.panMapIfOutOfView,void 0===t.panMapIfOutOfView&&(t.panMapIfOutOfView=!0),t.ani_opts=e.ani_opts,void 0===t.ani_opts&&(t.ani_opts={duration:250}),t.facadeMap_=null,t.cachedAniPixel_=null,t}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.container=e,this.content=this.getContentFromContainer(e),UV(this.content),this.setElement(this.container),t.getMapImpl().addOverlay(this)}},{key:"show",value:function(t,e){return this.setPosition(t),this.panMapIfOutOfView&&this.panIntoView_(t),this.content.scrollTop=0,vV(e)&&e(),this}},{key:"centerByStatus",value:function(t,e){var r=this.getMap().getView().getResolution(),n=[].concat(e);if(t===CO.status.COLLAPSED)n[1]-=.1*sO.HEIGHT*r;else{if(t!==CO.status.DEFAULT)return;n[1]-=.275*sO.HEIGHT*r}var i=this.facadeMap_.getFeatureCenter();this.facadeMap_.setCenter({x:n[0],y:n[1]}),_V(i)||this.facadeMap_.drawFeatures([i])}},{key:"getContentFromContainer",value:function(t){return t.querySelector("div.m-body")}},{key:"panIntoView_",value:function(t){var e=this;return this.panIntoSynchronizedAnim_().then((function(){if(e.isAnimating_=!0,sO.WIDTH>768){var r=e.element.querySelector(".m-popup"),n=r.clientWidth+20,i=r.clientHeight+20+30,o=e.getMap().getSize(),s=e.getMap().getView().getCenter(),a=n-60,l=e.getOffset(),u=e.getMap().getPixelFromCoordinate(t);if(!_V(u)){var c=u[0]-60,h=o[0]-(u[0]+a),f=u[1]-(i+l[1]),p=o[1]-(u[1]+20)-l[1],d=e.getMap().getPixelFromCoordinate(s),g=d.slice();h<0?g[0]-=h:c<0&&(g[0]+=c),f<0?g[1]+=f:p<0&&(g[1]-=p),!_V(e.ani_opts)&&_V(e.ani_opts.source)&&(e.ani_opts.source=s,e.getMap().getView().animate(e.ani_opts)),g[0]===d[0]&&g[1]===d[1]||e.getMap().getView().setCenter(e.getMap().getCoordinateFromPixel(g))}}e.isAnimating_=!1})),this.getMap().getView().getCenter()}},{key:"panIntoSynchronizedAnim_",value:function(){var t=this;return new Promise((function(e,r){if(!0===t.isAnimating_){var n=300;_V(t.ani_opts)||(n=t.ani_opts.duration),setTimeout(e,n)}else e()}))}},{key:"hide",value:function(){this.facadeMap_.removePopup()}},{key:"setContainer",value:function(t){this.setElement(t),this.content=this.getContentFromContainer(t),UV(this.content)}},{key:"getContent",value:function(){return this.content}}])&&uO(e.prototype,r),n&&uO(e,n),o}(nO),gO=(r(83),r(24)),yO=r.n(gO);function mO(t){return(mO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vO(t,e){return(vO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xO(t);if(e){var i=xO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wO(this,r)}}function wO(t,e){return!e||"object"!==mO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xO(t){return(xO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function EO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var SO=function(t,e){return{android:function(t){return"geo:".concat(t[1],"},").concat(t[0],"?q=").concat(t[1],",").concat(t[0])},ios:function(t){return"maps://?ll=".concat(t[1],",").concat(t[0])},unknown:function(t){return"http://maps.google.com?q=".concat(t[1],",").concat(t[0])}}[t](e)},IO=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};EO(this,t),this.icon=e.icon,this.title=e.title,this.content=e.content,this.listeners=e.listeners||[]},OO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vO(t,e)}(o,t);var e,r,n,i=bO(o);function o(t){var e;EO(this,o);var r=new dO(t);return(e=i.call(this,r)).coord_=null,e.tabs_=[],e.element_=null,e.status_=o.status.COLLAPSED,e}return e=o,(r=[{key:"getTabs",value:function(){return this.tabs_}},{key:"removeTab",value:function(t){this.tabs_=this.tabs_.filter((function(e){return e.content!==t.content})),this.update()}},{key:"addTab",value:function(t){var e=t;e instanceof IO||(e=new IO(t)),this.tabs_.push(e),this.update()}},{key:"addTo",value:function(t,e){if(this.map_=t,_V(this.element_)){var r=lq(e,this.map_.getProjection().code,"EPSG:4326"),n=aq(),i=Sp(yO.a,{jsonp:!0,vars:{tabs:this.tabs_,options:o.options,url:SO(n,r)}});this.tabs_.length>0&&(this.element_=i,this.addEvents(i),this.getImpl().addTo(t,i),this.show(e))}else this.getImpl().addTo(t,this.element_),this.show(e)}},{key:"update",value:function(){if(!_V(this.map_)){var t=lq(this.coord_,this.map_.getProjection().code,"EPSG:4326"),e=aq(),r=Sp(yO.a,{jsonp:!0,vars:{tabs:this.tabs_,options:o.options,url:SO(e,t)}});this.tabs_.length>0&&(this.element_=r,this.addEventTabs(this.tabs_[0],r),this.addEvents(r),this.getImpl().setContainer(r),this.show(this.coord_))}}},{key:"show",value:function(t){var e=this;this.coord_=t,this.getImpl().show(this.coord_,(function(){e.fire(Hf)}))}},{key:"hide",value:function(t){_V(t)||t.preventDefault(),this.getImpl().hide()}},{key:"switchTab",value:function(t){if(this.tabs_.length>t){var e=this.tabs_[t];this.setContent_(e.content),this.addEventTabs(e,this.getContent()),this.show(this.coord_)}}},{key:"addEventTabs",value:function(t,e){t.listeners.forEach((function(t){!0===t.all?e.querySelectorAll(t.selector).forEach((function(e){e.addEventListener(t.type,(function(e){return t.callback(e)}))})):e.querySelector(t.selector).addEventListener(t.type,(function(e){return t.callback(e)}))}))}},{key:"setContent_",value:function(t){this.getContent().innerHTML=t}},{key:"getContent",value:function(){return this.getImpl().getContent()}},{key:"addEvents",value:function(t){var e,r=this,n=t,i=n.querySelectorAll("div.m-tab");Array.prototype.forEach.call(i,(function(t){t.addEventListener("click",(function(n){n.preventDefault();var o=n.clientY;if("click"===n.type||Math.abs(e-o)<5){Array.prototype.forEach.call(i,(function(t){t.classList.remove("m-activated")})),t.classList.add("m-activated");var s=t.getAttribute("data-index");r.switchTab(s)}})),t.addEventListener("touchend",(function(n){n.preventDefault();var o=n.clientY;if("touchend"===n.type||Math.abs(e-o)<5){Array.prototype.forEach.call(i,(function(t){t.classList.remove("m-activated")})),t.classList.add("m-activated");var s=t.getAttribute("data-index");r.switchTab(s)}}))}));var s=n.querySelector("a.m-popup-closer");s.addEventListener("click",this.hide.bind(this),!1),s.addEventListener("touchend",this.hide.bind(this),!1);var a=n.querySelector("div.m-tabs");if(_V(a)&&(a=n.querySelector("div.m-content > div.m-header")),!_V(a)){var l;a.addEventListener("touchstart",(function(t){t.preventDefault(),e=t.touches[0].clientY,r.status_===o.status.COLLAPSED?l=.9*sO.HEIGHT:r.status_===o.status.DEFAULT?l=.45*sO.HEIGHT:r.status_===o.status.FULL&&(l=0),n.classList.add("m-no-animation")}),!1),a.addEventListener("touchmove",(function(t){t.preventDefault(),r.touchY=t.touches[0].clientY;var i=r.touchY-e;n.style.top="".concat(l+i,"px")}),!1),a.addEventListener("touchend",(function(t){t.preventDefault(),r.manageCollapsiblePopup_(e,r.touchY)}),!1);var u=window.matchMedia("(max-width: 768px)");setTimeout((function(){return r.manageTransform(u,n)}),10),u.addEventListener("change",(function(t){r.manageTransform(t,n)})),a.addEventListener("mouseup",(function(t){t.preventDefault(),r.tabs_.length<=1&&(r.status_===o.status.COLLAPSED?r.setStatus_(o.status.DEFAULT):r.status_===o.status.DEFAULT?r.setStatus_(o.status.FULL):r.setStatus_(o.status.COLLAPSED))}))}}},{key:"setStatus_",value:function(t){t!==this.status_&&(this.element_.classList.remove(this.status_),this.status_=t,this.element_.classList.add(this.status_),this.element_.style.top="",this.element_.classList.remove("m-no-animation"),sO.WIDTH<=M.config.MOBILE_WIDTH&&this.getImpl().centerByStatus(t,this.coord_))}},{key:"manageTransform",value:function(t,e){e&&e.parentElement&&(t.matches?e.parentElement.classList.add("unsetTransform"):e.parentElement.classList.remove("unsetTransform"))}},{key:"manageCollapsiblePopup_",value:function(t,e){var r=100*e/sO.HEIGHT;100*Math.abs(t-e)/sO.HEIGHT>10?this.status_===o.status.COLLAPSED?r<45?this.setStatus_(o.status.FULL):r<85?this.setStatus_(o.status.DEFAULT):this.setStatus_(o.status.COLLAPSED):this.status_===o.status.DEFAULT?r>45?this.setStatus_(o.status.COLLAPSED):r<45?this.setStatus_(o.status.FULL):this.setStatus_(o.status.DEFAULT):this.status_===o.status.FULL&&(r>45?this.setStatus_(o.status.COLLAPSED):r>0?this.setStatus_(o.status.DEFAULT):this.setStatus_(o.status.FULL)):this.setStatus_(this.status_)}},{key:"getCoordinate",value:function(){return this.coord_}},{key:"setCoordinate",value:function(t){this.coord_=t,_V(this.element_)||this.getImpl().show(t)}},{key:"destroy",value:function(){this.tabs_.length=0,this.coord_=null,this.fire(Kf)}}])&&_O(e.prototype,r),n&&_O(e,n),o}(Nf);OO.status={},OO.status.COLLAPSED="m-collapsed",OO.status.DEFAULT="m-default",OO.status.FULL="m-full",OO.options={takeMeThere:!1,textMode:!0,msg:"Llévame allí"};var CO=OO,TO=r(37),PO=r.n(TO);function RO(t){return(RO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LO(t){return function(t){if(Array.isArray(t))return MO(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return MO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MO(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MO(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NO(t,e){return(NO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function AO(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=DO(t);if(e){var i=DO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return FO(this,r)}}function FO(t,e){return!e||"object"!==RO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function DO(t){return(DO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jO=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&NO(t,e)}(o,t);var e,r,n,i=AO(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t,e)).facadeVector_=null,r.features_=[],r.postComposeEvtKey_=null,r.load_=!1,r.loaded_=!1,r}return e=o,(r=[{key:"addTo",value:function(t){this.map=t,this.fire(Af),t.on(op,this.setProjection_.bind(this),this),this.ol3Layer=new zS(this.vendorOptions_),this.updateSource_(),this.opacity_&&this.setOpacity(this.opacity_),this.setVisible(this.visibility),this.map.getMapImpl().addLayer(this.ol3Layer)}},{key:"updateSource_",value:function(){_V(this.vendorOptions_.source)&&(_V(this.ol3Layer.getSource())&&this.ol3Layer.setSource(new Fb),this.redraw(),this.loaded_=!0,this.fire(ep,[this.features_]))}},{key:"inRange",value:function(){return!0}},{key:"addFeatures",value:function(t,e){var r=this;t.forEach((function(t){var e=r.features_.find((function(e){return e.equals(t)}));_V(e)&&r.features_.push(t)})),e&&this.updateLayer_();var n=this.facadeVector_.getStyle();n instanceof zI?(n.getImpl().deactivateTemporarilyChangeEvent(this.redraw.bind(this)),n.refresh()):this.redraw()}},{key:"updateLayer_",value:function(){var t=this.facadeVector_.getStyle();if(!_V(t))if(t instanceof Rx)this.facadeVector_.setStyle(t);else if(t instanceof zI){var e=this.facadeVector_.getStyle();e.unapply(this.facadeVector_),e.getOldStyle().apply(this.facadeVector_),e.apply(this.facadeVector_)}else t.apply(this.facadeVector_)}},{key:"getFeatures",value:function(t,e){var r=this.features_;return t||(r=e.execute(r)),r}},{key:"getFeatureById",value:function(t){return this.features_.filter((function(e){return e.getId()===t}))[0]}},{key:"removeFeatures",value:function(t){this.features_=this.features_.filter((function(e){return!t.includes(e)}));var e=this.facadeVector_.getStyle();e instanceof zI?(e.getImpl().deactivateTemporarilyChangeEvent(this.redraw.bind(this)),e.refresh()):this.redraw()}},{key:"redraw",value:function(){var t=this.getOLLayer();if(!_V(t)){var e=this.facadeVector_.getStyle(),r=t.getSource();r instanceof jb&&(r=r.getSource()),e instanceof zI&&e.getImpl().deactivateChangeEvent(),LO(r.getFeatures()).forEach(r.removeFeature,r);var n=this.facadeVector_.getFeatures();r.addFeatures(n.map(cq.facade2OLFeature)),e instanceof zI&&e.getImpl().activateChangeEvent()}}},{key:"getFeaturesExtent",value:function(t,e){var r=this.getFeatures(t,e),n=ry.getFeaturesExtent(r,this.map.getProjection().code);return null===n&&(n=this.map.getProjection().getExtent()),n}},{key:"selectFeatures",value:function(t,e,r){var n=t[0];if(!(n instanceof Eq||!0!==this.extract||(this.unselectFeatures(),_V(n)))){var i=n.getAttribute("vendor.mapea.click");if(vV(i))i(r,n);else{var o=Sp(PO.a,{vars:this.parseFeaturesForTemplate_(t),parseToHtml:!1}),s={icon:"g-cartografia-pin",title:this.name,content:o},a=this.map.getPopup();_V(a)?((a=new CO).addTab(s),this.map.addPopup(a,e)):a.addTab(s)}}}},{key:"unselectFeatures",value:function(){}},{key:"setFacadeObj",value:function(t){this.facadeVector_=t}},{key:"setProjection_",value:function(t,e){if(t.code!==e.code){var r=ye(t.code),n=ye(e.code),i=this.facadeVector_.getStyle();i instanceof zI&&i.getImpl().deactivateChangeEvent(),this.facadeVector_.getFeatures().forEach((function(t){return t.getImpl().getOLFeature().getGeometry().transform(r,n)})),i instanceof zI&&i.getImpl().activateChangeEvent()}}},{key:"parseFeaturesForTemplate_",value:function(t){var e=this,r={features:[]};return t.forEach((function(t){if(!(t instanceof Eq)){var n=t.getAttributes(),i=Object.keys(n),o=[];i.forEach((function(t){var r=!0;_V(e.showAttributes_)?_V(e.hiddenAttributes_)||(r=!jV(e.hiddenAttributes_,t)):r=jV(e.showAttributes_,t),r&&o.push({key:FV(t),value:n[t]})}));var s={id:t.getId(),attributes:o};r.features.push(s)}})),r}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&this.constructor===t.constructor&&(e=!0),e}},{key:"refresh",value:function(){this.getOLLayer().getSource().clear()}},{key:"isLoaded",value:function(){return this.loaded_}},{key:"destroy",value:function(){var t=this.map.getMapImpl();_V(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map=null}}])&&kO(e.prototype,r),n&&kO(e,n),o}(cy),GO=(r(85),r(38)),zO=r.n(GO),UO=function(t,e,r){var n,i={message:t,title:e,severity:r},o=Sp(zO.a,{vars:i});n=document.querySelectorAll("div.m-dialog"),Array.prototype.forEach.call(n,(function(t){t.parentElement.removeChild(t)}));var s=document.querySelector("div.m-mapea-container");o.querySelector("div.m-button > button").addEventListener("click",(function(t){var e;(e=o).parentElement.removeChild(e)})),s.appendChild(o)},BO=function(t,e){var r=e;return _V(r)&&(r=pp("dialog").info),UO(t,r,"info")},VO=function(t,e){var r=e;return _V(r)&&(r=pp("dialog").error),UO(t,r,"error")},qO=function(t,e){var r=e;return _V(r)&&(r=pp("dialog").success),UO(t,r,"success")};function YO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var WO=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"getFunctionFilter",value:function(){}},{key:"execute",value:function(t){}},{key:"toCQL",value:function(){}}])&&YO(e.prototype,r),n&&YO(e,n),t}();function XO(t){return(XO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZO(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function KO(t,e){return(KO=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=QO(t);if(e){var i=QO(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return JO(this,r)}}function JO(t,e){return!e||"object"!==XO(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function QO(t){return(QO=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tC,eC=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KO(t,e)}(o,t);var e,r,n,i=$O(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return HO(this,o),(t=i.call(this,e)).textOverflow_=void 0!==e.textOverflow?e.textOverflow:"",t.minWidth_=e.minWidth||0,t}return e=o,(r=[{key:"getTextOverflow",value:function(){return this.textOverflow_}},{key:"getMinWidth",value:function(){return this.minWidth_}}])&&ZO(e.prototype,r),n&&ZO(e,n),o}(Qb),rC=function(t,e,r){var n;if(!_V(t.fill)){var i=Hw.getValue(t.fill.color,e,r),o=Hw.getValue(t.fill.opacity,e,r);o||0===o||(o=1),_V(i)||(n=new Kb({color:u()(i).alpha(o).css()}))}return n},nC=function(t,e,r){var n;if(!_V(t.stroke)){var i=Hw.getValue(t.stroke.color,e,r);if(!_V(i)){var o=t.stroke.linedashoffset;n=new Zb({color:i,width:Hw.getValue(t.stroke.width,e,r),lineDash:Hw.getValue(t.stroke.linedash,e,r),lineDashOffset:Hw.getValue(o,e,r),lineCap:Hw.getValue(t.stroke.linecap,e,r),lineJoin:Hw.getValue(t.stroke.linejoin,e,r),miterLimit:Hw.getValue(t.stroke.miterlimit,e,r)})}}return n},iC=function(t,e,r){var n;if(t.label){var s=Hw.getValue(t.label.text,e,r),a=Hw.getValue(t.label.align,e,r),l=Hw.getValue(t.label.baseline,e,r);if(n=new Qb({font:Hw.getValue(t.label.font,e,r),rotateWithView:Hw.getValue(t.label.rotate,e,r),scale:Hw.getValue(t.label.scale,e,r),offsetX:Hw.getValue(t.label.offset?t.label.offset[0]:void 0,e,r),offsetY:Hw.getValue(t.label.offset?t.label.offset[1]:void 0,e,r),fill:new Kb({color:Hw.getValue(t.label.color||"#000",e,r)}),textAlign:Object.values(o).includes(a)?a:"center",textBaseline:Object.values(i).includes(l)?l:"top",text:void 0===s?void 0:String(s),rotation:Hw.getValue(t.label.rotation,e,r)}),!_V(t.label.stroke)){var u=t.label.stroke,c=u.miterlimit,h=u.linedashoffset;n.setStroke(new Zb({color:Hw.getValue(t.label.stroke.color,e,r),width:Hw.getValue(t.label.stroke.width,e,r),lineCap:Hw.getValue(t.label.stroke.linecap,e,r),lineJoin:Hw.getValue(t.label.stroke.linejoin,e,r),lineDash:Hw.getValue(t.label.stroke.linedash,e,r),lineDashOffset:Hw.getValue(h,e,r),miterLimit:Hw.getValue(c,e,r)}))}}return n},oC={},sC=function(t,e,r){var n=t||{},i=rC(n,e,r),o=nC(n,e,r),s=new NE({fill:i,stroke:o,radius:Hw.getValue(n.radius,e,r),snapToPixel:Hw.getValue(n.snapToPixel,e,r)}),a=new ox({image:s}),l=new ox;if(!_V(n.icon)){var u,c=Hw.getValue(n.icon.src,e,r);_V(c)?_V(n.icon.form)||(u=function(t,e,r){return new _E({form:_V(Hw.getValue(t.icon.form,e,r))?"":Hw.getValue(t.icon.form,e,r).toLowerCase(),gradient:Hw.getValue(t.icon.gradient,e,r),glyph:Hw.getValue(t.icon.class,e,r),fontSize:Hw.getValue(t.icon.fontsize,e,r),radius:Hw.getValue(t.icon.radius,e,r),rotation:Hw.getValue(t.icon.rotation,e,r),rotateWithView:Hw.getValue(t.icon.rotate,e,r),offsetX:Hw.getValue(t.icon.offset?t.icon.offset[0]:void 0,e,r),offsetY:Hw.getValue(t.icon.offset?t.icon.offset[1]:void 0,e,r),fill:new Kb({color:Hw.getValue(void 0!==t.icon.fill?t.icon.fill:"#FFFFFF",e,r)}),stroke:t.icon.color?new Zb({color:Hw.getValue(t.icon.color,e,r),width:1}):void 0,anchor:Hw.getValue(t.icon.anchor,e,r),anchorXUnits:Hw.getValue(t.icon.anchorxunits,e,r),anchorYUnits:Hw.getValue(t.icon.anchoryunits,e,r),src:Hw.getValue(t.icon.src,e,r),opacity:Hw.getValue(t.icon.opacity,e,r),scale:Hw.getValue(t.icon.scale,e,r),snapToPixel:Hw.getValue(t.icon.snaptopixel,e,r),offsetOrigin:Hw.getValue(t.icon.offsetorigin,e,r),offset:Hw.getValue(t.icon.offset,e,r),crossOrigin:Hw.getValue(t.icon.crossorigin,e,r),anchorOrigin:Hw.getValue(t.icon.anchororigin,e,r),size:Hw.getValue(t.icon.size,e,r)})}(n,e,r),l.setImage(u)):(u=function(t,e,r){var n=Hw.getValue(t.icon.anchor,e,r),i=Hw.getValue(t.icon.anchorxunits,e,r),o=Hw.getValue(t.icon.anchoryunits,e,r),s=Hw.getValue(t.icon.src,e,r),a=Hw.getValue(t.icon.opacity,e,r),l=Hw.getValue(t.icon.scale,e,r),u=Hw.getValue(t.icon.rotation,e,r),c=Hw.getValue(t.icon.rotate,e,r),h=Hw.getValue(t.icon.snaptopixel,e,r),f=Hw.getValue(t.icon.offsetorigin,e,r),p=Hw.getValue(t.icon.offset,e,r),d=Hw.getValue(t.icon.crossorigin,e,r),g=Hw.getValue(t.icon.anchororigin,e,r),y=s+n+i+o+a+l+u+c+h+f+p+d+g+g+Hw.getValue(t.icon.size,e,r),m=oC[y];return m||(m=new OE({anchor:Hw.getValue(t.icon.anchor,e,r),anchorXUnits:Hw.getValue(t.icon.anchorxunits,e,r),anchorYUnits:Hw.getValue(t.icon.anchoryunits,e,r),src:Hw.getValue(t.icon.src,e,r),opacity:Hw.getValue(t.icon.opacity,e,r),scale:Hw.getValue(t.icon.scale,e,r),rotation:Hw.getValue(t.icon.rotation,e,r),rotateWithView:Hw.getValue(t.icon.rotate,e,r),snapToPixel:Hw.getValue(t.icon.snaptopixel,e,r),offsetOrigin:Hw.getValue(t.icon.offsetorigin,e,r),offset:Hw.getValue(t.icon.offset,e,r),crossOrigin:Hw.getValue(t.icon.crossorigin,e,r),anchorOrigin:Hw.getValue(t.icon.anchororigin,e,r),size:Hw.getValue(t.icon.size,e,r)}),oC[y]=m),m}(n,e,r),l.setImage(u))}var h=iC(n,e,r);return _V(n.label)||dV(h.getText())||a.setText(h),[a,l]},aC=function(t,e,r){var n=t||{},i=nC(n,e,r),o=function(t,e,r){var n;if(!_V(t.fill)){var i=Hw.getValue(t.fill.color,e,r),o=Hw.getValue(t.fill.opacity,e,r);o||0===o||(o=1);var s=Hw.getValue(t.fill.width,e,r);_V(i)||(n=new Zb({color:u()(i).alpha(o).css(),width:s}))}return n}(n,e,r),s=function(t,e,r){var n,i=t.label;if(!_V(i)){var o={text:void 0===Hw.getValue(i.text,e)?void 0:String(Hw.getValue(i.text,e)),font:Hw.getValue(i.font,e),fill:new Kb({color:Hw.getValue(i.color||"#000",e)}),textBaseline:(Hw.getValue(i.baseline,e)||"").toLowerCase(),textAlign:Hw.getValue(i.align,e),scale:Hw.getValue(i.scale,e),rotateWithView:Hw.getValue(i.rotate,e)||!1,textOverflow:Hw.getValue(i.textoverflow,e)||"",minWidth:Hw.getValue(i.minwidth,e)||0,geometry:Hw.getValue(i.geometry,e),offsetX:Hw.getValue(t.label.offset?t.label.offset[0]:void 0,e),offsetY:Hw.getValue(t.label.offset?t.label.offset[1]:void 0,e)};n=new eC(o),_V(i.stroke)||n.setStroke(new Zb({color:Hw.getValue(i.stroke.color,e),width:Hw.getValue(i.stroke.width,e),lineCap:Hw.getValue(i.stroke.linecap,e),lineJoin:Hw.getValue(i.stroke.linejoin,e),lineDash:Hw.getValue(i.stroke.linedash,e),lineDashOffset:Hw.getValue(i.stroke.linedashoffset,e),miterLimit:Hw.getValue(i.stroke.miterlimit,e)}))}return n}(n,e),a=new ox,l=new ox;_V(s)||(!0===Hw.getValue(s.path,e)?(a.textPath=s,!_V(s.smooth)&&!0===s.smooth&&vV(e.getGeometry)&&a.setGeometry(e.getGeometry().cspline())):a.setText(s));return a.setStroke(i),l.setStroke(o),[a,l]},lC=function(t,e,r){var n=t||{},i=new ox,o=nC(n,e,r),s=rC(n,e,r),a=iC(n,e,r);return n.fill&&!_V(n.fill.pattern)&&(s=function(t,e,r,n){var i="rgba(0,0,0,1)";if(!_V(t.fill.pattern.color)){var o=Hw.getValue(t.fill.pattern.opacity,e,r)||1;o||0===o||(o=1),i=u()(t.fill.pattern.color).alpha(o).css()}return new Dw({pattern:(Hw.getValue(t.fill.pattern.name,e,r)||"").toLowerCase(),color:i,size:Hw.getValue(t.fill.pattern.size,e,r),spacing:Hw.getValue(t.fill.pattern.spacing,e,r),image:"IMAGE"===Hw.getValue(t.fill.pattern.name,e,r)?new hw({src:Hw.getValue(t.fill.pattern.src,e,r)}):void 0,angle:Hw.getValue(t.fill.pattern.rotation,e,r),scale:Hw.getValue(t.fill.pattern.scale,e,r),offset:Hw.getValue(t.fill.pattern.offset,e,r),fill:n})}(n,e,r)),i.setFill(s),i.setStroke(o),i.setText(a),[i]};function uC(t){return(uC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fC(t,e){return(fC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=gC(t);if(e){var i=gC(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return dC(this,r)}}function dC(t,e){return!e||"object"!==uC(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gC(t){return(gC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yC(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mC=(yC(tC={},Yt.POINT,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return sC(e[0].point,e[1],e[2])})),yC(tC,Yt.LINE_STRING,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return aC(e[0].line,e[1],e[2])})),yC(tC,Yt.POLYGON,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return lC(e[0].polygon,e[1],e[2])})),yC(tC,Yt.MULTI_POINT,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return sC(e[0].point,e[1],e[2])})),yC(tC,Yt.MULTI_LINE_STRING,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return aC(e[0].line,e[1],e[2])})),yC(tC,Yt.MULTI_POLYGON,(function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return lC(e[0].polygon,e[1],e[2])})),tC),_C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fC(t,e)}(o,t);var e,r,n,i=pC(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return cC(this,o),(t=i.call(this,e)).styles_={},t}return e=o,(r=[{key:"toImage",value:function(){var t=oq(),e=document.createElement("canvas");e.width=200,e.height=50;var r=e.getContext("2d"),n=[0,60,120],i=0,o=new Image;if(o.width=30,o.height=30,!dV(this.options_.point)){if(!0===nq(this.options_.point))o.src=t;else{var s=(0,mC.Point)(this.options_,this,this.layer_);s[0].getImage().setRadius(5);var a=s[0].getImage().getImage(1).toDataURL();o.src=a}r.drawImage(o,n[i],0),i+=1}var l=new Image;if(!dV(this.options_.polygon)){if(!0===nq(this.options_.polygon))l.src=t,l.width=30,l.height=30;else{var u=(0,mC.Polygon)(this.options_,this,this.layer_),c=document.createElement("canvas");c.width=30,c.height=30;var h=Tw(c.getContext("2d"));h.setStyle(u[0],0,0);var f=[25,15],p=Math.floor(f[0]),d=Math.floor(f[1]),g=f[0]-p,y=f[1]-d;h.drawGeometry(new Rc([[[g+3,y+3],[p-3,y+3],[p-3,d-3],[g+3,d-3],[g+3,y+3]]])),l.src=c.toDataURL()}r.drawImage(l,n[i],0),i+=1}var m=new Image;if(!dV(this.options_.line)){if(!0===nq(this.options_.line))m.src=t,m.width=30,m.height=30;else{var _=(0,mC.LineString)(this.options_,this,this.layer_),v=document.createElement("canvas");v.width=30,v.height=30;var b=Tw(v.getContext("2d"));b.setStyle(_[0],0,0);var w=dV(_[0].getStroke())?1.5:_[0].getStroke().getWidth();b.drawGeometry(new Fg([[0+w/2,0+w/2],[25/3,7.5-w/2],[50/3,0+w/2],[25-w/2,7.5-w/2]])),m.src=v.toDataURL()}r.drawImage(m,n[i],0),i+=1}return e.toDataURL()}},{key:"updateFacadeOptions",value:function(t){var e=this;this.olStyleFn_=function(r){var n=JSON.stringify(r.getProperties()),i=[];e.styles_=[];var o=r;if(o instanceof Cg||o instanceof kg){var s=o.getGeometry().getType(),a=mC[s];vV(a)&&(i=a(t,o,e.layer_),e.styles_[n]=i)}else o=e;return i}}},{key:"drawGeometryToCanvas",value:function(t){}},{key:"updateCanvas",value:function(t){}},{key:"getCanvasSize",value:function(){return 0}},{key:"getRadius_",value:function(t){return t instanceof hw?25:t instanceof hE?t.getRadius():this.olStyleFn_()[0].getImage().getRadius()}}])&&hC(e.prototype,r),n&&hC(e,n),o}(Hw);function vC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function bC(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vC(Object(r),!0).forEach((function(e){wC(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vC(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function wC(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xC(t){return(xC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function EC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function SC(t,e){return(SC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function IC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=CC(t);if(e){var i=CC(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return OC(this,r)}}function OC(t,e){return!e||"object"!==xC(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function CC(t){return(CC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var TC=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SC(t,e)}(o,t);var e,r,n,i=IC(o);function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=t;e=_V(e)?o.DEFAULT_NULL:HV(e,o.DEFAULT),e=HV({},e);var r=new _C(e);return i.call(this,e,r)}return e=o,(r=[{key:"toImage",value:function(){return this.getImpl().toImage(this.canvas_)}},{key:"getDeserializedMethod_",value:function(){return"((serializedParameters) => M.style.Simple.deserialize(serializedParameters, 'M.style.Generic'))"}}])&&EC(e.prototype,r),n&&EC(e,n),o}(Hx);TC.DEFAULT={point:{radius:5}},TC.PARAMS_DEFAULT_NULL={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5}},TC.DEFAULT_NULL={point:bC(bC({},TC.PARAMS_DEFAULT_NULL),{},{radius:5}),line:bC({},TC.PARAMS_DEFAULT_NULL),polygon:bC({},TC.PARAMS_DEFAULT_NULL)};var PC=TC;function RC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function LC(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?RC(Object(r),!0).forEach((function(e){MC(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RC(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function MC(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kC(t){return(kC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function NC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function FC(t,e){return(FC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function DC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=GC(t);if(e){var i=GC(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return jC(this,r)}}function jC(t,e){return!e||"object"!==kC(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function GC(t){return(GC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zC=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&FC(t,e)}(o,t);var e,r,n,i=DC(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;NC(this,o);var a=s||new jO(r,n);return t=i.call(this,e,a),dV(jO)&&Of(pp("exception").vectorlayer_method),t.extract=e.extract,_V(t.extract)&&(t.extract=!0),t.style_=null,t.filter_=null,t.setStyle(r.style),a.on(ep,(function(e){return t.fire(ep,[e])})),t}return e=o,(r=[{key:"addFeatures",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t;_V(r)||(mV(r)||(r=[r]),this.getImpl().addFeatures(r,e))}},{key:"getFeatures",value:function(t){var e=t;return _V(this.getFilter())&&(e=!0),this.getImpl().getFeatures(e,this.filter_)}},{key:"getFeatureById",value:function(t){var e=null;return _V(t)?VO(pp("dialog").id_feature):e=this.getImpl().getFeatureById(t),e}},{key:"removeFeatures",value:function(t){var e=t;mV(e)||(e=[e]),this.getImpl().removeFeatures(e)}},{key:"clear",value:function(){this.removeFilter(),this.removeFeatures(this.getFeatures(!0))}},{key:"refresh",value:function(){this.getImpl().refresh(!0),this.redraw()}},{key:"redraw",value:function(){this.getImpl().redraw()}},{key:"setFilter",value:function(t){if(_V(t)||t instanceof WO){this.filter_=t;var e=this.style_;e instanceof zI&&e.getImpl().deactivateChangeEvent(),this.redraw(),e instanceof zI&&(e.getImpl().activateChangeEvent(),e.refresh())}else VO(pp("dialog").vector_filter)}},{key:"getFilter",value:function(){return this.filter_}},{key:"getFeaturesExtent",value:function(t){var e=t;return _V(this.getFilter())&&(e=!0),this.getImpl().getFeaturesExtent(e,this.filter_)}},{key:"removeFilter",value:function(){this.setFilter(null)}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.name===t.name),e}},{key:"setStyle",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.DEFAULT_OPTIONS_STYLE;this.getImpl().isLoaded()?(_V(this.getStyle())&&this.applyStyle_(n,r),_V(t)||this.applyStyle_(t,r)):this.once(ep,(function(){_V(e.getStyle())&&e.applyStyle_(n,r),_V(t)||e.applyStyle_(t,r)}))}},{key:"applyStyle_",value:function(t,e){var r=t;if(wV(r)?r=Rx.deserialize(r):r instanceof Rx||(r=new PC(r)),r instanceof Rx&&(!_V(this.style_)&&this.style_ instanceof Rx&&this.style_.unapply(this),r.apply(this,e),this.style_=r,this.fire(sp,[r,this])),!_V(this.getImpl().getMap())){var n=this.getImpl().getMap().getControls("layerswitcher")[0];_V(n)||n.render()}this.fire(sp,[r,this])}},{key:"getStyle",value:function(){return this.style_}},{key:"clearStyle",value:function(){this.setStyle(null),this.getFeatures().forEach((function(t){return t.clearStyle()}))}},{key:"getLegendURL",value:function(){var t=this.getImpl().getLegendURL();return-1!==t.indexOf(Ad.LEGEND_DEFAULT)&&-1===t.indexOf(Ad.LEGEND_ERROR)&&this.style_ instanceof Rx&&(t=this.style_ instanceof zI&&this.style_.getStyles().length>0?this.style_.getStyles()[0].toImage():this.style_.toImage()),t}},{key:"getGeometryType",value:function(){var t=null;if(!_V(this.getFeatures())){var e=this.getFeatures()[0];_V(e)||_V(e.getGeometry())||(t=e.getGeometry().type)}return t}},{key:"getMaxExtent",value:function(){return this.getFeaturesExtent()}},{key:"calculateMaxExtent",value:function(){return this.getImpl().getFeaturesExtentPromise(!0,this.filter_)}},{key:"toGeoJSON",value:function(){var t=this.map_.getProjection().code,e=this.getFeatures().map((function(t){return t.getGeoJSON()}));return{type:"FeatureCollection",features:ey(e,t)}}},{key:"type",get:function(){return Vp},set:function(t){dV(t)||_V(t)||t===Vp||Of("El tipo de capa debe ser '".concat(Vp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"extract",get:function(){return this.getImpl().extract},set:function(t){_V(t)?this.getImpl().extract=!0:wV(t)?this.getImpl().extract="true"===SV(t):this.getImpl().extract=t}}])&&AC(e.prototype,r),n&&AC(e,n),o}(Ad);zC.DEFAULT_PARAMS={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5}},zC.DEFAULT_OPTIONS_STYLE={point:LC(LC({},zC.DEFAULT_PARAMS),{},{radius:5}),line:LC({},zC.DEFAULT_PARAMS),polygon:LC({},zC.DEFAULT_PARAMS)};var UC=zC;function BC(t){return(BC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VC(t){return function(t){if(Array.isArray(t))return qC(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return qC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qC(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qC(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function YC(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function WC(t,e){return(WC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ZC(t);if(e){var i=ZC(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return HC(this,r)}}function HC(t,e){return!e||"object"!==BC(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ZC(t){return(ZC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var KC=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&WC(t,e)}(o,t);var e,r,n,i=XC(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new gb;return t=i.call(this,e,o.NAME),dV(gb)&&Of(pp("exception").layerswitcher_method),t}return e=o,n=[{key:"getTemplateVariables",value:function(t){return new Promise((function(e,r){if(!_V(t)){var n=t.getBaseLayers().filter((function(t){return!0===t.displayInLayerSwitcher})),i=t.getLayerGroup(),s=o.orderLayerGroups(i),a=t.getRootLayers().filter((function(t){var e=!0===t.transparent,r=!0===t.displayInLayerSwitcher,n=t.type!==Ap,i=!(t.type===Dp&&_V(t.name)),o=t.getLayerGroup&&null===t.getLayerGroup();return e&&n&&i&&r&&o})).reverse(),l=Promise.all(n.map(o.parseLayerForTemplate)),u=Promise.all(a.map(o.parseLayerForTemplate)),c=Promise.all(s.map((function(t){return o.parseGroupForTemplate(t,n)})).filter((function(t){return!_V(t)})));l.then((function(t){c.then((function(r){u.then((function(n){return e({baseLayers:t,overlayLayers:n,layerGroups:r})}))}))}))}}))}},{key:"parseLayerForTemplate",value:function(t){var e=t.legend;_V(e)&&(e=t.name),_V(e)&&(e="Servicio WMS");var r=!1;if(t instanceof UC){var n=t.getStyle();n instanceof $E&&!_V(n.get("icon.src"))&&(r=!0)}return new Promise((function(n,i){var o={base:!1===t.transparent,visible:!0===t.isVisible(),id:t.name,title:e,outOfRange:!t.inRange(),opacity:t.getOpacity(),isIcon:r},s=t.getLegendURL();s instanceof Promise?s.then((function(t){o.legend=t,n(o)})):(o.legend="KML"!==t.type?s:null,n(o))}))}},{key:"parseGroupForTemplate",value:function(t,e){var r=VC(t.getChildren()),n=t.title;_V(n)&&(n=t.id),_V(n)&&(n="Conjunto de Servicios WMS");var i={id:t.id,title:n,order:t.order,collapsed:t.collapsed,layers:[],layerGroups:[]};r.forEach((function(t){if(t instanceof Ad)i.layers.push(o.parseLayerForTemplate(t));else if(t instanceof sb){var r=o.parseGroupForTemplate(t,e);_V(r)||i.layerGroups.push(r)}})),Promise.all(i.layers).then((function(t){_V(i)||(i.layers=t)}));var s=0,a=t.getAllLayers();return a.every((function(t){return t.isVisible()}))?s=2:a.some((function(t){return t.isVisible()}))&&(s=1),i.visible=s,_V(i.layers)&&_V(i.layerGroups)&&(i=null),i}},{key:"orderLayerGroups",value:function(t){return t.sort((function(t,e){return t.order-e.order}))}}],(r=[{key:"addTo",value:function(t){var e=this;this.map_=t;var r=this.getImpl();this.createView(t).then((function(n){e.manageActivation(n),r.addTo(t,n),e.fire(Af)}))}},{key:"createView",value:function(t){var e=this;return new Promise((function(t){o.getTemplateVariables(e.map_).then((function(e){var r=Sp(Vv.a,{vars:e});t(r)}))}))}},{key:"equals",value:function(t){var e=t instanceof o;return e}},{key:"render",value:function(){this.getImpl().renderPanel()}},{key:"registerEvents",value:function(){this.getImpl().registerEvents()}},{key:"unregisterEvents",value:function(){this.getImpl().unregisterEvents()}}])&&YC(e.prototype,r),n&&YC(e,n),o}(bp);KC.NAME="layerswitcher";var $C=KC,JC=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),QC="accuracy",tT="accuracyGeometry",eT="altitude",rT="altitudeAccuracy",nT="heading",iT="position",oT="projection",sT="speed",aT="tracking",lT="trackingOptions",uT=function(t){function e(e){var r=t.call(this,Js)||this;return r.code=e.code,r.message=e.message,r}return JC(e,t),e}(Xs),cT=function(t){function e(e){var r=t.call(this)||this;r.on,r.once,r.un;var n=e||{};return r.position_=null,r.transform_=de,r.watchId_=void 0,r.addChangeListener(oT,r.handleProjectionChanged_),r.addChangeListener(aT,r.handleTrackingChanged_),void 0!==n.projection&&r.setProjection(n.projection),void 0!==n.trackingOptions&&r.setTrackingOptions(n.trackingOptions),r.setTracking(void 0!==n.tracking&&n.tracking),r}return JC(e,t),e.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},e.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=Se(ye("EPSG:4326"),t),this.position_&&this.set(iT,this.transform_(this.position_)))},e.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},e.prototype.positionChange_=function(t){var e=t.coords;this.set(QC,e.accuracy),this.set(eT,null===e.altitude?void 0:e.altitude),this.set(rT,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(nT,null===e.heading?void 0:x(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var r=this.transform_(this.position_);this.set(iT,r),this.set(sT,null===e.speed?void 0:e.speed);var n=Lc(this.position_,e.accuracy);n.applyTransform(this.transform_),this.set(tT,n),this.changed()},e.prototype.positionError_=function(t){this.dispatchEvent(new uT(t))},e.prototype.getAccuracy=function(){return this.get(QC)},e.prototype.getAccuracyGeometry=function(){return this.get(tT)||null},e.prototype.getAltitude=function(){return this.get(eT)},e.prototype.getAltitudeAccuracy=function(){return this.get(rT)},e.prototype.getHeading=function(){return this.get(nT)},e.prototype.getPosition=function(){return this.get(iT)},e.prototype.getProjection=function(){return this.get(oT)},e.prototype.getSpeed=function(){return this.get(sT)},e.prototype.getTracking=function(){return this.get(aT)},e.prototype.getTrackingOptions=function(){return this.get(lT)},e.prototype.setProjection=function(t){this.set(oT,ye(t))},e.prototype.setTracking=function(t){this.set(aT,t)},e.prototype.setTrackingOptions=function(t){this.set(lT,t)},e}(wa);function hT(t){return(hT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pT(t,e,r){return(pT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mT(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function dT(t,e){return(dT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mT(t);if(e){var i=mT(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return yT(this,r)}}function yT(t,e){return!e||"object"!==hT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mT(t){return(mT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dT(t,e)}(o,t);var e,r,n,i=gT(o);function o(t,e,r,n){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(s=i.call(this,n)).vendorOptions_=n,s.geolocation_=null,s.accuracyFeature_=cq.olFeature2Facade(new Cg),s.tracking_=t,s.highAccuracy_=e,s.maximumAge_=r,s.activated_=!1,s.positionFeature_=cq.olFeature2Facade(new Cg({style:o.POSITION_STYLE})),s}return e=o,(r=[{key:"activate",value:function(){var t=this;if(this.element.classList.add("m-locating"),_V(this.geolocation_)){var e=ye(this.facadeMap_.getProjection().code);this.geolocation_=new cT(GV({projection:e,tracking:this.tracking_,trackingOptions:{enableHighAccuracy:this.highAccuracy_,maximumAge:this.maximumAge_}},this.vendorOptions_,!0)),this.geolocation_.on("change:accuracyGeometry",(function(e){var r=e.target.get(e.key);t.accuracyFeature_.getImpl().getOLFeature().setGeometry(r)})),this.geolocation_.on("change:position",(function(e){var r=e.target.get(e.key),n=_V(r)?null:new dc(r);t.positionFeature_.getImpl().getOLFeature().setGeometry(n),t.facadeMap_.setCenter(r),t.element.classList.contains("m-locating")&&t.facadeMap_.setZoom(o.ZOOM),t.element.classList.remove("m-locating"),t.element.classList.add("m-located"),t.geolocation_.setTracking(t.tracking_)}))}this.geolocation_.setTracking(!0),this.facadeMap_.drawFeatures([this.accuracyFeature_,this.positionFeature_])}},{key:"removePositions_",value:function(){_V(this.accuracyFeature_)||this.facadeMap_.removeFeatures([this.accuracyFeature_]),_V(this.positionFeature_)||this.facadeMap_.removeFeatures([this.positionFeature_]),this.geolocation_.setTracking(!1)}},{key:"deactivate",value:function(){this.removePositions_(),this.element.classList.remove("m-located"),this.element.classList.remove("m-locating"),this.geolocation_=null}},{key:"setTracking",value:function(t){this.tracking_=t,this.geolocation_.setTracking(t)}},{key:"destroy",value:function(){this.removePositions_(),pT(mT(o.prototype),"destroy",this).call(this)}}])&&fT(e.prototype,r),n&&fT(e,n),o}(Ev);_T.POSITION_STYLE=new ox({image:new Jw({radius:6,fill:new Kb({color:"#3399CC"}),stroke:new Zb({color:"#fff",width:2})})}),_T.ZOOM=12;var vT=_T,bT=r(39),wT=r.n(bT);r(87);function xT(t){return(xT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ET(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ST(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function IT(t,e){return(IT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function OT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=TT(t);if(e){var i=TT(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return CT(this,r)}}function CT(t,e){return!e||"object"!==xT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function TT(t){return(TT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var PT=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&IT(t,e)}(o,t);var e,r,n,i=OT(o);function o(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ET(this,o),dV(vT)&&Of(pp("exception").location_method);var n=new vT(t,e,6e4,r);return i.call(this,n,o.NAME)}return e=o,(r=[{key:"createView",value:function(t){return Sp(wT.a,{vars:{title:pp("location").title}})}},{key:"getActivationButton",value:function(t){return t.querySelector("button#m-location-button")}},{key:"equals",value:function(t){var e=t instanceof o;return e}},{key:"setTracking",value:function(t){this.getImpl().tracking=t}}])&&ST(e.prototype,r),n&&ST(e,n),o}(bp);PT.NAME="location";var RT=PT,LT=(r(28),r(40)),MT=r.n(LT);function kT(t){return(kT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function NT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function FT(t,e,r){return(FT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zT(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function DT(t,e){return(DT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=zT(t);if(e){var i=zT(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return GT(this,r)}}function GT(t,e){return!e||"object"!==kT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zT(t){return(zT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UT=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DT(t,e)}(o,t);var e,r,n,i=jT(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return NT(this,o),(t=i.call(this)).facadeMap_=null,t.exactScale=e.exactScale||!1,t}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.scaleContainer_=e.querySelector("#".concat("m-scale-span")),this.element=e,this.render=this.renderCB,this.target_=null,t.getMapImpl().addControl(this)}},{key:"renderCB",value:function(t){var e,r,n,i,o=t.frameState;_V(o)||(o.viewState,e=this.scaleContainer_,r=this.facadeMap_,n=this.exactScale,i=e,r.getWMTS().length>0?i.innerHTML=ry.getWMTSScale(r,n):r.getWMTS().length<=0&&!0===n?i.innerHTML=r.getExactScale():r.getWMTS().length<=0&&1==!n&&(i.innerHTML=r.getScale()))}},{key:"destroy",value:function(){FT(zT(o.prototype),"destroy",this).call(this),this.scaleContainer_=null}}])&&AT(e.prototype,r),n&&AT(e,n),o}(Ev);function BT(t){return(BT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function YT(t,e,r){return(YT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ZT(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function WT(t,e){return(WT=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XT(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ZT(t);if(e){var i=ZT(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return HT(this,r)}}function HT(t,e){return!e||"object"!==BT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ZT(t){return(ZT=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var KT=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&WT(t,e)}(o,t);var e,r,n,i=XT(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};VT(this,o);var r=new UT(e);return t=i.call(this,r,o.NAME),dV(UT)&&Of(pp("exception").scale_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(MT.a,{vars:{title:pp("scale").title,scale:pp("scale").scale}})}},{key:"equals",value:function(t){var e=t instanceof o;return e}},{key:"destroy",value:function(){YT(ZT(o.prototype),"destroy",this).call(this);var t=this.getPanel();_V(t)||t.removeClassName("m-with-scale")}}])&&qT(e.prototype,r),n&&qT(e,n),o}(bp);KT.NAME="scale";var $T=KT;r(90);function JT(t){return(JT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function QT(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function tP(t,e,r){return(tP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=iP(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function eP(t,e){return(eP=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=iP(t);if(e){var i=iP(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return nP(this,r)}}function nP(t,e){return!e||"object"!==JT(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iP(t){return(iP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oP=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eP(t,e)}(o,t);var e,r,n,i=rP(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).facadeMap_=null,e}return e=o,(r=[{key:"addTo",value:function(t,e){var r=this;tP(iP(o.prototype),"addTo",this).call(this,t,e);var n=t.getMapImpl();this.olMap=n,this.panel=e,this.panel.querySelector("button").addEventListener("click",(function(){r.resetRotation()})),n.on("change:view",(function(t){t.target.getView().on("change:rotation",(function(t){var e=t.target.getRotation(),n="rotate(".concat(360*e/(2*Math.PI),"deg)");r.panel.querySelector("button").style.WebkitTransform=n,r.panel.querySelector("button").style.MozTransform=n,r.panel.querySelector("button").style.transform=n}))}))}},{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}},{key:"resetRotation",value:function(){this.olMap.getView().setRotation(0)}},{key:"onChangeView",value:function(t){var e=t.querySelector("#m-rotate-marker");this.olMap.on("change:view",(function(t){t.target.getView().on("change:rotation",(function(t){var r=t.target.getRotation();e.style.transform="rotate(".concat(r*(180/Math.PI)+45,"deg)")}))}))}}])&&QT(e.prototype,r),n&&QT(e,n),o}(Ev);oP.PANEL_ID="m-layerswitcher-panel";var sP=oP,aP=r(41),lP=r.n(aP);function uP(t){return(uP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cP(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hP(t,e){return(hP=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dP(t);if(e){var i=dP(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return pP(this,r)}}function pP(t,e){return!e||"object"!==uP(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dP(t){return(dP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gP=function(t,e,r){for(var n=e,i=t.target.parentElement.parentElement,o=0,s=0;i&&!Number.isNaN(i.offsetLeft)&&!Number.isNaN(i.offsetTop);)o+=i.offsetLeft-i.scrollLeft,s+=i.offsetTop-i.scrollTop,i=i.offsetParent;o=t.clientX-o,s=t.clientY-s;var a=t.currentTarget,l=a.clientWidth,u=a.clientHeight,c=[0,-u],h=[o-l/2,s-u/2],f=(c[0]*h[0]+c[1]*h[1])/(Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2))*Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2))),p=180*Math.acos(f)/Math.PI;h[0]<0&&(p=360-p),r.setRotation(p);n.querySelector("#m-rotate-marker").style.WebkitTransform="rotate(".concat(p+45,"deg)"),n.querySelector("#m-rotate-marker").style.MozTransform="rotate(".concat(p+45,"deg)"),n.querySelector("#m-rotate-marker").style.transform="rotate(".concat(p+45,"deg)")},yP=function(t,e){e.querySelector("#m-rotate-slider-container").addEventListener("mousedown",(function(e){t.setActive(!0),"m-rotate-button"!==e.target.id&&t.setMouseDown(!0)}))},mP=function(t,e){document.body.addEventListener("mouseup",(function(e){t.setActive(!1)}))},_P=function(t,e,r){var n=e,i=e.querySelector("#m-rotate-slider-container");i.addEventListener("click",(function(i){"m-rotate-button"!==i.target.id||t.getMouseDown()?gP(i,e,r):(t.getImpl().resetRotation(),n.querySelector("#m-rotate-marker").style.WebkitTransform="rotate(40deg)",n.querySelector("#m-rotate-marker").style.MozTransform="rotate(40deg)",n.querySelector("#m-rotate-marker").style.transform="rotate(40deg)"),t.setMouseDown(!1)}))},vP=function(t,e,r){e.querySelector("#m-rotate-slider-container").addEventListener("mousemove",(function(n){t.getActive()&&gP(n,e,r)}))},bP=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hP(t,e)}(o,t);var e,r,n,i=fP(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),dV(sP)&&Of("La implementación usada no puede crear controles Scale");var e=new sP;return(t=i.call(this,e,o.NAME)).active_=!1,t.isMouseDown_=!1,t}return e=o,(r=[{key:"createView",value:function(t){var e=this,r=Sp(lP.a);return r.querySelector("#m-rotate-marker").style.WebkitTransform="rotate(40deg)",r.querySelector("#m-rotate-marker").style.MozTransform="rotate(40deg)",r.querySelector("#m-rotate-marker").style.transform="rotate(40deg)",yP(this,r),vP(this,r,t),mP(this),_P(this,r,t),this.on(Af,(function(){e.getImpl().onChangeView(r)})),r}},{key:"equals",value:function(t){var e=t instanceof o;return e}},{key:"setActive",value:function(t){this.active_=!!t}},{key:"getActive",value:function(){return this.active_}},{key:"setMouseDown",value:function(t){this.isMouseDown_=!!t}},{key:"getMouseDown",value:function(){return this.isMouseDown_}}])&&cP(e.prototype,r),n&&cP(e,n),o}(bp);bP.NAME="rotate";var wP=bP,xP=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),EP="units",SP="degrees",IP="imperial",OP="nautical",CP="metric",TP="us",PP=[1,2,5],RP=25.4/.28,LP=function(t){function e(e){var r=this,n=e||{},i=void 0!==n.className?n.className:n.bar?"ol-scale-bar":"ol-scale-line";return(r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this).on,r.once,r.un,r.innerElement_=document.createElement("div"),r.innerElement_.className=i+"-inner",r.element.className=i+" "+Ja,r.element.appendChild(r.innerElement_),r.viewState_=null,r.minWidth_=void 0!==n.minWidth?n.minWidth:64,r.renderedVisible_=!1,r.renderedWidth_=void 0,r.renderedHTML_="",r.addChangeListener(EP,r.handleUnitsChanged_),r.setUnits(n.units||CP),r.scaleBar_=n.bar||!1,r.scaleBarSteps_=n.steps||4,r.scaleBarText_=n.text||!1,r.dpi_=n.dpi||void 0,r}return xP(e,t),e.prototype.getUnits=function(){return this.get(EP)},e.prototype.handleUnitsChanged_=function(){this.updateElement_()},e.prototype.setUnits=function(t){this.set(EP,t)},e.prototype.setDpi=function(t){this.dpi_=t},e.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e=t.center,r=t.projection,n=this.getUnits(),i=n==SP?d.DEGREES:d.METERS,o=me(r,t.resolution,e,i),s=this.minWidth_*(this.dpi_||RP)/RP,a=s*o,l="";if(n==SP){var u=p[d.DEGREES];(a*=u)<u/60?(l="″",o*=3600):a<u?(l="′",o*=60):l="°"}else n==IP?a<.9144?(l="in",o/=.0254):a<1609.344?(l="ft",o/=.3048):(l="mi",o/=1609.344):n==OP?(o/=1852,l="nm"):n==CP?a<.001?(l="μm",o*=1e6):a<1?(l="mm",o*=1e3):a<1e3?l="m":(l="km",o/=1e3):n==TP?a<.9144?(l="in",o*=39.37):a<1609.344?(l="ft",o/=.30480061):(l="mi",o/=1609.3472):ut(!1,33);for(var c,h,f,g,y=3*Math.floor(Math.log(s*o)/Math.log(10));;){f=Math.floor(y/3);var m=Math.pow(10,f);if(c=PP[(y%3+3)%3]*m,h=Math.round(c/o),isNaN(h))return this.element.style.display="none",void(this.renderedVisible_=!1);if(h>=s)break;++y}g=this.scaleBar_?this.createScaleBar(h,c,l):c.toFixed(f<0?-f:0)+" "+l,this.renderedHTML_!=g&&(this.innerElement_.innerHTML=g,this.renderedHTML_=g),this.renderedWidth_!=h&&(this.innerElement_.style.width=h+"px",this.renderedWidth_=h),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.createScaleBar=function(t,e,r){for(var n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),i=[],o=t/this.scaleBarSteps_,s="#ffffff",a=0;a<this.scaleBarSteps_;a++)0===a&&i.push(this.createMarker("absolute",a)),i.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+s+';"></div>'+this.createMarker("relative",a)+(a%2==0||2===this.scaleBarSteps_?this.createStepText(a,t,!1,e,r):"")+"</div>"),a===this.scaleBarSteps_-1&&i.push(this.createStepText(a+1,t,!0,e,r)),s="#ffffff"===s?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"")+i.join("")+"</div>"},e.prototype.createMarker=function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'},e.prototype.createStepText=function(t,e,r,n,i){var o=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+i);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(r?e+"px":"unset")+';">'+o+"</div>"},e.prototype.getScaleForResolution=function(){var t=me(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center),e=this.dpi_||RP,r=this.viewState_.projection.getMetersPerUnit();return parseFloat(t.toString())*r*(1e3/25.4)*e},e.prototype.render=function(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()},e}(Xc);function MP(t){return(MP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kP(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NP(t,e){return(NP=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function AP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=DP(t);if(e){var i=DP(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return FP(this,r)}}function FP(t,e){return!e||"object"!==MP(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function DP(t){return(DP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jP="units",GP="degrees",zP="imperial",UP="nautical",BP="metric",VP="us",qP=[1,2,5],YP=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&NP(t,e)}(o,t);var e,r,n,i=AP(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).facadeMap_=null,e.keyEvent_=null,e}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.removeChangeListener(jP,this.handleUnitsChanged),this.keyEvent_=this.addChangeListener(jP,this.handleUnitsChanged),t.getMapImpl().addControl(this)}},{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}},{key:"handleUnitsChanged_",value:function(){this.updateElement_()}},{key:"updateElement_",value:function(){var t=this.viewState_;if(t){var e=t.center,r=t.projection,n=this.getUnits(),i=n===GP?d.DEGREES:d.METERS,o=me(r,t.resolution,e,i);r.getUnits()!==d.DEGREES&&r.getMetersPerUnit()&&i===d.METERS&&(o*=r.getMetersPerUnit()),"d"===r.getUnits()&&(o/=12e4);var s=this.minWidth_*o,a="";if(n===GP){var l=p[d.DEGREES];r.getUnits()===d.DEGREES?s*=l:o/=l,s<l/60?(a="″",o*=3600):s<l?(a="′",o*=60):a="°"}else n===zP?s<.9144?(a="in",o/=.0254):s<1609.344?(a="ft",o/=.3048):(a="mi",o/=1609.344):n===UP?(o/=1852,a="nm"):n===BP?s<.001?(a="μm",o*=1e6):s<1?(a="mm",o*=1e3):s<1e3?a="m":(a="km",o/=1e3):n===VP?s<.9144?(a="in",o*=39.37):s<1609.344?(a="ft",o/=.30480061):(a="mi",o/=1609.3472):ut(!1,33);for(var u,c,h=3*Math.floor(Math.log(this.minWidth_*o)/Math.log(10));;){if(u=qP[(h%3+3)%3]*Math.pow(10,Math.floor(h/3)),c=Math.round(u/o),Number.isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(c>=this.minWidth_)break;h+=1}var f=u.toString().concat(" ").concat(a);this.renderedHTML_!==f&&(this.innerElement_.innerHTML=f,this.renderedHTML_=f),this.renderedWidth_!==c&&(this.innerElement_.style.width=c.toString().concat("px"),this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}}])&&kP(e.prototype,r),n&&kP(e,n),o}(LP),WP=r(42),XP=r.n(WP);function HP(t){return(HP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ZP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KP(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $P(t,e){return($P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function JP(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=tR(t);if(e){var i=tR(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return QP(this,r)}}function QP(t,e){return!e||"object"!==HP(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tR(t){return(tR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eR=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$P(t,e)}(o,t);var e,r,n,i=JP(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ZP(this,o);var r=new YP(e);return t=i.call(this,r,o.NAME),dV(YP)&&Of(pp("exception").scaleline_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(XP.a)}},{key:"equals",value:function(t){var e=t instanceof o;return e}}])&&KP(e.prototype,r),n&&KP(e,n),o}(bp);eR.NAME="scaleline";var rR=eR,nR=(r(92),r(43)),iR=r.n(nR),oR=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sR="projection",aR="coordinateFormat",lR=function(t){function e(e){var r=this,n=e||{},i=document.createElement("div");i.className=void 0!==n.className?n.className:"ol-mouse-position",(r=t.call(this,{element:i,render:n.render,target:n.target})||this).on,r.once,r.un,r.addChangeListener(sR,r.handleProjectionChanged_),n.coordinateFormat&&r.setCoordinateFormat(n.coordinateFormat),n.projection&&r.setProjection(n.projection);var o=!0,s="&#160;";return"undefinedHTML"in n?(void 0!==n.undefinedHTML&&(s=n.undefinedHTML),o=!!s):"placeholder"in n&&(!1===n.placeholder?o=!1:s=String(n.placeholder)),r.placeholder_=s,r.renderOnMouseOut_=o,r.renderedHTML_=i.innerHTML,r.mapProjection_=null,r.transform_=null,r}return oR(e,t),e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get(aR)},e.prototype.getProjection=function(){return this.get(sR)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},e.prototype.handleMouseOut=function(t){this.updateHTML_(null)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var r=e.getViewport();this.listenerKeys.push(fa(r,Hl,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(fa(r,$l,this.handleMouseOut,this)),this.updateHTML_(null)}},e.prototype.setCoordinateFormat=function(t){this.set(aR,t)},e.prototype.setProjection=function(t){this.set(sR,ye(t))},e.prototype.updateHTML_=function(t){var e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();this.transform_=r?Se(this.mapProjection_,r):de}var n=this.getMap().getCoordinateFromPixelInternal(t);if(n){var i=Me();i&&(this.transform_=Se(this.mapProjection_,i)),this.transform_(n,n);var o=this.getCoordinateFormat();e=o?o(n):n.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e.prototype.render=function(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null},e}(Xc);function uR(t){return(uR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hR(t,e){return(hR=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fR(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dR(t);if(e){var i=dR(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return pR(this,r)}}function pR(t,e){return!e||"object"!==uR(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dR(t){return(dR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gR(t){return(gR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mR(t,e){return(mR=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bR(t);if(e){var i=bR(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vR(this,r)}}function vR(t,e){return!e||"object"!==gR(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bR(t){return(bR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wR=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mR(t,e)}(o,t);var e,r,n,i=_R(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=GV({coordinateFormat:ee(t.precision||4),label:t.label,undefinedHTML:"",className:"m-mouse-position g-cartografia-flecha"},e,!0);return(r=i.call(this,n)).srs_=t.srs,r.label_=t.label,r.precision_=t.precision,r.vendorOptions_=e,r}return e=o,(r=[{key:"addTo",value:function(t,e){var r=this;this.facadeMap_=t,this.setProjection(this.srs_||t.getProjection().code),this.setTarget(e),t.getMapImpl().addControl(this),_V(this.vendorOptions_.projection)&&_V(this.srs_)&&t.getImpl().on(np,(function(){r.mousePositionControl.setProjection(ye(t.getProjection().code))}))}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&yR(e.prototype,r),n&&yR(e,n),o}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hR(t,e)}(o,t);var e,r,n,i=fR(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).vendorOptions_=t,e}return e=o,(r=[{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}},{key:"handleMouseMove",value:function(t){var e=this.getMap();this.lastMouseMovePixel_=e.getEventPixel(t),this.updateHTML_(this.lastMouseMovePixel_)}},{key:"handleMouseOut",value:function(t){this.updateHTML_(null),this.lastMouseMovePixel_=null}},{key:"updateHTML_",value:function(t){var e=this.undefinedHTML_,r=this.getProjection();if(t&&this.mapProjection_){this.transform_||(this.transform_=r?Ie(this.mapProjection_,r):de);var n=this.getMap().getCoordinateFromPixel(t);if(n){this.transform_(n,n);var i=this.getCoordinateFormat();e=i?i(n):n.toString()}this.vendorOptions_.label&&(e+=" | ".concat(this.vendorOptions_.label))}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=void 0!==e?e:"",this.renderedHTML_=void 0!==e?e:"")}}])&&cR(e.prototype,r),n&&cR(e,n),o}(lR));function xR(t){return(xR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ER(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function IR(t,e,r){return(IR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=PR(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function OR(t,e){return(OR=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function CR(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=PR(t);if(e){var i=PR(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return TR(this,r)}}function TR(t,e){return!e||"object"!==xR(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function PR(t){return(PR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RR=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&OR(t,e)}(o,t);var e,r,n,i=CR(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ER(this,o);var n=new wR(e,r);return t=i.call(this,n,o.NAME),dV(wR)&&Of(pp("exception").mouse_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(iR.a)}},{key:"equals",value:function(t){return t instanceof o}},{key:"destroy",value:function(){IR(PR(o.prototype),"destroy",this).call(this);var t=this.getPanel();_V(t)||t.removeClassName("m-with-mouse")}}])&&SR(e.prototype,r),n&&SR(e,n),o}(bp);RR.NAME="mouse";var LR=RR,MR=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kR=.75,NR=.1,AR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return MR(e,t),e.prototype.createRenderer=function(){return new kl(this)},e}(Yc),FR=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this).boundHandleRotationChanged_=r.handleRotationChanged_.bind(r),r.collapsed_=void 0===n.collapsed||n.collapsed,r.collapsible_=void 0===n.collapsible||n.collapsible,r.collapsible_||(r.collapsed_=!1),r.rotateWithView_=void 0!==n.rotateWithView&&n.rotateWithView,r.viewExtent_=void 0;var i=void 0!==n.className?n.className:"ol-overviewmap",o=void 0!==n.tipLabel?n.tipLabel:"Overview map",s=void 0!==n.collapseLabel?n.collapseLabel:"‹";"string"==typeof s?(r.collapseLabel_=document.createElement("span"),r.collapseLabel_.textContent=s):r.collapseLabel_=s;var a=void 0!==n.label?n.label:"›";"string"==typeof a?(r.label_=document.createElement("span"),r.label_.textContent=a):r.label_=a;var l=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_,u=document.createElement("button");u.setAttribute("type","button"),u.title=o,u.appendChild(l),u.addEventListener(ea,r.handleClick_.bind(r),!1),r.ovmapDiv_=document.createElement("div"),r.ovmapDiv_.className="ol-overviewmap-map",r.view_=n.view,r.ovmap_=new AR({view:n.view});var c=r.ovmap_;n.layers&&n.layers.forEach((function(t){c.addLayer(t)}));var h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",r.boxOverlay_=new nO({position:[0,0],positioning:YI,element:h}),r.ovmap_.addOverlay(r.boxOverlay_);var f=i+" "+"ol-unselectable "+Qa+(r.collapsed_&&r.collapsible_?" ol-collapsed":"")+(r.collapsible_?"":" ol-uncollapsible"),p=r.element;p.className=f,p.appendChild(r.ovmapDiv_),p.appendChild(u);var d=r,g=r.boxOverlay_,y=r.boxOverlay_.getElement(),m=function(t){var e,r={clientX:(e=t).clientX,clientY:e.clientY},n=c.getEventCoordinateInternal(r);g.setPosition(n)},_=function t(e){var r=c.getEventCoordinateInternal(e);d.getMap().getView().setCenterInternal(r),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",t)};return y.addEventListener("mousedown",(function(){window.addEventListener("mousemove",m),window.addEventListener("mouseup",_)})),r}return MR(e,t),e.prototype.setMap=function(e){var r=this.getMap();if(e!==r){if(r){var n=r.getView();n&&this.unbindView_(n),this.ovmap_.setTarget(null)}if(t.prototype.setMap.call(this,e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(fa(e,Hs,this.handleMapPropertyChange_,this));var i=e.getView();i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}},e.prototype.handleMapPropertyChange_=function(t){if(t.key===su){var e=t.oldValue;e&&this.unbindView_(e);var r=this.getMap().getView();this.bindView_(r)}else this.ovmap_.isRendered()||t.key!==ou&&t.key!==iu||this.ovmap_.updateSize()},e.prototype.bindView_=function(t){if(!this.view_){var e=new Gc({projection:t.getProjection()});this.ovmap_.setView(e)}t.addChangeListener(bu,this.boundHandleRotationChanged_),this.handleRotationChanged_()},e.prototype.unbindView_=function(t){t.removeChangeListener(bu,this.boundHandleRotationChanged_)},e.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},e.prototype.validateExtent_=function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var r=t.getSize(),n=t.getView().calculateExtentInternal(r);if(!this.viewExtent_||!Et(n,this.viewExtent_)){this.viewExtent_=n;var i=e.getSize(),o=e.getView().calculateExtentInternal(i),s=e.getPixelFromCoordinateInternal(Dt(n)),a=e.getPixelFromCoordinateInternal(Lt(n)),l=Math.abs(s[0]-a[0]),u=Math.abs(s[1]-a[1]),c=i[0],h=i[1];l<c*NR||u<h*NR||l>c*kR||u>h*kR?this.resetExtent_():gt(o,n)||this.recenter_()}}},e.prototype.resetExtent_=function(){var t=this.getMap(),e=this.ovmap_,r=t.getSize(),n=t.getView().calculateExtentInternal(r),i=e.getView(),o=Math.log(7.5)/Math.LN2;Bt(n,1/(Math.pow(2,o/2)*NR)),i.fitInternal(Mc(n))},e.prototype.recenter_=function(){var t=this.getMap(),e=this.ovmap_,r=t.getView();e.getView().setCenterInternal(r.getCenterInternal())},e.prototype.updateBox_=function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var r=t.getSize(),n=t.getView(),i=e.getView(),o=this.rotateWithView_?0:-n.getRotation(),s=this.boxOverlay_,a=this.boxOverlay_.getElement(),l=n.getCenterInternal(),u=n.getResolution(),c=i.getResolution(),h=r[0]*u/c,f=r[1]*u/c;if(s.setPosition(l),a){a.style.width=h+"px",a.style.height=f+"px";var p="rotate("+o+"rad)";a.style.transform=p}}},e.prototype.updateBoxAfterOvmapIsRendered_=function(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=pa(this.ovmap_,tu,(function(t){delete this.ovmapPostrenderKey_,this.updateBox_()}),this))},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(tl),this.collapsed_?ll(this.collapseLabel_,this.label_):ll(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var t=this.ovmap_;if(!this.collapsed_){if(t.isRendered())return this.viewExtent_=void 0,void t.render();t.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.getRotateWithView=function(){return this.rotateWithView_},e.prototype.setRotateWithView=function(t){this.rotateWithView_!==t&&(this.rotateWithView_=t,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},e.prototype.getOverviewMap=function(){return this.ovmap_},e.prototype.render=function(t){this.validateExtent_(),this.updateBox_()},e}(Xc);function DR(t){return(DR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zR(t,e){return(zR=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function UR(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=VR(t);if(e){var i=VR(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return BR(this,r)}}function BR(t,e){return!e||"object"!==DR(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function VR(t){return(VR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qR=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zR(t,e)}(o,t);var e,r,n,i=UR(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jR(this,o),(e=i.call(this,GV({layers:[]},r,!0))).toggleDelay_=0,_V(t.toggleDelay)||(e.toggleDelay_=t.toggleDelay),e.collapsedButtonClass_="g-cartografia-mundo",_V(t.collapsedButtonClass)||(e.collapsedButtonClass_=t.collapsedButtonClass),e.openedButtonClass_="g-cartografia-flecha-derecha2",_V(t.openedButtonClass)||(e.openedButtonClass_=t.openedButtonClass),e.facadeMap_=null,e}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.update(t,e),this.getCollapsed()||this.addLayers(this.facadeMap_)}},{key:"update",value:function(t,e){var r=this.element.querySelector("button");!0===this.collapsed_?r.classList.contains(this.collapsedButtonClass_)?r.classList.remove(this.collapsedButtonClass_):r.classList.add(this.collapsedButtonClass_):r.classList.contains(this.openedButtonClass_)?r.classList.remove(this.openedButtonClass_):r.classList.add(this.openedButtonClass_),this.addOpenEventListener(r,t),this.setTarget()}},{key:"addOpenEventListener",value:function(t,e){t.onclick=this.openEventListener.bind(this)}},{key:"openEventListener",value:function(t){var e=t;!0===this.getCollapsed()&&(this.addLayers(this.facadeMap_),e.target.onclick=null)}},{key:"setTarget",value:function(){var t=this.facadeControl_;if(!_V(t)){var e=t.getPanel();_V(e)||(this.target_=e.getControlsContainer())}}},{key:"getElement",value:function(){return this.element}},{key:"addLayer_",value:function(t){t.un(Af,this.addLayer_,this),this.getOverviewMap().addLayer(t.getOLLayer())}},{key:"addLayers",value:function(t){var e=this,r=[];t.getLayers().forEach((function(t){if((t.type===Dp||!1===t.transparent)&&t.isVisible()){var n=t.getImpl().cloneOLLayer();_V(n)?t.getImpl().on(Af,e.addLayer_.bind(e)):r.push(n)}}));var n=new $_({projection:ye(t.getProjection().code),resolutions:t.getResolutions()});t.getMapImpl().addControl(this),this.ovmap_.setView(n),r.forEach((function(t){return e.ovmap_.addLayer(t)})),this.wasOpen_=!0}},{key:"handleToggle_",value:function(){var t=this;tq(this.element,"ol-collapsed");var e=this.element.querySelector("button");tq(e,this.openedButtonClass_),tq(e,this.collapsedButtonClass_),setTimeout((function(){t.collapsed_?eq(t.collapseLabel_,t.label_):eq(t.label_,t.collapseLabel_),t.collapsed_=!t.collapsed_;var e=t.ovmap_;t.collapsed_||e.isRendered()||(e.updateSize(),t.resetExtent_(),e.addEventListener("postrender",(function(e){t.updateBox_()})))}),this.toggleDelay_)}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}},{key:"facadeControl",set:function(t){this.facadeControl_=t},get:function(){return this.facadeControl_}}])&&GR(e.prototype,r),n&&GR(e,n),o}(FR),YR=r(44),WR=r.n(YR);function XR(t){return(XR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function KR(t,e){return(KR=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=tL(t);if(e){var i=tL(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return JR(this,r)}}function JR(t,e){return!e||"object"!==XR(e)&&"function"!=typeof e?QR(t):e}function QR(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tL(t){return(tL=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eL=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KR(t,e)}(o,t);var e,r,n,i=$R(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};HR(this,o);var n=new qR(e,r);return t=i.call(this,n,o.NAME),dV(qR)&&Of(pp("exception").overviewmap_method),n.facadeControl=QR(t),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(WR.a)}},{key:"equals",value:function(t){var e=t instanceof o;return e}}])&&ZR(e.prototype,r),n&&ZR(e,n),o}(bp);eL.NAME="overviewmap";var rL=eL;function nL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var iL=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element_=null}var e,r,n;return e=t,(r=[{key:"addTo",value:function(t,e){this.element_=e}},{key:"getElement",value:function(){return this.element_}},{key:"destroy",value:function(){}}])&&nL(e.prototype,r),n&&nL(e,n),t}(),oL=r(45),sL=r.n(oL);function aL(t){return(aL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uL(t,e){return(uL=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fL(t);if(e){var i=fL(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hL(this,r)}}function hL(t,e){return!e||"object"!==aL(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fL(t){return(fL=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pL=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uL(t,e)}(o,t);var e,r,n,i=cL(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new iL;return t=i.call(this,e,o.NAME),dV(iL)&&Of(pp("exception").navtoolbar_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(sL.a)}},{key:"equals",value:function(t){var e=t instanceof o;return e}}])&&lL(e.prototype,r),n&&lL(e,n),o}(bp);pL.NAME="navtoolbar";var dL=pL,gL=r(46),yL=r.n(gL);function mL(t){return(mL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vL(t,e){return(vL=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xL(t);if(e){var i=xL(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wL(this,r)}}function wL(t,e){return!e||"object"!==mL(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xL(t){return(xL=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var EL=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vL(t,e)}(o,t);var e,r,n,i=bL(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).facadeMap_=null,e}return e=o,(r=[{key:"addTo",value:function(t,e){this.facadeMap_=t,t.getMapImpl().addControl(this)}},{key:"getElement",value:function(){return this.element}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null}}])&&_L(e.prototype,r),n&&_L(e,n),o}(Qc);function SL(t){return(SL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CL(t,e){return(CL=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function TL(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=RL(t);if(e){var i=RL(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return PL(this,r)}}function PL(t,e){return!e||"object"!==SL(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function RL(t){return(RL=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var LL=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&CL(t,e)}(o,t);var e,r,n,i=TL(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};IL(this,o);var r=new EL(e);return t=i.call(this,r,o.NAME),dV(EL)&&Of(pp("exception").panzoom_method),t}return e=o,(r=[{key:"createView",value:function(t){return Sp(yL.a)}},{key:"equals",value:function(t){var e=t instanceof o;return e}}])&&OL(e.prototype,r),n&&OL(e,n),o}(bp);LL.NAME="panzoom";var ML=LL,kL=(r(94),function(){function t(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return t.prototype.getReadOptions=function(t,e){var r;if(e){var n=e.dataProjection?ye(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()===d.TILE_PIXELS&&(n=ye(n)).setWorldExtent(e.extent),r={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(r)},t.prototype.adaptOptions=function(t){return V({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return Object(st.b)()},t.prototype.readFeature=function(t,e){return Object(st.b)()},t.prototype.readFeatures=function(t,e){return Object(st.b)()},t.prototype.readGeometry=function(t,e){return Object(st.b)()},t.prototype.readProjection=function(t){return Object(st.b)()},t.prototype.writeFeature=function(t,e){return Object(st.b)()},t.prototype.writeFeatures=function(t,e){return Object(st.b)()},t.prototype.writeGeometry=function(t,e){return Object(st.b)()},t}());function NL(t,e,r){var n,i=r?ye(r.featureProjection):null,o=r?ye(r.dataProjection):null;if(n=i&&o&&!Ee(i,o)?(e?t.clone():t).transform(e?i:o,e?o:i):t,e&&r&&void 0!==r.decimals){var s=Math.pow(10,r.decimals);n===t&&(n=t.clone()),n.applyTransform((function(t){for(var e=0,r=t.length;e<r;++e)t[e]=Math.round(t[e]*s)/s;return t}))}return n}function AL(t,e){var r=e?ye(e.featureProjection):null,n=e?ye(e.dataProjection):null;return r&&n&&!Ee(r,n)?Ce(t,n,r):t}var FL=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),DL=function(t){function e(){var e=t.call(this)||this;return e.xmlSerializer_=(void 0===gr&&"undefined"!=typeof XMLSerializer&&(gr=new XMLSerializer),gr),e}return FL(e,t),e.prototype.getType=function(){return Rb},e.prototype.readFeature=function(t,e){if(t){if("string"==typeof t){var r=Qe(t);return this.readFeatureFromDocument(r,e)}return Je(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}return null},e.prototype.readFeatureFromDocument=function(t,e){var r=this.readFeaturesFromDocument(t,e);return r.length>0?r[0]:null},e.prototype.readFeatureFromNode=function(t,e){return null},e.prototype.readFeatures=function(t,e){if(t){if("string"==typeof t){var r=Qe(t);return this.readFeaturesFromDocument(r,e)}return Je(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}return[]},e.prototype.readFeaturesFromDocument=function(t,e){for(var r=[],n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&qe(r,this.readFeaturesFromNode(n,e));return r},e.prototype.readFeaturesFromNode=function(t,e){return Object(st.b)()},e.prototype.readGeometry=function(t,e){if(t){if("string"==typeof t){var r=Qe(t);return this.readGeometryFromDocument(r,e)}return Je(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}return null},e.prototype.readGeometryFromDocument=function(t,e){return null},e.prototype.readGeometryFromNode=function(t,e){return null},e.prototype.readProjection=function(t){if(t){if("string"==typeof t){var e=Qe(t);return this.readProjectionFromDocument(e)}return Je(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}return null},e.prototype.readProjectionFromDocument=function(t){return this.dataProjection},e.prototype.readProjectionFromNode=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,e){var r=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(r)},e.prototype.writeFeatureNode=function(t,e){return null},e.prototype.writeFeatures=function(t,e){var r=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(r)},e.prototype.writeFeaturesNode=function(t,e){return null},e.prototype.writeGeometry=function(t,e){var r=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(r)},e.prototype.writeGeometryNode=function(t,e){return null},e}(kL),jL=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),GL="http://www.opengis.net/gml",zL=/^[\s\xa0]*$/,UL=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.featureType=n.featureType,r.featureNS=n.featureNS,r.srsName=n.srsName,r.schemaLocation="",r.FEATURE_COLLECTION_PARSERS={},r.FEATURE_COLLECTION_PARSERS[r.namespace]={featureMember:er(r.readFeaturesInternal),featureMembers:rr(r.readFeaturesInternal)},r.supportedMediaTypes=["application/gml+xml"],r}return jL(e,t),e.prototype.readFeaturesInternal=function(t,e){var r=t.localName,n=null;if("FeatureCollection"==r)n=fr([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if("featureMembers"==r||"featureMember"==r||"member"==r){var i=e[0],o=i.featureType,s=i.featureNS;if(!o&&t.childNodes){o=[],s={};for(var a=0,l=t.childNodes.length;a<l;++a){var u=t.childNodes[a];if(1===u.nodeType){var c=u.nodeName.split(":").pop();if(-1===o.indexOf(c)){var h="",f=0,p=u.namespaceURI;for(var d in s){if(s[d]===p){h=d;break}++f}h||(s[h="p"+f]=p),o.push(h+":"+c)}}}"featureMember"!=r&&(i.featureType=o,i.featureNS=s)}if("string"==typeof s){var g=s;(s={}).p0=g}var y={},m=Array.isArray(o)?o:[o];for(var _ in s){var v={};for(a=0,l=m.length;a<l;++a){(-1===m[a].indexOf(":")?"p0":m[a].split(":")[0])===_&&(v[m[a].split(":").pop()]="featureMembers"==r?er(this.readFeatureElement,this):rr(this.readFeatureElement,this))}y[s[_]]=v}n=fr("featureMember"==r||"member"==r?void 0:[],y,t,e)}return null===n&&(n=[]),n},e.prototype.readGeometryElement=function(t,e){var r=e[0];r.srsName=t.firstElementChild.getAttribute("srsName"),r.srsDimension=t.firstElementChild.getAttribute("srsDimension");var n=fr(null,this.GEOMETRY_PARSERS,t,e,this);return n?Array.isArray(n)?AL(n,r):NL(n,!1,r):void 0},e.prototype.readFeatureElementInternal=function(t,e,r){for(var n,i={},o=t.firstElementChild;o;o=o.nextElementSibling){var s=void 0,a=o.localName;0===o.childNodes.length||1===o.childNodes.length&&(3===o.firstChild.nodeType||4===o.firstChild.nodeType)?(s=Ke(o,!1),zL.test(s)&&(s=void 0)):(r&&(s=this.readGeometryElement(o,e)),s?"boundedBy"!==a&&(n=a):s=this.readFeatureElementInternal(o,e,!1)),i[a]?(i[a]instanceof Array||(i[a]=[i[a]]),i[a].push(s)):i[a]=s;var l=o.attributes.length;if(l>0){i[a]={_content_:i[a]};for(var u=0;u<l;u++){var c=o.attributes[u].name;i[a][c]=o.attributes[u].value}}}if(r){var h=new Cg(i);n&&h.setGeometryName(n);var f=t.getAttribute("fid")||function(t,e,r){return t.getAttributeNS(e,r)||""}(t,this.namespace,"id");return f&&h.setId(f),h}return i},e.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,!0)},e.prototype.readPoint=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);if(r)return new dc(r,Au)},e.prototype.readMultiPoint=function(t,e){var r=fr([],this.MULTIPOINT_PARSERS,t,e,this);return r?new jg(r):void 0},e.prototype.readMultiLineString=function(t,e){var r=fr([],this.MULTILINESTRING_PARSERS,t,e,this);if(r)return new zg(r)},e.prototype.readMultiPolygon=function(t,e){var r=fr([],this.MULTIPOLYGON_PARSERS,t,e,this);if(r)return new Bg(r)},e.prototype.pointMemberParser=function(t,e){hr(this.POINTMEMBER_PARSERS,t,e,this)},e.prototype.lineStringMemberParser=function(t,e){hr(this.LINESTRINGMEMBER_PARSERS,t,e,this)},e.prototype.polygonMemberParser=function(t,e){hr(this.POLYGONMEMBER_PARSERS,t,e,this)},e.prototype.readLineString=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);return r?new Fg(r,Au):void 0},e.prototype.readFlatLinearRing=function(t,e){var r=fr(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);return r||void 0},e.prototype.readLinearRing=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);if(r)return new fc(r,Au)},e.prototype.readPolygon=function(t,e){var r=fr([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(r&&r[0]){var n,i=r[0],o=[i.length],s=void 0;for(s=1,n=r.length;s<n;++s)qe(i,r[s]),o.push(i.length);return new Rc(i,Au,o)}},e.prototype.readFlatCoordinatesFromNode=function(t,e){return fr(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.readGeometryFromNode=function(t,e){var r=this.readGeometryElement(t,[this.getReadOptions(t,e||{})]);return r||null},e.prototype.readFeaturesFromNode=function(t,e){var r={featureType:this.featureType,featureNS:this.featureNS};return e&&V(r,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[r])||[]},e.prototype.readProjectionFromNode=function(t){return ye(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},e}(DL);UL.prototype.namespace=GL,UL.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},UL.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},UL.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},UL.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:er(UL.prototype.pointMemberParser),pointMembers:er(UL.prototype.pointMemberParser)}},UL.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:er(UL.prototype.lineStringMemberParser),lineStringMembers:er(UL.prototype.lineStringMemberParser)}},UL.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:er(UL.prototype.polygonMemberParser),polygonMembers:er(UL.prototype.polygonMemberParser)}},UL.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:er(UL.prototype.readFlatCoordinatesFromNode)}},UL.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:er(UL.prototype.readLineString)}},UL.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:er(UL.prototype.readPolygon)}},UL.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:rr(UL.prototype.readFlatLinearRing)}};var BL=UL,VL=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qL={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},YL=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,n)||this).FEATURE_COLLECTION_PARSERS[GL].featureMember=er(r.readFeaturesInternal),r.schemaLocation=n.schemaLocation?n.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",r}return VL(e,t),e.prototype.readFlatCoordinates=function(t,e){var r=Ke(t,!1).replace(/^\s*|\s*$/g,""),n=e[0].srsName,i="enu";if(n){var o=ye(n);o&&(i=o.getAxisOrientation())}for(var s=r.trim().split(/\s+/),a=[],l=0,u=s.length;l<u;l++){var c=s[l].split(/,+/),h=parseFloat(c[0]),f=parseFloat(c[1]),p=3===c.length?parseFloat(c[2]):0;"en"===i.substr(0,2)?a.push(h,f,p):a.push(f,h,p)}return a},e.prototype.readBox=function(t,e){var r=fr([null],this.BOX_PARSERS_,t,e,this);return vt(r[1][0],r[1][1],r[1][3],r[1][4])},e.prototype.innerBoundaryIsParser=function(t,e){var r=fr(void 0,this.RING_PARSERS,t,e,this);r&&e[e.length-1].push(r)},e.prototype.outerBoundaryIsParser=function(t,e){var r=fr(void 0,this.RING_PARSERS,t,e,this);r&&(e[e.length-1][0]=r)},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,r){var n,i=e[e.length-1],o=i.multiSurface,s=i.surface,a=i.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===o?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"MultiLineString"===n&&!0===a&&(n="MultiCurve"),Ze("http://www.opengis.net/gml",n)},e.prototype.writeFeatureElement=function(t,e,r){var n=e.getId();n&&t.setAttribute("fid",n);var i=r[r.length-1],o=i.featureNS,s=e.getGeometryName();i.serializers||(i.serializers={},i.serializers[o]={});var a=[],l=[];if(e.hasProperties()){var u=e.getProperties();for(var c in u){var h=u[c];null!==h&&(a.push(c),l.push(h),c==s||"function"==typeof h.getSimplifiedGeometry?c in i.serializers[o]||(i.serializers[o][c]=or(this.writeGeometryElement,this)):c in i.serializers[o]||(i.serializers[o][c]=or(Lr)))}}var f=V({},i);f.node=t,dr(f,i.serializers,ar(void 0,o),l,r,a)},e.prototype.writeCurveOrLineString=function(t,e,r){var n=r[r.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var i=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(i),this.writeCoordinates_(i,e,r)}else if("Curve"===t.nodeName){var o=Ze(t.namespaceURI,"segments");t.appendChild(o),this.writeCurveSegments_(o,e,r)}},e.prototype.writeLineStringOrCurveMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,r))},e.prototype.writeMultiCurveOrLineString=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,s=n.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();dr({node:t,hasZ:i,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,r,void 0,this)},e.prototype.writeGeometryElement=function(t,e,r){var n,i=r[r.length-1],o=V({},i);o.node=t,n=Array.isArray(e)?AL(e,i):NL(e,!0,i),dr(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],r,void 0,this)},e.prototype.createCoordinatesNode_=function(t){var e=Ze(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e},e.prototype.writeCoordinates_=function(t,e,r){for(var n=r[r.length-1],i=n.hasZ,o=n.srsName,s=e.getCoordinates(),a=s.length,l=new Array(a),u=0;u<a;++u){var c=s[u];l[u]=this.getCoords_(c,o,i)}Lr(t,l.join(" "))},e.prototype.writeCurveSegments_=function(t,e,r){var n=Ze(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,r)},e.prototype.writeSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();dr({node:t,hasZ:i,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,s,r,void 0,this)}else if("Surface"===t.nodeName){var a=Ze(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,r)}},e.prototype.RING_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1],i=n.node,o=n.exteriorWritten;return void 0===o&&(n.exteriorWritten=!0),Ze(i.namespaceURI,void 0!==o?"innerBoundaryIs":"outerBoundaryIs")},e.prototype.writeSurfacePatches_=function(t,e,r){var n=Ze(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,r)},e.prototype.writeRing=function(t,e,r){var n=Ze(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,r)},e.prototype.getCoords_=function(t,e,r){var n="enu";e&&(n=ye(e).getAxisOrientation());var i="en"===n.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];r&&(i+=","+(t[2]||0));return i},e.prototype.writePoint=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);var s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s);var a=e.getCoordinates();Lr(s,this.getCoords_(a,o,i))},e.prototype.writeMultiPoint=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;o&&t.setAttribute("srsName",o);var s=e.getPoints();dr({node:t,hasZ:i,srsName:o},this.POINTMEMBER_SERIALIZERS,ar("pointMember"),s,r,void 0,this)},e.prototype.writePointMember=function(t,e,r){var n=Ze(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,r)},e.prototype.writeLinearRing=function(t,e,r){var n=r[r.length-1].srsName;n&&t.setAttribute("srsName",n);var i=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(i),this.writeCoordinates_(i,e,r)},e.prototype.writeMultiSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,s=n.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();dr({node:t,hasZ:i,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,r,void 0,this)},e.prototype.writeSurfaceOrPolygonMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,r))},e.prototype.writeEnvelope=function(t,e,r){var n=r[r.length-1].srsName;n&&t.setAttribute("srsName",n);var i=[e[0]+" "+e[1],e[2]+" "+e[3]];dr({node:t},this.ENVELOPE_SERIALIZERS,lr,i,r,["lowerCorner","upperCorner"],this)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1].node;return Ze("http://www.opengis.net/gml",qL[n.nodeName])},e}(BL);YL.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:rr(YL.prototype.readFlatCoordinates)}},YL.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:YL.prototype.innerBoundaryIsParser,outerBoundaryIs:YL.prototype.outerBoundaryIsParser}},YL.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:er(YL.prototype.readFlatCoordinates)}},YL.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:rr(BL.prototype.readPoint),MultiPoint:rr(BL.prototype.readMultiPoint),LineString:rr(BL.prototype.readLineString),MultiLineString:rr(BL.prototype.readMultiLineString),LinearRing:rr(BL.prototype.readLinearRing),Polygon:rr(BL.prototype.readPolygon),MultiPolygon:rr(BL.prototype.readMultiPolygon),Box:rr(YL.prototype.readBox)}},YL.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:or(YL.prototype.writeCurveOrLineString),MultiCurve:or(YL.prototype.writeMultiCurveOrLineString),Point:or(YL.prototype.writePoint),MultiPoint:or(YL.prototype.writeMultiPoint),LineString:or(YL.prototype.writeCurveOrLineString),MultiLineString:or(YL.prototype.writeMultiCurveOrLineString),LinearRing:or(YL.prototype.writeLinearRing),Polygon:or(YL.prototype.writeSurfaceOrPolygon),MultiPolygon:or(YL.prototype.writeMultiSurfaceOrPolygon),Surface:or(YL.prototype.writeSurfaceOrPolygon),MultiSurface:or(YL.prototype.writeMultiSurfaceOrPolygon),Envelope:or(YL.prototype.writeEnvelope)}},YL.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:or(YL.prototype.writeLineStringOrCurveMember),curveMember:or(YL.prototype.writeLineStringOrCurveMember)}},YL.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:or(YL.prototype.writeRing),innerBoundaryIs:or(YL.prototype.writeRing)}},YL.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:or(YL.prototype.writePointMember)}},YL.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:or(YL.prototype.writeSurfaceOrPolygonMember),polygonMember:or(YL.prototype.writeSurfaceOrPolygonMember)}},YL.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:or(Lr),upperCorner:or(Lr)}};var WL=YL,XL=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),HL={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},ZL=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,n)||this).surface_=void 0!==n.surface&&n.surface,r.curve_=void 0!==n.curve&&n.curve,r.multiCurve_=void 0===n.multiCurve||n.multiCurve,r.multiSurface_=void 0===n.multiSurface||n.multiSurface,r.schemaLocation=n.schemaLocation?n.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",r.hasZ=void 0!==n.hasZ&&n.hasZ,r}return XL(e,t),e.prototype.readMultiCurve=function(t,e){var r=fr([],this.MULTICURVE_PARSERS,t,e,this);return r?new zg(r):void 0},e.prototype.readMultiSurface=function(t,e){var r=fr([],this.MULTISURFACE_PARSERS,t,e,this);if(r)return new Bg(r)},e.prototype.curveMemberParser=function(t,e){hr(this.CURVEMEMBER_PARSERS,t,e,this)},e.prototype.surfaceMemberParser=function(t,e){hr(this.SURFACEMEMBER_PARSERS,t,e,this)},e.prototype.readPatch=function(t,e){return fr([null],this.PATCHES_PARSERS,t,e,this)},e.prototype.readSegment=function(t,e){return fr([null],this.SEGMENTS_PARSERS,t,e,this)},e.prototype.readPolygonPatch=function(t,e){return fr([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)},e.prototype.readLineStringSegment=function(t,e){return fr([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.interiorParser=function(t,e){var r=fr(void 0,this.RING_PARSERS,t,e,this);r&&e[e.length-1].push(r)},e.prototype.exteriorParser=function(t,e){var r=fr(void 0,this.RING_PARSERS,t,e,this);r&&(e[e.length-1][0]=r)},e.prototype.readSurface=function(t,e){var r=fr([null],this.SURFACE_PARSERS,t,e,this);if(r&&r[0]){var n,i=r[0],o=[i.length],s=void 0;for(s=1,n=r.length;s<n;++s)qe(i,r[s]),o.push(i.length);return new Rc(i,Au,o)}},e.prototype.readCurve=function(t,e){var r=fr([null],this.CURVE_PARSERS,t,e,this);return r?new Fg(r,Au):void 0},e.prototype.readEnvelope=function(t,e){var r=fr([null],this.ENVELOPE_PARSERS,t,e,this);return vt(r[1][0],r[1][1],r[2][0],r[2][1])},e.prototype.readFlatPos=function(t,e){for(var r,n=Ke(t,!1),i=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];r=i.exec(n);)o.push(parseFloat(r[1])),n=n.substr(r[0].length);if(""===n){var s=e[0].srsName,a="enu";if(s)a=ye(s).getAxisOrientation();if("neu"===a){var l,u=void 0;for(u=0,l=o.length;u<l;u+=3){var c=o[u],h=o[u+1];o[u]=h,o[u+1]=c}}var f=o.length;if(2==f&&o.push(0),0!==f)return o}},e.prototype.readFlatPosList=function(t,e){var r=Ke(t,!1).replace(/^\s*|\s*$/g,""),n=e[0],i=n.srsName,o=n.srsDimension,s="enu";i&&(s=ye(i).getAxisOrientation());var a,l,u,c=r.split(/\s+/),h=2;t.getAttribute("srsDimension")?h=Or(t.getAttribute("srsDimension")):t.getAttribute("dimension")?h=Or(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?h=Or(t.parentNode.getAttribute("srsDimension")):o&&(h=Or(o));for(var f=[],p=0,d=c.length;p<d;p+=h)a=parseFloat(c[p]),l=parseFloat(c[p+1]),u=3===h?parseFloat(c[p+2]):0,"en"===s.substr(0,2)?f.push(a,l,u):f.push(l,a,u);return f},e.prototype.writePos_=function(t,e,r){var n=e.getCoordinates();Lr(t,n[0]+" "+n[1])},e.prototype.getCoords_=function(t,e,r){return t[0]+" "+t[1]},e.prototype.writePosList_=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=i?"3":"2";t.setAttribute("srsDimension",o);for(var s,a=n.srsName,l=e.getCoordinates(),u=l.length,c=new Array(u),h=0;h<u;++h)s=l[h],c[h]=this.getCoords_(s,a,i);Lr(t,c.join(" "))},e.prototype.writePoint=function(t,e,r){var n=r[r.length-1].srsName;n&&t.setAttribute("srsName",n);var i=Ze(t.namespaceURI,"pos");t.appendChild(i),this.writePos_(i,e,r)},e.prototype.writeEnvelope=function(t,e,r){var n=r[r.length-1].srsName;n&&t.setAttribute("srsName",n);var i=[e[0]+" "+e[1],e[2]+" "+e[3]];dr({node:t},this.ENVELOPE_SERIALIZERS,lr,i,r,["lowerCorner","upperCorner"],this)},e.prototype.writeLinearRing=function(t,e,r){var n=r[r.length-1].srsName;n&&t.setAttribute("srsName",n);var i=Ze(t.namespaceURI,"posList");t.appendChild(i),this.writePosList_(i,e,r)},e.prototype.RING_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1],i=n.node,o=n.exteriorWritten;return void 0===o&&(n.exteriorWritten=!0),Ze(i.namespaceURI,void 0!==o?"interior":"exterior")},e.prototype.writeSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();dr({node:t,hasZ:i,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,s,r,void 0,this)}else if("Surface"===t.nodeName){var a=Ze(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,r)}},e.prototype.writeCurveOrLineString=function(t,e,r){var n=r[r.length-1].srsName;if("LineStringSegment"!==t.nodeName&&n&&t.setAttribute("srsName",n),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var i=Ze(t.namespaceURI,"posList");t.appendChild(i),this.writePosList_(i,e,r)}else if("Curve"===t.nodeName){var o=Ze(t.namespaceURI,"segments");t.appendChild(o),this.writeCurveSegments_(o,e,r)}},e.prototype.writeMultiSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,s=n.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();dr({node:t,hasZ:i,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,r,void 0,this)},e.prototype.writeMultiPoint=function(t,e,r){var n=r[r.length-1],i=n.srsName,o=n.hasZ;i&&t.setAttribute("srsName",i);var s=e.getPoints();dr({node:t,hasZ:o,srsName:i},this.POINTMEMBER_SERIALIZERS,ar("pointMember"),s,r,void 0,this)},e.prototype.writeMultiCurveOrLineString=function(t,e,r){var n=r[r.length-1],i=n.hasZ,o=n.srsName,s=n.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();dr({node:t,hasZ:i,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,r,void 0,this)},e.prototype.writeRing=function(t,e,r){var n=Ze(t.namespaceURI,"LinearRing");t.appendChild(n),this.writeLinearRing(n,e,r)},e.prototype.writeSurfaceOrPolygonMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);n&&(t.appendChild(n),this.writeSurfaceOrPolygon(n,e,r))},e.prototype.writePointMember=function(t,e,r){var n=Ze(t.namespaceURI,"Point");t.appendChild(n),this.writePoint(n,e,r)},e.prototype.writeLineStringOrCurveMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);n&&(t.appendChild(n),this.writeCurveOrLineString(n,e,r))},e.prototype.writeSurfacePatches_=function(t,e,r){var n=Ze(t.namespaceURI,"PolygonPatch");t.appendChild(n),this.writeSurfaceOrPolygon(n,e,r)},e.prototype.writeCurveSegments_=function(t,e,r){var n=Ze(t.namespaceURI,"LineStringSegment");t.appendChild(n),this.writeCurveOrLineString(n,e,r)},e.prototype.writeGeometryElement=function(t,e,r){var n,i=r[r.length-1],o=V({},i);o.node=t,n=Array.isArray(e)?AL(e,i):NL(e,!0,i),dr(o,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[n],r,void 0,this)},e.prototype.writeFeatureElement=function(t,e,r){var n=e.getId();n&&t.setAttribute("fid",n);var i=r[r.length-1],o=i.featureNS,s=e.getGeometryName();i.serializers||(i.serializers={},i.serializers[o]={});var a=[],l=[];if(e.hasProperties()){var u=e.getProperties();for(var c in u){var h=u[c];null!==h&&(a.push(c),l.push(h),c==s||"function"==typeof h.getSimplifiedGeometry?c in i.serializers[o]||(i.serializers[o][c]=or(this.writeGeometryElement,this)):c in i.serializers[o]||(i.serializers[o][c]=or(Lr)))}}var f=V({},i);f.node=t,dr(f,i.serializers,ar(void 0,o),l,r,a)},e.prototype.writeFeatureMembers_=function(t,e,r){var n=r[r.length-1],i=n.featureType,o=n.featureNS,s={};s[o]={},s[o][i]=or(this.writeFeatureElement,this);var a=V({},n);a.node=t,dr(a,s,ar(i,o),e,r)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1].node;return Ze(this.namespace,HL[n.nodeName])},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,r){var n,i=e[e.length-1],o=i.multiSurface,s=i.surface,a=i.curve,l=i.multiCurve;return Array.isArray(t)?n="Envelope":"MultiPolygon"===(n=t.getType())&&!0===o?n="MultiSurface":"Polygon"===n&&!0===s?n="Surface":"LineString"===n&&!0===a?n="Curve":"MultiLineString"===n&&!0===l&&(n="MultiCurve"),Ze(this.namespace,n)},e.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var r=Ze(this.namespace,"geom"),n={node:r,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&V(n,e),this.writeGeometryElement(r,t,[n]),r},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var r=Ze(this.namespace,"featureMembers");r.setAttributeNS(He,"xsi:schemaLocation",this.schemaLocation);var n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&V(n,e),this.writeFeatureMembers_(r,t,[n]),r},e}(BL);ZL.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:rr(ZL.prototype.readFlatPos),posList:rr(ZL.prototype.readFlatPosList),coordinates:rr(WL.prototype.readFlatCoordinates)}},ZL.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:ZL.prototype.interiorParser,exterior:ZL.prototype.exteriorParser}},ZL.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:rr(BL.prototype.readPoint),MultiPoint:rr(BL.prototype.readMultiPoint),LineString:rr(BL.prototype.readLineString),MultiLineString:rr(BL.prototype.readMultiLineString),LinearRing:rr(BL.prototype.readLinearRing),Polygon:rr(BL.prototype.readPolygon),MultiPolygon:rr(BL.prototype.readMultiPolygon),Surface:rr(ZL.prototype.readSurface),MultiSurface:rr(ZL.prototype.readMultiSurface),Curve:rr(ZL.prototype.readCurve),MultiCurve:rr(ZL.prototype.readMultiCurve),Envelope:rr(ZL.prototype.readEnvelope)}},ZL.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:er(ZL.prototype.curveMemberParser),curveMembers:er(ZL.prototype.curveMemberParser)}},ZL.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:er(ZL.prototype.surfaceMemberParser),surfaceMembers:er(ZL.prototype.surfaceMemberParser)}},ZL.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:er(BL.prototype.readLineString),Curve:er(ZL.prototype.readCurve)}},ZL.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:er(BL.prototype.readPolygon),Surface:er(ZL.prototype.readSurface)}},ZL.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:rr(ZL.prototype.readPatch)}},ZL.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:rr(ZL.prototype.readSegment)}},ZL.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:er(ZL.prototype.readFlatPosList),upperCorner:er(ZL.prototype.readFlatPosList)}},ZL.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:rr(ZL.prototype.readPolygonPatch)}},ZL.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:rr(ZL.prototype.readLineStringSegment)}},ZL.prototype.writeFeatures,ZL.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:or(ZL.prototype.writeRing),interior:or(ZL.prototype.writeRing)}},ZL.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:or(Lr),upperCorner:or(Lr)}},ZL.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:or(ZL.prototype.writeSurfaceOrPolygonMember),polygonMember:or(ZL.prototype.writeSurfaceOrPolygonMember)}},ZL.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:or(ZL.prototype.writePointMember)}},ZL.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:or(ZL.prototype.writeLineStringOrCurveMember),curveMember:or(ZL.prototype.writeLineStringOrCurveMember)}},ZL.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:or(ZL.prototype.writeCurveOrLineString),MultiCurve:or(ZL.prototype.writeMultiCurveOrLineString),Point:or(ZL.prototype.writePoint),MultiPoint:or(ZL.prototype.writeMultiPoint),LineString:or(ZL.prototype.writeCurveOrLineString),MultiLineString:or(ZL.prototype.writeMultiCurveOrLineString),LinearRing:or(ZL.prototype.writeLinearRing),Polygon:or(ZL.prototype.writeSurfaceOrPolygon),MultiPolygon:or(ZL.prototype.writeMultiSurfaceOrPolygon),Surface:or(ZL.prototype.writeSurfaceOrPolygon),MultiSurface:or(ZL.prototype.writeMultiSurfaceOrPolygon),Envelope:or(ZL.prototype.writeEnvelope)}};var KL=ZL,$L=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),JL=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,n)||this).schemaLocation=n.schemaLocation?n.schemaLocation:r.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",r}return $L(e,t),e}(KL);JL.prototype.namespace="http://www.opengis.net/gml/3.2",JL.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:rr(KL.prototype.readFlatPos),posList:rr(KL.prototype.readFlatPosList),coordinates:rr(WL.prototype.readFlatCoordinates)}},JL.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:KL.prototype.interiorParser,exterior:KL.prototype.exteriorParser}},JL.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:rr(BL.prototype.readPoint),MultiPoint:rr(BL.prototype.readMultiPoint),LineString:rr(BL.prototype.readLineString),MultiLineString:rr(BL.prototype.readMultiLineString),LinearRing:rr(BL.prototype.readLinearRing),Polygon:rr(BL.prototype.readPolygon),MultiPolygon:rr(BL.prototype.readMultiPolygon),Surface:rr(JL.prototype.readSurface),MultiSurface:rr(KL.prototype.readMultiSurface),Curve:rr(JL.prototype.readCurve),MultiCurve:rr(KL.prototype.readMultiCurve),Envelope:rr(JL.prototype.readEnvelope)}},JL.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:er(KL.prototype.curveMemberParser),curveMembers:er(KL.prototype.curveMemberParser)}},JL.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:er(KL.prototype.surfaceMemberParser),surfaceMembers:er(KL.prototype.surfaceMemberParser)}},JL.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:er(BL.prototype.readLineString),Curve:er(KL.prototype.readCurve)}},JL.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:er(BL.prototype.readPolygon),Surface:er(KL.prototype.readSurface)}},JL.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:rr(KL.prototype.readPatch)}},JL.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:rr(KL.prototype.readSegment)}},JL.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:er(KL.prototype.readFlatPosList),upperCorner:er(KL.prototype.readFlatPosList)}},JL.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:rr(KL.prototype.readPolygonPatch)}},JL.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:rr(KL.prototype.readLineStringSegment)}},JL.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:er(BL.prototype.pointMemberParser),pointMembers:er(BL.prototype.pointMemberParser)}},JL.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:er(BL.prototype.lineStringMemberParser),lineStringMembers:er(BL.prototype.lineStringMemberParser)}},JL.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:er(BL.prototype.polygonMemberParser),polygonMembers:er(BL.prototype.polygonMemberParser)}},JL.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:er(BL.prototype.readFlatCoordinatesFromNode)}},JL.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:er(BL.prototype.readLineString)}},JL.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:er(BL.prototype.readPolygon)}},JL.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:rr(BL.prototype.readFlatLinearRing)}},JL.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:or(KL.prototype.writeRing),interior:or(KL.prototype.writeRing)}},JL.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:or(Lr),upperCorner:or(Lr)}},JL.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:or(KL.prototype.writeSurfaceOrPolygonMember),polygonMember:or(KL.prototype.writeSurfaceOrPolygonMember)}},JL.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:or(KL.prototype.writePointMember)}},JL.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:or(KL.prototype.writeLineStringOrCurveMember),curveMember:or(KL.prototype.writeLineStringOrCurveMember)}},JL.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:or(KL.prototype.writeCurveOrLineString),MultiCurve:or(KL.prototype.writeMultiCurveOrLineString),Point:or(JL.prototype.writePoint),MultiPoint:or(KL.prototype.writeMultiPoint),LineString:or(KL.prototype.writeCurveOrLineString),MultiLineString:or(KL.prototype.writeMultiCurveOrLineString),LinearRing:or(KL.prototype.writeLinearRing),Polygon:or(KL.prototype.writeSurfaceOrPolygon),MultiPolygon:or(KL.prototype.writeMultiSurfaceOrPolygon),Surface:or(KL.prototype.writeSurfaceOrPolygon),MultiSurface:or(KL.prototype.writeMultiSurfaceOrPolygon),Envelope:or(KL.prototype.writeEnvelope)}};var QL=JL,tM=function(){function t(t){this.tagName_=t}return t.prototype.getTagName=function(){return this.tagName_},t}(),eM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rM=function(t){function e(e,r){var n=t.call(this,e)||this;return n.conditions=r,ut(n.conditions.length>=2,57),n}return eM(e,t),e}(tM),nM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),iM=function(t){function e(e){return t.call(this,"And",Array.prototype.slice.call(arguments))||this}return nM(e,t),e}(rM),oM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sM=function(t){function e(e,r,n){var i=t.call(this,"BBOX")||this;if(i.geometryName=e,i.extent=r,4!==r.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return i.srsName=n,i}return oM(e,t),e}(tM),aM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lM=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.geometryName=r||"the_geom",o.geometry=n,o.srsName=i,o}return aM(e,t),e}(tM),uM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),cM=function(t){function e(e,r,n){return t.call(this,"Contains",e,r,n)||this}return uM(e,t),e}(lM),hM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fM=function(t){function e(e,r,n,i,o){var s=t.call(this,"DWithin",e,r,o)||this;return s.distance=n,s.unit=i,s}return hM(e,t),e}(lM),pM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dM=function(t){function e(e,r,n){return t.call(this,"Disjoint",e,r,n)||this}return pM(e,t),e}(lM),gM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yM=function(t){function e(e,r){var n=t.call(this,e)||this;return n.propertyName=r,n}return gM(e,t),e}(tM),mM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_M=function(t){function e(e,r,n){var i=t.call(this,"During",e)||this;return i.begin=r,i.end=n,i}return mM(e,t),e}(yM),vM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),bM=function(t){function e(e,r,n,i){var o=t.call(this,e,r)||this;return o.expression=n,o.matchCase=i,o}return vM(e,t),e}(yM),wM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xM=function(t){function e(e,r,n){return t.call(this,"PropertyIsEqualTo",e,r,n)||this}return wM(e,t),e}(bM),EM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),SM=function(t){function e(e,r){return t.call(this,"PropertyIsGreaterThan",e,r)||this}return EM(e,t),e}(bM),IM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),OM=function(t){function e(e,r){return t.call(this,"PropertyIsGreaterThanOrEqualTo",e,r)||this}return IM(e,t),e}(bM),CM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),TM=function(t){function e(e,r,n){return t.call(this,"Intersects",e,r,n)||this}return CM(e,t),e}(lM),PM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),RM=function(t){function e(e,r,n){var i=t.call(this,"PropertyIsBetween",e)||this;return i.lowerBoundary=r,i.upperBoundary=n,i}return PM(e,t),e}(yM),LM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),MM=function(t){function e(e,r,n,i,o,s){var a=t.call(this,"PropertyIsLike",e)||this;return a.pattern=r,a.wildCard=void 0!==n?n:"*",a.singleChar=void 0!==i?i:".",a.escapeChar=void 0!==o?o:"!",a.matchCase=s,a}return LM(e,t),e}(yM),kM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),NM=function(t){function e(e){return t.call(this,"PropertyIsNull",e)||this}return kM(e,t),e}(yM),AM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),FM=function(t){function e(e,r){return t.call(this,"PropertyIsLessThan",e,r)||this}return AM(e,t),e}(bM),DM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jM=function(t){function e(e,r){return t.call(this,"PropertyIsLessThanOrEqualTo",e,r)||this}return DM(e,t),e}(bM),GM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zM=function(t){function e(e){var r=t.call(this,"Not")||this;return r.condition=e,r}return GM(e,t),e}(tM),UM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),BM=function(t){function e(e,r,n){return t.call(this,"PropertyIsNotEqualTo",e,r,n)||this}return UM(e,t),e}(bM),VM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qM=function(t){function e(e){return t.call(this,"Or",Array.prototype.slice.call(arguments))||this}return VM(e,t),e}(rM),YM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),WM=(function(t){function e(e){var r=t.call(this,"ResourceId")||this;return r.rid=e,r}YM(e,t)}(tM),function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),XM=function(t){function e(e,r,n){return t.call(this,"Within",e,r,n)||this}return WM(e,t),e}(lM);function HM(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(iM,e))}function ZM(t,e,r){return new sM(t,e,r)}var KM=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$M={"http://www.opengis.net/gml":{boundedBy:ir(BL.prototype.readGeometryElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:er(BL.prototype.readFeaturesInternal)}},JM={"http://www.opengis.net/wfs":{totalInserted:ir(Ir),totalUpdated:ir(Ir),totalDeleted:ir(Ir)},"http://www.opengis.net/wfs/2.0":{totalInserted:ir(Ir),totalUpdated:ir(Ir),totalDeleted:ir(Ir)}},QM={"http://www.opengis.net/wfs":{TransactionSummary:ir(hk,"transactionSummary"),InsertResults:ir(gk,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:ir(hk,"transactionSummary"),InsertResults:ir(gk,"insertIds")}},tk={"http://www.opengis.net/wfs":{PropertyName:or(Lr)},"http://www.opengis.net/wfs/2.0":{PropertyName:or(Lr)}},ek={"http://www.opengis.net/wfs":{Insert:or(yk),Update:or(bk),Delete:or(vk),Property:or(wk),Native:or(xk)},"http://www.opengis.net/wfs/2.0":{Insert:or(yk),Update:or(bk),Delete:or(vk),Property:or(wk),Native:or(xk)}},rk="feature",nk="http://www.w3.org/2000/xmlns/",ik={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},ok={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},sk={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},ak={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},lk={"2.0.0":QL,"1.1.0":KL,"1.0.0":WL},uk=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.version_=n.version?n.version:"1.1.0",r.featureType_=n.featureType,r.featureNS_=n.featureNS,r.gmlFormat_=n.gmlFormat?n.gmlFormat:new lk[r.version_],r.schemaLocation_=n.schemaLocation?n.schemaLocation:ak[r.version_],r}return KM(e,t),e.prototype.getFeatureType=function(){return this.featureType_},e.prototype.setFeatureType=function(t){this.featureType_=t},e.prototype.readFeaturesFromNode=function(t,e){var r={node:t};V(r,{featureType:this.featureType_,featureNS:this.featureNS_}),V(r,this.getReadOptions(t,e||{}));var n=[r],i=fr([],"2.0.0"===this.version_?$M:this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,n,this.gmlFormat_);return i||(i=[]),i},e.prototype.readTransactionResponse=function(t){if(t){if("string"==typeof t){var e=Qe(t);return this.readTransactionResponseFromDocument(e)}return Je(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}},e.prototype.readFeatureCollectionMetadata=function(t){if(t){if("string"==typeof t){var e=Qe(t);return this.readFeatureCollectionMetadataFromDocument(e)}return Je(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}},e.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)},e.prototype.readFeatureCollectionMetadataFromNode=function(t){var e={},r=Or(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=r,fr(e,$M,t,[],this.gmlFormat_)},e.prototype.readTransactionResponseFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)},e.prototype.readTransactionResponseFromNode=function(t){return fr({},QM,t,[])},e.prototype.writeGetFeature=function(t){var e=this,r=Ze(ok[this.version_],"GetFeature");r.setAttribute("service","WFS"),r.setAttribute("version",this.version_),t.handle&&r.setAttribute("handle",t.handle),t.outputFormat&&r.setAttribute("outputFormat",t.outputFormat),void 0!==t.maxFeatures&&r.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&r.setAttribute("resultType",t.resultType),void 0!==t.startIndex&&r.setAttribute("startIndex",String(t.startIndex)),void 0!==t.count&&r.setAttribute("count",String(t.count)),void 0!==t.viewParams&&r.setAttribute("viewParams",t.viewParams),r.setAttributeNS(He,"xsi:schemaLocation",this.schemaLocation_);var n={node:r};if(V(n,{version:this.version_,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]}),ut(Array.isArray(t.featureTypes),11),"string"==typeof t.featureTypes[0]){var i=t.filter;t.bbox&&(ut(t.geometryName,12),i=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,i)),V(n,{geometryName:t.geometryName,filter:i}),zk(r,t.featureTypes,[n])}else t.featureTypes.forEach((function(i){var o=e.combineBboxAndFilter(i.geometryName,i.bbox,t.srsName,t.filter);V(n,{geometryName:i.geometryName,filter:o}),zk(r,[i.name],[n])}));return r},e.prototype.combineBboxAndFilter=function(t,e,r,n){var i=ZM(t,e,r);return n?HM(n,i):i},e.prototype.writeTransaction=function(t,e,r,n){var i,o=[],s=n.version?n.version:this.version_,a=Ze(ok[s],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",s),n&&(i=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle)),a.setAttributeNS(He,"xsi:schemaLocation",ak[s]);var l=function(t,e,r,n){var i,o=n.featurePrefix?n.featurePrefix:rk;"1.0.0"===r?i=2:"1.1.0"===r?i=3:"2.0.0"===r&&(i=3.2);return V({node:t},{version:r,featureNS:n.featureNS,featureType:n.featureType,featurePrefix:o,gmlVersion:i,hasZ:n.hasZ,srsName:n.srsName},e)}(a,i,s,n);return t&&ck("Insert",t,o,l),e&&ck("Update",e,o,l),r&&ck("Delete",r,o,l),n.nativeElements&&ck("Native",n.nativeElements,o,l),a},e.prototype.readProjectionFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null},e.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild)for(var e=(t=t.firstElementChild.firstElementChild).firstElementChild;e;e=e.nextElementSibling)if(0!==e.childNodes.length&&(1!==e.childNodes.length||3!==e.firstChild.nodeType)){var r=[{}];return this.gmlFormat_.readGeometryElement(e,r),ye(r.pop().srsName)}return null},e}(DL);function ck(t,e,r,n){dr(n,ek,ar(t),e,r)}function hk(t,e){return fr({},JM,t,e)}var fk={"http://www.opengis.net/ogc":{FeatureId:er((function(t,e){return t.getAttribute("fid")}))},"http://www.opengis.net/ogc/1.1":{FeatureId:er((function(t,e){return t.getAttribute("fid")}))}};function pk(t,e){hr(fk,t,e)}var dk={"http://www.opengis.net/wfs":{Feature:pk},"http://www.opengis.net/wfs/2.0":{Feature:pk}};function gk(t,e){return fr([],dk,t,e)}function yk(t,e,r){var n=r[r.length-1],i=n.featureType,o=n.featureNS,s=n.gmlVersion,a=Ze(o,i);t.appendChild(a),2===s?WL.prototype.writeFeatureElement(a,e,r):3===s?KL.prototype.writeFeatureElement(a,e,r):QL.prototype.writeFeatureElement(a,e,r)}function mk(t,e,r){var n=r[r.length-1].version,i=ik[n],o=Ze(i,"Filter"),s=Ze(i,"FeatureId");o.appendChild(s),s.setAttribute("fid",e),t.appendChild(o)}function _k(t,e){var r=(t=t||rk)+":";return 0===e.indexOf(r)?e:r+e}function vk(t,e,r){var n=r[r.length-1];ut(void 0!==e.getId(),26);var i=n.featureType,o=n.featurePrefix,s=n.featureNS,a=_k(o,i);t.setAttribute("typeName",a),t.setAttributeNS(nk,"xmlns:"+o,s);var l=e.getId();void 0!==l&&mk(t,l,r)}function bk(t,e,r){var n=r[r.length-1];ut(void 0!==e.getId(),27);var i=n.version,o=n.featureType,s=n.featurePrefix,a=n.featureNS,l=_k(s,o),u=e.getGeometryName();t.setAttribute("typeName",l),t.setAttributeNS(nk,"xmlns:"+s,a);var c=e.getId();if(void 0!==c){for(var h=e.getKeys(),f=[],p=0,d=h.length;p<d;p++){var g=e.get(h[p]);if(void 0!==g){var y=h[p];g&&"function"==typeof g.getSimplifiedGeometry&&(y=u),f.push({name:y,value:g})}}dr({version:i,gmlVersion:n.gmlVersion,node:t,hasZ:n.hasZ,srsName:n.srsName},ek,ar("Property"),f,r),mk(t,c,r)}}function wk(t,e,r){var n=r[r.length-1],i=n.version,o=ok[i],s=Ze(o,"Name"),a=n.gmlVersion;if(t.appendChild(s),Lr(s,e.name),void 0!==e.value&&null!==e.value){var l=Ze(o,"Value");t.appendChild(l),e.value&&"function"==typeof e.value.getSimplifiedGeometry?2===a?WL.prototype.writeGeometryElement(l,e.value,r):3===a?KL.prototype.writeGeometryElement(l,e.value,r):QL.prototype.writeGeometryElement(l,e.value,r):Lr(l,e.value)}}function xk(t,e,r){e.vendorId&&t.setAttribute("vendorId",e.vendorId),void 0!==e.safeToIgnore&&t.setAttribute("safeToIgnore",String(e.safeToIgnore)),void 0!==e.value&&Lr(t,e.value)}var Ek={"http://www.opengis.net/wfs":{Query:or(Sk)},"http://www.opengis.net/wfs/2.0":{Query:or(Sk)},"http://www.opengis.net/ogc":{During:or(Pk),And:or(Rk),Or:or(Rk),Not:or(Lk),BBOX:or(Ok),Contains:or(Ck),Intersects:or(Ck),Within:or(Ck),DWithin:or(Tk),PropertyIsEqualTo:or(Mk),PropertyIsNotEqualTo:or(Mk),PropertyIsLessThan:or(Mk),PropertyIsLessThanOrEqualTo:or(Mk),PropertyIsGreaterThan:or(Mk),PropertyIsGreaterThanOrEqualTo:or(Mk),PropertyIsNull:or(kk),PropertyIsBetween:or(Nk),PropertyIsLike:or(Ak)},"http://www.opengis.net/fes/2.0":{During:or(Pk),And:or(Rk),Or:or(Rk),Not:or(Lk),BBOX:or(Ok),Contains:or(Ck),Disjoint:or(Ck),Intersects:or(Ck),ResourceId:or((function(t,e,r){t.setAttribute("rid",e.rid)})),Within:or(Ck),DWithin:or(Tk),PropertyIsEqualTo:or(Mk),PropertyIsNotEqualTo:or(Mk),PropertyIsLessThan:or(Mk),PropertyIsLessThanOrEqualTo:or(Mk),PropertyIsGreaterThan:or(Mk),PropertyIsGreaterThanOrEqualTo:or(Mk),PropertyIsNull:or(kk),PropertyIsBetween:or(Nk),PropertyIsLike:or(Ak)}};function Sk(t,e,r){var n,i,o=r[r.length-1],s=o.version,a=o.featurePrefix,l=o.featureNS,u=o.propertyNames,c=o.srsName;n=a?_k(a,e):e,i="2.0.0"===s?"typeNames":"typeName",t.setAttribute(i,n),c&&t.setAttribute("srsName",c),l&&t.setAttributeNS(nk,"xmlns:"+a,l);var h=V({},o);h.node=t,dr(h,tk,ar("PropertyName"),u,r);var f=o.filter;if(f){var p=Ze(Uk(s),"Filter");t.appendChild(p),Ik(p,f,r)}}function Ik(t,e,r){var n=r[r.length-1],i={node:t};V(i,{context:n}),dr(i,Ek,ar(e.getTagName()),[e],r)}function Ok(t,e,r){var n=r[r.length-1],i=n.context.version;n.srsName=e.srsName;var o=lk[i];jk(i,t,e.geometryName),o.prototype.writeGeometryElement(t,e.extent,r)}function Ck(t,e,r){var n=r[r.length-1],i=n.context.version;n.srsName=e.srsName;var o=lk[i];jk(i,t,e.geometryName),o.prototype.writeGeometryElement(t,e.geometry,r)}function Tk(t,e,r){var n=r[r.length-1].context.version;Ck(t,e,r);var i=Ze(Uk(n),"Distance");Lr(i,e.distance.toString()),"2.0.0"===n?i.setAttribute("uom",e.unit):i.setAttribute("units",e.unit),t.appendChild(i)}function Pk(t,e,r){var n=r[r.length-1].context.version;Fk(sk[n],"ValueReference",t,e.propertyName);var i=Ze(GL,"TimePeriod");t.appendChild(i);var o=Ze(GL,"begin");i.appendChild(o),Gk(o,e.begin);var s=Ze(GL,"end");i.appendChild(s),Gk(s,e.end)}function Rk(t,e,r){var n=r[r.length-1].context,i={node:t};V(i,{context:n});for(var o=e.conditions,s=0,a=o.length;s<a;++s){var l=o[s];dr(i,Ek,ar(l.getTagName()),[l],r)}}function Lk(t,e,r){var n=r[r.length-1].context,i={node:t};V(i,{context:n});var o=e.condition;dr(i,Ek,ar(o.getTagName()),[o],r)}function Mk(t,e,r){var n=r[r.length-1].context.version;void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString()),jk(n,t,e.propertyName),Dk(n,t,""+e.expression)}function kk(t,e,r){jk(r[r.length-1].context.version,t,e.propertyName)}function Nk(t,e,r){var n=r[r.length-1].context.version,i=Uk(n);jk(n,t,e.propertyName);var o=Ze(i,"LowerBoundary");t.appendChild(o),Dk(n,o,""+e.lowerBoundary);var s=Ze(i,"UpperBoundary");t.appendChild(s),Dk(n,s,""+e.upperBoundary)}function Ak(t,e,r){var n=r[r.length-1].context.version;t.setAttribute("wildCard",e.wildCard),t.setAttribute("singleChar",e.singleChar),t.setAttribute("escapeChar",e.escapeChar),void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString()),jk(n,t,e.propertyName),Dk(n,t,""+e.pattern)}function Fk(t,e,r,n){var i=Ze(t,e);Lr(i,n),r.appendChild(i)}function Dk(t,e,r){Fk(Uk(t),"Literal",e,r)}function jk(t,e,r){"2.0.0"===t?Fk(sk[t],"ValueReference",e,r):Fk(ik[t],"PropertyName",e,r)}function Gk(t,e){var r=Ze(GL,"TimeInstant");t.appendChild(r);var n=Ze(GL,"timePosition");r.appendChild(n),Lr(n,e)}function zk(t,e,r){var n=r[r.length-1],i=V({},n);i.node=t,dr(i,Ek,ar("Query"),e,r)}function Uk(t){return"2.0.0"===t?sk[t]:ik[t]}var Bk=uk,Vk=r(47),qk=r.n(Vk),Yk=r(48),Wk=r.n(Yk);function Xk(t){return(Xk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hk(t){return function(t){if(Array.isArray(t))return Zk(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Zk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zk(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zk(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Kk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $k(t,e){return($k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jk(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=tN(t);if(e){var i=tN(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Qk(this,r)}}function Qk(t,e){return!e||"object"!==Xk(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tN(t){return(tN=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var eN=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$k(t,e)}(o,t);var e,r,n,i=Jk(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this)).userFormat=t,r.featureCount=e.featureCount,_V(r.featureCount)&&(r.featureCount=10),r.buffer=e.buffer,r}return e=o,n=[{key:"insert",value:function(t,e){var r=!1;switch(e){case"text/html":var n=document.createElement("div");n.innerHTML=t;var i="";Array.prototype.forEach.call(n.querySelectorAll("body"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("div"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("table"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("b"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("span"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("input"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("a"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("img"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("p"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("ul"),(function(t){i+=t.innerHTML.trim()})),Array.prototype.forEach.call(n.querySelectorAll("li"),(function(t){i+=t.innerHTML.trim()})),i.length>0&&!/WMS\s+server\s+error/i.test(t)&&(r=!0);break;case"application/vnd.ogc.gml":r=(new Bk).readFeatures(t).length>0;break;case"text/plain":/returned\s+no\s+results/i.test(t)||/features\s+were\s+found/i.test(t)||/:$/i.test(t)||(r=!0)}return r}},{key:"unsupportedFormat",value:function(t,e){var r=!1;return"text/html"===e&&(r=o.regExs.msUnsupportedFormat.test(t)),r}}],(r=[{key:"addTo",value:function(t,e){!1===t.getMapImpl().getControls().getArray().some((function(t){return t instanceof o}))&&(this.facadeMap_=t,Xc.call(this,{element:e,target:null}),t.getMapImpl().addControl(this))}},{key:"activate",value:function(){this.addOnClickEvent_()}},{key:"deactivate",value:function(){this.deleteOnClickEvent_()}},{key:"addOnClickEvent_",value:function(){var t=this,e=this.facadeMap_.getMapImpl();"plain"===SV(this.userFormat)||"text/plain"===SV(this.userFormat)?this.userFormat="text/plain":"gml"===SV(this.userFormat)||"application/vnd.ogc.gml"===SV(this.userFormat)?this.userFormat="application/vnd.ogc.gml":this.userFormat="text/html",this.clickEventKey_=e.on("singleclick",(function(e){return t.buildUrl_(s,e)}))}},{key:"buildUrl_",value:function(t,e){this.evt=e;var r=this.facadeMap_.getMapImpl(),n=this.buildWMSInfoURL(this.facadeMap_.getWMS()),i=this.buildWMTSInfoURL(this.facadeMap_.getWMTS()),o=[].concat(Hk(i),Hk(n)).filter((function(t){return!_V(t)}));o.length>0?this.showInfoFromURL_(o,e.coordinate,r):t.info("No existen capas consultables")}},{key:"buildWMSInfoURL",value:function(t){var e=this,r=this.facadeMap_.getMapImpl().getView().getResolution(),n=this.facadeMap_.getProjection().code;return t.map((function(t){var i,o=t.getImpl().getOLLayer();if(t.isVisible()&&t.isQueryable()&&!_V(o)){i={};var s={INFO_FORMAT:e.userFormat,FEATURE_COUNT:e.featureCount},a=o.getSource(),l=e.evt.coordinate,u=a.getFeatureInfoUrl(l,r,n,s);wV(M.config.ticket)&&(u=OV(u,{ticket:M.config.ticket})),/buffer/i.test(t.url)||(s.Buffer=e.buffer),i={layer:t.legend||t.name,url:u}}return i}))}},{key:"buildWMTSInfoURL",value:function(t){var e=this;return t.map((function(t){var r;if(t.isVisible()){r={};var n=e.userFormat,i=e.evt.coordinate,o=t.getGetFeatureInfoUrl(i,e.facadeMap_.getZoom(),n);wV(M.config.ticket)&&(o=OV(o,{ticket:M.config.ticket})),r={layer:t.legend||t.name,url:o}}return r}))}},{key:"deleteOnClickEvent_",value:function(){ma(this.clickEventKey_)}},{key:"formatInfo",value:function(t,e,r){var n=null;switch(e){case"text/html":n=t;break;case"application/vnd.ogc.gml":var i=(new Bk).readFeatures(t);n="",i.forEach((function(t){var e=t.getKeys();n+="<div class='divinfo'>",n+="<table class='mapea-table'><tbody><tr><td class='header' colspan='3'>' ".concat(AV(r)," '</td></tr>'");for(var i=0,o=e.length;i<o;i+=1){var s=e[i],a=t.get(s);n+='<tr><td class="key"><b>',n+=AV(s),n+='</b></td><td class="value">',n+=a,n+="</td></tr>"}n+="</tbody></table></div>"}));break;case"text/plain":n=o.regExs.gsResponse.test(t)?this.txtToHtmlGeoserver(t,r):this.txtToHtmlMapserver(t,r)}return n}},{key:"txtToHtmlGeoserver",value:function(t,e){var r=t,n=(r=(r=r.replace(/[\w\s\S]*':/i,"")).replace(/---(-*)(n+)---(-*)/g,"#newfeature#")).split("\n"),i="<div class='divinfo'>";i+="<table class='mapea-table'><tbody><tr><td class='header' colspan='3'>".concat(AV(e),"</td></tr>");for(var s=0,a=n.length;s<a;s+=1){var l=n[s].trim();if(-1!==l.indexOf("=")){var u=l.split("="),c=u[0].trim(),h="-";u.length>1&&(0!==(h=u[1].trim()).length&&"null"!==h||(h="-")),!1===o.regExs.gsGeometry.test(c)&&(i+='<tr><td class="key"><b>',i+=AV(c),i+='</b></td><td class="value">',i+=h,i+="</td></tr>")}else o.regExs.gsNewFeature.test(l)&&(i+='<tr><td class="header" colspan="3">'.concat(AV(e),"</td></tr>"))}return i+="</tbody></table></div>"}},{key:"txtToHtmlMapserver",value:function(t){for(var e=t,r=(e=e.replace(/[\w\s\S]*(layer)/i,"$1")).replace(/layer(\s*)'(\w+)'[\w\s\S]*/i,"$2"),n=(e=(e=(e=(e=e.replace(/layer(\s*)'(\w+)'([\w\s\S]*)/i,"$3")).replace(/feature(\s*)(\w*)(\s*)(:)([\w\s\S]*)/i,"$5")).replace(/'/g,"")).replace(/=/g,";")).split("\n"),i="",s="<table class='mapea-table'><tbody><tr><td class='header' colspan='3'>".concat(AV(r),"</td></tr>"),a=0,l=n.length;a<l;a+=1){var u=n[a].trim(),c=n[a]?n[a].trim():"",h=u.split(";"),f=h[0].trim(),p="-";h.length>1&&0===(p=h[1].trim()).length&&(p="-"),f.length>0&&(o.regExs.msNewFeature.test(f)?c.length>0&&!o.regExs.msNewFeature.test(c)&&(i+="<tr><td class='header' colspan='3'>".concat(AV(r),"</td><td></td></tr>")):(i+='<tr><td class="key"><b>',i+=AV(f),i+='</b></td><td class="value">',i+=p,i+="</td></tr>"))}return i.length>0&&(i="".concat(s+i,"</tbody></table>")),i}},{key:"showInfoFromURL_",value:function(t,e,r){var n=this,i=Sp(qk.a,{vars:{info:o.LOADING_MESSAGE},parseToHtml:!1}),s=[],a=String(this.userFormat),l=0,u={icon:"g-cartografia-info",title:o.POPUP_TITLE,content:i},c=this.facadeMap_.getPopup();_V(c)?((c=new CO).addTab(u),this.facadeMap_.addPopup(c,e)):c.getTabs().some((function(t){return t.title!==o.POPUP_TITLE}))?c.addTab(u):(this.facadeMap_.removePopup(),(c=new CO).addTab(u),this.facadeMap_.addPopup(c,e)),t.forEach((function(e){var r=e.url,i=e.layer;uV(r).then((function(e){if(c=n.facadeMap_.getPopup(),200===e.code&&!1===e.error){var r=e.text;if(!0===o.insert(r,a)){var h=n.formatInfo(r,a,i);s.push({formatedInfo:h,layerName:i})}else o.unsupportedFormat(r,a)&&s.push({formatedInfo:pp("getfeatureinfo").unsupported_format,layerName:i})}if(l+=1,t.length===l&&!_V(c))if(c.removeTab(u),0===s.length)c.addTab({icon:"g-cartografia-info",title:o.POPUP_TITLE,content:pp("getfeatureinfo").no_info});else{var f=Sp(Wk.a,{vars:{layers:s,info_of:pp("getfeatureinfo").info_of},parseToHtml:!1});c.addTab({icon:"g-cartografia-info",title:o.POPUP_TITLE,content:f,listeners:[{selector:".m-getfeatureinfo-content-info div.m-arrow-right",all:!0,type:"click",callback:function(t){return n.toogleSection(t)}}]})}}))})),this.popup_=c}},{key:"toogleSection",value:function(t){var e=t.target,r=e.parentElement.parentElement.querySelector(".m-getfeatureinfo-content-info-body");if(r.classList.contains("m-content-collapsed")){r.classList.remove("m-content-collapsed"),e.classList.remove("m-arrow-right"),e.classList.add("m-arrow-down");var n=this.popup_.getCoordinate();_V(this.popup_.getImpl().panIntoView)||this.popup_.getImpl().panIntoView(n)}else r.classList.add("m-content-collapsed"),e.classList.add("m-arrow-right"),e.classList.remove("m-arrow-down")}}])&&Kk(e.prototype,r),n&&Kk(e,n),o}(Ev);eN.LOADING_MESSAGE="Obteniendo información...",eN.regExs={gsResponse:/^results[\w\s\S]*'http:/i,msNewFeature:/feature(\s*)(\w+)(\s*):/i,gsNewFeature:/#newfeature#/,gsGeometry:/geom$/i,msGeometry:/boundedby$/i,msUnsupportedFormat:/error(.*)unsupported(.*)info_format/i};var rN=eN,nN=r(49),iN=r.n(nN);function oN(t){return(oN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lN(t,e){return(lN=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uN(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=hN(t);if(e){var i=hN(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return cN(this,r)}}function cN(t,e){return!e||"object"!==oN(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hN(t){return(hN=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fN=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lN(t,e)}(o,t);var e,r,n,i=uN(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};sN(this,o);var n=new rN(t,r);return e=i.call(this,n,o.NAME),dV(rN)&&Of(pp("exception").getfeatureinfo_method),e.format=t,e}return e=o,(r=[{key:"createView",value:function(t){return Sp(iN.a,{vars:{title:pp("getfeatureinfo").title}})}},{key:"getActivationButton",value:function(t){return t.querySelector("button#m-getfeatureinfo-button")}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.name===t.name),e}}])&&aN(e.prototype,r),n&&aN(e,n),o}(bp);fN.NAME="getfeatureinfo",fN.POPUP_TITLE=pp("getfeatureinfo").info;var pN=fN,dN=(r(96),r(50)),gN=r.n(dN),yN=".m-top.m-left",mN=".m-top.m-right",_N=".m-bottom.m-left",vN=".m-bottom.m-right";function bN(t){return(bN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function EN(t,e){return(EN=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function SN(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ON(t);if(e){var i=ON(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return IN(this,r)}}function IN(t,e){return!e||"object"!==bN(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ON(t){return(ON=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var CN=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&EN(t,e)}(o,t);var e,r,n,i=SN(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return wN(this,o),(e=i.call(this)).name=t,e._map=null,e._controls=[],e._buttonPanel=null,e._collapsible=!1,_V(r.collapsible)||(e._collapsible=r.collapsible),e.position=yN,_V(r.position)||(e.position=r.position),e._collapsed=e._collapsible,_V(r.collapsed)||(e._collapsed=r.collapsed&&!0===e._collapsible),e._multiActivation=!1,_V(r.multiActivation)||(e._multiActivation=r.multiActivation),e._className=null,_V(r.className)||(e._className=r.className),e._collapsedButtonClass=null,_V(r.collapsedButtonClass)?e.position===yN||e.position===_N?e._collapsedButtonClass="g-cartografia-flecha-derecha":e.position!==mN&&e.position!==vN||(e._collapsedButtonClass="g-cartografia-flecha-izquierda"):e._collapsedButtonClass=r.collapsedButtonClass,e._openedButtonClass=null,_V(r.openedButtonClass)?e.position===yN||e.position===_N?e._openedButtonClass="g-cartografia-flecha-izquierda":e.position!==mN&&e.position!==vN||(e._openedButtonClass="g-cartografia-flecha-derecha"):e._openedButtonClass=r.openedButtonClass,e._element=null,e._areaContainer=null,e._controlsContainer=null,e._tooltip=null,_V(r.tooltip)||(e._tooltip=r.tooltip),e}return e=o,(r=[{key:"destroy",value:function(){null!=this._element&&this._areaContainer.removeChild(this._element),this._controlsContainer=null}},{key:"addTo",value:function(t,e){var r=this;this._map=t,this._areaContainer=e;var n=Sp(gN.a);this._element=n,_V(this._tooltip)||this._element.setAttribute("title",this._tooltip),this._buttonPanel=n.querySelector("button.m-panel-btn"),_V(this._className)||this._className.split(/\s+/).forEach((function(t){n.classList.add(t)})),!0===this._collapsed?this.collapse():this.open(),!0!==this._collapsible&&n.classList.add("no-collapsible"),this._controlsContainer=n.querySelector("div.m-panel-controls"),e.appendChild(n),this._buttonPanel.addEventListener("click",(function(t){t.preventDefault(),!1===r._collapsed?r.collapse():r.open()})),this.addControls(this._controls),this.fire(Af,n)}},{key:"_collapse",value:function(t){t.classList.remove("opened"),this._buttonPanel.classList.remove(this._openedButtonClass),t.classList.add("collapsed"),this._buttonPanel.classList.add(this._collapsedButtonClass),this._collapsed=!0,this.fire(Zf)}},{key:"_open",value:function(t){t.classList.remove("collapsed"),this._buttonPanel.classList.remove(this._collapsedButtonClass),t.classList.add("opened"),this._buttonPanel.classList.add(this._openedButtonClass),this._collapsed=!1,this.fire(Hf)}},{key:"open",value:function(){this._open(this._element)}},{key:"collapse",value:function(){this._collapse(this._element)}},{key:"getControls",value:function(){return this._controls}},{key:"addControls",value:function(t){var e=this,r=t;_V(r)||(mV(r)||(r=[r]),r.forEach((function(t){t instanceof bp&&(e.hasControl(t)||(e._controls.push(t),t.setPanel(e),t.on(Kf,e._removeControl.bind(e),e)),_V(e._controlsContainer)||(t.on(Af,e._moveControlView.bind(e),e),t.addTo(e._map)),t.on(Wf,e._manageActivation.bind(e),e))})))}},{key:"hasControl",value:function(t){var e=!1;return _V(t)||(wV(t)?e=null!=this._controls.filter((function(e){return e.name===t}))[0]:t instanceof bp&&(e=jV(this._controls,t))),e}},{key:"removeControls",value:function(t){var e=this,r=t;_V(r)||(mV(r)||(r=[r]),r.forEach((function(t){var r=t;r instanceof bp&&e.hasControl(r)&&(e._controls=e._controls.filter((function(t){return!r.equals(t)})),r.destroy&&r.destroy(),r.setPanel(null))}),this),0===this._controls.length&&this._map.removePanel(this))}},{key:"_removeControl",value:function(t){var e=this;this._map.controls(t).forEach((function(t){var r=e._controls.indexOf(t);-1!==r&&e._controls.splice(r,1)}))}},{key:"removeClassName",value:function(t){_V(this._element)?this._className=this._className.replace(new RegExp("s* ".concat(t," s*")),""):this._element.classList.remove(t)}},{key:"addClassName",value:function(t){_V(this._element)?this._className=this._className.concat(" ").concat(t):this._element.classList.add(t)}},{key:"_moveControlView",value:function(t){var e=t.getElement();_V(this._controlsContainer)||this._controlsContainer.appendChild(e),t.fire(Ff)}},{key:"_manageActivation",value:function(t){!0!==this._multiActivation&&this._controls.forEach((function(e){!e.equals(t)&&e.activated&&e.deactivate()}))}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=t.name===this.name),e}},{key:"getTemplatePanel",value:function(){return this._element}},{key:"getButtonPanel",value:function(){return this._buttonPanel}},{key:"isCollapsed",value:function(){return this._collapsed}},{key:"setCollapsed",value:function(t){this._collapsed=t}},{key:"getControlsContainer",value:function(){return this._controlsContainer}}])&&xN(e.prototype,r),n&&xN(e,n),o}(ff);function TN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function PN(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?TN(Object(r),!0).forEach((function(e){RN(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TN(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function RN(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var kN="map-info",NN=function(t,e){t.on(Af,(function(){3===e.getControls(["wmcselector","scale","scaleline"]).length&&e.getControls(["scaleline"])[0].getElement().classList.add("ol-scale-line-up")}))},AN=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};LN(this,t),this.panel_=new CN(e.name,PN({},e.params)),r(this.panel_)}var e,r,n;return e=t,(r=[{key:"panel",get:function(){return this.panel_}}])&&MN(e.prototype,r),n&&MN(e,n),t}(),FN=function(t){var e=t.getPanels("map-info")[0];_V(e)&&(e=new AN({name:kN,params:{collapsible:!1,className:"m-map-info",position:vN}},(function(e){NN(e,t)})).panel);return e.addClassName("m-with-scale"),e},DN=function(t,e){var r,n=(RN(r={},pN.NAME,(function(){return function(t){var e=t;if(_V(e.panel.TOOLS)){var r=new AN({name:"tools",params:{collapsible:!0,className:"m-tools",collapsedButtonClass:"g-cartografia-herramienta",position:yN,tooltip:"Panel de herramientas"}});e.panel.TOOLS=r.panel}return e.panel.TOOLS}(e)})),RN(r,$C.NAME,(function(){return new AN({name:$C.NAME,params:{collapsible:!0,className:"m-layerswitcher",collapsedButtonClass:"g-cartografia-capas2",position:mN,tooltip:pp("layerswitcher").title}},(function(t){t.on(Af,(function(t){UV(t.querySelector(".m-panel-controls"))})),t.on(Hf,(function(t){var e=t.getControls()[0];e.registerEvents(),e.render()})),t.on(Zf,(function(t){t.getControls()[0].unregisterEvents()}))})).panel})),RN(r,RT.NAME,(function(){return new AN({name:RT.NAME,params:{collapsible:!1,className:"m-location",position:vN}}).panel})),RN(r,LR.NAME,(function(){return function(t){var e=t.getPanels("map-info")[0];return _V(e)&&(e=new AN({name:kN,params:{collapsible:!1,className:"m-map-info",position:vN,tooltip:"Coordenadas del puntero"}}).panel),e.addClassName("m-with-mouse"),e}(e)})),RN(r,rL.NAME,(function(){return function(t){var e=t.getPanels("map-info")[0];return _V(e)&&(e=new AN({name:kN,params:{collapsible:!1,className:"m-map-info",position:vN}}).panel),e.addClassName("m-with-overview"),e}(e)})),RN(r,ML.NAME,(function(){return new AN({name:ML.NAME,params:{collapsible:!1,className:"m-panzoom",position:yN}}).panel})),RN(r,Np.NAME,(function(){return new AN({name:Np.NAME,params:{collapsible:!1,className:"m-panzoombar",position:yN,tooltip:"Nivel de zoom"}}).panel})),RN(r,wP.NAME,(function(){return new AN({name:wP.NAME,params:{collapsible:!1,className:"m-rotate",position:mN}}).panel})),RN(r,$T.NAME,(function(){return FN(e)})),RN(r,"".concat($T.NAME,"*true"),(function(){return FN(e)})),RN(r,rR.NAME,(function(){return function(t){return new AN({name:rR.NAME,params:{collapsible:!1,className:"m-scaleline",position:_N,tooltip:"Línea de escala"}},(function(e){NN(e,t)})).panel}(e)})),RN(r,Uv.NAME,(function(){return function(t){var e=t.getPanels("map-info")[0];return _V(e)&&(e=new AN({name:kN,params:{collapsible:!1,className:"m-map-info",position:vN}},(function(e){NN(e,t)})).panel),e.addClassName("m-with-wmcselector"),e}(e)})),r)[t.name];return vV(n)?n():null},jN=r(51),GN=r.n(jN);function zN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var UN=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text_=e,this.coord_=[r.x,r.y],this.popup_=null,this.facadeMap_=null,this.panMapIfOutOfView=n}var e,r,n;return e=t,(r=[{key:"show",value:function(t){this.facadeMap_=t;var e=Sp(GN.a,{vars:{info:this.text_},parseToHtml:!1});t.removePopup(),this.popup_=new CO({panMapIfOutOfView:this.panMapIfOutOfView}),this.popup_.addTab({icon:"g-cartografia-comentarios",title:"Información",content:e}),t.addPopup(this.popup_,this.coord_)}},{key:"hide",value:function(){this.facadeMap_.removePopup()}},{key:"getPopup",value:function(){return this.popup_}},{key:"getCoordinate",value:function(){var t=this.coord;return _V(t)&&(t=this.getPopup().getCoordinate()),t}},{key:"setCoordinate",value:function(t){var e=this.getPopup();_V(e)||e.setCoordinate(t)}}])&&zN(e.prototype,r),n&&zN(e,n),t}();function BN(t){return(BN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qN(t,e){return(qN=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function YN(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=XN(t);if(e){var i=XN(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return WN(this,r)}}function WN(t,e){return!e||"object"!==BN(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function XN(t){return(XN=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HN=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qN(t,e)}(o,t);var e,r,n,i=YN(o);function o(t,e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=new UN(t,e,r);return i.call(this,n)}return e=o,(r=[{key:"hide",value:function(){this.getImpl().hide()}},{key:"show",value:function(t){this.getImpl().show(t)}},{key:"getPopup",value:function(){return this.getImpl().getPopup()}},{key:"getCoordinate",value:function(){return this.getImpl().getCoordinate()}},{key:"setCoordinate",value:function(t){this.getImpl().coordinate=t}}])&&VN(e.prototype,r),n&&VN(e,n),o}(Nf);HN.POPUP_TEMPLATE="label_popup.html";var ZN=HN;function KN(t){return(KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var $N=function t(e){var r;return wV(e)?r=document.getElementById(e):bV(e)?_V(e.id)?_V(e.container)?Of(pp("exception").no_container):r=t(e.container):r=document.getElementById(e.id):Of("El tipo del parámetro container no es válido: ".concat(KN(e))),_V(r)&&Of(pp("exception").no_id_container),r},JN=function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_V(e)&&Of(pp("exception").no_param),this.container=$N(e),this.layers=(wV(r=e)?n=IV("layers",r):bV(r)?n=r.layers:Of("El tipo del parámetro container no es válido: ".concat(KN(r))),n),this.wmc=function(t){var e;return wV(t)?(e=IV("wmc",t),_V(e)&&(e=IV("wmcfile",t)),_V(e)&&(e=IV("wmcfiles",t))):bV(t)?(e=t.wmc,_V(e)&&(e=t.wmcfile),_V(e)&&(e=t.wmcfiles)):Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.wms=function(t){var e;return wV(t)?e=IV("wms",t):bV(t)?e=t.wms:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.wmts=function(t){var e;return wV(t)?e=IV("wmts",t):bV(t)?e=t.wmts:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.kml=function(t){var e;return wV(t)?e=IV("kml",t):bV(t)?e=t.kml:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.controls=function(t){var e;return wV(t)?e=IV("controls",t):bV(t)?e=t.controls:Of("El tipo del parámetro controls no es válido: ".concat(KN(t))),e}(e),this.getfeatureinfo=function(t){var e;return wV(t)?e=IV("getfeatureinfo",t):bV(t)?(e=t.getfeatureinfo,!dV(e)&&_V(e)&&(e="plain")):Of("El tipo del parámetro controls no es válido: ".concat(KN(t))),e}(e),this.maxExtent=function(t){var e;return wV(t)?(e=IV("maxExtent",t),_V(e)&&(e=IV("maxextent",t))):bV(t)?(e=t.maxExtent,_V(e)&&(e=t.maxextent)):Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.bbox=function(t){var e;return wV(t)?e=IV("bbox",t):bV(t)?e=t.bbox:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.zoom=function(t){var e;return wV(t)?e=IV("zoom",t):bV(t)?e=t.zoom:Of("El tipo del parámetro zoom no es válido: ".concat(KN(t))),e}(e),this.center=function(t){var e;return wV(t)?e=IV("center",t):bV(t)?e=t.center:Of("El tipo del parámetro center no es válido: ".concat(KN(t))),e}(e),this.resolutions=function(t){var e;return wV(t)?e=IV("resolutions",t):bV(t)?e=t.resolutions:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.projection=function(t){var e;return wV(t)?e=IV("projection",t):bV(t)?e=t.projection:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.label=function(t){var e;return wV(t)?e=IV("label",t):bV(t)?e=t.label:Of("El tipo del parámetro container no es válido: ".concat(KN(t))),e}(e),this.ticket=function(t){var e;return wV(t)?e=IV("ticket",t):bV(t)?e=t.ticket:Of("El tipo del parámetro ticket no es válido: ".concat(KN(t))),e}(e),this.rotation=function(t){var e=t;return wV(t)?e=IV("rotation",t):bV(t)&&(e=t.rotation),e}(e)};function QN(t){return(QN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eA(t,e){return(eA=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=iA(t);if(e){var i=iA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return nA(this,r)}}function nA(t,e){return!e||"object"!==QN(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iA(t){return(iA=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oA=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eA(t,e)}(o,t);var e,r,n,i=rA(o);function o(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=new aA;return(t=i.call(this,e)).id_=CV("mapea","render_feature"),t}return e=o,(r=[{key:"getId",value:function(){return this.id_}},{key:"getGeometry",value:function(){return null}},{key:"getAttributes",value:function(){return this.getImpl().getAttributes()}},{key:"getType",value:function(){return this.getImpl().getType()}},{key:"getAttribute",value:function(t){var e;if(e=this.getImpl().getAttribute(t),_V(e)){var r=t.split(".");r.length>1&&(e=r.reduce((function(t,e){var r;return _V(t)||(r=t instanceof o?t.getAttribute(e):t[e]),r}),this))}return e}},{key:"equals",value:function(t){return this.getId()===t.getId()}}])&&tA(e.prototype,r),n&&tA(e,n),o}(Nf);function sA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var aA=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.olFeature_=null}var e,r,n;return e=t,n=[{key:"olFeature2Facade",value:function(t,e){var r=null;return _V(t)||(r=new oA).getImpl().setOLFeature(t),r}},{key:"facade2OLFeature",value:function(t){return t.getImpl().getOLFeature()}}],(r=[{key:"getOLFeature",value:function(){return this.olFeature_}},{key:"getType",value:function(){return this.getOLFeature().getType()}},{key:"setOLFeature",value:function(t){_V(t)||(this.olFeature_=t)}},{key:"getAttributes",value:function(){return this.olFeature_.getProperties()}},{key:"getAttribute",value:function(t){return this.olFeature_.get(t)}},{key:"setFacadeObj",value:function(t){this.facadeFeature_=t}},{key:"getCentroid",value:function(){}}])&&sA(e.prototype,r),n&&sA(e,n),t}();function lA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var cA=function(t,e){var r,n=t.getId();return _V(n)||(r=e.getFeatureById(n)),_V(r)&&t instanceof kg&&(r=aA.olFeature2Facade(t)),r},hA=function(){function t(){lA(this,t),this.map_=null,this.defaultCursor_=void 0}var e,r,n;return e=t,(r=[{key:"addTo",value:function(t){this.map_=t}},{key:"getFeaturesByLayer",value:function(t,e){var r=[];if(!_V(e)&&e.isVisible()&&!_V(e.getImpl().getOLLayer())){var n=e.getImpl().getOLLayer();this.map_.getMapImpl().forEachFeatureAtPixel(t.pixel,(function(t,n){if(n instanceof KS&&!_V(t.get("features"))){var i=t.get("features").map((function(t){return cA(t,e)}));if(1===i.length)r.push(i[0]);else{var o=e.getStyle();o instanceof zI||(o=o.getStyles().find((function(t){return t instanceof zI}))),r.push(new Eq(i,{ranges:o.getRanges(),hoverInteraction:o.getOptions().hoverInteraction,maxFeaturesToSelect:o.getOptions().maxFeaturesToSelect,distance:o.getOptions().distance}))}}else Object.prototype.hasOwnProperty.call(t.getProperties(),"selectclusterlink")||r.push(cA(t,e))}),{layerFilter:function(t){var r=!1;return e.getStyle()instanceof zI&&e.getStyle().getOptions().selectInteraction&&(r=t===e.getStyle().getImpl().selectClusterInteraction.getLayer()),r=r||t===n}})}return r}},{key:"addCursorPointer",value:function(){var t=this.map_.getMapImpl().getViewport();"pointer"!==t.style.cursor&&(this.defaultCursor_=t.style.cursor),t.style.cursor="pointer"}},{key:"removeCursorPointer",value:function(){this.map_.getMapImpl().getViewport().style.cursor=this.defaultCursor_}},{key:"destroy",value:function(){this.map_.un("click",this.onMapClick_,this),this.map_=null}}])&&uA(e.prototype,r),n&&uA(e,n),t}();function fA(t){return(fA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pA(t){return function(t){if(Array.isArray(t))return dA(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return dA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dA(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dA(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mA(t,e){return(mA=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bA(t);if(e){var i=bA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vA(this,r)}}function vA(t,e){return!e||"object"!==fA(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bA(t){return(bA=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wA=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mA(t,e)}(o,t);var e,r,n,i=_A(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hA(e);return gA(this,o),(t=i.call(this,r)).map_=null,t.layers_=[],t.activated_=!1,t.prevSelectedFeatures_={},t.prevHoverFeatures_={},vV(r.addTo)||Of(pp("exception").addto_method),vV(r.getFeaturesByLayer)||Of(pp("exception").getfeaturesbylayer_method),t}return e=o,(r=[{key:"addTo",value:function(t){this.map_=t,this.map_.on(cp,this.moveOverMap_.bind(this)),this.map_.on(up,this.clickOnMap_.bind(this)),this.getImpl().addTo(this.map_),this.fire(Af)}},{key:"clickOnMap_",value:function(t){var e=this;if(!0===this.activated_){var r=this.getImpl();this.map_.removePopup(),this.layers_.forEach((function(n){var i=r.getFeaturesByLayer(t,n),o=pA(e.prevSelectedFeatures_[n.name]);if(0===i.length&&o.length>0)e.unselectFeatures(o,n,t);else if(i.length>0){var s=i.filter((function(t){return!o.some((function(e){return e.equals(t)}))})),a=o.filter((function(t){return!i.some((function(e){return e.equals(t)}))}));a.length>0&&e.unselectFeatures(a,n,t),s.length>0&&e.selectFeatures(s,n,t)}}))}}},{key:"moveOverMap_",value:function(t){var e=this;if(!0===this.activated_){var r=this.getImpl();this.layers_.forEach((function(n){var i=r.getFeaturesByLayer(t,n),o=pA(e.prevHoverFeatures_[n.name]);if(0===i.length&&o.length>0)e.leaveFeatures_(o,n,t);else if(i.length>0){var s=i.filter((function(t){return(t instanceof mq||t instanceof oA)&&!o.some((function(e){return e.equals(t)}))})),a=o.filter((function(t){return!i.some((function(e){return e.equals(t)}))}));a.length>0&&e.leaveFeatures_(a,n,t),s.length>0&&e.hoverFeatures_(s,n,t)}}))}}},{key:"selectFeatures",value:function(t,e,r){this.prevSelectedFeatures_[e.name]=this.prevSelectedFeatures_[e.name].concat(t);var n=e.getImpl();vV(n.selectFeatures)&&n.selectFeatures(t,r.coord,r),e.fire($f,[t,r])}},{key:"unselectFeatures",value:function(t,e,r){this.prevSelectedFeatures_[e.name]=this.prevSelectedFeatures_[e.name].filter((function(e){return!t.some((function(t){return t.equals(e)}))}));var n=e.getImpl();vV(n.unselectFeatures)&&n.unselectFeatures(t,r.coord),e.fire(Jf,[t,r.coord])}},{key:"hoverFeatures_",value:function(t,e,r){this.prevHoverFeatures_[e.name]=this.prevHoverFeatures_[e.name].concat(t),e.fire(Qf,[t,r]),this.getImpl().addCursorPointer()}},{key:"leaveFeatures_",value:function(t,e,r){this.prevHoverFeatures_[e.name]=this.prevHoverFeatures_[e.name].filter((function(e){return!t.some((function(t){return t.equals(e)}))})),e.fire(tp,[t,r.coord]),this.getImpl().removeCursorPointer()}},{key:"activate",value:function(){!1===this.activated_&&(this.activated_=!0,this.fire(Wf))}},{key:"deactivate",value:function(){!0===this.activated_&&(this.activated_=!1,this.fire(Xf))}},{key:"addLayer",value:function(t){jV(this.layers_,t)||(this.layers_.push(t),this.prevSelectedFeatures_[t.name]=[],this.prevHoverFeatures_[t.name]=[])}},{key:"removeLayer",value:function(t){this.layers_=this.layers_.filter((function(e){return!e.equals(t)})),this.prevSelectedFeatures_[t.name]=null,this.prevHoverFeatures_[t.name]=null,delete this.prevSelectedFeatures_[t.name],delete this.prevHoverFeatures_[t.name]}},{key:"destroy",value:function(){}},{key:"clearSelectedFeatures",value:function(){var t=this;Object.keys(this.prevSelectedFeatures_).forEach((function(e){t.prevSelectedFeatures_[e]=[]}))}},{key:"clearHoverFeatures",value:function(){var t=this;Object.keys(this.prevHoverFeatures_).forEach((function(e){t.prevHoverFeatures_[e]=[]}))}}])&&yA(e.prototype,r),n&&yA(e,n),o}(Nf),xA=r(52),EA=r.n(xA);function SA(t){return(SA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function OA(t,e){return(OA=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function CA(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=PA(t);if(e){var i=PA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return TA(this,r)}}function TA(t,e){return!e||"object"!==SA(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function PA(t){return(PA=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RA=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&OA(t,e)}(o,t);var e,r,n,i=CA(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).map_=t,n.url_=e,n.format_=r,n}return e=o,(r=[{key:"getLoaderFn",value:function(t){var e=this;return function(r,n,i){e.loadInternal_(i).then((function(e){t(e)}))}}},{key:"loadInternal_",value:function(t){var e=this;return new Promise((function(t,r){uV(e.url_).then((function(r){var n=e.map_.getProjection().code;if(_V(r.text))Of(pp("exception").no_kml_response);else{var i=e.format_.readCustomFeatures(r.text,{featureProjection:n}),o=e.format_.getScreenOverlay(),s=i.map((function(t){var e=new mq(t.getId(),{geometry:{coordinates:t.getGeometry().getCoordinates(),type:t.getGeometry().getType()},properties:t.getProperties()});return e.getImpl().getOLFeature().setStyle(t.getStyle()),e}));t({features:s,screenOverlay:o})}}))}))}}])&&IA(e.prototype,r),n&&IA(e,n),o}(ff);function LA(t){return(LA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var MA,kA,NA,AA,FA,DA,jA=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),GA=["http://www.google.com/kml/ext/2.2"],zA=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],UA={fraction:tw,pixels:ew,insetPixels:ew},BA=cr(zA,{ExtendedData:GF,Region:zF,MultiGeometry:ir(RF,"geometry"),LineString:ir(CF,"geometry"),LinearRing:ir(TF,"geometry"),Point:ir(LF,"geometry"),Polygon:ir(kF,"geometry"),Style:ir(AF),StyleMap:function(t,e){var r=pF.call(this,t,e);if(!r)return;var n=e[e.length-1];Array.isArray(r)?n.Style=r:"string"==typeof r?n.styleUrl=r:ut(!1,38)},address:ir(Cr),description:ir(Cr),name:ir(Cr),open:ir(br),phoneNumber:ir(Cr),styleUrl:ir(cF),visibility:ir(br)},cr(GA,{MultiTrack:ir((function(t,e){var r=fr([],bF,t,e);if(!r)return;return new zg(r)}),"geometry"),Track:ir(xF,"geometry")})),VA=cr(zA,{ExtendedData:GF,Region:zF,Link:function(t,e){hr(qA,t,e)},address:ir(Cr),description:ir(Cr),name:ir(Cr),open:ir(br),phoneNumber:ir(Cr),visibility:ir(br)}),qA=cr(zA,{href:ir(uF)}),YA=cr(zA,{LatLonAltBox:function(t,e){var r=fr({},VF,t,e);if(!r)return;var n=e[e.length-1],i=[parseFloat(r.west),parseFloat(r.south),parseFloat(r.east),parseFloat(r.north)];n.extent=i,n.altitudeMode=r.altitudeMode,n.minAltitude=parseFloat(r.minAltitude),n.maxAltitude=parseFloat(r.maxAltitude)},Lod:function(t,e){var r=fr({},qF,t,e);if(!r)return;var n=e[e.length-1];n.minLodPixels=parseFloat(r.minLodPixels),n.maxLodPixels=parseFloat(r.maxLodPixels),n.minFadeExtent=parseFloat(r.minFadeExtent),n.maxFadeExtent=parseFloat(r.maxFadeExtent)}}),WA=cr(zA,["Document","Placemark"]),XA=cr(zA,{Document:or((function(t,e,r){dr({node:t},ZF,KF,e,r,void 0,this)})),Placemark:or(bD)}),HA=null;var ZA,KA=null;var $A,JA=null;var QA=null;var tF=null;var eF,rF=null;function nF(t){return 32/Math.min(t[0],t[1])}function iF(t){return t}var oF=function(t){function e(e){var r=t.call(this)||this,n=e||{};return rF||(HA=new Kb({color:MA=[255,255,255,1]}),DA="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",KA=new hw({anchor:kA=[20,2],anchorOrigin:rw,anchorXUnits:NA=ew,anchorYUnits:AA=ew,crossOrigin:"anonymous",rotation:0,scale:nF(FA=[64,64]),size:FA,src:DA}),ZA="NO_IMAGE",JA=new Zb({color:MA,width:1}),$A=new Zb({color:[51,51,51,1],width:2}),QA=new Qb({font:"bold 16px Helvetica",fill:HA,stroke:$A,scale:.8}),tF=new ox({fill:HA,image:KA,text:QA,stroke:JA,zIndex:0}),rF=[tF]),r.dataProjection=ye("EPSG:4326"),r.defaultStyle_=n.defaultStyle?n.defaultStyle:rF,r.extractStyles_=void 0===n.extractStyles||n.extractStyles,r.writeStyles_=void 0===n.writeStyles||n.writeStyles,r.sharedStyles_={},r.showPointNames_=void 0===n.showPointNames||n.showPointNames,r.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",r.iconUrlFunction_=n.iconUrlFunction?n.iconUrlFunction:iF,r.supportedMediaTypes=["application/vnd.google-earth.kml+xml"],r}return jA(e,t),e.prototype.readDocumentOrFolder_=function(t,e){var r=fr([],cr(zA,{Document:tr(this.readDocumentOrFolder_,this),Folder:tr(this.readDocumentOrFolder_,this),Placemark:er(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),t,e,this);return r||void 0},e.prototype.readPlacemark_=function(t,e){var r=fr({geometry:null},BA,t,e,this);if(r){var n=new Cg,i=t.getAttribute("id");null!==i&&n.setId(i);var o=e[0],s=r.geometry;if(s&&NL(s,!1,o),n.setGeometry(s),delete r.geometry,this.extractStyles_){var a=function(t,e,r,n,i){return function(o,s){var a=i,l="",u=[];if(a){var c=o.getGeometry();if(c){var h=c.getType();a=h===Yt.GEOMETRY_COLLECTION?(u=c.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e===Yt.POINT||e===Yt.MULTI_POINT}))).length>0:h===Yt.POINT||h===Yt.MULTI_POINT}}a&&(l=o.get("name"),(a=a&&!!l)&&l.search(/&[^&]+;/)>-1&&(eF||(eF=document.createElement("textarea")),eF.innerHTML=l,l=eF.value));var f=r;if(t?f=t:e&&(f=sF(e,r,n)),a){var p=function(t,e){var r=[0,0],n="start",i=t.getImage();if(i){var o=i.getSize();if(o&&2==o.length){var s=i.getScaleArray(),a=i.getAnchor();r[0]=s[0]*(o[0]-a[0]),r[1]=s[1]*(o[1]/2-a[1]),n="left"}}var l=t.getText();l?((l=l.clone()).setFont(l.getFont()||QA.getFont()),l.setScale(l.getScale()||QA.getScale()),l.setFill(l.getFill()||QA.getFill()),l.setStroke(l.getStroke()||$A)):l=QA.clone();return l.setText(e),l.setOffsetX(r[0]),l.setOffsetY(r[1]),l.setTextAlign(n),new ox({image:i,text:l})}(f[0],l);return u.length>0?(p.setGeometry(new Yg(u)),[p,new ox({geometry:f[0].getGeometry(),image:null,fill:f[0].getFill(),stroke:f[0].getStroke(),text:null})].concat(f.slice(1))):p}return f}}(r.Style,r.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);n.setStyle(a)}return delete r.Style,n.setProperties(r,!0),n}},e.prototype.readSharedStyle_=function(t,e){var r=t.getAttribute("id");if(null!==r){var n=AF.call(this,t,e);if(n){var i=void 0,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)i=new URL("#"+r,o).href;else i="#"+r;this.sharedStyles_[i]=n}}},e.prototype.readSharedStyleMap_=function(t,e){var r=t.getAttribute("id");if(null!==r){var n=pF.call(this,t,e);if(n){var i,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)i=new URL("#"+r,o).href;else i="#"+r;this.sharedStyles_[i]=n}}},e.prototype.readFeatureFromNode=function(t,e){if(!Ue(zA,t.namespaceURI))return null;var r=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return r||null},e.prototype.readFeaturesFromNode=function(t,e){if(!Ue(zA,t.namespaceURI))return[];var r,n=t.localName;if("Document"==n||"Folder"==n)return(r=this.readDocumentOrFolder_(t,[this.getReadOptions(t,e)]))||[];if("Placemark"==n){var i=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return i?[i]:[]}if("kml"==n){r=[];for(var o=t.firstElementChild;o;o=o.nextElementSibling){var s=this.readFeaturesFromNode(o,e);s&&qe(r,s)}return r}return[]},e.prototype.readName=function(t){if(t){if("string"==typeof t){var e=Qe(t);return this.readNameFromDocument(e)}return Je(t)?this.readNameFromDocument(t):this.readNameFromNode(t)}},e.prototype.readNameFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE){var r=this.readNameFromNode(e);if(r)return r}},e.prototype.readNameFromNode=function(t){for(var e=t.firstElementChild;e;e=e.nextElementSibling)if(Ue(zA,e.namespaceURI)&&"name"==e.localName)return Cr(e);for(e=t.firstElementChild;e;e=e.nextElementSibling){var r=e.localName;if(Ue(zA,e.namespaceURI)&&("Document"==r||"Folder"==r||"Placemark"==r||"kml"==r)){var n=this.readNameFromNode(e);if(n)return n}}},e.prototype.readNetworkLinks=function(t){var e=[];if("string"==typeof t){var r=Qe(t);qe(e,this.readNetworkLinksFromDocument(r))}else Je(t)?qe(e,this.readNetworkLinksFromDocument(t)):qe(e,this.readNetworkLinksFromNode(t));return e},e.prototype.readNetworkLinksFromDocument=function(t){for(var e=[],r=t.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&qe(e,this.readNetworkLinksFromNode(r));return e},e.prototype.readNetworkLinksFromNode=function(t){for(var e=[],r=t.firstElementChild;r;r=r.nextElementSibling)if(Ue(zA,r.namespaceURI)&&"NetworkLink"==r.localName){var n=fr({},VA,r,[]);e.push(n)}for(r=t.firstElementChild;r;r=r.nextElementSibling){var i=r.localName;!Ue(zA,r.namespaceURI)||"Document"!=i&&"Folder"!=i&&"kml"!=i||qe(e,this.readNetworkLinksFromNode(r))}return e},e.prototype.readRegion=function(t){var e=[];if("string"==typeof t){var r=Qe(t);qe(e,this.readRegionFromDocument(r))}else Je(t)?qe(e,this.readRegionFromDocument(t)):qe(e,this.readRegionFromNode(t));return e},e.prototype.readRegionFromDocument=function(t){for(var e=[],r=t.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&qe(e,this.readRegionFromNode(r));return e},e.prototype.readRegionFromNode=function(t){for(var e=[],r=t.firstElementChild;r;r=r.nextElementSibling)if(Ue(zA,r.namespaceURI)&&"Region"==r.localName){var n=fr({},YA,r,[]);e.push(n)}for(r=t.firstElementChild;r;r=r.nextElementSibling){var i=r.localName;!Ue(zA,r.namespaceURI)||"Document"!=i&&"Folder"!=i&&"kml"!=i||qe(e,this.readRegionFromNode(r))}return e},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var r=Ze(zA[4],"kml"),n="http://www.w3.org/2000/xmlns/";r.setAttributeNS(n,"xmlns:gx",GA[0]),r.setAttributeNS(n,"xmlns:xsi",He),r.setAttributeNS(He,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var i={node:r},o={};t.length>1?o.Document=t:1==t.length&&(o.Placemark=t[0]);var s=WA[r.namespaceURI],a=ur(o,s);return dr(i,XA,lr,a,[e],s,this),r},e}(DL);function sF(t,e,r){return Array.isArray(t)?t:"string"==typeof t?sF(r[t],e,r):e}function aF(t){var e=Ke(t,!1),r=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(r){var n=r[1];return[parseInt(n.substr(6,2),16),parseInt(n.substr(4,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(0,2),16)/255]}}function lF(t){var e=Ke(t,!1),r=[];e=e.replace(/\s*,\s*/g,",");for(var n,i=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;n=i.exec(e);){var o=parseFloat(n[1]),s=parseFloat(n[2]),a=n[3]?parseFloat(n[3]):0;r.push(o,s,a),e=e.substr(n[0].length)}if(""===e)return r}function uF(t){var e=Ke(t,!1).trim(),r=t.baseURI;return r&&"about:blank"!=r||(r=window.location.href),r?new URL(e,r).href:e}function cF(t){var e=Ke(t,!1).trim().replace(/^(?!.*#)/,"#"),r=t.baseURI;return r&&"about:blank"!=r||(r=window.location.href),r?new URL(e,r).href:e}function hF(t){return Er(t)}var fF=cr(zA,{Pair:function(t,e){var r=fr({},UF,t,e,this);if(!r)return;var n=r.key;if(n&&"normal"==n){var i=r.styleUrl;i&&(e[e.length-1]=i);var o=r.Style;o&&(e[e.length-1]=o)}}});function pF(t,e){return fr(void 0,fF,t,e,this)}var dF=cr(zA,{Icon:ir((function(t,e){var r=fr({},EF,t,e);return r||null})),color:ir(aF),heading:ir(Er),hotSpot:ir((function(t){var e,r=t.getAttribute("xunits"),n=t.getAttribute("yunits");return e="insetPixels"!==r?"insetPixels"!==n?rw:iw:"insetPixels"!==n?nw:ow,{x:parseFloat(t.getAttribute("x")),xunits:UA[r],y:parseFloat(t.getAttribute("y")),yunits:UA[n],origin:e}})),scale:ir(hF)});var gF=cr(zA,{color:ir(aF),scale:ir(hF)});var yF=cr(zA,{color:ir(aF),width:ir(Er)});var mF=cr(zA,{color:ir(aF),fill:ir(br),outline:ir(br)});var _F=cr(zA,{coordinates:rr(lF)});function vF(t,e){return fr(null,_F,t,e)}var bF=cr(GA,{Track:er(xF)});var wF=cr(zA,{when:function(t,e){var r=e[e.length-1].whens,n=Ke(t,!1),i=Date.parse(n);r.push(isNaN(i)?0:i)}},cr(GA,{coord:function(t,e){var r=e[e.length-1].coordinates,n=Ke(t,!1),i=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(n);if(i){var o=parseFloat(i[1]),s=parseFloat(i[2]),a=parseFloat(i[3]);r.push([o,s,a])}else r.push([])}}));function xF(t,e){var r=fr({coordinates:[],whens:[]},wF,t,e);if(r){for(var n=[],i=r.coordinates,o=r.whens,s=0,a=Math.min(i.length,o.length);s<a;++s)3==i[s].length&&n.push(i[s][0],i[s][1],i[s][2],o[s]);return new Fg(n,Du)}}var EF=cr(zA,{href:ir(uF)},cr(GA,{x:ir(Er),y:ir(Er),w:ir(Er),h:ir(Er)}));var SF=cr(zA,{coordinates:rr(lF)});function IF(t,e){return fr(null,SF,t,e)}var OF=cr(zA,{extrude:ir(br),tessellate:ir(br),altitudeMode:ir(Cr)});function CF(t,e){var r=fr({},OF,t,e),n=IF(t,e);if(n){var i=new Fg(n,Au);return i.setProperties(r,!0),i}}function TF(t,e){var r=fr({},OF,t,e),n=IF(t,e);if(n){var i=new Rc(n,Au,[n.length]);return i.setProperties(r,!0),i}}var PF=cr(zA,{LineString:er(CF),LinearRing:er(TF),MultiGeometry:er(RF),Point:er(LF),Polygon:er(kF)});function RF(t,e){var r,n=fr([],PF,t,e);if(!n)return null;if(0===n.length)return new Yg(n);for(var i=!0,o=n[0].getType(),s=1,a=n.length;s<a;++s)if(n[s].getType()!=o){i=!1;break}if(i){var l=void 0,u=void 0;if(o==Yt.POINT){var c=n[0];l=c.getLayout(),u=c.getFlatCoordinates();for(s=1,a=n.length;s<a;++s)qe(u,n[s].getFlatCoordinates());FF(r=new jg(u,l),n)}else o==Yt.LINE_STRING?FF(r=new zg(n),n):o==Yt.POLYGON?FF(r=new Bg(n),n):o==Yt.GEOMETRY_COLLECTION?r=new Yg(n):ut(!1,37)}else r=new Yg(n);return r}function LF(t,e){var r=fr({},OF,t,e),n=IF(t,e);if(n){var i=new dc(n,Au);return i.setProperties(r,!0),i}}var MF=cr(zA,{innerBoundaryIs:function(t,e){var r=fr([],YF,t,e);if(r.length>0){var n=e[e.length-1];n.push.apply(n,r)}},outerBoundaryIs:function(t,e){var r=fr(void 0,WF,t,e);if(r){e[e.length-1][0]=r}}});function kF(t,e){var r=fr({},OF,t,e),n=fr([null],MF,t,e);if(n&&n[0]){for(var i=n[0],o=[i.length],s=1,a=n.length;s<a;++s)qe(i,n[s]),o.push(i.length);var l=new Rc(i,Au,o);return l.setProperties(r,!0),l}}var NF=cr(zA,{IconStyle:function(t,e){var r=fr({},dF,t,e);if(r){var n,i,o,s,a=e[e.length-1],l="Icon"in r?r.Icon:{},u=!("Icon"in r)||Object.keys(l).length>0,c=l.href;c?n=c:u&&(n=DA);var h,f=rw,p=r.hotSpot;p?(i=[p.x,p.y],o=p.xunits,s=p.yunits,f=p.origin):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(n)&&(/pushpin/.test(n)?(i=kA,o=NA,s=AA):/arrow-reverse/.test(n)?(i=[54,42],o=NA,s=AA):/paddle/.test(n)&&(i=[32,1],o=NA,s=AA));var d,g=l.x,y=l.y;void 0!==g&&void 0!==y&&(h=[g,y]);var m,_=l.w,v=l.h;void 0!==_&&void 0!==v&&(d=[_,v]);var b=r.heading;void 0!==b&&(m=x(b));var w=r.scale,E=r.color;if(u){n==DA&&(d=FA);var S=new hw({anchor:i,anchorOrigin:f,anchorXUnits:o,anchorYUnits:s,crossOrigin:this.crossOrigin_,offset:h,offsetOrigin:rw,rotation:m,scale:w,size:d,src:this.iconUrlFunction_(n),color:E}),I=S.getScaleArray()[0],O=S.getSize();if(null===O){var C=S.getImageState();if(C===zd||C===Ud){S.listenImageChange((function t(){var e=S.getImageState();if(e!==zd&&e!==Ud){var r=S.getSize();if(r&&2==r.length){var n=nF(r);S.setScale(I*n)}S.unlistenImageChange(t)}})),C===zd&&S.load()}}else if(2==O.length){var T=nF(O);S.setScale(I*T)}a.imageStyle=S}else a.imageStyle=ZA}},LabelStyle:function(t,e){var r=fr({},gF,t,e);if(r){var n=e[e.length-1],i=new Qb({fill:new Kb({color:"color"in r?r.color:MA}),scale:r.scale});n.textStyle=i}},LineStyle:function(t,e){var r=fr({},yF,t,e);if(r){var n=e[e.length-1],i=new Zb({color:"color"in r?r.color:MA,width:"width"in r?r.width:1});n.strokeStyle=i}},PolyStyle:function(t,e){var r=fr({},mF,t,e);if(r){var n=e[e.length-1],i=new Kb({color:"color"in r?r.color:MA});n.fillStyle=i;var o=r.fill;void 0!==o&&(n.fill=o);var s=r.outline;void 0!==s&&(n.outline=s)}}});function AF(t,e){var r=fr({},NF,t,e,this);if(!r)return null;var n,i="fillStyle"in r?r.fillStyle:HA,o=r.fill;void 0===o||o||(i=null),"imageStyle"in r?r.imageStyle!=ZA&&(n=r.imageStyle):n=KA;var s="textStyle"in r?r.textStyle:QA,a="strokeStyle"in r?r.strokeStyle:JA,l=r.outline;return void 0===l||l?[new ox({fill:i,image:n,stroke:a,text:s,zIndex:void 0})]:[new ox({geometry:function(t){var e=t.getGeometry(),r=e.getType();return r===Yt.GEOMETRY_COLLECTION?new Yg(e.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e!==Yt.POLYGON&&e!==Yt.MULTI_POLYGON}))):r!==Yt.POLYGON&&r!==Yt.MULTI_POLYGON?e:void 0},fill:i,image:n,stroke:a,text:s,zIndex:void 0}),new ox({geometry:function(t){var e=t.getGeometry(),r=e.getType();return r===Yt.GEOMETRY_COLLECTION?new Yg(e.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e===Yt.POLYGON||e===Yt.MULTI_POLYGON}))):r===Yt.POLYGON||r===Yt.MULTI_POLYGON?e:void 0},fill:i,stroke:null,zIndex:void 0})]}function FF(t,e){var r,n,i,o=e.length,s=new Array(e.length),a=new Array(e.length),l=new Array(e.length);r=!1,n=!1,i=!1;for(var u=0;u<o;++u){var c=e[u];s[u]=c.get("extrude"),a[u]=c.get("tessellate"),l[u]=c.get("altitudeMode"),r=r||void 0!==s[u],n=n||void 0!==a[u],i=i||l[u]}r&&t.set("extrude",s),n&&t.set("tessellate",a),i&&t.set("altitudeMode",l)}var DF=cr(zA,{displayName:ir(Cr),value:ir(Cr)});var jF=cr(zA,{Data:function(t,e){var r=t.getAttribute("name");hr(DF,t,e);var n=e[e.length-1];r&&n.displayName?n[r]={value:n.value,displayName:n.displayName,toString:function(){return n.value}}:null!==r?n[r]=n.value:null!==n.displayName&&(n[n.displayName]=n.value),delete n.value},SchemaData:function(t,e){hr(BF,t,e)}});function GF(t,e){hr(jF,t,e)}function zF(t,e){hr(YA,t,e)}var UF=cr(zA,{Style:ir(AF),key:ir(Cr),styleUrl:ir(cF)});var BF=cr(zA,{SimpleData:function(t,e){var r=t.getAttribute("name");if(null!==r){var n=Cr(t);e[e.length-1][r]=n}}});var VF=cr(zA,{altitudeMode:ir(Cr),minAltitude:ir(Er),maxAltitude:ir(Er),north:ir(Er),south:ir(Er),east:ir(Er),west:ir(Er)});var qF=cr(zA,{minLodPixels:ir(Er),maxLodPixels:ir(Er),minFadeExtent:ir(Er),maxFadeExtent:ir(Er)});var YF=cr(zA,{LinearRing:er(vF)});var WF=cr(zA,{LinearRing:rr(vF)});function XF(t,e){for(var r=zs(e),n=[255*(4==r.length?r[3]:1),r[2],r[1],r[0]],i=0;i<4;++i){var o=Math.floor(n[i]).toString(16);n[i]=1==o.length?"0"+o:o}Lr(t,n.join(""))}var HF=cr(zA,{Data:or((function(t,e,r){t.setAttribute("name",e.name);var n={node:t},i=e.value;"object"==LA(i)?(null!==i&&i.displayName&&dr(n,HF,lr,[i.displayName],r,["displayName"]),null!==i&&i.value&&dr(n,HF,lr,[i.value],r,["value"])):dr(n,HF,lr,[i],r,["value"])})),value:or((function(t,e){Lr(t,e)})),displayName:or((function(t,e){!function(t,e){t.appendChild(mr().createCDATASection(e))}(t,e)}))});var ZF=cr(zA,{Placemark:or(bD)}),KF=function(t,e,r){return Ze(e[e.length-1].node.namespaceURI,"Placemark")};var $F=ar("Data");var JF=cr(zA,["href"],cr(GA,["x","y","w","h"])),QF=cr(zA,{href:or(Lr)},cr(GA,{x:or(Pr),y:or(Pr),w:or(Pr),h:or(Pr)})),tD=function(t,e,r){return Ze(GA[0],"gx:"+r)};var eD=cr(zA,["scale","heading","Icon","color","hotSpot"]),rD=cr(zA,{Icon:or((function(t,e,r){var n={node:t},i=r[r.length-1].node,o=JF[i.namespaceURI],s=ur(e,o);dr(n,QF,lr,s,r,o),s=ur(e,o=JF[GA[0]]),dr(n,QF,tD,s,r,o)})),color:or(XF),heading:or(Pr),hotSpot:or((function(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)})),scale:or(RD)});var nD=cr(zA,["color","scale"]),iD=cr(zA,{color:or(XF),scale:or(RD)});var oD=cr(zA,["color","width"]),sD=cr(zA,{color:or(XF),width:or(Pr)});var aD={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},lD=function(t,e,r){if(t)return Ze(e[e.length-1].node.namespaceURI,aD[t.getType()])},uD=ar("Point"),cD=ar("LineString"),hD=ar("LinearRing"),fD=ar("Polygon"),pD=cr(zA,{LineString:or(ED),Point:or(ED),Polygon:or(TD),GeometryCollection:or(dD)});function dD(t,e,r){var n,i={node:t},o=e.getType(),s=[];o===Yt.GEOMETRY_COLLECTION?(e.getGeometriesArrayRecursive().forEach((function(t){var e=t.getType();e===Yt.MULTI_POINT?s=s.concat(t.getPoints()):e===Yt.MULTI_LINE_STRING?s=s.concat(t.getLineStrings()):e===Yt.MULTI_POLYGON?s=s.concat(t.getPolygons()):e===Yt.POINT||e===Yt.LINE_STRING||e===Yt.POLYGON?s.push(t):ut(!1,39)})),n=lD):o===Yt.MULTI_POINT?(s=e.getPoints(),n=uD):o===Yt.MULTI_LINE_STRING?(s=e.getLineStrings(),n=cD):o===Yt.MULTI_POLYGON?(s=e.getPolygons(),n=fD):ut(!1,39),dr(i,pD,n,s,r)}var gD=cr(zA,{LinearRing:or(ED)});function yD(t,e,r){dr({node:t},gD,hD,[e],r)}var mD=cr(zA,{ExtendedData:or((function(t,e,r){for(var n={node:t},i=e.names,o=e.values,s=i.length,a=0;a<s;a++)dr(n,HF,$F,[{name:i[a],value:o[a]}],r)})),MultiGeometry:or(dD),LineString:or(ED),LinearRing:or(ED),Point:or(ED),Polygon:or(TD),Style:or((function(t,e,r){var n={node:t},i={};if(e.pointStyles.length){var o=e.pointStyles[0].getText();o&&(i.LabelStyle=o);var s=e.pointStyles[0].getImage();s&&"function"==typeof s.getSrc&&(i.IconStyle=s)}if(e.lineStyles.length){(a=e.lineStyles[0].getStroke())&&(i.LineStyle=a)}if(e.polyStyles.length){var a;(a=e.polyStyles[0].getStroke())&&!i.LineStyle&&(i.LineStyle=a),i.PolyStyle=e.polyStyles[0]}var l=r[r.length-1].node,u=LD[l.namespaceURI],c=ur(i,u);dr(n,MD,lr,c,r,u)})),address:or(Lr),description:or(Lr),name:or(Lr),open:or(Tr),phoneNumber:or(Lr),styleUrl:or(Lr),visibility:or(Tr)}),_D=cr(zA,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),vD=ar("ExtendedData");function bD(t,e,r){var n={node:t};e.getId()&&t.setAttribute("id",e.getId());var i=e.getProperties(),o={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};o[e.getGeometryName()]=1;var s=Object.keys(i||{}).sort().filter((function(t){return!o[t]})),a=e.getStyleFunction();if(a){var l=a(e,0);if(l){var u=Array.isArray(l)?l:[l],c=u;if(e.getGeometry()&&(c=u.filter((function(t){var r=t.getGeometryFunction()(e);if(r){var n=r.getType();return n===Yt.GEOMETRY_COLLECTION?r.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e===Yt.POINT||e===Yt.MULTI_POINT})).length:n===Yt.POINT||n===Yt.MULTI_POINT}}))),this.writeStyles_){var h=u,f=u;e.getGeometry()&&(h=u.filter((function(t){var r=t.getGeometryFunction()(e);if(r){var n=r.getType();return n===Yt.GEOMETRY_COLLECTION?r.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e===Yt.LINE_STRING||e===Yt.MULTI_LINE_STRING})).length:n===Yt.LINE_STRING||n===Yt.MULTI_LINE_STRING}})),f=u.filter((function(t){var r=t.getGeometryFunction()(e);if(r){var n=r.getType();return n===Yt.GEOMETRY_COLLECTION?r.getGeometriesArrayRecursive().filter((function(t){var e=t.getType();return e===Yt.POLYGON||e===Yt.MULTI_POLYGON})).length:n===Yt.POLYGON||n===Yt.MULTI_POLYGON}}))),i.Style={pointStyles:c,lineStyles:h,polyStyles:f}}if(c.length&&void 0===i.name){var p=c[0].getText();p&&(i.name=p.getText())}}}var d=r[r.length-1].node,g=_D[d.namespaceURI],y=ur(i,g);if(dr(n,mD,lr,y,r,g),s.length>0){var m=ur(i,s);dr(n,mD,vD,[{names:s,values:m}],r)}var _=r[0],v=e.getGeometry();v&&(v=NL(v,!0,_)),dr(n,mD,lD,[v],r)}var wD=cr(zA,["extrude","tessellate","altitudeMode","coordinates"]),xD=cr(zA,{extrude:or(Tr),tessellate:or(Tr),altitudeMode:or(Lr),coordinates:or((function(t,e,r){var n,i=r[r.length-1],o=i.layout,s=i.stride;o==Nu||o==Fu?n=2:o==Au||o==Du?n=3:ut(!1,34);var a=e.length,l="";if(a>0){l+=e[0];for(var u=1;u<n;++u)l+=","+e[u];for(var c=s;c<a;c+=s){l+=" "+e[c];for(u=1;u<n;++u)l+=","+e[c+u]}}Lr(t,l)}))});function ED(t,e,r){var n=e.getFlatCoordinates(),i={node:t};i.layout=e.getLayout(),i.stride=e.getStride();var o=e.getProperties();o.coordinates=n;var s=r[r.length-1].node,a=wD[s.namespaceURI],l=ur(o,a);dr(i,xD,lr,l,r,a)}var SD=cr(zA,["color","fill","outline"]),ID=cr(zA,{outerBoundaryIs:or(yD),innerBoundaryIs:or(yD)}),OD=ar("innerBoundaryIs"),CD=ar("outerBoundaryIs");function TD(t,e,r){var n=e.getLinearRings(),i=n.shift(),o={node:t};dr(o,ID,OD,n,r),dr(o,ID,CD,[i],r)}var PD=cr(zA,{color:or(XF),fill:or(Tr),outline:or(Tr)});function RD(t,e){Pr(t,Math.round(1e6*e)/1e6)}var LD=cr(zA,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),MD=cr(zA,{IconStyle:or((function(t,e,r){var n={node:t},i={},o=e.getSrc(),s=e.getSize(),a=e.getImageSize(),l={href:o};if(s){l.w=s[0],l.h=s[1];var u=e.getAnchor(),c=e.getOrigin();if(c&&a&&0!==c[0]&&c[1]!==s[1]&&(l.x=c[0],l.y=a[1]-(c[1]+s[1])),u&&(u[0]!==s[0]/2||u[1]!==s[1]/2)){var h={x:u[0],xunits:ew,y:s[1]-u[1],yunits:ew};i.hotSpot=h}}i.Icon=l;var f=e.getScaleArray()[0],p=s;null===p&&(p=FA),2==p.length&&(f/=nF(p)),1!==f&&(i.scale=f);var d=e.getRotation();0!==d&&(i.heading=d);var g=e.getColor();g&&(i.color=g);var y=r[r.length-1].node,m=eD[y.namespaceURI],_=ur(i,m);dr(n,rD,lr,_,r,m)})),LabelStyle:or((function(t,e,r){var n={node:t},i={},o=e.getFill();o&&(i.color=o.getColor());var s=e.getScale();s&&1!==s&&(i.scale=s);var a=r[r.length-1].node,l=nD[a.namespaceURI],u=ur(i,l);dr(n,iD,lr,u,r,l)})),LineStyle:or((function(t,e,r){var n={node:t},i={color:e.getColor(),width:Number(e.getWidth())||1},o=r[r.length-1].node,s=oD[o.namespaceURI],a=ur(i,s);dr(n,sD,lr,a,r,s)})),PolyStyle:or((function(t,e,r){var n={node:t},i=e.getFill(),o=e.getStroke(),s={color:i?i.getColor():void 0,fill:!!i&&void 0,outline:!!o&&void 0},a=r[r.length-1].node,l=SD[a.namespaceURI],u=ur(s,l);dr(n,PD,lr,u,r,l)}))});var kD=oF;function ND(t){return(ND="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function DD(t,e){return(DD=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=zD(t);if(e){var i=zD(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return GD(this,r)}}function GD(t,e){return!e||"object"!==ND(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zD(t){return(zD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UD=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DD(t,e)}(o,t);var e,r,n,i=jD(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return AD(this,o),(t=i.call(this)).screenOverlay_=null,t.label_=void 0===e.label||e.label,t}return e=o,(r=[{key:"readCustomFeatures",value:function(t,e){var r=this,n=this.readFeatures(t,e).map((function(t){var e=t.getStyle()(t);if(!1===r.label_){var n=[e[0]];t.setStyle(n)}return Array.isArray(e)||(e=[e]),e.forEach((function(t){if(t.getImage()instanceof hw){var e=t.getImage();t.setImage(e)}})),t.set("name",qV(t.get("name"))),t}));return this.readScreenOverlay(t),n}},{key:"readScreenOverlay",value:function(t){var e="xunits",r="yunits",n=Qe(t).querySelector("ScreenOverlay");if(null!==n){var i,s,a,l,u,c,h=n.querySelector("Icon"),f=null!==h?h.querySelector("href").innerHTML:o.DEFAULT_NO_IMAGE_STYLE,p=n.querySelector("overlayXY");null!==p&&(i=[parseFloat(p.getAttribute("x")),parseFloat(p.getAttribute("y"))],s=p.getAttribute(e),a=p.getAttribute(r));var d,g,y,m=n.querySelector("screenXY");null!==m?(l=[parseFloat(m.getAttribute("x")),parseFloat(m.getAttribute("y"))],u=m.getAttribute(e),c=m.getAttribute(r)):f===o.DEFAULT_IMAGE_STYLE_SRC?(l=o.DEFAULT_IMAGE_STYLE_ANCHOR,u=o.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,c=o.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(f)&&(l=[.5,0],u=tw,c=tw);var _,v,b,w=n.querySelector("rotationXY");if(null!==w){var x=parseFloat(w.getAttribute("x"));d=Math.PI/180*x,g=w.getAttribute(e),y=w.getAttribute(r)}var E=n.querySelector("size");null!==E&&(_=[parseFloat(E.getAttribute("x")),parseFloat(E.getAttribute("y"))],v=E.getAttribute(e),b=E.getAttribute(r)),this.screenOverlay_={screenXY:l,screenXUnits:u,screenYUnits:c,overlayXY:i,overlayXUnits:s,overlayYUnits:a,rotationXY:d,rotationXUnits:g,rotationYUnits:y,size:_,sizeXUnits:v,sizeYUnits:b,src:f}}}},{key:"getScreenOverlay",value:function(){return this.screenOverlay_}}])&&FD(e.prototype,r),n&&FD(e,n),o}(kD);UD.DEFAULT_NO_IMAGE_STYLE="NO_IMAGE",UD.DEFAULT_IMAGE_STYLE_SRC="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",UD.DEFAULT_IMAGE_STYLE_ANCHOR=[20,2],UD.DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS="pixels",UD.DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS="pixels";var BD=UD;function VD(t){return(VD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function YD(t,e){return(YD=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function WD(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=HD(t);if(e){var i=HD(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return XD(this,r)}}function XD(t,e){return!e||"object"!==VD(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function HD(t){return(HD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ZD=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&YD(t,e)}(o,t);var e,r,n,i=WD(o);function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t,e)).popup_=null,r.tabPopup_=null,r.loadFeaturesPromise_=null,r.screenOverlayImg_=null,r.label_=t.label,r}return e=o,(r=[{key:"setVisible",value:function(t){if(this.visibility=t,_V(this.ol3Layer)||this.ol3Layer.setVisible(t),!_V(this.screenOverlayImg_)){var e="none";!0===t&&(e="inherit"),this.screenOverlayImg_.style[e]=e}}},{key:"addTo",value:function(t){this.map=t,this.fire(Af),t.on(op,this.setProjection_.bind(this),this),this.formater_=new BD({label:this.label_}),this.loader_=new RA(this.map,this.url,this.formater_),this.ol3Layer=new zS(GV({},this.vendorOptions_,!0)),this.updateSource_(),!1!==this.options.visibility&&this.setVisible(this.inRange()),null!==this.zIndex_&&this.setZIndex(this.zIndex_),this.map.getMapImpl().addLayer(this.ol3Layer)}},{key:"selectFeatures",value:function(t,e,r){var n=t[0];if(!(n instanceof Eq)&&!0===this.extract){var i=n.getAttribute("name"),o=n.getAttribute("description"),s=n.getImpl().getOLFeature().getGeometry().getFirstCoordinate(),a=Sp(EA.a,{vars:{name:i,desc:o},parseToHtml:!1});this.tabPopup_={icon:"g-cartografia-comentarios",title:i,content:a};var l=this.map.getPopup();_V(l)?(this.popup_=new CO,this.popup_.addTab(this.tabPopup_),this.map.addPopup(this.popup_,s)):l.addTab(this.tabPopup_)}}},{key:"unselectFeatures",value:function(){_V(this.popup_)||(this.popup_.hide(),this.popup_=null)}},{key:"updateSource_",value:function(){var t=this;_V(this.vendorOptions_.source)&&this.requestFeatures_().then((function(e){t.ol3Layer.setSource(new Fb({loader:function(){var r=e.screenOverlay;if(t.facadeVector_.clear(),t.facadeVector_.addFeatures(e.features),t.fire(ep,[e.features]),!_V(r)){var n=ry.addOverlayImage(r,t.map);t.setScreenOverlayImg(n)}}})),t.facadeVector_.addFeatures(e.features)}))}},{key:"setScreenOverlayImg",value:function(t){this.screenOverlayImg_=t}},{key:"destroy",value:function(){var t=this.map.getMapImpl();_V(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),this.removePopup(),this.options=null,this.map=null}},{key:"removePopup",value:function(){_V(this.popup_)||(this.popup_.getTabs().length>1?this.popup_.removeTab(this.tabPopup_):this.map.removePopup())}},{key:"getFeaturesExtentPromise",value:function(t,e){var r=this;return new Promise((function(n){var i=r.map.getProjection().code;if(!0===r.isLoaded()){var o=r.getFeatures(t,e),s=ry.getFeaturesExtent(o,i);n(s)}else r.requestFeatures_().then((function(t){var e=ry.getFeaturesExtent(t.features,i);n(e)}))}))}},{key:"requestFeatures_",value:function(){var t=this;return _V(this.loadFeaturesPromise_)&&(this.loadFeaturesPromise_=new Promise((function(e){t.loader_.getLoaderFn((function(t){e(t)}))(null,null,ye(t.map.getProjection().code))}))),this.loadFeaturesPromise_}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.extract===t.extract),e}}])&&qD(e.prototype,r),n&&qD(e,n),o}(jO);function KD(t){return(KD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function JD(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$D(Object(r),!0).forEach((function(e){QD(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$D(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function QD(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ej(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rj(t,e){return(rj=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oj(t);if(e){var i=oj(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ij(this,r)}}function ij(t,e){return!e||"object"!==KD(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oj(t){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rj(t,e)}(o,t);var e,r,n,i=nj(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};tj(this,o);var s=Cd(t,Fp),a=JD(JD({},r),{},{label:s.label}),l=new ZD(a,n);return e=i.call(this,s,r,void 0,l),dV(ZD)&&Of(pp("exception").kmllayer_method),_V(t)&&Of(pp("exception").no_param),e.extract=s.extract,e.options=r,e.label=s.label,e}return e=o,(r=[{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.extract===t.extract),e}},{key:"type",get:function(){return Fp},set:function(t){dV(t)||_V(t)||t===Fp||Of("El tipo de capa debe ser '".concat(Fp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"extract",get:function(){return this.getImpl().extract},set:function(t){_V(t)?this.getImpl().extract=!0:wV(t)?this.getImpl().extract="true"===SV(t):this.getImpl().extract=t}},{key:"options",get:function(){return this.getImpl().options},set:function(t){this.getImpl().options=t}}])&&ej(e.prototype,r),n&&ej(e,n),o}(UC),aj=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function lj(t){if("string"==typeof t){var e=JSON.parse(t);return e||null}return null!==t?t:null}var uj=function(t){function e(){return t.call(this)||this}return aj(e,t),e.prototype.getType=function(){return Tb},e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(lj(t),this.getReadOptions(t,e))},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(lj(t),this.getReadOptions(t,e))},e.prototype.readFeatureFromObject=function(t,e){return Object(st.b)()},e.prototype.readFeaturesFromObject=function(t,e){return Object(st.b)()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(lj(t),this.getReadOptions(t,e))},e.prototype.readGeometryFromObject=function(t,e){return Object(st.b)()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(lj(t))},e.prototype.readProjectionFromObject=function(t){return Object(st.b)()},e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},e.prototype.writeFeatureObject=function(t,e){return Object(st.b)()},e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},e.prototype.writeFeaturesObject=function(t,e){return Object(st.b)()},e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},e.prototype.writeGeometryObject=function(t,e){return Object(st.b)()},e}(kL),cj=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function hj(t,e){if(!t)return null;var r;switch(t.type){case Yt.POINT:r=function(t){return new dc(t.coordinates)}(t);break;case Yt.LINE_STRING:r=function(t){return new Fg(t.coordinates)}(t);break;case Yt.POLYGON:r=function(t){return new Rc(t.coordinates)}(t);break;case Yt.MULTI_POINT:r=function(t){return new jg(t.coordinates)}(t);break;case Yt.MULTI_LINE_STRING:r=function(t){return new zg(t.coordinates)}(t);break;case Yt.MULTI_POLYGON:r=function(t){return new Bg(t.coordinates)}(t);break;case Yt.GEOMETRY_COLLECTION:r=function(t,e){var r=t.geometries.map((function(t){return hj(t,e)}));return new Yg(r)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return NL(r,!1,e)}function fj(t,e){var r,n=(t=NL(t,!0,e)).getType();switch(n){case Yt.POINT:r=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case Yt.LINE_STRING:r=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case Yt.POLYGON:r=function(t,e){var r;e&&(r=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(r)}}(t,e);break;case Yt.MULTI_POINT:r=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case Yt.MULTI_LINE_STRING:r=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case Yt.MULTI_POLYGON:r=function(t,e){var r;e&&(r=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}(t,e);break;case Yt.GEOMETRY_COLLECTION:r=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){var r=V({},e);return delete r.featureProjection,fj(t,r)}))}}(t,e);break;case Yt.CIRCLE:r={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return r}var pj=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this)||this).dataProjection=ye(n.dataProjection?n.dataProjection:"EPSG:4326"),n.featureProjection&&(r.defaultFeatureProjection=ye(n.featureProjection)),r.geometryName_=n.geometryName,r.extractGeometryName_=n.extractGeometryName,r.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],r}return cj(e,t),e.prototype.readFeatureFromObject=function(t,e){var r=null,n=hj((r="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),i=new Cg;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&i.setGeometryName(r.geometry_name),i.setGeometry(n),"id"in r&&i.setId(r.id),r.properties&&i.setProperties(r.properties,!0),i},e.prototype.readFeaturesFromObject=function(t,e){var r=null;if("FeatureCollection"===t.type){r=[];for(var n=t.features,i=0,o=n.length;i<o;++i)r.push(this.readFeatureFromObject(n[i],e))}else r=[this.readFeatureFromObject(t,e)];return r},e.prototype.readGeometryFromObject=function(t,e){return hj(t,e)},e.prototype.readProjectionFromObject=function(t){var e,r=t.crs;return r?"name"==r.type?e=ye(r.properties.name):"EPSG"===r.type?e=ye("EPSG:"+r.properties.code):ut(!1,36):e=this.dataProjection,e},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var r={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(r.id=n),!t.hasProperties())return r;var i=t.getProperties(),o=t.getGeometry();return o&&(r.geometry=fj(o,e),delete i[t.getGeometryName()]),W(i)||(r.properties=i),r},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var r=[],n=0,i=t.length;n<i;++n)r.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:r}},e.prototype.writeGeometryObject=function(t,e){return fj(t,this.adaptOptions(e))},e}(uj);function dj(t){return(dj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mj(t,e,r){return(mj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wj(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function _j(t,e){return(_j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=wj(t);if(e){var i=wj(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return bj(this,r)}}function bj(t,e){return!e||"object"!==dj(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wj(t){return(wj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_j(t,e)}(o,t);var e,r,n,i=vj(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return gj(this,o),i.call(this,t)}return e=o,n=[{key:"readProjectionFromObject",value:function(t){var e,r=t.crs;if(r)if("name"===r.type)e=ye(r.properties.name);else{if("EPSG"!==r.type)throw e=null,new Error("Unknown crs.type: ".concat(r.type));e=ye("EPSG:".concat(r.properties.code))}else e="EPSG:4326";return e}},{key:"applyIcon",value:function(t,e){var r,n=document.createElement("IMG");n.src=e.url,n.width=e.width,n.height=e.height,n.crossOrigin="anonymous",e.anchor&&e.anchor.x&&e.anchor.y&&(r=[e.anchor.x,e.anchor.y]),t.setStyle(new ox({image:new hw({img:n,imgSize:[e.width,e.height],anchor:r})}))}}],(r=[{key:"readFeatureFromObject",value:function(t,e){var r=t,n=mj(wj(o.prototype),"readFeatureFromObject",this).call(this,r,e);return this.geometryName_&&n.setGeometryName(this.geometryName_),_V(r.id)?n.setId(CV("geojson_")):n.setId(r.id),r.properties&&n.setProperties(r.properties),r.click&&(n.click=r.click),r.properties&&r.properties.vendor&&r.properties.vendor.mapea&&r.properties.vendor.mapea.icon&&o.applyIcon(n,r.properties.vendor.mapea.icon),n}},{key:"writeFeatureObject",value:function(t,e){var r=e,n={type:"Feature"},i=t.getId();i&&(n.id=i);var s=t.getGeometry();n.geometry=s?mj(wj(o.prototype),"writeGeometryObject",this).call(this,s,r):null;var a=t.getProperties();return delete a[t.getGeometryName()],_V(a)?n.properties=null:n.properties=a,_V(t.click)||(n.click=t.click),n}},{key:"write",value:function(t){var e=this;return t.map((function(t){return e.writeFeatureObject(t.getImpl().getOLFeature())}))}},{key:"read",value:function(t,e,r){var n=r.code;_V(n)&&(n=_V(r.featureProjection)?ye(r.getCode()):ye(r.featureProjection.getCode()));var i=o.readProjectionFromObject(t);return e.map((function(t){var e=t.id,r=new mq(e,t),o=r.getImpl().getOLFeature(),s=o.getGeometry().transform(i,n);return o.setGeometry(s),r}))}}])&&yj(e.prototype,r),n&&yj(e,n),o}(pj);function Ej(t){return(Ej="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ij(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Oj(t,e){return(Oj=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Pj(t);if(e){var i=Pj(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Tj(this,r)}}function Tj(t,e){return!e||"object"!==Ej(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pj(t){return(Pj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oj(t,e)}(o,t);var e,r,n,i=Cj(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Sj(this,o);var r=new xj(e);return t=i.call(this,r),dV(xj)&&Of(pp("exception").geojson_method),t}return e=o,(r=[{key:"write",value:function(t){var e=t;return mV(e)||(e=[e]),this.getImpl().write(e)}},{key:"read",value:function(t,e){var r=t,n=[];if(!_V(r)){wV(r)&&(r=JSON.parse(r));var i=[];"FeatureCollection"===r.type?i=r.features:"Feature"===r.type&&(i=[r]),n=this.getImpl().read(r,i,e)}return n}}])&&Ij(e.prototype,r),n&&Ij(e,n),o}(Nf);function Lj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var kj=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Lj(this,t),this.rootPrefix=null,this.namespaces={ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",ogc:"http://www.opengis.net/ogc",wmcext:"http://wmcext.org/context"},this.options=e}var e,r,n;return e=t,n=[{key:"getChildValue",value:function(t,e){var r=e||"";if(t)for(var n=t.firstChild;n;n=n.nextSibling)switch(n.nodeType){case 3:case 4:r+=n.nodeValue}return r}}],(r=[{key:"read",value:function(t){var e=t;wV(t)&&(e=Qe(t)),9!==e.nodeType&&Of(pp("exception").must_be_document);var r={};return this.readRoot(r,e),r}},{key:"readRoot",value:function(t,e){var r=t,n=e.documentElement;this.rootPrefix=n.prefix,r.version=n.getAttribute("version"),this.runChildNodes(r,n)}},{key:"runChildNodes",value:function(t,e){for(var r,n,i,o,s=e.childNodes,a=0,l=s.length;a<l;a+=1)1===(r=s[a]).nodeType&&(i=this.getNamespacePrefix(r.namespaceURI),o=r.nodeName.split(":").pop(),(n=this["read".concat(i).concat(o)])&&n.apply(this,[t,r]))}},{key:"getNamespacePrefix",value:function(t){var e=null;if(null===t)e=this.namespaces[this.defaultPrefix];else for(var r=Object.keys(this.namespaces),n=0;n<r.length&&(e=r[n],this.namespaces[e]!==t);n+=1);return e}},{key:"getAttributeNS",value:function(t,e,r){var n="";if(t.getAttributeNS)n=t.getAttributeNS(e,r)||"";else{var i=this.getAttributeNodeNS(t,e,r);i&&(n=i.nodeValue)}return n}}])&&Mj(e.prototype,r),n&&Mj(e,n),t}();function Nj(t){return(Nj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Fj(t,e){return(Fj=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gj(t);if(e){var i=Gj(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return jj(this,r)}}function jj(t,e){return!e||"object"!==Nj(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gj(t){return(Gj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fj(t,e)}(o,t);var e,r,n,i=Dj(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).featureTypeIdx_=0,e.readingFeatureType=!1,e.serviceException_=!1,e}return e=o,(r=[{key:"readRoot",value:function(t,e){var r=e.documentElement;if(/ServiceExceptionReport/i.test(r.localName))this.serviceException_=!0;else{this.rootPrefix=r.prefix;var n=t;n.elementFormDefault=r.getAttribute("elementFormDefault"),n.targetNamespace=r.getAttribute("targetNamespace"),n.targetPrefix=r.getAttribute("targetPrefix"),n.featureTypes=[]}this.runChildNodes(t,r)}},{key:"readogcServiceException",value:function(t,e){VO("Error en el DescribeFeatureType: ".concat(e.textContent.trim()," "))}},{key:"readxsdschema",value:function(t,e){this.runChildNodes(t,e)}},{key:"readxsdimport",value:function(t,e){}},{key:"readxsdcomplexType",value:function(t,e){this.readingFeatureType=!0,t.featureTypes.push({properties:[]}),this.runChildNodes(t,e),this.readingFeatureType=!1}},{key:"readxsdcomplexContent",value:function(t,e){this.runChildNodes(t,e)}},{key:"readxsdextension",value:function(t,e){this.runChildNodes(t,e)}},{key:"readxsdsequence",value:function(t,e){this.runChildNodes(t,e)}},{key:"readxsdelement",value:function(t,e){!0===this.readingFeatureType?t.featureTypes[this.featureTypeIdx_].properties.push({name:e.getAttribute("name"),maxOccurs:e.getAttribute("maxOccurs"),minOccurs:e.getAttribute("minOccurs"),nillable:e.getAttribute("nillable"),type:e.getAttribute("type"),localType:e.getAttribute("type").replace(/^\w+:/g,"")}):(t.featureTypes[this.featureTypeIdx_].typeName=e.getAttribute("name"),this.featureTypeIdx_+=1)}}])&&Aj(e.prototype,r),n&&Aj(e,n),o}(kj);function Uj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Bj=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.typeName_=e,this.outputFormat_=r,this.projection_=n,this.gmlFormatter_=new zj({outputFormat:r,featureType:e,srsName:this.projection_.code})}var e,r,n;return e=t,(r=[{key:"read",value:function(t){var e,r=this,n={};if(/json/gi.test(this.outputFormat_))try{e=JSON.parse(t.text)}catch(t){throw t}return e||(e=this.gmlFormatter_.read(t.text)),n.featureNS=e.targetNamespace,n.featurePrefix=e.targetPrefix,e.featureTypes.some((function(t){return t.typeName===r.typeName_&&(n.properties=t.properties,n.properties.some((function(t){return VV(t.localType)&&(n.geometryName=t.name),VV(t.localType)}))),t.typeName===r.typeName_})),n}}])&&Uj(e.prototype,r),n&&Uj(e,n),t}();function Vj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var qj=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url_=e.url,this.namespace_=e.namespace,this.name_=e.name,this.typeName_=this.name_,_V(this.namespace_)||(this.typeName_=this.namespace_.concat(":").concat(this.name_)),this.version_=e.version,this.ids_=e.ids,this.cql_=e.cql,this.projection_=e.projection,this.getFeatureOutputFormat_=e.getFeatureOutputFormat,_V(this.getFeatureOutputFormat_)&&(this.getFeatureOutputFormat_="application/json"),this.describeFeatureTypeOutputFormat_=e.describeFeatureTypeOutputFormat,this.getFeatureVendor_={},_V(r)||_V(r.getFeature)||(this.getFeatureVendor_=r.getFeature),this.describeFeatureTypeVendor_={},_V(r)||_V(r.describeFeatureType)||(this.describeFeatureTypeVendor_=r.describeFeatureType)}var e,r,n;return e=t,(r=[{key:"getDescribeFeatureType",value:function(){var t={service:"WFS",version:this.version_,request:"DescribeFeatureType",typename:this.typeName_};_V(this.describeFeatureTypeOutputFormat_)||(t.outputFormat=this.describeFeatureTypeOutputFormat_);var e=OV(this.url_,t),r=OV(e,this.describeFeatureTypeVendor_),n=this.describeFeatureTypeOutputFormat_,i=new Bj(this.name_,n,this.projection_);return new Promise((function(t,e){uV(r).then((function(e){t(i.read(e))}))}))}},{key:"getFeatureUrl",value:function(t,e){var r=this,n={service:"WFS",version:this.version_,request:"GetFeature",typename:this.typeName_,outputFormat:this.getFeatureOutputFormat_,srsname:e.getCode()};return _V(this.ids_)||(n.featureId=this.ids_.map((function(t){return r.name_.concat(".").concat(t)}))),_V(this.cql_)?_V(t)||(n.bbox="".concat(t.join(","),",").concat(e.getCode())):n.CQL_FILTER=this.cql_,OV(OV(this.url_,n),this.getFeatureVendor_)}}])&&Vj(e.prototype,r),n&&Vj(e,n),t}(),Yj=KL;Yj.prototype.writeFeatures,Yj.prototype.writeFeaturesNode;var Wj=Yj;function Xj(t){return(Xj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zj(t,e){return(Zj=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Kj(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Jj(t);if(e){var i=Jj(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $j(this,r)}}function $j(t,e){return!e||"object"!==Xj(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jj(t){return(Jj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zj(t,e)}(r,t);var e=Kj(r);function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Hj(this,r),e.call(this,t)}return r}(Wj);function tG(t){return(tG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rG(t,e){return(rG=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nG(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oG(t);if(e){var i=oG(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return iG(this,r)}}function iG(t,e){return!e||"object"!==tG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oG(t){return(oG=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rG(t,e)}(o,t);var e,r,n,i=nG(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).map_=t,n.service_=e,n.format_=r,n}return e=o,(r=[{key:"getLoaderFn",value:function(t){var e=this;return function(r,n,i){var o=e.getRequestUrl_(r,i);e.loadInternal_(o,i).then(t.bind(e))}}},{key:"loadInternal_",value:function(t,e){var r=this,n=t;return new Promise((function(t,i){wV(M.config.ticket)&&(n=OV(n,{ticket:M.config.ticket})),uV(n).then((function(n){if(!_V(n.text)&&n.text.indexOf("ServiceExceptionReport")<0){var i=r.format_.read(n.text,e);t(i)}else 401===n.code?VO(pp("dialog").unauthorized_user):n.text.indexOf("featureId and cql_filter")>=0?VO(pp("dialog").only_one_filter):Of(pp("exception").no_getfeature_response)}))}))}},{key:"getRequestUrl_",value:function(t,e){return this.service_.getFeatureUrl(null,e)}}])&&eG(e.prototype,r),n&&eG(e,n),o}(ff);function aG(t){return(aG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cG(t,e,r){return(cG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dG(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function hG(t,e){return(hG=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function fG(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=dG(t);if(e){var i=dG(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return pG(this,r)}}function pG(t,e){return!e||"object"!==aG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dG(t){return(dG=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hG(t,e)}(o,t);var e,r,n,i=fG(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return lG(this,o),(t=i.call(this,e,r)).describeFeatureType_=null,t.formater_=null,t.loader_=null,t.service_=null,t.loaded_=!1,_V(t.options.getFeatureOutputFormat)&&(t.options.getFeatureOutputFormat="application/json"),t}return e=o,(r=[{key:"addTo",value:function(t){var e=this;cG(dG(o.prototype),"addTo",this).call(this,t),t.getImpl().on(np,(function(){return e.refresh()}))}},{key:"refresh",value:function(t){t&&this.facadeVector_.removeFeatures(this.facadeVector_.getFeatures(!0)),this.updateSource_(t)}},{key:"updateSource_",value:function(t){var e=this;_V(this.vendorOptions_.source)&&(this.service_=new qj({url:this.url,namespace:this.namespace,name:this.name,version:this.version,ids:this.ids,cql:this.cql,projection:this.map.getProjection(),getFeatureOutputFormat:this.options.getFeatureOutputFormat,describeFeatureTypeOutputFormat:this.options.describeFeatureTypeOutputFormat},this.options.vendor),/json/gi.test(this.options.getFeatureOutputFormat)?this.formater_=new Rj({defaultDataProjection:ye(this.map.getProjection().code)}):this.formater_=new Qj(this.name,this.version,this.map.getProjection()),this.loader_=new sG(this.map,this.service_,this.formater_),this.requestFeatures_().then((function(r){var n=e.facadeVector_.getStyle()instanceof zI,i=null;if(_V(e.ol3Layer)||(i=e.ol3Layer.getSource()),!0===t||_V(i)){var o=new Fb({loader:function(){e.loaded_=!0,e.facadeVector_.addFeatures(r),e.fire(ep,[r]),e.facadeVector_.redraw()}});if(n){var s=e.facadeVector_.getStyle().getOptions().distance,a=new jb({distance:s,source:o});e.ol3Layer.setStyle(e.facadeVector_.getStyle().getImpl().olStyleFn),e.ol3Layer.setSource(a)}else e.ol3Layer&&e.ol3Layer.setSource(o)}else n&&(i=i.getSource()),i.set("format",e.formater_),i.set("loader",e.loader_.getLoaderFn((function(t){e.loaded_=!0,e.facadeVector_.addFeatures(t),e.fire(ep,[t]),e.facadeVector_.redraw()}))),i.set("strategy",Ob),n||i.changed()})))}},{key:"getFeaturesExtentPromise",value:function(t,e){var r=this;return new Promise((function(n){var i=r.map.getProjection().code;if(!0===r.isLoaded()){var o=r.getFeatures(t,e),s=ry.getFeaturesExtent(o,i);n(s)}else r.requestFeatures_().then((function(t){var e=ry.getFeaturesExtent(t,i);n(e)}))}))}},{key:"setCQL",value:function(t){this.cql=t,this.refresh(!0)}},{key:"getDescribeFeatureType",value:function(){var t=this;return _V(this.describeFeatureType_)&&(this.describeFeatureType_=this.service_.getDescribeFeatureType().then((function(e){return _V(e)||(t.formater_=new xj({geometryName:e.geometryName,defaultDataProjection:ye(t.map.getProjection().code)})),e}))),this.describeFeatureType_}},{key:"getDefaultValue",value:function(t){return"dateTime"===t?"0000-00-00T00:00:00":"date"===t?"0000-00-00":"time"===t?"00:00:00":"duration"===t?"P0Y":"int"===t||"number"===t||"float"===t||"double"===t||"decimal"===t||"short"===t||"byte"===t||"integer"===t||"long"===t||"negativeInteger"===t||"nonNegativeInteger"===t||"nonPositiveInteger"===t||"positiveInteger"===t||"unsignedLong"===t||"unsignedInt"===t||"unsignedShort"===t||"unsignedByte"===t?0:"hexBinary"===t?null:"-"}},{key:"isLoaded",value:function(){return this.loaded_}},{key:"requestFeatures_",value:function(){var t=this;return new Promise((function(e){t.loader_.getLoaderFn((function(t){e(t)}))(null,null,ye(t.map.getProjection().code))}))}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.namespace===t.namespace,e=e&&this.name===t.name,e=e&&this.ids===t.ids,e=e&&this.cql===t.cql,e=e&&this.version===t.version),e}}])&&uG(e.prototype,r),n&&uG(e,n),o}(jO),yG="POINT",mG="LINE",_G="POLYGON",vG="MPOINT",bG="MLINE",wG="MPOLYGON",xG=function(t){var e=SV(t,!0);return a[e]};function EG(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function SG(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?EG(Object(r),!0).forEach((function(e){IG(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EG(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function IG(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OG(t){return(OG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function PG(t,e,r){return(PG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=kG(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function RG(t,e){return(RG=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function LG(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kG(t);if(e){var i=kG(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return MG(this,r)}}function MG(t,e){return!e||"object"!==OG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kG(t){return(kG=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var NG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&RG(t,e)}(o,t);var e,r,n,i=LG(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new gG(r,n);CG(this,o);var a=Cd(t,jp);return e=i.call(this,a,r,void 0,s),dV(gG)&&Of(pp("exception").wfslayer_method),_V(t)&&Of(pp("exception").no_param),e.namespace=a.namespace,e.legend=a.legend,e.cql=a.cql,e.geometry=a.geometry,e.ids=a.ids,e.version=a.version,e.options=r,e.extract=a.extract,e}return e=o,(r=[{key:"setCQL",value:function(t){var e=this,r=t;this.getImpl().getDescribeFeatureType().then((function(t){if(!_V(r)){var n=t.geometryName;r=r.replace(/{{geometryName}}/g,n)}e.getImpl().cql!==r&&e.getImpl().setCQL(r)}))}},{key:"setStyle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.DEFAULT_OPTIONS_STYLE;PG(kG(o.prototype),"setStyle",this).call(this,t,e,r)}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.namespace===t.namespace,e=e&&this.name===t.name,e=e&&this.ids===t.ids,e=e&&this.cql===t.cql,e=e&&this.version===t.version),e}},{key:"type",get:function(){return jp},set:function(t){dV(t)||_V(t)||t===jp||Of("El tipo de capa debe ser '".concat(jp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"namespace",get:function(){return this.getImpl().namespace},set:function(t){this.getImpl().namespace=t}},{key:"legend",get:function(){return this.getImpl().legend},set:function(t){_V(t)?this.getImpl().legend=this.name:this.getImpl().legend=t}},{key:"cql",get:function(){return this.getImpl().cql},set:function(t){this.getImpl().cql=t}},{key:"geometry",get:function(){return this.getImpl().geometry},set:function(t){if(!_V(t)){var e=xG(t);_V(e)&&Of("El tipo de capa WFS <b>".concat(t,"</b> no se reconoce. Los tipos disponibles son: POINT, LINE, POLYGON, MPOINT, MLINE, MPOLYGON")),this.getImpl().geometry=e}}},{key:"ids",get:function(){return this.getImpl().ids},set:function(t){_V(t)?this.getImpl().ids=this.ids:this.getImpl().ids=t}},{key:"version",get:function(){return this.getImpl().version},set:function(t){_V(t)?this.getImpl().version="1.0.0":this.getImpl().version=t}}])&&TG(e.prototype,r),n&&TG(e,n),o}(UC);NG.DEFAULT_PARAMS={fill:{color:"rgba(103, 175, 19, 0.2)",opacity:.4},stroke:{color:"#67af13",width:1}},NG.DEFAULT_OPTIONS_STYLE={point:SG(SG({},NG.DEFAULT_PARAMS),{},{radius:5}),line:SG({},NG.DEFAULT_PARAMS),polygon:SG({},NG.DEFAULT_PARAMS)};var AG=NG;function FG(t){return(FG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function DG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function GG(t,e){return(GG=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zG(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=BG(t);if(e){var i=BG(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return UG(this,r)}}function UG(t,e){return!e||"object"!==FG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function BG(t){return(BG=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var VG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&GG(t,e)}(o,t);var e,r,n,i=zG(o);function o(){return DG(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"readsldMinScaleDenominator",value:function(t,e){t.options.minScale=parseFloat(kj.getChildValue(e))}},{key:"readolgroup",value:function(t,e){var r=t;if(mV(r)){var n=r[0],i=r[1],o=n.layerGroups,s=new sb({id:e.getAttribute("id"),title:e.getAttribute("title"),order:e.getAttribute("orderInsideGroupDisplay")});_V(i)?o.push(s):i.addChild(s),this.runChildNodes([n,s],e)}else r.layerGroups=[],this.runChildNodes([r],e)}},{key:"readwmcLayer",value:function(t,e){var r=t,n={params:this.layerParams||{},options:{visibility:"1"!==e.getAttribute("hidden"),queryable:"1"===e.getAttribute("queryable")},formats:[],styles:[]};this.runChildNodes(n,e),n.params.isWMC="ok",n.params.layers=n.name,n.options.wmcMaxExtent=n.maxExtent,n.options.wmcGlobalMaxExtent=r.maxExtent;var i=this.getLayerFromInfo(n),o=n.options.groupDisplayLayerSwitcher,s=n.options.orderInsideGroupDisplayLayerSwitcher,a=r.layerGroups,l=sb.findGroupById(o,a);if(null!=n.styles&&null!=n.styles[0]){var u=n.styles[0];if(null!=u.legend&&u.legend.href){var c=u.legend.href;i.setLegendURL(c)}}_V(l)?(_V(r.layers)&&(r.layers=[]),r.layers.push(i)):l.addChild(i,parseInt(s,10))}},{key:"getLayerFromInfo",value:function(t){var e=t.options;return e.params=t.params,new q_({name:t.name,legend:t.title,url:t.href,transparent:!/^1|(true)$/i.test(e.isBaseLayer)},e)}},{key:"readolunits",value:function(t,e){t.units=kj.getChildValue(e)}},{key:"readoltileSize",value:function(t,e){t.tileSize={width:parseFloat(e.getAttribute("width")),height:parseFloat(e.getAttribute("height"))}}},{key:"readolgroupDisplayLayerSwitcher",value:function(t,e){t.options.groupDisplayLayerSwitcher=kj.getChildValue(e)}},{key:"readolorderInsideGroupDisplayLayerSwitcher",value:function(t,e){t.options.orderInsideGroupDisplayLayerSwitcher=kj.getChildValue(e)}},{key:"readsldMaxScaleDenominator",value:function(t,e){t.options.maxScale=parseFloat(kj.getChildValue(e))}},{key:"readwmcStyle",value:function(t,e){var r=t,n={};this.runChildNodes(n,e),"1"===e.getAttribute("current")&&(n.legend&&(r.params.layerLegend=n.legend),n.href?r.params.sld=n.href:n.body?r.params.sld_body=n.body:r.params.styles=n.name),r.styles.push(n)}},{key:"readwmcGeneral",value:function(t,e){this.runChildNodes(t,e)}},{key:"readwmcBoundingBox",value:function(t,e){var r=t;r.projection=e.getAttribute("SRS"),r.bounds=[parseFloat(e.getAttribute("minx")),parseFloat(e.getAttribute("miny")),parseFloat(e.getAttribute("maxx")),parseFloat(e.getAttribute("maxy"))]}},{key:"readwmcLayerList",value:function(t,e){var r=t;r.layers=[],this.runChildNodes(r,e)}},{key:"readwmcExtension",value:function(t,e){this.runChildNodes(t,e)}},{key:"readolmaxExtent",value:function(t,e){var r=t,n=[parseFloat(e.getAttribute("minx")),parseFloat(e.getAttribute("miny")),parseFloat(e.getAttribute("maxx")),parseFloat(e.getAttribute("maxy"))],i=this.options.projection,o=r.projection;_V(i)||_V(o)||i===o||(o=ye(o),i=ye(i),n=ry.transformExtent(n,o,i)),r.maxExtent=n}},{key:"readoltransparent",value:function(t,e){t.params.transparent=kj.getChildValue(e)}},{key:"readolnumZoomLevels",value:function(t,e){t.options.numZoomLevels=parseInt(kj.getChildValue(e),10)}},{key:"readolopacity",value:function(t,e){t.options.opacity=parseFloat(kj.getChildValue(e))}},{key:"readolsingleTile",value:function(t,e){t.options.singleTile="true"===kj.getChildValue(e)}},{key:"readolisBaseLayer",value:function(t,e){t.options.isBaseLayer="true"===kj.getChildValue(e)}},{key:"readoldisplayInLayerSwitcher",value:function(t,e){var r=t,n=SV(kj.getChildValue(e));r.options.displayInLayerSwitcher="true"===n}},{key:"readwmcServer",value:function(t,e){var r=t;r.params.version=e.getAttribute("version"),this.runChildNodes(r,e)}},{key:"readwmcFormatList",value:function(t,e){this.runChildNodes(t,e)}},{key:"readwmcFormat",value:function(t,e){var r=t,n=kj.getChildValue(e);r.formats.push(n),"1"===e.getAttribute("current")&&(r.params.format=n)}},{key:"readwmcStyleList",value:function(t,e){this.runChildNodes(t,e)}},{key:"readwmcSLD",value:function(t,e){this.runChildNodes(t,e)}},{key:"readsldStyledLayerDescriptor",value:function(t,e){t.body=Ke(e)}},{key:"readwmcOnlineResource",value:function(t,e){t.href=this.getAttributeNS(e,this.namespaces.xlink,"href")}},{key:"readwmcName",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.name=n)}},{key:"readwmcTitle",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.title=n)}},{key:"readwmcMetadataURL",value:function(t,e){var r=t,n={},i=e.getElementsByTagName("OnlineResource");i.length>0&&this.readwmcOnlineResource(n,i[0]),r.options.metadataURL=n.href}},{key:"readwmcextmetadata",value:function(t,e){t.options.metadataUrl=e&&e.innerHTML}},{key:"readwmcAbstract",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.abstract=n)}},{key:"readwmcLatLonBoundingBox",value:function(t,e){t.llbbox=[parseFloat(e.getAttribute("minx")),parseFloat(e.getAttribute("miny")),parseFloat(e.getAttribute("maxx")),parseFloat(e.getAttribute("maxy"))]}},{key:"readwmcLegendURL",value:function(t,e){var r=t,n={width:e.getAttribute("width"),height:e.getAttribute("height")},i=e.getElementsByTagName("OnlineResource");i.length>0&&this.readwmcOnlineResource(n,i[0]),r.legend=n}},{key:"readsldFeatureTypeStyle",value:function(t,e){t.body=Ke(e)}},{key:"readwmcKeywordList",value:function(t,e){var r=t;r.keywords=[],this.runChildNodes(r.keywords,e)}},{key:"readwmcKeyword",value:function(t,e){t.push(kj.getChildValue(e))}},{key:"readwmcLogoURL",value:function(t,e){t.logo={width:e.getAttribute("width"),height:e.getAttribute("height"),format:e.getAttribute("format"),href:this.getOnlineResource_href(e)}}},{key:"readwmcDescriptionURL",value:function(t,e){t.descriptionURL=this.getOnlineResource_href(e)}},{key:"readwmcContactInformation",value:function(t,e){var r=t,n={};this.runChildNodes(n,e),r.contactInformation=n}},{key:"readwmcContactPersonPrimary",value:function(t,e){var r=t,n={};this.runChildNodes(n,e),r.personPrimary=n}},{key:"readwmcContactPerson",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.person=n)}},{key:"readwmcContactOrganization",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.organization=n)}},{key:"readwmcContactPosition",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.position=n)}},{key:"readwmcContactAddress",value:function(t,e){var r=t,n={};this.runChildNodes(n,e),r.contactAddress=n}},{key:"readwmcAddressType",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.type=n)}},{key:"readwmcAddress",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.address=n)}},{key:"readwmcCity",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.city=n)}},{key:"readwmcStateOrProvince",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.stateOrProvince=n)}},{key:"readwmcPostCode",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.postcode=n)}},{key:"readwmcCountry",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.country=n)}},{key:"readwmcContactVoiceTelephone",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.phone=n)}},{key:"readwmcContactFacsimileTelephone",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.fax=n)}},{key:"readwmcContactElectronicMailAddress",value:function(t,e){var r=t,n=kj.getChildValue(e);n&&(r.email=n)}},{key:"readwmcDataURL",value:function(t,e){t.dataURL=this.getOnlineResource_href(e)}},{key:"readwmcDimensionList",value:function(t,e){var r=t;r.dimensions={},this.runChildNodes(r.dimensions,e)}},{key:"readwmcDimension",value:function(t,e){var r=t,n={name:e.getAttribute("name").toLowerCase(),units:e.getAttribute("units")||"",unitSymbol:e.getAttribute("unitSymbol")||"",userValue:e.getAttribute("userValue")||"",nearestValue:"1"===e.getAttribute("nearestValue"),multipleValues:"1"===e.getAttribute("multipleValues"),current:"1"===e.getAttribute("current"),default:e.getAttribute("default")||""},i=kj.getChildValue(e);n.values=i.split(","),r[n.name]=n}}])&&jG(e.prototype,r),n&&jG(e,n),o}(kj);function qG(t){return(qG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function YG(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function WG(t,e){return(WG=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XG(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ZG(t);if(e){var i=ZG(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return HG(this,r)}}function HG(t,e){return!e||"object"!==qG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ZG(t){return(ZG=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var KG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&WG(t,e)}(o,t);var e,r,n,i=XG(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).version=null,e.parser=null,e}return e=o,(r=[{key:"readFromDocument",value:function(t){9!==t.nodeType&&Of(pp("exception").must_be_document);var e=t.documentElement;this.version=e.getAttribute("version"),this.version||(this.version=o.DEFAULT_VERSION);var r="v".concat(SV(this.version).replace(/\./g,""));return this.parser=new o[r](this.options),this.parser.read(t)}}])&&YG(e.prototype,r),n&&YG(e,n),o}(kj);KG.v110=VG;var $G=KG;function JG(t){return(JG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function QG(t){return function(t){if(Array.isArray(t))return tz(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return tz(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tz(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tz(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ez(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rz(t,e){return(rz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oz(t);if(e){var i=oz(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return iz(this,r)}}function iz(t,e){return!e||"object"!==JG(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oz(t){return(oz=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rz(t,e)}(o,t);var e,r,n,i=nz(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).selected=!1,e.layers=[],e.groups=[],e.loadContextPromise=null,e.maxExtent=null,e.extentProj_=null,e}return e=o,(r=[{key:"addTo",value:function(t){this.map=t,this.fire(Af)}},{key:"select",value:function(){var t=this;!1===this.selected&&(this.map.getWMC().forEach((function(t){return t.unselect()})),this.selected=!0,this.loadContextPromise=new Promise((function(e,r){uV(t.url).then((function(r){var n;!1===t.map.defaultProj&&(n=t.map.getProjection().code);var i=r.xml,o=new $G({projection:n}).readFromDocument(i);e.call(t,o)}))})),this.loadContextPromise.then((function(e){if(t.map.defaultProj){var r=ye(e.projection);t.map.setProjection({code:r.getCode(),units:r.getUnits()},!0)}t.loadLayers(e),t.map.fire(ip,t)})))}},{key:"unselect",value:function(){if(!0===this.selected&&(this.selected=!1,_V(this.layers)||this.map.removeLayers(this.layers),!_V(this.groups))){var t=QG(this.groups);this.groups=[],this.map.removeLayerGroup(t)}}},{key:"loadLayers",value:function(t){var e=this;this.layers=t.layers,this.maxExtent=t.maxExtent,_V(t.layerGroups)?this.groups=[]:this.groups=this.groups.concat(t.layerGroups),this.layers.forEach((function(t){return t.setWMCParent(e.facadeLayer_)})),this.map.addWMS(this.layers,!0),this.map.addLayerGroup(this.groups),this.layers.forEach((function(t,r){return t.setZIndex(e.getZIndex()+r)})),this.groups.forEach((function(t,r){return t.setZIndex(e.getZIndex()+r)})),this.facadeLayer_.fire(ep,[this.layers]),this.facadeLayer_.fire(ep,[this.groups])}},{key:"setFacadeObj",value:function(t){this.facadeLayer_=t}},{key:"getMaxExtent",value:function(t){var e=this;return _V(this.maxExtent)&&this.loadContextPromise.then((function(r){e.maxExtent=r.maxExtent,vV(t)&&t(e.maxExtent)})),!_V(this.maxExtent)&&vV(t)&&t(this.maxExtent),this.maxExtent}},{key:"calculateMaxExtent",value:function(){var t=this;return new Promise((function(e){return t.getMaxExtent(e)}))}},{key:"getLayers",value:function(){return this.layers}},{key:"destroy",value:function(){_V(this.layers)||this.map.removeLayers(this.layers),this.map=null,this.layers.length=0,this.wmcDocument=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name),e}}])&&ez(e.prototype,r),n&&ez(e,n),o}(cy);function az(t){return(az="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uz(t,e){return(uz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fz(t);if(e){var i=fz(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hz(this,r)}}function hz(t,e){return!e||"object"!==az(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fz(t){return(fz=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uz(t,e)}(o,t);var e,r,n,i=cz(o);function o(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=new sz(e),s=Cd(t,Ap);if(r=i.call(this,s,n),dV(sz)&&Of(pp("exception").wmclayer_method),_V(t)&&Of(pp("exception").no_param),r.options=e,!_V(r.url)&&_V(r.name))r.generateName_();else if(_V(r.url)&&!_V(r.name)){var a=M.config.predefinedWMC.predefinedNames.indexOf(r.name);-1===a?Of("El contexto predefinido '".concat(r.name,"'no existe")):(r.url=M.config.predefinedWMC.urls[a],r.name=M.config.predefinedWMC.names[a])}return r.loaded_=!1,r.once(ep,(function(){r.setLoaded(!0)})),r}return e=o,(r=[{key:"getMaxExtent",value:function(t){return this.getImpl().getMaxExtent(t)}},{key:"calculateMaxExtent",value:function(){return this.getImpl().calculateMaxExtent()}},{key:"select",value:function(){dV(this.getImpl().select)&&Of(pp("exception").select_method),this.getImpl().select()}},{key:"unselect",value:function(){dV(this.getImpl().unselect)&&Of(pp("exception").unselect_method),this.getImpl().unselect()}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name),e}},{key:"isLoaded",value:function(){return this.loaded_}},{key:"setLoaded",value:function(t){this.loaded_=t}},{key:"selected",get:function(){return this.getImpl().selected},set:function(t){this.getImpl().selected=t}},{key:"type",get:function(){return Ap},set:function(t){dV(t)||_V(t)||t===Ap||Of("El tipo de capa debe ser '".concat(Ap).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"layers",get:function(){return this.getImpl().layers},set:function(t){this.getImpl().layers=t}},{key:"projection",get:function(){return this.getImpl().projection},set:function(t){this.getImpl().projection=t}},{key:"maxExtent",set:function(t){this.getImpl().maxExtent=t}},{key:"options",get:function(){return this.getImpl().options},set:function(t){this.getImpl().options=t}}])&&lz(e.prototype,r),n&&lz(e,n),o}(Ad),dz="KVP",gz="REST",yz=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),mz=function(t){function e(e){var r=t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;return r.matrixIds_=e.matrixIds,r}return yz(e,t),e.prototype.getMatrixId=function(t){return this.matrixIds_[t]},e.prototype.getMatrixIds=function(){return this.matrixIds_},e}(gg),_z=mz;function vz(t,e,r){var n=[],i=[],o=[],s=[],a=[],l=void 0!==r?r:[],u=ye(t.SupportedCRS),c=u.getMetersPerUnit(),h="ne"==u.getAxisOrientation().substr(0,2);return t.TileMatrix.sort((function(t,e){return e.ScaleDenominator-t.ScaleDenominator})),t.TileMatrix.forEach((function(e){if(!(l.length>0)||Ye(l,(function(r){return e.Identifier==r.TileMatrix||-1===e.Identifier.indexOf(":")&&t.Identifier+":"+e.Identifier===r.TileMatrix}))){i.push(e.Identifier);var r=28e-5*e.ScaleDenominator/c,u=e.TileWidth,f=e.TileHeight;h?o.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):o.push(e.TopLeftCorner),n.push(r),s.push(u==f?u:[u,f]),a.push([e.MatrixWidth,e.MatrixHeight])}})),new mz({extent:e,origins:o,resolutions:n,matrixIds:i,tileSizes:s,sizes:a})}var bz=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wz=function(t){function e(e){var r=this,n=void 0!==e.requestEncoding?e.requestEncoding:dz,i=e.tileGrid,o=e.urls;return void 0===o&&void 0!==e.url&&(o=Gm(e.url)),(r=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,imageSmoothing:e.imageSmoothing,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:o,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection})||this).version_=void 0!==e.version?e.version:"1.0.0",r.format_=void 0!==e.format?e.format:"image/jpeg",r.dimensions_=void 0!==e.dimensions?e.dimensions:{},r.layer_=e.layer,r.matrixSet_=e.matrixSet,r.style_=e.style,r.requestEncoding_=n,r.setKey(r.getKeyForDimensions_()),o&&o.length>0&&(r.tileUrlFunction=Dm(o.map(r.createFromWMTSTemplate.bind(r)))),r}return bz(e,t),e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(Dm(t.map(this.createFromWMTSTemplate.bind(this))),e)},e.prototype.getDimensions=function(){return this.dimensions_},e.prototype.getFormat=function(){return this.format_},e.prototype.getLayer=function(){return this.layer_},e.prototype.getMatrixSet=function(){return this.matrixSet_},e.prototype.getRequestEncoding=function(){return this.requestEncoding_},e.prototype.getStyle=function(){return this.style_},e.prototype.getVersion=function(){return this.version_},e.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var r in this.dimensions_)e[t++]=r+"-"+this.dimensions_[r];return e.join("/")},e.prototype.updateDimensions=function(t){V(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},e.prototype.createFromWMTSTemplate=function(t){var e=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e==dz&&V(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e==dz?Zm(t,r):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in r?r[e.toLowerCase()]:t}));var n=this.tileGrid,i=this.dimensions_;return function(r,o,s){if(r){var a={TileMatrix:n.getMatrixId(r[0]),TileCol:r[1],TileRow:r[2]};V(a,i);var l=t;return l=e==dz?Zm(l,a):l.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]}))}}},e}(qm);function xz(t,e){var r=Ye(t.Contents.Layer,(function(t,r,n){return t.Identifier==e.layer}));if(null===r)return null;var n,i=t.Contents.TileMatrixSet;(n=r.TileMatrixSetLink.length>1?Xe(r.TileMatrixSetLink,"projection"in e?function(t,r,n){var o=Ye(i,(function(e){return e.Identifier==t.TileMatrixSet})).SupportedCRS,s=ye(o),a=ye(e.projection);return s&&a?Ee(s,a):o==e.projection}:function(t,r,n){return t.TileMatrixSet==e.matrixSet}):0)<0&&(n=0);var o=r.TileMatrixSetLink[n].TileMatrixSet,s=r.TileMatrixSetLink[n].TileMatrixSetLimits,a=r.Format[0];"format"in e&&(a=e.format),(n=Xe(r.Style,(function(t,r,n){return"style"in e?t.Title==e.style:t.isDefault})))<0&&(n=0);var l=r.Style[n].Identifier,u={};"Dimension"in r&&r.Dimension.forEach((function(t,e,r){var n=t.Identifier,i=t.Default;void 0===i&&(i=t.Value[0]),u[n]=i}));var c,h=Ye(t.Contents.TileMatrixSet,(function(t,e,r){return t.Identifier==o})),f=h.SupportedCRS;if(f&&(c=ye(f)),"projection"in e){var p=ye(e.projection);p&&(c&&!Ee(p,c)||(c=p))}var d=!1,g="ne"==c.getAxisOrientation().substr(0,2),y=h.TileMatrix[0],m={MinTileCol:0,MinTileRow:0,MaxTileCol:y.MatrixWidth-1,MaxTileRow:y.MatrixHeight-1};if(s){m=s[s.length-1];var _=Ye(h.TileMatrix,(function(t){return t.Identifier===m.TileMatrix||h.Identifier+":"+t.Identifier===m.TileMatrix}));_&&(y=_)}var v=28e-5*y.ScaleDenominator/c.getMetersPerUnit(),b=g?[y.TopLeftCorner[1],y.TopLeftCorner[0]]:y.TopLeftCorner,w=y.TileWidth*v,x=y.TileHeight*v,E=h.BoundingBox,S=[b[0]+w*m.MinTileCol,b[1]-x*(1+m.MaxTileRow),b[0]+w*(1+m.MaxTileCol),b[1]-x*m.MinTileRow];if(void 0!==E&&!gt(E,S)){var I=r.WGS84BoundingBox,O=ye("EPSG:4326").getExtent();if(S=E,I)d=I[0]===O[0]&&I[2]===O[2];else{var C=Ce(E,h.SupportedCRS,"EPSG:4326");d=C[0]-1e-10<=O[0]&&C[2]+1e-10>=O[2]}}var T=vz(h,S,s),P=[],R=e.requestEncoding;if(R=void 0!==R?R:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var L=t.OperationsMetadata.GetTile.DCP.HTTP.Get,M=0,k=L.length;M<k;++M)if(L[M].Constraint){var N=Ye(L[M].Constraint,(function(t){return"GetEncoding"==t.name})).AllowedValues.Value;if(""===R&&(R=N[0]),R!==dz)break;Ue(N,dz)&&P.push(L[M].href)}else L[M].href&&(R=dz,P.push(L[M].href));return 0===P.length&&(R=gz,r.ResourceURL.forEach((function(t){"tile"===t.resourceType&&(a=t.format,P.push(t.template))}))),{urls:P,layer:e.layer,matrixSet:o,format:a,projection:c,requestEncoding:R,tileGrid:T,style:l,dimensions:u,wrapX:d,crossOrigin:e.crossOrigin}}function Ez(t){return(Ez="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Oz(t,e){return(Oz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Cz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Pz(t);if(e){var i=Pz(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Tz(this,r)}}function Tz(t,e){return!e||"object"!==Ez(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pz(t){return(Pz=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oz(t,e)}(o,t);var e,r,n,i=Cz(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return Sz(this,o),(t=i.call(this,e,r)).facadeLayer_=null,t.capabilitiesOptionsPromise=null,t.getCapabilitiesPromise_=e.capabilities||null,t}return e=o,(r=[{key:"addTo",value:function(t){var e=this;if(this.map=t,this.fire(Af),!yV(this.options)&&!yV(this.options.minScale)&&!yV(this.options.maxScale)){var r=this.map.getMapImpl().getView().getProjection().getUnits();this.options.minResolution=LV(this.options.minScale,r),this.options.maxResolution=LV(this.options.maxScale,r)}var n=this.getCapabilitiesOptions_();n instanceof Promise?n.then((function(t){return e.addLayer_(t)})):this.addLayer_(n)}},{key:"setResolutions",value:function(t){var e=this;if(_V(this.vendorOptions_.source)){var r=this.facadeLayer_.getMaxExtent(),n=ye(this.map.getProjection().code);this.getCapabilities().then((function(i){var o=i.getMatrixSet(e.name),s=i.getMatrixIds(e.name),a=i.getFormat(e.name),l=new wz({url:e.url,layer:e.name,matrixSet:o,format:a,projection:n,tileGrid:new _z({origin:Rt(r),resolutions:t,matrixIds:s}),extent:r});e.ol3Layer.setSource(l)}))}}},{key:"setVisible",value:function(t){var e=this;if(this.visibility=t,!0===t&&!0!==this.transparent){this.map.getBaseLayers().filter((function(t){return!t.equals(e)&&t.isVisible()})).forEach((function(t){return t.setVisible(!1)})),_V(this.ol3Layer)||this.ol3Layer.setVisible(t);var r=this.map.getBbox();_V(r)||this.map.setBbox(r,{nearest:!0})}else _V(this.ol3Layer)||this.ol3Layer.setVisible(t)}},{key:"addLayer_",value:function(t){var e=this.facadeLayer_.getMaxExtent(),r=t,n=this.options.minResolution,i=this.options.maxResolution;r.format=this.options.format||t.format;var o=new wz(GV(r,{extent:e},!0));this.ol3Layer=new rg(GV({visible:this.options.visibility,source:o,minResolution:n,maxResolution:i},this.vendorOptions_,!0));var s=this.zIndex_;this.map.getMapImpl().addLayer(this.ol3Layer),null!==s&&this.setZIndex(s),this.setVisible(this.visibility),this.ol3Layer.set("animated",!0),this.fire(Af,this)}},{key:"setMaxExtent",value:function(t){this.getOLLayer().setExtent(t)}},{key:"getCapabilitiesOptions_",value:function(){var t=this;return _V(this.capabilitiesOptionsPromise)&&(this.capabilitiesOptionsPromise=this.getCapabilities(),this.capabilitiesOptionsPromise instanceof Promise&&(this.capabilitiesOptionsPromise=this.capabilitiesOptionsPromise.then((function(e){var r=t.name,n=t.matrixSet;_V(n)&&(n=t.map.getProjection().code);var i=t.facadeLayer_.getMaxExtent(),o=xz(e,{layer:r,matrixSet:n,extent:i});return o.tileGrid.extent=i,o})))),this.capabilitiesOptionsPromise}},{key:"getCapabilities",value:function(){var t=this;return _V(this.getCapabilitiesPromise_)&&(this.getCapabilitiesPromise_=new Promise((function(e,r){var n=PV(t.url),i=new dn;uV(n).then((function(r){var n=r.xml,o=i.read(n);e.call(t,o)}))}))),this.getCapabilitiesPromise_}},{key:"getMinResolution",value:function(){return this.options.minResolution}},{key:"getMaxResolution",value:function(){return this.options.maxResolution}},{key:"setFacadeObj",value:function(t){this.facadeLayer_=t}},{key:"destroy",value:function(){var t=this.map.getMapImpl();_V(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.matrixSet===t.matrixSet),e}},{key:"getGetFeatureInfoUrl",value:function(t,e,r){var n=this.getTileColTileRow(t,e),i=this.getRelativeTileCoordInPixel_(t,e),o=this.name,s=this.ol3Layer.getSource().getMatrixSet(),a=e,l=r,u=n[0],c=n[1],h=i[0],f=i[1];return OV(this.url,{service:"WMTS",request:"GetFeatureInfo",version:"1.0.0",layer:o,style:"default",format:"image/jpeg",tilematrixset:s,tilematrix:a,tilerow:c,tilecol:u,J:f,I:h,infoFormat:l})}},{key:"getTileColTileRow",value:function(t,e){var r=null;if(!_V(this.ol3Layer)){var n=this.ol3Layer.getSource();_V(n)||(r=n.tileGrid.getTileCoordForCoordAndZ(t,e))}return r.slice(1)}},{key:"getRelativeTileCoordInPixel_",value:function(t,e){var r;if(!_V(this.ol3Layer)){var n=this.ol3Layer.getSource();if(!_V(n)){var i=n.tileGrid,o=i.getTileCoordForCoordAndZ(t,e),s=i.getTileCoordExtent(o,[]),a=i.getResolution(o[0]);r=[Math.floor((t[0]-s[0])/a),Math.floor((s[3]-t[1])/a)]}}return r}},{key:"cloneOLLayer",value:function(){var t=null;if(null!=this.ol3Layer){var e=this.ol3Layer.getProperties();t=new rg(e)}return t}}])&&Iz(e.prototype,r),n&&Iz(e,n),o}(cy);function Lz(t){return(Lz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nz(t,e){return(Nz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Az(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Dz(t);if(e){var i=Dz(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Fz(this,r)}}function Fz(t,e){return!e||"object"!==Lz(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dz(t){return(Dz=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nz(t,e)}(o,t);var e,r,n,i=Az(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;Mz(this,o);var s=new Rz(r,n),a=Cd(t,Gp);return e=i.call(this,a,s),dV(Rz)&&Of(pp("exception").wmts_method),_V(t)&&Of(pp("exception").no_param),e.matrixSet=a.matrixSet,e.legend=a.legend,e.transparent=a.transparent,e.options=r,e}return e=o,(r=[{key:"getCapabilities",value:function(){return _V(this.getCapabilitiesPromise_)&&(this.getCapabilitiesPromise_=this.getImpl().getCapabilities()),this.getCapabilitiesPromise_}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.matrixSet===t.matrixSet),e}},{key:"getGetFeatureInfoUrl",value:function(t,e,r){return this.getImpl().getGetFeatureInfoUrl(t,e,r)}},{key:"getTileColTileRow",value:function(t,e){return this.getImpl().getTileColTileRow(t,e)}},{key:"type",get:function(){return Gp},set:function(t){dV(t)||_V(t)||t===Gp||Of("El tipo de capa debe ser '".concat(Gp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"matrixSet",get:function(){return this.getImpl().matrixSet},set:function(t){this.getImpl().matrixSet=t}},{key:"legend",get:function(){return this.getImpl().legend},set:function(t){_V(t)?this.getImpl().legend=this.name:this.getImpl().legend=t}},{key:"options",get:function(){return this.getImpl().options},set:function(t){this.getImpl().options=t}}])&&kz(e.prototype,r),n&&kz(e,n),o}(Ad),Gz=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zz=function(t){function e(e){var r=e||{},n=void 0!==r.projection?r.projection:"EPSG:3857",i=void 0!==r.tileGrid?r.tileGrid:Cm({extent:Rm(n),maxResolution:r.maxResolution,maxZoom:r.maxZoom,minZoom:r.minZoom,tileSize:r.tileSize});return t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,imageSmoothing:r.imageSmoothing,opaque:r.opaque,projection:n,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:r.tileLoadFunction,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:r.tileUrlFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection})||this}return Gz(e,t),e}(qm);function Uz(t){return(Uz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vz(t,e){return(Vz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Wz(t);if(e){var i=Wz(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Yz(this,r)}}function Yz(t,e){return!e||"object"!==Uz(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wz(t){return(Wz=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Xz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vz(t,e)}(o,t);var e,r,n,i=qz(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,e,r)).resolutions_=null,n.facadeLayer_=null,n.hasAttributtion=!1,n.haveOSMorMapboxLayer=!1,!1===e.visibility&&(n.visibility=!1),n.zIndex_=dv.Z_INDEX.Mapbox,n}return e=o,(r=[{key:"setVisible",value:function(t){var e=this;if(this.visibility=t,!0===t&&!0!==this.transparent){this.map.getBaseLayers().forEach((function(t){!t.equals(e)&&t.isVisible()&&t.setVisible(!1)})),_V(this.ol3Layer)||this.ol3Layer.setVisible(t);var r=this.map.getBbox();this.map.getImpl().updateResolutionsFromBaseLayer(),_V(r)||this.map.setBbox(r)}else _V(this.ol3Layer)||this.ol3Layer.setVisible(t)}},{key:"addTo",value:function(t){var e=this;this.map=t,this.fire(Af);var r,n=this.facadeLayer_.getMaxExtent();this.ol3Layer=new rg(GV({source:new zz({url:"".concat(this.url).concat(this.name,"/{z}/{x}/{y}.png?").concat(M.config.MAPBOX_TOKEN_NAME,"=").concat(this.accessToken)}),extent:n},this.vendorOptions_,!0)),this.map.getMapImpl().addLayer(this.ol3Layer),this.map.getMapImpl().getControls().getArray().forEach((function(t){t instanceof Zc&&(e.hasAttributtion=!0)})),this.hasAttributtion||(_V(this.vendorOptions_)&&(r={className:"ol-attribution ol-unselectable ol-control ol-collapsed m-attribution"}),this.map.getMapImpl().addControl(new Zc(r)),this.hasAttributtion=!1),this.map.getMapImpl().updateSize();var i=this.map.getMapImpl().getSize(),o=this.map.getProjection().units;this.resolutions_=MV(this.getExtent(),i,16,o),this.isVisible()&&!this.inRange()&&this.setVisible(!1),null!==this.zIndex_&&this.setZIndex(this.zIndex_),null!==this.resolutions_&&this.setResolutions(this.resolutions_);var s=!1===this.transparent||!0===this.options.animated;this.ol3Layer.set("animated",s)}},{key:"setResolutions",value:function(t){if(this.resolutions_=t,!_V(this.ol3Layer)&&_V(this.vendorOptions_.source)){var e=this.facadeLayer_.getMaxExtent(),r=new zz({url:"".concat(this.url).concat(this.name,"/{z}/{x}/{y}.png?").concat(M.config.MAPBOX_TOKEN_NAME,"=").concat(this.accessToken),extent:e,resolutions:t,attributionControl:!0});this.ol3Layer.setSource(r)}}},{key:"getExtent",value:function(){var t=null;return _V(this.ol3Layer)||(t=ye(this.map.getProjection().code).getExtent()),{x:{min:t[0],max:t[2]},y:{min:t[1],max:t[3]}}}},{key:"setMaxExtent",value:function(t){this.ol3Layer.setExtent(t)}},{key:"setFacadeObj",value:function(t){this.facadeLayer_=t}},{key:"getMinResolution",value:function(){return this.resolutions_[0]}},{key:"getMaxResolution",value:function(){return this.resolutions_[this.resolutions_.length-1]}},{key:"destroy",value:function(){var t=this,e=this.map.getMapImpl();_V(this.ol3Layer)||(e.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map.getLayers().forEach((function(e){(e instanceof rU||e instanceof wU)&&(t.haveOSMorMapboxLayer=!0)})),this.haveOSMorMapboxLayer||this.map.getImpl().getMapImpl().getControls().getArray().forEach((function(e){e instanceof Zc&&t.map.getImpl().getMapImpl().removeControl(e)})),this.map=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name),e}},{key:"cloneOLLayer",value:function(){var t=null;if(null!=this.ol3Layer){var e=this.ol3Layer.getProperties();t=new rg(e)}return t}}])&&Bz(e.prototype,r),n&&Bz(e,n),o}(cy);Xz.ATTRIBUTION='&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a>';var Hz=Xz;function Zz(t){return(Zz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jz(t,e){return(Jz=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qz(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=eU(t);if(e){var i=eU(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return tU(this,r)}}function tU(t,e){return!e||"object"!==Zz(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function eU(t){return(eU=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rU=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jz(t,e)}(o,t);var e,r,n,i=Qz(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Kz(this,o);var s=new Hz(t,r,n),a=Cd(t,Up);return e=i.call(this,a,s),dV(Hz)&&Of(pp("exception").mapbox_method),_V(t)&&Of(pp("exception").no_param),_V(a.name)&&Of(pp("exception").no_name),e.name=a.name,e.legend=a.legend,_V(a.legend)&&(e.legend=a.name),e.transparent=a.transparent,e.accessToken=a.accessToken,e.options=r,e}return e=o,(r=[{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.options===t.options),e}},{key:"url",get:function(){return this.getImpl().url},set:function(t){_V(t)?this.getImpl().url=M.config.MAPBOX_URL:this.getImpl().url=t}},{key:"transparent",get:function(){return this.getImpl().transparent},set:function(t){_V(t)?this.getImpl().transparent=!1:this.getImpl().transparent=t}},{key:"accessToken",get:function(){return this.getImpl().accessToken},set:function(t){_V(t)?this.getImpl().accessToken=M.config.MAPBOX_TOKEN_VALUE:this.getImpl().accessToken=t}},{key:"type",get:function(){return Up},set:function(t){dV(t)||_V(t)||t===Up||Of("El tipo de capa debe ser '".concat(Up).concat("' pero se ha especificado '").concat(t).concat("'"))}}])&&$z(e.prototype,r),n&&$z(e,n),o}(Ad),nU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),iU='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',oU=function(t){function e(e){var r,n=e||{};r=void 0!==n.attributions?n.attributions:[iU];var i=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",o=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:r,attributionsCollapsible:!1,cacheSize:n.cacheSize,crossOrigin:i,imageSmoothing:n.imageSmoothing,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,opaque:void 0===n.opaque||n.opaque,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,transition:n.transition,url:o,wrapX:n.wrapX,zDirection:n.zDirection})||this}return nU(e,t),e}(zz);function sU(t){return(sU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aU(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uU(t,e){return(uU=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cU(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fU(t);if(e){var i=fU(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hU(this,r)}}function hU(t,e){return!e||"object"!==sU(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fU(t){return(fU=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pU=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uU(t,e)}(o,t);var e,r,n,i=cU(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return aU(this,o),(e=i.call(this,r,n)).resolutions_=null,e.facadeLayer_=null,e.hasAttributtion=!1,e.haveOSMorMapboxLayer=!1,!1===r.visibility&&(e.visibility=!1),e.zIndex_=dv.Z_INDEX.OSM,e}return e=o,(r=[{key:"setVisible",value:function(t){var e=this;if(this.visibility=t,!0===this.inRange())if(!0===t&&!0!==this.transparent){this.map.getBaseLayers().forEach((function(t){!t.equals(e)&&t.isVisible()&&t.setVisible(!1)})),_V(this.ol3Layer)||this.ol3Layer.setVisible(t);var r=this.map.getBbox();this.map.getImpl().updateResolutionsFromBaseLayer(),_V(r)||this.map.setBbox(r)}else _V(this.ol3Layer)||this.ol3Layer.setVisible(t)}},{key:"addTo",value:function(t){var e=this;this.map=t,this.fire(Af),this.ol3Layer=new rg(GV({},this.vendorOptions_,!0)),this.updateSource_(),this.map.getMapImpl().addLayer(this.ol3Layer),this.map.getImpl().getMapImpl().getControls().getArray().forEach((function(t){t instanceof Zc&&(e.hasAttributtion=!0)}),this),this.hasAttributtion||(this.map.getMapImpl().addControl(new Zc({className:"ol-attribution ol-unselectable ol-control ol-collapsed m-attribution",collapsible:!0})),this.hasAttributtion=!1),this.map.getMapImpl().updateSize();var r=this.map.getMapImpl().getSize(),n=this.map.getProjection().units;this.resolutions_=MV(this.facadeLayer_.getMaxExtent(),r,16,n),this.isVisible()&&!this.inRange()&&this.setVisible(!1),null!==this.zIndex_&&this.setZIndex(this.zIndex_),null!==this.resolutions_&&this.setResolutions(this.resolutions_);var i=!1===this.transparent||!0===this.options.animated;this.ol3Layer.set("animated",i),this.map.on(op,(function(){return e.updateSource_()}))}},{key:"setResolutions",value:function(t){this.resolutions_=t,this.updateSource_(t)}},{key:"updateSource_",value:function(t){if(_V(t)&&!_V(this.map)){this.map.getMapImpl().updateSize();var e=this.map.getMapImpl().getSize(),r=this.map.getProjection().units;this.resolutions_=MV(this.facadeLayer_.getMaxExtent(),e,16,r)}if(!_V(this.ol3Layer)&&_V(this.vendorOptions_.source)){var n=this.facadeLayer_.getMaxExtent(),i=new oU({});this.ol3Layer.setSource(i),this.ol3Layer.setExtent(n)}}},{key:"setFacadeObj",value:function(t){this.facadeLayer_=t}},{key:"setMaxExtent",value:function(t){this.ol3Layer.setExtent(t)}},{key:"getMinResolution",value:function(){}},{key:"getMaxResolution",value:function(){}},{key:"destroy",value:function(){var t=this,e=this.map.getMapImpl();_V(this.ol3Layer)||(e.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map.getLayers().forEach((function(e){(e instanceof wU||e instanceof rU)&&(t.haveOSMorMapboxLayer=!0)})),this.haveOSMorMapboxLayer||this.map.getImpl().getMapImpl().getControls().getArray().forEach((function(e){e instanceof Zc&&t.map.getImpl().getMapImpl().removeControl(e)})),this.map=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name),e}},{key:"cloneOLLayer",value:function(){var t=null;if(null!=this.ol3Layer){var e=this.ol3Layer.getProperties();t=new rg(e)}return t}}])&&lU(e.prototype,r),n&&lU(e,n),o}(cy);function dU(t){return(dU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gU(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mU(t,e){return(mU=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bU(t);if(e){var i=bU(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return vU(this,r)}}function vU(t,e){return!e||"object"!==dU(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bU(t){return(bU=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wU=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mU(t,e)}(o,t);var e,r,n,i=_U(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};gU(this,o);var s=t;dV(pU)&&Of(pp("exception").osm_method),_V(s)&&(s="OSM");var a=new pU(s,r,n),l=Cd(s,zp);return _V(l.name)&&(l.name="osm"),(e=i.call(this,l,a)).name=l.name,e.legend=l.legend,_V(l.legend)&&(e.legend="OpenStreetMap"),e.transparent=l.transparent,e.options=r,e}return e=o,(r=[{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.url===t.url,e=e&&this.name===t.name,e=e&&this.options===t.options),e}},{key:"transparent",get:function(){return this.getImpl().transparent},set:function(t){_V(t)?this.getImpl().transparent=!1:this.getImpl().transparent=t}},{key:"type",get:function(){return zp},set:function(t){dV(t)||_V(t)||t===zp||Of("El tipo de capa debe ser '".concat(zp).concat("' pero se ha especificado '").concat(t).concat("'"))}}])&&yU(e.prototype,r),n&&yU(e,n),o}(Ad),xU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),EU=function(t){function e(e,r,n,i,o,s){var a=t.call(this,e,r,s)||this;return a.extent=null,a.format_=i,a.features_=null,a.loader_,a.projection=null,a.resolution,a.tileLoadFunction_=o,a.url_=n,a.key=n,a}return xU(e,t),e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.load=function(){this.state==uu&&(this.setState(cu),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},e.prototype.onLoad=function(t,e){this.setFeatures(t)},e.prototype.onError=function(){this.setState(fu)},e.prototype.setFeatures=function(t){this.features_=t,this.setState(hu)},e.prototype.setLoader=function(t){this.loader_=t},e}(em),SU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),IU=[],OU=function(t){function e(e,r,n,i){var o=t.call(this,e,r,{transition:0})||this;return o.context_={},o.executorGroups={},o.declutterExecutorGroups={},o.loadingSourceTiles=0,o.hitDetectionImageData={},o.replayState_={},o.sourceTiles=[],o.errorTileKeys={},o.wantedResolution,o.getSourceTiles=i.bind(void 0,o),o.wrappedTileCoord=n,o}return SU(e,t),e.prototype.getContext=function(t){var e=Object(st.c)(t);return e in this.context_||(this.context_[e]=ol(1,1,IU)),this.context_[e]},e.prototype.hasContext=function(t){return Object(st.c)(t)in this.context_},e.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},e.prototype.getReplayState=function(t){var e=Object(st.c)(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]},e.prototype.load=function(){this.getSourceTiles()},e.prototype.release=function(){for(var e in this.context_)IU.push(this.context_[e].canvas),delete this.context_[e];t.prototype.release.call(this)},e}(em),CU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),TU=function(t){function e(e){var r=this,n=e.projection||"EPSG:3857",i=e.extent||Rm(n),o=e.tileGrid||Cm({extent:i,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});return(r=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,opaque:!1,projection:n,state:e.state,tileGrid:o,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:PU,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection})||this).format_=e.format?e.format:null,r.sourceTileCache=new vm(r.tileCache.highWaterMark),r.overlaps_=null==e.overlaps||e.overlaps,r.tileClass=e.tileClass?e.tileClass:EU,r.tileGrids_={},r}return CU(e,t),e.prototype.getFeaturesInExtent=function(t){var e=[],r=this.tileCache;if(0===r.getCount())return e;var n=fg(r.peekFirstKey())[0],i=this.tileGrid;return r.forEach((function(r){if(r.tileCoord[0]===n&&r.getState()===hu)for(var o=r.getSourceTiles(),s=0,a=o.length;s<a;++s){var l=o[s],u=l.tileCoord;if(zt(t,i.getTileCoordExtent(u))){var c=l.getFeatures();if(c)for(var h=0,f=c.length;h<f;++h){var p=c[h],d=p.getGeometry();zt(t,d.getExtent())&&e.push(p)}}}})),e},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},e.prototype.expireCache=function(e,r){var n=this.getTileCacheForProjection(e),i=Object.keys(r).reduce((function(t,e){var r,i,o=cg((i=(r=e).substring(r.lastIndexOf("/")+1,r.length).split(",").map(Number))[0],i[1],i[2]);if(n.containsKey(o))for(var s=n.get(o).sourceTiles,a=0,l=s.length;a<l;++a)t[s[a].getKey()]=!0;return t}),{});t.prototype.expireCache.call(this,e,r),this.sourceTileCache.expireCache(i)},e.prototype.getSourceTiles=function(t,e,r){var n=this;if(r.getState()===uu){r.setState(cu);var i=r.wrappedTileCoord,o=this.getTileGridForProjection(e),s=o.getTileCoordExtent(i),a=i[0],l=o.getResolution(a);ht(s,-l,s);var u=this.tileGrid,c=u.getExtent();c&&Ft(s,c,s);var h=u.getZForResolution(l,1);u.forEachTileCoord(s,h,(function(i){var o=n.tileUrlFunction(i,t,e),s=n.sourceTileCache.containsKey(o)?n.sourceTileCache.get(o):new n.tileClass(i,o?uu:pu,o,n.format_,n.tileLoadFunction);r.sourceTiles.push(s);var a=s.getState();if(a<hu){s.addEventListener($s,(function t(e){n.handleTileChange(e);var i=s.getState();if(i===hu||i===fu){var o=s.getKey();o in r.errorTileKeys?s.getState()===hu&&delete r.errorTileKeys[o]:r.loadingSourceTiles--,i===fu?r.errorTileKeys[o]=!0:s.removeEventListener($s,t),0===r.loadingSourceTiles&&r.setState(W(r.errorTileKeys)?hu:fu)}})),r.loadingSourceTiles++}a===uu&&(s.extent=u.getTileCoordExtent(i),s.projection=e,s.resolution=u.getResolution(i[0]),n.sourceTileCache.set(o,s),s.load())})),r.loadingSourceTiles||r.setState(r.sourceTiles.some((function(t){return t.getState()===fu}))?fu:hu)}return r.sourceTiles},e.prototype.getTile=function(t,e,r,n,i){var o,s=cg(t,e,r),a=this.getKey();if(this.tileCache.containsKey(s)&&(o=this.tileCache.get(s)).key===a)return o;var l=[t,e,r],u=this.getTileCoordForTileUrlFunction(l,i),c=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(i);if(u&&c){var f=h.getTileCoordExtent(u);ht(f,-h.getResolution(t),f),zt(c,f)||(u=null)}var p=!0;if(null!==u){var d=this.tileGrid,g=h.getResolution(t),y=d.getZForResolution(g,1),m=h.getTileCoordExtent(u);ht(m,-g,m),d.forEachTileCoord(m,y,function(t){p=p&&!this.tileUrlFunction(t,n,i)}.bind(this))}var _=new OU(l,p?pu:uu,u,this.getSourceTiles.bind(this,n,i));return _.key=a,o?(_.interimTile=o,_.refreshInterimChain(),this.tileCache.replace(s,_)):this.tileCache.set(s,_),_},e.prototype.getTileGridForProjection=function(t){var e=t.getCode(),r=this.tileGrids_[e];if(!r){var n=this.tileGrid;r=Pm(t,void 0,n?n.getTileSize(n.getMinZoom()):void 0),this.tileGrids_[e]=r}return r},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.getTilePixelSize=function(t,e,r){var n=Vc(this.getTileGridForProjection(r).getTileSize(t),this.tmpSize);return[Math.round(n[0]*e),Math.round(n[1]*e)]},e.prototype.updateCacheSize=function(e,r){t.prototype.updateCacheSize.call(this,2*e,r),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(r).highWaterMark},e}(Um);function PU(t,e){t.setLoader((function(r,n,i){Mb(e,t.getFormat(),r,n,i,t.onLoad.bind(t),t.onError.bind(t))}))}var RU="image",LU="hybrid",MU="vector",kU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),NU={image:[bw,yw,vw,_w,ww],hybrid:[bw,vw],vector:[]},AU={hybrid:[_w,ww,mw],vector:[bw,yw,vw,_w,ww,mw]},FU=function(t){function e(e){var r=t.call(this,e)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.dirty_=!1,r.renderedLayerRevision_,r.renderedPixelToCoordinateTransform_=null,r.renderedRotation_,r.tmpTransform_=[1,0,0,1,0,0],r}return kU(e,t),e.prototype.prepareTile=function(t,e,r){var n,i=t.getState();return i!==hu&&i!==fu||(this.updateExecutorGroup_(t,e,r),this.tileImageNeedsRender_(t)&&(n=!0)),n},e.prototype.getTile=function(e,r,n,i){var o=i.pixelRatio,s=i.viewState,a=s.resolution,l=s.projection,u=this.getLayer(),c=u.getSource().getTile(e,r,n,o,l),h=i.viewHints,f=!(h[yu]||h[mu]);return!f&&c.wantedResolution||(c.wantedResolution=a),this.prepareTile(c,o,l)&&(f||Date.now()-i.time<8)&&u.getRenderMode()!==MU&&this.renderTileImage_(c,i),t.prototype.getTile.call(this,e,r,n,i)},e.prototype.isDrawableTile=function(e){var r=this.getLayer();return t.prototype.isDrawableTile.call(this,e)&&(r.getRenderMode()===MU?Object(st.c)(r)in e.executorGroups:e.hasContext(r))},e.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},e.prototype.prepareFrame=function(e){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!=r&&(this.renderedTiles.length=0),this.renderedLayerRevision_=r,t.prototype.prepareFrame.call(this,e)},e.prototype.updateExecutorGroup_=function(t,e,r){var n=this.getLayer(),i=n.getRevision(),o=n.getRenderOrder()||null,s=t.wantedResolution,a=t.getReplayState(n);if(a.dirty||a.renderedResolution!==s||a.renderedRevision!=i||a.renderedRenderOrder!=o){var l=n.getSource(),u=n.getDeclutter(),c=l.getTileGrid(),h=l.getTileGridForProjection(r).getTileCoordExtent(t.wrappedTileCoord),f=l.getSourceTiles(e,r,t),p=Object(st.c)(n);delete t.hitDetectionImageData[p],t.executorGroups[p]=[],u&&(t.declutterExecutorGroups[p]=[]);for(var d=function(r,i){var d=f[r];if(d.getState()!=hu)return"continue";var y=d.tileCoord,m=c.getTileCoordExtent(y),_=Ft(h,m),v=ht(_,n.getRenderBuffer()*s,g.tmpExtent),b=Et(m,_)?null:v;a.dirty=!1;var w=new vS(0,v,s,e),x=u?new vS(0,_,s,e):void 0,E=Sw(s,e),S=function(t){var e,r=t.getStyleFunction()||n.getStyleFunction();if(r&&(e=r(t,s)),e){var i=this.renderFeature(t,E,e,w,x);this.dirty_=this.dirty_||i,a.dirty=a.dirty||i}},I=d.getFeatures();o&&o!==a.renderedRenderOrder&&I.sort(o);for(var O=0,C=I.length;O<C;++O){var T=I[O];b&&!zt(b,T.getGeometry().getExtent())||S.call(g,T)}var P=w.finish(),R=n.getRenderMode()!==MU&&u&&1===f.length?null:_,L=new kS(R,s,e,l.getOverlaps(),P,n.getRenderBuffer());if(t.executorGroups[p].push(L),x){var M=new kS(null,s,e,l.getOverlaps(),x.finish(),n.getRenderBuffer());t.declutterExecutorGroups[p].push(M)}},g=this,y=0,m=f.length;y<m;++y)d(y);a.renderedRevision=i,a.renderedRenderOrder=o,a.renderedResolution=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){var o=e.viewState.resolution,s=e.viewState.rotation;r=null==r?0:r;var a=this.getLayer(),l=a.getSource().getTileGridForProjection(e.viewState.projection),u=ct([t]);ht(u,o*r,u);for(var c,h={},f=function(t,e,r){var o=t.getId();void 0===o&&(o=Object(st.c)(t));var s=h[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return h[o]=!0,i.splice(i.lastIndexOf(s),1),n(t,a,e);s.geometry=e,s.distanceSq=r}}else{if(0===r)return h[o]=!0,n(t,a,e);i.push(h[o]={feature:t,layer:a,geometry:e,distanceSq:r,callback:n})}},p=this.renderedTiles,d=function(n,i){var h=p[n];if(!zt(l.getTileCoordExtent(h.wrappedTileCoord),u))return"continue";var d=Object(st.c)(a),g=[h.executorGroups[d]],y=h.declutterExecutorGroups[d];y&&g.push(y),g.some((function(n){for(var i=n===y?e.declutterTree.all().map((function(t){return t.value})):null,a=0,l=n.length;a<l;++a){var u=n[a];if(c=u.forEachFeatureAtCoordinate(t,o,s,r,f,i))return!0}}))},g=0,y=p.length;!c&&g<y;++g)d(g);return c},e.prototype.getFeatures=function(t){return new Promise(function(e,r){for(var n,i=this.getLayer(),o=Object(st.c)(i),s=i.getSource(),a=this.renderedProjection,l=a.getExtent(),u=this.renderedResolution,c=s.getTileGridForProjection(a),h=Ts(this.renderedPixelToCoordinateTransform_,t.slice()),f=c.getTileCoordForCoordAndResolution(h,u),p=0,d=this.renderedTiles.length;p<d;++p)if(f.toString()===this.renderedTiles[p].tileCoord.toString()){if((n=this.renderedTiles[p]).getState()===hu){var g=c.getTileCoordExtent(n.tileCoord);s.getWrapX()&&a.canWrapX()&&!gt(l,g)&&he(h,a);break}n=void 0}if(!n||n.loadingSourceTiles>0)e([]);else{var y=Dt(c.getTileCoordExtent(n.wrappedTileCoord)),m=[(h[0]-y[0])/u,(y[1]-h[1])/u],_=n.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]),v=n.hitDetectionImageData[o];if(!v&&!this.animatingOrInteracting_){var b=Vc(c.getTileSize(c.getZForResolution(u))),w=this.renderedRotation_;v=AS(b,[this.getRenderTransform(c.getTileCoordCenter(n.wrappedTileCoord),u,0,NS,b[0]*NS,b[1]*NS,0)],_,i.getStyleFunction(),c.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(i).renderedResolution,w),n.hitDetectionImageData[o]=v}e(FS(m,_,v))}}.bind(this))},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.renderDeclutter=function(t){var e=this.context,r=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();for(var n=t.viewHints,i=!(n[yu]||n[mu]),o=this.renderedTiles,s=0,a=o.length;s<a;++s){var l=o[s],u=l.declutterExecutorGroups[Object(st.c)(this.getLayer())];if(u)for(var c=u.length-1;c>=0;--c)u[c].execute(this.context,1,this.getTileRenderTransform(l,t),t.viewState.rotation,i,void 0,t.declutterTree)}e.globalAlpha=r},e.prototype.getTileRenderTransform=function(t,e){var r=e.pixelRatio,n=e.viewState,i=n.center,o=n.resolution,s=n.rotation,a=e.size,l=Math.round(a[0]*r),u=Math.round(a[1]*r),c=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),h=t.tileCoord,f=c.getTileCoordExtent(t.wrappedTileCoord),p=c.getTileCoordExtent(h,this.tmpExtent)[0]-f[0];return Os(Ps(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,s,r,l,u,p))},e.prototype.renderFrame=function(e,r){var n=e.viewHints,i=!(n[yu]||n[mu]);t.prototype.renderFrame.call(this,e,r),this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;var o=this.getLayer(),s=o.getRenderMode(),a=this.context,l=a.globalAlpha;a.globalAlpha=o.getOpacity();for(var u=AU[s],c=e.viewState.rotation,h=this.renderedTiles,f=[],p=[],d=h.length-1;d>=0;--d)for(var g=h[d],y=this.getTileRenderTransform(g,e),m=g.executorGroups[Object(st.c)(o)],_=!1,v=0,b=m.length;v<b;++v){var w=m[v];if(w.hasExecutors(u)){var x=g.tileCoord[0],E=void 0;if(!_&&(E=w.getClipCoords(y))){a.save();for(var S=0,I=f.length;S<I;++S){var O=f[S];x<p[S]&&(a.beginPath(),a.moveTo(E[0],E[1]),a.lineTo(E[2],E[3]),a.lineTo(E[4],E[5]),a.lineTo(E[6],E[7]),a.moveTo(O[6],O[7]),a.lineTo(O[4],O[5]),a.lineTo(O[2],O[3]),a.lineTo(O[0],O[1]),a.clip())}}w.execute(a,1,y,c,i,u),!_&&E&&(a.restore(),f.push(E),p.push(x),_=!0)}}return a.globalAlpha=l,this.container},e.prototype.renderFeature=function(t,e,r,n,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var s=0,a=r.length;s<a;++s)o=Ow(n,t,r[s],e,this.boundHandleStyleImageChange_,void 0,i)||o;else o=Ow(n,t,r,e,this.boundHandleStyleImageChange_,void 0,i);return o},e.prototype.tileImageNeedsRender_=function(t){var e=this.getLayer();if(e.getRenderMode()===MU)return!1;var r=t.getReplayState(e),n=e.getRevision(),i=t.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n},e.prototype.renderTileImage_=function(t,e){var r=this.getLayer(),n=t.getReplayState(r),i=r.getRevision(),o=t.executorGroups[Object(st.c)(r)];n.renderedTileRevision=i;var s=t.wrappedTileCoord,a=s[0],l=r.getSource(),u=e.pixelRatio,c=e.viewState.projection,h=l.getTileGridForProjection(c),f=h.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*f,d=h.getResolution(a),g=t.getContext(r);u=Math.round(Math.max(u,p/u));var y=l.getTilePixelSize(a,u,c);g.canvas.width=y[0],g.canvas.height=y[1];var m=u/p;if(1!==m){var _=Is(this.tmpTransform_);Ps(_,m,m),g.setTransform.apply(g,_)}var v=h.getTileCoordExtent(s,this.tmpExtent),b=p/d,w=Is(this.tmpTransform_);Ps(w,b,-b),function(t,e,r){Os(t,Cs(Ss,1,0,0,1,e,r))}(w,-v[0],-v[3]);for(var x=0,E=o.length;x<E;++x){o[x].execute(g,m,w,0,!0,NU[r.getRenderMode()])}n.renderedTileResolution=t.wantedResolution},e}(tg),DU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jU=function(t){function e(e){var r=this,n=e||{},i=V({},n);delete i.preload,delete i.useInterimTilesOnError,(r=t.call(this,i)||this).on,r.once,r.un,n.renderMode===RU&&(console.warn('renderMode: "image" is deprecated. Option ignored.'),n.renderMode=void 0);var o=n.renderMode||LU;return ut(o==LU||o==MU,28),r.renderMode_=o,r.setPreload(n.preload?n.preload:0),r.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),r}return DU(e,t),e.prototype.createRenderer=function(){return new FU(this)},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderMode=function(){return this.renderMode_},e.prototype.getPreload=function(){return this.get(Fd)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Dd)},e.prototype.setPreload=function(t){this.set(Fd,t)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Dd,t)},e}(tS),GU=r(53),zU=r.n(GU),UU=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function BU(t,e,r){if(3===t){var n={keys:[],values:[],features:[]},i=r.readVarint()+r.pos;r.readFields(VU,n,i),n.length=n.features.length,n.length&&(e[n.name]=n)}}function VU(t,e,r){if(15===t)e.version=r.readVarint();else if(1===t)e.name=r.readString();else if(5===t)e.extent=r.readVarint();else if(2===t)e.features.push(r.pos);else if(3===t)e.keys.push(r.readString());else if(4===t){for(var n=null,i=r.readVarint()+r.pos;r.pos<i;)n=1===(t=r.readVarint()>>3)?r.readString():2===t?r.readFloat():3===t?r.readDouble():4===t?r.readVarint64():5===t?r.readVarint():6===t?r.readSVarint():7===t?r.readBoolean():null;e.values.push(n)}}function qU(t,e,r){if(1==t)e.id=r.readVarint();else if(2==t)for(var n=r.readVarint()+r.pos;r.pos<n;){var i=e.layer.keys[r.readVarint()],o=e.layer.values[r.readVarint()];e.properties[i]=o}else 3==t?e.type=r.readVarint():4==t&&(e.geometry=r.pos)}function YU(t,e,r){t.pos=e.features[r];var n=t.readVarint()+t.pos,i={layer:e,type:0,properties:{}};return t.readFields(qU,i,n),i}var WU=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.dataProjection=new g({code:"",units:d.TILE_PIXELS}),r.featureClass_=n.featureClass?n.featureClass:kg,r.geometryName_=n.geometryName,r.layerName_=n.layerName?n.layerName:"layer",r.layers_=n.layers?n.layers:null,r.idProperty_=n.idProperty,r.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],r}return UU(e,t),e.prototype.readRawGeometry_=function(t,e,r,n){t.pos=e.geometry;for(var i=t.readVarint()+t.pos,o=1,s=0,a=0,l=0,u=0,c=0;t.pos<i;){if(!s){var h=t.readVarint();o=7&h,s=h>>3}s--,1===o||2===o?(a+=t.readSVarint(),l+=t.readSVarint(),1===o&&u>c&&(n.push(u),c=u),r.push(a,l),u+=2):7===o?u>c&&(r.push(r[c],r[c+1]),u+=2):ut(!1,59)}u>c&&(n.push(u),c=u)},e.prototype.createFeature_=function(t,e,r){var n,i=e.type;if(0===i)return null;var o,s=e.properties;this.idProperty_?(o=s[this.idProperty_],delete s[this.idProperty_]):o=e.id,s[this.layerName_]=e.layer.name;var a=[],l=[];this.readRawGeometry_(t,e,a,l);var u=function(t,e){var r;1===t?r=1===e?Yt.POINT:Yt.MULTI_POINT:2===t?r=1===e?Yt.LINE_STRING:Yt.MULTI_LINE_STRING:3===t&&(r=Yt.POLYGON);return r}(i,l.length);if(this.featureClass_===kg)(n=new this.featureClass_(u,a,l,s,o)).transform(r.dataProjection);else{var c=void 0;if(u==Yt.POLYGON){for(var h=[],f=0,p=0,d=0,g=l.length;d<g;++d){var y=l[d];if(Sc(a,f,y,2)){if(0===h.length)continue;h[h.length-1].push(l[p])}else h.push(l.slice(p,d+1));p=d+1,f=y}c=h.length>1?new Bg(a,Nu,h):new Rc(a,Nu,l)}else c=u===Yt.POINT?new dc(a,Nu):u===Yt.LINE_STRING?new Fg(a,Nu):u===Yt.POLYGON?new Rc(a,Nu,l):u===Yt.MULTI_POINT?new jg(a,Nu):u===Yt.MULTI_LINE_STRING?new zg(a,Nu,l):null;n=new(0,this.featureClass_),this.geometryName_&&n.setGeometryName(this.geometryName_);var m=NL(c,!1,r);n.setGeometry(m),n.setId(o),n.setProperties(s,!0)}return n},e.prototype.getType=function(){return Cb},e.prototype.readFeatures=function(t,e){var r=this.layers_,n=this.adaptOptions(e),i=ye(n.dataProjection);i.setWorldExtent(n.extent),n.dataProjection=i;var o=new zU.a(t),s=o.readFields(BU,{}),a=[];for(var l in s)if(!r||-1!=r.indexOf(l)){var u=s[l],c=u?[0,0,u.extent,u.extent]:null;i.setExtent(c);for(var h=0,f=u.length;h<f;++h){var p=YU(o,u,h);a.push(this.createFeature_(o,p,n))}}return a},e.prototype.readProjection=function(t){return this.dataProjection},e.prototype.setLayers=function(t){this.layers_=t},e}(kL);function XU(t){return(XU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HU(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ZU(t,e){return(ZU=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function KU(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=JU(t);if(e){var i=JU(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $U(this,r)}}function $U(t,e){return!e||"object"!==XU(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function JU(t){return(JU=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var QU=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ZU(t,e)}(o,t);var e,r,n,i=KU(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,e,r)).formater_=null,n.lastZoom_=-1,n.projection_=t.projection||"EPSG:3857",n.features_=[],n.mode_=t.mode,n.loaded_=!1,n}return e=o,(r=[{key:"addTo",value:function(t){var e=this;this.map=t,this.fire(Af),this.formater_=new WU({featureClass:this.mode_===hB.FEATURE?Cg:kg});var r=this.facadeVector_.getMaxExtent(),n=new TU({format:this.formater_,url:this.url,projection:this.projection_});this.ol3Layer=new jU(GV({source:n,extent:r},this.vendorOptions_,!0)),this.opacity_&&this.setOpacity(this.opacity_),this.map.getMapImpl().addLayer(this.ol3Layer),this.loaded_=!0,this.facadeVector_.fire(ep),this.map.on(ap,(function(){if(e.map){var t=e.map.getZoom();e.lastZoom_!==t&&(e.features_.length=0,e.lastZoom_=t)}}))}},{key:"getFeatures",value:function(t,e){var r=[];if(this.ol3Layer){var n=this.ol3Layer.getSource().tileCache;if(0===n.getCount())return r;var i=fg(n.peekFirstKey())[0];n.forEach((function(t){if(t.tileCoord[0]===i&&t.getState()===hu)for(var e=t.getSourceTiles(),n=0,o=e.length;n<o;n+=1){var s=e[n].getFeatures();s&&(r=r.concat(s))}}))}return r}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.name===t.name),e}}])&&HU(e.prototype,r),n&&HU(e,n),o}(jO);function tB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function eB(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tB(Object(r),!0).forEach((function(e){rB(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tB(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function rB(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nB(t){return(nB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sB(t,e,r){return(sB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cB(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function aB(t,e){return(aB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=cB(t);if(e){var i=cB(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uB(this,r)}}function uB(t,e){return!e||"object"!==nB(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cB(t){return(cB=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hB={RENDER:"render",FEATURE:"feature"},fB=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&aB(t,e)}(o,t);var e,r,n,i=lB(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;iB(this,o);var a=s||new QU(e,r,n);return t=i.call(this,e,r,n,a),dV(QU)&&Of("La implementación usada no puede crear capas Vector"),t}return e=o,(r=[{key:"getMaxExtent",value:function(){var t=this.userMaxExtent;return _V(t)&&(t=this.map_.userMaxExtent,_V(t)&&(t=this.map_.getProjection().getExtent())),t}},{key:"calculateMaxExtent",value:function(){var t=this;return new Promise((function(e){return e(t.getMaxExtent())}))}},{key:"setStyle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.DEFAULT_OPTIONS_STYLE;sB(cB(o.prototype),"setStyle",this).call(this,t,e,r)}},{key:"getProjection",value:function(){return this.getImpl().getProjection()}},{key:"getGeometryType",value:function(){var t=null,e=this.getFeatures();if(!_V(e)){var r=e[0];_V(r)||(t=r.getType())}return t}},{key:"getFeatures",value:function(){return this.getImpl().getFeatures().map((function(t){return aA.olFeature2Facade(t)}))}},{key:"setFilter",value:function(){}},{key:"addFeatures",value:function(){}},{key:"removeFeatures",value:function(){}},{key:"refresh",value:function(){}},{key:"redraw",value:function(){}},{key:"toGeoJSON",value:function(){}},{key:"type",get:function(){return qp},set:function(t){dV(t)||_V(t)||t===qp||Of("El tipo de capa debe ser '".concat(qp).concat("' pero se ha especificado '").concat(t).concat("'"))}}])&&oB(e.prototype,r),n&&oB(e,n),o}(UC);fB.DEFAULT_PARAMS_STYLE={fill:{color:"#fff",opacity:.6},stroke:{color:"#827ec5",width:2}},fB.DEFAULT_OPTIONS_STYLE={point:eB(eB({},fB.DEFAULT_PARAMS_STYLE),{},{radius:5}),line:eB({},fB.DEFAULT_PARAMS_STYLE),polygon:eB({},fB.DEFAULT_PARAMS_STYLE)};var pB=fB;function dB(t){return(dB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yB(t,e){return(yB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=vB(t);if(e){var i=vB(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _B(this,r)}}function _B(t,e){return!e||"object"!==dB(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vB(t){return(vB=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bB=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yB(t,e)}(o,t);var e,r,n,i=mB(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this)).map_=t,n.url_=e,n.format_=r,n}return e=o,(r=[{key:"getLoaderFn",value:function(t){var e=this;return function(r,n,i){e.loadInternal_(i).then((function(r){t.apply(e,r)}))}}},{key:"loadInternal_",value:function(t){var e=this,r=this.url_;return new Promise((function(n){wV(M.config.ticket)&&(r=OV(r,{ticket:M.config.ticket})),uV(r).then((function(r){if(_V(r.text))Of(pp("exception").no_service_response);else{var i=e.format_.read(r.text,{featureProjection:t});n.call(e,[i])}}))}))}}])&&gB(e.prototype,r),n&&gB(e,n),o}(ff);function wB(t){return(wB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function EB(t,e,r){return(EB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=CB(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function SB(t,e){return(SB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function IB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=CB(t);if(e){var i=CB(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return OB(this,r)}}function OB(t,e){return!e||"object"!==wB(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function CB(t){return(CB=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var TB=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SB(t,e)}(o,t);var e,r,n,i=IB(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,e,r)).popup_=null,n.formater_=null,n.loader_=null,n.loadFeaturesPromise_=null,n.loaded_=!1,n.hiddenAttributes_=[],_V(e.hide)||(n.hiddenAttributes_=e.hide),n.showAttributes_=[],_V(e.show)||(n.showAttributes_=e.show),n}return e=o,(r=[{key:"addTo",value:function(t){this.formater_=new Rj({defaultDataProjection:ye(t.getProjection().code)}),_V(this.url)||(this.loader_=new bB(t,this.url,this.formater_)),EB(CB(o.prototype),"addTo",this).call(this,t)}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.formater_.write(this.facadeVector_.getFeatures()),r=this.map.getProjection().code.split(":")[1],n={type:"FeatureCollection",features:e,crs:{properties:{code:r},type:"EPSG"}};bV(t)&&(n=t),this.source=n,this.updateSource_()}},{key:"setSource",value:function(t){this.source=t,_V(this.map)||this.updateSource_()}},{key:"requestFeatures_",value:function(){var t=this;return this.source?this.loadFeaturesPromise_=new Promise((function(e){e(t.formater_.read(t.source,t.map.getProjection()))})):_V(this.loadFeaturesPromise_)&&(this.loadFeaturesPromise_=new Promise((function(e){t.loader_.getLoaderFn((function(t){e(t)}))(null,null,ye(t.map.getProjection().code))}))),this.loadFeaturesPromise_}},{key:"updateSource_",value:function(){var t=this;_V(this.vendorOptions_.source)&&this.requestFeatures_().then((function(e){t.ol3Layer&&t.ol3Layer.setSource(new Fb({loader:function(r,n,i){t.loaded_=!0,t.facadeVector_.clear(),t.facadeVector_.addFeatures(e),t.fire(ep,[e])}})),t.facadeVector_.addFeatures(e)}))}},{key:"getFeaturesExtentPromise",value:function(t,e){var r=this;return new Promise((function(n){var i=r.map.getProjection().code;if(!0===r.isLoaded()){var o=r.getFeatures(t,e),s=ry.getFeaturesExtent(o,i);n(s)}else r.requestFeatures_().then((function(t){var e=ry.getFeaturesExtent(t,i);n(e)}))}))}},{key:"isLoaded",value:function(){return this.loaded_}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=e&&this.name===t.name,e=e&&this.extract===t.extract),e}}])&&xB(e.prototype,r),n&&xB(e,n),o}(jO);function PB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function RB(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?PB(Object(r),!0).forEach((function(e){LB(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PB(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function LB(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MB(t){return(MB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function AB(t,e,r){return(AB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=GB(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function FB(t,e){return(FB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function DB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=GB(t);if(e){var i=GB(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return jB(this,r)}}function jB(t,e){return!e||"object"!==MB(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function GB(t){return(GB=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var zB=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&FB(t,e)}(o,t);var e,r,n,i=DB(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;kB(this,o);var s=new TB(t,r,n);return e=i.call(this,t,r,void 0,s),dV(TB)&&Of(pp("exception").geojsonlayer_method),_V(t)&&Of(pp("exception").no_param),wV(t)?e.url=t:mV(t)?e.source=t:(e.url=t.url,e.name=t.name,e.source=t.source,_V(t.crs)||(_V(e.source)&&(e.source={type:"FeatureCollection",features:[]}),e.source.crs={type:"EPSG",properties:{code:t.crs}})),e.options=r,e}return e=o,(r=[{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=this.name===t.name,e=e&&this.extract===t.extract),e}},{key:"setSource",value:function(t){this.source=t,this.getImpl().refresh(t)}},{key:"setStyle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.DEFAULT_OPTIONS_STYLE;AB(GB(o.prototype),"setStyle",this).call(this,t,e,r)}},{key:"type",get:function(){return Bp},set:function(t){dV(t)||_V(t)||t===Bp||Of("El tipo de capa debe ser '".concat(Bp).concat("' pero se ha especificado '").concat(t).concat("'"))}},{key:"source",get:function(){return this.getImpl().source},set:function(t){this.getImpl().source=t}}])&&NB(e.prototype,r),n&&NB(e,n),o}(UC);zB.DEFAULT_PARAMS={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5}},zB.DEFAULT_OPTIONS_STYLE={point:RB(RB({},zB.DEFAULT_PARAMS),{},{radius:5}),line:RB({},zB.DEFAULT_PARAMS),polygon:RB({},zB.DEFAULT_PARAMS)};var UB=zB;function BB(t){return(BB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qB(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function YB(t,e,r){return(YB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=KB(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function WB(t,e){return(WB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function XB(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=KB(t);if(e){var i=KB(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return HB(this,r)}}function HB(t,e){return!e||"object"!==BB(e)&&"function"!=typeof e?ZB(t):e}function ZB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KB(t){return(KB=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $B=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&WB(t,e)}(o,t);var e,r,n,i=XB(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};VB(this,o);var n=new JN(t);e=i.call(this);var s=new dv(n.container,ZB(e),r);if(e.setImpl(s),_V(t)&&Of(pp("exception").no_param),dV(dv)&&Of(pp("exception").constructor_impl),e._panels=[],e._plugins=[],e._areasContainer=null,e.popup_=null,e._defaultProj=!0,e.panel={LEFT:null,RIGHT:"null"},e._userZoom=null,e.userCenter_=null,e._finishedInitCenter=!0,e._finishedMaxExtent=!0,e._finishedMapImpl=!1,e._finishedMap=!1,e.centerFeature_=null,e.drawLayer_=null,e.userMaxExtent=null,e.ticket_=null,n.container.classList.add("m-mapea-container"),s.on(rp,(function(){e._finishedMapImpl=!0,e._checkCompleted()})),e.createMainPanels_(),e.featuresHandler_=new wA,e.featuresHandler_.addTo(ZB(e)),e.featuresHandler_.activate(),e.drawLayer_=new UC({name:"__draw__"},{displayInLayerSwitcher:!1}),e.drawLayer_.setStyle(new $E(o.DRAWLAYER_STYLE)),e.drawLayer_.setZIndex(dv.Z_INDEX.WFS+999),e.addLayers(e.drawLayer_),_V(n.projection)?e.setProjection(M.config.DEFAULT_PROJ,!0):e.setProjection(n.projection),_V(n.bbox)||e.setBbox(n.bbox),_V(n.resolutions)||e.setResolutions(n.resolutions),!_V(n.maxExtent)){var a=_V(n.zoom)&&_V(n.bbox);e.setMaxExtent(n.maxExtent,a)}if(_V(n.wmc)||e.addWMC(n.wmc),_V(n.layers)||e.addLayers(n.layers),_V(n.wms)||e.addWMS(n.wms),_V(n.wmts)||e.addWMTS(n.wmts),_V(n.kml)||e.addKML(n.kml),_V(n.controls)?e.addControls("panzoom"):e.addControls(n.controls),!_V(n.getfeatureinfo))if("plain"!==n.getfeatureinfo&&"html"!==n.getfeatureinfo&&"gml"!==n.getfeatureinfo)VO(pp("dialog").getfeatureinfo_type);else{var l=new pN(n.getfeatureinfo);e.addControls(l)}return _V(n.wmc)&&_V(n.layers)&&e.addWMC(M.config.predefinedWMC.predefinedNames[0]),_V(n.center)||e.setCenter(n.center),_V(n.zoom)?_V(n.bbox)&&e.setZoom(0):e.setZoom(n.zoom),_V(n.rotation)||e.once(rp,(function(){e.setRotation(n.rotation)})),_V(n.label)||e.addLabel(n.label),_V(n.ticket)||e.setTicket(n.ticket),_V(n.bbox)&&_V(n.zoom)&&_V(n.center)&&e.zoomToMaxExtent(!0),_V(n.center)&&_V(n.bbox)&&(e._finishedInitCenter=!1,e.getInitCenter_().then((function(t){_V(e.userCenter_)&&e.setCenter(t),e._finishedInitCenter=!0,e._checkCompleted()}))),e}return e=o,n=[{key:"LAYER_SORT",value:function(t,e){return _V(t)||_V(e)?0:t.getZIndex()-e.getZIndex()}}],(r=[{key:"getLayers",value:function(t){var e=t;dV(dv.prototype.getLayers)&&Of(pp("exception").getlayers_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map(Cd)),this.getImpl().getLayers(r).sort(o.LAYER_SORT)}},{key:"getRootLayers",value:function(t){return this.getLayers(t).filter((function(t){return _V(t.getLayerGroup())}))}},{key:"getBaseLayers",value:function(){return dV(dv.prototype.getBaseLayers)&&Of(pp("exception").getbaselayers_method),this.getImpl().getBaseLayers().sort(o.LAYER_SORT)}},{key:"getFeatureHandler",value:function(){return this.featuresHandler_}},{key:"addLayers",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addLayers)&&Of(pp("exception").addlayers_method),mV(r)||(r=[r]);var n=r.map((function(t){var r;if(t instanceof Ad)r=t;else{var n=Cd(t);if(_V(n.type))VO(pp("dialog").invalid_type_layer);else switch(n.type){case"WFS":r=new AG(t,{style:n.style});break;case"WMC":r=new pz(t);break;case"WMS":r=new q_(t);break;case"GeoJSON":r=new UB(n,{style:n.style});break;case"OSM":r=new wU(t);break;case"Mapbox":r=new rU(t);break;case"KML":r=new sj(t);break;case"Vector":r=new UC(t);break;case"WMTS":r=new jz(t);break;case"MVT":r=new pB(n);break;default:VO(pp("dialog").invalid_type_layer)}}return r instanceof UC&&!(r instanceof AG)&&e.featuresHandler_.addLayer(r),r.setMap(e),r}));this.getImpl().addLayers(n),this.fire(Df,[n])}return this}},{key:"removeLayers",value:function(t){var e=this;if(!_V(t)){dV(dv.prototype.removeLayers)&&Of(pp("exception").removelayers_method);var r=this.getLayers(t);r.forEach((function(t){t instanceof UC&&e.featuresHandler_.removeLayer(t)})),this.getImpl().removeLayers(r)}return this}},{key:"getLayerGroup",value:function(){return dV(dv.prototype.getLayerGroups)&&Of("La implementación usada no posee el método getLayerGroups"),this.getImpl().getLayerGroups().sort(o.LAYER_SORT)}},{key:"addLayerGroup",value:function(t){var e=t;return yV(e)&&Of("No ha especificado ningun grupo"),dV(dv.prototype.addLayerGroups)&&Of("La implementación usada no posee el método addLayerGroups"),mV(e)||(e=[e]),this.getImpl().addLayerGroups(e),this}},{key:"removeLayerGroup",value:function(t){return yV(t)&&Of("No ha especificado ningun grupo a eliminar"),dV(this.getImpl().removeLayerGroups)&&Of("La implementación usada no posee el método removeGroups"),this.getImpl().removeLayerGroups(t),this}},{key:"getWMC",value:function(t){var e=t;dV(dv.prototype.getWMC)&&Of(pp("exception").getwmc_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,Ap)}))),this.getImpl().getWMC(r).sort(o.LAYER_SORT)}},{key:"addWMC",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addWMC)&&Of(pp("exception").addwmc_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){if(bV(t)&&t instanceof pz)t.setMap(e),n.push(t);else if(!(t instanceof Ad))try{var r=new pz(t,t.options);r.setMap(e),n.push(r)}catch(t){throw VO(t.toString()),t}})),this.getImpl().addWMC(n),this.fire(Df,[n]),this.fire(jf,[n]);var i=this.getWMC();null==i.filter((function(t){return!0===t.selected}))[0]&&i[0].select(),i.length>1&&(this.removeControls("wmcselector"),this.addControls(new Uv))}return this}},{key:"refreshWMCSelectorControl",value:function(){this.removeControls("wmcselector"),1===this.getWMC().length?this.getWMC()[0].select():this.getWMC().length>1&&(this.addControls(new Uv),null==this.getWMC().filter((function(t){return!0===t.selected}))[0]&&this.getWMC()[0].select())}},{key:"removeWMC",value:function(t){if(!_V(t)){dV(dv.prototype.removeWMC)&&Of(pp("exception").removewmc_method);var e=this.getWMC(t);e.length>0&&this.getImpl().removeWMC(e)}return this}},{key:"getKML",value:function(t){var e=t;dV(dv.prototype.getKML)&&Of(pp("exception").getkml_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,Fp)}))),this.getImpl().getKML(r).sort(o.LAYER_SORT)}},{key:"addKML",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addKML)&&Of(pp("exception").addkml_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){var r;bV(t)&&t instanceof sj?r=t:t instanceof Ad||(r=new sj(t,t.options)),!0===r.extract&&e.featuresHandler_.addLayer(r),n.push(r)})),this.getImpl().addKML(n),this.fire(Df,[n]),this.fire(Gf,[n])}return this}},{key:"removeKML",value:function(t){var e=this;if(!_V(t)){dV(dv.prototype.removeKML)&&Of(pp("exception").removekml_method);var r=this.getKML(t);r.length>0&&(r.forEach((function(t){e.featuresHandler_.removeLayer(t)})),this.getImpl().removeKML(r))}return this}},{key:"getWMS",value:function(t){var e=t;dV(dv.prototype.getWMS)&&Of(pp("exception").getwms_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,Dp)}))),this.getImpl().getWMS(r).sort(o.LAYER_SORT)}},{key:"addWMS",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addWMS)&&Of(pp("exception").addwms_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){var r=t;t instanceof q_||(r=new q_(t,t.options)),r.setMap(e),n.push(r)})),this.getImpl().addWMS(n),this.fire(Df,[n]),this.fire(zf,[n])}return this}},{key:"removeWMS",value:function(t){if(!_V(t)){dV(dv.prototype.removeWMS)&&Of(pp("exception").removewms_method);var e=this.getWMS(t);e.length>0&&this.getImpl().removeWMS(e)}return this}},{key:"getWFS",value:function(t){var e=t;dV(dv.prototype.getWFS)&&Of(pp("exception").getwfs_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,jp)}))),this.getImpl().getWFS(r).sort(o.LAYER_SORT)}},{key:"getGeoJSON",value:function(t){var e=t;return dV(dv.prototype.getGeoJSON)&&Of(pp("exception").getgeojson_method),yV(e)?e=[]:mV(e)||(e=[e]),this.getImpl().getGeoJSON(e).sort(o.LAYER_SORT)}},{key:"addWFS",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addWFS)&&Of(pp("exception").addwfs_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){var r;if(bV(t)&&t instanceof AG)r=t;else if(!(t instanceof Ad))try{r=new AG(t,t.options)}catch(t){throw VO(t.toString()),t}e.featuresHandler_.addLayer(r),n.push(r)})),this.getImpl().addWFS(n),this.fire(Df,[n]),this.fire(Uf,[n])}return this}},{key:"removeWFS",value:function(t){var e=this;if(!_V(t)){dV(dv.prototype.removeWFS)&&Of(pp("exception").removewfs_method);var r=this.getWFS(t);r.length>0&&(r.forEach((function(t){e.featuresHandler_.removeLayer(t)})),this.getImpl().removeWFS(r))}return this}},{key:"getWMTS",value:function(t){var e=t;dV(dv.prototype.getWMTS)&&Of(pp("exception").getwmts_method),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,Gp)}))),this.getImpl().getWMTS(r).sort(o.LAYER_SORT)}},{key:"addWMTS",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addWMTS)&&Of(pp("exception").addwmts_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){if(bV(t)&&t instanceof jz)t.setMap(e),n.push(t);else if(!(t instanceof Ad)){var r=new jz(t,t.options);r.setMap(e),n.push(r)}})),this.getImpl().addWMTS(n),this.fire(Df,[n]),this.fire(Yf,[n])}return this}},{key:"removeWMTS",value:function(t){if(!_V(t)){dV(dv.prototype.removeWMTS)&&Of(pp("exception").removewmts_method);var e=this.getWMTS(t);e.length>0&&this.getImpl().removeWMTS(e)}return this}},{key:"getMVT",value:function(t){var e=t;dV(dv.prototype.getMVT)&&Of("La implementación usada no posee el método getWFS"),yV(e)?e=[]:mV(e)||(e=[e]);var r=[];return e.length>0&&(r=e.map((function(t){return Cd(t,qp)}))),this.getImpl().getMVT(r).sort(o.LAYER_SORT)}},{key:"removeMVT",value:function(t){var e=this;if(!_V(t)){dV(dv.prototype.removeMVT)&&Of("La implementación usada no posee el método removeWFS");var r=this.getMVT(t);r.length>0&&(r.forEach((function(t){e.featuresHandler_.removeLayer(t)})),this.getImpl().removeMVT(r))}return this}},{key:"addMVT",value:function(t){var e=t;if(!_V(e)){dV(dv.prototype.addMVT)&&Of("La implementación usada no posee el método addWFS"),mV(e)||(e=[e]);var r=[];e.forEach((function(t){var e;if(bV(t)&&t instanceof pB)e=t;else if(!(t instanceof Ad))try{e=new pB(t,t.options)}catch(t){throw VO(t.toString()),t}r.push(e)})),this.getImpl().addMVT(r),this.fire(Df,[r]),this.fire(Bf,[r])}return this}},{key:"getControls",value:function(t){var e=t;return dV(dv.prototype.getControls)&&Of(pp("exception").getcontrols_method),yV(e)?e=[]:mV(e)||(e=[e]),this.getImpl().getControls(e)}},{key:"addControls",value:function(t){var e=this,r=t;if(!_V(r)){dV(dv.prototype.addControls)&&Of(pp("exception").addcontrols_method),mV(r)||(r=[r]);var n=[];r.forEach((function(t){var r=function(t){var e=null;if(wV(t)){var r,n=SV(t),i=(RN(r={},pN.NAME,new pN("html")),RN(r,$C.NAME,new $C),RN(r,RT.NAME,new RT),RN(r,LR.NAME,new LR),RN(r,dL.NAME,new dL),RN(r,rL.NAME,new rL({toggleDelay:400})),RN(r,ML.NAME,new ML),RN(r,Np.NAME,new Np),RN(r,wP.NAME,new wP),RN(r,$T.NAME,new $T),RN(r,"".concat($T.Name,"*true"),new $T({exactScale:!0})),RN(r,rR.NAME,new rR),RN(r,Uv.NAME,new Uv),r);if(!(n in i)){var o=DV([M.config.MAPEA_URL,"/api/actions/controls"]);VO("El control ".concat(n," no está definido. Consulte los controles disponibles <a href='").concat(o,'\' target="_blank">aquí</a>'))}e=i[n]}else t instanceof bp?e=t:Of("El control añadido no es válido.");return e}(t),i=DN(r,e);e.hasControl(r)||(_V(i)?r.addTo(e):(i.addControls(r),e.addPanels(i)),n.push(r))})),this.getImpl().addControls(n)}}},{key:"hasControl",value:function(t){var e=t;t instanceof bp&&(e=t.name);var r=this.getControls().find((function(t){return t.name===e})),n=!_V(r);return n}},{key:"removeControls",value:function(t){_V(t)&&Of(pp("exception").remove_control),dV(dv.prototype.removeControls)&&Of(pp("exception").removecontrol_method);var e=this.getControls(t);return(e=[].concat(e)).length>0&&(e.forEach((function(t){_V(t.getPanel())||t.getPanel().removeControls(t)})),this.getImpl().removeControls(e)),this}},{key:"getMaxExtent",value:function(){var t=this.userMaxExtent;if(_V(t)){var e=this.getWMC().find((function(t){return t.selected}));t=_V(e)?sq(this.getLayers().filter((function(t){return"__draw__"!==t.name})).map((function(t){return t.getMaxExtent()}))):e.getMaxExtent(),_V(t)&&(t=this.getProjection().getExtent())}return t}},{key:"calculateMaxExtent",value:function(){var t=this;return new Promise((function(e){var r=t.userMaxExtent;if(_V(r)){var n=t.getWMC().find((function(t){return t.selected}));if(_V(n)){var i=t.getLayers().filter((function(t){return"__draw__"!==t.name&&t.isVisible()})).map((function(t){return t.calculateMaxExtent()}));Promise.all(i).then((function(n){r=sq(n),_V(r)&&(r=t.getProjection().getExtent()),_V(t.userMaxExtent)||(r=t.userMaxExtent),e(r)}))}else n.calculateMaxExtent().then(e)}else e(r)}))}},{key:"setMaxExtent",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_V(t)&&this.resetMaxExtent(),dV(dv.prototype.setMaxExtent)&&Of(pp("exception").setmaxextent_method);try{var r=vd(t);!mV(r)&&bV(r)&&(r=[r.x.min,r.y.min,r.x.max,r.y.max]),this.userMaxExtent=r,this.getImpl().setMaxExtent(r,e)}catch(t){throw VO(t.toString()),t}return this}},{key:"resetMaxExtent",value:function(){var t=this;return this.userMaxExtent=null,this.calculateMaxExtent().then((function(e){var r=vd(e);t.getImpl().setMaxExtent(r,!0)})),this}},{key:"getBbox",value:function(){return dV(dv.prototype.getBbox)&&Of(pp("exception").getbbox_method),this.getImpl().getBbox()}},{key:"setBbox",value:function(t,e){_V(t)&&Of(pp("exception").no_bbox),dV(dv.prototype.setBbox)&&Of(pp("exception").setbbox_method);try{var r=vd(t);this.getImpl().setBbox(r,e)}catch(t){throw VO(pp("exception").incorrect_format_bbox),t}return this}},{key:"getZoom",value:function(){return dV(dv.prototype.getZoom)&&Of(pp("exception").getzoom_method),this.getImpl().getZoom()}},{key:"setZoom",value:function(t){_V(t)&&Of(pp("exception").no_zoom),dV(dv.prototype.setZoom)&&Of(pp("exception").setzoom_method);try{var e=xd(t);this._userZoom=e,this.getImpl().setZoom(e)}catch(t){throw VO(t.toString()),t}return this}},{key:"getCenter",value:function(){return dV(dv.prototype.getCenter)&&Of(pp("exception").getcenter_method),this.getImpl().getCenter()}},{key:"setCenter",value:function(t){var e=this;_V(t)&&Of(pp("exception").no_center),dV(dv.prototype.setCenter)&&Of(pp("exception").setcenter_method);var r=_d(t);return this.getImpl().setCenter(r),this.userCenter_=r,!0===r.draw&&(this.drawLayer_.clear(),this.centerFeature_=new mq("__mapeacenter__",{type:"Feature",geometry:{type:"Point",coordinates:[r.x,r.y]},properties:{vendor:{mapea:{click:function(t){var r=e.getLabel();_V(r)||r.show(e)}}}}}),this.drawFeatures([this.centerFeature_])),this}},{key:"getFeatureCenter",value:function(){return this.centerFeature_}},{key:"removeCenter",value:function(){this.removeFeatures(this.centerFeature_),this.centerFeature_=null,this.zoomToMaxExtent()}},{key:"getResolutions",value:function(){return dV(dv.prototype.getResolutions)&&Of(pp("exception").getresolutions_method),this.getImpl().getResolutions()}},{key:"setResolutions",value:function(t){_V(t)&&Of(pp("exception").no_resolutions),dV(dv.prototype.setResolutions)&&Of(pp("exception").setresolutions_method);var e=wd(t);return this.getImpl().setResolutions(e),this}},{key:"getScale",value:function(){return dV(dv.prototype.getScale)&&Of(pp("exception").getscale_method),this.getImpl().getScale()}},{key:"getExactScale",value:function(){return dV(dv.prototype.getExactScale)&&Of("La implementación usada no posee el método getScale"),this.getImpl().getExactScale()}},{key:"getProjection",value:function(){return dV(dv.prototype.getProjection)&&Of(pp("exception").getprojection_method),this.getImpl().getProjection()}},{key:"setProjection",value:function(t,e){var r=t;_V(r)&&Of(pp("exception").no_projection),dV(dv.prototype.setProjection)&&Of(pp("exception").setprojection_method);try{var n=this.getProjection();r=bd(r),n.code!==r.code&&(this.getImpl().setProjection(r),this._defaultProj=this._defaultProj&&!0===e,this.fire(op,[n,r]))}catch(t){VO(t.toString()),String(t).indexOf("El formato del parámetro projection no es correcto")>=0&&this.setProjection(M.config.DEFAULT_PROJ,!0)}return this}},{key:"getPlugins",value:function(t){var e=this,r=t;yV(r)?r=[]:mV(r)||(r=[r]);var n=[];return 0===r.length?n=this._plugins:r.forEach((function(t){n=n.concat(e._plugins.filter((function(e){return t===e.name})))})),n}},{key:"addPlugin",value:function(t){return _V(t)&&Of(pp("exception").no_plugins),dV(t.addTo)&&Of(pp("exception").no_add_plugin_to_map),this._plugins.push(t),t.addTo(this),this}},{key:"removePlugins",value:function(t){var e=this,r=t;return _V(r)&&Of(pp("exception").no_plugin_to_remove),mV(r)||(r=[r]),(r=[].concat(r)).length>0&&r.forEach((function(t){t.destroy(),e._plugins=e._plugins.filter((function(e){return t.name!==e.name}))})),this}},{key:"getEnvolvedExtent",value:function(){var t=this;return new Promise((function(e){var r=t.getWMC().find((function(t){return t.selected}));if(_V(r)){var n=t.getBaseLayers().find((function(t){return t.isVisible()}));if(_V(n)){var i=t.getLayers().filter((function(t){return"__draw__"!==t.name}));Promise.all(i.map((function(t){return t.calculateMaxExtent()}))).then((function(r){var n=_V(r)?[t.getProjection().getExtent()]:r,i=sq(n);e(i)}))}else n.getMaxExtent(e)}else r.getMaxExtent(e)}))}},{key:"zoomToMaxExtent",value:function(t){var e=this;return this.calculateMaxExtent().then((function(r){(!0!==t||_V(e._userZoom))&&e.setBbox(r),e._finishedMaxExtent=!0,e._checkCompleted()})),this}},{key:"setTicket",value:function(t){return this.ticket_=t,M.config.ticket=t,this}},{key:"getTicket",value:function(){return this.ticket_}},{key:"getInitCenter_",value:function(){var t=this;return new Promise((function(e,r){t.calculateMaxExtent().then((function(t){var r;r=mV(t)?{x:(t[0]+t[2])/2,y:(t[1]+t[3])/2}:{x:(t.x.max+t.x.min)/2,y:(t.y.max+t.y.min)/2},e(r)}))}))}},{key:"destroy",value:function(){return dV(dv.prototype.destroy)&&Of(pp("exception").destroy_method),this.getImpl().destroy(),this}},{key:"addLabel",value:function(t,e){var r=this,n=void 0===t.panMapIfOutOfView||t.panMapIfOutOfView;_V(t)&&Of(pp("exception").no_projection),dV(dv.prototype.addLabel)&&Of(pp("exception").addlabel_method);var i=null,o=null;if(bV(t)?(i=zV(t.text),o=t.coord):(i=zV(t),o=e),o=_V(o)?this.getCenter():_d(o),_V(o))this.getInitCenter_().then((function(t){var e=new ZN(i,t,n);r.getImpl().addLabel(e)}));else{var s=new ZN(i,o,n);this.getImpl().addLabel(s)}return this}},{key:"getLabel",value:function(){return this.getImpl().getLabel()}},{key:"removeLabel",value:function(){return this.getImpl().removeLabel()}},{key:"drawPoints",value:function(t){var e=t;_V(e)&&Of(pp("exception").no_point),mV(e)||(e=[e]);var r=e.map((function(t){var e={type:"Feature",geometry:{type:"Point",coordinates:[t.x,t.y]},properties:{}};return vV(t.click)&&(e.properties.vendor={mapea:{click:t.click}}),new mq(null,e)}));this.drawLayer_.addFeatures(r)}},{key:"drawFeatures",value:function(t){return this.drawLayer_.addFeatures(t),this}},{key:"removeFeatures",value:function(t){return this.drawLayer_.removeFeatures(t),this}},{key:"addPanels",value:function(t){var e=this,r=t;return _V(r)||(mV(r)||(r=[r]),r.forEach((function(t){var r=e._panels.some((function(e){return e.equals(t)}));if(t instanceof CN&&!r){e._panels.push(t);var n="div.m-area".concat(t.position),i=e._areasContainer.querySelector(n);t.addTo(e,i)}}))),this}},{key:"removePanel",value:function(t){return t.getControls().length>0&&Of(pp("exception").remove_control_from_panel),t instanceof CN&&(t.destroy(),this._panels=this._panels.filter((function(e){return!e.equals(t)}))),this}},{key:"getPanels",value:function(t){var e=this,r=t,n=[];return _V(r)?n=this._panels:(mV(r)||(r=[r]),r.forEach((function(t){e._panels.filter((function(e){return e.name===t})).forEach((function(t){_V(t)||n.push(t)}))}))),n}},{key:"createMainPanels_",value:function(){this._areasContainer=document.createElement("div"),this._areasContainer.classList.add("m-areas");var t=document.createElement("div");t.classList.add("m-area"),t.classList.add("m-top"),t.classList.add("m-left");var e=document.createElement("div");e.classList.add("m-area"),e.classList.add("m-top"),e.classList.add("m-right");var r=document.createElement("div");r.classList.add("m-area"),r.classList.add("m-bottom"),r.classList.add("m-left");var n=document.createElement("div");n.classList.add("m-area"),n.classList.add("m-bottom"),n.classList.add("m-right"),this._areasContainer.appendChild(t),this._areasContainer.appendChild(e),this._areasContainer.appendChild(r),this._areasContainer.appendChild(n),this.getContainer().appendChild(this._areasContainer)}},{key:"getContainer",value:function(){return dV(dv.prototype.getContainer)&&Of(pp("exception").getcontainer_method),this.getImpl().getContainer()}},{key:"getMapImpl",value:function(){return dV(dv.prototype.getMapImpl)&&Of(pp("exception").getmapimpl_method),this.getImpl().getMapImpl()}},{key:"getPopup",value:function(){return this.popup_}},{key:"removePopup",value:function(){return dV(dv.prototype.removePopup)&&Of(pp("exception").removepopup_method),_V(this.popup_)||(this.getImpl().removePopup(this.popup_),this.popup_.destroy(),this.popup_=null),this}},{key:"addPopup",value:function(t,e){return _V(t)&&Of(pp("exception").no_popup),t instanceof CO||Of(pp("exception").invalid_popup),_V(this.popup_)||this.removePopup(),this.popup_=t,this.popup_.addTo(this,e),this}},{key:"addUpClass_",value:function(t){var e=this;t.on(Af,(function(t){3===e.getControls(["wmcselector","scale","scaleline"]).length&&e.getControls(["scaleline"])[0].getElement().classList.add("ol-scale-line-up")}))}},{key:"_checkCompleted",value:function(){this._finishedInitCenter&&this._finishedMaxExtent&&this._finishedMapImpl&&(this._finishedMap=!0,this.fire(rp))}},{key:"on",value:function(t,e,r){var n=YB(KB(o.prototype),"on",this).call(this,t,e,r);return t===rp&&!0===this._finishedMap&&this.fire(rp),n}},{key:"refresh",value:function(){return!dV(this.getImpl().refresh)&&vV(this.getImpl().refresh)&&this.getImpl().refresh(),this.getLayers().forEach((function(t){return t.refresh()})),this}},{key:"isFinished",value:function(){return this._finishedMap}},{key:"getRotation",value:function(){return dV(dv.prototype.getRotation)&&Of(pp("exception").no_get_rotation_method),this.getImpl().getRotation()*(180/Math.PI)}},{key:"setRotation",value:function(t){dV(dv.prototype.setRotation)&&Of(pp("exception").no_set_rotation_method),this.getImpl().setRotation(t*(Math.PI/180)),this.fire(lp,[t])}},{key:"defaultProj",get:function(){return this._defaultProj}},{key:"areasContainer",get:function(){return this._areasContainer}}])&&qB(e.prototype,r),n&&qB(e,n),o}(Nf);$B.DRAWLAYER_STYLE={fill:{color:"#009e00"},stroke:{color:"#fcfcfc",width:2},radius:7};var JB=$B,QB=(r(98),!0),tV=[],eV=cs.version;function rV(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var nV=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=null,this.xml=null,this.headers={},this.error=!1,this.code=0}var e,r,n;return e=t,(r=[{key:"parseXmlHttp",value:function(t){var e=this;this.text=t.responseText,this.xml=t.responseXML,this.code=t.status,this.error=""!==t.statusText&&"OK"!==t.statusText;var r=t.getAllResponseHeaders();(r=r.split("\n")).forEach((function(t){var r=t,n=(r=r.trim()).replace(/^([^:]+):(.+)$/,"$1").trim(),i=r.replace(/^([^:]+):(.+)$/,"$2").trim();""!==n&&(e.headers[n]=i)}))}},{key:"parseProxy",value:function(t){var e=this;if(this.code=t.code,this.error=t.error,200===this.code&&!0!==this.error){this.text=t.content.trim();try{var r=t.headers["Content-Type"];"undefined"!=typeof DOMParser&&/text\/html/i.test(r)?this.xml=(new DOMParser).parseFromString(this.text,"text/html"):/xml/i.test(r)&&(this.xml=(new DOMParser).parseFromString(this.text,"text/xml"))}catch(t){this.xml=null,this.error=!0}}Object.keys(t.headers).forEach((function(r){e.headers[r]=t.headers[r]}))}}])&&rV(e.prototype,r),n&&rV(e,n),t}(),iV="GET",oV="POST",sV=function(t,e){var r=M.config.PROXY_URL;return e===oV&&(r=M.config.PROXY_POST_URL),r=OV(r,{url:t})},aV=function(t,e,r){var n=t;_V(e)||(n=OV(n,e)),QB&&(n=sV(n,iV));var i=CV("mapea_jsonphandler_");if(n=OV(n,{callback:i}),!_V(r)&&"ticket"in r&&!1===r.ticket){var o=n.indexOf("ticket="),s=n.indexOf("&",o);n=n.substring(n,o)+n.substring(s,n.length)}var a=new Promise((function(t,e){var r=t;new Promise((function(t){window[i]=t})).then((function(t){delete window[i],function(t){var e=document.getElementById(t);e.parentNode.removeChild(e)}(i);var e=new nV;e.parseProxy(t),r(e)}))}));return function(t,e){var r=document.createElement("script");r.type="text/javascript",r.id=e,r.src=t,r.setAttribute("async",""),window.document.body.appendChild(r)}(n,i),a},lV=function(t,e,r,n){var i=t,o=e;return!1!==n&&!0===QB&&(i=sV(i,r)),bV(o)&&(o=JSON.stringify(o)),new Promise((function(t,e){var n;window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n.onreadystatechange=function(){if(4===n.readyState){var e=new nV;e.parseXmlHttp(n),t(e)}},n.open(r,i,!0),n.send(o)}))},uV=function(t,e,r){var n=(_V(r)||!1!==r.jsonp)&&!1!==QB,i=new URL(t).origin;return!0===(n=n&&-1===tV.indexOf(i))?aV(t,e,r):lV(t,e,iV,!1)},cV={inches:1,in:1,Inch:1,ft:12,mi:63360,m:39.3701,dd:4374754,yd:36,d:4374754,degrees:4374754,nmi:72913.4252,Meter:39.37,Foot:12,IFoot:11.999976,ClarkeFoot:11.999868327581488,SearsFoot:11.999955194477684,GoldCoastFoot:11.999964589846002,IInch:.9999979999999999,MicroInch:999998e-9,Mil:9.99998e-7,Centimeter:.3937,Kilometer:39370,Yard:36,SearsYard:35.99986558343306,IndianYard:35.99987015540864,IndianYd37:35.999740205100004,IndianYd62:35.999880755999996,IndianYd75:35.999868945,IndianFoot:11.9999567087,IndianFt37:11.9999134017,IndianFt62:11.999960252000001,IndianFt75:11.999956315,Mile:63360,IYard:35.999928,IMile:63359.87328,NautM:72913.24,"Lat-66":4367838.370169282,"Lat-83":4367954.152606599,Decimeter:3.9370000000000003,Millimeter:.03937,Dekameter:393.7,Decameter:393.7,Hectometer:3937,GermanMeter:39.370535294205006,CaGrid:39.359685060000004,ClarkeChain:791.991309620512,GunterChain:792.0000000000001,BenoitChain:791.9977268035781,SearsChain:791.9970428354235,ClarkeLink:7.91991309620512,GunterLink:7.920000000000001,BenoitLink:7.919977268035781,SearsLink:7.919970428354236,Rod:198.00000000000014,IntnlChain:791.998416,IntnlLink:7.91998416,Perch:198.00000000000014,Pole:198.00000000000014,Furlong:7919.999999999997,Rood:148.75036777426,CapeFoot:11.999868185255002,Brealey:14763.75,ModAmFt:12.000458400000001,Fathom:71.999856,"NautM-UK":72959.85408,"50kilometers":1968500,"150kilometers":5905500,mm:39.37/1e3,cm:.3937,dm:39.37*100,km:39370,kmi:72913.4252,fath:71.999856,ch:791.998416,link:7.91998416,"us-in":1,"us-ft":12,"us-yd":36,"us-ch":792.0000000000001,"us-mi":63360,"ind-yd":35.999740205100004,"ind-ft":11.9999134017,"ind-ch":791.9942845122};function hV(t){return function(t){if(Array.isArray(t))return fV(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return fV(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fV(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fV(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pV(t){return(pV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var dV=function(t){return void 0===t},gV=function(t){var e=!1;return null===t||dV(t)||(e="boolean"==typeof t),e},yV=function(t){var e=!1;return gV(t)||"number"==typeof t||(dV(t)?e=!0:t?null===t&&(e=!0):e=!0),e},mV=function(t){var e=!1;return yV(t)||(e=Object.prototype.toString.call(t)===Object.prototype.toString.call([])),e},_V=function t(e){var r=!1;return yV(e)?r=!0:mV(e)?(r=!0,e.length>0&&(r=!e.some((function(e){return!t(e)})))):"string"==typeof e&&0===e.trim().length&&(r=!0),r},vV=function(t){var e=!1;return yV(t)||(e="function"==typeof t&&!dV(t.call)),e},bV=function(t){var e=!1;return yV(t)||(e="object"===pV(t)&&!dV(t.toString)),e},wV=function(t){var e=!1;return yV(t)||(e="string"==typeof t),e},xV=function(t){var e=!1;return!yV(t)&&wV(t)&&(e=/(https?:\/\/[^*]+)/.test(t)),e},EV=function(t){return"number"==typeof t},SV=function(t,e){var r=t;return!_V(r)&&wV(r)&&(r=r.trim(),r=e?r.toUpperCase():r.toLowerCase()),r},IV=function(t,e){var r=null,n=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"),i=e,o=i.indexOf("?");-1!==o&&(i=i.substring(o),null!==(r=new RegExp("[\\?&]".concat(n,"=([^&#]*)")).exec(i))&&(r=decodeURIComponent(r[1].replace(/\+/g," "))));return r},OV=function(t,e){var r=t;-1===r.indexOf("?")?r+="?":"?"!==r.charAt(r.length-1)&&(r+="&");var n="";bV(e)?(Object.keys(e).forEach((function(t){var r=e[t];n+=t,n+="=",n+=encodeURIComponent(r),n+="&"})),n=n.substring(0,n.length-1)):wV(e)&&(n=e);return r+=n},CV=function(t,e){var r="";return _V(t)||(r=t),r=r.concat(Math.random()).replace(/0\./,""),_V(e)||(r=r.concat(e)),r},TV=function(t,e,r){var n=t;return n=OV(n,"request=GetCapabilities"),n=OV(n,"service=WMS"),wV(e)&&(n=OV(n,{version:e})),wV(r)&&(n=OV(n,{ticket:r})),n},PV=function(t,e){var r=t;return r=OV(r,"request=GetCapabilities"),r=OV(r,"service=WMTS"),_V(e)||(r=OV(r,{version:e})),r},RV=function(t,e,r){var n=t,i=e,o=new Array(r);n=Number.parseFloat(n),i=Number.parseFloat(i);var s=2;Number.isNaN(n)||(s=Math.pow(i/n,1/(r-1)));for(var a=0;a<r;a+=1)o[a]=i/Math.pow(s,a);return o.sort((function(t,e){return e-t})),o},LV=function(t,e){var r,n=e;_V(t)||(yV(n)&&(n="degrees"),r=1/((t>1?1/t:t)*cV[n]*72));return r},MV=function(t,e,r,n){var i=t,o=null,s=null;mV(i)?(o=i[2]-i[0],s=i[3]-i[1]):bV(i)?(o=i.x.max-i.x.min,s=i.y.max-i.y.min):wV(i)&&(o=(i=i.split(","))[2]-i[0],s=i[3]-i[1]);var a=o/e[0],l=s/e[1],u=Math.max(a,l);return RV(null,u,r)},kV=function(t,e){var r=e;return _V(r)&&(r="degrees"),t*cV[r]*72},NV=function(t){var e;if(!_V(t)){var r=document.createElement("div");r.innerHTML=t,e=r.children[0]}return e},AV=function(t){var e=t;if(e&&(e=e.trim()).length>0){var r=e.indexOf(":");-1!==r&&(r+=1,e=e.substring(r,e.length))}return e},FV=function(t){var e=SV(t);return e=(e=e.replace(/_(\w)/g,(function(t,e){return" ".concat(e.toUpperCase())}))).replace(/^\w/,(function(t){return t.toUpperCase()}))},DV=function(t){var e=null;if(!_V(t)){e=(e=t[0]).replace(/\/+\s*$/,"");for(var r=1,n=t.length;r<n;r+=1){var i=t[r];0!==i.indexOf("/")&&(e=e.concat("/")),e=e.concat(i)}}return e},jV=function(t,e,r){var n=Object(t),i=parseInt(n.length,10)||0;if(0===i)return!1;var o,s,a=parseInt(r,10)||0;for(a>=0?o=a:(o=i+a)<0&&(o=0);o<i;){if(e===(s=n[o])||Object.equals(e,s))return!0;o+=1}return!1},GV=function t(e,r,n){var i=e;return Object.keys(r).forEach((function(e){dV(i[e])?i[e]=r[e]:Object.getPrototypeOf(i[e])===Object.prototype?t(i[e],r[e],n):!0===n&&(i[e]=r[e])})),i},zV=function(t){return t.replace(/(<\s*script[^>]*>)+[^<]*(<\s*\/\s*script[^>]*>)+/gi,"").replace(/(('|')\s*\+\s*)?\s*eval\s*\(.*\)\s*(\+\s*('|'))?/gi,"")},UV=function(t){var e=t;if("ontouchstart"in document){var r=0;e.addEventListener("touchstart",(function(t){r=e.scrollTop+t.touches[0].pageY})),e.addEventListener("touchmove",(function(t){e.scrollTop=r-t.touches[0].pageY}))}},BV=function(t,e){var r=t.replace(/^(.+)\/$/,"$1").replace(/^(.+)\?$/,"$1"),n=e.replace(/^(.+)\/$/,"$1").replace(/^(.+)\?$/,"$1");return r.toLowerCase()===n.toLowerCase()},VV=function(t){var e=[yg.toLowerCase(),"GeometryPropertyType".toLowerCase(),Eg.toLowerCase(),mg.toLowerCase(),xg.toLowerCase(),_g.toLowerCase(),vg.toLowerCase(),bg.toLowerCase(),wg.toLowerCase(),Sg.toLowerCase(),Ig.toLowerCase(),"pointpropertytype","polygonpropertytype","linestringpropertytype","geometrypropertytype","multisurfacepropertytype","multilinestringpropertytype","surfacepropertytype","geometrypropertytype","geometryarraypropertytype","multigeometrypropertytype","multipolygonpropertytype","multipointpropertytype","abstractgeometricaggregatetype","pointarraypropertytype","curvearraypropertytype","solidpropertytype","solidarraypropertytype"],r=t.toLowerCase();return-1!==e.indexOf(r)},qV=function(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value},YV=function(t){var e=t;!wV(t)&&t.outerHTML&&(e=t.outerHTML);var r=document.createElement("DIV");return r.innerHTML=e,r.textContent||r.innerText||""},WV=function(t,e,r){return u.a.scale([t,e]).colors(r)},XV=function(t){var e;if(wV(t)){var r=u()(t).hex();r=r.replace(/^#/,"0x"),e=u()(16777215-r).hex()}return e},HV=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;return _V(r)||Object.keys(r).forEach((function(e){var i=r[e];mV(i)?i=hV(i):bV(i)&&(i=t({},i)),_V(n[e])?n[e]=i:bV(n[e])&&t(n[e],i)})),n},ZV=function(t,e){var r=hV(t);if(t.length<e){for(var n=(t[0]+t[1])/(e-1),i=1;i<e-1;i+=1)r[i]=n*i;r=[].concat(hV(r),[t[1]])}return r},KV=function(t,e){return t.ORDER-e.ORDER},$V=function(t){var e=new Image;return new Promise((function(r,n){e.onload=function(){return r(e)},e.src=t}))},JV=function t(e){var r;return mV(e)?r=(r=hV(e)).map(t):bV(e)?(r=HV({},e),Object.keys(r).forEach((function(e){var n=r[e];vV(n)?r[e]="{{f}}".concat(n.toString()):bV(n)&&(r[e]=t(n))}))):r=vV(e)?"{{f}}".concat(e.toString()):e,r},QV=function t(e){var r=e;if(/^\{\{f\}\}/.test(e)){var n=e.replace(/^\{\{f\}\}(.+)/,"$1");r=new Function("f","return ".concat(n))()}else Object.keys(r).forEach((function(e){var n=r[e];if(/^\{\{f\}\}/.test(n)){var i=n.replace(/^\{\{f\}\}(.+)/,"$1");r[e]=new Function("f","return ".concat(i))()}else bV(n)&&t(n)}));return r},tq=function(t,e){var r=t.classList;r.contains(e)?r.remove(e):r.add(e)},eq=function(t,e){var r=e.parentNode;r&&r.replaceChild(t,e)},rq=function(t){if(t){var e=t.parentElement;e&&e.removeChild(t)}},nq=function t(e){var r=!1;return Array.isArray(e)||"object"!==pV(e)||_V(e)?("function"==typeof e||"string"==typeof e&&/\{\{.*\}\}/.test(e))&&(r=!0):r=Object.values(e).some((function(e){return t(e)})),r},iq="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wgARCAAwADADAREAAhEBAxEB/8QAGwAAAwADAQEAAAAAAAAAAAAAAgQGAAMFBwj/xAAaAQACAwEBAAAAAAAAAAAAAAABAwACBQQG/9oADAMBAAIQAxAAAAH6nAjsJBGa6wjLHdfHYSKvZeqmvnvmeW03ujmclCMS56qpDj7We++Xx06aCfzF5J29Bj3RYKgROx3M3XMzkpERpxsd18dhIIzJBEsd1/8A/8QAHBAAAwEBAQEBAQAAAAAAAAAAAgMFBAEAEwYU/9oACAEBAAEFAiLg8Oppos5Cc33Y5p4FTTOYJcLlQzo7UIDMqi5mfHzC183D3tSdLM522Fz66aFrQLc1Rj/H+aLvkZ15hu8+WmSPfpn0BIsbNa69U6blulVia27366agHO2/y5aGTPNQhOrNsx08AtW2WB0dpDwuHL0zmcuuV7t1zfBL00WCPB5//8QAIBEAAgEEAwEBAQAAAAAAAAAAAQIAERIhIgMTMRAyQv/aAAgBAwEBPwGXlsJOsn0yynhl5XD/AB9jYIBTAjGgqJaSt1Yu67RNTYZx5JMbkOVgcmikTqgAHk5MEGJ/SwGx8xje2JeRqsR64M5MkCPqbxKKwxAgApCGVqiLX9tE2N5+WFcpOwj0TsJ8EsLZf5//xAAoEQABBAEDAwQCAwAAAAAAAAACAAEDBBESIUExUWEFFSIzExQjMkL/2gAIAQIBAT8Bd2ZsuiuTWi0VG27r26Q/tldPRIN4pnZDcmqlottt3TOztllcIrUzVA6cqOMYhYAbZWjOKFzDq3dfrnJXe1r844Vd3uV/58PlUyKrM9Q+nC9O+cksvlWr8rEddh34worhyaKsgZfnKL0p3zguenGFHEETYBsL1H4SRS+VSb5T1843UUo0bZa31eVPMN20Oh9PlFbkAxggyTj1zyqd0jJ4pv75XqPzkii8q4JVZmth05X4YLMTuH+lHUijAQxnCmisQWfyxPqcvCrMYkVycsd2wqYlame2fThOzO2HRU5qpa6j7dl7jIH2xOvcZD+qJ0NOa0Wu2+3ZMzM2GX//xAAlEAABAwIGAwEBAQAAAAAAAAABAAIDBBEFEhMhMUEiMlEUQiP/2gAIAQEABj8CJJsB2jFh7PEczv4V6iulcfjUXQYi9ttvI7XQixBnieJ2cIEG4PaZh8Rs32lKbHG3KwdKSSMtDm7+fCkrv0Wu4y6X83V6kMeJOm9J+Hym7faIquqDy6TKFUUYh/0OzCw72UFBNTB7rgO1U+0oAMlxH/OVZYmBg5sFQ1A5bJlKxKkzFjsxsRypNV5qBbKZO1BpOMA9dQ8qGmptSeWK4kDx7J1PUB/6Mx2y7NCoaccukzFMxCIXb6yhSGMNyz7l4G91FHka/T3DiO/qbUQO15JrjKW2ACmxGql0dy17MvKfiEos31iCIIuD0jLh7/E8wP4VqihlafrVanoZXH65CXEH+I4gZwgALAdL/8QAIBABAAIBBQEBAQEAAAAAAAAAAQARITFBUXHwYcGBof/aAAgBAQABPyEGxrVoErNNRMOvX8mTK3aD3Uvhexf8HMvNNRMu/X8gNjWDRI4U8PY49ukPsWgQg3/YcdxUFIAyD3rM7VfN+McK+Xuce3GanEJwHiZmdd0I17qN3TltoZuneWOplXW0ftRenthouaHAJyPmGyKtMGyz/I7iEDNsff5NJkDFbMLdyg6m9/vUDGbaWoqanABwHmOFfD3OfbhMM8ofZ2S00dBuBIGrTCqFvg+aQ3Od9IKAe604jhTy9jn26wGxqVokvNNbMuvX9mDK2bH3cyZWzQe7lZprZh36/sBsagaBP//aAAwDAQACAAMAAAAQo4FGBA7SvIwnAyQo/F//xAAdEQEBAAIDAQEBAAAAAAAAAAABABGBITFBYXFR/9oACAEDAQE/EFxyyvBu9nL5WLwbhzyST2QGGeMh+2LL6JL6Lc4qBzcwn7L5w+9fIXAxbnHnoibLMJ9PsoMincq97c4J7LNvqKYdXedYhUx/YL6JM8MryavZ3s4Xk1Bjgv/EACIRAQABAwQDAQEBAAAAAAAAAAERACExQVFhcYHB8LHhkf/aAAgBAgEBPxBEkBSC3ZePHy8FF292LH76odjjF2Sdm/qgF+wcefh4aBJI0g8ZPjb7VNqj4ClFC5s67cHND9GV5g9xO1uKmADSaHpH/KQecnxt9qO9CfyxOif5V3rskzCZ7i9oisy4ErgvMOsbzPmpbEMy7JrrMfaiY4b23oR+SD0x/acuCUJkmSfFqSnEQ5M23cmG9HrDErM358F6GSSAIs1nJuPVE03LRYMx13xelH5ZPRH9oB5wPG/2ob1DQi9QJnfs/ZpgHKKEzvR68ZDAAiBZ2M2bVl8U1AQEPcREzGaAeMDxv9qu1IgkaQX7Lx4+HloszO5c/PdNm53bH57oBbsHHn5eSgQQFf/EACAQAQACAgIDAQEBAAAAAAAAAAERIQAxQVFhcZGBobH/2gAIAQEAAT8QTtB2AWq8GCJrqeglfoodN5zBhY7xKn8Zpp6KkEgAZQhHeCJvqegF/gANt4HaDsosR5MIyQ/phPKJGNPQc/0ACRXldq7yF3EzgMvsKPKYgZRAxGSmrFPBzImVkJYGgbpRaarCMEv7ZXwkFjR2DNrBDalj4/OOoUT4gQCVKaiJ8YKEllTEEgLuZjV5UGvGh5N2qoJuR5z5kIBY9B8zSwQ2oY+H3hA6OtTzAP8AcD15MbErKsRVvPrCI2DdxCA1bBZbxhvy/ugNKhakjtOsh6thgYJLAsFnZbOaWCG1BPx+cIyQftgPCYCdHYcZCYkxClOk4eZ5XF6Qd6bLtf8ADrI2LMXISFBcp7S41YIXgyJ6AgzSbcIwSfpkfKBSdPQMTtA2UUicmCJvqewt/qANtZxBhY7xIH9ZxBgY7zAn8YIGup7A1+Kh01gdoGwCgDgz/9k=",oq=function(t){return iq},sq=function(t){var e=null;return _V(t)||(e=[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],t.forEach((function(t){_V(t)||(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]))}))),e},aq=function(){var t=window.navigator.userAgent||window.navigator.vendor||window.opera,e="unknown";return/android/i.test(t)&&(e="android"),/iPad|iPhone|iPod/.test(t)&&!window.MSStream&&(e="ios"),e},lq=function(t,e,r){return Ge(t,e,r)};function uq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var cq=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=r;this.facadeFeature_=null,this.formatter_=new xj,_V(r)?this.olFeature_=new Cg:(_V(r.type)&&(i.type="Feature"),this.olFeature_=this.formatter_.readFeature(i)),_V(e)?_V(this.olFeature_.getId())&&this.olFeature_.setId(CV("mapea_feature_")):this.olFeature_.setId(e)}var e,r,n;return e=t,n=[{key:"olFeature2Facade",value:function(t,e){var r=null;return _V(t)||(r=new mq).getImpl().setOLFeature(t,e),r}},{key:"olRenderFeature2Facade",value:function(e,r,n){var i=ry.olRenderFeature2olFeature(e,r,n);return t.olFeature2Facade(i)}},{key:"facade2OLFeature",value:function(t){return t.getImpl().getOLFeature()}},{key:"getGeometry",value:function(t){var e,r=t.geometry.type;return"circle"===r?e=new Hg(t.geometry.coordinates):"geometry"===r?e=new Vu(t.geometry.coordinates):"linestring"===r?e=new Fg(t.geometry.coordinates):"multilinestring"===r?e=new zg(t.geometry.coordinates):"multipoint"===r?e=new jg(t.geometry.coordinates):"multipolygon"===r?e=new Bg(t.geometry.coordinates):"point"===r?e=new dc(t.geometry.coordinates):"polygon"===r&&(e=new Rc(t.geometry.coordinates)),e}}],(r=[{key:"getOLFeature",value:function(){return this.olFeature_}},{key:"setOLFeature",value:function(t,e){_V(t)||(this.olFeature_=t,!1!==e&&_V(this.olFeature_.getId())&&this.olFeature_.setId(CV("mapea_feature_")))}},{key:"getAttributes",value:function(){var t=this.olFeature_.getProperties(),e=t.geometry;return!_V(e)&&e instanceof Vu&&delete t.geometry,t}},{key:"getId",value:function(){return this.olFeature_.getId()}},{key:"setId",value:function(t){this.olFeature_.setId(t)}},{key:"setAttributes",value:function(t){this.olFeature_.setProperties(t)}},{key:"getAttribute",value:function(t){return this.olFeature_.get(t)}},{key:"setAttribute",value:function(t,e){return this.olFeature_.set(t,e)}},{key:"setGeometry",value:function(t){var e=t.type.toLowerCase();"circle"===e?this.olFeature_.setGeometry(new Hg(t.coordinates)):"geometry"===e?this.olFeature_.setGeometry(new Vu(t.coordinates)):"linestring"===e?this.olFeature_.setGeometry(new Fg(t.coordinates)):"multilinestring"===e?this.olFeature_.setGeometry(new zg(t.coordinates)):"multipoint"===e?this.olFeature_.setGeometry(new jg(t.coordinates)):"multipolygon"===e?this.olFeature_.setGeometry(new Bg(t.coordinates)):"point"===e?this.olFeature_.setGeometry(new dc(t.coordinates)):"polygon"===e&&this.olFeature_.setGeometry(new Rc(t.coordinates))}},{key:"setFacadeObj",value:function(t){this.facadeFeature_=t}},{key:"getCentroid",value:function(){var e,r=this.getOLFeature().getGeometry(),n=ry.getCentroid(r);if(!_V(n)){var i=new dc(n);e=new Cg({geometry:i,name:"centroid"})}return e=t.olFeature2Facade(e)}},{key:"clearStyle",value:function(){this.olFeature_.setStyle(null)}}])&&uq(e.prototype,r),n&&uq(e,n),t}();function hq(t){return(hq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pq(t,e){return(pq=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dq(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=yq(t);if(e){var i=yq(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return gq(this,r)}}function gq(t,e){return!e||"object"!==hq(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yq(t){return(yq=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mq=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pq(t,e)}(o,t);var e,r,n,i=dq(o);function o(t,e,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var s=new cq(t,e,r);return(n=i.call(this,s)).style_=null,n.formatGeoJSON_=new Rj,n.setStyle(r),n}return e=o,(r=[{key:"setId",value:function(t){this.getImpl().setId(t)}},{key:"getId",value:function(){return this.getImpl().getId()}},{key:"getGeometry",value:function(){return this.getGeoJSON().geometry}},{key:"setGeometry",value:function(t){this.getImpl().setGeometry(t)}},{key:"getGeoJSON",value:function(){return this.formatGeoJSON_.write(this)[0]}},{key:"getAttributes",value:function(){return this.getImpl().getAttributes()}},{key:"setAttributes",value:function(t){"object"===hq(t)?this.getImpl().setAttributes(t):BO(pp("feature").incorrect_attributes)}},{key:"getAttribute",value:function(t){var e;if(e=this.getImpl().getAttribute(t),_V(e)){var r=t.split(".");r.length>1&&(e=r.reduce((function(t,e){var r;return _V(t)||(r=t instanceof o?t.getAttribute(e):t[e]),r}),this))}return e}},{key:"setAttribute",value:function(t,e){return this.getImpl().setAttribute(t,e)}},{key:"setStyle",value:function(t){!_V(t)&&t instanceof Dx?(this.style_=t,this.style_.applyToFeature(this)):_V(t)&&(this.style_=null,this.getImpl().clearStyle()),this.fire(sp,[t,this])}},{key:"equals",value:function(t){return this.getId()===t.getId()}},{key:"getStyle",value:function(){return this.style_}},{key:"clearStyle",value:function(){this.setStyle(null)}},{key:"getCentroid",value:function(){var t=this.getId(),e=this.getAttributes(),r=new $E({stroke:{color:"#67af13",width:2},radius:8,fill:{color:"#67af13",opacity:.2}}),n=this.getImpl().getCentroid();return _V(n)||(n.setId("".concat(t," centroid}")),n.setAttributes(e),n.setStyle(r)),n}}])&&fq(e.prototype,r),n&&fq(e,n),o}(Nf);function _q(t){return(_q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vq(t,e){return(vq=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bq(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xq(t);if(e){var i=xq(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wq(this,r)}}function wq(t,e){return!e||"object"!==_q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xq(t){return(xq=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Eq=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vq(t,e)}(r,t);var e=bq(r);function r(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=e.call(this,CV("_mapea_cluster_"))).setAttributes(n),i.setAttribute("features",t),i}return r}(mq);function Sq(t){return(Sq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Iq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Cq(t,e){return(Cq=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tq(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Rq(t);if(e){var i=Rq(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Pq(this,r)}}function Pq(t,e){return!e||"object"!==Sq(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rq(t){return(Rq=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Lq=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cq(t,e)}(o,t);var e,r,n,i=Tq(o);function o(){return Iq(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"addTo",value:function(t){var e=this;_V(t)&&Of(pp("exception").no_map);var r=this.getImpl();dV(r.addTo)&&Of(pp("exception").addto_method);var n=this.createView(t);n instanceof Promise?n.then((function(n){r.addTo(t,n),e.fire(Af)})):(r.addTo(t,n),this.fire(Af))}},{key:"createView",value:function(t){}},{key:"getControls",value:function(){}}])&&Oq(e.prototype,r),n&&Oq(e,n),o}(Nf);function Mq(t){return(Mq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nq(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Aq(t,e){return(Aq=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fq(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=jq(t);if(e){var i=jq(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Dq(this,r)}}function Dq(t,e){return!e||"object"!==Mq(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jq(t){return(jq=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gq=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Aq(t,e)}(o,t);var e,r,n,i=Fq(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return kq(this,o),(e=i.call(this)).filterFunction_=t,e.cqlFilter_="",_V(r.cqlFilter)||(e.cqlFilter_=r.cqlFilter),e}return e=o,(r=[{key:"setFunction",value:function(t){this.filterFunction_=t}},{key:"getFunctionFilter",value:function(){return this.filterFunction_}},{key:"execute",value:function(t){return t.filter(this.filterFunction_)}},{key:"toCQL",value:function(){return this.cqlFilter_}}])&&Nq(e.prototype,r),n&&Nq(e,n),o}(WO);function zq(t){return(zq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uq(t,e){return(Uq=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bq(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=qq(t);if(e){var i=qq(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Vq(this,r)}}function Vq(t,e){return!e||"object"!==zq(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qq(t){return(qq=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Yq=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uq(t,e)}(r,t);var e=Bq(r);function r(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);return e.call(this,(function(e,r){var n=null;return _V(e)||(n=e.getGeometry()),t(n,r)}),n)}return r}(Gq),Wq=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Xq(t){return"string"==typeof t?t:""}var Hq=function(t){function e(){return t.call(this)||this}return Wq(e,t),e.prototype.getType=function(){return Pb},e.prototype.readFeature=function(t,e){return this.readFeatureFromText(Xq(t),this.adaptOptions(e))},e.prototype.readFeatureFromText=function(t,e){return Object(st.b)()},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromText(Xq(t),this.adaptOptions(e))},e.prototype.readFeaturesFromText=function(t,e){return Object(st.b)()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromText(Xq(t),this.adaptOptions(e))},e.prototype.readGeometryFromText=function(t,e){return Object(st.b)()},e.prototype.readProjection=function(t){return this.readProjectionFromText(Xq(t))},e.prototype.readProjectionFromText=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,e){return this.writeFeatureText(t,this.adaptOptions(e))},e.prototype.writeFeatureText=function(t,e){return Object(st.b)()},e.prototype.writeFeatures=function(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))},e.prototype.writeFeaturesText=function(t,e){return Object(st.b)()},e.prototype.writeGeometry=function(t,e){return this.writeGeometryText(t,this.adaptOptions(e))},e.prototype.writeGeometryText=function(t,e){return Object(st.b)()},e}(kL),Zq=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kq={POINT:dc,LINESTRING:Fg,POLYGON:Rc,MULTIPOINT:jg,MULTILINESTRING:zg,MULTIPOLYGON:Bg},$q="EMPTY",Jq=0,Qq=1,tY=2,eY=3,rY=4,nY=5,iY=6,oY={};for(var sY in Yt)oY[sY]=Yt[sY].toUpperCase();var aY=function(){function t(t){this.wkt=t,this.index_=-1}return t.prototype.isAlpha_=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"},t.prototype.isNumeric_=function(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)},t.prototype.isWhiteSpace_=function(t){return" "==t||"\t"==t||"\r"==t||"\n"==t},t.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},t.prototype.nextToken=function(){var t,e=this.nextChar_(),r=this.index_,n=e;if("("==e)t=tY;else if(","==e)t=nY;else if(")"==e)t=eY;else if(this.isNumeric_(e)||"-"==e)t=rY,n=this.readNumber_();else if(this.isAlpha_(e))t=Qq,n=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(""!==e)throw new Error("Unexpected character: "+e);t=iY}return{position:r,value:n,type:t}},t.prototype.readNumber_=function(){var t,e=this.index_,r=!1,n=!1;do{"."==t?r=!0:"e"!=t&&"E"!=t||(n=!0),t=this.nextChar_()}while(this.isNumeric_(t,r)||!n&&("e"==t||"E"==t)||n&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))},t.prototype.readText_=function(){var t,e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()},t}(),lY=function(){function t(t){this.lexer_=t,this.token_={position:0,type:Jq},this.layout_=Nu}return t.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},t.prototype.isTokenType=function(t){return this.token_.type==t},t.prototype.match=function(t){var e=this.isTokenType(t);return e&&this.consume_(),e},t.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},t.prototype.parseGeometryLayout_=function(){var t=Nu,e=this.token_;if(this.isTokenType(Qq)){var r=e.value;"Z"===r?t=Au:"M"===r?t=Fu:"ZM"===r&&(t=Du),t!==Nu&&this.consume_()}return t},t.prototype.parseGeometryCollectionText_=function(){if(this.match(tY)){var t=[];do{t.push(this.parseGeometry_())}while(this.match(nY));if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parsePointText_=function(){if(this.match(tY)){var t=this.parsePoint_();if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parseLineStringText_=function(){if(this.match(tY)){var t=this.parsePointList_();if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parsePolygonText_=function(){if(this.match(tY)){var t=this.parseLineStringTextList_();if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parseMultiPointText_=function(){if(this.match(tY)){var t=void 0;if(t=this.token_.type==tY?this.parsePointTextList_():this.parsePointList_(),this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parseMultiLineStringText_=function(){if(this.match(tY)){var t=this.parseLineStringTextList_();if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parseMultiPolygonText_=function(){if(this.match(tY)){var t=this.parsePolygonTextList_();if(this.match(eY))return t}throw new Error(this.formatErrorMessage_())},t.prototype.parsePoint_=function(){for(var t=[],e=this.layout_.length,r=0;r<e;++r){var n=this.token_;if(!this.match(rY))break;t.push(n.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())},t.prototype.parsePointList_=function(){for(var t=[this.parsePoint_()];this.match(nY);)t.push(this.parsePoint_());return t},t.prototype.parsePointTextList_=function(){for(var t=[this.parsePointText_()];this.match(nY);)t.push(this.parsePointText_());return t},t.prototype.parseLineStringTextList_=function(){for(var t=[this.parseLineStringText_()];this.match(nY);)t.push(this.parseLineStringText_());return t},t.prototype.parsePolygonTextList_=function(){for(var t=[this.parsePolygonText_()];this.match(nY);)t.push(this.parsePolygonText_());return t},t.prototype.isEmptyGeometry_=function(){var t=this.isTokenType(Qq)&&this.token_.value==$q;return t&&this.consume_(),t},t.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},t.prototype.parseGeometry_=function(){var t=this.token_;if(this.match(Qq)){var e=t.value;this.layout_=this.parseGeometryLayout_();var r=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==e){if(r)return new Yg([]);var n=this.parseGeometryCollectionText_();return new Yg(n)}var i=Kq[e];if(!i)throw new Error("Invalid geometry type: "+e);var o=void 0;if(r)o="POINT"==e?[NaN,NaN]:[];else switch(e){case"POINT":o=this.parsePointText_();break;case"LINESTRING":o=this.parseLineStringText_();break;case"POLYGON":o=this.parsePolygonText_();break;case"MULTIPOINT":o=this.parseMultiPointText_();break;case"MULTILINESTRING":o=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":o=this.parseMultiPolygonText_()}return new i(o,this.layout_)}throw new Error(this.formatErrorMessage_())},t}(),uY=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.splitCollection_=void 0!==n.splitCollection&&n.splitCollection,r}return Zq(e,t),e.prototype.parse_=function(t){var e=new aY(t);return new lY(e).parse()},e.prototype.readFeatureFromText=function(t,e){var r=this.readGeometryFromText(t,e),n=new Cg;return n.setGeometry(r),n},e.prototype.readFeaturesFromText=function(t,e){for(var r=[],n=this.readGeometryFromText(t,e),i=[],o=0,s=(r=this.splitCollection_&&n.getType()==Yt.GEOMETRY_COLLECTION?n.getGeometriesArray():[n]).length;o<s;++o){var a=new Cg;a.setGeometry(r[o]),i.push(a)}return i},e.prototype.readGeometryFromText=function(t,e){return NL(this.parse_(t),!1,e)},e.prototype.writeFeatureText=function(t,e){var r=t.getGeometry();return r?this.writeGeometryText(r,e):""},e.prototype.writeFeaturesText=function(t,e){if(1==t.length)return this.writeFeatureText(t[0],e);for(var r=[],n=0,i=t.length;n<i;++n)r.push(t[n].getGeometry());var o=new Yg(r);return this.writeGeometryText(o,e)},e.prototype.writeGeometryText=function(t,e){return dY(NL(t,!0,e))},e}(Hq);function cY(t){var e=t.getCoordinates();return 0===e.length?"":e.join(" ")}function hY(t){for(var e=t.getCoordinates(),r=[],n=0,i=e.length;n<i;++n)r.push(e[n].join(" "));return r.join(",")}function fY(t){for(var e=[],r=t.getLinearRings(),n=0,i=r.length;n<i;++n)e.push("("+hY(r[n])+")");return e.join(",")}var pY={Point:cY,LineString:hY,Polygon:fY,MultiPoint:function(t){for(var e=[],r=t.getPoints(),n=0,i=r.length;n<i;++n)e.push("("+cY(r[n])+")");return e.join(",")},MultiLineString:function(t){for(var e=[],r=t.getLineStrings(),n=0,i=r.length;n<i;++n)e.push("("+hY(r[n])+")");return e.join(",")},MultiPolygon:function(t){for(var e=[],r=t.getPolygons(),n=0,i=r.length;n<i;++n)e.push("("+fY(r[n])+")");return e.join(",")},GeometryCollection:function(t){for(var e=[],r=t.getGeometries(),n=0,i=r.length;n<i;++n)e.push(dY(r[n]));return e.join(",")}};function dY(t){var e=t.getType(),r=(0,pY[e])(t);if(e=e.toUpperCase(),"function"==typeof t.getFlatCoordinates){var n=function(t){var e=t.getLayout(),r="";return e!==Au&&e!==Du||(r+="Z"),e!==Fu&&e!==Du||(r+="M"),r}(t);n.length>0&&(e+=" "+n)}return 0===r.length?e+" "+$q:e+"("+r+")"}var gY=uY;function yY(t){return(yY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vY(t,e){return(vY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bY(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xY(t);if(e){var i=xY(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wY(this,r)}}function wY(t,e){return!e||"object"!==yY(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xY(t){return(xY=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var EY=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vY(t,e)}(o,t);var e,r,n,i=bY(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return mY(this,o),(t=i.call(this,e)).gjFormat_=new xj,t}return e=o,(r=[{key:"write",value:function(t){var e=this.gjFormat_.readGeometryFromObject(t);if("point"===e.getType().toLowerCase()){var r=e.getCoordinates();e.setCoordinates([r[0],r[1]])}return this.writeGeometryText(e)}}])&&_Y(e.prototype,r),n&&_Y(e,n),o}(gY);function SY(t){return(SY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OY(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CY(t,e){return(CY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function TY(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=RY(t);if(e){var i=RY(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return PY(this,r)}}function PY(t,e){return!e||"object"!==SY(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function RY(t){return(RY=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var LY=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&CY(t,e)}(o,t);var e,r,n,i=TY(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};IY(this,o);var r=new EY(e);return t=i.call(this,r),dV(EY)&&Of(pp("exception").wkt_method),t}return e=o,(r=[{key:"write",value:function(t){return this.getImpl().write(t)}}])&&OY(e.prototype,r),n&&OY(e,n),o}(Nf);function MY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kY(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var NY=function(){function t(){MY(this,t),this.parser=new dn,this.capabilities=null}var e,r,n;return e=t,(r=[{key:"read",value:function(t){return this.capabilities=this.parser.read(t),this}},{key:"getMatrixSet",value:function(t,e){for(var r,n=0;n<this.capabilities.Contents.Layer.length&&void 0===r;n+=1){var i=this.capabilities.Contents.Layer[n];i.Identifier===t&&(_V(e)||(r=i.TileMatrixSetLink.filter((function(t){return t.contains(e)}))[0]),void 0===r&&(r=i.TileMatrixSetLink[0].TileMatrixSet))}return r}},{key:"getMatrixIds",value:function(t,e){var r=[],n=this.getMatrixSet(t,e),i=this.capabilities.Contents.TileMatrixSet.filter((function(t){return t.Identifier===n}))[0];return null!=i&&i.length>0&&(r=i.TileMatrix.map((function(t){return t.Identifier}))),r}},{key:"getFormat",value:function(t){var e,r=this.capabilities.Contents.Layer.filter((function(e){return e.Identifier===t}))[0];return null!=r&&(e=r.Format[0]),e}},{key:"getOptionsFromCapabilities",value:function(t,e){return xz(this.capabilities,{layer:t,matrixSet:e})}}])&&kY(e.prototype,r),n&&kY(e,n),t}();function AY(t){return(AY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function FY(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function DY(t,e){return(DY=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jY(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=zY(t);if(e){var i=zY(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return GY(this,r)}}function GY(t,e){return!e||"object"!==AY(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zY(t){return(zY=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UY=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DY(t,e)}(o,t);var e,r,n,i=jY(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).geojsonFormatter_=new xj,t.name="drawLayer",t.selectedFeatures_=[],t}return e=o,(r=[{key:"addTo",value:function(t){this.map=t,this.fire(Af),this.ol3Layer=new zS({source:new Fb({}),style:new ox({fill:new Kb({color:"rgba(0, 158, 0, 0.1)"}),stroke:new Zb({color:"#fcfcfc",width:2}),image:new Jw({radius:7,fill:new Kb({color:"#009E00"}),stroke:new Zb({color:"#fcfcfc",width:2})})}),zIndex:dv.Z_INDEX.WFS+999}),!1!==this.options.visibility&&this.setVisible(this.inRange()),this.map.getMapImpl().addLayer(this.ol3Layer)}},{key:"selectFeatures",value:function(t){this.selectedFeatures_=t,vV(this.selectedFeatures_[0].click)&&this.selectedFeatures_[0].click()}},{key:"unselectFeatures",value:function(){this.selectedFeatures_.length>0&&(this.selectedFeatures_.length=0,this.map.removePopup())}},{key:"drawPoints",value:function(t){var e=t;_V(e)&&Of(pp("exception").no_point),mV(e)||(e=[e]);var r=this.pointsToGeoJSON_(e);this.drawGeoJSON(r)}},{key:"drawGeoJSON",value:function(t){var e=this,r=t;_V(r)&&Of(pp("exception").no_geojson),mV(r)||(r=[r]);var n=ye(this.map.getProjection().code),i=[];r.forEach((function(t){var r=e.geojsonFormatter_.readFeatures(t,{dataProjection:n});i=i.concat(r)})),this.ol3Layer.getSource().addFeatures(i)}},{key:"drawFeatures",value:function(t){var e=t;_V(e)||(mV(e)||(e=[e]),this.ol3Layer.getSource().addFeatures(e))}},{key:"removeFeatures",value:function(t){var e=t;if(!_V(e)){mV(e)||(e=[e]);var r=this.ol3Layer.getSource();e.forEach((function(t){try{r.removeFeature(t)}catch(t){throw t}}))}}},{key:"getPoints",value:function(t){var e=[],r=this.ol3Layer.getSource();return e=_V(t)?r.getFeatures():r.getFeaturesAtCoordinate(t),this.featuresToPoints_(e)}},{key:"destroy",value:function(){var t=this.map.getMapImpl();_V(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),this.options=null,this.map=null}},{key:"equals",value:function(t){var e=!1;return t instanceof o&&(e=e&&this.name===t.name),e}},{key:"pointsToGeoJSON_",value:function(t){var e=this,r=ye(this.map.getProjection().code);return t.map((function(t){var n=t.data,i=new dc([t.x,t.y]);return{type:"Feature",geometry:e.geojsonFormatter_.writeGeometryObject(i,{dataProjection:r}),properties:n,click:t.click,showPopup:t.showPopup}}))}},{key:"featuresToPoints_",value:function(t){return[]}}])&&FY(e.prototype,r),n&&FY(e,n),o}(cy),BY=34962,VY=34963,qY=35044,YY=35048,WY=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function XY(t,e){for(var r=WY.length,n=0;n<r;++n)try{var i=t.getContext(WY[n],e);if(i)return i}catch(t){}return null}var HY=qY;function ZY(t){switch(t){case BY:return Float32Array;case VY:return Uint32Array;default:return Float32Array}}var KY=function(){function t(t,e){this.array=null,this.type=t,ut(t===BY||t===VY,62),this.usage=void 0!==e?e:HY}return t.prototype.ofSize=function(t){this.array=new(ZY(this.type))(t)},t.prototype.fromArray=function(t){var e=ZY(this.type);this.array=e.from?e.from(t):new e(t)},t.prototype.fromArrayBuffer=function(t){this.array=new(ZY(this.type))(t)},t.prototype.getType=function(){return this.type},t.prototype.getArray=function(){return this.array},t.prototype.getUsage=function(){return this.usage},t.prototype.getSize=function(){return this.array?this.array.length:0},t}(),$Y="webglcontextlost",JY="webglcontextrestored",QY=function(){function t(t){this.gl_=t.webGlContext;var e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),e.compileShader(r);var n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,t.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n"),e.compileShader(n),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,r),e.attachShader(this.renderTargetProgram_,n),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(r){this.uniforms_.push({value:t.uniforms[r],location:e.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}return t.prototype.getGL=function(){return this.gl_},t.prototype.init=function(t){var e=this.getGL(),r=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var n=e.RGBA,i=e.RGBA,o=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,0,n,r[0],r[1],0,i,o,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}},t.prototype.apply=function(t,e){var r=this.getGL(),n=t.size;r.bindFramebuffer(r.FRAMEBUFFER,e?e.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,n[0],n[1]),r.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(t),r.drawArrays(r.TRIANGLES,0,6)},t.prototype.getFrameBuffer=function(){return this.frameBuffer_},t.prototype.applyUniforms=function(t){var e,r=this.getGL(),n=1;this.uniforms_.forEach((function(i){if((e="function"==typeof i.value?i.value(t):i.value)instanceof HTMLCanvasElement||e instanceof ImageData)i.texture||(i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+n]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),e instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,e.width,e.height,0,r.UNSIGNED_BYTE,new Uint8Array(e.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.uniform1i(i.location,n++);else if(Array.isArray(e))switch(e.length){case 2:return void r.uniform2f(i.location,e[0],e[1]);case 3:return void r.uniform3f(i.location,e[0],e[1],e[2]);case 4:return void r.uniform4f(i.location,e[0],e[1],e[2],e[3]);default:return}else"number"==typeof e&&r.uniform1f(i.location,e)}))},t}();function tW(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var eW=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rW="u_projectionMatrix",nW="u_offsetScaleMatrix",iW="u_offsetRotateMatrix",oW="u_time",sW="u_zoom",aW="u_resolution",lW={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function uW(t){for(var e=0,r=0;r<t.length;r++){var n=t[r];e+=n.size*cW(n.type)}return e}function cW(t){switch(t){case lW.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case lW.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case lW.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case lW.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var hW=function(t){function e(e){var r=t.call(this)||this,n=e||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvas_=document.createElement("canvas"),r.canvas_.style.position="absolute",r.canvas_.style.left="0",r.gl_=XY(r.canvas_);var i=r.getGL();if(r.bufferCache_={},r.extensionCache_={},r.currentProgram_=null,r.canvas_.addEventListener($Y,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(JY,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=[1,0,0,1,0,0],r.offsetScaleMatrix_=[1,0,0,1,0,0],r.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],n.uniforms)for(var o in n.uniforms)r.uniforms_.push({name:o,value:n.uniforms[o]});return r.postProcessPasses_=n.postProcesses?n.postProcesses.map((function(t){return new QY({webGlContext:i,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})})):[new QY({webGlContext:i})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return eW(e,t),e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e},e.prototype.bindBuffer=function(t){var e=this.getGL(),r=Object(st.c)(t),n=this.bufferCache_[r];n||(n={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[r]=n);e.bindBuffer(t.getType(),n.webGlBuffer)},e.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var e=this.getGL(),r=Object(st.c)(t),n=this.bufferCache_[r];n&&!e.isContextLost()&&e.deleteBuffer(n.webGlBuffer),delete this.bufferCache_[r]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener($Y,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(JY,this.boundHandleWebGLContextRestored_);var t=this.gl_.getExtension("WEBGL_lose_context");t&&t.loseContext(),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,e){var r=this.getGL(),n=this.getCanvas(),i=t.size,o=t.pixelRatio;n.width=i[0]*o,n.height=i[1]*o,n.style.width=i[0]+"px",n.style.height=i[1]+"px",r.useProgram(this.currentProgram_);for(var s=this.postProcessPasses_.length-1;s>=0;s--)this.postProcessPasses_[s].init(t);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,e?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,e,r){var n=this.getGL(),i=e.getSize();n.bindFramebuffer(n.FRAMEBUFFER,e.getFramebuffer()),n.viewport(0,0,i[0],i[1]),n.bindTexture(n.TEXTURE_2D,e.getTexture()),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,r?n.ZERO:n.ONE_MINUS_SRC_ALPHA),n.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,e){var r=this.getGL();this.getExtension("OES_element_index_uint");var n=r.UNSIGNED_INT,i=e-t,o=4*t;r.drawElements(r.TRIANGLES,i,n,o)},e.prototype.finalizeDraw=function(t){for(var e=0;e<this.postProcessPasses_.length;e++)this.postProcessPasses_[e].apply(t,this.postProcessPasses_[e+1]||null)},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var e=t.size,r=t.viewState.rotation,n=Is(this.offsetScaleMatrix_);Ps(n,2/e[0],2/e[1]);var i,o,s,a,l=Is(this.offsetRotateMatrix_);0!==r&&(i=l,o=-r,s=Math.cos(o),a=Math.sin(o),Os(i,Cs(Ss,s,a,-a,s,0,0))),this.setUniformMatrixValue(nW,tW(this.tmpMat4_,n)),this.setUniformMatrixValue(iW,tW(this.tmpMat4_,l)),this.setUniformFloatValue(oW,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(sW,t.viewState.zoom),this.setUniformFloatValue(aW,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var e,r=this.getGL(),n=0;this.uniforms_.forEach(function(i){if((e="function"==typeof i.value?i.value(t):i.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)i.texture||(i.prevValue=void 0,i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+n]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(!(e instanceof HTMLImageElement)||e.complete)&&i.prevValue!==e&&(i.prevValue=e,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)),r.uniform1i(this.getUniformLocation(i.name),n++);else if(Array.isArray(e)&&6===e.length)this.setUniformMatrixValue(i.name,tW(this.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void r.uniform2f(this.getUniformLocation(i.name),e[0],e[1]);case 3:return void r.uniform3f(this.getUniformLocation(i.name),e[0],e[1],e[2]);case 4:return void r.uniform4f(this.getUniformLocation(i.name),e[0],e[1],e[2],e[3]);default:return}else"number"==typeof e&&r.uniform1f(this.getUniformLocation(i.name),e)}.bind(this))},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0)},e.prototype.compileShader=function(t,e){var r=this.getGL(),n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n},e.prototype.getProgram=function(t,e){var r=this.getGL(),n=this.compileShader(t,r.FRAGMENT_SHADER),i=this.compileShader(e,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,n),r.attachShader(o,i),r.linkProgram(o),!r.getShaderParameter(n,r.COMPILE_STATUS)){var s="Fragment shader compliation failed: "+r.getShaderInfoLog(n);throw new Error(s)}if(r.deleteShader(n),!r.getShaderParameter(i,r.COMPILE_STATUS)){s="Vertex shader compilation failed: "+r.getShaderInfoLog(i);throw new Error(s)}if(r.deleteShader(i),!r.getProgramParameter(o,r.LINK_STATUS)){s="GL program linking failed: "+r.getShaderInfoLog(i);throw new Error(s)}return o},e.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,e){var r=t.size,n=t.viewState.rotation,i=t.viewState.resolution,o=t.viewState.center;return Is(e),Rs(e,0,0,2/(i*r[0]),2/(i*r[1]),-n,-o[0],-o[1]),e},e.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},e.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},e.prototype.enableAttributeArray_=function(t,e,r,n,i){var o=this.getAttributeLocation(t);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,e,r,!1,n,i))},e.prototype.enableAttributes=function(t){for(var e=uW(t),r=0,n=0;n<t.length;n++){var i=t[n];this.enableAttributeArray_(i.name,i.size,i.type||5126,e,r),r+=i.size*cW(i.type)}},e.prototype.handleWebGLContextLost=function(){q(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,e,r){var n=this.getGL(),i=r||n.createTexture(),o=n.RGBA,s=n.RGBA,a=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,i),e?n.texImage2D(n.TEXTURE_2D,0,o,s,a,e):n.texImage2D(n.TEXTURE_2D,0,o,t[0],t[1],0,s,a,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i},e}(hs),fW=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pW="GENERATE_BUFFERS",dW=function(t){function e(e,r){var n=t.call(this,e)||this,i=r||{};return n.helper=new hW({postProcesses:i.postProcesses,uniforms:i.uniforms}),void 0!==i.className&&(n.helper.getCanvas().className=i.className),n}return fW(e,t),e.prototype.disposeInternal=function(){this.helper.dispose(),delete this.helper,t.prototype.disposeInternal.call(this)},e.prototype.dispatchRenderEvent_=function(t,e){var r=this.getLayer();if(r.hasListener(t)){var n=new Ka(t,null,e,null);r.dispatchEvent(n)}},e.prototype.preRender=function(t){this.dispatchRenderEvent_(Na,t)},e.prototype.postRender=function(t){this.dispatchRenderEvent_(Aa,t)},e}(Wd);var gW=dW,yW=new Uint8Array(4),mW=function(){function t(t,e){this.helper_=t;var r=t.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return t.prototype.setSize=function(t){We(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},t.prototype.getSize=function(){return this.size_},t.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},t.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},t.prototype.readPixel=function(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return yW[0]=0,yW[1]=0,yW[2]=0,yW[3]=0,yW;this.readAll();var r=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return yW[0]=this.data_[4*r],yW[1]=this.data_[4*r+1],yW[2]=this.data_[4*r+2],yW[3]=this.data_[4*r+3],yW},t.prototype.getTexture=function(){return this.texture_},t.prototype.getFramebuffer=function(){return this.framebuffer_},t.prototype.updateSize_=function(){var t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},t}(),_W=new Blob(['var e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n="GENERATE_BUFFERS",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};'],{type:"application/javascript"}),vW=URL.createObjectURL(_W);var bW=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wW=function(t){function e(e,r){var n=this,i=r.uniforms||{},o=[1,0,0,1,0,0];i[rW]=o,(n=t.call(this,e,{className:r.className,uniforms:i,postProcesses:r.postProcesses})||this).sourceRevision_=-1,n.verticesBuffer_=new KY(BY,YY),n.hitVerticesBuffer_=new KY(BY,YY),n.indicesBuffer_=new KY(VY,YY),n.program_=n.helper.getProgram(r.fragmentShader,r.vertexShader),n.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),n.hitProgram_=n.hitDetectionEnabled_&&n.helper.getProgram(r.hitFragmentShader,r.hitVertexShader);var s=r.attributes?r.attributes.map((function(t){return{name:"a_"+t.name,size:1,type:lW.FLOAT}})):[];n.attributes=[{name:"a_position",size:2,type:lW.FLOAT},{name:"a_index",size:1,type:lW.FLOAT}].concat(s),n.hitDetectionAttributes=[{name:"a_position",size:2,type:lW.FLOAT},{name:"a_index",size:1,type:lW.FLOAT},{name:"a_hitColor",size:4,type:lW.FLOAT},{name:"a_featureUid",size:1,type:lW.FLOAT}].concat(s),n.customAttributes=r.attributes?r.attributes:[],n.previousExtent_=[1/0,1/0,-1/0,-1/0],n.currentTransform_=o,n.renderTransform_=[1,0,0,1,0,0],n.invertRenderTransform_=[1,0,0,1,0,0],n.renderInstructions_=new Float32Array(0),n.hitRenderInstructions_=new Float32Array(0),n.hitRenderTarget_=n.hitDetectionEnabled_&&new mW(n.helper),n.worker_=new Worker(vW),n.worker_.addEventListener("message",function(t){var e=t.data;if(e.type===pW){var r=e.projectionTransform;e.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(e.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(e.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(e.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,Ls(this.invertRenderTransform_,this.renderTransform_),e.hitDetection?this.hitRenderInstructions_=new Float32Array(t.data.renderInstructions):this.renderInstructions_=new Float32Array(t.data.renderInstructions),this.getLayer().changed()}}.bind(n)),n.featureCache_={},n.featureCount_=0;var a=n.getLayer().getSource();return n.sourceListenKeys_=[fa(a,vb,n.handleSourceFeatureAdded_,n),fa(a,bb,n.handleSourceFeatureChanged_,n),fa(a,xb,n.handleSourceFeatureDelete_,n),fa(a,wb,n.handleSourceFeatureClear_,n)],a.forEachFeature(function(t){this.featureCache_[Object(st.c)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++}.bind(n)),n}return bW(e,t),e.prototype.handleSourceFeatureAdded_=function(t){var e=t.feature;this.featureCache_[Object(st.c)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++},e.prototype.handleSourceFeatureChanged_=function(t){var e=t.feature;this.featureCache_[Object(st.c)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}},e.prototype.handleSourceFeatureDelete_=function(t){var e=t.feature;delete this.featureCache_[Object(st.c)(e)],this.featureCount_--},e.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},e.prototype.renderFrame=function(t){this.preRender(t);var e=this.indicesBuffer_.getSize();this.helper.drawElements(0,e),this.helper.finalizeDraw(t);var r=this.helper.getCanvas(),n=t.layerStatesArray[t.layerIndex].opacity;return n!==parseFloat(r.style.opacity)&&(r.style.opacity=String(n)),this.hitDetectionEnabled_&&(this.renderHitDetection(t),this.hitRenderTarget_.clearCachedData()),this.postRender(t),r},e.prototype.prepareFrame=function(t){var e=this.getLayer(),r=e.getSource(),n=t.viewState,i=!t.viewHints[yu]&&!t.viewHints[mu],o=!Et(this.previousExtent_,t.extent),s=this.sourceRevision_<r.getRevision();if(s&&(this.sourceRevision_=r.getRevision()),i&&(o||s)){var a=n.projection,l=n.resolution,u=e instanceof tS?e.getRenderBuffer():0,c=ht(t.extent,u*l);r.loadFeatures(c,l,a),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()}return this.helper.makeProjectionTransform(t,this.currentTransform_),Os(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},e.prototype.rebuildBuffers_=function(t){var e=[1,0,0,1,0,0];this.helper.makeProjectionTransform(t,e);var r,n,i=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===i||(this.renderInstructions_=new Float32Array(i)),this.hitDetectionEnabled_){var o=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===o||(this.hitRenderInstructions_=new Float32Array(o))}var s,a,l,u,c,h=[],f=[],p=0,d=0;for(var g in this.featureCache_)if((n=(r=this.featureCache_[g]).geometry)&&n.getType()===Yt.POINT){h[0]=n.getFlatCoordinates()[0],h[1]=n.getFlatCoordinates()[1],Ts(e,h),a=d+6,l=void 0,u=void 0,c=void 0,u=256,c=255,(l=f||[])[0]=Math.floor(a/u/u/u)/c,l[1]=Math.floor(a/u/u)%u/c,l[2]=Math.floor(a/u)%u/c,l[3]=a%u/c,s=l,this.renderInstructions_[p++]=h[0],this.renderInstructions_[p++]=h[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[d++]=h[0],this.hitRenderInstructions_[d++]=h[1],this.hitRenderInstructions_[d++]=s[0],this.hitRenderInstructions_[d++]=s[1],this.hitRenderInstructions_[d++]=s[2],this.hitRenderInstructions_[d++]=s[3],this.hitRenderInstructions_[d++]=Number(g));for(var y=void 0,m=0;m<this.customAttributes.length;m++)y=this.customAttributes[m].callback(r.feature,r.properties),this.renderInstructions_[p++]=y,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[d++]=y)}var _={type:pW,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(_.projectionTransform=e,this.worker_.postMessage(_,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var v={type:pW,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};v.projectionTransform=e,v.hitDetection=!0,this.worker_.postMessage(v,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){if(ut(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var o=Ts(e.coordinateToPixelTransform,t.slice()),s=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),a=function(t){var e=0,r=256,n=255;return e+=Math.round(t[0]*r*r*r*n),e+=Math.round(t[1]*r*r*n),e+=Math.round(t[2]*r*n),e+Math.round(t[3]*n)}([s[0]/255,s[1]/255,s[2]/255,s[3]/255]),l=this.hitRenderInstructions_[a],u=Math.floor(l).toString(),c=this.getLayer().getSource().getFeatureByUid(u);return c?n(c,this.getLayer(),null):void 0}},e.prototype.renderHitDetection=function(t){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var e=this.indicesBuffer_.getSize();this.helper.drawElements(0,e)}},e.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(t){da(t)})),this.sourceListenKeys_=null,t.prototype.disposeInternal.call(this)},e}(gW),xW=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),EW="blur",SW="gradient",IW="radius",OW=["#00f","#0ff","#0f0","#ff0","#f00"];var CW=function(t){function e(e){var r=this,n=e||{},i=V({},n);delete i.gradient,delete i.radius,delete i.blur,delete i.weight,(r=t.call(this,i)||this).gradient_=null,r.addChangeListener(SW,r.handleGradientChanged_),r.setGradient(n.gradient?n.gradient:OW),r.setBlur(void 0!==n.blur?n.blur:15),r.setRadius(void 0!==n.radius?n.radius:8);var o=n.weight?n.weight:"weight";return r.weightFunction_="string"==typeof o?function(t){return t.get(o)}:o,r.setRenderOrder(null),r}return xW(e,t),e.prototype.getBlur=function(){return this.get(EW)},e.prototype.getGradient=function(){return this.get(SW)},e.prototype.getRadius=function(){return this.get(IW)},e.prototype.handleGradientChanged_=function(){this.gradient_=function(t){for(var e=1,r=256,n=ol(e,r),i=n.createLinearGradient(0,0,e,r),o=1/(t.length-1),s=0,a=t.length;s<a;++s)i.addColorStop(s*o,t[s]);return n.fillStyle=i,n.fillRect(0,0,e,r),n.canvas}(this.getGradient())},e.prototype.setBlur=function(t){this.set(EW,t)},e.prototype.setGradient=function(t){this.set(SW,t)},e.prototype.setRadius=function(t){this.set(IW,t)},e.prototype.createRenderer=function(){return new wW(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(t){var e=this.weightFunction_(t);return void 0!==e?y(e,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(IW)+this.get(EW))}.bind(this),u_blurSlope:function(){return this.get(IW)/Math.max(1,this.get(EW))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},e.prototype.renderDeclutter=function(){},e}(zS);function TW(t){return(TW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function PW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RW(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function LW(t,e){return(LW=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function MW(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=NW(t);if(e){var i=NW(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return kW(this,r)}}function kW(t,e){return!e||"object"!==TW(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function NW(t){return(NW=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var AW=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&LW(t,e)}(o,t);var e,r,n,i=MW(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};PW(this,o),t=i.call(this,e);var r,n=e.weight?e.weight:"weight";if("string"==typeof n){var s=1,a=t.getWeights(e);a.length>0?(s=a.reduce((function(t,e){return Math.max(t,e)})),t.maxWeight_=s,t.minWeight_=a.reduce((function(t,e){return Math.min(t,e)})),r=function(t){var e;return t instanceof Cg?e=t.get(n):t instanceof mq&&(e=t.getAttribute(n)),parseFloat(e/s)}):BO("La capa de nombre <b>".concat(e.name,"</b> no tiene ninguna feature <br/>\n          con el atributo especificado en simbología establecida.\n          <br/>Se setea una ponderación por defecto"),"Mapa de calor")}else r=n;return t.setStyle((function(e,n){var i=Hw.getValue(r,e),o=void 0!==i?y(i,0,1):1,s=255*o||0,a=t.styleCache_[s];return a||(a=[new ox({image:new hw({opacity:o,src:t.circleImage_})})],t.styleCache_[s]=a),a})),t}return e=o,(r=[{key:"getMinWeight",value:function(){return this.minWeight_}},{key:"getMaxWeight",value:function(){return this.maxWeight_}},{key:"getWeights",value:function(t){var e=[],r=this.getSource();if(null!==r){var n=r.getFeatures();n.length>0&&(e=n.map((function(e){return e.get(t.weight)})).filter((function(t){return null!=t})))}return e}}])&&RW(e.prototype,r),n&&RW(e,n),o}(CW);function FW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DW(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var jW=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};FW(this,t),this.attributeName_=e.attribute||null,this.label_=e.label||null,this.fillColor_=e.fill||null,this.legend_=e.legend||null}var e,r,n;return e=t,(r=[{key:"attribute",get:function(){return this.attributeName_},set:function(t){this.attributeName_=t}},{key:"label",get:function(){return this.label_},set:function(t){this.label_=t}},{key:"fillColor",get:function(){return this.fillColor_},set:function(t){this.fillColor_=t}},{key:"legend",get:function(){return this.legend_},set:function(t){this.legend_=t}}])&&DW(e.prototype,r),n&&DW(e,n),t}(),GW={DONUT:"donut",PIE_3D:"pie3D",PIE:"pie",BAR:"bar"},zW={Custom:"m.style.chart.types.custom_scheme",Classic:["#ffa500","blue","red","green","cyan","magenta","yellow","#0f0"],Dark:["#960","#003","#900","#060","#099","#909","#990","#090"],Pale:["#fd0","#369","#f64","#3b7","#880","#b5d","#666"],Pastel:["#fb4","#79c","#f66","#7d7","#acc","#fdd","#ff9","#b9b"],Neon:["#ff0","#0ff","#0f0","#f0f","#f00","#00f"]};function UW(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||VW(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function BW(t){return function(t){if(Array.isArray(t))return qW(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||VW(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VW(t,e){if(t){if("string"==typeof t)return qW(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qW(t,e):void 0}}function qW(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function YW(t){return(YW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function WW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XW(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function HW(t,e){return(HW=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ZW(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=$W(t);if(e){var i=$W(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return KW(this,r)}}function KW(t,e){return!e||"object"!==YW(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $W(t){return($W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var JW=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&HW(t,e)}(o,t);var e,r,n,i=ZW(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};WW(this,o);var e=t,r=e.variables||null;if(Object.values(GW).includes(e.type)||(e.type=o.DEFAULT.type),_V(r)||(r instanceof Array?e.variables=r.filter((function(t){return null!=t})).map((function(t){return o.formatVariable(t)})):"string"==typeof r||"object"===YW(r)?e.variables=[o.formatVariable(r)]:e.variables=[]),_V(e.scheme))e.scheme=o.DEFAULT.scheme;else if("string"==typeof e.scheme){var n=e.variables.some((function(t){return null!=t.fillColor}));e.scheme===zW.Custom&&n?e.scheme=e.variables.map((function(t){return t.fillColor?t.fillColor:""})):e.scheme=zW[e.scheme]||o.DEFAULT.scheme}else e.scheme instanceof Array&&e.scheme.every((function(t){return"string"==typeof t}))||(e.scheme=o.DEFAULT.scheme);var s=new OX(e);return i.call(this,e,s)}return e=o,n=[{key:"formatVariable",value:function(t){return null==t?null:t instanceof jW?t:new jW("string"==typeof t?{attribute:t}:t)}},{key:"deserialize",value:function(t){var e=UW(t,1)[0],r=e;return r.variables=e.variables.map((function(t){return new jW(QV(t))})),new Function(["options"],"return new M.style.Chart(options)")(r)}}],(r=[{key:"updateCanvas",value:function(){_V(this.getImpl())&&_V(this.canvas_)||this.getImpl().updateCanvas(this.canvas_)}},{key:"apply",value:function(t){var e=this;this.layer_=t,t.getFeatures().forEach((function(t){return t.setStyle(e.clone())})),this.updateCanvas()}},{key:"toJSON",value:function(){var t=this.getOptions();return{parameters:[{type:t.type,radius:t.radius,donutRadio:t.donutRadio,offsetX:t.offsetX,offsetY:t.offsetY,stroke:_V(t.stroke)?void 0:HV({},t.stroke),fill3DColor:t.fill3DColor,scheme:mV(t.scheme)?BW(t.scheme):t.scheme,label:_V(t.label)?void 0:HV({},t.label),rotateWithView:t.rotateWithView,variables:t.variables.map((function(t){var e;return _V(t.label)||(e=HV({},t.label),e=JV(e)),{attribute:t.attribute,legend:t.legend,fill:t.fillColor,label:e}}))}],deserializedMethod:"M.style.Chart.deserialize"}}},{key:"ORDER",get:function(){return 1}}])&&XW(e.prototype,r),n&&XW(e,n),o}(Dx);JW.DEFAULT={shadow3dColor:"#369",type:GW.PIE,scheme:zW.Classic,radius:20,donutRatio:.5,offsetX:0,offsetY:0,animationStep:1};var QW=JW;function tX(t){return(tX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rX(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nX(t,e){return(nX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function iX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=sX(t);if(e){var i=sX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return oX(this,r)}}function oX(t,e){return!e||"object"!==tX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sX(t){return(sX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nX(t,e)}(o,t);var e,r,n,i=iX(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};eX(this,o);var r=_V(e.stroke)?0:e.stroke.getWidth();return t=i.call(this,{radius:("number"==typeof e.radius?e.radius:0)+r,fill:new Kb({color:[0,0,0]}),rotation:"number"==typeof e.rotation?e.rotation:0,snapToPixel:"boolean"==typeof e.snapToPixel&&e.snapToPixel}),e.scale&&t.setScale(e.scale),t.variables_=e.variables||[],t.stroke_=e.stroke||null,t.radius_=e.radius||0,t.donutRatio_=e.donutRatio||0,t.type_=e.type||null,t.offset_=[e.offsetX?e.offsetX:0,e.offsetY?e.offsetY:0],t.animation_={animate:"number"==typeof e.animation,step:"number"==typeof e.animation?e.animation:QW.DEFAULT.animationStep},t.data_=e.data||null,t.colors_=e.scheme instanceof Array?e.scheme:[],t.fill3DColor_=e.fill3DColor||"#000",t.rotateWithView_=e.rotateWithView||!1,t.renderChart_(),t}return e=o,(r=[{key:"clone",value:function(){var t=new o({type:this.type_,radius:this.radius_,colors:this.colors_,rotation:this.getRotation(),scale:this.getScale(),donutRatio:this.donutRatio_,data:this.data_,stroke:this.stroke_,scheme:this.colors_,offsetX:this.offset_[0],offsetY:this.offset_[1],animation:this.animation_,fill3DColor:this.fill3DColor_,rotateWithView:this.rotateWithView_});return t.setScale(this.getScale()),t.setOpacity(this.getOpacity()),t}},{key:"setRadius",value:function(t,e){this.donutRatio_=e||this.donutRatio_,this.radius=t}},{key:"setAnimation",value:function(t){if(!1===t){if(!1===this.animation_.animate)return;this.animation_.animate=!1}else{if(this.animation_.step===t)return;this.animation_.animate=!0,this.animation_.step=t}this.renderChart_()}},{key:"getChecksum",value:function(){var t,e=null!==this.stroke_?this.stroke_.getChecksum():"-";if(null===this.checksums_||e!==this.checksums_[1]||t!==this.checksums_[2]||this.radius_!==this.checksums_[3]||this.data_.join("|")!==this.checksums_[4]){var r=this.radius_?this.radius_.toString():"-",n="c".concat(e).concat(t).concat(r).concat(this.data_.join("|"));this.checksums_=[n,e,t,this.radius_,this.data_.join("|")]}return this.checksums_[0]}},{key:"renderChart_",value:function(t){switch(this.type_){case GW.DONUT:case GW.PIE_3D:case GW.PIE:this.renderCircleChart();break;default:this.renderBarChart()}}},{key:"renderBarChart",value:function(){var t,e=this,r=this.getImage(1),n=r.getContext("2d"),i=0,o=this.animation_.animate?this.animation_.step:1;this.stroke_&&(t=As(this.stroke_.getColor()),i=this.stroke_.getWidth());var s,a=Math.max.apply(null,this.data_)||0,l=Math.min(5,2*this.radius_/this.data_.length),u=r.width-(i||0),c=r.width/2,h=c-this.data_.length*l/2;t&&(n.strokeStyle=t,n.lineWidth=i),this.data_.sort((function(t,e){return t-e})).forEach((function(r,i){n.beginPath(),n.fillStyle=e.colors_[i%e.colors_.length],s=h+l;var c=r/a*2*e.radius_*o;n.rect(h,u-c,l,c),n.closePath(),n.fill(),t&&n.stroke(),h=s}));var f=this.getAnchor();f[0]=c-this.offset_[0],f[1]=c-this.offset_[1]}},{key:"renderCircleChart",value:function(){var t,e=0;this.stroke_&&(t=As(this.stroke_.getColor()),e=this.stroke_.getWidth());var r=this.getImage(1),n=r.getContext("2d");n.clearRect(0,0,r.width,r.height),n.lineJoin="round";var i=0;!_V(this.data_)&&this.data_.length>0&&(i=this.data_.reduce((function(t,e){return t+e}))),n.setTransform(1,0,0,1,0,0),n.translate(0,0);var o=this.animation_.animate?this.animation_.step:1,s=Math.PI*(o-1.5),a=r.width/2;t&&(n.strokeStyle=t,n.lineWidth=e),n.save(),this.type_===GW.PIE_3D?this.drawPie3D(n,s,a,o,t,i):this.type_===GW.DONUT?this.drawDonut(n,s,a,o,t,e,i):this.drawPie(n,s,a,o,t,i),n.restore();var l=this.getAnchor();l[0]=a-this.offset_[0],l[1]=a-this.offset_[1]}},{key:"drawDonut",value:function(t,e,r,n,i,o,s){var a=t;a.save(),a.beginPath(),a.rect(0,0,2*r,2*r),a.arc(r,r,this.radius_*n*this.donutRatio_,0,2*Math.PI),a.clip("evenodd");var l=this.drawPie(a,e,r,n,i,s);a.restore(),a.beginPath(),a.strokeStyle=i,a.lineWidth=o;var u=this.radius_;a.arc(r,r,u*n*this.donutRatio_,Math.PI*(n-1.5),l),i&&a.stroke()}},{key:"drawPie3D",value:function(t,e,r,n,i,o){var s=t;s.translate(0,.3*r),s.scale(1,.7),s.beginPath(),s.fillStyle=this.fill3DColor_,s.arc(r,1.4*r,this.radius_*n,0,2*Math.PI),s.fill(),i&&s.stroke(),this.drawPie(t,e,r,n,i,o)}},{key:"drawPie",value:function(t,e,r,n,i,o){var s,a=this,l=e,u=t;return this.data_.forEach((function(t,e){u.beginPath(),u.moveTo(r,r),u.fillStyle=a.colors_[e%a.colors_.length],s=l+2*Math.PI*t/(o*n),u.arc(r,r,a.radius_*n,l,s),u.closePath(),u.fill(),i&&u.stroke(),l=s})),l}},{key:"data",get:function(){return this.data_},set:function(t){this.data_=t,this.renderChart_()}},{key:"radius",get:function(){return this.radius_},set:function(t){this.radius_=t,this.renderChart_()}}])&&rX(e.prototype,r),n&&rX(e,n),o}(Kw);function lX(t){return(lX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cX(t,e){return(cX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pX(t);if(e){var i=pX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return fX(this,r)}}function fX(t,e){return!e||"object"!==lX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pX(t){return(pX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dX(t){return(dX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gX(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return yX(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yX(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yX(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vX(t,e){return(vX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xX(t);if(e){var i=xX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return wX(this,r)}}function wX(t,e){return!e||"object"!==dX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xX(t){return(xX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var EX=function(t){var e=t;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.filter((function(t){return null!=t})).forEach((function(t){return Object.keys(t).forEach((function(r){Object.prototype.hasOwnProperty.call(t,r)&&!Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}))})),r},SX=function(t,e,r,n){var i;return i="0"===(i="function"==typeof t.text?t.text(n,r.data,e):"".concat(Hw.getValue(t.text,e))||"")?"":i},IX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vX(t,e)}(a,t);var e,r,n,s=bX(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return mX(this,a),EX(e,QW.DEFAULT),(t=s.call(this,e)).variables_=e.variables||[],t.colorsScheme_=e.scheme||[],t}return e=a,(r=[{key:"updateCanvas",value:function(t){if(!_V(t)){var e=t.getContext("2d");this.drawGeometryToCanvas(e)}}},{key:"drawGeometryToCanvas",value:function(t){var e=this,r=t;if(!_V(r)&&!_V(r.canvas)){var n=a.CANVAS_PROPS.fixedProps,i=a.CANVAS_PROPS.width;r.canvas.setAttribute("width",i),r.width=i;var o=[],s={};Object.keys(a.CANVAS_PROPS.percentages).forEach((function(t){s[t]=i*(a.CANVAS_PROPS.percentages[t]/100)}));var l=[s.left_right_content,n.top_content],u=l[0],c=l[1],h=function(t,i,a){var l=gX(t,2),u=l[0],c=l[1];c+=n.item_top_margin,o.push(function(t){var e=t.context;e.beginPath(),e.strokeStyle=t.strokeColor,e.lineWidth=t.width,e.fillStyle=t.color,e.rect(t.x,t.y,t.rectSize,t.rectSize),e.closePath(),e.stroke(),e.fill()}.bind(e,{context:r,strokeColor:"#000",width:n.rect_border_width,color:a,x:u,y:c,rectSize:n.rect_size})),u+=s.item_side_margin+n.rect_size;var h=(c+=n.rect_size/1.5)+n.item_top_margin,f=function(t,i,s,a,l){var u=s.split(" "),c="",h=i[0],f=i[1];return o.push(function(t){var e=t.context;e.font="".concat(t.fontSize,"px ").concat(t.fontFamily),e.strokeStyle=t.strokeColor,e.strokeWidth=t.strokeWidth,e.fillStyle=t.textColor}.bind(e,{context:r,fontSize:n.font_size,fontFamily:n.font_family,strokeColor:n.text_stroke_color,strokeWidth:n.text_stroke_width,textColor:n.text_color})),u.forEach((function(t,n){r.measureText("".concat(c+t)).width>a&&n>0?(o.push(function(t,e,r,n){t.strokeText(e,r,n),t.fillText(e,r,n)}.bind(e,r,c,h,f)),c="".concat(t," "),f+=l):c="".concat(c+t," ")})),o.push(function(t,e,r,n){t.strokeText(e,r,n),t.fillText(e,r,n)}.bind(e,r,c,h,f)),[h,f]}(0,[u,c],i,s.max_text_width,s.max_text_line_height);return[f[0],f[1]>h?f[1]:h]};this.variables_.forEach((function(t,r){var n=_V(t.legend)?t.attribute:t.legend,i=_V(t.fillColor)?e.colorsScheme_[r%e.colorsScheme_.length]||e.colorsScheme_[0]:t.fillColor,o=gX(h([u,c],n,i),2);u=o[0],c=o[1],u=s.left_right_content})),c+=n.top_content,r.canvas.setAttribute("height",c),r.save(),o.forEach((function(t){return t()})),r.restore()}}},{key:"updateFacadeOptions",value:function(t){var e=this,r=t;r.rotateWithView=!1,this.olStyleFn_=function(t,n){var s=t;s instanceof Cg||(s=e);var a=e.formatDataRecursively_(r,s),l=[];if(e.variables_.forEach((function(t){var e=s.get(t.attribute);e=parseFloat(e),l=l.concat(e instanceof Array?e:[e]).filter((function(t){return null!=t}))})),0===l.length)throw new Error("cannot draw an empty data chart");a.data=l,_V(r.stroke)||(a.stroke=new Zb(r.stroke));var u=[new px({geometry:function(t){var e=ry.getCentroid(t.getGeometry());return new dc(e)},image:new aX(a)})];return"bar"!==a.type?1!==r.variables.length&&r.variables.length!==l.length||(u=u.concat(function(t,e,r){var n=0,i=e.data.reduce((function(t,e){return t+e})),o=e.variables,s=e.data;return t.concat(e.data.map((function(t,a){var l=o.length===s.length?o[a]:o[0],u=l.label||{},c=u.radius?u.radius:e.radius,h=(2*n+t)/i*Math.PI-Math.PI/2;if(n+=t,!l.label)return null;var f="number"==typeof u.radiusIncrement?u.radiusIncrement:3,p="function"==typeof u.textAlign?u.textAlign(h):null;_V(p)&&(p=u.textAlign||(h<Math.PI/2?"left":"right"));var d=SX(u,r,e,t),g=Hw.getValue(u.font,r),y=new Kb({color:Hw.getValue(u.fill,r)||"#000"}),m=new Zb({color:Hw.getValue(u.stroke.color,r)||"#000",width:Hw.getValue(u.stroke.width,r)||1}),_=Math.cos(h)*(c+f+e.offsetX)||0,v=Math.sin(h)*(c+f+e.offsetY)||0,b=new Qb({text:"string"==typeof d?"".concat(d):"",offsetX:"number"==typeof u.offsetX?Hw.getValue(u.offsetX,r):_,offsetY:"number"==typeof u.offsetY?Hw.getValue(u.offsetY,r):v,textAlign:Hw.getValue(p,r),textBaseline:Hw.getValue(u.textBaseline,r)||"middle",stroke:u.stroke?m:void 0,font:/^([1-9])[0-9]*px ./.test(g)?g:"12px ".concat(g),scale:"number"==typeof u.scale?Hw.getValue(u.scale,r):void 0,fill:y});return new px({text:b})}))).filter((function(t){return null!=t}))}(u,a,s))):"bar"===a.type&&(u=u.concat(function(t,e,r){var n=0,i=null,o=e.variables,s=e.data,a=t.concat(e.data.map((function(a,l){var u=o.length===s.length?o[l]:o[0],c=u.label||{};if(!u.label)return null;var h=SX(c,r,e,a),f=Hw.getValue(c.font,r);_V(i)?i=t[0].getImage().getImage().height/2-6:i-=15,n=n+9+6;var p=-t[0].getImage().getImage().width/2-(1+e.offsetX)||0;return new px({text:new Qb({text:"string"==typeof h?"".concat(h):"",offsetY:i+e.offsetY||0,offsetX:p,textBaseline:"middle",rotateWithView:!1,textAlign:"center",stroke:c.stroke?new Zb({}):void 0,font:"9px ".concat(f),scale:"number"==typeof c.scale?Hw.getValue(c.scale,r):void 0,fill:new Kb({color:e.scheme[l%e.scheme.length]})})})}))),l=a.filter((function(t){return null!=t}));n=Math.max(n,1);var u=-t[0].getImage().getImage().width/2+10+e.offsetX,c=t[0].getImage().getImage().height/2+e.offsetY,h=new hw({anchor:[u,c],anchorOrigin:"bottom-right",offsetOrigin:"bottom-left",anchorXUnits:"pixels",anchorYUnits:"pixels",rotateWithView:!1,src:"data:image/svg+xml;base64,".concat(window.btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t[0].getImage().getImage().width/2,'" height="').concat(n,'"><rect width="').concat(a[0].getImage().getImage().width/2,'" height="').concat(n,'" fill="rgba(255, 255, 255, 0.75)" stroke-width="0" stroke="rgba(0, 0, 0, 0.34)"/></svg>'))),size:[a[0].getImage().getImage().width/2,n]});return l.push(new ox({image:h})),l}(u,a,s))),function(t,e,r){if(!_V(t.label)){var n=new ox,s=Hw.getValue(t.label.text,r),a=Hw.getValue(t.label.align,r),l=Hw.getValue(t.label.baseline,r),u=t.label.offset?t.label.offset[0]:void 0,c=t.label.offset?t.label.offset[1]:void 0,h=new Kb({color:Hw.getValue(t.label.color||"#000000",r)}),f=new Qb({font:Hw.getValue(t.label.font,r),rotateWithView:Hw.getValue(t.label.rotate,r),scale:Hw.getValue(t.label.scale,r),offsetX:Hw.getValue(u,r),offsetY:Hw.getValue(c,r),fill:h,textAlign:Object.values(o).includes(a)?a:"center",textBaseline:Object.values(i).includes(l)?l:"top",text:void 0===s?void 0:String(s),rotation:Hw.getValue(t.label.rotation,r)});_V(t.label.stroke)||f.setStroke(new Zb({color:Hw.getValue(t.label.stroke.color,r),width:Hw.getValue(t.label.stroke.width,r),lineCap:Hw.getValue(t.label.stroke.linecap,r),lineJoin:Hw.getValue(t.label.stroke.linejoin,r),lineDash:Hw.getValue(t.label.stroke.linedash,r),lineDashOffset:Hw.getValue(t.label.stroke.linedashoffset,r),miterLimit:Hw.getValue(t.label.stroke.miterlimit,r)})),n.setText(f),e.push(n)}}(a,u,s),u}}},{key:"applyToLayer",value:function(t){t.getFeatures().forEach(this.applyToFeature,this)}},{key:"applyToFeature",value:function(t){t.getImpl().getOLFeature().setStyle(this.olStyleFn_)}},{key:"formatDataRecursively_",value:function(t,e){var r=this;return Object.keys(t).reduce((function(n,i,o){var s=n;return"object"!==dX(n)&&(s={},"object"!==dX(t[n])&&r.setVal(s,t,n,e)),r.setVal(s,t,i),s}))}},{key:"setVal",value:function(t,e,r,n){var i=t;i[r]=Hw.getValue(e[r],n),!bV(e[r])||e[r]instanceof Array||(i[r]=this.formatDataRecursively_(e[r],n))}}])&&_X(e.prototype,r),n&&_X(e,n),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cX(t,e)}(r,t);var e=hX(r);function r(){return uX(this,r),e.apply(this,arguments)}return r}(zw));IX.CANVAS_PROPS={width:200,percentages:{left_right_content:5,item_side_margin:5,max_text_width:70},fixedProps:{rect_border_width:2,font_size:10,font_family:"sans-serif",text_stroke_color:"#fff",text_stroke_width:1,text_color:"#000",top_content:10,item_top_margin:10,text_line_height:15,rect_size:15}};var OX=IX;function CX(t){return(CX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TX(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function PX(t,e){return(PX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function RX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=MX(t);if(e){var i=MX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return LX(this,r)}}function LX(t,e){return!e||"object"!==CX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function MX(t){return(MX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&PX(t,e)}(o,t);var e,r,n,i=RX(o);function o(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,{})).heatmapLayer_=null,n.attribute_=t,n.opt_options_=HV(e,r),n.opt_options_.zIndex=999999,n.oldOLLayer_=null,n}return e=o,(r=[{key:"applyToLayer",value:function(t){if(this.layer_=t,!_V(t)){var e=this.layer_.getImpl().getOLLayer();e instanceof CW||(this.oldOLLayer_=e);var r=this.layer_.getFeatures().map((function(t){return t.getImpl().getOLFeature()}));r.forEach((function(t){return t.setStyle(null)})),this.createHeatmapLayer_(r),this.layer_.getImpl().setOLLayer(this.heatmapLayer_)}}},{key:"unapply",value:function(t){_V(this.oldOLLayer_)||(this.layer_.getImpl().setOLLayer(this.oldOLLayer_),this.layer_.redraw(),this.layer_=null,this.oldOLLayer_=null,this.heatmapLayer_=null)}},{key:"createHeatmapLayer_",value:function(t){this.opt_options_.source=new Fb({features:t}),this.opt_options_.name=this.layer_.name,this.heatmapLayer_=new AW(this.opt_options_)}},{key:"setOptions",value:function(t,e){this.opt_options_=HV(t,e)}},{key:"getMinWeight",value:function(){return this.heatmapLayer_.getMinWeight()}},{key:"getMaxWeight",value:function(){return this.heatmapLayer_.getMaxWeight()}}])&&TX(e.prototype,r),n&&TX(e,n),o}(zw);function NX(t){return(NX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FX(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function DX(t,e){return(DX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=zX(t);if(e){var i=zX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return GX(this,r)}}function GX(t,e){return!e||"object"!==NX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zX(t){return(zX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var UX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DX(t,e)}(o,t);var e,r,n,i=jX(o);function o(){return AX(this,o),i.apply(this,arguments)}return e=o,(r=[{key:"getImageSize",value:function(){return this.iconImage_.getSize()}}])&&FX(e.prototype,r),n&&FX(e,n),o}(hw);function BX(t){return(BX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VX(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qX(t,e){return(qX=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function YX(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=XX(t);if(e){var i=XX(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return WX(this,r)}}function WX(t,e){return!e||"object"!==BX(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function XX(t){return(XX=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qX(t,e)}(o,t);var e,r,n,i=YX(o);function o(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var e=t;_V(e)&&(e=o.DEFAULT_NULL),e=HV({},e);var r=new lH(e);return i.call(this,e,r)}return e=o,(r=[{key:"unapply",value:function(t){this.getImpl().unapply(t)}},{key:"getDeserializedMethod_",value:function(){return"((serializedParameters) => M.style.Simple.deserialize(serializedParameters, 'M.style.Line'))"}}])&&VX(e.prototype,r),n&&VX(e,n),o}(Hx);HX.DEFAULT_NULL={fill:{color:"rgba(255, 255, 255, 0.4)",opacity:.4},stroke:{color:"#3399CC",width:1.5}};var ZX=HX;function KX(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var $X=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"render",value:function(t,e){for(var r=t,n=this,i=0,o=0,s=2,a=function(t,e,r,n){var i=r-t,o=n-e;return Math.sqrt(i*i+o*o)},l=function(t,e){if(!i||o+i<e)for(;s<t.length&&(i=a(t[s-2],t[s-1],t[s],t[s+1]),!(o+i>e))&&!((s+=2)>=t.length);)o+=i;var r=e-o;return s>=t.length&&(s=t.length-2),[r?t[s-2]+(t[s]-t[s-2])*r/i:t[s-2],r?t[s-1]+(t[s+1]-t[s-1])*r/i:t[s-1],Math.atan2(t[s+1]-t[s-1],t[s]-t[s-2])]},u=.25*n.measureText(" ").width,c=0,h=0,f=2;f<e.length;f+=2)h+=a(e[f-2],e[f-1],e[f],e[f+1]);if(!(h<n.minWidth)){var p=r.split(" ").length-1;if("visible"!==n.textOverflow&&h<n.measureText(r).width+(r.length-(1+p))*u){var d="ellipsis"===n.textOverflow?"…":n.textOverflow;do{p=r.split(" ").length-1,r=r.slice(0,r.length-1)}while(r&&h<n.measureText(r+d).width+(r.length+(d.length-1)+p)*u);r+=d}switch(n.textJustify||n.textAlign){case!0:case"center":case"end":case"right":n.textJustify?(c=0,u=(h-n.measureText(r).width)/(t.length-(1+p))):(c=h-n.measureText(r).width-(r.length+p)*u,"center"===n.textAlign&&(c/=2))}for(var g=0;g<r.length;g+=1){var y=r[g],m=n.measureText(y).width,_=l(e,c+m/2);n.save(),n.textAlign="center",n.translate(_[0],_[1]),n.rotate(_[2]),n.lineWidth&&n.strokeText(y,0,0),n.fillText(y,0,0),n.restore(),c+=m+u*(" "===y?2:1)}}}},{key:"getPath_",value:function(t,e,r){var n=[];if(e.forEach((function(e){n.push(t[0]*e[0]+t[1]*e[1]+t[4]),n.push(t[2]*e[0]+t[3]*e[1]+t[5])})),r&&n[0]>n[n.length-2]){for(var i=[],o=n.length-2;o>=0;o-=2)i.push(n[o]),i.push(n[o+1]);return i}return n}},{key:"formatStyle",value:function(t){var e=t;return null==e?null:(void 0===e&&(e=[new ox({text:new Qb})]),"function"==typeof e?e:function(){return[e]})}},{key:"draw",value:function(e,r,n,i){var o=this.getPath_(r,i,n.getRotateWithView());e.font=n.getFont(),e.textBaseline=n.getTextBaseline(),e.textAlign=n.getTextAlign(),e.lineWidth=n.getStroke()&&n.getStroke().getWidth()||t.DEFAULT.lineWidth,e.strokeStyle=n.getStroke()&&n.getStroke().getColor()||t.DEFAULT.lineColor,e.fillStyle=n.getFill()&&n.getFill().getColor()||t.DEFAULT.fillColor,e.textJustify="justify"===n.getTextAlign(),e.textOverflow=n.getTextOverflow?n.getTextOverflow():t.DEFAULT.textOverflow,e.minWidth=n.getMinWidth?n.getMinWidth():t.DEFAULT.minWidth,"function"==typeof e.textPath&&e.textPath(n.getText(),o),e.restore()}}],(r=null)&&KX(e.prototype,r),n&&KX(e,n),t}();$X.DEFAULT={lineWidth:0,lineColor:"#fff",fillColor:"#000",textOverflow:"",minWidth:0};var JX=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(dV(window.CanvasRenderingContext2D.prototype.textPath)&&(window.CanvasRenderingContext2D.prototype.textPath=$X.render),!(e.frameState.viewState.resolution>this.textPathMaxResolution_)){var r=e.frameState.extent,n=e.context;n.save(),n.scale(e.frameState.pixelRatio,e.frameState.pixelRatio);var i=null!=this.getSource()&&0===this.getSource().getFeatures().length;i||(this.getSource().getFeaturesInExtent(r).forEach((function(r){var i=null!=r.getStyle()?r.getStyle():t.getStyle(),o="function"==typeof i?i(r,e.frameState.viewState.resolution):i;o instanceof Array||(o=[o]),o.forEach((function(t){var i,o=(t instanceof ZX?t.getOptions().geometry:t.getGeometry())||r.getGeometry();switch("function"==typeof o&&(o=o(r)),o.getType()){case"MultiLineString":i=o.getLineString(0).getCoordinates();break;default:i=o.getCoordinates()}var s=t instanceof ZX?t.getOptions().text:t.textPath;null!=s&&s instanceof eC&&$X.draw(n,e.frameState.coordinateToPixelTransform,s,i)}))})),n.restore())}};Vu.prototype.cspline=function(t){var e;return this.calcCSpline?this.csplineGeometryRevision===this.getRevision()&&this.csplineOption===JSON.stringify(t)||(this.csplineGeometry_=this.calcCSpline(t),this.csplineGeometryRevision=this.getRevision(),this.csplineOption=JSON.stringify(t),e=this.csplineGeometry_):e=this,e},Yg.prototype.calcCSpline=function(t){var e=[];return this.getGeometries().forEach((function(t){return e.push(t.cspline())})),new Yg(e)},zg.prototype.calcCSpline=function(t){var e=[];return this.getLineStrings().forEach((function(t){return e.push(t.cspline().getCoordinates())})),new zg(e)},Rc.prototype.calcCSpline=function(t){var e=[];return this.getLineStrings().forEach((function(t){return e.push(t.cspline().getCoordinates())})),new Rc(e)},Bg.prototype.calcCSpline=function(t){var e=[];return this.getLineStrings().forEach((function(t){return e.push(t.cspline().getCoordinates())})),new Bg(e)};var QX=function(t,e,r,n){var i=r-t,o=n-e;return Math.sqrt(i*i+o*o)};function tH(t){return(tH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rH(t,e,r){return(rH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sH(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function nH(t,e){return(nH=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function iH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=sH(t);if(e){var i=sH(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return oH(this,r)}}function oH(t,e){return!e||"object"!==tH(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sH(t){return(sH=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Fg.prototype.calcCSpline=function(){var t,e,r,n,i,o,s,a,l,u,c,h,f,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=this.getCoordinates(),g="number"==typeof p.tension?p.tension:.5,y=p.resolution||this.getLength()/d.length/(p.pointsPerSeg||10),m=[],_=d.slice(0);for(d.length>2&&d[0][0]===d[d.length-1][0]&&d[0][1]===d[d.length-1][1]?(_.unshift(d[d.length-2]),_.push(d[1])):(_.unshift(d[0]),_.push(d[d.length-1])),f=1;f<_.length-2;f+=1){var v=QX(_[f][0],_[f][1],_[f+1][0],_[f+1][1]),b=Math.round(v/y),w=1;if(p.normalize){var x=QX(_[f+1][0],_[f+1][1],_[f-1][0],_[f-1][1]),E=QX(_[f+2][0],_[f+2][1],_[f][0],_[f][1]);w=x<E?x/E:E/x}for(r=(_[f+1][0]-_[f-1][0])*g*w,n=(_[f+2][0]-_[f][0])*g*w,i=(_[f+1][1]-_[f-1][1])*g*w,o=(_[f+2][1]-_[f][1])*g*w,h=0;h<=b;h+=1)c=h/b,s=2*Math.pow(c,3)-(3*Math.pow(c,2)+1),a=-2*Math.pow(c,3)+3*Math.pow(c,2),l=Math.pow(c,3)-(2*Math.pow(c,2)+c),u=Math.pow(c,3)-Math.pow(c,2),t=s*_[f][0]+a*_[f+1][0]+l*r+u*n,e=s*_[f][1]+a*_[f+1][1]+l*i+u*o,m.push([t,e])}return new Fg(m)};var aH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nH(t,e)}(o,t);var e,r,n,i=iH(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this,t)).olStyleFn_=e.updateFacadeOptions(t),e}return e=o,n=[{key:"getCanvasSize",value:function(){return[25,15]}}],(r=[{key:"updateFacadeOptions",value:function(t){var e=this;return function(r){var n=r;n instanceof Cg||n instanceof kg||(n=e);var i,o=t.stroke,s=t.label,a=new px,l=new px,c=Hw.getValue;if(_V(o)||a.setStroke(new Zb({color:c(o.color,n),width:c(o.width,n),lineDash:c(o.linedash,n),lineDashOffset:c(o.linedashoffset,n),lineCap:c(o.linecap,n),lineJoin:c(o.linejoin,n),miterLimit:c(o.miterlimit,n)})),!_V(s)){var h={text:void 0===c(s.text,n)?void 0:String(c(s.text,n)),font:c(s.font,n),fill:new Kb({color:c(s.color||"#000000",n)}),textBaseline:(c(s.baseline,n)||"").toLowerCase(),textAlign:c(s.align,n),scale:c(s.scale,n),rotateWithView:c(s.rotate,n)||!1,textOverflow:c(s.textoverflow,n)||"",minWidth:c(s.minwidth,n)||0,geometry:c(s.geometry,n),offsetX:c(t.label.offset?t.label.offset[0]:void 0,n),offsetY:c(t.label.offset?t.label.offset[1]:void 0,n)},f=new eC(h);_V(s.stroke)||f.setStroke(new Zb({color:c(s.stroke.color,n),width:c(s.stroke.width,n),lineCap:c(s.stroke.linecap,n),lineJoin:c(s.stroke.linejoin,n),lineDash:c(s.stroke.linedash,n),lineDashOffset:c(s.stroke.linedashoffset,n),miterLimit:c(s.stroke.miterlimit,n)}));var p=c(s.path,n);"boolean"==typeof p&&p?(a.textPath=f,!_V(s.smooth)&&!0===s.smooth&&vV(n.getGeometry)&&a.setGeometry(n.getGeometry().cspline())):a.setText(f)}if(!_V(t.fill)){var d=Hw.getValue(t.fill.color,n,e.layer_),g=Hw.getValue(t.fill.opacity,n,e.layer_);g||0===g||(g=1);var y=Hw.getValue(t.fill.width,n,e.layer_);_V(d)||(i=new Zb({color:u()(d).alpha(g).css(),width:y}))}return l.setStroke(i),[a,l]}}},{key:"applyToLayer",value:function(t){rH(sH(o.prototype),"applyToLayer",this).call(this,t);var e=t.getImpl().getOLLayer();_V(e)||(this.postComposeEvtKey_=e.on("postcompose",JX,e))}},{key:"unapply",value:function(){ma(this.postComposeEvtKey_)}},{key:"drawGeometryToCanvas",value:function(t,e,r,n){var i=o.getCanvasSize()[0],s=o.getCanvasSize()[1];if(t.drawGeometry(new Fg([[0+n/2,0+n/2],[i/3,s/2-n/2],[2*i/3,0+n/2],[i-n/2,s/2-n/2]])),!_V(r)){var a=r.width,l=e.getContext("2d");l.lineWidth=r.width,i=e.width,s=e.height,l.strokeStyle=r.color,l.beginPath(),l.lineTo(0+a,0+a),l.lineTo(i/3,s/2-a),l.lineTo(2*i/3,0+a),l.lineTo(i-a,s/2-a),l.stroke()}}},{key:"updateCanvas",value:function(t){this.updateFacadeOptions(this.options_);var e,r=o.getCanvasSize(),n=Tw(t.getContext("2d"),{size:r}),i=this.olStyleFn_()[1];_V(i)||_V(i.getStroke())||(e={color:i.getStroke().getColor(),width:1});var s=this.olStyleFn_()[0];_V(s.getText())||s.setText(null);var a,l=s.getStroke();_V(l)||(_V(l.getWidth())?a=1:(a=l.getWidth(),l.getWidth()>o.DEFAULT_WIDTH_LINE&&(a=o.DEFAULT_WIDTH_LINE)),e={color:s.getStroke().getColor(),width:a},s.getStroke().setWidth(a),n.setStyle(s)),this.drawGeometryToCanvas(n,t,e,a)}}])&&eH(e.prototype,r),n&&eH(e,n),o}(Hw);aH.DEFAULT_WIDTH_LINE=3;var lH=aH;function uH(t){return(uH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cH(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return hH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hH(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hH(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dH(t,e){return(dH=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mH(t);if(e){var i=mH(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return yH(this,r)}}function yH(t,e){return!e||"object"!==uH(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mH(t){return(mH=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _H=function(t,e){var r=void 0,n=void 0,i=t.filter((function(t){return![NaN,void 0,null].includes(t.getAttribute(e))})).map((function(t){return parseInt(t.getAttribute(e),10)})),o=1;if(!_V(i))for(r=i[0],n=i[0];o<i.length-1;){var s=i[o+1];r=r<s?r:s,n=n<s?s:n,o+=1}return[r,n]},vH=function(t,e,r,n,i){return(t-e)*(i-n)/(r-e)+n},bH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dH(t,e)}(o,t);var e,r,n,i=gH(o);function o(t,e,r,n,s){var a,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return fH(this,o),a=i.call(this,l,{}),_V(t)&&Of(pp("exception").no_attr_name),a.attributeName_=t,a.minRadius_=parseInt(e,10)||5,a.maxRadius_=parseInt(r,10)||15,a.style_=n,a.proportionalFunction_=s||vH,a.maxRadius_<a.minRadius_&&(a.minRadius_=r,a.maxRadius_=e),_V(a.style_)||a.styles_.push(a.style_),a}return e=o,n=[{key:"getSizeAttribute",value:function(t){var e="radius";return _V(t.get("icon"))||(e=_V(t.get("icon.src"))?"icon.radius":"icon.scale"),e}},{key:"deserialize",value:function(t){var e=cH(t,6),r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],l=r,u=n,c=i,h=QV(s),f=QV(a),p=new Function(["attributeName","minRadius","maxRadius","style","proportionalFunction","options"],"return new M.style.Proportional(attributeName,\n    minRadius, maxRadius, style, proportionalFunction, options)")(l,u,c,void 0,h,f),d=o.map((function(t){return Rx.deserialize(t)}));return p.add(d),p}}],(r=[{key:"applyInternal",value:function(t){this.layer_=t,this.update_()}},{key:"applyToFeature",value:function(t,e){var r=this.style_;if(_V(r)&&(r=t.getStyle()?t.getStyle():this.layer_.getStyle()),!_V(r)){!(r instanceof $E)&&r instanceof Hx?r=new $E(r.getOptions()):r instanceof TI&&(r=new $E(r.getOldStyle().getOptions()));var n=this.calculateStyle_(t,{minRadius:this.minRadius_,maxRadius:this.maxRadius_,minValue:this.minValue_,maxValue:this.maxValue_},r);t.setStyle(n)}}},{key:"update_",value:function(){var t=this;if(!_V(this.layer_)){_V(this.style_),this.oldStyle_=this.layer_.getStyle()instanceof TI?this.layer_.getStyle().getOldStyle():this.layer_.getStyle();var e=cH(_H(this.layer_.getFeatures(),this.attributeName_),2);this.minValue_=e[0],this.maxValue_=e[1],this.layer_.getFeatures().forEach((function(e){return t.applyToFeature(e,1)}));var r=this.oldStyle_.clone();r instanceof Hx&&(r instanceof $E||(r=new $E(r.getOptions())),r.set("zindex",(function(e){return t.maxValue_-parseFloat(e.getAttribute(t.attributeName_))})),r.set(o.getSizeAttribute(r),(function(e){var r=o.SCALE_PROPORTION,n=e.getAttribute(t.attributeName_),i=[n,t.minValue_,t.maxValue_,t.minRadius_,t.maxRadius_],s=t.proportionalFunction_.apply(t,i);if("icon.scale"===o.getSizeAttribute(t.oldStyle_)){var a=t.minRadius_/r,l=t.maxRadius_/r,u=[n,t.minValue_,t.maxValue_,a,l];s=t.proportionalFunction_.apply(t,u)}return s})),this.updateCanvas())}}},{key:"getAttributeName",value:function(){return this.attributeName_}},{key:"setAttributeName",value:function(t){return this.attributeName_=t,this.update_(),this}},{key:"getStyle",value:function(){return console.warn("Deprecated function: Use getStyles instead."),this.style_}},{key:"setStyle",value:function(t){return this.style_=t,this.update_(),this}},{key:"getMinRadius",value:function(){return this.minRadius_}},{key:"setProportionalFunction",value:function(t){this.proportionalFunction_=t,this.update_()}},{key:"getProportionalFunction",value:function(){return this.proportionalFunction_}},{key:"setMinRadius",value:function(t){return this.minRadius_=parseInt(t,10),t>=this.maxRadius_&&Of(pp("exception").min_gt_max),this.update_(),this}},{key:"getMaxRadius",value:function(){return this.maxRadius_}},{key:"setMaxRadius",value:function(t){return this.maxRadius_=parseInt(t,10),t<=this.minRadius_&&Of(pp("exception").max_lt_min),this.update_(),this}},{key:"updateCanvas",value:function(){var t=this;this.updateCanvasPromise_=new Promise((function(e,r){if(!_V(t.layer_)){var n=t.styles_.filter((function(t){return t instanceof Hx}))[0],i=_V(n)?t.layer_.getStyle():n;if((i=_V(i)?t.style_:i)instanceof Hx){var s=i.clone();s instanceof $E||(s=new $E(s.getOptions()));var a=o.getSizeAttribute(s),l=s.clone(),u=s.clone(),c=t.getMaxRadius(),h=t.getMinRadius();l.set(a,c),u.set(a,h),t.loadCanvasImage(c,l.toImage(),(function(r){t.loadCanvasImage(h,u.toImage(),(function(n){t.drawGeometryToCanvas(r,n,e)}))}))}else _V(i)||(t.canvas_=i.canvas,e())}}))}},{key:"loadCanvasImage",value:function(t,e,r){var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){r({image:n,value:t})},n.onerror=function(){r({value:t})},n.src=e}},{key:"drawGeometryToCanvas",value:function(t,e,r){var n=t.image,i=e.image;this.canvas_.height=n.height+5+i.height+5;var o=this.canvas_.getContext("2d");o.textBaseline="middle";var s=0,a=0;if(_V(n)||(s=n.width+5,a=n.height/2,/^https?:\/\//i.test(n.src)?(this.canvas_.height=130,o.fillText("  max: ".concat(this.maxValue_),85,40),o.drawImage(n,0,0,80,80)):(o.fillText("  max: ".concat(this.maxValue_),s,a),o.drawImage(n,0,0))),!_V(i)){var l=0;_V(n)||(l=n.width/2-i.width/2);var u=n.height+5;a=u+i.height/2,/^https?:\/\//i.test(i.src)?(o.fillText("  min: ".concat(this.minValue_),85,105),o.drawImage(i,20,85,40,40)):(o.fillText("  min: ".concat(this.minValue_),s,a),o.drawImage(i,l,u))}r()}},{key:"calculateStyle_",value:function(t,e,r){var n=this.proportionalFunction_,i=r;if(!_V(i)){i=i.clone();var s=[e.minRadius,e.maxRadius],a=s[0],l=s[1];_V(i.get("icon.src"))||(a=e.minRadius/o.SCALE_PROPORTION,l=e.maxRadius/o.SCALE_PROPORTION);var u=t.getAttribute(this.attributeName_);null==u&&console.warn("Warning: ".concat(this.attributeName_," value is null or empty."));var c=n(u,e.minValue,e.maxValue,a,l),h=e.maxValue-parseFloat(t.getAttribute(this.attributeName_));i.set(o.getSizeAttribute(i),c),i.set("zindex",h)}return i}},{key:"toJSON",value:function(){var t=this.getAttributeName(),e=this.getMinRadius(),r=this.getMaxRadius(),n=this.getStyles().map((function(t){return t.serialize()})),i=JV(this.getProportionalFunction()),o=HV({},this.getOptions());return{parameters:[t,e,r,n,i,o=JV(o)],deserializedMethod:"M.style.Proportional.deserialize"}}},{key:"ORDER",get:function(){return 3}}])&&pH(e.prototype,r),n&&pH(e,n),o}(TI);bH.SCALE_PROPORTION=20;var wH=bH,xH=function(t){var e,r=t.radius,n=u.a.random().hex(),i=t.strokeColor,o=t.strokeWidth;switch(t.feature.getGeometry().type){case"Point":case"MultiPoint":e=new $E({radius:r,fill:{color:n},stroke:{color:i,width:o}});break;case"LineString":case"MultiLineString":e=new ZX({fill:{color:n},stroke:{color:i,width:o}});break;case"Polygon":case"MultiPolygon":e=new nE({fill:{color:n},stroke:{color:i,width:o}});break;default:e=null}return e};function EH(t){return(EH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function SH(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return IH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IH(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IH(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function OH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function TH(t,e,r){return(TH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=MH(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function PH(t,e){return(PH=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function RH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=MH(t);if(e){var i=MH(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return LH(this,r)}}function LH(t,e){return!e||"object"!==EH(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function MH(t){return(MH=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&PH(t,e)}(o,t);var e,r,n,i=RH(o);function o(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return OH(this,o),r=i.call(this,n,{}),_V(t)&&Of(pp("exception").no_attr_name),r.attributeName_=t,r.categoryStyles_=e,r}return e=o,n=[{key:"deserialize",value:function(t){var e=SH(t,4),r=e[0],n=e[1],i=e[2],o=e[3],s=r,a=n;Object.keys(n).forEach((function(t){a[t]=Rx.deserialize(n[t])}));var l=QV(i),u=new Function(["attributeName","categoryStyles","options"],"return new M.style.Category(attributeName, categoryStyles, options)")(s,a,l),c=o.map((function(t){return Rx.deserialize(t)}));return u.add(c),u}}],(r=[{key:"applyInternal",value:function(t){this.layer_=t,this.update_()}},{key:"getAttributeName",value:function(){return this.attributeName_}},{key:"setAttributeName",value:function(t){return this.attributeName_=t,this.update_(),this.refresh(),this}},{key:"getCategories",value:function(){return this.categoryStyles_}},{key:"setCategories",value:function(t){return this.categoryStyles_=t,this.update_(),this.refresh(),this}},{key:"getStyleForCategory",value:function(t){return this.categoryStyles_[t]}},{key:"setStyleForCategory",value:function(t,e){return this.categoryStyles_[t]=e,this.update_(),this.refresh(),this}},{key:"updateCanvas",value:function(){var t=this,e=[];this.updateCanvasPromise_=new Promise((function(r,n){return t.loadCanvasImages_(0,e,r)}))}},{key:"loadCanvasImages_",value:function(t,e,r){var n=this,i=this.getCategories(),o=Object.keys(i);if(t===o.length)this.drawGeometryToCanvas(e,r);else{var s=o[t],a=this.getStyleForCategory(s),l=new Image;l.crossOrigin="Anonymous",l.onload=function(){e.push({image:l,categoryName:s}),n.loadCanvasImages_(t+1,e,r)},l.onerror=function(){e.push({categoryName:s}),n.loadCanvasImages_(t+1,e,r)},a.updateCanvas(),a.get("icon.src")?$V(a.get("icon.src")).then((function(t){l.width=a.get("icon.scale")?t.width*a.get("icon.scale"):t.width,l.height=a.get("icon.scale")?t.height*a.get("icon.scale"):t.height,l.src=a.toImage()})):l.src=a.toImage()}}},{key:"drawGeometryToCanvas",value:function(t,e){var r=t.map((function(t){return t.image.height})),n=t.map((function(t){return t.image.width})),i=this.canvas_.getContext("2d");i.canvas.height=r.reduce((function(t,e){return t+e+5})),i.textBaseline="middle";var o=Math.max.apply(n,n);t.forEach((function(t,e){var n=t.image,s=t.categoryName,a=0,l=r.slice(0,e);_V(l)||(a=l.reduce((function(t,e){return t+e+5})),a+=5);var u=0;if(!_V(n)){u=n.height;var c=(o-n.width)/2;i.drawImage(n,c,a,n.width,n.height)}i.fillText(s,o+5,a+u/2)})),e()}},{key:"update_",value:function(){var t=this;if(!_V(this.layer_)){(_V(this.categoryStyles_)||0===Object.keys(this.categoryStyles_).length)&&(this.categoryStyles_=this.generateRandomCategories_());var e=this.categoryStyles_.other;this.layer_.getFeatures().forEach((function(r){var n=r.getAttribute(t.attributeName_),i=t.categoryStyles_[n];_V(i)?_V(e)||r.setStyle(e):r.setStyle(i)})),this.updateCanvas()}}},{key:"add",value:function(t){var e=t;return mV(e)||(e=[e]),e=e.filter((function(t){return t instanceof zI||t instanceof wH})),TH(MH(o.prototype),"add",this).call(this,e)}},{key:"generateRandomCategories_",value:function(){var t=this,e={};return _V(this.layer_)||this.layer_.getFeatures().forEach((function(r){var n=r.getAttribute(t.attributeName_);Object.prototype.hasOwnProperty.call(e,n)||(e[n]=xH({feature:r,radius:o.RANDOM_RADIUS_OPTION,strokeColor:o.RANDOM_STROKE_COLOR_OPTION,strokeWidth:o.RANDOM_STROKE_WIDTH_OPTION}))})),e}},{key:"toJSON",value:function(){var t=this.getAttributeName(),e=this.getCategories(),r={};Object.keys(e).forEach((function(t){r[t]=e[t].serialize()}));var n=HV({},this.getOptions());n=JV(n);var i=this.getStyles().map((function(t){return t.serialize()}));return{parameters:[t,r,n,i],deserializedMethod:"M.style.Category.deserialize"}}},{key:"ORDER",get:function(){return 2}}])&&CH(e.prototype,r),n&&CH(e,n),o}(TI);kH.RANDOM_RADIUS_OPTION=10,kH.RANDOM_STROKE_WIDTH_OPTION=1,kH.RANDOM_STROKE_COLOR_OPTION="black";var NH=kH,AH=function(t){var e=[];return t.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),e},FH=function(t,e){for(var r=[],n=[],i=0,o=0;o<t.length+1;o+=1){for(var s=[],a=[],l=0;l<e+1;l+=1)s.push(0),a.push(0);r.push(s),n.push(a)}for(var u=1;u<e+1;u+=1){r[1][u]=1,n[1][u]=0;for(var c=2;c<t.length+1;c+=1)n[c][u]=1/0}for(var h=2;h<t.length+1;h+=1){for(var f=0,p=0,d=0,g=0,y=1;y<h+1;y+=1){var m=h-y+1,_=t[m-1];if(d+=1,f+=_,i=(p+=_*_)-Math.pow(f,2)/d,0!==(g=m-1))for(var v=2;v<e+1;v+=1)n[h][v]>=i+n[g][v-1]&&(r[h][v]=m,n[h][v]=i+n[g][v-1])}r[h][1]=1,n[h][1]=i}return{lowerClassLimits:r,varianceCombinations:n}},DH=function(t,e,r){var n=t.length-1,i=[],o=r;for(i[r]=t[t.length-1],i[0]=t[0];o>1;)i[o-1]=t[e[n][o]-2],n=e[n][o]-1,o-=1;return i},jH=function(t){var e=t;e=e||5;var r=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=AH(t),i=n.length<=r?n.length-1:r;t.sort((function(t,e){return t-e}));var o=FH(t,i),s=o.lowerClassLimits,a=DH(t,s,i),l=a.slice(1,a.length);return l};return Object.defineProperty(r,"name",{value:"jenks"}),r},GH=function(t){var e=t||5,r=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=AH(t),i=n.length<=r?n.length-1:r,o=t.length;t.sort((function(t,e){return t-e}));for(var s=Math.trunc(o/i),a=[],l=0;l<i;l+=1){var u=t.slice(l*s,(l+1)*s);l===i-1&&(u=t.slice(l*s));var c=u.slice(-1)[0];a.push(c)}return a};return Object.defineProperty(r,"name",{value:"quantile"}),r},zH=function(t,e){return new Gq((function(r){return null!=r.getAttribute(t)&&r.getAttribute(t)<=e}),{cqlFilter:"".concat(t," <= '").concat(e,"'")})};function UH(t){return(UH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function BH(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return VH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VH(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VH(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function WH(t,e,r){return(WH="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=KH(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function XH(t,e){return(XH=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function HH(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=KH(t);if(e){var i=KH(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return ZH(this,r)}}function ZH(t,e){return!e||"object"!==UH(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function KH(t){return(KH=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $H=function(t){var e=Math.pow(10,2);return Math.round(t*e)/e},JH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&XH(t,e)}(o,t);var e,r,n,i=HH(o);function o(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jH(),s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return qH(this,o),r=i.call(this,s,{}),_V(t)&&Of(pp("exception").no_attr_name),r.attributeName_=t,r.choroplethStyles_=e,r.quantification_=n,r.dataValues_=[],r.breakPoints_=[],r}return e=o,n=[{key:"DEFAULT_STYLE",value:function(t){return new PC({point:{fill:{color:t,opacity:1},stroke:{color:"black",width:1},radius:5},line:{stroke:{color:t,width:1}},polygon:{fill:{color:t,opacity:1},stroke:{color:t,width:1}}})}},{key:"deserialize",value:function(t){var e,r=BH(t,5),n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=n,u=i.map((function(t){return Rx.deserialize(t)}));e="jenks"===o?jH():"quantile"===o?GH():QV(o);var c=QV(s),h=new Function(["attributeName","styles","quantification","options"],"return new M.style.Choropleth(attributeName, styles, quantification, options)")(l,u,e,c),f=a.map((function(t){return Rx.deserialize(t)}));return h.add(f),h}}],(r=[{key:"applyInternal",value:function(t){this.layer_=t,this.update_()}},{key:"getAttributeName",value:function(){return this.attributeName_}},{key:"setAttributeName",value:function(t){return this.attributeName_=t,this.update_(),this.refresh(),this}},{key:"getQuantification",value:function(){return this.quantification_}},{key:"setQuantification",value:function(t){if(this.quantification_=t,!this.choroplethStyles_.some((function(t){return wV(t)}))){if(this.choroplethStyles_.length<this.quantification_().length){var e=BH(this.choroplethStyles_,2),r=e[0],n=e[1],i=r.get("fill.color"),o=n.get("fill.color");_V(i)&&(i=r.get("stroke.color")),_V(o)&&(o=n.get("stroke.color")),this.choroplethStyles_=[i,o]}else this.choroplethStyles_=this.choroplethStyles_.slice(0,this.quantification_().length);this.update_(),this.refresh()}return this}},{key:"getChoroplethStyles",value:function(){return this.choroplethStyles_}},{key:"setStyles",value:function(t){var e=t;return mV(e)||(e=[e]),this.choroplethStyles_=e,this.update_(),this.refresh(),this}},{key:"updateCanvas",value:function(){var t=this;if(!_V(this.choroplethStyles_)&&this.breakPoints_.length>0){var e=[];this.updateCanvasPromise_=new Promise((function(r,n){return t.loadCanvasImages_(0,e,r)}))}}},{key:"loadCanvasImages_",value:function(t,e,r){var n=this;if(t===this.choroplethStyles_.length)this.drawGeometryToCanvas(e,r);else{var i=-1;t>0&&(i=this.breakPoints_[t-1]);var o=this.breakPoints_[t],s=new Image;s.crossOrigin="Anonymous",s.onload=function(){e.push({image:s,startLimit:$H(i),endLimit:$H(o)}),n.loadCanvasImages_(t+1,e,r)},s.onerror=function(){e.push({startLimit:$H(i),endLimit:$H(o)}),n.loadCanvasImages_(t+1,e,r)},this.choroplethStyles_[t].updateCanvas(),s.src=this.choroplethStyles_[t].toImage()}}},{key:"drawGeometryToCanvas",value:function(t,e){var r=t.map((function(t){return t.image.height})),n=t.map((function(t){return t.image.width})),i=this.canvas_.getContext("2d");i.canvas.height=r.reduce((function(t,e){return t+e+5})),i.textBaseline="middle";var o=Math.max.apply(n,n);t.forEach((function(t,e){var n=t.image,s=t.startLimit,a=t.endLimit,l=0,u=r.slice(0,e);_V(u)||(l=u.reduce((function(t,e){return t+e+5})),l+=5);var c=0;_V(n)||(c=n.height,i.drawImage(n,0,l)),s<0?i.fillText(" x  <=  ".concat(a),o+5,l+c/2):i.fillText("".concat(s," <  x  <=  ").concat(a),o+5,l+c/2)}),this),e()}},{key:"getValues",value:function(){var t=this,e=[];return _V(this.layer_)||this.layer_.getFeatures().forEach((function(r){try{var n=parseFloat(r.getAttribute(t.attributeName_));Number.isNaN(n)||e.push(n)}catch(t){}}),this),e}},{key:"update_",value:function(){var t,e,r=this;if(!_V(this.layer_)){var n=this.layer_.getFeatures();if(!_V(n))if(this.dataValues_=this.getValues(),_V(this.choroplethStyles_)||!_V(this.choroplethStyles_)&&(wV(this.choroplethStyles_[0])||wV(this.choroplethStyles_[1]))){this.breakPoints_=this.quantification_(this.dataValues_);var i=this.choroplethStyles_&&this.choroplethStyles_[0]?this.choroplethStyles_[0]:o.START_COLOR_DEFAULT,s=this.choroplethStyles_&&this.choroplethStyles_[1]?this.choroplethStyles_[1]:o.END_COLOR_DEFAULT,a=this.breakPoints_.length,l=WV(i,s,a);mV(l)||(l=[l]),this.choroplethStyles_=(t=l,e=o.DEFAULT_STYLE,t.map((function(t){return e(t)})))}else this.breakPoints_=this.quantification_(this.dataValues_,this.choroplethStyles_.length);for(var u=function(t){new zH(r.attributeName_,r.breakPoints_[t]).execute(n).forEach((function(e){return e.setStyle(r.choroplethStyles_[t])}))},c=this.breakPoints_.length-1;c>-1;c-=1)u(c);this.updateCanvas()}}},{key:"add",value:function(t){var e=t;return mV(e)||(e=[e]),e=e.filter((function(t){return t instanceof zI||t instanceof wH})),WH(KH(o.prototype),"add",this).call(this,e)}},{key:"toJSON",value:function(){var t=this.getAttributeName(),e=this.getChoroplethStyles().map((function(t){return t.serialize()})),r=this.getQuantification();r=_V(r.name)?JV(r):r.name;var n=HV({},this.getOptions());return{parameters:[t,e,r,n=JV(n),this.getStyles().map((function(t){return t.serialize()}))],deserializedMethod:"M.style.Choropleth.deserialize"}}},{key:"ORDER",get:function(){return 2}}])&&YH(e.prototype,r),n&&YH(e,n),o}(TI);JH.START_COLOR_DEFAULT="red",JH.END_COLOR_DEFAULT="brown";var QH=JH;function tZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var eZ=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"addSymbol",value:function(t,e){return hE.addDefs(t,e)}}],(r=null)&&tZ(e.prototype,r),n&&tZ(e,n),t}();function rZ(t){return(rZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nZ(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||oZ(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iZ(t){return function(t){if(Array.isArray(t))return sZ(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||oZ(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oZ(t,e){if(t){if("string"==typeof t)return sZ(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sZ(t,e):void 0}}function sZ(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function aZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uZ(t,e){return(uZ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cZ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=fZ(t);if(e){var i=fZ(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return hZ(this,r)}}function hZ(t,e){return!e||"object"!==rZ(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fZ(t){return(fZ=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pZ=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uZ(t,e)}(o,t);var e,r,n,i=cZ(o);function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};aZ(this,o);var s=r,a=n;if(wV(t)||vV(t)||Of(pp("exception").no_empty),HV(s,o.DEFAULT_OPTIONS),_V(s.gradient)||mV(s.gradient)||(s.gradient=[s.gradient]),s.gradient=s.gradient||o.DEFAULT_OPTIONS.gradient,s.gradient.length<2){var l=XV(s.gradient[0]);s.gradient.push(l)}s.blur=_V(s.blur)?o.DEFAULT_OPTIONS.blur:parseFloat(s.blur),s.radius=_V(s.radius)?o.DEFAULT_OPTIONS.radius:parseFloat(s.radius),s.weight=t,a.opacity=Number.isNaN(parseFloat(a.opacity))?1:parseFloat(a.opacity);var u=new kX(t,s,a);return(e=i.call(this,s,u)).attribute_=t,e.options_=s,e.vendorOptions_=a,e}return e=o,n=[{key:"deserialize",value:function(t){var e=nZ(t,3),r=e[0],n=e[1],i=e[2],o=r,s=QV(n),a=QV(i);return new Function(["attribute","options","vendorOptions"],"return new M.style.Heatmap(attribute, options, vendorOptions)")(o,s,a)}}],(r=[{key:"unapply",value:function(t){this.layer_=null,this.getImpl().unapply(t)}},{key:"getAttributeName",value:function(){return this.attribute_}},{key:"setAttributeName",value:function(t){this.attribute_=t,this.options_.weight=this.attribute_,this.update_()}},{key:"getGradient",value:function(){return this.options_.gradient}},{key:"setGradient",value:function(t){var e=t;if(mV(e)||(e=[e]),e.length<2){var r=XV(e[0]);e.push(r)}this.options_.gradient=e,this.update_()}},{key:"getRadius",value:function(){return this.options_.radius}},{key:"setRadius",value:function(t){this.options_.radius=t,this.update_()}},{key:"getBlurSize",value:function(){return this.options_.blur}},{key:"setBlurSize",value:function(t){this.options_.blur=t,this.update_()}},{key:"update_",value:function(){var t=this.getImpl();t.unapply(this.layer_),t.setOptions(this.options_,this.vendorOptions_),t.applyToLayer(this.layer_)}},{key:"drawGeometryToCanvas",value:function(){var t=[this.getImpl().getMinWeight(),this.getImpl().getMaxWeight()],e=t[0],r=t[1],n=this.canvas_.getContext("2d"),i=n.createLinearGradient(0,150,200,150),o=ZV([0,1],this.options_.gradient.length);this.options_.gradient.forEach((function(t,e){return i.addColorStop(o[e],t)})),n.fillStyle=i,n.fillRect(0,20,200,30),n.fillStyle="#000",n.font="10px sans-serif",n.fillText(e,0,60),n.fillText(r,199,60)}},{key:"updateCanvas",value:function(){this.drawGeometryToCanvas()}},{key:"toJSON",value:function(){var t=this.getAttributeName(),e=this.getOptions();return{parameters:[t,{gradient:iZ(e.gradient),blur:e.blur,radius:e.radius,weight:e.weight},this.vendorOptions_],deserializedMethod:"M.style.Heatmap.deserialize"}}}])&&lZ(e.prototype,r),n&&lZ(e,n),o}(Rx);pZ.DEFAULT_OPTIONS={gradient:["#00f","#0ff","#0f0","#ff0","#f00"],blur:15,radius:10};var dZ,gZ,yZ,mZ,_Z,vZ,bZ,wZ,xZ=pZ,EZ=function(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1};function SZ(){}class IZ{constructor(){IZ.constructor_.apply(this,arguments)}setOrdinate(t,e,r){}size(){}getOrdinate(t,e){}getCoordinate(){if(1===arguments.length){}else if(2===arguments.length){}}getCoordinateCopy(t){}getDimension(){}getX(t){}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}getClass(){return IZ}get interfaces_(){return[SZ]}}IZ.constructor_=function(){},IZ.X=0,IZ.Y=1,IZ.Z=2,IZ.M=3;class OZ{constructor(){OZ.constructor_.apply(this,arguments)}create(){if(1===arguments.length){if(arguments[0]instanceof Array){}else if(EZ(arguments[0],IZ)){}}else if(2===arguments.length){}}getClass(){return OZ}get interfaces_(){return[]}}function CZ(t){this.message=t}OZ.constructor_=function(){};class TZ{constructor(){TZ.constructor_.apply(this,arguments)}filter(t){}getClass(){return TZ}get interfaces_(){return[]}}function PZ(){}function RZ(){}TZ.constructor_=function(){};class LZ{constructor(){LZ.constructor_.apply(this,arguments)}static equalsWithTolerance(t,e,r){return Math.abs(t-e)<=r}getClass(){return LZ}get interfaces_(){return[]}}function MZ(t,e){this.low=0|e,this.high=0|t}function kZ(){}function NZ(){}function AZ(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}LZ.constructor_=function(){},MZ.toBinaryString=function(t){for(var e="",r=2147483648;r>0;r>>>=1)e+=(t.high&r)===r?"1":"0";for(r=2147483648;r>0;r>>>=1)e+=(t.low&r)===r?"1":"0";return e},kZ.isNaN=t=>Number.isNaN(t),kZ.isInfinite=t=>!Number.isFinite(t),kZ.MAX_VALUE=Number.MAX_VALUE,"function"==typeof Float64Array&&"function"==typeof Int32Array?(vZ=2146435072,bZ=new Float64Array(1),wZ=new Int32Array(bZ.buffer),kZ.doubleToLongBits=function(t){bZ[0]=t;var e=0|wZ[0],r=0|wZ[1];return(r&vZ)===vZ&&0!=(1048575&r)&&0!==e&&(e=0,r=2146959360),new MZ(r,e)},kZ.longBitsToDouble=function(t){return wZ[0]=t.low,wZ[1]=t.high,bZ[0]}):(dZ=1023,gZ=Math.log2,yZ=Math.floor,mZ=Math.pow,_Z=function(){for(var t=53;t>0;t--){var e=mZ(2,t)-1;if(yZ(gZ(e))+1===t)return e}return 0}(),kZ.doubleToLongBits=function(t){var e,r,n,i,o,s,a,l,u;if(t<0||1/t===Number.NEGATIVE_INFINITY?(s=1<<31,t=-t):s=0,0===t)return new MZ(l=s,u=0);if(t===1/0)return new MZ(l=2146435072|s,u=0);if(t!=t)return new MZ(l=2146959360,u=0);if(i=0,u=0,(e=yZ(t))>1)if(e<=_Z)(i=yZ(gZ(e)))<=20?(u=0,l=e<<20-i&1048575):(u=e%(r=mZ(2,n=i-20))<<32-n,l=e/r&1048575);else for(n=e,u=0;0!==(n=yZ(r=n/2));)i++,u>>>=1,u|=(1&l)<<31,l>>>=1,r!==n&&(l|=524288);if(a=i+dZ,o=0===e,e=t-e,i<52&&0!==e)for(n=0;;){if((r=2*e)>=1?(e=r-1,o?(a--,o=!1):(n<<=1,n|=1,i++)):(e=r,o?0==--a&&(i++,o=!1):(n<<=1,i++)),20===i)l|=n,n=0;else if(52===i){u|=n;break}if(1===r){i<20?l|=n<<20-i:i<52&&(u|=n<<52-i);break}}return l|=a<<20,new MZ(l|=s,u)},kZ.longBitsToDouble=function(t){var e,r,n,i,o=t.high,s=t.low;r=o&1<<31?-1:1,n=((2146435072&o)>>20)-dZ,i=0,e=1<<19;for(var a=1;a<=20;a++)o&e&&(i+=mZ(2,-a)),e>>>=1;for(e=1<<31,a=21;a<=52;a++)s&e&&(i+=mZ(2,-a)),e>>>=1;if(-1023===n){if(0===i)return 0*r;n=-1022}else{if(1024===n)return 0===i?r/0:NaN;i+=1}return r*i*mZ(2,n)}),AZ.prototype=Object.create(Error.prototype),AZ.prototype.constructor=Error;class FZ extends AZ{constructor(){super(),FZ.constructor_.apply(this,arguments)}getClass(){return FZ}get interfaces_(){return[]}}FZ.constructor_=function(){if(0===arguments.length)AZ.constructor_.call(this);else if(1===arguments.length){let t=arguments[0];AZ.constructor_.call(this,t)}};class DZ{constructor(){DZ.constructor_.apply(this,arguments)}static shouldNeverReachHere(){if(0===arguments.length)DZ.shouldNeverReachHere(null);else if(1===arguments.length){let t=arguments[0];throw new FZ("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){let t=arguments[0];DZ.isTrue(t,null)}else if(2===arguments.length){let t=arguments[1];if(!arguments[0])throw null===t?new FZ:new FZ(t)}}static equals(){if(2===arguments.length){let t=arguments[0],e=arguments[1];DZ.equals(t,e,null)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];if(!e.equals(t))throw new FZ("Expected "+t+" but encountered "+e+(null!==r?": "+r:""))}}getClass(){return DZ}get interfaces_(){return[]}}DZ.constructor_=function(){};class jZ{constructor(){jZ.constructor_.apply(this,arguments)}static hashCode(){if(1===arguments.length&&"number"==typeof arguments[0]){let e=arguments[0];var t=kZ.doubleToLongBits(e);return Math.trunc(t^t>>>32)}}setOrdinate(t,e){switch(t){case jZ.X:this.x=e;break;case jZ.Y:this.y=e;break;case jZ.Z:this.z=e;break;default:throw new CZ("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){let t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){let t=arguments[0],e=arguments[1];return!!LZ.equalsWithTolerance(this.x,t.x,e)&&!!LZ.equalsWithTolerance(this.y,t.y,e)}}getOrdinate(t){switch(t){case jZ.X:return this.x;case jZ.Y:return this.y;case jZ.Z:return this.z}throw new CZ("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||kZ.isNaN(this.z)&&kZ.isNaN(t.z))}equals(t){return t instanceof jZ&&this.equals2D(t)}equalInZ(t,e){return LZ.equalsWithTolerance(this.z,t.z,e)}compareTo(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return DZ.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new jZ(this)}toString(){return"("+this.x+", "+this.y+", "+this.z+")"}distance3D(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+r*r+n*n)}distance(t){var e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}hashCode(){var t=17;return t=37*(t=37*t+jZ.hashCode(this.x))+jZ.hashCode(this.y)}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.z}getClass(){return jZ}get interfaces_(){return[PZ,SZ,RZ]}}class GZ{constructor(){GZ.constructor_.apply(this,arguments)}static compare(t,e){return t<e?-1:t>e?1:kZ.isNaN(t)?kZ.isNaN(e)?0:-1:kZ.isNaN(e)?1:0}compare(t,e){var r=t,n=e,i=GZ.compare(r.x,n.x);if(0!==i)return i;var o=GZ.compare(r.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:GZ.compare(r.z,n.z)}getClass(){return GZ}get interfaces_(){return[NZ]}}GZ.constructor_=function(){if(this._dimensionsToTest=2,0===arguments.length)GZ.constructor_.call(this,2);else if(1===arguments.length){let t=arguments[0];if(2!==t&&3!==t)throw new CZ("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}},jZ.DimensionalComparator=GZ,jZ.constructor_=function(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)jZ.constructor_.call(this,0,0);else if(1===arguments.length){let t=arguments[0];jZ.constructor_.call(this,t.x,t.y,t.z)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];jZ.constructor_.call(this,t,e,jZ.NULL_ORDINATE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.x=t,this.y=e,this.z=r}},jZ.serialVersionUID=0x5cbf2c235c7e5800,jZ.NULL_ORDINATE=kZ.NaN,jZ.X=0,jZ.Y=1,jZ.Z=2;class zZ{constructor(){zZ.constructor_.apply(this,arguments)}static intersects(){if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];return r.x>=(t.x<e.x?t.x:e.x)&&r.x<=(t.x>e.x?t.x:e.x)&&r.y>=(t.y<e.y?t.y:e.y)&&r.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){let i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];var t=Math.min(s.x,a.x),e=Math.max(s.x,a.x),r=Math.min(i.x,o.x),n=Math.max(i.x,o.x);return!(r>e)&&(!(n<t)&&(t=Math.min(s.y,a.y),e=Math.max(s.y,a.y),r=Math.min(i.y,o.y),n=Math.max(i.y,o.y),!(r>e)&&!(n<t)))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof zZ))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new zZ;var e=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new zZ(e,n,r,i)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof jZ){let t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof zZ){let t=arguments[0];return!this.isNull()&&!t.isNull()&&(t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return!this.isNull()&&(t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy)}}intersects(){if(1===arguments.length){if(arguments[0]instanceof zZ){let t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof jZ){let t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof jZ&&arguments[1]instanceof jZ){let t=arguments[0],e=arguments[1];return!this.isNull()&&(!((t.x<e.x?t.x:e.x)>this._maxx)&&(!((t.x>e.x?t.x:e.x)<this._minx)&&(!((t.y<e.y?t.y:e.y)>this._maxy)&&!((t.y>e.y?t.y:e.y)<this._miny))))}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof jZ){let t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof zZ){let t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){let t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof zZ){let t=arguments[0];return this.covers(t)}if(arguments[0]instanceof jZ){let t=arguments[0];return this.covers(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new jZ((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof jZ){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof zZ){let t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),r<n?(this._miny=r,this._maxy=n):(this._miny=n,this._maxy=r)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),0===e?r:0===r?e:Math.sqrt(e*e+r*r)}hashCode(){var t=17;return t=37*(t=37*(t=37*(t=37*t+jZ.hashCode(this._minx))+jZ.hashCode(this._maxx))+jZ.hashCode(this._miny))+jZ.hashCode(this._maxy)}getClass(){return zZ}get interfaces_(){return[PZ,RZ]}}zZ.constructor_=function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof jZ){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof zZ){let t=arguments[0];this.init(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.init(t,e,r,n)}},zZ.serialVersionUID=0x51845cd552189800;class UZ{constructor(){UZ.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===UZ.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equals(){if(arguments[0]instanceof UZ){let t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){let e=arguments[0];if(!(e instanceof UZ))return!1;var t=e;return this.equalsExact(t)}}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(UZ.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){if(1===arguments.length){let e=arguments[0];var t=e;return this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){let e=arguments[0],r=arguments[1];t=e;return this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,r)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}checkNotGeometryCollection(t){if(t.getTypeCode()===UZ.TYPECODE_GEOMETRYCOLLECTION)throw new CZ("This method does not support GeometryCollection arguments")}equal(t,e,r){return 0===r?t.equals(e):t.distance(e)<=r}norm(){var t=this.copy();return t.normalize(),t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new zZ(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){for(var r=t.iterator(),n=e.iterator();r.hasNext()&&n.hasNext();){var i=r.next(),o=n.next(),s=i.compareTo(o);if(0!==s)return s}return r.hasNext()?1:n.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isGeometryCollectionOrDerived(){return this.getTypeCode()===UZ.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===UZ.TYPECODE_MULTIPOINT||this.getTypeCode()===UZ.TYPECODE_MULTILINESTRING||this.getTypeCode()===UZ.TYPECODE_MULTIPOLYGON}get interfaces_(){return[SZ,PZ,RZ]}getClass(){return UZ}static hasNonEmptyElements(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}UZ.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},UZ.serialVersionUID=0x799ea46522854c00,UZ.TYPECODE_POINT=0,UZ.TYPECODE_MULTIPOINT=1,UZ.TYPECODE_LINESTRING=2,UZ.TYPECODE_LINEARRING=3,UZ.TYPECODE_MULTILINESTRING=4,UZ.TYPECODE_POLYGON=5,UZ.TYPECODE_MULTIPOLYGON=6,UZ.TYPECODE_GEOMETRYCOLLECTION=7,UZ.TYPENAME_POINT="Point",UZ.TYPENAME_MULTIPOINT="MultiPoint",UZ.TYPENAME_LINESTRING="LineString",UZ.TYPENAME_LINEARRING="LinearRing",UZ.TYPENAME_MULTILINESTRING="MultiLineString",UZ.TYPENAME_POLYGON="Polygon",UZ.TYPENAME_MULTIPOLYGON="MultiPolygon",UZ.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",UZ.geometryChangedFilter={get interfaces_(){return[TZ]},filter(t){t.geometryChangedAction()}};class BZ{constructor(){BZ.constructor_.apply(this,arguments)}filter(t){}getClass(){return BZ}get interfaces_(){return[]}}BZ.constructor_=function(){};class VZ{constructor(){VZ.constructor_.apply(this,arguments)}isInBoundary(t){}getClass(){return VZ}get interfaces_(){return[]}}class qZ{constructor(){qZ.constructor_.apply(this,arguments)}isInBoundary(t){return t%2==1}getClass(){return qZ}get interfaces_(){return[VZ]}}qZ.constructor_=function(){};class YZ{constructor(){YZ.constructor_.apply(this,arguments)}isInBoundary(t){return t>0}getClass(){return YZ}get interfaces_(){return[VZ]}}YZ.constructor_=function(){};class WZ{constructor(){WZ.constructor_.apply(this,arguments)}isInBoundary(t){return t>1}getClass(){return WZ}get interfaces_(){return[VZ]}}WZ.constructor_=function(){};class XZ{constructor(){XZ.constructor_.apply(this,arguments)}isInBoundary(t){return 1===t}getClass(){return XZ}get interfaces_(){return[VZ]}}function HZ(){}function ZZ(){}function KZ(t){this.message=t||""}function $Z(){}function JZ(t){this.message=t||""}function QZ(t){this.message=t||""}function tK(){this.array_=[],arguments[0]instanceof ZZ&&this.addAll(arguments[0])}XZ.constructor_=function(){},VZ.Mod2BoundaryNodeRule=qZ,VZ.EndPointBoundaryNodeRule=YZ,VZ.MultiValentEndPointBoundaryNodeRule=WZ,VZ.MonoValentEndPointBoundaryNodeRule=XZ,VZ.constructor_=function(){},VZ.MOD2_BOUNDARY_RULE=new qZ,VZ.ENDPOINT_BOUNDARY_RULE=new YZ,VZ.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new WZ,VZ.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new XZ,VZ.OGC_SFS_BOUNDARY_RULE=VZ.MOD2_BOUNDARY_RULE,HZ.prototype.hasNext=function(){},HZ.prototype.next=function(){},HZ.prototype.remove=function(){},ZZ.prototype.add=function(){},ZZ.prototype.addAll=function(){},ZZ.prototype.isEmpty=function(){},ZZ.prototype.iterator=function(){},ZZ.prototype.size=function(){},ZZ.prototype.toArray=function(){},ZZ.prototype.remove=function(){},KZ.prototype=new Error,KZ.prototype.name="IndexOutOfBoundsException",$Z.prototype=Object.create(ZZ.prototype),$Z.prototype.constructor=$Z,$Z.prototype.get=function(){},$Z.prototype.set=function(){},$Z.prototype.isEmpty=function(){},JZ.prototype=new Error,JZ.prototype.name="NoSuchElementException",QZ.prototype=new Error,QZ.prototype.name="OperationNotSupported",tK.prototype=Object.create($Z.prototype),tK.prototype.constructor=tK,tK.prototype.ensureCapacity=function(){},tK.prototype.interfaces_=[$Z,ZZ],tK.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],0,arguments[1]),!0},tK.prototype.clear=function(){this.array_=[]},tK.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},tK.prototype.set=function(t,e){var r=this.array_[t];return this.array_[t]=e,r},tK.prototype.iterator=function(){return new eK(this)},tK.prototype.get=function(t){if(t<0||t>=this.size())throw new KZ;return this.array_[t]},tK.prototype.isEmpty=function(){return 0===this.array_.length},tK.prototype.size=function(){return this.array_.length},tK.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},tK.prototype.remove=function(t){for(var e=!1,r=0,n=this.array_.length;r<n;r++)if(this.array_[r]===t){this.array_.splice(r,1),e=!0;break}return e},tK.prototype.removeAll=function(t){for(var e=t.iterator();e.hasNext();)this.remove(e.next());return!0};var eK=function(t){this.arrayList_=t,this.position_=0};eK.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new JZ;return this.arrayList_.get(this.position_++)},eK.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},eK.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},eK.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))};class rK extends tK{constructor(){super(),rK.constructor_.apply(this,arguments)}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&EZ(arguments[0],ZZ)){let r=arguments[1];for(var t=!1,e=arguments[0].iterator();e.hasNext();)this.add(e.next(),r),t=!0;return t}return super.addAll.apply(this,arguments)}clone(){for(var t=super.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){return this.toArray(rK.coordArrayType)}add(){if(1===arguments.length){let t=arguments[0];super.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof jZ&&"boolean"==typeof arguments[1]){let t=arguments[0];if(!arguments[1])if(this.size()>=1)if(this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let e=arguments[0],r=arguments[1];if(arguments[2])for(var t=0;t<e.length;t++)this.add(e[t],r);else for(t=e.length-1;t>=0;t--)this.add(e[t],r);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof jZ){let t=arguments[0],r=arguments[1];if(!arguments[2]){var e=this.size();if(e>0){if(t>0)if(this.get(t-1).equals2D(r))return null;if(t<e)if(this.get(t).equals2D(r))return null}}super.add.call(this,t,r)}}else if(4===arguments.length){let e=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3];var r=1;i>o&&(r=-1);for(t=i;t!==o;t+=r)this.add(e[t],n);return!0}}closeRing(){this.size()>0&&this.add(new jZ(this.get(0)),!1)}getClass(){return rK}get interfaces_(){return[]}}rK.constructor_=function(){if(0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}},rK.coordArrayType=new Array(0).fill(null);class nK{constructor(){nK.constructor_.apply(this,arguments)}static log10(t){var e=Math.log(t);return kZ.isInfinite(e)||kZ.isNaN(e)?e:e/nK.LOG_10}static min(t,e,r,n){var i=t;return e<i&&(i=e),r<i&&(i=r),n<i&&(i=n),i}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){let e=arguments[1],r=arguments[2];return e>(t=arguments[0])&&(t=e),r>t&&(t=r),t}if(4===arguments.length){let e=arguments[1],r=arguments[2],n=arguments[3];var t;return e>(t=arguments[0])&&(t=e),r>t&&(t=r),n>t&&(t=n),t}}static average(t,e){return(t+e)/2}getClass(){return nK}get interfaces_(){return[]}}function iK(){}nK.constructor_=function(){},nK.LOG_10=Math.log(10),iK.arraycopy=(t,e,r,n,i)=>{let o=0;for(let s=e;s<e+i;s++)r[n+o]=t[s],o++},iK.getProperty=t=>({"line.separator":"\n"}[t]);class oK{constructor(){oK.constructor_.apply(this,arguments)}static isRing(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}static ptNotInList(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(oK.indexOf(n,e)<0)return n}return null}static scroll(t,e){var r=oK.indexOf(e,t);if(r<0)return null;var n=new Array(t.length).fill(null);iK.arraycopy(t,r,n,0,t.length-r),iK.arraycopy(t,0,n,t.length-r,r),iK.arraycopy(n,0,t,0,t.length)}static equals(){if(2===arguments.length){let e=arguments[0],r=arguments[1];if(e===r)return!0;if(null===e||null===r)return!1;if(e.length!==r.length)return!1;for(var t=0;t<e.length;t++)if(!e[t].equals(r[t]))return!1;return!0}if(3===arguments.length){let e=arguments[0],r=arguments[1],n=arguments[2];if(e===r)return!0;if(null===e||null===r)return!1;if(e.length!==r.length)return!1;for(t=0;t<e.length;t++)if(0!==n.compare(e[t],r[t]))return!1;return!0}}static intersection(t,e){for(var r=new rK,n=0;n<t.length;n++)e.intersects(t[n])&&r.add(t[n],!0);return r.toCoordinateArray()}static hasRepeatedPoints(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){return oK.hasRepeatedPoints(t)?new rK(t,!1).toCoordinateArray():t}static reverse(t){for(var e=t.length-1,r=Math.trunc(e/2),n=0;n<=r;n++){var i=t[n];t[n]=t[e-n],t[e-n]=i}}static removeNull(t){for(var e=0,r=0;r<t.length;r++)null!==t[r]&&e++;var n=new Array(e).fill(null);if(0===e)return n;var i=0;for(r=0;r<t.length;r++)null!==t[r]&&(n[i++]=t[r]);return n}static copyDeep(){if(1===arguments.length){let r=arguments[0];for(var t=new Array(r.length).fill(null),e=0;e<r.length;e++)t[e]=new jZ(r[e]);return t}if(5===arguments.length){let t=arguments[0],r=arguments[1],n=arguments[2],i=arguments[3],o=arguments[4];for(e=0;e<o;e++)n[i+e]=new jZ(t[r+e])}}static isEqualReversed(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=e[t.length-r-1];if(0!==n.compareTo(i))return!1}return!0}static envelope(t){for(var e=new zZ,r=0;r<t.length;r++)e.expandToInclude(t[r]);return e}static toCoordinateArray(t){return t.toArray(oK.coordArrayType)}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(var r=0;r<e.length;r++)if(t.equals(e[r]))return r;return-1}static increasingDirection(t){for(var e=0;e<Math.trunc(t.length/2);e++){var r=t.length-1-e,n=t[e].compareTo(t[r]);if(0!==n)return n}return 1}static compare(t,e){for(var r=0;r<t.length&&r<e.length;){var n=t[r].compareTo(e[r]);if(0!==n)return n;r++}return r<e.length?-1:r<t.length?1:0}static minCoordinate(t){for(var e=null,r=0;r<t.length;r++)(null===e||e.compareTo(t[r])>0)&&(e=t[r]);return e}static extract(t,e,r){e=nK.clamp(e,0,t.length);var n=(r=nK.clamp(r,-1,t.length))-e+1;r<0&&(n=0),e>=t.length&&(n=0),r<e&&(n=0);var i=new Array(n).fill(null);if(0===n)return i;for(var o=0,s=e;s<=r;s++)i[o++]=t[s];return i}getClass(){return oK}get interfaces_(){return[]}}class sK{constructor(){sK.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e;return oK.compare(r,n)}getClass(){return sK}get interfaces_(){return[NZ]}}sK.constructor_=function(){};class aK{constructor(){aK.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;var i=oK.compare(r,n);return oK.isEqualReversed(r,n)?0:i}OLDcompare(t,e){var r=t,n=e;if(r.length<n.length)return-1;if(r.length>n.length)return 1;if(0===r.length)return 0;for(var i=oK.increasingDirection(r),o=oK.increasingDirection(n),s=i>0?0:r.length-1,a=o>0?0:r.length-1,l=0;l<r.length;l++){var u=r[s].compareTo(n[a]);if(0!==u)return u;s+=i,a+=o}return 0}getClass(){return aK}get interfaces_(){return[NZ]}}function lK(){}function uK(){}function cK(){}function hK(){this.array_=[],arguments[0]instanceof ZZ&&this.addAll(arguments[0])}aK.constructor_=function(){},oK.ForwardComparator=sK,oK.BidirectionalComparator=aK,oK.constructor_=function(){},oK.coordArrayType=new Array(0).fill(null),lK.prototype.get=function(){},lK.prototype.put=function(){},lK.prototype.size=function(){},lK.prototype.values=function(){},lK.prototype.entrySet=function(){},uK.prototype=new lK,cK.prototype=new ZZ,cK.prototype.contains=function(){},hK.prototype=new cK,hK.prototype.contains=function(t){for(var e=0,r=this.array_.length;e<r;e++){if(this.array_[e]===t)return!0}return!1},hK.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},hK.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},hK.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},hK.prototype.size=function(){return this.array_.length},hK.prototype.isEmpty=function(){return 0===this.array_.length},hK.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},hK.prototype.iterator=function(){return new fK(this)};var fK=function(t){this.hashSet_=t,this.position_=0};fK.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new JZ;return this.hashSet_.array_[this.position_++]},fK.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},fK.prototype.remove=function(){throw new QZ};function pK(t){return null==t?0:t.color}function dK(t){return null==t?null:t.parent}function gK(t,e){null!==t&&(t.color=e)}function yK(t){return null==t?null:t.left}function mK(t){return null==t?null:t.right}function _K(){this.root_=null,this.size_=0}_K.prototype=new uK,_K.prototype.get=function(t){for(var e=this.root_;null!==e;){var r=t.compareTo(e.key);if(r<0)e=e.left;else{if(!(r>0))return e.value;e=e.right}}return null},_K.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;var r,n,i=this.root_;do{if(r=i,(n=t.compareTo(i.key))<0)i=i.left;else{if(!(n>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var s={key:t,left:null,right:null,value:e,parent:r,color:0,getValue(){return this.value},getKey(){return this.key}};return n<0?r.left=s:r.right=s,this.fixAfterInsertion(s),this.size_++,null},_K.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;){var e;if(dK(t)==yK(dK(dK(t))))1==pK(e=mK(dK(dK(t))))?(gK(dK(t),0),gK(e,0),gK(dK(dK(t)),1),t=dK(dK(t))):(t==mK(dK(t))&&(t=dK(t),this.rotateLeft(t)),gK(dK(t),0),gK(dK(dK(t)),1),this.rotateRight(dK(dK(t))));else 1==pK(e=yK(dK(dK(t))))?(gK(dK(t),0),gK(e,0),gK(dK(dK(t)),1),t=dK(dK(t))):(t==yK(dK(t))&&(t=dK(t),this.rotateRight(t)),gK(dK(t),0),gK(dK(dK(t)),1),this.rotateLeft(dK(dK(t))))}this.root_.color=0},_K.prototype.values=function(){var t=new tK,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=_K.successor(e));)t.add(e.value);return t},_K.prototype.entrySet=function(){var t=new hK,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=_K.successor(e));)t.add(e);return t},_K.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},_K.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},_K.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},_K.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var r=t;null!==e&&r===e.right;)r=e,e=e.parent;return e},_K.prototype.size=function(){return this.size_},_K.prototype.containsKey=function(t){for(var e=this.root_;null!==e;){var r=t.compareTo(e.key);if(r<0)e=e.left;else{if(!(r>0))return!0;e=e.right}}return!1};class vK{constructor(){vK.constructor_.apply(this,arguments)}getClass(){return vK}get interfaces_(){return[]}}function bK(){}function wK(){this.array_=[],arguments[0]instanceof ZZ&&this.addAll(arguments[0])}vK.constructor_=function(){},bK.prototype=new cK,wK.prototype=new bK,wK.prototype.contains=function(t){for(var e=0,r=this.array_.length;e<r;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},wK.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,r=this.array_.length;e<r;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},wK.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},wK.prototype.remove=function(t){throw new QZ},wK.prototype.size=function(){return this.array_.length},wK.prototype.isEmpty=function(){return 0===this.array_.length},wK.prototype.toArray=function(){for(var t=[],e=0,r=this.array_.length;e<r;e++)t.push(this.array_[e]);return t},wK.prototype.iterator=function(){return new EK(this)};var xK,EK=function(t){this.treeSet_=t,this.position_=0};function SK(){}function IK(){}EK.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new JZ;return this.treeSet_.array_[this.position_++]},EK.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},EK.prototype.remove=function(){throw new QZ},SK.sort=function(){var t,e,r,n,i=arguments[0];if(1===arguments.length)return n=function(t,e){return t.compareTo(e)},void i.sort(n);if(2===arguments.length)r=arguments[1],n=function(t,e){return r.compare(t,e)},i.sort(n);else{if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}if(4===arguments.length){for(e=i.slice(arguments[1],arguments[2]),r=arguments[3],n=function(t,e){return r.compare(t,e)},e.sort(n),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}}},SK.asList=function(t){for(var e=new tK,r=0,n=t.length;r<n;r++)e.add(t[r]);return e},IK.isWhitespace=t=>t<=32&&t>=0||127==t,IK.toUpperCase=t=>t.toUpperCase();class OK{constructor(){OK.constructor_.apply(this,arguments)}static toDimensionSymbol(t){switch(t){case OK.FALSE:return OK.SYM_FALSE;case OK.TRUE:return OK.SYM_TRUE;case OK.DONTCARE:return OK.SYM_DONTCARE;case OK.P:return OK.SYM_P;case OK.L:return OK.SYM_L;case OK.A:return OK.SYM_A}throw new CZ("Unknown dimension value: "+t)}static toDimensionValue(t){switch(IK.toUpperCase(t)){case OK.SYM_FALSE:return OK.FALSE;case OK.SYM_TRUE:return OK.TRUE;case OK.SYM_DONTCARE:return OK.DONTCARE;case OK.SYM_P:return OK.P;case OK.SYM_L:return OK.L;case OK.SYM_A:return OK.A}throw new CZ("Unknown dimension symbol: "+t)}getClass(){return OK}get interfaces_(){return[]}}OK.constructor_=function(){},OK.P=0,OK.L=1,OK.A=2,OK.FALSE=-1,OK.TRUE=-2,OK.DONTCARE=-3,OK.SYM_FALSE="F",OK.SYM_TRUE="T",OK.SYM_DONTCARE="*",OK.SYM_P="0",OK.SYM_L="1",OK.SYM_A="2";class CK{constructor(){CK.constructor_.apply(this,arguments)}filter(t){}getClass(){return CK}get interfaces_(){return[]}}CK.constructor_=function(){};class TK{constructor(){TK.constructor_.apply(this,arguments)}filter(t,e){}isDone(){}isGeometryChanged(){}getClass(){return TK}get interfaces_(){return[]}}TK.constructor_=function(){};class PK extends UZ{constructor(){super(),PK.constructor_.apply(this,arguments)}computeEnvelopeInternal(){for(var t=new zZ,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,r=0;r<this._geometries.length;r++)for(var n=this._geometries[r].getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];return t}getArea(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let r=arguments[0],n=arguments[1];if(!this.isEquivalentClass(r))return!1;var t=r;if(this._geometries.length!==t._geometries.length)return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].equalsExact(t._geometries[e],n))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();SK.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){for(var t=OK.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}getTypeCode(){return UZ.TYPECODE_GEOMETRYCOLLECTION}getDimension(){for(var t=OK.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[r]=this._geometries[r].reverse();return this.getFactory().createGeometryCollection(e)}compareToSameClass(){if(1===arguments.length){let r=arguments[0];var t=new wK(SK.asList(this._geometries)),e=new wK(SK.asList(r._geometries));return this.compare(t,e)}if(2===arguments.length){let t=arguments[1];for(var r=arguments[0],n=this.getNumGeometries(),i=r.getNumGeometries(),o=0;o<n&&o<i;){var s=this.getGeometryN(o),a=r.getGeometryN(o),l=s.compareToSameClass(a,t);if(0!==l)return l;o++}return o<n?1:o<i?-1:0}}apply(){if(EZ(arguments[0],BZ)){let e=arguments[0];for(var t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(EZ(arguments[0],TK)){let e=arguments[0];if(0===this._geometries.length)return null;for(t=0;t<this._geometries.length&&(this._geometries[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(EZ(arguments[0],CK)){let e=arguments[0];e.filter(this);for(t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(EZ(arguments[0],TZ)){let e=arguments[0];e.filter(this);for(t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}}getBoundary(){return this.checkNotGeometryCollection(this),DZ.shouldNeverReachHere(),null}getGeometryType(){return UZ.TYPENAME_GEOMETRYCOLLECTION}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new PK(t,this._factory)}isEmpty(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}getClass(){return PK}get interfaces_(){return[]}}PK.constructor_=function(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(UZ.constructor_.call(this,e),null===t&&(t=[]),UZ.hasNullElements(t))throw new CZ("geometries must not contain null elements");this._geometries=t}},PK.serialVersionUID=-0x4f07bcb1f857d800;class RK extends PK{constructor(){super(),RK.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?OK.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return UZ.TYPECODE_MULTILINESTRING}getDimension(){return 1}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[t-1-r]=this._geometries[r].reverse();return this.getFactory().createMultiLineString(e)}getBoundary(){return new LK(this).getBoundary()}getGeometryType(){return UZ.TYPENAME_MULTILINESTRING}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new RK(t,this._factory)}getClass(){return RK}get interfaces_(){return[vK]}}RK.constructor_=function(){let t=arguments[0],e=arguments[1];PK.constructor_.call(this,t,e)},RK.serialVersionUID=0x7155d2ab4afa8000;class LK{constructor(){LK.constructor_.apply(this,arguments)}static getBoundary(){if(1===arguments.length){return new LK(arguments[0]).getBoundary()}if(2===arguments.length){return new LK(arguments[0],arguments[1]).getBoundary()}}boundaryMultiLineString(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)}getBoundary(){return this._geom instanceof BK?this.boundaryLineString(this._geom):this._geom instanceof RK?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(t){var e=new tK;this._endpointMap=new _K;for(var r=0;r<t.getNumGeometries();r++){var n=t.getGeometryN(r);0!==n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return oK.toCoordinateArray(e)}addEndpoint(t){var e=this._endpointMap.get(t);null===e&&(e=new MK,this._endpointMap.put(t,e)),e.count++}getClass(){return LK}get interfaces_(){return[]}}LK.constructor_=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){let t=arguments[0];LK.constructor_.call(this,t,VZ.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}};class MK{constructor(){MK.constructor_.apply(this,arguments)}getClass(){return MK}get interfaces_(){return[]}}MK.constructor_=function(){this.count=null};class kK{constructor(){kK.constructor_.apply(this,arguments)}static ofLine(t){var e=t.size();if(e<=1)return 0;var r=0,n=new jZ;t.getCoordinate(0,n);for(var i=n.x,o=n.y,s=1;s<e;s++){t.getCoordinate(s,n);var a=n.x,l=n.y,u=a-i,c=l-o;r+=Math.sqrt(u*u+c*c),i=a,o=l}return r}getClass(){return kK}get interfaces_(){return[]}}function NK(){}function AK(){}function FK(){}function DK(){}function jK(){}kK.constructor_=function(){};class GK{constructor(){GK.constructor_.apply(this,arguments)}static chars(t,e){for(var r=new Array(e).fill(null),n=0;n<e;n++)r[n]=t;return new String(r)}static getStackTrace(){if(1===arguments.length){let r=arguments[0];var t=new FK,e=new NK(t);return r.printStackTrace(e),t.toString()}if(2===arguments.length){let t=arguments[0],e=arguments[1];for(var r="",n=new jK(new AK(GK.getStackTrace(t))),i=0;i<e;i++)try{r+=n.readLine()+GK.NEWLINE}catch(t){if(!(t instanceof DK))throw t;DZ.shouldNeverReachHere()}return r}}static split(t,e){for(var r=e.length,n=new tK,i=""+t,o=i.indexOf(e);o>=0;){var s=i.substring(0,o);n.add(s),o=(i=i.substring(o+r)).indexOf(e)}i.length>0&&n.add(i);for(var a=new Array(n.size()).fill(null),l=0;l<a.length;l++)a[l]=n.get(l);return a}static toString(){if(1===arguments.length&&"number"==typeof arguments[0]){let t=arguments[0];return GK.SIMPLE_ORDINATE_FORMAT.format(t)}}static spaces(t){return GK.chars(" ",t)}getClass(){return GK}get interfaces_(){return[]}}function zK(t){this.str=t}GK.constructor_=function(){},GK.NEWLINE=iK.getProperty("line.separator"),GK.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),zK.prototype.append=function(t){this.str+=t},zK.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},zK.prototype.toString=function(t){return this.str};class UK{constructor(){UK.constructor_.apply(this,arguments)}static copyCoord(t,e,r,n){for(var i=Math.min(t.getDimension(),r.getDimension()),o=0;o<i;o++)r.setOrdinate(n,o,t.getOrdinate(e,o))}static isRing(t){var e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,IZ.X)===t.getOrdinate(e-1,IZ.X)&&t.getOrdinate(0,IZ.Y)===t.getOrdinate(e-1,IZ.Y))}static isEqual(t,e){var r=t.size();if(r!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),i=0;i<r;i++)for(var o=0;o<n;o++){var s=t.getOrdinate(i,o),a=e.getOrdinate(i,o);if(t.getOrdinate(i,o)!==e.getOrdinate(i,o)&&(!kZ.isNaN(s)||!kZ.isNaN(a)))return!1}return!0}static extend(t,e,r){var n=t.create(r,e.getDimension()),i=e.size();if(UK.copy(e,0,n,0,i),i>0)for(var o=i;o<r;o++)UK.copy(e,i-1,n,o,1);return n}static reverse(t){for(var e=t.size()-1,r=Math.trunc(e/2),n=0;n<=r;n++)UK.swap(t,n,e-n)}static swap(t,e,r){if(e===r)return null;for(var n=0;n<t.getDimension();n++){var i=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(r,n)),t.setOrdinate(r,n,i)}}static copy(t,e,r,n,i){for(var o=0;o<i;o++)UK.copyCoord(t,e+o,r,n+o)}static toString(){if(1===arguments.length&&EZ(arguments[0],IZ)){let o=arguments[0];var t=o.size();if(0===t)return"()";var e=o.getDimension(),r=new zK;r.append("(");for(var n=0;n<t;n++){n>0&&r.append(" ");for(var i=0;i<e;i++)i>0&&r.append(","),r.append(GK.toString(o.getOrdinate(n,i)))}return r.append(")"),r.toString()}}static ensureValidRing(t,e){var r=e.size();return 0===r?e:r<=3?UK.createClosedRing(t,e,4):e.getOrdinate(0,IZ.X)===e.getOrdinate(r-1,IZ.X)&&e.getOrdinate(0,IZ.Y)===e.getOrdinate(r-1,IZ.Y)?e:UK.createClosedRing(t,e,r+1)}static createClosedRing(t,e,r){var n=t.create(r,e.getDimension()),i=e.size();UK.copy(e,0,n,0,i);for(var o=i;o<r;o++)UK.copy(e,0,n,o,1);return n}getClass(){return UK}get interfaces_(){return[]}}UK.constructor_=function(){};class BK extends UZ{constructor(){super(),BK.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this.isEmpty()?new zZ:this._points.expandEnvelope(new zZ)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let r=arguments[0],n=arguments[1];if(!this.isEquivalentClass(r))return!1;var t=r;if(this._points.size()!==t._points.size())return!1;for(var e=0;e<this._points.size();e++)if(!this.equal(this._points.getCoordinate(e),t._points.getCoordinate(e),n))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){var r=this._points.copy();UK.reverse(r),this._points=r}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?OK.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return UZ.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return kK.ofLine(this._points)}getNumPoints(){return this._points.size()}reverse(){var t=this._points.copy();return UK.reverse(t),this.getFactory().createLineString(t)}compareToSameClass(){if(1===arguments.length){for(var t=arguments[0],e=0,r=0;e<this._points.size()&&r<t._points.size();){var n=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(r));if(0!==n)return n;e++,r++}return e<this._points.size()?1:r<t._points.size()?-1:0}if(2===arguments.length){t=arguments[0];return arguments[1].compare(this._points,t._points)}}apply(){if(EZ(arguments[0],BZ)){let e=arguments[0];for(var t=0;t<this._points.size();t++)e.filter(this._points.getCoordinate(t))}else if(EZ(arguments[0],TK)){let e=arguments[0];if(0===this._points.size())return null;for(t=0;t<this._points.size()&&(e.filter(this._points,t),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(EZ(arguments[0],CK)){arguments[0].filter(this)}else if(EZ(arguments[0],TZ)){arguments[0].filter(this)}}getBoundary(){return new LK(this).getBoundary()}isEquivalentClass(t){return t instanceof BK}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return UZ.TYPENAME_LINESTRING}copy(){return new BK(this._points.copy(),this._factory)}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new CZ("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}getClass(){return BK}get interfaces_(){return[vK]}}BK.constructor_=function(){if(this._points=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];UZ.constructor_.call(this,e),this.init(t)}},BK.serialVersionUID=0x2b2b51ba435c8e00;class VK{constructor(){VK.constructor_.apply(this,arguments)}getClass(){return VK}get interfaces_(){return[]}}VK.constructor_=function(){};class qK extends UZ{constructor(){super(),qK.constructor_.apply(this,arguments)}computeEnvelopeInternal(){if(this.isEmpty())return new zZ;var t=new zZ;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return OK.FALSE}getTypeCode(){return UZ.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}reverse(){return this.copy()}getX(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}apply(){if(EZ(arguments[0],BZ)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(EZ(arguments[0],TK)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else if(EZ(arguments[0],CK)){arguments[0].filter(this)}else if(EZ(arguments[0],TZ)){arguments[0].filter(this)}}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return UZ.TYPENAME_POINT}copy(){return new qK(this._coordinates.copy(),this._factory)}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),DZ.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}getClass(){return qK}get interfaces_(){return[VK]}}qK.constructor_=function(){this._coordinates=null;let t=arguments[0],e=arguments[1];UZ.constructor_.call(this,e),this.init(t)},qK.serialVersionUID=0x44077bad161cbc00;class YK{constructor(){YK.constructor_.apply(this,arguments)}static ofRing(){if(arguments[0]instanceof Array){let t=arguments[0];return Math.abs(YK.ofRingSigned(t))}if(EZ(arguments[0],IZ)){let t=arguments[0];return Math.abs(YK.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){let o=arguments[0];if(o.length<3)return 0;for(var t=0,e=o[0].x,r=1;r<o.length-1;r++){var n=o[r].x-e,i=o[r+1].y;t+=n*(o[r-1].y-i)}return t/2}if(EZ(arguments[0],IZ)){let n=arguments[0];var o=n.size();if(o<3)return 0;var s=new jZ,a=new jZ,l=new jZ;n.getCoordinate(0,a),n.getCoordinate(1,l);e=a.x;l.x-=e;for(t=0,r=1;r<o-1;r++)s.y=a.y,a.x=l.x,a.y=l.y,n.getCoordinate(r+1,l),l.x-=e,t+=a.x*(s.y-l.y);return t/2}}getClass(){return YK}get interfaces_(){return[]}}function WK(t){this.str=t}function XK(t){this.value=t}YK.constructor_=function(){},WK.prototype.append=function(t){this.str+=t},WK.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},WK.prototype.toString=function(t){return this.str},XK.prototype.intValue=function(){return this.value},XK.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},XK.isNaN=t=>Number.isNaN(t);class HK{constructor(){HK.constructor_.apply(this,arguments)}static sqr(t){return HK.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){let t=arguments[0];return HK.parse(t)}if("number"==typeof arguments[0]){return new HK(arguments[0])}}static sqrt(t){return HK.valueOf(t).sqrt()}static parse(t){for(var e=0,r=t.length;IK.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<r){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(n=!0))}for(var o=new HK,s=0,a=0,l=0;!(e>=r);){var u=t.charAt(e);if(e++,IK.isDigit(u)){var c=u-"0";o.selfMultiply(HK.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=XK.parseInt(h)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+h+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var f=o,p=s-a-l;if(0===p)f=o;else if(p>0){var d=HK.TEN.pow(p);f=o.divide(d)}else if(p<0){d=HK.TEN.pow(-p);f=o.multiply(d)}return n?f.negate():f}static createNaN(){return new HK(kZ.NaN,kZ.NaN)}static copy(t){return new HK(t)}static magnitude(t){var e=Math.abs(t),r=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(r));return 10*Math.pow(10,n)<=e&&(n+=1),n}static stringOfChar(t,e){for(var r=new WK,n=0;n<e;n++)r.append(t);return r.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){var r=this.abs(),n=HK.magnitude(r._hi),i=HK.TEN.pow(n);(r=r.divide(i)).gt(HK.TEN)?(r=r.divide(HK.TEN),n+=1):r.lt(HK.ONE)&&(r=r.multiply(HK.TEN),n-=1);for(var o=n+1,s=new WK,a=HK.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(r._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),r=r.subtract(HK.valueOf(u)).multiply(HK.TEN),c&&r.selfAdd(HK.TEN);var f=!0,p=HK.magnitude(r._hi);if(p<0&&Math.abs(p)>=a-l&&(f=!1),!f)break}return e[0]=n,s.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof HK){let t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){let t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof HK){let t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof HK){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof HK){let t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){let l=arguments[0],u=arguments[1];var t,e,r,n,i=null,o=null,s=null,a=null;return r=this._hi/l,a=(i=(s=HK.SPLIT*r)-(i=s-r))*(o=(a=HK.SPLIT*l)-(o=a-l))-(n=r*l)+i*(e=l-o)+(t=r-i)*o+t*e,a=r+(s=(this._hi-n-a+this._lo-r*u)/l),this._hi=a,this._lo=r-a+s,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof HK){let l=arguments[0];var t,e,r,n,i=null,o=null,s=null,a=null;return t=(r=this._hi/l._hi)-(i=(s=HK.SPLIT*r)-(i=s-r)),a=i*(o=(a=HK.SPLIT*l._hi)-(o=a-l._hi))-(n=r*l._hi)+i*(e=l._hi-o)+t*o+t*e,s=(this._hi-n-a+this._lo-r*l._lo)/l._hi,new HK(a=r+s,r-a+s)}if("number"==typeof arguments[0]){let t=arguments[0];return kZ.isNaN(t)?HK.createNaN():HK.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return HK.valueOf(1);var e=new HK(this),r=HK.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&r.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else r=e;return t<0?r.reciprocal():r}ceil(){if(this.isNaN())return HK.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new HK(t,e)}compareTo(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof HK){let t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){let t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return HK.valueOf(0);if(this.isNegative())return HK.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,r=HK.valueOf(e),n=this.subtract(r.sqr())._hi*(.5*t);return r.add(n)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof HK){let t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){let s=arguments[0];var t=null,e=null,r=null,n=null,i=null,o=null;return n=(r=this._hi+s)-(i=r-this._hi),e=(o=(n=s-i+(this._hi-n))+this._lo)+(r-(t=r+o)),this._hi=t+e,this._lo=e+(t-this._hi),this}}else if(2===arguments.length){let c=arguments[0],h=arguments[1];t=null,e=null;var s,a=null;r=null,n=null,i=null,o=null;r=this._hi+c,s=this._lo+h,n=r-(i=r-this._hi),a=s-(o=s-this._lo);var l=(t=r+(i=(n=c-i+(this._hi-n))+s))+(i=(a=h-o+(this._lo-a))+(e=i+(r-t))),u=i+(t-l);return this._hi=l,this._lo=u,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof HK){let t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){let l=arguments[0],u=arguments[1];var t,e,r=null,n=null,i=null,o=null;r=(i=HK.SPLIT*this._hi)-this._hi,o=HK.SPLIT*l,r=i-r,t=this._hi-r,n=o-l;var s=(i=this._hi*l)+(o=r*(n=o-n)-i+r*(e=l-n)+t*n+t*e+(this._hi*u+this._lo*l)),a=o+(r=i-s);return this._hi=s,this._lo=a,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return HK.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new HK(t,e)}negate(){return this.isNaN()?this:new HK(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof HK){let t=arguments[0];return t.isNaN()?HK.createNaN():HK.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){let t=arguments[0];return kZ.isNaN(t)?HK.createNaN():HK.copy(this).selfMultiply(t,0)}}isNaN(){return kZ.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){var t=HK.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!0,e),n=e[0]+1,i=r;if("."===r.charAt(0))i="0"+r;else if(n<0)i="0."+HK.stringOfChar("0",-n)+r;else if(-1===r.indexOf(".")){var o=n-r.length;i=r+HK.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i}reciprocal(){var t,e,r,n,i=null,o=null,s=null,a=null;t=(r=1/this._hi)-(i=(s=HK.SPLIT*r)-(i=s-r)),o=(a=HK.SPLIT*this._hi)-this._hi;var l=r+(s=(1-(n=r*this._hi)-(a=i*(o=a-o)-n+i*(e=this._hi-o)+t*o+t*e)-r*this._lo)/this._hi);return new HK(l,r-l+s)}toSciNotation(){if(this.isZero())return HK.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!1,e),n=HK.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===r.charAt(0))throw new IllegalStateException("Found leading zero: "+r);var i="";r.length>1&&(i=r.substring(1));var o=r.charAt(0)+"."+i;return this.isNegative()?"-"+o+n:o+n}abs(){return this.isNaN()?HK.NaN:this.isNegative()?this.negate():new HK(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof HK){let t=arguments[0];return HK.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){let t=arguments[0];return HK.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof HK){let t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?HK.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}getClass(){return HK}get interfaces_(){return[RZ,PZ,SZ]}}HK.constructor_=function(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this.init(t)}else if(arguments[0]instanceof HK){let t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){let t=arguments[0];HK.constructor_.call(this,HK.parse(t))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t,e)}},HK.PI=new HK(3.141592653589793,12246467991473532e-32),HK.TWO_PI=new HK(6.283185307179586,24492935982947064e-32),HK.PI_2=new HK(1.5707963267948966,6123233995736766e-32),HK.E=new HK(2.718281828459045,14456468917292502e-32),HK.NaN=new HK(kZ.NaN,kZ.NaN),HK.EPS=123259516440783e-46,HK.SPLIT=134217729,HK.MAX_PRINT_DIGITS=32,HK.TEN=HK.valueOf(10),HK.ONE=HK.valueOf(1),HK.SCI_NOT_EXPONENT_CHAR="E",HK.SCI_NOT_ZERO="0.0E0";class ZK{constructor(){ZK.constructor_.apply(this,arguments)}static orientationIndex(t,e,r){var n=ZK.orientationIndexFilter(t,e,r);if(n<=1)return n;var i=HK.valueOf(e.x).selfAdd(-t.x),o=HK.valueOf(e.y).selfAdd(-t.y),s=HK.valueOf(r.x).selfAdd(-e.x),a=HK.valueOf(r.y).selfAdd(-e.y);return i.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()}static signOfDet2x2(){if(arguments[0]instanceof HK){let t=arguments[1],e=arguments[2],r=arguments[3];return arguments[0].multiply(r).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[0]){let i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];var t=HK.valueOf(i),e=HK.valueOf(o),r=HK.valueOf(s),n=HK.valueOf(a);return t.multiply(n).selfSubtract(e.multiply(r)).signum()}}static intersection(t,e,r,n){var i=HK.valueOf(n.y).selfSubtract(r.y).selfMultiply(HK.valueOf(e.x).selfSubtract(t.x)),o=HK.valueOf(n.x).selfSubtract(r.x).selfMultiply(HK.valueOf(e.y).selfSubtract(t.y)),s=i.subtract(o),a=HK.valueOf(n.x).selfSubtract(r.x).selfMultiply(HK.valueOf(t.y).selfSubtract(r.y)),l=HK.valueOf(n.y).selfSubtract(r.y).selfMultiply(HK.valueOf(t.x).selfSubtract(r.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=HK.valueOf(t.x).selfAdd(HK.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=HK.valueOf(e.x).selfSubtract(t.x).selfMultiply(HK.valueOf(t.y).selfSubtract(r.y)),f=HK.valueOf(e.y).selfSubtract(t.y).selfMultiply(HK.valueOf(t.x).selfSubtract(r.x)),p=h.subtract(f).selfDivide(s).doubleValue(),d=HK.valueOf(r.y).selfAdd(HK.valueOf(n.y).selfSubtract(r.y).selfMultiply(p)).doubleValue();return new jZ(c,d)}static orientationIndexFilter(t,e,r){var n=null,i=(t.x-r.x)*(e.y-r.y),o=(t.y-r.y)*(e.x-r.x),s=i-o;if(i>0){if(o<=0)return ZK.signum(s);n=i+o}else{if(!(i<0))return ZK.signum(s);if(o>=0)return ZK.signum(s);n=-i-o}var a=ZK.DP_SAFE_EPSILON*n;return s>=a||-s>=a?ZK.signum(s):2}static signum(t){return t>0?1:t<0?-1:0}getClass(){return ZK}get interfaces_(){return[]}}ZK.constructor_=function(){},ZK.DP_SAFE_EPSILON=1e-15;class KK{constructor(){KK.constructor_.apply(this,arguments)}static index(t,e,r){return ZK.orientationIndex(t,e,r)}static isCCW(t){var e=t.length-1;if(e<3)throw new CZ("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],n=0,i=1;i<=e;i++){var o=t[i];o.y>r.y&&(r=o,n=i)}var s=n;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(r)&&s!==n);var a=n;do{a=(a+1)%e}while(t[a].equals2D(r)&&a!==n);var l=t[s],u=t[a];if(l.equals2D(r)||u.equals2D(r)||l.equals2D(u))return!1;var c=KK.index(l,r,u);return 0===c?l.x>u.x:c>0}getClass(){return KK}get interfaces_(){return[]}}KK.constructor_=function(){},KK.CLOCKWISE=-1,KK.RIGHT=KK.CLOCKWISE,KK.COUNTERCLOCKWISE=1,KK.LEFT=KK.COUNTERCLOCKWISE,KK.COLLINEAR=0,KK.STRAIGHT=KK.COLLINEAR;class $K{constructor(){$K.constructor_.apply(this,arguments)}getClass(){return $K}get interfaces_(){return[]}}$K.constructor_=function(){};class JK extends UZ{constructor(){super(),JK.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,r=this._shell.getCoordinates(),n=0;n<r.length;n++)t[++e]=r[n];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t}getArea(){var t=0;t+=YK.ofRing(this._shell.getCoordinateSequence());for(var e=0;e<this._holes.length;e++)t-=YK.ofRing(this._holes[e].getCoordinateSequence());return t}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),r=0;r<5;r++){if((o=t.getX(r))!==e.getMinX()&&o!==e.getMaxX())return!1;if((s=t.getY(r))!==e.getMinY()&&s!==e.getMaxY())return!1}var n=t.getX(0),i=t.getY(0);for(r=1;r<=4;r++){var o,s;if((o=t.getX(r))!==n===((s=t.getY(r))!==i))return!1;n=o,i=s}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let i=arguments[0],o=arguments[1];if(!this.isEquivalentClass(i))return!1;var t=i,e=this._shell,r=t._shell;if(!e.equalsExact(r,o))return!1;if(this._holes.length!==t._holes.length)return!1;for(var n=0;n<this._holes.length;n++)if(!this._holes[n].equalsExact(t._holes[n],o))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);SK.sort(this._holes)}else if(2===arguments.length){let t=arguments[0],n=arguments[1];if(t.isEmpty())return null;var e=new Array(t.getCoordinates().length-1).fill(null);iK.arraycopy(t.getCoordinates(),0,e,0,e.length);var r=oK.minCoordinate(t.getCoordinates());oK.scroll(e,r),iK.arraycopy(e,0,t.getCoordinates(),0,e.length),t.getCoordinates()[e.length]=e[0],KK.isCCW(t.getCoordinates())===n&&oK.reverse(t.getCoordinates())}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getTypeCode(){return UZ.TYPECODE_POLYGON}getDimension(){return 2}getLength(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}reverse(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t}convexHull(){return this.getExteriorRing().convexHull()}compareToSameClass(){if(1===arguments.length){let r=arguments[0];var t=this._shell,e=r._shell;return t.compareToSameClass(e)}if(2===arguments.length){let c=arguments[1];var r=arguments[0],n=(t=this._shell,e=r._shell,t.compareToSameClass(e,c));if(0!==n)return n;for(var i=this.getNumInteriorRing(),o=r.getNumInteriorRing(),s=0;s<i&&s<o;){var a=this.getInteriorRingN(s),l=r.getInteriorRingN(s),u=a.compareToSameClass(l,c);if(0!==u)return u;s++}return s<i?1:s<o?-1:0}}apply(){if(EZ(arguments[0],BZ)){let e=arguments[0];this._shell.apply(e);for(var t=0;t<this._holes.length;t++)this._holes[t].apply(e)}else if(EZ(arguments[0],TK)){let e=arguments[0];if(this._shell.apply(e),!e.isDone())for(t=0;t<this._holes.length&&(this._holes[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(EZ(arguments[0],CK)){arguments[0].filter(this)}else if(EZ(arguments[0],TZ)){let e=arguments[0];e.filter(this),this._shell.apply(e);for(t=0;t<this._holes.length;t++)this._holes[t].apply(e)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return UZ.TYPENAME_POLYGON}copy(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),r=0;r<this._holes.length;r++)e[r]=this._holes[r].copy();return new JK(t,e,this._factory)}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}getClass(){return JK}get interfaces_(){return[$K]}}JK.constructor_=function(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],r=arguments[2];if(UZ.constructor_.call(this,r),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),UZ.hasNullElements(e))throw new CZ("holes must not contain null elements");if(t.isEmpty()&&UZ.hasNonEmptyElements(e))throw new CZ("shell is empty but holes are not");this._shell=t,this._holes=e},JK.serialVersionUID=-0x307ffefd8dc97200;class QK extends PK{constructor(){super(),QK.constructor_.apply(this,arguments)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){let t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return OK.FALSE}getTypeCode(){return UZ.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return UZ.TYPENAME_MULTIPOINT}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new QK(t,this._factory)}getClass(){return QK}get interfaces_(){return[VK]}}QK.constructor_=function(){let t=arguments[0],e=arguments[1];PK.constructor_.call(this,t,e)},QK.serialVersionUID=-0x6fb1ed4162e0fc00;class t$ extends BK{constructor(){super(),t$.constructor_.apply(this,arguments)}getBoundaryDimension(){return OK.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}getTypeCode(){return UZ.TYPECODE_LINEARRING}reverse(){var t=this._points.copy();return UK.reverse(t),this.getFactory().createLinearRing(t)}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new CZ("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t$.MINIMUM_VALID_SIZE)throw new CZ("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return UZ.TYPENAME_LINEARRING}copy(){return new t$(this._points.copy(),this._factory)}getClass(){return t$}get interfaces_(){return[]}}t$.constructor_=function(){if(arguments[0]instanceof Array&&arguments[1]instanceof v$){let t=arguments[0],e=arguments[1];t$.constructor_.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(EZ(arguments[0],IZ)&&arguments[1]instanceof v$){let t=arguments[0],e=arguments[1];BK.constructor_.call(this,t,e),this.validateConstruction()}},t$.MINIMUM_VALID_SIZE=4,t$.serialVersionUID=-0x3b229e262367a600;class e$ extends PK{constructor(){super(),e$.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof UZ){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return UZ.TYPECODE_MULTIPOLYGON}getDimension(){return 2}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),r=0;r<this._geometries.length;r++)e[r]=this._geometries[r].reverse();return this.getFactory().createMultiPolygon(e)}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new tK,e=0;e<this._geometries.length;e++)for(var r=this._geometries[e].getBoundary(),n=0;n<r.getNumGeometries();n++)t.add(r.getGeometryN(n));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))}getGeometryType(){return UZ.TYPENAME_MULTIPOLYGON}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new e$(t,this._factory)}getClass(){return e$}get interfaces_(){return[$K]}}e$.constructor_=function(){let t=arguments[0],e=arguments[1];PK.constructor_.call(this,t,e)},e$.serialVersionUID=-0x7a5aa1369171980;class r${constructor(){r$.constructor_.apply(this,arguments)}setCopyUserData(t){this._isUserDataCopied=t}edit(t,e){if(null===t)return null;var r=this.editInternal(t,e);return this._isUserDataCopied&&r.setUserData(t.getUserData()),r}editInternal(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof PK?this.editGeometryCollection(t,e):t instanceof JK?this.editPolygon(t,e):t instanceof qK||t instanceof BK?e.edit(t,this._factory):(DZ.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)}editGeometryCollection(t,e){for(var r=e.edit(t,this._factory),n=new tK,i=0;i<r.getNumGeometries();i++){var o=this.edit(r.getGeometryN(i),e);null===o||o.isEmpty()||n.add(o)}return r.getClass()===QK?this._factory.createMultiPoint(n.toArray([])):r.getClass()===RK?this._factory.createMultiLineString(n.toArray([])):r.getClass()===e$?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))}editPolygon(t,e){var r=e.edit(t,this._factory);if(null===r&&(r=this._factory.createPolygon()),r.isEmpty())return r;var n=this.edit(r.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var i=new tK,o=0;o<r.getNumInteriorRing();o++){var s=this.edit(r.getInteriorRingN(o),e);null===s||s.isEmpty()||i.add(s)}return this._factory.createPolygon(n,i.toArray([]))}getClass(){return r$}get interfaces_(){return[]}}function n$(){}r$.GeometryEditorOperation=n$;class i${constructor(){i$.constructor_.apply(this,arguments)}edit(t,e){return t}getClass(){return i$}get interfaces_(){return[n$]}}i$.constructor_=function(){};class o${constructor(){o$.constructor_.apply(this,arguments)}edit(t,e){var r=this.edit(t.getCoordinates(),t);return t instanceof t$?null===r?e.createLinearRing():e.createLinearRing(r):t instanceof BK?null===r?e.createLineString():e.createLineString(r):t instanceof qK?null===r||0===r.length?e.createPoint():e.createPoint(r[0]):t}getClass(){return o$}get interfaces_(){return[n$]}}o$.constructor_=function(){};class s${constructor(){s$.constructor_.apply(this,arguments)}edit(t,e){return t instanceof t$?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof BK?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof qK?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t}getClass(){return s$}get interfaces_(){return[n$]}}s$.constructor_=function(){},r$.NoOpGeometryOperation=i$,r$.CoordinateOperation=o$,r$.CoordinateSequenceOperation=s$,r$.constructor_=function(){if(this._factory=null,this._isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._factory=t}};class a${constructor(){a$.constructor_.apply(this,arguments)}setOrdinate(t,e,r){switch(e){case IZ.X:this._coordinates[t].x=r;break;case IZ.Y:this._coordinates[t].y=r;break;case IZ.Z:this._coordinates[t].z=r;break;default:throw new CZ("invalid ordinateIndex")}}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case IZ.X:return this._coordinates[t].x;case IZ.Y:return this._coordinates[t].y;case IZ.Z:return this._coordinates[t].z}return kZ.NaN}getCoordinate(){if(1===arguments.length){let t=arguments[0];return this._coordinates[t]}if(2===arguments.length){let t=arguments[0],e=arguments[1];e.x=this._coordinates[t].x,e.y=this._coordinates[t].y,e.z=this._coordinates[t].z}}getCoordinateCopy(t){return new jZ(this._coordinates[t])}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}expandEnvelope(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new a$(t,this._dimension)}toString(){if(this._coordinates.length>0){var t=new zK(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}getClass(){return a$}get interfaces_(){return[IZ,RZ]}}a$.constructor_=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];a$.constructor_.call(this,t,3)}else if(Number.isInteger(arguments[0])){let e=arguments[0];this._coordinates=new Array(e).fill(null);for(var t=0;t<e;t++)this._coordinates[t]=new jZ}else if(EZ(arguments[0],IZ)){let e=arguments[0];if(null===e)return this._coordinates=new Array(0).fill(null),null;this._dimension=e.getDimension(),this._coordinates=new Array(e.size()).fill(null);for(t=0;t<this._coordinates.length;t++)this._coordinates[t]=e.getCoordinateCopy(t)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1];this._coordinates=t,this._dimension=e,null===t&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let e=arguments[0],r=arguments[1];this._coordinates=new Array(e).fill(null),this._dimension=r;for(t=0;t<e;t++)this._coordinates[t]=new jZ}},a$.serialVersionUID=-0xcb44a778db18e00;class l${constructor(){l$.constructor_.apply(this,arguments)}static instance(){return l$.instanceObject}readResolve(){return l$.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array){return new a$(arguments[0])}if(EZ(arguments[0],IZ)){return new a$(arguments[0])}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new a$(t):new a$(t,e)}}getClass(){return l$}get interfaces_(){return[OZ,RZ]}}l$.constructor_=function(){},l$.serialVersionUID=-0x38e49fa6cf6f2e00,l$.instanceObject=new l$;var u$=Object.defineProperty;var c$=function(t,e){function r(t){if(!this||this.constructor!==r)return new r(t);this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,t&&h$.call(this,t)}e||u$(t,"size",{get:d$});return t.constructor=r,r.prototype=t,r}({delete:function(t){this.has(t)&&(this._keys.splice(xK,1),this._values.splice(xK,1),this._itp.forEach((function(t){xK<t[0]&&t[0]--})));return xK>-1},has:function(t){return f$.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[xK]:void 0},set:function(t,e){return this.has(t)?this._values[xK]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return p$(this._itp,this._keys)},values:function(){return p$(this._itp,this._values)},entries:function(){return p$(this._itp,this._keys,this._values)},forEach:function(t,e){for(var r=this.entries();;){var n=r.next();if(n.done)break;t.call(e,n.value[1],n.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}});function h$(t){this.add?t.forEach(this.add,this):t.forEach((function(t){this.set(t[0],t[1])}),this)}function f$(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(xK=t.length;xK--&&((r=t[xK])!==(n=e)&&(r==r||n==n)););else xK=t.indexOf(e);var r,n;return xK>-1}function p$(t,e,r){var n=[0],i=!1;return t.push(n),{next:function(){var o,s=n[0];return!i&&s<e.length?(o=r?[e[s],r[s]]:e[s],n[0]++):(i=!0,t.splice(t.indexOf(n),1)),{done:i,value:o}}}}function d$(){return this._values.length}let g$="undefined"!=typeof Map&&Map.prototype.values?Map:c$;function y$(){this.map_=new g$}y$.prototype=new lK,y$.prototype.get=function(t){return this.map_.get(t)||null},y$.prototype.put=function(t,e){return this.map_.set(t,e),e},y$.prototype.values=function(){const t=new tK,e=this.map_.values();let r=e.next();for(;!r.done;)t.add(r.value),r=e.next();return t},y$.prototype.entrySet=function(){const t=new hK;return this.map_.entries().forEach(e=>t.add(e)),t},y$.prototype.size=function(){return this.map_.size()};class m${constructor(){m$.constructor_.apply(this,arguments)}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof m$))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){var e=t,r=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new XK(r).compareTo(new XK(n))}getScale(){return this._scale}isFloating(){return this._modelType===m$.FLOATING||this._modelType===m$.FLOATING_SINGLE}getType(){return this._modelType}toString(){var t="UNKNOWN";return this._modelType===m$.FLOATING?t="Floating":this._modelType===m$.FLOATING_SINGLE?t="Floating-Single":this._modelType===m$.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){let t=arguments[0];return kZ.isNaN(t)||this._modelType===m$.FLOATING_SINGLE?t:this._modelType===m$.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof jZ){let t=arguments[0];if(this._modelType===m$.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){var t=16;return this._modelType===m$.FLOATING?t=16:this._modelType===m$.FLOATING_SINGLE?t=6:this._modelType===m$.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}getClass(){return m$}get interfaces_(){return[RZ,PZ]}}class _${constructor(){_$.constructor_.apply(this,arguments)}readResolve(){return _$.nameToTypeMap.get(this._name)}toString(){return this._name}getClass(){return _$}get interfaces_(){return[RZ]}}_$.constructor_=function(){this._name=null;let t=arguments[0];this._name=t,_$.nameToTypeMap.put(t,this)},_$.serialVersionUID=-552860263173159e4,_$.nameToTypeMap=new y$,m$.Type=_$,m$.constructor_=function(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=m$.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof _$){let t=arguments[0];this._modelType=t,t===m$.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){let t=arguments[0];this._modelType=m$.FIXED,this.setScale(t)}else if(arguments[0]instanceof m$){let t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}},m$.serialVersionUID=0x6bee6404e9a25c00,m$.FIXED=new _$("FIXED"),m$.FLOATING=new _$("FLOATING"),m$.FLOATING_SINGLE=new _$("FLOATING SINGLE"),m$.maximumPreciseValue=9007199254740992;class v${constructor(){v$.constructor_.apply(this,arguments)}static toMultiPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return l$.instance()}static toMultiLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new jZ(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new jZ(t.getMinX(),t.getMinY()),new jZ(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new jZ(t.getMinX(),t.getMinY()),new jZ(t.getMinX(),t.getMaxY()),new jZ(t.getMaxX(),t.getMaxY()),new jZ(t.getMaxX(),t.getMinY()),new jZ(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(EZ(arguments[0],IZ)){return new BK(arguments[0],this)}}}createMultiLineString(){if(0===arguments.length)return new RK(null,this);if(1===arguments.length){return new RK(arguments[0],this)}}buildGeometry(t){for(var e=null,r=!1,n=!1,i=t.iterator();i.hasNext();){var o=i.next(),s=o.getClass();null===e&&(e=s),s!==e&&(r=!0),o instanceof PK&&(n=!0)}if(null===e)return this.createGeometryCollection();if(r||n)return this.createGeometryCollection(v$.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof JK)return this.createMultiPolygon(v$.toPolygonArray(t));if(a instanceof BK)return this.createMultiLineString(v$.toLineStringArray(t));if(a instanceof qK)return this.createMultiPoint(v$.toPointArray(t));DZ.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof jZ){let t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(EZ(arguments[0],IZ)){return new qK(arguments[0],this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(EZ(arguments[0],IZ)){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof t$){let t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length){return new JK(arguments[0],arguments[1],this)}}getSRID(){return this._SRID}createGeometryCollection(){if(0===arguments.length)return new PK(null,this);if(1===arguments.length){return new PK(arguments[0],this)}}createGeometry(t){return new r$(this).edit(t,new class{edit(){if(2===arguments.length&&arguments[1]instanceof UZ&&EZ(arguments[0],IZ)){let t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(EZ(arguments[0],IZ)){return new t$(arguments[0],this)}}}createMultiPolygon(){if(0===arguments.length)return new e$(null,this);if(1===arguments.length){return new e$(arguments[0],this)}}createMultiPoint(){if(0===arguments.length)return new QK(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){return new QK(arguments[0],this)}if(EZ(arguments[0],IZ)){let n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var t=new Array(n.size()).fill(null),e=0;e<n.size();e++){var r=this.getCoordinateSequenceFactory().create(1,n.getDimension());UK.copy(n,e,r,0,1),t[e]=this.createPoint(r)}return this.createMultiPoint(t)}}}getClass(){return v$}get interfaces_(){return[RZ]}}v$.constructor_=function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)v$.constructor_.call(this,new m$,0);else if(1===arguments.length){if(EZ(arguments[0],OZ)){let t=arguments[0];v$.constructor_.call(this,new m$,0,t)}else if(arguments[0]instanceof m$){let t=arguments[0];v$.constructor_.call(this,t,0,v$.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];v$.constructor_.call(this,t,e,v$.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=r,this._SRID=e}},v$.serialVersionUID=-0x5ea75f2051eeb400;const b$=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class w${constructor(t){this.geometryFactory=t||new v$}read(t){let e;e="string"==typeof t?JSON.parse(t):t;const r=e.type;if(!x$[r])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==b$.indexOf(r)?x$[r].call(this,e.coordinates):"GeometryCollection"===r?x$[r].call(this,e.geometries):x$[r].call(this,e)}write(t){const e=t.getGeometryType();if(!E$[e])throw new Error("Geometry is not supported");return E$[e].call(this,t)}}const x$={Feature:function(t){const e={};for(let r in t)e[r]=t[r];if(t.geometry){const r=t.geometry.type;if(!x$[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=x$.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let r=0;r<t.features.length;++r)e.features.push(this.read(t.features[r]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(new jZ(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new jZ(t[0],t[1]),new jZ(t[2],t[1]),new jZ(t[2],t[3]),new jZ(t[0],t[3]),new jZ(t[0],t[1])])},Point:function(t){const e=new jZ(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let r=0;r<t.length;++r)e.push(x$.Point.call(this,t[r]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=x$.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let r=0;r<t.length;++r)e.push(x$.LineString.call(this,t[r]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=x$.coordinates.call(this,t[0]),r=this.geometryFactory.createLinearRing(e),n=[];for(let e=1;e<t.length;++e){var i=t[e],o=x$.coordinates.call(this,i),s=this.geometryFactory.createLinearRing(o);n.push(s)}return this.geometryFactory.createPolygon(r,n)},MultiPolygon:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(x$.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let r=0;r<t.length;++r){const n=t[r];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},E$={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:E$.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=E$.Point.call(this,n);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],r=t.getCoordinates();for(let t=0;t<r.length;++t){const n=r[t];e.push(E$.coordinate.call(this,n))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=E$.LineString.call(this,n);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],r=E$.LineString.call(this,t._shell);e.push(r.coordinates);for(let r=0;r<t._holes.length;++r){const n=t._holes[r],i=E$.LineString.call(this,n);e.push(i.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=E$.Polygon.call(this,n);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let r=0;r<t._geometries.length;++r){const n=t._geometries[r],i=n.getGeometryType();e.push(E$[i].call(this,n))}return{type:"GeometryCollection",geometries:e}}};class S${constructor(t){this.parser=new w$(t||new v$)}read(t){return this.parser.read(t)}}const I$={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};class O${constructor(t){this.geometryFactory=t||new v$,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){var e,r,n;t=t.replace(/[\n\r]/g," ");var i=I$.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=I$.emptyTypeStr.exec(t))[2]=void 0),i&&(r=i[1].toLowerCase(),n=i[2],T$[r]&&(e=T$[r].call(this,n))),void 0===e)throw new Error("Could not parse WKT "+t);return e}write(t){return this.extractGeometry(t)}extractGeometry(t){var e=t.getGeometryType().toLowerCase();if(!C$[e])return null;var r=e.toUpperCase();return t.isEmpty()?r+" EMPTY":r+"("+C$[e].call(this,t)+")"}}const C$={coordinate:t=>t.x+" "+t.y,point(t){return C$.coordinate.call(this,t._coordinates._coordinates[0])},multipoint(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+C$.point.call(this,t._geometries[r])+")");return e.join(",")},linestring(t){var e=[];for(let r=0,n=t._points._coordinates.length;r<n;++r)e.push(C$.coordinate.call(this,t._points._coordinates[r]));return e.join(",")},linearring(t){var e=[];for(let r=0,n=t._points._coordinates.length;r<n;++r)e.push(C$.coordinate.call(this,t._points._coordinates[r]));return e.join(",")},multilinestring(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+C$.linestring.call(this,t._geometries[r])+")");return e.join(",")},polygon(t){var e=[];e.push("("+C$.linestring.call(this,t._shell)+")");for(let r=0,n=t._holes.length;r<n;++r)e.push("("+C$.linestring.call(this,t._holes[r])+")");return e.join(",")},multipolygon(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push("("+C$.polygon.call(this,t._geometries[r])+")");return e.join(",")},geometrycollection(t){var e=[];for(let r=0,n=t._geometries.length;r<n;++r)e.push(this.extractGeometry(t._geometries[r]));return e.join(",")}},T$={coord(t){var e=t.trim().split(I$.spaces),r=new jZ(Number.parseFloat(e[0]),Number.parseFloat(e[1]));return this.precisionModel.makePrecise(r),r},point(t){return void 0===t?this.geometryFactory.createPoint():this.geometryFactory.createPoint(T$.coord.call(this,t))},multipoint(t){if(void 0===t)return this.geometryFactory.createMultiPoint();var e,r=t.trim().split(","),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(I$.trimParens,"$1"),n.push(T$.point.call(this,e));return this.geometryFactory.createMultiPoint(n)},linestring(t){if(void 0===t)return this.geometryFactory.createLineString();var e=t.trim().split(","),r=[];for(let t=0,n=e.length;t<n;++t)r.push(T$.coord.call(this,e[t]));return this.geometryFactory.createLineString(r)},linearring(t){if(void 0===t)return this.geometryFactory.createLinearRing();var e=t.trim().split(","),r=[];for(let t=0,n=e.length;t<n;++t)r.push(T$.coord.call(this,e[t]));return this.geometryFactory.createLinearRing(r)},multilinestring(t){if(void 0===t)return this.geometryFactory.createMultiLineString();var e,r=t.trim().split(I$.parenComma),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(I$.trimParens,"$1"),n.push(T$.linestring.call(this,e));return this.geometryFactory.createMultiLineString(n)},polygon(t){if(void 0===t)return this.geometryFactory.createPolygon();var e,r,n,i,o=t.trim().split(I$.parenComma),s=[];for(let t=0,a=o.length;t<a;++t)e=o[t].replace(I$.trimParens,"$1"),r=T$.linestring.call(this,e),n=this.geometryFactory.createLinearRing(r._points),0===t?i=n:s.push(n);return this.geometryFactory.createPolygon(i,s)},multipolygon(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();var e,r=t.trim().split(I$.doubleParenComma),n=[];for(let t=0,i=r.length;t<i;++t)e=r[t].replace(I$.trimParens,"$1"),n.push(T$.polygon.call(this,e));return this.geometryFactory.createMultiPolygon(n)},geometrycollection(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),r=[];for(let t=0,n=e.length;t<n;++t)r.push(this.read(e[t]));return this.geometryFactory.createGeometryCollection(r)}};class P${constructor(t){this.parser=new O$(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class R${constructor(){R$.constructor_.apply(this,arguments)}static toLocationSymbol(t){switch(t){case R$.EXTERIOR:return"e";case R$.BOUNDARY:return"b";case R$.INTERIOR:return"i";case R$.NONE:return"-"}throw new CZ("Unknown location value: "+t)}getClass(){return R$}get interfaces_(){return[]}}function L$(){}R$.constructor_=function(){},R$.INTERIOR=0,R$.BOUNDARY=1,R$.EXTERIOR=2,R$.NONE=-1;class M$ extends L${constructor(){super(),M$.constructor_.apply(this,arguments)}getClass(){return M$}get interfaces_(){return[]}}M$.constructor_=function(){L$.constructor_.call(this,"Projective point not representable on the Cartesian plane.")};class k${constructor(){k$.constructor_.apply(this,arguments)}static intersection(t,e,r,n){var i=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=r.y-n.y,l=n.x-r.x,u=r.x*n.y-n.x*r.y,c=i*l-a*o,h=(o*u-l*s)/c,f=(a*s-i*u)/c;if(kZ.isNaN(h)||kZ.isInfinite(h)||kZ.isNaN(f)||kZ.isInfinite(f))throw new M$;return new jZ(h,f)}getY(){var t=this.y/this.w;if(kZ.isNaN(t)||kZ.isInfinite(t))throw new M$;return t}getX(){var t=this.x/this.w;if(kZ.isNaN(t)||kZ.isInfinite(t))throw new M$;return t}getCoordinate(){var t=new jZ;return t.x=this.getX(),t.y=this.getY(),t}getClass(){return k$}get interfaces_(){return[]}}k$.constructor_=function(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){let t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof k$&&arguments[1]instanceof k$){let t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof jZ&&arguments[1]instanceof jZ){let t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.x=t,this.y=e,this.w=r}else if(4===arguments.length){let s=arguments[0],a=arguments[1],l=arguments[2],u=arguments[3];var t=s.y-a.y,e=a.x-s.x,r=s.x*a.y-a.x*s.y,n=l.y-u.y,i=u.x-l.x,o=l.x*u.y-u.x*l.y;this.x=e*o-i*r,this.y=n*r-t*o,this.w=t*i-n*e}};class N${constructor(){N$.constructor_.apply(this,arguments)}static segmentToSegment(t,e,r,n){if(t.equals(e))return N$.pointToSegment(t,r,n);if(r.equals(n))return N$.pointToSegment(n,t,e);var i=!1;if(zZ.intersects(t,e,r,n)){var o=(e.x-t.x)*(n.y-r.y)-(e.y-t.y)*(n.x-r.x);if(0===o)i=!0;else{var s=(t.y-r.y)*(n.x-r.x)-(t.x-r.x)*(n.y-r.y),a=((t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(i=!0)}}else i=!0;return i?nK.min(N$.pointToSegment(t,r,n),N$.pointToSegment(e,r,n),N$.pointToSegment(r,t,e),N$.pointToSegment(n,t,e)):0}static pointToSegment(t,e,r){if(e.x===r.x&&e.y===r.y)return t.distance(e);var n=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/n;if(i<=0)return t.distance(e);if(i>=1)return t.distance(r);var o=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/n;return Math.abs(o)*Math.sqrt(n)}static pointToLinePerpendicular(t,e,r){var n=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),i=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/n;return Math.abs(i)*Math.sqrt(n)}static pointToSegmentString(t,e){if(0===e.length)throw new CZ("Line array must contain at least one vertex");for(var r=t.distance(e[0]),n=0;n<e.length-1;n++){var i=N$.pointToSegment(t,e[n],e[n+1]);i<r&&(r=i)}return r}getClass(){return N$}get interfaces_(){return[]}}N$.constructor_=function(){};class A${constructor(){A$.constructor_.apply(this,arguments)}static computeEdgeDistance(t,e,r){var n=Math.abs(r.x-e.x),i=Math.abs(r.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(r))o=n>i?n:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=n>i?s:a)||t.equals(e)||(o=Math.max(s,a))}return DZ.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o}static nonRobustComputeEdgeDistance(t,e,r){var n=t.x-e.x,i=t.y-e.y,o=Math.sqrt(n*n+i*i);return DZ.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){var t=new zK;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,r,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=r,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,r,n)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){let t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){let e=arguments[0];for(var t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==A$.NO_INTERSECTION}getEdgeDistance(t,e){return A$.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===A$.COLLINEAR_INTERSECTION}toString(){return P$.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+P$.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}getClass(){return A$}get interfaces_(){return[]}}A$.constructor_=function(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new jZ,this._intPt[1]=new jZ,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},A$.DONT_INTERSECT=0,A$.DO_INTERSECT=1,A$.COLLINEAR=2,A$.NO_INTERSECTION=0,A$.POINT_INTERSECTION=1,A$.COLLINEAR_INTERSECTION=2;class F$ extends A${constructor(){super(),F$.constructor_.apply(this,arguments)}static nearestEndpoint(t,e,r,n){var i=t,o=N$.pointToSegment(t,r,n),s=N$.pointToSegment(e,r,n);return s<o&&(o=s,i=e),(s=N$.pointToSegment(r,t,e))<o&&(o=s,i=r),(s=N$.pointToSegment(n,t,e))<o&&(o=s,i=n),i}isInSegmentEnvelopes(t){var e=new zZ(this._inputLines[0][0],this._inputLines[0][1]),r=new zZ(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&r.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{let t=arguments[0],e=arguments[1],r=arguments[2];if(this._isProper=!1,zZ.intersects(e,r,t)&&0===KK.index(e,r,t)&&0===KK.index(r,e,t))return this._isProper=!0,(t.equals(e)||t.equals(r))&&(this._isProper=!1),this._result=A$.POINT_INTERSECTION,null;this._result=A$.NO_INTERSECTION}}normalizeToMinimum(t,e,r,n,i){i.x=this.smallestInAbsValue(t.x,e.x,r.x,n.x),i.y=this.smallestInAbsValue(t.y,e.y,r.y,n.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y}safeHCoordinateIntersection(t,e,r,n){var i=null;try{i=k$.intersection(t,e,r,n)}catch(o){if(!(o instanceof M$))throw o;i=F$.nearestEndpoint(t,e,r,n)}return i}intersection(t,e,r,n){var i=this.intersectionWithNormalization(t,e,r,n);return this.isInSegmentEnvelopes(i)||(i=new jZ(F$.nearestEndpoint(t,e,r,n))),null!==this._precisionModel&&this._precisionModel.makePrecise(i),i}smallestInAbsValue(t,e,r,n){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(r)<o&&(i=r,o=Math.abs(r)),Math.abs(n)<o&&(i=n),i}checkDD(t,e,r,n,i){var o=ZK.intersection(t,e,r,n),s=this.isInSegmentEnvelopes(o);iK.out.println("DD in env = "+s+"  --------------------- "+o),i.distance(o)>1e-4&&iK.out.println("Distance = "+i.distance(o))}intersectionWithNormalization(t,e,r,n){var i=new jZ(t),o=new jZ(e),s=new jZ(r),a=new jZ(n),l=new jZ;this.normalizeToEnvCentre(i,o,s,a,l);var u=this.safeHCoordinateIntersection(i,o,s,a);return u.x+=l.x,u.y+=l.y,u}computeCollinearIntersection(t,e,r,n){var i=zZ.intersects(t,e,r),o=zZ.intersects(t,e,n),s=zZ.intersects(r,n,t),a=zZ.intersects(r,n,e);return i&&o?(this._intPt[0]=r,this._intPt[1]=n,A$.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,A$.COLLINEAR_INTERSECTION):i&&s?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||o||a?A$.COLLINEAR_INTERSECTION:A$.POINT_INTERSECTION):i&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||s?A$.COLLINEAR_INTERSECTION:A$.POINT_INTERSECTION):o&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||i||a?A$.COLLINEAR_INTERSECTION:A$.POINT_INTERSECTION):o&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||i||s?A$.COLLINEAR_INTERSECTION:A$.POINT_INTERSECTION):A$.NO_INTERSECTION}normalizeToEnvCentre(t,e,r,n,i){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=r.x<n.x?r.x:n.x,c=r.y<n.y?r.y:n.y,h=r.x>n.x?r.x:n.x,f=r.y>n.y?r.y:n.y,p=((o>u?o:u)+(a<h?a:h))/2,d=((s>c?s:c)+(l<f?l:f))/2;i.x=p,i.y=d,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,r.x-=i.x,r.y-=i.y,n.x-=i.x,n.y-=i.y}computeIntersect(t,e,r,n){if(this._isProper=!1,!zZ.intersects(t,e,r,n))return A$.NO_INTERSECTION;var i=KK.index(t,e,r),o=KK.index(t,e,n);if(i>0&&o>0||i<0&&o<0)return A$.NO_INTERSECTION;var s=KK.index(r,n,t),a=KK.index(r,n,e);return s>0&&a>0||s<0&&a<0?A$.NO_INTERSECTION:0===i&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,r,n):(0===i||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(r)||t.equals2D(n)?this._intPt[0]=t:e.equals2D(r)||e.equals2D(n)?this._intPt[0]=e:0===i?this._intPt[0]=new jZ(r):0===o?this._intPt[0]=new jZ(n):0===s?this._intPt[0]=new jZ(t):0===a&&(this._intPt[0]=new jZ(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,r,n)),A$.POINT_INTERSECTION)}getClass(){return F$}get interfaces_(){return[]}}F$.constructor_=function(){};class D${constructor(){D$.constructor_.apply(this,arguments)}static locatePointInRing(){if(arguments[0]instanceof jZ&&EZ(arguments[1],IZ)){let i=arguments[1];for(var t=new D$(arguments[0]),e=new jZ,r=new jZ,n=1;n<i.size();n++)if(i.getCoordinate(n,e),i.getCoordinate(n-1,r),t.countSegment(e,r),t.isOnSegment())return t.getLocation();return t.getLocation()}if(arguments[0]instanceof jZ&&arguments[1]instanceof Array){let i=arguments[1];for(t=new D$(arguments[0]),n=1;n<i.length;n++){e=i[n],r=i[n-1];if(t.countSegment(e,r),t.isOnSegment())return t.getLocation()}return t.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var r=t.x,n=e.x;return r>n&&(r=e.x,n=t.x),this._p.x>=r&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=KK.index(t,e,this._p);if(i===KK.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(i=-i),i===KK.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==R$.EXTERIOR}getLocation(){return this._isPointOnSegment?R$.BOUNDARY:this._crossingCount%2==1?R$.INTERIOR:R$.EXTERIOR}isOnSegment(){return this._isPointOnSegment}getClass(){return D$}get interfaces_(){return[]}}D$.constructor_=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;let t=arguments[0];this._p=t};class j${constructor(){j$.constructor_.apply(this,arguments)}static isOnLine(){if(arguments[0]instanceof jZ&&EZ(arguments[1],IZ)){let o=arguments[0],s=arguments[1];for(var t=new F$,e=new jZ,r=new jZ,n=s.size(),i=1;i<n;i++)if(s.getCoordinate(i-1,e),s.getCoordinate(i,r),t.computeIntersection(o,e,r),t.hasIntersection())return!0;return!1}if(arguments[0]instanceof jZ&&arguments[1]instanceof Array){let n=arguments[0],o=arguments[1];for(t=new F$,i=1;i<o.length;i++){e=o[i-1],r=o[i];if(t.computeIntersection(n,e,r),t.hasIntersection())return!0}return!1}}static locateInRing(t,e){return D$.locatePointInRing(t,e)}static isInRing(t,e){return j$.locateInRing(t,e)!==R$.EXTERIOR}getClass(){return j$}get interfaces_(){return[]}}j$.constructor_=function(){};class G${constructor(){G$.constructor_.apply(this,arguments)}static isAtomic(t){return!(t instanceof PK)}next(){if(this._atStart)return this._atStart=!1,G$.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new JZ;var t=this._parent.getGeometryN(this._index++);return t instanceof PK?(this._subcollectionIterator=new G$(t),this._subcollectionIterator.next()):t}remove(){throw new UnsupportedOperationException(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}getClass(){return G$}get interfaces_(){return[HZ]}}G$.constructor_=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;let t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};class z${constructor(){z$.constructor_.apply(this,arguments)}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?j$.locateInRing(t,e.getCoordinates()):R$.EXTERIOR}intersects(t,e){return this.locate(t,e)!==R$.EXTERIOR}updateLocationInfo(t){t===R$.INTERIOR&&(this._isIn=!0),t===R$.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof qK&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof BK)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof JK)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof RK)for(var r=e,n=0;n<r.getNumGeometries();n++){var i=r.getGeometryN(n);this.updateLocationInfo(this.locateOnLineString(t,i))}else if(e instanceof e$){var o=e;for(n=0;n<o.getNumGeometries();n++){var s=o.getGeometryN(n);this.updateLocationInfo(this.locateInPolygon(t,s))}}else if(e instanceof PK)for(var a=new G$(e);a.hasNext();){var l=a.next();l!==e&&this.computeLocation(t,l)}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?R$.INTERIOR:R$.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return R$.EXTERIOR;var r=e.getCoordinateSequence();return e.isClosed()||!t.equals(r.getCoordinate(0))&&!t.equals(r.getCoordinate(r.size()-1))?j$.isOnLine(t,r)?R$.INTERIOR:R$.EXTERIOR:R$.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return R$.EXTERIOR;var r=e.getExteriorRing(),n=this.locateInPolygonRing(t,r);if(n===R$.EXTERIOR)return R$.EXTERIOR;if(n===R$.BOUNDARY)return R$.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=this.locateInPolygonRing(t,o);if(s===R$.INTERIOR)return R$.EXTERIOR;if(s===R$.BOUNDARY)return R$.BOUNDARY}return R$.INTERIOR}locate(t,e){return e.isEmpty()?R$.EXTERIOR:e instanceof BK?this.locateOnLineString(t,e):e instanceof JK?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?R$.BOUNDARY:this._numBoundaries>0||this._isIn?R$.INTERIOR:R$.EXTERIOR)}getClass(){return z$}get interfaces_(){return[]}}z$.constructor_=function(){if(this._boundaryRule=VZ.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];if(null===t)throw new CZ("Rule must be non-null");this._boundaryRule=t}};class U${constructor(){U$.constructor_.apply(this,arguments)}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return e===OK.SYM_DONTCARE||(e===OK.SYM_TRUE&&(t>=0||t===OK.TRUE)||(e===OK.SYM_FALSE&&t===OK.FALSE||(e===OK.SYM_P&&t===OK.P||(e===OK.SYM_L&&t===OK.L||e===OK.SYM_A&&t===OK.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){let t=arguments[1];return new U$(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===OK.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])||U$.isTrue(this._matrix[R$.INTERIOR][R$.BOUNDARY])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.INTERIOR])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.BOUNDARY]))&&this._matrix[R$.EXTERIOR][R$.INTERIOR]===OK.FALSE&&this._matrix[R$.EXTERIOR][R$.BOUNDARY]===OK.FALSE}isCoveredBy(){return(U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])||U$.isTrue(this._matrix[R$.INTERIOR][R$.BOUNDARY])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.INTERIOR])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.BOUNDARY]))&&this._matrix[R$.INTERIOR][R$.EXTERIOR]===OK.FALSE&&this._matrix[R$.BOUNDARY][R$.EXTERIOR]===OK.FALSE}set(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<n.length;t++){var e=Math.trunc(t/3),r=t%3;this._matrix[e][r]=OK.toDimensionValue(n.charAt(t))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._matrix[t][e]=r}}isContains(){return U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&this._matrix[R$.EXTERIOR][R$.INTERIOR]===OK.FALSE&&this._matrix[R$.EXTERIOR][R$.BOUNDARY]===OK.FALSE}setAtLeast(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<n.length;t++){var e=Math.trunc(t/3),r=t%3;this.setAtLeast(e,r,OK.toDimensionValue(n.charAt(t)))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._matrix[t][e]<r&&(this._matrix[t][e]=r)}}setAtLeastIfValid(t,e,r){t>=0&&e>=0&&this.setAtLeast(t,e,r)}isWithin(){return U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&this._matrix[R$.INTERIOR][R$.EXTERIOR]===OK.FALSE&&this._matrix[R$.BOUNDARY][R$.EXTERIOR]===OK.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===OK.A&&e===OK.A||t===OK.L&&e===OK.L||t===OK.L&&e===OK.A||t===OK.P&&e===OK.A||t===OK.P&&e===OK.L)&&(this._matrix[R$.INTERIOR][R$.INTERIOR]===OK.FALSE&&(U$.isTrue(this._matrix[R$.INTERIOR][R$.BOUNDARY])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.INTERIOR])||U$.isTrue(this._matrix[R$.BOUNDARY][R$.BOUNDARY])))}isOverlaps(t,e){return t===OK.P&&e===OK.P||t===OK.A&&e===OK.A?U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&U$.isTrue(this._matrix[R$.INTERIOR][R$.EXTERIOR])&&U$.isTrue(this._matrix[R$.EXTERIOR][R$.INTERIOR]):t===OK.L&&e===OK.L&&(1===this._matrix[R$.INTERIOR][R$.INTERIOR]&&U$.isTrue(this._matrix[R$.INTERIOR][R$.EXTERIOR])&&U$.isTrue(this._matrix[R$.EXTERIOR][R$.INTERIOR]))}isEquals(t,e){return t===e&&(U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&this._matrix[R$.INTERIOR][R$.EXTERIOR]===OK.FALSE&&this._matrix[R$.BOUNDARY][R$.EXTERIOR]===OK.FALSE&&this._matrix[R$.EXTERIOR][R$.INTERIOR]===OK.FALSE&&this._matrix[R$.EXTERIOR][R$.BOUNDARY]===OK.FALSE)}toString(){for(var t=new zK("123456789"),e=0;e<3;e++)for(var r=0;r<3;r++)t.setCharAt(3*e+r,OK.toDimensionSymbol(this._matrix[e][r]));return t.toString()}setAll(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this._matrix[e][r]=t}get(t,e){return this._matrix[t][e]}transpose(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new CZ("Should be length 9: "+t);for(var e=0;e<3;e++)for(var r=0;r<3;r++)if(!U$.matches(this._matrix[e][r],t.charAt(3*e+r)))return!1;return!0}add(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this.setAtLeast(e,r,t.get(e,r))}isDisjoint(){return this._matrix[R$.INTERIOR][R$.INTERIOR]===OK.FALSE&&this._matrix[R$.INTERIOR][R$.BOUNDARY]===OK.FALSE&&this._matrix[R$.BOUNDARY][R$.INTERIOR]===OK.FALSE&&this._matrix[R$.BOUNDARY][R$.BOUNDARY]===OK.FALSE}isCrosses(t,e){return t===OK.P&&e===OK.L||t===OK.P&&e===OK.A||t===OK.L&&e===OK.A?U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&U$.isTrue(this._matrix[R$.INTERIOR][R$.EXTERIOR]):t===OK.L&&e===OK.P||t===OK.A&&e===OK.P||t===OK.A&&e===OK.L?U$.isTrue(this._matrix[R$.INTERIOR][R$.INTERIOR])&&U$.isTrue(this._matrix[R$.EXTERIOR][R$.INTERIOR]):t===OK.L&&e===OK.L&&0===this._matrix[R$.INTERIOR][R$.INTERIOR]}getClass(){return U$}get interfaces_(){return[SZ]}}U$.constructor_=function(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(OK.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){let t=arguments[0];U$.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof U$){let t=arguments[0];U$.constructor_.call(this),this._matrix[R$.INTERIOR][R$.INTERIOR]=t._matrix[R$.INTERIOR][R$.INTERIOR],this._matrix[R$.INTERIOR][R$.BOUNDARY]=t._matrix[R$.INTERIOR][R$.BOUNDARY],this._matrix[R$.INTERIOR][R$.EXTERIOR]=t._matrix[R$.INTERIOR][R$.EXTERIOR],this._matrix[R$.BOUNDARY][R$.INTERIOR]=t._matrix[R$.BOUNDARY][R$.INTERIOR],this._matrix[R$.BOUNDARY][R$.BOUNDARY]=t._matrix[R$.BOUNDARY][R$.BOUNDARY],this._matrix[R$.BOUNDARY][R$.EXTERIOR]=t._matrix[R$.BOUNDARY][R$.EXTERIOR],this._matrix[R$.EXTERIOR][R$.INTERIOR]=t._matrix[R$.EXTERIOR][R$.INTERIOR],this._matrix[R$.EXTERIOR][R$.BOUNDARY]=t._matrix[R$.EXTERIOR][R$.BOUNDARY],this._matrix[R$.EXTERIOR][R$.EXTERIOR]=t._matrix[R$.EXTERIOR][R$.EXTERIOR]}};class B${constructor(){B$.constructor_.apply(this,arguments)}static isNorthern(t){return t===B$.NE||t===B$.NW}static isOpposite(t,e){return t!==e&&2===(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var r=t<e?t:e;return 0===r&&3===(t>e?t:e)?3:r}static isInHalfPlane(t,e){return e===B$.SE?t===B$.SE||t===B$.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new CZ("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?B$.NE:B$.SE:e>=0?B$.NW:B$.SW}if(arguments[0]instanceof jZ&&arguments[1]instanceof jZ){let t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new CZ("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?B$.NE:B$.SE:e.y>=t.y?B$.NW:B$.SW}}getClass(){return B$}get interfaces_(){return[]}}B$.constructor_=function(){},B$.NE=0,B$.NW=1,B$.SW=2,B$.SE=3;class V${constructor(){V$.constructor_.apply(this,arguments)}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:KK.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){var e=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),n=r.lastIndexOf("."),i=r.substring(n+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){var e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),r=e.lastIndexOf(".");return"  "+e.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=B$.quadrant(this._dx,this._dy),DZ.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}getClass(){return V$}get interfaces_(){return[PZ]}}V$.constructor_=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){let t=arguments[0];this._edge=t}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];V$.constructor_.call(this,t,e,r,null)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];V$.constructor_.call(this,t),this.init(e,r),this._label=n}};class q${constructor(){q$.constructor_.apply(this,arguments)}static opposite(t){return t===q$.LEFT?q$.RIGHT:t===q$.RIGHT?q$.LEFT:t}getClass(){return q$}get interfaces_(){return[]}}q$.constructor_=function(){},q$.ON=0,q$.LEFT=1,q$.RIGHT=2;class Y${constructor(){Y$.constructor_.apply(this,arguments)}setAllLocations(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==R$.NONE)return!1;return!0}setAllLocationsIfNull(t){for(var e=0;e<this.location.length;e++)this.location[e]===R$.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[q$.ON]=this.location[q$.ON],e[q$.LEFT]=R$.NONE,e[q$.RIGHT]=R$.NONE,this.location=e}for(var r=0;r<this.location.length;r++)this.location[r]===R$.NONE&&r<t.location.length&&(this.location[r]=t.location[r])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;var t=this.location[q$.LEFT];this.location[q$.LEFT]=this.location[q$.RIGHT],this.location[q$.RIGHT]=t}toString(){var t=new WK;return this.location.length>1&&t.append(R$.toLocationSymbol(this.location[q$.LEFT])),t.append(R$.toLocationSymbol(this.location[q$.ON])),this.location.length>1&&t.append(R$.toLocationSymbol(this.location[q$.RIGHT])),t.toString()}setLocations(t,e,r){this.location[q$.ON]=t,this.location[q$.LEFT]=e,this.location[q$.RIGHT]=r}get(t){return t<this.location.length?this.location[t]:R$.NONE}isArea(){return this.location.length>1}isAnyNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]===R$.NONE)return!0;return!1}setLocation(){if(1===arguments.length){let t=arguments[0];this.setLocation(q$.ON,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(R$.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}getClass(){return Y$}get interfaces_(){return[]}}Y$.constructor_=function(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){let t=arguments[0];this.init(1),this.location[q$.ON]=t}else if(arguments[0]instanceof Y$){let e=arguments[0];if(this.init(e.location.length),null!==e)for(var t=0;t<this.location.length;t++)this.location[t]=e.location[t]}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.init(3),this.location[q$.ON]=t,this.location[q$.LEFT]=e,this.location[q$.RIGHT]=r}};class W${constructor(){W$.constructor_.apply(this,arguments)}static toLineLabel(t){for(var e=new W$(R$.NONE),r=0;r<2;r++)e.setLocation(r,t.getLocation(r));return e}getGeometryCount(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){let t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Y$(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){let t=arguments[0];return this.elt[t].get(q$.ON)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){var t=new WK;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){let t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setLocation(q$.ON,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.elt[t].setLocation(e,r)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new Y$(this.elt[t].location[0]))}getClass(){return W$}get interfaces_(){return[]}}W$.constructor_=function(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){let t=arguments[0];this.elt[0]=new Y$(t),this.elt[1]=new Y$(t)}else if(arguments[0]instanceof W$){let t=arguments[0];this.elt[0]=new Y$(t.elt[0]),this.elt[1]=new Y$(t.elt[1])}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[0]=new Y$(R$.NONE),this.elt[1]=new Y$(R$.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this.elt[0]=new Y$(t,e,r),this.elt[1]=new Y$(t,e,r)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.elt[0]=new Y$(R$.NONE,R$.NONE,R$.NONE),this.elt[1]=new Y$(R$.NONE,R$.NONE,R$.NONE),this.elt[t].setLocations(e,r,n)}};class X${constructor(){X$.constructor_.apply(this,arguments)}createEdgeEndForNext(t,e,r,n){var i=r.segmentIndex+1;if(i>=t.getNumPoints()&&null===n)return null;var o=t.getCoordinate(i);null!==n&&n.segmentIndex===r.segmentIndex&&(o=n.coord);var s=new V$(t,r.coord,o,new W$(t.getLabel()));e.add(s)}createEdgeEndForPrev(t,e,r,n){var i=r.segmentIndex;if(0===r.dist){if(0===i)return null;i--}var o=t.getCoordinate(i);null!==n&&n.segmentIndex>=i&&(o=n.coord);var s=new W$(t.getLabel());s.flip();var a=new V$(t,r.coord,o,s);e.add(a)}computeEdgeEnds(){if(1===arguments.length){let n=arguments[0];for(var t=new tK,e=n;e.hasNext();){var r=e.next();this.computeEdgeEnds(r,t)}return t}if(2===arguments.length){let t=arguments[0],e=arguments[1];var n=t.getEdgeIntersectionList();n.addEndpoints();var i=n.iterator(),o=null,s=null;if(!i.hasNext())return null;var a=i.next();do{o=s,s=a,a=null,i.hasNext()&&(a=i.next()),null!==s&&(this.createEdgeEndForPrev(t,e,s,o),this.createEdgeEndForNext(t,e,s,a))}while(null!==s)}}getClass(){return X$}get interfaces_(){return[]}}X$.constructor_=function(){};class H${constructor(){H$.constructor_.apply(this,arguments)}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){DZ.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}getClass(){return H$}get interfaces_(){return[]}}H$.constructor_=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._label=t}};class Z$ extends H${constructor(){super(),Z$.constructor_.apply(this,arguments)}isIncidentEdgeInResult(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){var r=R$.NONE;if(r=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);r!==R$.BOUNDARY&&(r=n)}return r}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{let t=arguments[0],e=arguments[1];null===this._label?this._label=new W$(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof Z$){let t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof W$){let r=arguments[0];for(var t=0;t<2;t++){var e=this.computeMergedLocation(r,t);this._label.getLocation(t)===R$.NONE&&this._label.setLocation(t,e)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;var e=R$.NONE;null!==this._label&&(e=this._label.getLocation(t));var r=null;switch(e){case R$.BOUNDARY:r=R$.INTERIOR;break;case R$.INTERIOR:default:r=R$.BOUNDARY}this._label.setLocation(t,r)}getClass(){return Z$}get interfaces_(){return[]}}Z$.constructor_=function(){this._coord=null,this._edges=null;let t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new W$(0,R$.NONE)};class K${constructor(){K$.constructor_.apply(this,arguments)}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof jZ){let e=arguments[0];return null===(t=this.nodeMap.get(e))&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof Z$){let e=arguments[0];var t;return null===(t=this.nodeMap.get(e.getCoordinate()))?(this.nodeMap.put(e.getCoordinate(),e),e):(t.mergeLabel(e),t)}}print(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){for(var e=new tK,r=this.iterator();r.hasNext();){var n=r.next();n.getLabel().getLocation(t)===R$.BOUNDARY&&e.add(n)}return e}add(t){var e=t.getCoordinate();this.addNode(e).add(t)}getClass(){return K$}get interfaces_(){return[]}}K$.constructor_=function(){this.nodeMap=new _K,this.nodeFact=null;let t=arguments[0];this.nodeFact=t};class $$ extends AZ{constructor(){if(1===arguments.length){let t=arguments[0];super(t),AZ.call(this,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];super($$.msgWithCoord(t,e)),this.name="TopologyException",this.pt=new jZ(e)}}getCoordinate(){return this.pt}get interfaces_(){return[]}getClass(){return $$}static msgWithCoord(t,e){return null!==e?t+" [ "+e+" ]":t}}class J${constructor(){J$.constructor_.apply(this,arguments)}locate(t){}getClass(){return J$}get interfaces_(){return[]}}J$.constructor_=function(){};class Q${constructor(){Q$.constructor_.apply(this,arguments)}static locatePointInPolygon(t,e){if(e.isEmpty())return R$.EXTERIOR;var r=e.getExteriorRing(),n=Q$.locatePointInRing(t,r);if(n!==R$.INTERIOR)return n;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=Q$.locatePointInRing(t,o);if(s===R$.BOUNDARY)return R$.BOUNDARY;if(s===R$.INTERIOR)return R$.EXTERIOR}return R$.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?j$.locateInRing(t,e.getCoordinates()):R$.EXTERIOR}static containsPointInPolygon(t,e){return R$.EXTERIOR!==Q$.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof JK)return Q$.locatePointInPolygon(t,e);if(e instanceof PK)for(var r=new G$(e);r.hasNext();){var n=r.next();if(n!==e){var i=Q$.locateInGeometry(t,n);if(i!==R$.EXTERIOR)return i}}return R$.EXTERIOR}static locate(t,e){return e.isEmpty()?R$.EXTERIOR:Q$.locateInGeometry(t,e)}locate(t){return Q$.locate(t,this._geom)}getClass(){return Q$}get interfaces_(){return[J$]}}Q$.constructor_=function(){this._geom=null;let t=arguments[0];this._geom=t};class tJ{constructor(){tJ.constructor_.apply(this,arguments)}getNextCW(t){this.getEdges();var e=this._edgeList.indexOf(t),r=e-1;return 0===e&&(r=this._edgeList.size()-1),this._edgeList.get(r)}propagateSideLabels(t){for(var e=R$.NONE,r=this.iterator();r.hasNext();){(o=(i=r.next()).getLabel()).isArea(t)&&o.getLocation(t,q$.LEFT)!==R$.NONE&&(e=o.getLocation(t,q$.LEFT))}if(e===R$.NONE)return null;var n=e;for(r=this.iterator();r.hasNext();){var i,o;if((o=(i=r.next()).getLabel()).getLocation(t,q$.ON)===R$.NONE&&o.setLocation(t,q$.ON,n),o.isArea(t)){var s=o.getLocation(t,q$.LEFT),a=o.getLocation(t,q$.RIGHT);if(a!==R$.NONE){if(a!==n)throw new $$("side location conflict",i.getCoordinate());s===R$.NONE&&DZ.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),n=s}else DZ.isTrue(o.getLocation(t,q$.LEFT)===R$.NONE,"found single null side"),o.setLocation(t,q$.RIGHT,n),o.setLocation(t,q$.LEFT,n)}}}getCoordinate(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}print(t){iK.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){var e=this.getEdges();if(e.size()<=0)return!0;var r=e.size()-1,n=e.get(r).getLabel().getLocation(t,q$.LEFT);DZ.isTrue(n!==R$.NONE,"Found unlabelled area edge");for(var i=n,o=this.iterator();o.hasNext();){var s=o.next().getLabel();DZ.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,q$.LEFT),l=s.getLocation(t,q$.RIGHT);if(a===l)return!1;if(l!==i)return!1;i=a}return!0}findIndex(t){this.iterator();for(var e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new tK(this._edgeMap.values())),this._edgeList}getLocation(t,e,r){return this._ptInAreaLocation[t]===R$.NONE&&(this._ptInAreaLocation[t]=Q$.locate(e,r[t].getGeometry())),this._ptInAreaLocation[t]}toString(){var t=new WK;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var r=e.next();t.append(r),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],r=this.iterator();r.hasNext();)for(var n=(o=r.next()).getLabel(),i=0;i<2;i++)n.isLine(i)&&n.getLocation(i)===R$.BOUNDARY&&(e[i]=!0);for(r=this.iterator();r.hasNext();){var o;for(n=(o=r.next()).getLabel(),i=0;i<2;i++)if(n.isAnyNull(i)){var s=R$.NONE;if(e[i])s=R$.EXTERIOR;else{var a=o.getCoordinate();s=this.getLocation(i,a,t)}n.setAllLocationsIfNull(i,s)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}getClass(){return tJ}get interfaces_(){return[]}}tJ.constructor_=function(){this._edgeMap=new _K,this._edgeList=null,this._ptInAreaLocation=[R$.NONE,R$.NONE]};class eJ{constructor(){eJ.constructor_.apply(this,arguments)}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}getClass(){return eJ}get interfaces_(){return[]}}eJ.constructor_=function(){this.mce=null,this.chainIndex=null;let t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};class rJ{constructor(){rJ.constructor_.apply(this,arguments)}isDelete(){return this._eventType===rJ.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===rJ.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}getClass(){return rJ}get interfaces_(){return[PZ]}}rJ.constructor_=function(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._eventType=rJ.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._eventType=rJ.INSERT,this._label=t,this._xValue=e,this._obj=r}},rJ.INSERT=1,rJ.DELETE=2;class nJ{constructor(){nJ.constructor_.apply(this,arguments)}getClass(){return nJ}get interfaces_(){return[]}}nJ.constructor_=function(){};const iJ={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return iJ.sort(t),t.get(0)},sort:function(t,e){const r=t.toArray();e?SK.sort(r,e):SK.sort(r);const n=t.iterator();for(let t=0,e=r.length;t<e;t++)n.next(),n.set(r[t])},singletonList:function(t){const e=new tK;return e.add(t),e}};var oJ=iJ;class sJ{constructor(){sJ.constructor_.apply(this,arguments)}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,r,n){if(t===r&&1===this._li.getIntersectionNum()){if(sJ.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(var r=e.iterator();r.hasNext();){var n=r.next().getCoordinate();if(t.isIntersection(n))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,r,n){if(t===r&&e===n)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=r.getCoordinates()[n],a=r.getCoordinates()[n+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,r,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),r.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}getClass(){return sJ}get interfaces_(){return[]}}sJ.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;let t=arguments[0],e=arguments[1],r=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=r};class aJ extends nJ{constructor(){super(),aJ.constructor_.apply(this,arguments)}prepareEvents(){oJ.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){let r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var t=0;t<this.events.size();t++){var e=this.events.get(t);if(e.isInsert()&&this.processOverlaps(t,e.getDeleteEventIndex(),e,r),r.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof sJ&&EZ(arguments[0],$Z)&&EZ(arguments[1],$Z)){let t=arguments[0],e=arguments[1],r=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(r)}else if("boolean"==typeof arguments[2]&&EZ(arguments[0],$Z)&&arguments[1]instanceof sJ){let t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){for(var r=t.getMonotoneChainEdge(),n=r.getStartIndexes(),i=0;i<n.length-1;i++){var o=new eJ(r,i),s=new rJ(e,r.getMinX(i),o);this.events.add(s),this.events.add(new rJ(r.getMaxX(i),s))}}processOverlaps(t,e,r,n){for(var i=r.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();r.isSameLabel(s)||(i.computeIntersections(a,n),this.nOverlaps++)}}}addEdges(){if(1===arguments.length){for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}}else if(2===arguments.length){let r=arguments[1];for(t=arguments[0].iterator();t.hasNext();){e=t.next();this.addEdge(e,r)}}}getClass(){return aJ}get interfaces_(){return[]}}aJ.constructor_=function(){this.events=new tK,this.nOverlaps=null};class lJ{constructor(){lJ.constructor_.apply(this,arguments)}visitItem(t){}getClass(){return lJ}get interfaces_(){return[]}}lJ.constructor_=function(){};class uJ{constructor(){uJ.constructor_.apply(this,arguments)}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return P$.toLineString(new jZ(this._min,0),new jZ(this._max,0))}getClass(){return uJ}get interfaces_(){return[]}}class cJ{constructor(){cJ.constructor_.apply(this,arguments)}compare(t,e){var r=t,n=e,i=(r._min+r._max)/2,o=(n._min+n._max)/2;return i<o?-1:i>o?1:0}getClass(){return cJ}get interfaces_(){return[NZ]}}cJ.constructor_=function(){},uJ.NodeComparator=cJ,uJ.constructor_=function(){this._min=kZ.POSITIVE_INFINITY,this._max=kZ.NEGATIVE_INFINITY};class hJ extends uJ{constructor(){super(),hJ.constructor_.apply(this,arguments)}query(t,e,r){if(!this.intersects(t,e))return null;r.visitItem(this._item)}getClass(){return hJ}get interfaces_(){return[]}}hJ.constructor_=function(){this._item=null;let t=arguments[0],e=arguments[1],r=arguments[2];this._min=t,this._max=e,this._item=r};class fJ extends uJ{constructor(){super(),fJ.constructor_.apply(this,arguments)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,r){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,r),null!==this._node2&&this._node2.query(t,e,r)}getClass(){return fJ}get interfaces_(){return[]}}fJ.constructor_=function(){this._node1=null,this._node2=null;let t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)};class pJ{constructor(){pJ.constructor_.apply(this,arguments)}buildTree(){oJ.sort(this._leaves,new uJ.NodeComparator);for(var t=this._leaves,e=null,r=new tK;;){if(this.buildLevel(t,r),1===r.size())return r.get(0);e=t,t=r,r=e}}insert(t,e,r){if(null!==this._root)throw new IllegalStateException("Index cannot be added to once it has been queried");this._leaves.add(new hJ(t,e,r))}query(t,e,r){this.init(),this._root.query(t,e,r)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){iK.out.println(P$.toLineString(new jZ(t._min,this._level),new jZ(t._max,this._level)))}init(){if(null!==this._root)return null;this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(var r=0;r<t.size();r+=2){var n=t.get(r);if(null===(r+1<t.size()?t.get(r):null))e.add(n);else{var i=new fJ(t.get(r),t.get(r+1));e.add(i)}}}getClass(){return pJ}get interfaces_(){return[]}}pJ.constructor_=function(){this._leaves=new tK,this._root=null,this._level=0};class dJ{constructor(){dJ.constructor_.apply(this,arguments)}static midPoint(t,e){return new jZ((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof dJ){let r=arguments[0];var t=KK.index(this.p0,this.p1,r.p0),e=KK.index(this.p0,this.p1,r.p1);return t>=0&&e>=0||t<=0&&e<=0?Math.max(t,e):0}if(arguments[0]instanceof jZ){let t=arguments[0];return KK.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof dJ))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){var e=new F$;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof jZ){let r=arguments[0];if(r.equals(this.p0)||r.equals(this.p1))return new jZ(r);var t=this.projectionFactor(r),e=new jZ;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}if(arguments[0]instanceof dJ){let t=arguments[0];var r=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(r>=1&&n>=1)return null;if(r<=0&&n<=0)return null;var i=this.project(t.p0);r<0&&(i=this.p0),r>1&&(i=this.p1);var o=this.project(t.p1);return n<0&&(o=this.p0),n>1&&(o=this.p1),new dJ(i,o)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return N$.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return dJ.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,n=e*e+r*r;return n<=0?kZ.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*r)/n}closestPoints(t){var e=this.intersection(t);if(null!==e)return[e,e];var r=new Array(2).fill(null),n=kZ.MAX_VALUE,i=null,o=this.closestPoint(t.p0);n=o.distance(t.p0),r[0]=o,r[1]=t.p0;var s=this.closestPoint(t.p1);(i=s.distance(t.p1))<n&&(n=i,r[0]=s,r[1]=t.p1);var a=t.closestPoint(this.p0);(i=a.distance(this.p0))<n&&(n=i,r[0]=this.p0,r[1]=a);var l=t.closestPoint(this.p1);return(i=l.distance(this.p1))<n&&(n=i,r[0]=this.p1,r[1]=l),r}closestPoint(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){var e=t,r=this.p0.compareTo(e.p0);return 0!==r?r:this.p1.compareTo(e.p1)}reverse(){var t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){try{return k$.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof M$))throw t}return null}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){var r=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(i*i+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*i/s,l=e*o/s}return new jZ(r-l,n+a)}setCoordinates(){if(1===arguments.length){let t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||kZ.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}distance(){if(arguments[0]instanceof dJ){let t=arguments[0];return N$.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof jZ){let t=arguments[0];return N$.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){var e=new jZ;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),r=java.lang.Double.doubleToLongBits(this.p1.x);return r^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^(Math.trunc(r)^Math.trunc(r>>32))}getClass(){return dJ}get interfaces_(){return[PZ,RZ]}}dJ.constructor_=function(){if(this.p0=null,this.p1=null,0===arguments.length)dJ.constructor_.call(this,new jZ,new jZ);else if(1===arguments.length){let t=arguments[0];dJ.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];dJ.constructor_.call(this,new jZ(t,e),new jZ(r,n))}},dJ.serialVersionUID=0x2d2172135f411c00;class gJ{constructor(){gJ.constructor_.apply(this,arguments)}static getGeometry(){if(1===arguments.length){let t=arguments[0];return t.getFactory().buildGeometry(gJ.getLines(t))}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(gJ.getLines(t,e))}}static getLines(){if(1===arguments.length){let t=arguments[0];return gJ.getLines(t,!1)}if(2===arguments.length){if(EZ(arguments[0],ZZ)&&EZ(arguments[1],ZZ)){let r=arguments[1];for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();gJ.getLines(e,r)}return r}if(arguments[0]instanceof UZ&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];var r=new tK;return t.apply(new gJ(r,e)),r}if(arguments[0]instanceof UZ&&EZ(arguments[1],ZZ)){let t=arguments[0],e=arguments[1];return t instanceof BK?e.add(t):t.apply(new gJ(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&EZ(arguments[0],ZZ)&&EZ(arguments[1],ZZ)){let r=arguments[1],n=arguments[2];for(t=arguments[0].iterator();t.hasNext();){e=t.next();gJ.getLines(e,r,n)}return r}if("boolean"==typeof arguments[2]&&arguments[0]instanceof UZ&&EZ(arguments[1],ZZ)){let t=arguments[1],e=arguments[2];return arguments[0].apply(new gJ(t,e)),t}}}filter(t){if(this._isForcedToLineString&&t instanceof t$){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof BK&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}getClass(){return gJ}get interfaces_(){return[TZ]}}gJ.constructor_=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){let t=arguments[0];this._lines=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}};class yJ{constructor(){yJ.constructor_.apply(this,arguments)}visitItem(t){this._items.add(t)}getItems(){return this._items}getClass(){return yJ}get interfaces_(){return[lJ]}}yJ.constructor_=function(){this._items=new tK};class mJ{constructor(){mJ.constructor_.apply(this,arguments)}locate(t){var e=new D$(t),r=new _J(e);return this._index.query(t.y,t.y,r),e.getLocation()}getClass(){return mJ}get interfaces_(){return[J$]}}class _J{constructor(){_J.constructor_.apply(this,arguments)}visitItem(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}getClass(){return _J}get interfaces_(){return[lJ]}}_J.constructor_=function(){this._counter=null;let t=arguments[0];this._counter=t};class vJ{constructor(){vJ.constructor_.apply(this,arguments)}init(t){for(var e=gJ.getLines(t).iterator();e.hasNext();){var r=e.next().getCoordinates();this.addLine(r)}}addLine(t){for(var e=1;e<t.length;e++){var r=new dJ(t[e-1],t[e]),n=Math.min(r.p0.y,r.p1.y),i=Math.max(r.p0.y,r.p1.y);this._index.insert(n,i,r)}}query(){if(2===arguments.length){let e=arguments[0],r=arguments[1];var t=new yJ;return this._index.query(e,r,t),t.getItems()}if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._index.query(t,e,r)}}getClass(){return vJ}get interfaces_(){return[]}}vJ.constructor_=function(){this._index=new pJ;let t=arguments[0];this.init(t)},mJ.SegmentVisitor=_J,mJ.IntervalIndexedGeometry=vJ,mJ.constructor_=function(){this._index=null;let t=arguments[0];if(!(EZ(t,$K)||t instanceof t$))throw new CZ("Argument must be Polygonal or LinearRing");this._index=new vJ(t)};class bJ{constructor(){bJ.constructor_.apply(this,arguments)}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){var e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}getClass(){return bJ}get interfaces_(){return[PZ]}}bJ.constructor_=function(){this.coord=null,this.segmentIndex=null,this.dist=null;let t=arguments[0],e=arguments[1],r=arguments[2];this.coord=new jZ(t),this.segmentIndex=e,this.dist=r};class wJ{constructor(){wJ.constructor_.apply(this,arguments)}print(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();for(var e=this.iterator(),r=e.next();e.hasNext();){var n=e.next(),i=this.createSplitEdge(r,n);t.add(i),r=n}}addEndpoints(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){var r=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(n);i||r--;var o=new Array(r).fill(null),s=0;o[s++]=new jZ(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return i&&(o[s]=e.coord),new IJ(o,new W$(this.edge._label))}add(t,e,r){var n=new bJ(t,e,r),i=this._nodeMap.get(n);return null!==i?i:(this._nodeMap.put(n,n),n)}isIntersection(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1}getClass(){return wJ}get interfaces_(){return[]}}wJ.constructor_=function(){this._nodeMap=new _K,this.edge=null;let t=arguments[0];this.edge=t};class xJ{constructor(){xJ.constructor_.apply(this,arguments)}static toIntArray(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e}getChainStartIndices(t){var e=0,r=new tK;r.add(new XK(e));do{var n=this.findChainEnd(t,e);r.add(new XK(n)),e=n}while(e<t.length-1);return xJ.toIntArray(r)}findChainEnd(t,e){for(var r=B$.quadrant(t[e],t[e+1]),n=e+1;n<t.length;){if(B$.quadrant(t[n-1],t[n])!==r)break;n++}return n-1}getClass(){return xJ}get interfaces_(){return[]}}xJ.constructor_=function(){};class EJ{constructor(){EJ.constructor_.apply(this,arguments)}getCoordinates(){return this.pts}getMaxX(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e>r?e:r}getMinX(t){var e=this.pts[this.startIndex[t]].x,r=this.pts[this.startIndex[t+1]].x;return e<r?e:r}computeIntersectsForChain(){if(4===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[r],e.startIndex[r+1],n)}else if(6===arguments.length){let r=arguments[0],n=arguments[1],i=arguments[2],o=arguments[3],s=arguments[4],a=arguments[5];if(n-r==1&&s-o==1)return a.addIntersections(this.e,r,i.e,o),null;if(!this.overlaps(r,n,i,o,s))return null;var t=Math.trunc((r+n)/2),e=Math.trunc((o+s)/2);r<t&&(o<e&&this.computeIntersectsForChain(r,t,i,o,e,a),e<s&&this.computeIntersectsForChain(r,t,i,e,s,a)),t<n&&(o<e&&this.computeIntersectsForChain(t,n,i,o,e,a),e<s&&this.computeIntersectsForChain(t,n,i,e,s,a))}}overlaps(t,e,r,n,i){return zZ.intersects(this.pts[t],this.pts[e],r.pts[n],r.pts[i])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(var r=0;r<this.startIndex.length-1;r++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(r,t,n,e)}getClass(){return EJ}get interfaces_(){return[]}}EJ.constructor_=function(){this.e=null,this.pts=null,this.startIndex=null;let t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new xJ;this.startIndex=e.getChainStartIndices(this.pts)};class SJ{constructor(){SJ.constructor_.apply(this,arguments)}static depthAtLocation(t){return t===R$.EXTERIOR?0:t===R$.INTERIOR?1:SJ.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,r){this._depth[t][e]=r}isNull(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==SJ.NULL_VALUE)return!1;return!0}if(1===arguments.length){let t=arguments[0];return this._depth[t][1]===SJ.NULL_VALUE}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this._depth[t][e]===SJ.NULL_VALUE}}normalize(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var r=1;r<3;r++){var n=0;this._depth[t][r]>e&&(n=1),this._depth[t][r]=n}}}getDelta(t){return this._depth[t][q$.RIGHT]-this._depth[t][q$.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?R$.EXTERIOR:R$.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){let n=arguments[0];for(var t=0;t<2;t++)for(var e=1;e<3;e++){var r=n.getLocation(t,e);r!==R$.EXTERIOR&&r!==R$.INTERIOR||(this.isNull(t,e)?this._depth[t][e]=SJ.depthAtLocation(r):this._depth[t][e]+=SJ.depthAtLocation(r))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1];arguments[2]===R$.INTERIOR&&this._depth[t][e]++}}getClass(){return SJ}get interfaces_(){return[]}}SJ.constructor_=function(){this._depth=Array(2).fill().map(()=>Array(3));for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=SJ.NULL_VALUE},SJ.NULL_VALUE=-1;class IJ extends H${constructor(){super(),IJ.constructor_.apply(this,arguments)}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof U$&&arguments[0]instanceof W$))return super.updateIM.apply(this,arguments);{let t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,q$.ON),t.getLocation(1,q$.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,q$.LEFT),t.getLocation(1,q$.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,q$.RIGHT),t.getLocation(1,q$.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new IJ(t,W$.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof IJ))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var r=!0,n=!0,i=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(r=!1),this.pts[o].equals2D(e.pts[--i])||(n=!1),!r&&!n)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){let t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){IJ.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new EJ(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new zZ;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,r,n){var i=new jZ(t.getIntersection(n)),o=e,s=t.getEdgeDistance(r,n),a=o+1;if(a<this.pts.length){var l=this.pts[a];i.equals2D(l)&&(o=a,s=0)}this.eiList.add(i,o,s)}toString(){var t=new zK;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,r){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,r,n)}getClass(){return IJ}get interfaces_(){return[]}}IJ.constructor_=function(){if(this.pts=null,this._env=null,this.eiList=new wJ(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new SJ,this._depthDelta=0,1===arguments.length){let t=arguments[0];IJ.constructor_.call(this,t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.pts=t,this._label=e}};class OJ extends V${constructor(){super(),OJ.constructor_.apply(this,arguments)}static depthFactor(t,e){return t===R$.EXTERIOR&&e===R$.INTERIOR?1:t===R$.INTERIOR&&e===R$.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new W$(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new $$("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,q$.LEFT)===R$.INTERIOR&&this._label.getLocation(e,q$.RIGHT)===R$.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[q$.LEFT]+"/"+this._depth[q$.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,R$.EXTERIOR),r=!this._label.isArea(1)||this._label.allPositionsEqual(1,R$.EXTERIOR);return t&&e&&r}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){var r=this.getEdge().getDepthDelta();this._isForward||(r=-r);var n=1;t===q$.LEFT&&(n=-1);var i=q$.opposite(t),o=e+r*n;this.setDepth(t,e),this.setDepth(i,o)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}getClass(){return OJ}get interfaces_(){return[]}}OJ.constructor_=function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];let t=arguments[0],e=arguments[1];if(V$.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()};class CJ{constructor(){CJ.constructor_.apply(this,arguments)}createNode(t){return new Z$(t,null)}getClass(){return CJ}get interfaces_(){return[]}}CJ.constructor_=function(){};class TJ{constructor(){TJ.constructor_.apply(this,arguments)}static linkResultDirectedEdges(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}}printEdges(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var r=this._edges.get(e);r.print(t),r.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof Z$){let t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof jZ){let t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}}debugPrintln(t){iK.out.println(t)}isBoundaryNode(t,e){var r=this._nodes.find(e);if(null===r)return!1;var n=r.getLabel();return null!==n&&n.getLocation(t)===R$.BOUNDARY}linkAllDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}}matchInSameDirection(t,e,r,n){return!!t.equals(r)&&(KK.index(t,e,n)===KK.COLLINEAR&&B$.quadrant(t,e)===B$.quadrant(r,n))}getEdgeEnds(){return this._edgeEndList}debugPrint(t){iK.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(var r=0;r<this._edges.size();r++){var n=this._edges.get(r),i=n.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return n;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return n}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var r=e.next();if(r.getEdge()===t)return r}return null}addEdges(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this._edges.add(r);var n=new OJ(r,!0),i=new OJ(r,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(var r=0;r<this._edges.size();r++){var n=this._edges.get(r),i=n.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return n}return null}getClass(){return TJ}get interfaces_(){return[]}}TJ.constructor_=function(){if(this._edges=new tK,this._nodes=null,this._edgeEndList=new tK,0===arguments.length)this._nodes=new K$(new CJ);else if(1===arguments.length){let t=arguments[0];this._nodes=new K$(t)}};class PJ extends TJ{constructor(){super(),PJ.constructor_.apply(this,arguments)}static determineBoundary(t,e){return t.isInBoundary(e)?R$.BOUNDARY:R$.INTERIOR}insertBoundaryPoint(t,e){var r=this._nodes.addNode(e).getLabel(),n=1;R$.NONE;r.getLocation(t,q$.ON)===R$.BOUNDARY&&n++;var i=PJ.determineBoundary(this._boundaryNodeRule,n);r.setLocation(t,i)}computeSelfNodes(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){let i=arguments[1],o=arguments[2];var t=new sJ(arguments[0],!0,!1);t.setIsDoneIfProperInt(o);var e=this.createEdgeSetIntersector(),r=this._parentGeom instanceof t$||this._parentGeom instanceof JK||this._parentGeom instanceof e$,n=i||!r;return e.computeIntersections(this._edges,t,n),this.addSelfIntersectionNodes(this._argIndex),t}}computeSplitEdges(t){for(var e=this._edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}}computeEdgeIntersections(t,e,r){var n=new sJ(e,r,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof qK){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,R$.INTERIOR)}else if(arguments[0]instanceof jZ){let t=arguments[0];this.insertPoint(this._argIndex,t,R$.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),R$.EXTERIOR,R$.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var r=t.getInteriorRingN(e);this.addPolygonRing(r,R$.INTERIOR,R$.EXTERIOR)}}addEdge(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],R$.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],R$.BOUNDARY)}addLineString(t){var e=oK.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var r=new IJ(e,new W$(this._argIndex,R$.INTERIOR));this._lineEdgeMap.put(t,r),this.insertEdge(r),DZ.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),r=0,n=t.iterator();n.hasNext();){var i=n.next();e[r++]=i.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,r){if(this.isBoundaryNode(t,e))return null;r===R$.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,r)}addPolygonRing(t,e,r){if(t.isEmpty())return null;var n=oK.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var i=e,o=r;KK.isCCW(n)&&(i=r,o=e);var s=new IJ(n,new W$(this._argIndex,R$.BOUNDARY,i,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,n[0],R$.BOUNDARY)}insertPoint(t,e,r){var n=this._nodes.addNode(e),i=n.getLabel();null===i?n._label=new W$(t,r):i.setLocation(t,r)}createEdgeSetIntersector(){return new aJ}addSelfIntersectionNodes(t){for(var e=this._edges.iterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,n)}}add(){if(!(1===arguments.length&&arguments[0]instanceof UZ))return super.add.apply(this,arguments);{let t=arguments[0];if(t.isEmpty())return null;if(t instanceof e$&&(this._useBoundaryDeterminationRule=!1),t instanceof JK)this.addPolygon(t);else if(t instanceof BK)this.addLineString(t);else if(t instanceof qK)this.addPoint(t);else if(t instanceof QK)this.addCollection(t);else if(t instanceof RK)this.addCollection(t);else if(t instanceof e$)this.addCollection(t);else{if(!(t instanceof PK))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}}}addCollection(t){for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);this.add(r)}}locate(t){return EZ(this._parentGeom,$K)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new mJ(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof BK){let t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}getClass(){return PJ}get interfaces_(){return[]}}PJ.constructor_=function(){if(this._parentGeom=null,this._lineEdgeMap=new y$,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new z$,2===arguments.length){let t=arguments[0],e=arguments[1];PJ.constructor_.call(this,t,e,VZ.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=r,null!==e&&this.add(e)}};class RJ extends V${constructor(){super(),RJ.constructor_.apply(this,arguments)}insert(t){this._edgeEnds.add(t)}print(t){t.println("EdgeEndBundle--\x3e Label: "+this._label);for(var e=this.iterator();e.hasNext();){e.next().print(t),t.println()}}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(t,e){for(var r=0,n=!1,i=this.iterator();i.hasNext();){(o=i.next().getLabel().getLocation(t))===R$.BOUNDARY&&r++,o===R$.INTERIOR&&(n=!0)}var o=R$.NONE;n&&(o=R$.INTERIOR),r>0&&(o=PJ.determineBoundary(e,r)),this._label.setLocation(t,o)}computeLabelSide(t,e){for(var r=this.iterator();r.hasNext();){var n=r.next();if(n.getLabel().isArea()){var i=n.getLabel().getLocation(t,e);if(i===R$.INTERIOR)return this._label.setLocation(t,e,R$.INTERIOR),null;i===R$.EXTERIOR&&this._label.setLocation(t,e,R$.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(t){this.computeLabelSide(t,q$.LEFT),this.computeLabelSide(t,q$.RIGHT)}updateIM(t){IJ.updateIM(this._label,t)}computeLabel(t){for(var e=!1,r=this.iterator();r.hasNext();){r.next().getLabel().isArea()&&(e=!0)}this._label=e?new W$(R$.NONE,R$.NONE,R$.NONE):new W$(R$.NONE);for(var n=0;n<2;n++)this.computeLabelOn(n,t),e&&this.computeLabelSides(n)}getClass(){return RJ}get interfaces_(){return[]}}RJ.constructor_=function(){if(this._edgeEnds=new tK,1===arguments.length){let t=arguments[0];RJ.constructor_.call(this,null,t)}else if(2===arguments.length){let t=arguments[1];V$.constructor_.call(this,t.getEdge(),t.getCoordinate(),t.getDirectedCoordinate(),new W$(t.getLabel())),this.insert(t)}};class LJ extends tJ{constructor(){super(),LJ.constructor_.apply(this,arguments)}updateIM(t){for(var e=this.iterator();e.hasNext();){e.next().updateIM(t)}}insert(t){var e=this._edgeMap.get(t);null===e?(e=new RJ(t),this.insertEdgeEnd(t,e)):e.insert(t)}getClass(){return LJ}get interfaces_(){return[]}}LJ.constructor_=function(){};class MJ extends Z${constructor(){super(),MJ.constructor_.apply(this,arguments)}updateIMFromEdges(t){this._edges.updateIM(t)}computeIM(t){t.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}getClass(){return MJ}get interfaces_(){return[]}}MJ.constructor_=function(){let t=arguments[0],e=arguments[1];Z$.constructor_.call(this,t,e)};class kJ extends CJ{constructor(){super(),kJ.constructor_.apply(this,arguments)}createNode(t){return new MJ(t,new LJ)}getClass(){return kJ}get interfaces_(){return[]}}kJ.constructor_=function(){};class NJ{constructor(){NJ.constructor_.apply(this,arguments)}insertEdgeEnds(t){for(var e=t.iterator();e.hasNext();){var r=e.next();this._nodes.add(r)}}computeProperIntersectionIM(t,e){var r=this._arg[0].getGeometry().getDimension(),n=this._arg[1].getGeometry().getDimension(),i=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===r&&2===n?i&&e.setAtLeast("212101212"):2===r&&1===n?(i&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===r&&2===n?(i&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===r&&1===n&&o&&e.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(t,e){for(var r=this._arg[t].getEdgeIterator();r.hasNext();){var n=r.next();n.isIsolated()&&(this.labelIsolatedEdge(n,e,this._arg[e].getGeometry()),this._isolatedEdges.add(n))}}labelIsolatedEdge(t,e,r){if(r.getDimension()>0){var n=this._ptLocator.locate(t.getCoordinate(),r);t.getLabel().setAllLocations(e,n)}else t.getLabel().setAllLocations(e,R$.EXTERIOR)}computeIM(){var t=new U$;if(t.set(R$.EXTERIOR,R$.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);var e=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var r=new X$,n=r.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(n);var i=r.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(i),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t}labelNodeEdges(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().computeLabelling(this._arg)}}copyNodesAndLabels(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var r=e.next();this._nodes.addNode(r.getCoordinate()).setLabel(t,r.getLabel().getLocation(t))}}labelIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),s=this._nodes.find(o.coord);s.getLabel().isNull(t)&&(n===R$.BOUNDARY?s.setLabelBoundary(t):s.setLabel(t,R$.INTERIOR))}}labelIsolatedNode(t,e){var r=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setAllLocations(e,r)}computeIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var r=e.next(),n=r.getLabel().getLocation(t),i=r.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),s=this._nodes.addNode(o.coord);n===R$.BOUNDARY?s.setLabelBoundary(t):s.getLabel().isNull(t)&&s.setLabel(t,R$.INTERIOR)}}labelIsolatedNodes(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next(),r=e.getLabel();DZ.isTrue(r.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(r.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}}updateIM(t){for(var e=this._isolatedEdges.iterator();e.hasNext();){e.next().updateIM(t)}for(var r=this._nodes.iterator();r.hasNext();){var n=r.next();n.updateIM(t),n.updateIMFromEdges(t)}}computeDisjointIM(t){var e=this._arg[0].getGeometry();e.isEmpty()||(t.set(R$.INTERIOR,R$.EXTERIOR,e.getDimension()),t.set(R$.BOUNDARY,R$.EXTERIOR,e.getBoundaryDimension()));var r=this._arg[1].getGeometry();r.isEmpty()||(t.set(R$.EXTERIOR,R$.INTERIOR,r.getDimension()),t.set(R$.EXTERIOR,R$.BOUNDARY,r.getBoundaryDimension()))}getClass(){return NJ}get interfaces_(){return[]}}NJ.constructor_=function(){this._li=new F$,this._ptLocator=new z$,this._arg=null,this._nodes=new K$(new kJ),this._im=null,this._isolatedEdges=new tK,this._invalidPoint=null;let t=arguments[0];this._arg=t};class AJ{constructor(){AJ.constructor_.apply(this,arguments)}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}getClass(){return AJ}get interfaces_(){return[]}}AJ.constructor_=function(){if(this._li=new F$,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){let t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new PJ(0,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];AJ.constructor_.call(this,t,e,VZ.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new PJ(0,t,r),this._arg[1]=new PJ(1,e,r)}};class FJ{constructor(){FJ.constructor_.apply(this,arguments)}static contains(t,e){return new FJ(t).contains(e)}isContainedInBoundary(t){if(t instanceof JK)return!1;if(t instanceof qK)return this.isPointContainedInBoundary(t);if(t instanceof BK)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var r=t.getGeometryN(e);if(!this.isContainedInBoundary(r))return!1}return!0}isLineSegmentContainedInBoundary(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(t){for(var e=t.getCoordinateSequence(),r=new jZ,n=new jZ,i=0;i<e.size()-1;i++)if(e.getCoordinate(i,r),e.getCoordinate(i+1,n),!this.isLineSegmentContainedInBoundary(r,n))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof qK){let t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof jZ){let t=arguments[0];return t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX()||t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()}}contains(t){return!!this._rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)}getClass(){return FJ}get interfaces_(){return[]}}FJ.constructor_=function(){this._rectEnv=null;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal()};class DJ{constructor(){DJ.constructor_.apply(this,arguments)}intersects(t,e){var r=new zZ(t,e);if(!this._rectEnv.intersects(r))return!1;if(this._rectEnv.intersects(t))return!0;if(this._rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var n=t;t=e,e=n}var i=!1;return e.y>t.y&&(i=!0),i?this._li.computeIntersection(t,e,this._diagDown0,this._diagDown1):this._li.computeIntersection(t,e,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}getClass(){return DJ}get interfaces_(){return[]}}DJ.constructor_=function(){this._li=new F$,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;let t=arguments[0];this._rectEnv=t,this._diagUp0=new jZ(t.getMinX(),t.getMinY()),this._diagUp1=new jZ(t.getMaxX(),t.getMaxY()),this._diagDown0=new jZ(t.getMinX(),t.getMaxY()),this._diagDown1=new jZ(t.getMaxX(),t.getMinY())};class jJ{constructor(){jJ.constructor_.apply(this,arguments)}applyTo(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var r=t.getGeometryN(e);if(r instanceof PK)this.applyTo(r);else if(this.visit(r),this.isDone())return this._isDone=!0,null}}getClass(){return jJ}get interfaces_(){return[]}}jJ.constructor_=function(){this._isDone=!1};class GJ{constructor(){GJ.constructor_.apply(this,arguments)}static intersects(t,e){return new GJ(t).intersects(e)}intersects(t){if(!this._rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new zJ(this._rectEnv);if(e.applyTo(t),e.intersects())return!0;var r=new UJ(this._rectangle);if(r.applyTo(t),r.containsPoint())return!0;var n=new BJ(this._rectangle);return n.applyTo(t),!!n.intersects()}getClass(){return GJ}get interfaces_(){return[]}}GJ.constructor_=function(){this._rectangle=null,this._rectEnv=null;let t=arguments[0];this._rectangle=t,this._rectEnv=t.getEnvelopeInternal()};class zJ extends jJ{constructor(){super(),zJ.constructor_.apply(this,arguments)}isDone(){return!0===this._intersects}visit(t){var e=t.getEnvelopeInternal();return this._rectEnv.intersects(e)?this._rectEnv.contains(e)||e.getMinX()>=this._rectEnv.getMinX()&&e.getMaxX()<=this._rectEnv.getMaxX()||e.getMinY()>=this._rectEnv.getMinY()&&e.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}intersects(){return this._intersects}getClass(){return zJ}get interfaces_(){return[]}}zJ.constructor_=function(){this._rectEnv=null,this._intersects=!1;let t=arguments[0];this._rectEnv=t};class UJ extends jJ{constructor(){super(),UJ.constructor_.apply(this,arguments)}isDone(){return!0===this._containsPoint}visit(t){if(!(t instanceof JK))return null;var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;for(var r=new jZ,n=0;n<4;n++)if(this._rectSeq.getCoordinate(n,r),e.contains(r)&&Q$.containsPointInPolygon(r,t))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}getClass(){return UJ}get interfaces_(){return[]}}UJ.constructor_=function(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;let t=arguments[0];this._rectSeq=t.getExteriorRing().getCoordinateSequence(),this._rectEnv=t.getEnvelopeInternal()};class BJ extends jJ{constructor(){super(),BJ.constructor_.apply(this,arguments)}intersects(){return this._hasIntersection}isDone(){return!0===this._hasIntersection}visit(t){var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;var r=gJ.getLines(t);this.checkIntersectionWithLineStrings(r)}checkIntersectionWithLineStrings(t){for(var e=t.iterator();e.hasNext();){var r=e.next();if(this.checkIntersectionWithSegments(r),this._hasIntersection)return null}}checkIntersectionWithSegments(t){for(var e=t.getCoordinateSequence(),r=1;r<e.size();r++)if(e.getCoordinate(r-1,this._p0),e.getCoordinate(r,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}getClass(){return BJ}get interfaces_(){return[]}}BJ.constructor_=function(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new jZ,this._p1=new jZ;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal(),this._rectIntersector=new DJ(this._rectEnv)};class VJ extends AJ{constructor(){super(),VJ.constructor_.apply(this,arguments)}static covers(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&(!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&(!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||new VJ(t,e).getIntersectionMatrix().isCovers())))}static intersects(t,e){if(!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal()))return!1;if(t.isRectangle())return GJ.intersects(t,e);if(e.isRectangle())return GJ.intersects(e,t);if(t.isGeometryCollection()||e.isGeometryCollection()){for(var r=0;r<t.getNumGeometries();r++)for(var n=0;n<e.getNumGeometries();n++)if(t.getGeometryN(r).intersects(e.getGeometryN(n)))return!0;return!1}return new VJ(t,e).getIntersectionMatrix().isIntersects()}static touches(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new VJ(t,e).getIntersectionMatrix().isTouches(t.getDimension(),e.getDimension())}static relate(){if(2===arguments.length){return new VJ(arguments[0],arguments[1]).getIntersectionMatrix()}if(3===arguments.length){return new VJ(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix()}}static overlaps(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new VJ(t,e).getIntersectionMatrix().isOverlaps(t.getDimension(),e.getDimension())}static crosses(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new VJ(t,e).getIntersectionMatrix().isCrosses(t.getDimension(),e.getDimension())}static contains(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&(!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&(!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?FJ.contains(t,e):new VJ(t,e).getIntersectionMatrix().isContains())))}getIntersectionMatrix(){return this._relate.computeIM()}getClass(){return VJ}get interfaces_(){return[]}}function qJ(t){return function(t){if(Array.isArray(t))return YJ(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return YJ(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YJ(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YJ(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}VJ.constructor_=function(){if(this._relate=null,2===arguments.length){let t=arguments[0],e=arguments[1];AJ.constructor_.call(this,t,e),this._relate=new NJ(this._arg)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];AJ.constructor_.call(this,t,e,r),this._relate=new NJ(this._arg)}};var WJ=function(t){var e=t,r=[];return e instanceof UC?r=qJ(e.getFeatures().map((function(t){return t.getGeometry()}))):(mV(e)||(e=[e]),r=e.map((function(t){var e;return t instanceof mq?e=t.getGeometry():bV(t)&&(e=t),e}))),r},XJ=function(t,e){var r="",n=new LY;return e.forEach((function(e,i){0!==i&&(r+=" OR ");var o=e;"point"===o.type.toLowerCase()&&(o.coordinates.length=2);var s=n.write(o);r+="".concat(t,"({{geometryName}}, ").concat(s,")")})),r},HJ=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZJ=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],KJ="enterfullscreen",$J="leavefullscreen";function JJ(){var t=document.body;return!!(t.webkitRequestFullscreen||t.msRequestFullscreen&&document.msFullscreenEnabled||t.requestFullscreen&&document.fullscreenEnabled)}function QJ(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function tQ(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}var eQ=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{element:document.createElement("div"),target:n.target})||this).on,r.once,r.un,r.cssClassName_=void 0!==n.className?n.className:"ol-full-screen",r.activeClassName_=void 0!==n.activeClassName?n.activeClassName.split(" "):[r.cssClassName_+"-true"],r.inactiveClassName_=void 0!==n.inactiveClassName?n.inactiveClassName.split(" "):[r.cssClassName_+"-false"];var i=void 0!==n.label?n.label:"⤢";r.labelNode_="string"==typeof i?document.createTextNode(i):i;var o=void 0!==n.labelActive?n.labelActive:"×";r.labelActiveNode_="string"==typeof o?document.createTextNode(o):o,r.button_=document.createElement("button");var s=n.tipLabel?n.tipLabel:"Toggle full-screen";r.setClassName_(r.button_,QJ()),r.button_.setAttribute("type","button"),r.button_.title=s,r.button_.appendChild(r.labelNode_),r.button_.addEventListener(ea,r.handleClick_.bind(r),!1);var a=r.cssClassName_+" "+"ol-unselectable "+"ol-control "+(JJ()?"":"ol-unsupported"),l=r.element;return l.className=a,l.appendChild(r.button_),r.keys_=void 0!==n.keys&&n.keys,r.source_=n.source,r}return HJ(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleFullScreen_()},e.prototype.handleFullScreen_=function(){if(JJ()){var t=this.getMap();if(t)if(QJ())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{var e=void 0;e=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:t.getTargetElement(),this.keys_?function(t){t.webkitRequestFullscreen?t.webkitRequestFullscreen():tQ(t)}(e):tQ(e)}}},e.prototype.handleFullScreenChange_=function(){var t=this.getMap();QJ()?(this.setClassName_(this.button_,!0),ll(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(KJ)):(this.setClassName_(this.button_,!1),ll(this.labelNode_,this.labelActiveNode_),this.dispatchEvent($J)),t&&t.updateSize()},e.prototype.setClassName_=function(t,e){var r,n,i,o=this.activeClassName_,s=this.inactiveClassName_,a=e?o:s;(r=t.classList).remove.apply(r,o),(n=t.classList).remove.apply(n,s),(i=t.classList).add.apply(i,a)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e)for(var r=0,n=ZJ.length;r<n;++r)this.listenerKeys.push(fa(document,ZJ[r],this.handleFullScreenChange_,this))},e}(Xc),rQ=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),nQ=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{element:document.createElement("div"),target:n.target})||this).extent=n.extent?n.extent:null;var i=void 0!==n.className?n.className:"ol-zoom-extent",o=void 0!==n.label?n.label:"E",s=void 0!==n.tipLabel?n.tipLabel:"Fit to extent",a=document.createElement("button");a.setAttribute("type","button"),a.title=s,a.appendChild("string"==typeof o?document.createTextNode(o):o),a.addEventListener(ea,r.handleClick_.bind(r),!1);var l=i+" "+"ol-unselectable "+Qa,u=r.element;return u.className=l,u.appendChild(a),r}return rQ(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal(Mc(e))},e}(Xc),iQ=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),oQ={};oQ[Yt.POINT]=function(t){var e;e=void 0!==t.m&&void 0!==t.z?new dc([t.x,t.y,t.z,t.m],Du):void 0!==t.z?new dc([t.x,t.y,t.z],Au):void 0!==t.m?new dc([t.x,t.y,t.m],Fu):new dc([t.x,t.y]);return e},oQ[Yt.LINE_STRING]=function(t){var e=lQ(t);return new Fg(t.paths[0],e)},oQ[Yt.POLYGON]=function(t){var e=lQ(t);return new Rc(t.rings,e)},oQ[Yt.MULTI_POINT]=function(t){var e=lQ(t);return new jg(t.points,e)},oQ[Yt.MULTI_LINE_STRING]=function(t){var e=lQ(t);return new zg(t.paths,e)},oQ[Yt.MULTI_POLYGON]=function(t){var e=lQ(t);return new Bg(t.rings,e)};var sQ={};function aQ(t,e){var r,n,i;if(!t)return null;if("number"==typeof t.x&&"number"==typeof t.y)i=Yt.POINT;else if(t.points)i=Yt.MULTI_POINT;else if(t.paths){i=1===t.paths.length?Yt.LINE_STRING:Yt.MULTI_LINE_STRING}else if(t.rings){var o=t,s=lQ(o),a=function(t,e){var r,n,i=[],o=[],s=[];for(r=0,n=t.length;r<n;++r){i.length=0,Qu(i,0,t[r],e.length),Sc(i,0,i.length,e.length)?o.push([t[r]]):s.push(t[r])}for(;s.length;){var a=s.shift(),l=!1;for(r=o.length-1;r>=0;r--){var u=o[r][0];if(gt(new fc(u).getExtent(),new fc(a).getExtent())){o[r].push(a),l=!0;break}}l||o.push([a.reverse()])}return o}(o.rings,s);1===a.length?(i=Yt.POLYGON,t=V({},t,((r={}).rings=a[0],r))):(i=Yt.MULTI_POLYGON,t=V({},t,((n={}).rings=a,n)))}return NL((0,oQ[i])(t),!1,e)}function lQ(t){var e=Nu;return!0===t.hasZ&&!0===t.hasM?e=Du:!0===t.hasZ?e=Au:!0===t.hasM&&(e=Fu),e}function uQ(t){var e=t.getLayout();return{hasZ:e===Au||e===Du,hasM:e===Fu||e===Du}}function cQ(t,e){return(0,sQ[t.getType()])(NL(t,!0,e),e)}sQ[Yt.POINT]=function(t,e){var r,n=t.getCoordinates(),i=t.getLayout();i===Au?r={x:n[0],y:n[1],z:n[2]}:i===Fu?r={x:n[0],y:n[1],m:n[2]}:i===Du?r={x:n[0],y:n[1],z:n[2],m:n[3]}:i===Nu?r={x:n[0],y:n[1]}:ut(!1,34);return r},sQ[Yt.LINE_STRING]=function(t,e){var r=uQ(t);return{hasZ:r.hasZ,hasM:r.hasM,paths:[t.getCoordinates()]}},sQ[Yt.POLYGON]=function(t,e){var r=uQ(t);return{hasZ:r.hasZ,hasM:r.hasM,rings:t.getCoordinates(!1)}},sQ[Yt.MULTI_POINT]=function(t,e){var r=uQ(t);return{hasZ:r.hasZ,hasM:r.hasM,points:t.getCoordinates()}},sQ[Yt.MULTI_LINE_STRING]=function(t,e){var r=uQ(t);return{hasZ:r.hasZ,hasM:r.hasM,paths:t.getCoordinates()}},sQ[Yt.MULTI_POLYGON]=function(t,e){for(var r=uQ(t),n=t.getCoordinates(!1),i=[],o=0;o<n.length;o++)for(var s=n[o].length-1;s>=0;s--)i.push(n[o][s]);return{hasZ:r.hasZ,hasM:r.hasM,rings:i}};var hQ=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this)||this).geometryName_=n.geometryName,r}return iQ(e,t),e.prototype.readFeatureFromObject=function(t,e,r){var n=t,i=aQ(n.geometry,e),o=new Cg;if(this.geometryName_&&o.setGeometryName(this.geometryName_),o.setGeometry(i),n.attributes){o.setProperties(n.attributes,!0);var s=n.attributes[r];void 0!==s&&o.setId(s)}return o},e.prototype.readFeaturesFromObject=function(t,e){var r=e||{};if(t.features){for(var n=[],i=t.features,o=0,s=i.length;o<s;++o)n.push(this.readFeatureFromObject(i[o],r,t.objectIdFieldName));return n}return[this.readFeatureFromObject(t,r)]},e.prototype.readGeometryFromObject=function(t,e){return aQ(t,e)},e.prototype.readProjectionFromObject=function(t){return t.spatialReference&&void 0!==t.spatialReference.wkid?ye("EPSG:"+t.spatialReference.wkid):null},e.prototype.writeGeometryObject=function(t,e){return cQ(t,this.adaptOptions(e))},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var r={};if(!t.hasProperties())return r.attributes={},r;var n=t.getProperties(),i=t.getGeometry();if(i){r.geometry=cQ(i,e);var o=e&&(e.dataProjection||e.featureProjection);o&&(r.geometry.spatialReference={wkid:Number(ye(o).getCode().split(":").pop())}),delete n[t.getGeometryName()]}return W(n)?r.attributes={}:r.attributes=n,r},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var r=[],n=0,i=t.length;n<i;++n)r.push(this.writeFeatureObject(t[n],e));return{features:r}},e}(uj),fQ=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pQ=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],dQ={rte:BQ,trk:VQ,wpt:qQ},gQ=cr(pQ,{rte:er(BQ),trk:er(VQ),wpt:er(qQ)}),yQ=cr(pQ,{text:ir(Cr,"linkText"),type:ir(Cr,"linkType")}),mQ=cr(pQ,{rte:or((function(t,e,r){var n=r[0],i=e.getProperties(),o={node:t};o.properties=i;var s=e.getGeometry();if(s.getType()==Yt.LINE_STRING){var a=NL(s,!0,n);o.geometryLayout=a.getLayout(),i.rtept=a.getCoordinates()}var l=r[r.length-1].node,u=CQ[l.namespaceURI],c=ur(i,u);dr(o,TQ,lr,c,r,u)})),trk:or((function(t,e,r){var n=r[0],i=e.getProperties(),o={node:t};o.properties=i;var s=e.getGeometry();if(s.getType()==Yt.MULTI_LINE_STRING){var a=NL(s,!0,n);i.trkseg=a.getLineStrings()}var l=r[r.length-1].node,u=RQ[l.namespaceURI],c=ur(i,u);dr(o,LQ,lr,c,r,u)})),wpt:or((function(t,e,r){var n=r[0],i=r[r.length-1];i.properties=e.getProperties();var o=e.getGeometry();if(o.getType()==Yt.POINT){var s=NL(o,!0,n);i.geometryLayout=s.getLayout(),WQ(t,s.getCoordinates(),r)}}))}),_Q=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.dataProjection=ye("EPSG:4326"),r.readExtensions_=n.readExtensions,r}return fQ(e,t),e.prototype.handleReadExtensions_=function(t){t||(t=[]);for(var e=0,r=t.length;e<r;++e){var n=t[e];if(this.readExtensions_){var i=n.get("extensionsNode_")||null;this.readExtensions_(n,i)}n.set("extensionsNode_",void 0)}},e.prototype.readFeatureFromNode=function(t,e){if(!Ue(pQ,t.namespaceURI))return null;var r=dQ[t.localName];if(!r)return null;var n=r(t,[this.getReadOptions(t,e)]);return n?(this.handleReadExtensions_([n]),n):null},e.prototype.readFeaturesFromNode=function(t,e){if(!Ue(pQ,t.namespaceURI))return[];if("gpx"==t.localName){var r=fr([],gQ,t,[this.getReadOptions(t,e)]);return r?(this.handleReadExtensions_(r),r):[]}return[]},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var r=Ze("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",He),r.setAttributeNS(He,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),dr({node:r},mQ,DQ,t,[e]),r},e}(DL),vQ=cr(pQ,{name:ir(Cr),cmt:ir(Cr),desc:ir(Cr),src:ir(Cr),link:zQ,number:ir(Ir),extensions:UQ,type:ir(Cr),rtept:function(t,e){var r=fr({},bQ,t,e);if(r){var n=e[e.length-1],i=n.flatCoordinates,o=n.layoutOptions;jQ(i,o,t,r)}}}),bQ=cr(pQ,{ele:ir(Er),time:ir(xr)}),wQ=cr(pQ,{name:ir(Cr),cmt:ir(Cr),desc:ir(Cr),src:ir(Cr),link:zQ,number:ir(Ir),type:ir(Cr),extensions:UQ,trkseg:function(t,e){var r=e[e.length-1];hr(xQ,t,e);var n=r.flatCoordinates;r.ends.push(n.length)}}),xQ=cr(pQ,{trkpt:function(t,e){var r=fr({},EQ,t,e);if(r){var n=e[e.length-1],i=n.flatCoordinates,o=n.layoutOptions;jQ(i,o,t,r)}}}),EQ=cr(pQ,{ele:ir(Er),time:ir(xr)}),SQ=cr(pQ,{ele:ir(Er),time:ir(xr),magvar:ir(Er),geoidheight:ir(Er),name:ir(Cr),cmt:ir(Cr),desc:ir(Cr),src:ir(Cr),link:zQ,sym:ir(Cr),type:ir(Cr),fix:ir(Cr),sat:ir(Ir),hdop:ir(Er),vdop:ir(Er),pdop:ir(Er),ageofdgpsdata:ir(Er),dgpsid:ir(Ir),extensions:UQ}),IQ=["text","type"],OQ=cr(pQ,{text:or(Lr),type:or(Lr)}),CQ=cr(pQ,["name","cmt","desc","src","link","number","type","rtept"]),TQ=cr(pQ,{name:or(Lr),cmt:or(Lr),desc:or(Lr),src:or(Lr),link:or(YQ),number:or(Rr),type:or(Lr),rtept:sr(or(WQ))}),PQ=cr(pQ,["ele","time"]),RQ=cr(pQ,["name","cmt","desc","src","link","number","type","trkseg"]),LQ=cr(pQ,{name:or(Lr),cmt:or(Lr),desc:or(Lr),src:or(Lr),link:or(YQ),number:or(Rr),type:or(Lr),trkseg:sr(or((function(t,e,r){var n={node:t};n.geometryLayout=e.getLayout(),n.properties={},dr(n,kQ,MQ,e.getCoordinates(),r)})))}),MQ=ar("trkpt"),kQ=cr(pQ,{trkpt:or(WQ)}),NQ=cr(pQ,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),AQ=cr(pQ,{ele:or(Pr),time:or((function(t,e){var r=new Date(1e3*e),n=r.getUTCFullYear()+"-"+$t(r.getUTCMonth()+1,2)+"-"+$t(r.getUTCDate(),2)+"T"+$t(r.getUTCHours(),2)+":"+$t(r.getUTCMinutes(),2)+":"+$t(r.getUTCSeconds(),2)+"Z";t.appendChild(mr().createTextNode(n))})),magvar:or(Pr),geoidheight:or(Pr),name:or(Lr),cmt:or(Lr),desc:or(Lr),src:or(Lr),link:or(YQ),sym:or(Lr),type:or(Lr),fix:or(Lr),sat:or(Rr),hdop:or(Pr),vdop:or(Pr),pdop:or(Pr),ageofdgpsdata:or(Pr),dgpsid:or(Rr)}),FQ={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function DQ(t,e,r){var n=t.getGeometry();if(n){var i=FQ[n.getType()];if(i)return Ze(e[e.length-1].node.namespaceURI,i)}}function jQ(t,e,r,n){return t.push(parseFloat(r.getAttribute("lon")),parseFloat(r.getAttribute("lat"))),"ele"in n?(t.push(n.ele),delete n.ele,e.hasZ=!0):t.push(0),"time"in n?(t.push(n.time),delete n.time,e.hasM=!0):t.push(0),t}function GQ(t,e,r){var n=Nu,i=2;if(t.hasZ&&t.hasM?(n=Du,i=4):t.hasZ?(n=Au,i=3):t.hasM&&(n=Fu,i=3),4!==i){for(var o=0,s=e.length/4;o<s;o++)e[o*i]=e[4*o],e[o*i+1]=e[4*o+1],t.hasZ&&(e[o*i+2]=e[4*o+2]),t.hasM&&(e[o*i+2]=e[4*o+3]);if(e.length=e.length/4*i,r)for(o=0,s=r.length;o<s;o++)r[o]=r[o]/4*i}return n}function zQ(t,e){var r=e[e.length-1],n=t.getAttribute("href");null!==n&&(r.link=n),hr(yQ,t,e)}function UQ(t,e){e[e.length-1].extensionsNode_=t}function BQ(t,e){var r=e[0],n=fr({flatCoordinates:[],layoutOptions:{}},vQ,t,e);if(n){var i=n.flatCoordinates;delete n.flatCoordinates;var o=n.layoutOptions;delete n.layoutOptions;var s=GQ(o,i),a=new Fg(i,s);NL(a,!1,r);var l=new Cg(a);return l.setProperties(n,!0),l}}function VQ(t,e){var r=e[0],n=fr({flatCoordinates:[],ends:[],layoutOptions:{}},wQ,t,e);if(n){var i=n.flatCoordinates;delete n.flatCoordinates;var o=n.ends;delete n.ends;var s=n.layoutOptions;delete n.layoutOptions;var a=GQ(s,i,o),l=new zg(i,a,o);NL(l,!1,r);var u=new Cg(l);return u.setProperties(n,!0),u}}function qQ(t,e){var r=e[0],n=fr({},SQ,t,e);if(n){var i={},o=jQ([],i,t,n),s=GQ(i,o),a=new dc(o,s);NL(a,!1,r);var l=new Cg(a);return l.setProperties(n,!0),l}}function YQ(t,e,r){t.setAttribute("href",e);var n=r[r.length-1].properties,i=[n.linkText,n.linkType];dr({node:t},OQ,lr,i,r,IQ)}function WQ(t,e,r){var n=r[r.length-1],i=n.node.namespaceURI,o=n.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),n.geometryLayout){case Du:0!==e[3]&&(o.time=e[3]);case Au:0!==e[2]&&(o.ele=e[2]);break;case Fu:0!==e[2]&&(o.time=e[2])}var s="rtept"==t.nodeName?PQ[i]:NQ[i],a=ur(o,s);dr({node:t,properties:o},AQ,lr,a,r,s)}var XQ=_Q,HQ=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ZQ="barometric",KQ="gps",$Q="none",JQ=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,QQ=/^H.([A-Z]{3}).*?:(.*)/,t0=/^HFDTE(\d{2})(\d{2})(\d{2})/,e0=/\r\n|\r|\n/,r0=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.dataProjection=ye("EPSG:4326"),r.altitudeMode_=n.altitudeMode?n.altitudeMode:$Q,r}return HQ(e,t),e.prototype.readFeatureFromText=function(t,e){var r,n,i=this.altitudeMode_,o=t.split(e0),s={},a=[],l=2e3,u=0,c=1,h=-1;for(r=0,n=o.length;r<n;++r){var f=o[r],p=void 0;if("B"==f.charAt(0)){if(p=JQ.exec(f)){var d=parseInt(p[1],10),g=parseInt(p[2],10),y=parseInt(p[3],10),m=parseInt(p[4],10)+parseInt(p[5],10)/6e4;"S"==p[6]&&(m=-m);var _=parseInt(p[7],10)+parseInt(p[8],10)/6e4;if("W"==p[9]&&(_=-_),a.push(_,m),i!=$Q){var v=void 0;v=i==KQ?parseInt(p[11],10):i==ZQ?parseInt(p[12],10):0,a.push(v)}var b=Date.UTC(l,u,c,d,g,y);b<h&&(b=Date.UTC(l,u,c+1,d,g,y)),a.push(b/1e3),h=b}}else"H"==f.charAt(0)&&((p=t0.exec(f))?(c=parseInt(p[1],10),u=parseInt(p[2],10)-1,l=2e3+parseInt(p[3],10)):(p=QQ.exec(f))&&(s[p[1]]=p[2].trim()))}if(0===a.length)return null;var w=new Fg(a,i==$Q?Fu:Du),x=new Cg(NL(w,!1,e));return x.setProperties(s,!0),x},e.prototype.readFeaturesFromText=function(t,e){var r=this.readFeatureFromText(t,e);return r?[r]:[]},e}(Hq),n0=function(t,e){for(var r=0,n=e.length,i=t.length;r<n;r++,i++)t[i]=e[r];return t},i0="version1",o0="version2",s0="version3",a0={};a0[i0]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},a0[o0]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},a0[s0]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},a0.none={none:{supports:[],formats:[],qualities:[]}};var l0=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,u0=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,c0=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/;var h0={};h0[i0]=function(t){var e=t.getComplianceLevelSupportedFeatures();return void 0===e&&(e=a0[i0].level0),{url:void 0===t.imageInfo["@id"]?void 0:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:e.supports,formats:n0(n0([],e.formats),[void 0===t.imageInfo.formats?[]:t.imageInfo.formats]),qualities:n0(n0([],e.qualities),[void 0===t.imageInfo.qualities?[]:t.imageInfo.qualities]),resolutions:t.imageInfo.scale_factors,tileSize:void 0!==t.imageInfo.tile_width?void 0!==t.imageInfo.tile_height?[t.imageInfo.tile_width,t.imageInfo.tile_height]:[t.imageInfo.tile_width,t.imageInfo.tile_width]:null!=t.imageInfo.tile_height?[t.imageInfo.tile_height,t.imageInfo.tile_height]:void 0}},h0[o0]=function(t){var e=t.getComplianceLevelSupportedFeatures(),r=Array.isArray(t.imageInfo.profile)&&t.imageInfo.profile.length>1,n=r&&t.imageInfo.profile[1].supports?t.imageInfo.profile[1].supports:[],i=r&&t.imageInfo.profile[1].formats?t.imageInfo.profile[1].formats:[],o=r&&t.imageInfo.profile[1].qualities?t.imageInfo.profile[1].qualities:[];return{url:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map((function(t){return[t.width,t.height]})),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map((function(t){return t.width}))[0],t.imageInfo.tiles.map((function(t){return void 0===t.height?t.width:t.height}))[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map((function(t){return t.scaleFactors}))[0],supports:n0(n0([],e.supports),n),formats:n0(n0([],e.formats),i),qualities:n0(n0([],e.qualities),o)}},h0[s0]=function(t){var e=t.getComplianceLevelSupportedFeatures(),r=void 0===t.imageInfo.extraFormats?e.formats:n0(n0([],e.formats),t.imageInfo.extraFormats),n=void 0!==t.imageInfo.preferredFormats&&Array.isArray(t.imageInfo.preferredFormats)&&t.imageInfo.preferredFormats.length>0?t.imageInfo.preferredFormats.filter((function(t){return Ue(["jpg","png","gif"],t)})).reduce((function(t,e){return void 0===t&&Ue(r,e)?e:t}),void 0):void 0;return{url:t.imageInfo.id,sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map((function(t){return[t.width,t.height]})),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map((function(t){return t.width}))[0],t.imageInfo.tiles.map((function(t){return t.height}))[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map((function(t){return t.scaleFactors}))[0],supports:void 0===t.imageInfo.extraFeatures?e.supports:n0(n0([],e.supports),t.imageInfo.extraFeatures),formats:r,qualities:void 0===t.imageInfo.extraQualities?e.qualities:n0(n0([],e.qualities),t.imageInfo.extraQualities),preferredFormat:n}};var f0=function(){function t(t){this.setImageInfo(t)}return t.prototype.setImageInfo=function(t){this.imageInfo="string"==typeof t?JSON.parse(t):t},t.prototype.getImageApiVersion=function(){if(void 0!==this.imageInfo){var t=this.imageInfo["@context"]||"ol-no-context";"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)switch(t[e]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return i0;case"http://iiif.io/api/image/2/context.json":return o0;case"http://iiif.io/api/image/3/context.json":return s0;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(i0)&&this.imageInfo.identifier)return i0}ut(!1,61)}},t.prototype.getComplianceLevelEntryFromProfile=function(t){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===t&&(t=this.getImageApiVersion()),t){case i0:if(l0.test(this.imageInfo.profile))return this.imageInfo.profile;break;case s0:if(c0.test(this.imageInfo.profile))return this.imageInfo.profile;break;case o0:if("string"==typeof this.imageInfo.profile&&u0.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&"string"==typeof this.imageInfo.profile[0]&&u0.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}},t.prototype.getComplianceLevelFromProfile=function(t){var e=this.getComplianceLevelEntryFromProfile(t);if(void 0!==e){var r=e.match(/level[0-2](?:\.json)?$/g);return Array.isArray(r)?r[0].replace(".json",""):void 0}},t.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var t=this.getImageApiVersion(),e=this.getComplianceLevelFromProfile(t);return void 0===e?a0.none.none:a0[t][e]}},t.prototype.getTileSourceOptions=function(t){var e=t||{},r=this.getImageApiVersion();if(void 0!==r){var n=void 0===r?void 0:h0[r](this);if(void 0!==n)return{url:n.url,version:r,size:[this.imageInfo.width,this.imageInfo.height],sizes:n.sizes,format:void 0!==e.format&&Ue(n.formats,e.format)?e.format:void 0!==n.preferredFormat?n.preferredFormat:"jpg",supports:n.supports,quality:e.quality&&Ue(n.qualities,e.quality)?e.quality:Ue(n.qualities,"native")?"native":"default",resolutions:Array.isArray(n.resolutions)?n.resolutions.sort((function(t,e){return e-t})):void 0,tileSize:n.tileSize}}},t}(),p0=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d0=[null],g0=cr(d0,{nd:function(t,e){e[e.length-1].ndrefs.push(t.getAttribute("ref"))},tag:v0}),y0=cr(d0,{node:function(t,e){var r=e[0],n=e[e.length-1],i=t.getAttribute("id"),o=[parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))];n.nodes[i]=o;var s=fr({tags:{}},_0,t,e);if(!W(s.tags)){var a=new dc(o);NL(a,!1,r);var l=new Cg(a);l.setId(i),l.setProperties(s.tags,!0),n.features.push(l)}},way:function(t,e){var r=fr({id:t.getAttribute("id"),ndrefs:[],tags:{}},g0,t,e);e[e.length-1].ways.push(r)}}),m0=function(t){function e(){var e=t.call(this)||this;return e.dataProjection=ye("EPSG:4326"),e}return p0(e,t),e.prototype.readFeaturesFromNode=function(t,e){var r=this.getReadOptions(t,e);if("osm"==t.localName){for(var n=fr({nodes:{},ways:[],features:[]},y0,t,[r]),i=0;i<n.ways.length;i++){for(var o=n.ways[i],s=[],a=0,l=o.ndrefs.length;a<l;a++){qe(s,n.nodes[o.ndrefs[a]])}var u=void 0;NL(u=o.ndrefs[0]==o.ndrefs[o.ndrefs.length-1]?new Rc(s,Nu,[s.length]):new Fg(s,Nu),!1,r);var c=new Cg(u);c.setId(o.id),c.setProperties(o.tags,!0),n.features.push(c)}if(n.features)return n.features}return[]},e}(DL),_0=cr(d0,{tag:v0});function v0(t,e){e[e.length-1].tags[t.getAttribute("k")]=t.getAttribute("v")}var b0=m0;function w0(t,e,r,n,i,o){var s,a;void 0!==i?(s=i,a=void 0!==o?o:0):(s=[],a=0);for(var l=e;l<r;){var u=t[l++];s[a++]=t[l++],s[a++]=u;for(var c=2;c<n;++c)s[a++]=t[l++]}return s.length=a,s}var x0=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function E0(t,e,r){var n,i=r||1e5,o=new Array(e);for(n=0;n<e;++n)o[n]=0;for(var s=0,a=t.length;s<a;)for(n=0;n<e;++n,++s){var l=t[s],u=l-o[n];o[n]=l,t[s]=u}return I0(t,i)}function S0(t,e,r){var n,i=r||1e5,o=new Array(e);for(n=0;n<e;++n)o[n]=0;for(var s=O0(t,i),a=0,l=s.length;a<l;)for(n=0;n<e;++n,++a)o[n]+=s[a],s[a]=o[n];return s}function I0(t,e){for(var r=e||1e5,n=0,i=t.length;n<i;++n)t[n]=Math.round(t[n]*r);return function(t){for(var e=0,r=t.length;e<r;++e){var n=t[e];t[e]=n<0?~(n<<1):n<<1}return function(t){for(var e="",r=0,n=t.length;r<n;++r)e+=C0(t[r]);return e}(t)}(t)}function O0(t,e){for(var r=e||1e5,n=function(t){for(var e=function(t){for(var e=[],r=0,n=0,i=0,o=t.length;i<o;++i){var s=t.charCodeAt(i)-63;r|=(31&s)<<n,s<32?(e.push(r),r=0,n=0):n+=5}return e}(t),r=0,n=e.length;r<n;++r){var i=e[r];e[r]=1&i?~(i>>1):i>>1}return e}(t),i=0,o=n.length;i<o;++i)n[i]/=r;return n}function C0(t){for(var e,r="";t>=32;)e=63+(32|31&t),r+=String.fromCharCode(e),t>>=5;return e=t+63,r+=String.fromCharCode(e)}var T0=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.dataProjection=ye("EPSG:4326"),r.factor_=n.factor?n.factor:1e5,r.geometryLayout_=n.geometryLayout?n.geometryLayout:Nu,r}return x0(e,t),e.prototype.readFeatureFromText=function(t,e){var r=this.readGeometryFromText(t,e);return new Cg(r)},e.prototype.readFeaturesFromText=function(t,e){return[this.readFeatureFromText(t,e)]},e.prototype.readGeometryFromText=function(t,e){var r=Yu(this.geometryLayout_),n=S0(t,r,this.factor_);w0(n,0,n.length,r,n);var i=sc(n,0,n.length,r);return NL(new Fg(i,this.geometryLayout_),!1,this.adaptOptions(e))},e.prototype.writeFeatureText=function(t,e){var r=t.getGeometry();return r?this.writeGeometryText(r,e):(ut(!1,40),"")},e.prototype.writeFeaturesText=function(t,e){return this.writeFeatureText(t[0],e)},e.prototype.writeGeometryText=function(t,e){var r=(t=NL(t,!0,this.adaptOptions(e))).getFlatCoordinates(),n=t.getStride();return w0(r,0,r.length,n,r),E0(r,n,this.factor_)},e}(Hq),P0=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R0=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.layerName_=n.layerName,r.layers_=n.layers?n.layers:null,r.dataProjection=ye(n.dataProjection?n.dataProjection:"EPSG:4326"),r}return P0(e,t),e.prototype.readFeaturesFromObject=function(t,e){if("Topology"==t.type){var r=t,n=void 0,i=null,o=null;r.transform&&(i=(n=r.transform).scale,o=n.translate);var s=r.arcs;n&&function(t,e,r){for(var n=0,i=t.length;n<i;++n)A0(t[n],e,r)}(s,i,o);var a=[],l=r.objects,u=this.layerName_,c=void 0;for(var h in l)this.layers_&&-1==this.layers_.indexOf(h)||("GeometryCollection"===l[h].type?(c=l[h],a.push.apply(a,k0(c,s,i,o,u,h,e))):(c=l[h],a.push(N0(c,s,i,o,u,h,e))));return a}return[]},e.prototype.readProjectionFromObject=function(t){return this.dataProjection},e}(uj),L0={Point:function(t,e,r){var n=t.coordinates;e&&r&&F0(n,e,r);return new dc(n)},LineString:function(t,e){var r=M0(t.arcs,e);return new Fg(r)},Polygon:function(t,e){for(var r=[],n=0,i=t.arcs.length;n<i;++n)r[n]=M0(t.arcs[n],e);return new Rc(r)},MultiPoint:function(t,e,r){var n=t.coordinates;if(e&&r)for(var i=0,o=n.length;i<o;++i)F0(n[i],e,r);return new jg(n)},MultiLineString:function(t,e){for(var r=[],n=0,i=t.arcs.length;n<i;++n)r[n]=M0(t.arcs[n],e);return new zg(r)},MultiPolygon:function(t,e){for(var r=[],n=0,i=t.arcs.length;n<i;++n){for(var o=t.arcs[n],s=[],a=0,l=o.length;a<l;++a)s[a]=M0(o[a],e);r[n]=s}return new Bg(r)}};function M0(t,e){for(var r,n,i=[],o=0,s=t.length;o<s;++o)r=t[o],o>0&&i.pop(),n=r>=0?e[r]:e[~r].slice().reverse(),i.push.apply(i,n);for(var a=0,l=i.length;a<l;++a)i[a]=i[a].slice();return i}function k0(t,e,r,n,i,o,s){for(var a=t.geometries,l=[],u=0,c=a.length;u<c;++u)l[u]=N0(a[u],e,r,n,i,o,s);return l}function N0(t,e,r,n,i,o,s){var a=null,l=t.type;if(l){var u=L0[l];a=NL(a="Point"===l||"MultiPoint"===l?u(t,r,n):u(t,e),!1,s)}var c=new Cg({geometry:a});void 0!==t.id&&c.setId(t.id);var h=t.properties;return i&&(h||(h={}),h[i]=o),h&&c.setProperties(h,!0),c}function A0(t,e,r){for(var n=0,i=0,o=0,s=t.length;o<s;++o){var a=t[o];n+=a[0],i+=a[1],a[0]=n,a[1]=i,F0(a,e,r)}}function F0(t,e,r){t[0]=t[0]*e[0]+r[0],t[1]=t[1]*e[1]+r[1]}var D0=R0,j0=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),G0=1,z0=2,U0=3,B0=4,V0=5,q0=6,Y0=7,W0=15,X0=16,H0=17,Z0=function(){function t(t){this.view_=t,this.pos_=0,this.initialized_=!1,this.isLittleEndian_=!1,this.hasZ_=!1,this.hasM_=!1,this.srid_=null,this.layout_=Nu}return t.prototype.readUint8=function(){return this.view_.getUint8(this.pos_++)},t.prototype.readUint32=function(t){return this.view_.getUint32((this.pos_+=4)-4,void 0!==t?t:this.isLittleEndian_)},t.prototype.readDouble=function(t){return this.view_.getFloat64((this.pos_+=8)-8,void 0!==t?t:this.isLittleEndian_)},t.prototype.readPoint=function(){var t=[];return t.push(this.readDouble()),t.push(this.readDouble()),this.hasZ_&&t.push(this.readDouble()),this.hasM_&&t.push(this.readDouble()),t},t.prototype.readLineString=function(){for(var t=this.readUint32(),e=[],r=0;r<t;r++)e.push(this.readPoint());return e},t.prototype.readPolygon=function(){for(var t=this.readUint32(),e=[],r=0;r<t;r++)e.push(this.readLineString());return e},t.prototype.readWkbHeader=function(t){var e=this.readUint8()>0,r=this.readUint32(e),n=Math.floor((268435455&r)/1e3),i=Boolean(2147483648&r)||1===n||3===n,o=Boolean(1073741824&r)||2===n||3===n,s=Boolean(536870912&r),a=(268435455&r)%1e3,l=["XY",i?"Z":"",o?"M":""].join(""),u=s?this.readUint32(e):null;if(void 0!==t&&t!==a)throw new Error("Unexpected WKB geometry type "+a);if(this.initialized_){if(this.isLittleEndian_!==e)throw new Error("Inconsistent endian");if(this.layout_!==l)throw new Error("Inconsistent geometry layout");if(u&&this.srid_!==u)throw new Error("Inconsistent coordinate system (SRID)")}else this.isLittleEndian_=e,this.hasZ_=i,this.hasM_=o,this.layout_=l,this.srid_=u,this.initialized_=!0;return a},t.prototype.readWkbPayload=function(t){switch(t){case G0:return this.readPoint();case z0:return this.readLineString();case U0:case H0:return this.readPolygon();case B0:return this.readMultiPoint();case V0:return this.readMultiLineString();case q0:case W0:case X0:return this.readMultiPolygon();case Y0:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+t+" is found")}},t.prototype.readWkbBlock=function(t){return this.readWkbPayload(this.readWkbHeader(t))},t.prototype.readWkbCollection=function(t,e){for(var r=this.readUint32(),n=[],i=0;i<r;i++){var o=t.call(this,e);o&&n.push(o)}return n},t.prototype.readMultiPoint=function(){return this.readWkbCollection(this.readWkbBlock,G0)},t.prototype.readMultiLineString=function(){return this.readWkbCollection(this.readWkbBlock,z0)},t.prototype.readMultiPolygon=function(){return this.readWkbCollection(this.readWkbBlock,U0)},t.prototype.readGeometryCollection=function(){return this.readWkbCollection(this.readGeometry)},t.prototype.readGeometry=function(){var t=this.readWkbHeader(),e=this.readWkbPayload(t);switch(t){case G0:return new dc(e,this.layout_);case z0:return new Fg(e,this.layout_);case U0:case H0:return new Rc(e,this.layout_);case B0:return new jg(e,this.layout_);case V0:return new zg(e,this.layout_);case q0:case W0:case X0:return new Bg(e,this.layout_);case Y0:return new Yg(e);default:return null}},t.prototype.getSrid=function(){return this.srid_},t}(),K0=function(){function t(t){t=t||{},this.layout_=t.layout,this.isLittleEndian_=!1!==t.littleEndian,this.isEWKB_=!1!==t.ewkb,this.writeQueue_=[],this.nodata_=V({X:0,Y:0,Z:0,M:0},t.nodata)}return t.prototype.writeUint8=function(t){this.writeQueue_.push([1,t])},t.prototype.writeUint32=function(t){this.writeQueue_.push([4,t])},t.prototype.writeDouble=function(t){this.writeQueue_.push([8,t])},t.prototype.writePoint=function(t,e){for(var r=V.apply(null,e.split("").map((function(e,r){var n;return(n={})[e]=t[r],n}))),n=0,i=this.layout_;n<i.length;n++){var o=i[n];this.writeDouble(o in r?r[o]:this.nodata_[o])}},t.prototype.writeLineString=function(t,e){this.writeUint32(t.length);for(var r=0;r<t.length;r++)this.writePoint(t[r],e)},t.prototype.writePolygon=function(t,e){this.writeUint32(t.length);for(var r=0;r<t.length;r++)this.writeLineString(t[r],e)},t.prototype.writeWkbHeader=function(t,e){t%=1e3,this.layout_.indexOf("Z")>=0&&(t+=this.isEWKB_?2147483648:1e3),this.layout_.indexOf("M")>=0&&(t+=this.isEWKB_?1073741824:2e3),this.isEWKB_&&Number.isInteger(e)&&(t|=536870912),this.writeUint8(this.isLittleEndian_?1:0),this.writeUint32(t),this.isEWKB_&&Number.isInteger(e)&&this.writeUint32(e)},t.prototype.writeMultiPoint=function(t,e){this.writeUint32(t.length);for(var r=0;r<t.length;r++)this.writeWkbHeader(1),this.writePoint(t[r],e)},t.prototype.writeMultiLineString=function(t,e){this.writeUint32(t.length);for(var r=0;r<t.length;r++)this.writeWkbHeader(2),this.writeLineString(t[r],e)},t.prototype.writeMultiPolygon=function(t,e){this.writeUint32(t.length);for(var r=0;r<t.length;r++)this.writeWkbHeader(3),this.writePolygon(t[r],e)},t.prototype.writeGeometryCollection=function(t){this.writeUint32(t.length);for(var e=0;e<t.length;e++)this.writeGeometry(t[e])},t.prototype.findMinimumLayout=function(t,e){void 0===e&&(e=Du);var r,n;if(t instanceof Wu)return(r=t.getLayout())===(n=e)?r:r===Du?n:n===Du?r:Nu;if(t instanceof Yg)for(var i=t.getGeometriesArray(),o=0;o<i.length&&e!==Nu;o++)e=this.findMinimumLayout(i[o],e);return e},t.prototype.writeGeometry=function(t,e){var r,n,i=((r={})[Yt.POINT]=G0,r[Yt.LINE_STRING]=z0,r[Yt.POLYGON]=U0,r[Yt.MULTI_POINT]=B0,r[Yt.MULTI_LINE_STRING]=V0,r[Yt.MULTI_POLYGON]=q0,r[Yt.GEOMETRY_COLLECTION]=Y0,r),o=t.getType(),s=i[o];if(!s)throw new Error("GeometryType "+o+" is not supported");(this.layout_||(this.layout_=this.findMinimumLayout(t)),this.writeWkbHeader(s,e),t instanceof Wu)?((n={})[Yt.POINT]=this.writePoint,n[Yt.LINE_STRING]=this.writeLineString,n[Yt.POLYGON]=this.writePolygon,n[Yt.MULTI_POINT]=this.writeMultiPoint,n[Yt.MULTI_LINE_STRING]=this.writeMultiLineString,n[Yt.MULTI_POLYGON]=this.writeMultiPolygon,n)[o].call(this,t.getCoordinates(),t.getLayout()):t instanceof Yg&&this.writeGeometryCollection(t.getGeometriesArray())},t.prototype.getBuffer=function(){var t=this,e=this.writeQueue_.reduce((function(t,e){return t+e[0]}),0),r=new ArrayBuffer(e),n=new DataView(r),i=0;return this.writeQueue_.forEach((function(e){switch(e[0]){case 1:n.setUint8(i,e[1]);break;case 4:n.setUint32(i,e[1],t.isLittleEndian_);break;case 8:n.setFloat64(i,e[1],t.isLittleEndian_)}i+=e[0]})),r},t}();function $0(t){return"string"==typeof t?function(t){for(var e=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)e[r]=parseInt(t.substr(2*r,2),16);return new DataView(e.buffer)}(t):ArrayBuffer.isView(t)?t instanceof DataView?t:new DataView(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new DataView(t):null}var J0=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.splitCollection=Boolean(n.splitCollection),r.viewCache_=null,r.hex_=!1!==n.hex,r.littleEndian_=!1!==n.littleEndian,r.ewkb_=!1!==n.ewkb,r.layout_=n.geometryLayout,r.nodataZ_=n.nodataZ||0,r.nodataM_=n.nodataM||0,r.srid_=n.srid,r}return j0(e,t),e.prototype.getType=function(){return this.hex_?Pb:Cb},e.prototype.readFeature=function(t,e){return new Cg({geometry:this.readGeometry(t,e)})},e.prototype.readFeatures=function(t,e){var r=this.readGeometry(t,e);return(this.splitCollection&&r instanceof Yg?r.getGeometriesArray():[r]).map((function(t){return new Cg({geometry:t})}))},e.prototype.readGeometry=function(t,e){var r=$0(t);if(!r)return null;var n=new Z0(r).readGeometry();this.viewCache_=r;var i=this.getReadOptions(t,e);return this.viewCache_=null,NL(n,!1,i)},e.prototype.readProjection=function(t){var e=this.viewCache_||$0(t);if(e){var r=new Z0(e);return r.readWkbHeader(),r.getSrid()&&ye("EPSG:"+r.getSrid())||void 0}},e.prototype.writeFeature=function(t,e){return this.writeGeometry(t.getGeometry(),e)},e.prototype.writeFeatures=function(t,e){return this.writeGeometry(new Yg(t.map((function(t){return t.getGeometry()}))),e)},e.prototype.writeGeometry=function(t,e){var r=this.adaptOptions(e),n=new K0({layout:this.layout_,littleEndian:this.littleEndian_,ewkb:this.ewkb_,nodata:{Z:this.nodataZ_,M:this.nodataM_}}),i=Number.isInteger(this.srid_)?Number(this.srid_):null;if(!1!==this.srid_&&!Number.isInteger(this.srid_)){var o=r.dataProjection&&ye(r.dataProjection);if(o){var s=o.getCode();0===s.indexOf("EPSG:")&&(i=Number(s.substring(5)))}}n.writeGeometry(NL(t,!0,r),i);var a=n.getBuffer();return this.hex_?function(t){var e=new Uint8Array(t);return Array.from(e.values()).map((function(t){return(t<16?"0":"")+Number(t).toString(16).toUpperCase()})).join("")}(a):a},e}(kL),Q0=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),t1=function(t){function e(e){var r=t.call(this)||this,n=e||{};return r.featureNS_="http://mapserver.gis.umn.edu/mapserver",r.gmlFormat_=new WL,r.layers_=n.layers?n.layers:null,r}return Q0(e,t),e.prototype.getLayers=function(){return this.layers_},e.prototype.setLayers=function(t){this.layers_=t},e.prototype.readFeatures_=function(t,e){t.setAttribute("namespaceURI",this.featureNS_);var r=t.localName,n=[];if(0===t.childNodes.length)return n;if("msGMLOutput"==r)for(var i=0,o=t.childNodes.length;i<o;i++){var s=t.childNodes[i];if(s.nodeType===Node.ELEMENT_NODE){var a=s,l=e[0],u=a.localName.replace("_layer","");if(!this.layers_||Ue(this.layers_,u)){var c=u+"_feature";l.featureType=c,l.featureNS=this.featureNS_;var h={};h[c]=er(this.gmlFormat_.readFeatureElement,this.gmlFormat_);var f=cr([l.featureNS,null],h);a.setAttribute("namespaceURI",this.featureNS_);var p=fr([],f,a,e,this.gmlFormat_);p&&qe(n,p)}}}if("FeatureCollection"==r){var d=fr([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,[{}],this.gmlFormat_);d&&(n=d)}return n},e.prototype.readFeaturesFromNode=function(t,e){var r={};return e&&V(r,this.getReadOptions(t,e)),this.readFeatures_(t,[r])},e}(DL),e1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),r1="addfeatures",n1=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.features=n,o.file=r,o.projection=i,o}return e1(e,t),e}(Xs),i1=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{handleEvent:fs})||this).on,r.once,r.un,r.readAsBuffer_=!1,r.formats_=[];for(var i=n.formatConstructors?n.formatConstructors:[],o=0,s=i.length;o<s;++o){var a=i[o];"function"==typeof a&&(a=new a),r.formats_.push(a),r.readAsBuffer_=r.readAsBuffer_||a.getType()===Cb}return r.projection_=n.projection?ye(n.projection):null,r.dropListenKeys_=null,r.source_=n.source||null,r.target=n.target?n.target:null,r}return e1(e,t),e.prototype.handleResult_=function(t,e){var r,n=e.target.result,i=this.getMap(),o=this.projection_;o||(o=i.getView().getProjection());for(var s=this.formats_,a=0,l=s.length;a<l;++a){var u=s[a],c=n;this.readAsBuffer_&&u.getType()!==Cb&&(void 0===r&&(r=(new TextDecoder).decode(n)),c=r);var h=this.tryReadFeatures_(u,c,{featureProjection:o});if(h&&h.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(h)),this.dispatchEvent(new n1(r1,t,h,o));break}}},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[fa(e,oa,this.handleDrop,this),fa(e,na,this.handleStop,this),fa(e,ia,this.handleStop,this),fa(e,oa,this.handleStop,this)]}},e.prototype.setActive=function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,r){try{return t.readFeatures(e,r)}catch(t){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(da),this.dropListenKeys_=null)},e.prototype.handleDrop=function(t){for(var e=t.dataTransfer.files,r=0,n=e.length;r<n;++r){var i=e.item(r),o=new FileReader;o.addEventListener(la,this.handleResult_.bind(this,i)),this.readAsBuffer_?o.readAsArrayBuffer(i):o.readAsText(i)}},e.prototype.handleStop=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},e}(ih),o1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s1=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,n)||this).condition_=n.condition?n.condition:bh,r.lastAngle_=void 0,r.lastMagnitude_=void 0,r.lastScaleDelta_=0,r.duration_=void 0!==n.duration?n.duration:400,r}return o1(e,t),e.prototype.handleDragEvent=function(t){if(xh(t)){var e=t.map,r=e.getSize(),n=t.pixel,i=n[0]-r[0]/2,o=r[1]/2-n[1],s=Math.atan2(o,i),a=Math.sqrt(i*i+o*o),l=e.getView();if(void 0!==this.lastAngle_){var u=this.lastAngle_-s;l.adjustRotationInternal(u)}this.lastAngle_=s,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/a),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/a),this.lastMagnitude_=a}},e.prototype.handleUpEvent=function(t){if(!xh(t))return!0;var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!xh(t)&&(!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))},e}(uh),a1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),l1="Point",u1="LineString",c1="Polygon",h1="Circle",f1="drawstart",p1="drawend",d1="drawabort",g1=function(t){function e(e,r){var n=t.call(this,e)||this;return n.feature=r,n}return a1(e,t),e}(Xs);var y1=function(t){function e(e){var r=this,n=e;n.stopDown||(n.stopDown=ps),(r=t.call(this,n)||this).on,r.once,r.un,r.shouldHandle_=!1,r.downPx_=null,r.downTimeout_,r.lastDragTime_,r.pointerType_,r.freehand_=!1,r.source_=e.source?e.source:null,r.features_=e.features?e.features:null,r.snapTolerance_=e.snapTolerance?e.snapTolerance:12,r.type_=e.type,r.mode_=function(t){switch(t){case Yt.POINT:case Yt.MULTI_POINT:return l1;case Yt.LINE_STRING:case Yt.MULTI_LINE_STRING:return u1;case Yt.POLYGON:case Yt.MULTI_POLYGON:return c1;case Yt.CIRCLE:return h1;default:throw new Error("Invalid type: "+t)}}(r.type_),r.stopClick_=!!e.stopClick,r.minPoints_=e.minPoints?e.minPoints:r.mode_===c1?3:2,r.maxPoints_=r.mode_===h1?2:e.maxPoints?e.maxPoints:1/0,r.finishCondition_=e.finishCondition?e.finishCondition:fs;var i,o=e.geometryFunction;if(!o){var s,a=r.mode_;if(a===h1)o=function(t,e,r){var n=e||new Hg([NaN,NaN]),i=Ne(t[0],r),o=ae(i,Ne(t[t.length-1],r));n.setCenterAndRadius(i,Math.sqrt(o));var s=Me();return s&&n.transform(r,s),n};else a===l1?s=dc:a===u1?s=Fg:a===c1&&(s=Rc),o=function(t,e,r){return e?a===c1?t[0].length?e.setCoordinates([t[0].concat([t[0][0]])]):e.setCoordinates([]):e.setCoordinates(t):e=new s(t),e}}return r.geometryFunction_=o,r.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,r.finishCoordinate_=null,r.sketchFeature_=null,r.sketchPoint_=null,r.sketchCoords_=null,r.sketchLine_=null,r.sketchLineCoords_=null,r.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,r.overlay_=new zS({source:new Fb({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:(i=nx(),function(t,e){return i[t.getGeometry().getType()]}),updateWhileInteracting:!0}),r.geometryName_=e.geometryName,r.condition_=e.condition?e.condition:vh,r.freehandCondition_,e.freehand?r.freehandCondition_=gh:r.freehandCondition_=e.freehandCondition?e.freehandCondition:bh,r.addChangeListener(eh,r.updateState_),r}return a1(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===ta&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!==l1&&this.freehandCondition_(e);var r=e.type===Xl.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===Xl.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,r=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===Xl.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===Xl.POINTERDOWN?n=!1:r&&this.getPointerCount()<2?(n=e.type===Xl.POINTERMOVE)&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===Xl.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Xl.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Wl(Xl.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},e.prototype.handleUpEvent=function(t){var e=!0;if(0===this.getPointerCount())if(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t),this.shouldHandle_){var r=!this.finishCoordinate_;r&&this.startDrawing_(t.coordinate),!r&&this.freehand_?this.finishDrawing():this.freehand_||r&&this.mode_!==l1||(this.atFinish_(t.pixel)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing();return!e&&this.stopClick_&&t.preventDefault(),e},e.prototype.handlePointerMove_=function(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,r=t.pixel,n=e[0]-r[0],i=e[1]-r[1],o=n*n+i*i;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(t.coordinate):this.createOrUpdateSketchPoint_(t.coordinate.slice())},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var r=!1,n=[this.finishCoordinate_],i=this.mode_;if(i===l1)e=!0;else if(i===h1)e=2===this.sketchCoords_.length;else if(i===u1)r=this.sketchCoords_.length>this.minPoints_;else if(i===c1){var o=this.sketchCoords_;r=o[0].length>this.minPoints_,n=[o[0][0],o[0][o[0].length-2]]}if(r)for(var s=this.getMap(),a=0,l=n.length;a<l;a++){var u=n[a],c=s.getPixelFromCoordinate(u),h=t[0]-c[0],f=t[1]-c[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(h*h+f*f)<=p){this.finishCoordinate_=u;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new Cg(new dc(t)),this.updateSketchFeatures_())},e.prototype.createOrUpdateCustomSketchLine_=function(t){this.sketchLine_||(this.sketchLine_=new Cg);var e=t.getLinearRing(0),r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),r.changed()):(r=new Fg(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(r))},e.prototype.startDrawing_=function(t){var e=this.getMap().getView().getProjection();this.finishCoordinate_=t,this.mode_===l1?this.sketchCoords_=t.slice():this.mode_===c1?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Cg(new Fg(this.sketchLineCoords_)));var r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new Cg,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new g1(f1,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,r,n=this.getMap(),i=this.sketchFeature_.getGeometry(),o=n.getView().getProjection();(this.mode_===l1?r=this.sketchCoords_:this.mode_===c1?(r=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(n.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):r=(e=this.sketchCoords_)[e.length-1],r[0]=t[0],r[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(t);if(i.getType()===Yt.POLYGON&&this.mode_!==c1)this.createOrUpdateCustomSketchLine_(i);else if(this.sketchLineCoords_){this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,r,n=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),o=this.mode_;o===u1||o===h1?(this.finishCoordinate_=t.slice(),(r=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?r.pop():e=!0),r.push(t.slice()),this.geometryFunction_(r,n,i)):o===c1&&((r=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?r.pop():e=!0),r.push(t.slice()),e&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,n,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),n=this.mode_;if(n===u1||n===h1){if((t=this.sketchCoords_).splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();var i=this.finishCoordinate_.slice();t[t.length-1]=i,this.createOrUpdateSketchPoint_(i)}this.geometryFunction_(t,e,r),e.getType()===Yt.POLYGON&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(n===c1){(t=this.sketchCoords_[0]).splice(-2,1);var o=this.sketchLine_.getGeometry();if(t.length>=2){i=t[t.length-2].slice();t[t.length-1]=i,this.createOrUpdateSketchPoint_(i)}o.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,r)}1===t.length&&this.abortDrawing(),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,r=t.getGeometry(),n=this.getMap().getView().getProjection();this.mode_===u1?(e.pop(),this.geometryFunction_(e,r,n)):this.mode_===c1&&(e[0].pop(),this.geometryFunction_(e,r,n),e=r.getCoordinates()),this.type_===Yt.MULTI_POINT?t.setGeometry(new jg([e])):this.type_===Yt.MULTI_LINE_STRING?t.setGeometry(new zg([e])):this.type_===Yt.MULTI_POLYGON&&t.setGeometry(new Bg([e])),this.dispatchEvent(new g1(p1,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t},e.prototype.abortDrawing=function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new g1(d1,t))},e.prototype.appendCoordinates=function(t){var e,r=this.mode_,n=!this.sketchFeature_;if(n&&this.startDrawing_(t[0]),r===u1||r===h1)e=this.sketchCoords_;else{if(r!==c1)return;e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}n&&e.shift(),e.pop();for(var i=0;i<t.length;i++)this.addToDrawing_(t[i]);var o=t[t.length-1];this.addToDrawing_(o),this.modifyDrawing_(o)},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new Cg(new dc(r)),this.updateSketchFeatures_(),this.dispatchEvent(new g1(f1,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)},e}(uh),m1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_1="extentchanged",v1=function(t){function e(e){var r=t.call(this,_1)||this;return r.extent=e,r}return m1(e,t),e}(Xs);function b1(){var t=nx();return function(e,r){return t[Yt.POINT]}}function w1(t){return function(e){return ct([t,e])}}function x1(t,e){return t[0]==e[0]?function(r){return ct([t,[r[0],e[1]]])}:t[1]==e[1]?function(r){return ct([t,[e[0],r[1]]])}:null}var E1=function(t){function e(e){var r,n=this,i=e||{};return(n=t.call(this,i)||this).on,n.once,n.un,n.condition_=i.condition?i.condition:gh,n.extent_=null,n.pointerHandler_=null,n.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,n.snappedToVertex_=!1,n.extentFeature_=null,n.vertexFeature_=null,e||(e={}),n.extentOverlay_=new zS({source:new Fb({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:(r=nx(),function(t,e){return r[Yt.POLYGON]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),n.vertexOverlay_=new zS({source:new Fb({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:b1(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&n.setExtent(e.extent),n}return m1(e,t),e.prototype.snapToVertex_=function(t,e){var r=e.getCoordinateFromPixelInternal(t),n=this.getExtentInternal();if(n){var i=function(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}(n);i.sort((function(t,e){return ue(r,t)-ue(r,e)}));var o=i[0],s=te(r,o),a=e.getPixelFromCoordinateInternal(s);if(le(t,a)<=this.pixelTolerance_){var l=e.getPixelFromCoordinateInternal(o[0]),u=e.getPixelFromCoordinateInternal(o[1]),c=ae(a,l),h=ae(a,u),f=Math.sqrt(Math.min(c,h));return this.snappedToVertex_=f<=this.pixelTolerance_,this.snappedToVertex_&&(s=c>h?o[1]:o[0]),s}}return null},e.prototype.handlePointerMove_=function(t){var e=t.pixel,r=t.map,n=this.snapToVertex_(e,r);n||(n=r.getCoordinateFromPixelInternal(e)),this.createOrUpdatePointerFeature_(n)},e.prototype.createOrUpdateExtentFeature_=function(t){var e=this.extentFeature_;return e?t?e.setGeometry(Mc(t)):e.setGeometry(void 0):(e=new Cg(t?Mc(t):{}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e},e.prototype.createOrUpdatePointerFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new Cg(new dc(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.originalEvent||!this.condition_(e)||(e.type!=Xl.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),t.prototype.handleEvent.call(this,e),!1)},e.prototype.handleDownEvent=function(t){var e=t.pixel,r=t.map,n=this.getExtentInternal(),i=this.snapToVertex_(e,r),o=function(t){var e=null,r=null;return t[0]==n[0]?e=n[2]:t[0]==n[2]&&(e=n[0]),t[1]==n[1]?r=n[3]:t[1]==n[3]&&(r=n[1]),null!==e&&null!==r?[e,r]:null};if(i&&n){var s=i[0]==n[0]||i[0]==n[2]?i[0]:null,a=i[1]==n[1]||i[1]==n[3]?i[1]:null;null!==s&&null!==a?this.pointerHandler_=w1(o(i)):null!==s?this.pointerHandler_=x1(o([s,n[1]]),o([s,n[3]])):null!==a&&(this.pointerHandler_=x1(o([n[0],a]),o([n[2],a])))}else i=r.getCoordinateFromPixelInternal(e),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=w1(i);return!0},e.prototype.handleDragEvent=function(t){if(this.pointerHandler_){var e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}},e.prototype.handleUpEvent=function(t){this.pointerHandler_=null;var e=this.getExtentInternal();return e&&0!==Pt(e)||this.setExtent(null),!1},e.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getExtent=function(){return Ae(this.getExtentInternal(),this.getMap().getView().getProjection())},e.prototype.getExtentInternal=function(){return this.extent_},e.prototype.setExtent=function(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new v1(this.extent_))},e}(uh);function S1(t){return(S1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var I1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),O1=[0,0,0,0],C1=[],T1="modifystart",P1="modifyend",R1=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.features=r,i.mapBrowserEvent=n,i}return I1(e,t),e}(Xs);function L1(t,e){return t.index-e.index}function M1(t,e,r){var n=e.geometry;if(n.getType()===Yt.CIRCLE){var i=n;if(1===e.index){var o=Me();o&&(i=i.clone().transform(o,r));var s=ae(i.getCenter(),Ne(t,r)),a=Math.sqrt(s)-i.getRadius();return a*a}}var l=Ne(t,r);return C1[0]=Ne(e.segment[0],r),C1[1]=Ne(e.segment[1],r),ue(l,C1)}function k1(t,e,r){var n=e.geometry;if(n.getType()===Yt.CIRCLE&&1===e.index){var i=n,o=Me();return o&&(i=i.clone().transform(o,r)),ke(i.getClosestPoint(Ne(t,r)),r)}var s=Ne(t,r);return C1[0]=Ne(e.segment[0],r),C1[1]=Ne(e.segment[1],r),ke(te(s,C1),r)}var N1=function(t){function e(e){var r,n,i=t.call(this,e)||this;if(i.on,i.once,i.un,i.boundHandleFeatureChange_=i.handleFeatureChange_.bind(i),i.condition_=e.condition?e.condition:Eh,i.defaultDeleteCondition_=function(t){return hh(t)&&_h(t)},i.deleteCondition_=e.deleteCondition?e.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:gh,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.featuresBeingModified_=null,i.rBush_=new _b,i.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new zS({source:new Fb({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:(r=nx(),function(t,e){return r[Yt.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(i),LineString:i.writeLineStringGeometry_.bind(i),LinearRing:i.writeLineStringGeometry_.bind(i),Polygon:i.writePolygonGeometry_.bind(i),MultiPoint:i.writeMultiPointGeometry_.bind(i),MultiLineString:i.writeMultiLineStringGeometry_.bind(i),MultiPolygon:i.writeMultiPolygonGeometry_.bind(i),Circle:i.writeCircleGeometry_.bind(i),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(i)},i.source_=null,i.hitDetection_=null,e.features?n=e.features:e.source&&(i.source_=e.source,n=new Gl(i.source_.getFeatures()),i.source_.addEventListener(vb,i.handleSourceAdd_.bind(i)),i.source_.addEventListener(xb,i.handleSourceRemove_.bind(i))),!n)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(i.hitDetection_=e.hitDetection),i.features_=n,i.features_.forEach(i.addFeature_.bind(i)),i.features_.addEventListener(Nl,i.handleFeatureAdd_.bind(i)),i.features_.addEventListener(Al,i.handleFeatureRemove_.bind(i)),i.lastPointerEvent_=null,i.delta_=[0,0],i.snapToPointer_=void 0===e.snapToPointer?!i.hitDetection_:e.snapToPointer,i}return I1(e,t),e.prototype.addFeature_=function(t){var e=t.getGeometry();if(e){var r=this.SEGMENT_WRITERS_[e.getType()];r&&r(t,e)}var n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener($s,this.boundHandleFeatureChange_)},e.prototype.willModifyFeatures_=function(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Gl;for(var r=this.featuresBeingModified_.getArray(),n=0,i=e.length;n<i;++n)for(var o=e[n],s=0,a=o.length;s<a;++s){var l=o[s].feature;l&&-1===r.indexOf(l)&&this.featuresBeingModified_.push(l)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new R1(T1,this.featuresBeingModified_,t))}},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener($s,this.boundHandleFeatureChange_)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,r=[];e.forEach((function(e){t===e.feature&&r.push(e)}));for(var n=r.length-1;n>=0;--n){for(var i=r[n],o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===i&&this.dragSegments_.splice(o,1);e.remove(i)}},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var r=e.getCoordinates(),n={feature:t,geometry:e,segment:[r,r]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n){var o=r[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length-1;n<i;++n){var o=r.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert(ct(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(ct(l),u)}},e.prototype.writePolygonGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(ct(l),u)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,c=l.length-1;u<c;++u){var h=l.slice(u,u+2),f={feature:t,geometry:e,depth:[s,n],index:u,segment:h};this.rBush_.insert(ct(h),f)}},e.prototype.writeCircleGeometry_=function(t,e){var r=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[r,r]},i={feature:t,geometry:e,index:1,segment:[r,r]},o=[n,i];n.featureSegments=o,i.featureSegments=o,this.rBush_.insert(wt(r),n);var s=e,a=Me();if(a&&this.getMap()){var l=this.getMap().getView().getProjection();s=kc(s=s.clone().transform(a,l)).transform(l,a)}this.rBush_.insert(s.getExtent(),i)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var r=e.getGeometriesArray(),n=0;n<r.length;++n){var i=r[n];(0,this.SEGMENT_WRITERS_[i.getType()])(t,i)}},e.prototype.createOrUpdateVertexFeature_=function(t,e,r){var n=this.vertexFeature_;n?n.getGeometry().setCoordinates(t):(n=new Cg(new dc(t)),this.vertexFeature_=n,this.overlay_.getSource().addFeature(n));return n.set("features",e),n.set("geometries",r),n},e.prototype.handleEvent=function(e){return!e.originalEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Xl.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(r=!(e.type!=Xl.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Xl.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!r);var r},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);for(var e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],r=[],n=[],i=0,o=this.dragSegments_.length;i<o;++i){var s=this.dragSegments_[i],a=s[0],l=a.feature;-1===r.indexOf(l)&&r.push(l);var u=a.geometry;-1===n.indexOf(u)&&n.push(u);for(var c=a.depth,h=void 0,f=a.segment,p=s[1];e.length<u.getStride();)e.push(f[p][e.length]);switch(u.getType()){case Yt.POINT:h=e,f[0]=e,f[1]=e;break;case Yt.MULTI_POINT:(h=u.getCoordinates())[a.index]=e,f[0]=e,f[1]=e;break;case Yt.LINE_STRING:(h=u.getCoordinates())[a.index+p]=e,f[p]=e;break;case Yt.MULTI_LINE_STRING:case Yt.POLYGON:(h=u.getCoordinates())[c[0]][a.index+p]=e,f[p]=e;break;case Yt.MULTI_POLYGON:(h=u.getCoordinates())[c[1]][c[0]][a.index+p]=e,f[p]=e;break;case Yt.CIRCLE:if(f[0]=e,f[1]=e,0===a.index)this.changingFeature_=!0,u.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;var d=t.map.getView().getProjection(),g=le(Ne(u.getCenter(),d),Ne(e,d)),y=Me();if(y){var m=u.clone().transform(y,d);m.setRadius(g),g=m.transform(d,y).getRadius()}u.setRadius(g),this.changingFeature_=!1}}h&&this.setGeometryCoordinates_(u,h)}this.createOrUpdateVertexFeature_(e,r,n)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;var r=this.vertexFeature_;if(r){var n=t.map.getView().getProjection(),i=[],o=r.getGeometry().getCoordinates(),s=ct([o]),a=this.rBush_.getInExtent(s),l={};a.sort(L1);for(var u=0,c=a.length;u<c;++u){var h=a[u],f=h.segment,p=Object(st.c)(h.geometry),d=h.depth;if(d&&(p+="-"+d.join("-")),l[p]||(l[p]=new Array(2)),h.geometry.getType()!==Yt.CIRCLE||1!==h.index)if(!ie(f[0],o)||l[p][0])if(!ie(f[1],o)||l[p][1])Object(st.c)(f)in this.vertexSegments_&&!l[p][0]&&!l[p][1]&&this.insertVertexCondition_(t)&&i.push(h);else{if((h.geometry.getType()===Yt.LINE_STRING||h.geometry.getType()===Yt.MULTI_LINE_STRING)&&l[p][0]&&0===l[p][0].index)continue;this.dragSegments_.push([h,1]),l[p][1]=h}else this.dragSegments_.push([h,0]),l[p][0]=h;else ie(k1(e,h,n),o)&&!l[p][0]&&(this.dragSegments_.push([h,0]),l[p][0]=h)}i.length&&this.willModifyFeatures_(t,[i]);for(var g=i.length-1;g>=0;--g)this.insertVertex_(i[g],o)}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var r=this.dragSegments_[e][0],n=r.geometry;if(n.getType()===Yt.CIRCLE){var i=n.getCenter(),o=r.featureSegments[0],s=r.featureSegments[1];o.segment[0]=i,o.segment[1]=i,s.segment[0]=i,s.segment[1]=i,this.rBush_.update(wt(i),o);var a=n,l=Me();if(l){var u=t.map.getView().getProjection();a=kc(a=a.clone().transform(l,u)).transform(u,l)}this.rBush_.update(a.getExtent(),s)}else this.rBush_.update(ct(r.segment),r)}return this.featuresBeingModified_&&(this.dispatchEvent(new R1(P1,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)},e.prototype.handlePointerAtPixel_=function(t,e,r){var n,i,o=this,s=r||e.getCoordinateFromPixel(t),a=e.getView().getProjection();if(this.hitDetection_){var l="object"===S1(this.hitDetection_)?function(t){return t===o.hitDetection_}:void 0;e.forEachFeatureAtPixel(t,(function(t,e,r){if((r=r||t.getGeometry()).getType()===Yt.POINT&&Ue(o.features_.getArray(),t)){i=r;var s=r.getFlatCoordinates().slice(0,2);n=[{feature:t,geometry:r,segment:[s,s]}]}return!0}),{layerFilter:l})}if(!n){var u=Ae(ht(Fe(wt(s,O1),a),e.getView().getResolution()*this.pixelTolerance_,O1),a);n=this.rBush_.getInExtent(u)}if(n&&n.length>0){var c=n.sort((function(t,e){return M1(s,t,a)-M1(s,e,a)}))[0],h=c.segment,f=k1(s,c,a),p=e.getPixelFromCoordinate(f),d=le(t,p);if(i||d<=this.pixelTolerance_){var g={};if(g[Object(st.c)(h)]=!0,this.snapToPointer_||(this.delta_[0]=f[0]-s[0],this.delta_[1]=f[1]-s[1]),c.geometry.getType()===Yt.CIRCLE&&1===c.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(f,[c.feature],[c.geometry]);else{var y=e.getPixelFromCoordinate(h[0]),m=e.getPixelFromCoordinate(h[1]),_=ae(p,y),v=ae(p,m);d=Math.sqrt(Math.min(_,v)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(f=_>v?h[1]:h[0]),this.createOrUpdateVertexFeature_(f,[c.feature],[c.geometry]);var b={};b[Object(st.c)(c.geometry)]=!0;for(var w=1,x=n.length;w<x;++w){var E=n[w].segment;if(!(ie(h[0],E[0])&&ie(h[1],E[1])||ie(h[0],E[1])&&ie(h[1],E[0])))break;var S=Object(st.c)(n[w].geometry);S in b||(b[S]=!0,g[Object(st.c)(E)]=!0)}}return void(this.vertexSegments_=g)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var r,n=t.segment,i=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case Yt.MULTI_LINE_STRING:case Yt.POLYGON:(r=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case Yt.MULTI_POLYGON:(r=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case Yt.LINE_STRING:(r=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,r);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,a,s,1);var u={segment:[n[0],e],feature:i,geometry:o,depth:s,index:a};l.insert(ct(u.segment),u),this.dragSegments_.push([u,1]);var c={segment:[e,n[1]],feature:i,geometry:o,depth:s,index:a+1};l.insert(ct(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Xl.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);var e=this.removeVertex_();return this.dispatchEvent(new R1(P1,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1},e.prototype.removeVertex_=function(){var t,e,r,n,i,o,s,a,l,u,c,h=this.dragSegments_,f={},p=!1;for(i=h.length-1;i>=0;--i)u=(r=h[i])[0],c=Object(st.c)(u.feature),u.depth&&(c+="-"+u.depth.join("-")),c in f||(f[c]={}),0===r[1]?(f[c].right=u,f[c].index=u.index):1==r[1]&&(f[c].left=u,f[c].index=u.index+1);for(c in f){switch(l=f[c].right,s=f[c].left,(a=(o=f[c].index)-1)<0&&(a=0),t=e=(n=(u=void 0!==s?s:l).geometry).getCoordinates(),p=!1,n.getType()){case Yt.MULTI_LINE_STRING:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(o,1),p=!0);break;case Yt.LINE_STRING:e.length>2&&(e.splice(o,1),p=!0);break;case Yt.MULTI_POLYGON:t=t[u.depth[1]];case Yt.POLYGON:(t=t[u.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),p=!0,0===o&&(t.pop(),t.push(t[0]),a=t.length-1))}if(p){this.setGeometryCoordinates_(n,e);var d=[];if(void 0!==s&&(this.rBush_.remove(s),d.push(s.segment[0])),void 0!==l&&(this.rBush_.remove(l),d.push(l.segment[1])),void 0!==s&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:a,segment:d};this.rBush_.insert(ct(g.segment),g)}this.updateSegmentIndices_(n,o,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),h.length=0}}return p},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,r,n){this.rBush_.forEachInExtent(t.getExtent(),(function(i){i.geometry===t&&(void 0===r||void 0===i.depth||We(i.depth,r))&&i.index>e&&(i.index+=n)}))},e}(uh),A1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function F1(t){return t.feature?t.feature:t.element?t.element:void 0}var D1=[],j1=function(t){function e(e){var r=this,n=e||{},i=n;return i.handleDownEvent||(i.handleDownEvent=fs),i.stopDown||(i.stopDown=ps),(r=t.call(this,i)||this).source_=n.source?n.source:null,r.vertex_=void 0===n.vertex||n.vertex,r.edge_=void 0===n.edge||n.edge,r.features_=n.features?n.features:null,r.featuresListenerKeys_=[],r.featureChangeListenerKeys_={},r.indexedFeaturesExtents_={},r.pendingFeatures_={},r.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,r.rBush_=new _b,r.SEGMENT_WRITERS_={Point:r.writePointGeometry_.bind(r),LineString:r.writeLineStringGeometry_.bind(r),LinearRing:r.writeLineStringGeometry_.bind(r),Polygon:r.writePolygonGeometry_.bind(r),MultiPoint:r.writeMultiPointGeometry_.bind(r),MultiLineString:r.writeMultiLineStringGeometry_.bind(r),MultiPolygon:r.writeMultiPolygonGeometry_.bind(r),GeometryCollection:r.writeGeometryCollectionGeometry_.bind(r),Circle:r.writeCircleGeometry_.bind(r)},r}return A1(e,t),e.prototype.addFeature=function(t,e){var r=void 0===e||e,n=Object(st.c)(t),i=t.getGeometry();if(i){var o=this.SEGMENT_WRITERS_[i.getType()];o&&(this.indexedFeaturesExtents_[n]=i.getExtent([1/0,1/0,-1/0,-1/0]),o(t,i))}r&&(this.featureChangeListenerKeys_[n]=fa(t,$s,this.handleFeatureChange_,this))},e.prototype.forEachFeatureAdd_=function(t){this.addFeature(t)},e.prototype.forEachFeatureRemove_=function(t){this.removeFeature(t)},e.prototype.getFeatures_=function(){var t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t},e.prototype.handleEvent=function(e){var r=this.snapTo(e.pixel,e.coordinate,e.map);return r.snapped&&(e.coordinate=r.vertex.slice(0,2),e.pixel=r.vertexPixel),t.prototype.handleEvent.call(this,e)},e.prototype.handleFeatureAdd_=function(t){var e=F1(t);this.addFeature(e)},e.prototype.handleFeatureRemove_=function(t){var e=F1(t);this.removeFeature(e)},e.prototype.handleFeatureChange_=function(t){var e=t.target;if(this.handlingDownUpSequence){var r=Object(st.c)(e);r in this.pendingFeatures_||(this.pendingFeatures_[r]=e)}else this.updateFeature_(e)},e.prototype.handleUpEvent=function(t){var e=Y(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},e.prototype.removeFeature=function(t,e){var r=void 0===e||e,n=Object(st.c)(t),i=this.indexedFeaturesExtents_[n];if(i){var o=this.rBush_,s=[];o.forEachInExtent(i,(function(e){t===e.feature&&s.push(e)}));for(var a=s.length-1;a>=0;--a)o.remove(s[a])}r&&(da(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])},e.prototype.setMap=function(e){var r=this.getMap(),n=this.featuresListenerKeys_,i=this.getFeatures_();r&&(n.forEach(da),n.length=0,i.forEach(this.forEachFeatureRemove_.bind(this))),t.prototype.setMap.call(this,e),e&&(this.features_?n.push(fa(this.features_,Nl,this.handleFeatureAdd_,this),fa(this.features_,Al,this.handleFeatureRemove_,this)):this.source_&&n.push(fa(this.source_,vb,this.handleFeatureAdd_,this),fa(this.source_,xb,this.handleFeatureRemove_,this)),i.forEach(this.forEachFeatureAdd_.bind(this)))},e.prototype.snapTo=function(t,e,r){var n=ct([r.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),r.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_])]),i=this.rBush_.getInExtent(n);this.vertex_&&!this.edge_&&(i=i.filter((function(t){return t.feature.getGeometry().getType()!==Yt.CIRCLE})));var o=!1,s=null,a=null;if(0===i.length)return{snapped:o,vertex:s,vertexPixel:a};for(var l,u=r.getView().getProjection(),c=Ne(e,u),h=1/0,f=0;f<i.length;++f){var p=i[f];D1[0]=Ne(p.segment[0],u),D1[1]=Ne(p.segment[1],u);var d=ue(c,D1);d<h&&(l=p,h=d)}var g=l.segment;if(this.vertex_&&!this.edge_){var y=r.getPixelFromCoordinate(g[0]),m=r.getPixelFromCoordinate(g[1]),_=ae(t,y),v=ae(t,m);Math.sqrt(Math.min(_,v))<=this.pixelTolerance_&&(o=!0,s=_>v?g[1]:g[0],a=r.getPixelFromCoordinate(s))}else if(this.edge_){var b=l.feature.getGeometry().getType()===Yt.CIRCLE;if(b){var w=l.feature.getGeometry(),x=Me();x&&(w=w.clone().transform(x,u)),s=ke(function(t,e){var r=e.getRadius(),n=e.getCenter(),i=n[0],o=n[1],s=t[0]-i,a=t[1]-o;0===s&&0===a&&(s=1);var l=Math.sqrt(s*s+a*a);return[i+r*s/l,o+r*a/l]}(c,w),u)}else D1[0]=Ne(g[0],u),D1[1]=Ne(g[1],u),s=ke(te(c,D1),u);if(le(t,a=r.getPixelFromCoordinate(s))<=this.pixelTolerance_&&(o=!0,this.vertex_&&!b)){y=r.getPixelFromCoordinate(g[0]),m=r.getPixelFromCoordinate(g[1]),_=ae(a,y),v=ae(a,m);Math.sqrt(Math.min(_,v))<=this.pixelTolerance_&&(s=_>v?g[1]:g[0],a=r.getPixelFromCoordinate(s))}}return o&&(a=[Math.round(a[0]),Math.round(a[1])]),{snapped:o,vertex:s,vertexPixel:a}},e.prototype.updateFeature_=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},e.prototype.writeCircleGeometry_=function(t,e){var r=this.getMap().getView().getProjection(),n=e,i=Me();i&&(n=n.clone().transform(i,r));var o=kc(n);i&&o.transform(r,i);for(var s=o.getCoordinates()[0],a=0,l=s.length-1;a<l;++a){var u=s.slice(a,a+2),c={feature:t,segment:u};this.rBush_.insert(ct(u),c)}},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var r=e.getGeometriesArray(),n=0;n<r.length;++n){var i=this.SEGMENT_WRITERS_[r[n].getType()];i&&i(t,r[n])}},e.prototype.writeLineStringGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length-1;n<i;++n){var o=r.slice(n,n+2),s={feature:t,segment:o};this.rBush_.insert(ct(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,segment:l};this.rBush_.insert(ct(l),u)}},e.prototype.writeMultiPointGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n){var o=r[n],s={feature:t,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,c=l.length-1;u<c;++u){var h=l.slice(u,u+2),f={feature:t,segment:h};this.rBush_.insert(ct(h),f)}},e.prototype.writePointGeometry_=function(t,e){var r=e.getCoordinates(),n={feature:t,segment:[r,r]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writePolygonGeometry_=function(t,e){for(var r=e.getCoordinates(),n=0,i=r.length;n<i;++n)for(var o=r[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,segment:l};this.rBush_.insert(ct(l),u)}},e}(uh),G1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),z1="translatestart",U1="translating",B1="translateend",V1=function(t){function e(e,r,n,i,o){var s=t.call(this,e)||this;return s.features=r,s.coordinate=n,s.startCoordinate=i,s.mapBrowserEvent=o,s}return G1(e,t),e}(Xs),q1=function(t){function e(e){var r,n=this,i=e||{};if((n=t.call(this,i)||this).on,n.once,n.un,n.lastCoordinate_=null,n.startCoordinate_=null,n.features_=void 0!==i.features?i.features:null,i.layers&&!n.features_)if("function"==typeof i.layers)r=i.layers;else{var o=i.layers;r=function(t){return Ue(o,t)}}else r=fs;return n.layerFilter_=r,n.filter_=i.filter&&!n.features_?i.filter:fs,n.hitTolerance_=i.hitTolerance?i.hitTolerance:0,n.condition_=i.condition?i.condition:gh,n.lastFeature_=null,n.addChangeListener(eh,n.handleActiveChanged_),n}return G1(e,t),e.prototype.handleDownEvent=function(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new Gl([this.lastFeature_]);return this.dispatchEvent(new V1(z1,e,t.coordinate,this.startCoordinate_,t)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new Gl([this.lastFeature_]);return this.dispatchEvent(new V1(B1,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,r=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],i=this.features_||new Gl([this.lastFeature_]);i.forEach((function(t){var e=t.getGeometry();e.translate(r,n),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new V1(U1,i,e,this.startCoordinate_,t))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||Ue(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var r=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(r)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),r=this.getActive();e&&r||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(uh);function Y1(t,e,r){for(var n,i,o,s,a,l,u=[],c=t(0),h=t(1),f=e(c),p=e(h),d=[h,c],g=[p,f],y=[1,0],m={},_=1e5;--_>0&&y.length>0;)o=y.pop(),c=d.pop(),f=g.pop(),(l=o.toString())in m||(u.push(f[0],f[1]),m[l]=!0),s=y.pop(),h=d.pop(),p=g.pop(),v((i=e(n=t(a=(o+s)/2)))[0],i[1],f[0],f[1],p[0],p[1])<r?(u.push(p[0],p[1]),m[l=s.toString()]=!0):(y.push(s,a,a,o),g.push(p,i,i,f),d.push(h,n,n,c));return u}var W1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),X1=new Zb({color:"rgba(0,0,0,0.2)"}),H1=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],Z1=function(t){function e(e){var r=this,n=e||{},i=V({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},n);return delete i.maxLines,delete i.strokeStyle,delete i.targetSize,delete i.showLabels,delete i.lonLabelFormatter,delete i.latLabelFormatter,delete i.lonLabelPosition,delete i.latLabelPosition,delete i.lonLabelStyle,delete i.latLabelStyle,delete i.intervals,(r=t.call(this,i)||this).projection_=null,r.maxLat_=1/0,r.maxLon_=1/0,r.minLat_=-1/0,r.minLon_=-1/0,r.maxX_=1/0,r.maxY_=1/0,r.minX_=-1/0,r.minY_=-1/0,r.targetSize_=void 0!==n.targetSize?n.targetSize:100,r.maxLines_=void 0!==n.maxLines?n.maxLines:100,r.meridians_=[],r.parallels_=[],r.strokeStyle_=void 0!==n.strokeStyle?n.strokeStyle:X1,r.fromLonLatTransform_=void 0,r.toLonLatTransform_=void 0,r.projectionCenterLonLat_=null,r.bottomLeft_=null,r.bottomRight_=null,r.topLeft_=null,r.topRight_=null,r.meridiansLabels_=null,r.parallelsLabels_=null,n.showLabels&&(r.lonLabelFormatter_=null==n.lonLabelFormatter?re.bind(r,"EW"):n.lonLabelFormatter,r.latLabelFormatter_=null==n.latLabelFormatter?re.bind(r,"NS"):n.latLabelFormatter,r.lonLabelPosition_=null==n.lonLabelPosition?0:n.lonLabelPosition,r.latLabelPosition_=null==n.latLabelPosition?1:n.latLabelPosition,r.lonLabelStyleBase_=new ox({text:void 0!==n.lonLabelStyle?n.lonLabelStyle.clone():new Qb({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new Kb({color:"rgba(0,0,0,1)"}),stroke:new Zb({color:"rgba(255,255,255,1)",width:3})})}),r.lonLabelStyle_=function(t){var e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_}.bind(r),r.latLabelStyleBase_=new ox({text:void 0!==n.latLabelStyle?n.latLabelStyle.clone():new Qb({font:"12px Calibri,sans-serif",textAlign:"right",fill:new Kb({color:"rgba(0,0,0,1)"}),stroke:new Zb({color:"rgba(255,255,255,1)",width:3})})}),r.latLabelStyle_=function(t){var e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_}.bind(r),r.meridiansLabels_=[],r.parallelsLabels_=[],r.addEventListener(Aa,r.drawLabels_.bind(r))),r.intervals_=void 0!==n.intervals?n.intervals:H1,r.setSource(new Fb({loader:r.loaderFunction.bind(r),strategy:r.strategyFunction.bind(r),features:new Gl,overlaps:!1,useSpatialIndex:!1,wrapX:n.wrapX})),r.featurePool_=[],r.lineStyle_=new ox({stroke:r.strokeStyle_}),r.loadedExtent_=null,r.renderedExtent_=null,r.setRenderOrder(null),r}return W1(e,t),e.prototype.strategyFunction=function(t,e){var r,n,i,o=t.slice();return this.projection_&&this.getSource().getWrapX()&&qt(o,this.projection_),this.loadedExtent_&&(r=this.loadedExtent_,n=o,i=e,Math.abs(r[0]-n[0])<i&&Math.abs(r[2]-n[2])<i&&Math.abs(r[1]-n[1])<i&&Math.abs(r[3]-n[3])<i?o=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[o]},e.prototype.loaderFunction=function(t,e,r){this.loadedExtent_=t;var n=this.getSource(),i=Ft(this.getExtent()||[-1/0,-1/0,1/0,1/0],t);if(!(this.renderedExtent_&&Et(this.renderedExtent_,i)||(this.renderedExtent_=i,Ut(i)))){var o=Mt(i),s=e*e/4;(!this.projection_||!Ee(this.projection_,r))&&this.updateProjectionInfo_(r),this.createGraticule_(i,o,e,s);var a,l=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&(l+=this.meridians_.length),this.parallelsLabels_&&(l+=this.parallels_.length);l>this.featurePool_.length;)a=new Cg,this.featurePool_.push(a);var u=n.getFeaturesCollection();u.clear();var c,h,f=0;for(c=0,h=this.meridians_.length;c<h;++c)(a=this.featurePool_[f++]).setGeometry(this.meridians_[c]),a.setStyle(this.lineStyle_),u.push(a);for(c=0,h=this.parallels_.length;c<h;++c)(a=this.featurePool_[f++]).setGeometry(this.parallels_[c]),a.setStyle(this.lineStyle_),u.push(a)}},e.prototype.addMeridian_=function(t,e,r,n,i,o){var s=this.getMeridian_(t,e,r,n,o);if(zt(s.getExtent(),i)){if(this.meridiansLabels_){var a=this.lonLabelFormatter_(t);o in this.meridiansLabels_?this.meridiansLabels_[o].text=a:this.meridiansLabels_[o]={geom:new dc([]),text:a}}this.meridians_[o++]=s}return o},e.prototype.addParallel_=function(t,e,r,n,i,o){var s=this.getParallel_(t,e,r,n,o);if(zt(s.getExtent(),i)){if(this.parallelsLabels_){var a=this.latLabelFormatter_(t);o in this.parallelsLabels_?this.parallelsLabels_[o].text=a:this.parallelsLabels_[o]={geom:new dc([]),text:a}}this.parallels_[o++]=s}return o},e.prototype.drawLabels_=function(t){var e=t.frameState.viewState.rotation,r=t.frameState.extent,n=Mt(r),i=r;if(e){var o=Gt(r),s=At(r),a=Math.abs(Math.cos(e)),l=Math.abs(Math.sin(e)),u=(l*s-a*o)/(l*l-a*a),c=(l*o-a*s)/(l*l-a*a);i=[n[0]-u/2,n[1]-c/2,n[0]+u/2,n[1]+c/2]}var h=0,f=0,p=this.latLabelPosition_<.5,d=this.projection_.getExtent(),g=Gt(d);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!gt(d,r)&&(h=Math.floor((r[0]-d[0])/g),f=Math.ceil((r[2]-d[2])/g),p=p!==Math.abs(e)>Math.PI/2);for(var y=Pw(t),m=h;m<=f;++m){var _=this.meridians_.length+this.parallels_.length,v=void 0,b=void 0,w=void 0,x=void 0;if(this.meridiansLabels_)for(b=0,w=this.meridiansLabels_.length;b<w;++b){var E=this.meridians_[b];if(e||0!==m)(S=E.clone()).translate(m*g,0),S.rotate(-e,n),(x=this.getMeridianPoint_(S,i,b)).rotate(e,n);else x=this.getMeridianPoint_(E,r,b);(v=this.featurePool_[_++]).setGeometry(x),v.set("graticule_label",this.meridiansLabels_[b].text),y.drawFeature(v,this.lonLabelStyle_(v))}if(this.parallelsLabels_&&(m===h&&p||m===f&&!p))for(b=0,w=this.parallels_.length;b<w;++b){var S;E=this.parallels_[b];if(e||0!==m)(S=E.clone()).translate(m*g,0),S.rotate(-e,n),(x=this.getParallelPoint_(S,i,b)).rotate(e,n);else x=this.getParallelPoint_(E,r,b);(v=this.featurePool_[_++]).setGeometry(x),v.set("graticule_label",this.parallelsLabels_[b].text),y.drawFeature(v,this.latLabelStyle_(v))}}},e.prototype.createGraticule_=function(t,e,r,n){var i=this.getInterval_(r);if(-1==i)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var o=!1,s=this.projection_.getExtent(),a=Gt(s);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!gt(s,t)&&(Gt(t)>=a?(t[0]=s[0],t[2]=s[2]):o=!0);var l=[y(e[0],this.minX_,this.maxX_),y(e[1],this.minY_,this.maxY_)],u=this.toLonLatTransform_(l);isNaN(u[1])&&(u[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var c,h,f,p,d=y(u[0],this.minLon_,this.maxLon_),g=y(u[1],this.minLat_,this.maxLat_),m=this.maxLines_,_=t;o||(_=[y(t[0],this.minX_,this.maxX_),y(t[1],this.minY_,this.maxY_),y(t[2],this.minX_,this.maxX_),y(t[3],this.minY_,this.maxY_)]);var v=Vt(_,this.toLonLatTransform_,void 0,8),b=v[3],w=v[2],x=v[1],E=v[0];if(o||(dt(_,this.bottomLeft_)&&(E=this.minLon_,x=this.minLat_),dt(_,this.bottomRight_)&&(w=this.maxLon_,x=this.minLat_),dt(_,this.topLeft_)&&(E=this.minLon_,b=this.maxLat_),dt(_,this.topRight_)&&(w=this.maxLon_,b=this.maxLat_),b=y(b,g,this.maxLat_),w=y(w,d,this.maxLon_),x=y(x,this.minLat_,g),E=y(E,this.minLon_,d)),p=y(d=Math.floor(d/i)*i,this.minLon_,this.maxLon_),h=this.addMeridian_(p,x,b,n,t,0),c=0,o)for(;(p-=i)>=E&&c++<m;)h=this.addMeridian_(p,x,b,n,t,h);else for(;p!=this.minLon_&&c++<m;)p=Math.max(p-i,this.minLon_),h=this.addMeridian_(p,x,b,n,t,h);if(p=y(d,this.minLon_,this.maxLon_),c=0,o)for(;(p+=i)<=w&&c++<m;)h=this.addMeridian_(p,x,b,n,t,h);else for(;p!=this.maxLon_&&c++<m;)p=Math.min(p+i,this.maxLon_),h=this.addMeridian_(p,x,b,n,t,h);for(this.meridians_.length=h,this.meridiansLabels_&&(this.meridiansLabels_.length=h),f=y(g=Math.floor(g/i)*i,this.minLat_,this.maxLat_),h=this.addParallel_(f,E,w,n,t,0),c=0;f!=this.minLat_&&c++<m;)f=Math.max(f-i,this.minLat_),h=this.addParallel_(f,E,w,n,t,h);for(f=y(g,this.minLat_,this.maxLat_),c=0;f!=this.maxLat_&&c++<m;)f=Math.min(f+i,this.maxLat_),h=this.addParallel_(f,E,w,n,t,h);this.parallels_.length=h,this.parallelsLabels_&&(this.parallelsLabels_.length=h)},e.prototype.getInterval_=function(t){for(var e=this.projectionCenterLonLat_[0],r=this.projectionCenterLonLat_[1],n=-1,i=Math.pow(this.targetSize_*t,2),o=[],s=[],a=0,l=this.intervals_.length;a<l;++a){var u=y(this.intervals_[a]/2,0,90),c=y(r,-90+u,90-u);if(o[0]=e-u,o[1]=c-u,s[0]=e+u,s[1]=c+u,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(s,s),Math.pow(s[0]-o[0],2)+Math.pow(s[1]-o[1],2)<=i)break;n=this.intervals_[a]}return n},e.prototype.getMeridian_=function(t,e,r,n,i){var o=function(t,e,r,n,i){return Y1((function(n){return[t,e+(r-e)*n]}),Ie(ye("EPSG:4326"),n),i)}(t,e,r,this.projection_,n),s=this.meridians_[i];return s?(s.setFlatCoordinates(Nu,o),s.changed()):(s=new Fg(o,Nu),this.meridians_[i]=s),s},e.prototype.getMeridianPoint_=function(t,e,r){var n=t.getFlatCoordinates(),i=1,o=n.length-1;n[i]>n[o]&&(i=o,o=1);var s=Math.max(e[1],n[i]),a=Math.min(e[3],n[o]),l=y(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,s,a),u=[n[i-1]+(n[o-1]-n[i-1])*(l-n[i])/(n[o]-n[i]),l],c=this.meridiansLabels_[r].geom;return c.setCoordinates(u),c},e.prototype.getMeridians=function(){return this.meridians_},e.prototype.getParallel_=function(t,e,r,n,i){var o=function(t,e,r,n,i){return Y1((function(n){return[e+(r-e)*n,t]}),Ie(ye("EPSG:4326"),n),i)}(t,e,r,this.projection_,n),s=this.parallels_[i];return s?(s.setFlatCoordinates(Nu,o),s.changed()):s=new Fg(o,Nu),s},e.prototype.getParallelPoint_=function(t,e,r){var n=t.getFlatCoordinates(),i=0,o=n.length-2;n[i]>n[o]&&(i=o,o=0);var s=Math.max(e[0],n[i]),a=Math.min(e[2],n[o]),l=y(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,s,a),u=[l,n[i+1]+(n[o+1]-n[i+1])*(l-n[i])/(n[o]-n[i])],c=this.parallelsLabels_[r].geom;return c.setCoordinates(u),c},e.prototype.getParallels=function(){return this.parallels_},e.prototype.updateProjectionInfo_=function(t){var e=ye("EPSG:4326"),r=t.getWorldExtent();this.maxLat_=r[3],this.maxLon_=r[2],this.minLat_=r[1],this.minLon_=r[0];var n=Ie(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=n;else{var i=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(t,e,r){for(var o=r||2,s=n(t,e,o),a=0,l=s.length;a<l;a+=o)s[a]<i&&(s[a]+=360);return s}}this.fromLonLatTransform_=Ie(e,t);var o=Vt([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=o[0],this.maxX_=o[2],this.minY_=o[1],this.maxY_=o[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(Mt(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t},e}(zS),K1=r(12),$1=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),J1=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,imageSmoothing:e.imageSmoothing,projection:ye("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:za,tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})||this;if(r.tileJSON_=null,r.tileSize_=e.tileSize,e.url)if(e.jsonp)Object(K1.a)(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var n=new XMLHttpRequest;n.addEventListener("load",r.onXHRLoad_.bind(r)),n.addEventListener("error",r.onXHRError_.bind(r)),n.open("GET",e.url),n.send()}else e.tileJSON?r.handleTileJSONResponse(e.tileJSON):ut(!1,51);return r}return $1(e,t),e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r=void 0;try{r=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTileJSON=function(){return this.tileJSON_},e.prototype.handleTileJSONResponse=function(t){var e,r=ye("EPSG:4326"),n=this.getProjection();if(void 0!==t.bounds){var i=Se(r,n);e=Vt(t.bounds,i)}var o=Rm(n),s=t.minzoom||0,a=Cm({extent:o,maxZoom:t.maxzoom||22,minZoom:s,tileSize:this.tileSize_});if(this.tileGrid=a,this.tileUrlFunction=Fm(t.tiles,a),void 0!==t.attribution&&!this.getAttributions()){var l=void 0!==e?e:o;this.setAttributions((function(e){return zt(l,e.extent)?[t.attribution]:null}))}this.tileJSON_=t,this.setState(Ua)},e.prototype.handleTileJSONError=function(){this.setState(Ba)},e}(qm),Q1=r(18),t2=r.n(Q1),e2=r(6),r2="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1,i=arguments.length;n<i;++n){var o=arguments[n];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(r[s]=o[s])}return r};function n2(t){return t*Math.PI/180}var i2=function(){for(var t=[],e=78271.51696402048;t.length<=24;e/=2)t.push(e);return t}();function o2(t,e){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(t,e);var r=document.createElement("canvas");return r.width=t,r.height=e,r}var s2,a2=Array(256).join(" ");function l2(t,e){if(e>=.05){for(var r="",n=t.split("\n"),i=a2.slice(0,Math.round(e/.1)),o=0,s=n.length;o<s;++o)o>0&&(r+="\n"),r+=n[o].split("").join(i);return r}return t}function u2(){return s2||(s2=o2(1,1).getContext("2d")),s2}function c2(t,e){return u2().measureText(t).width+(t.length-1)*e}var h2={};function f2(t,e,r,n){if(-1!==t.indexOf("\n")){for(var i=t.split("\n"),o=[],s=0,a=i.length;s<a;++s)o.push(f2(i[s],e,r,n));return o.join("\n")}var l=r+","+e+","+t+","+n,u=h2[l];if(!u){var c=t.split(" ");if(c.length>1){var h=u2();h.font=e;var f=h.measureText("M").width*r,p="";for(o=[],s=0,a=c.length;s<a;++s){var d=c[s],g=p+(p?" ":"")+d;c2(g,n)<=f?p=g:(p&&o.push(p),p=d)}p&&o.push(p);for(s=0,a=o.length;s<a&&a>1;++s){var y=o[s];if(c2(y,n)<.35*f){var m=s>0?c2(o[s-1],n):1/0,_=s<a-1?c2(o[s+1],n):1/0;o.splice(s,1),a-=1,m<_?(o[s-1]+=" "+y,s-=1):o[s]=y+" "+o[s]}}for(s=0,a=o.length-1;s<a;++s){var v=o[s],b=o[s+1];if(c2(v,n)>.7*f&&c2(b,n)<.6*f){var w=v.split(" "),x=w.pop();c2(x,n)<.2*f&&(o[s]=w.join(" "),o[s+1]=x+" "+b),a-=1}}u=o.join("\n")}else u=t;u=l2(u,n),h2[l]=u}return u}wl&&fa(wl,Qs,(function(){h2={}}));var p2,d2,g2=e2.e.isFunction,y2=e2.e.convertFunction,m2=e2.c.isExpression,_2=e2.c.createPropertyExpression,v2={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},b2={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},w2={},x2={zoom:0};function E2(t,e,r,n,i,o){var s=t.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[s]||(o[s]={});var a=o[s];if(!a[r]){var l=(t[e]||w2)[r],u=e2.f["".concat(e,"_").concat(t.type)][r];void 0===l&&(l=u.default);var c=m2(l);if(!c&&g2(l)&&(l=y2(l,u),c=!0),c){var h=function(t,e){var r=_2(t,e);if("error"===r.result)throw new Error(r.value.map((function(t){return"".concat(t.key,": ").concat(t.message)})).join(", "));return r.value}(l,u);a[r]=h.evaluate.bind(h)}else"color"==u.type&&(l=e2.a.parse(l)),a[r]=function(){return l}}return x2.zoom=n,a[r](x2,i)}var S2=!1;function I2(t,e){if(t){if(!S2&&(0===t.a||0===e))return;var r=t.a;return e=void 0===e?1:e,0===r?"transparent":"rgba("+Math.round(255*t.r/r)+","+Math.round(255*t.g/r)+","+Math.round(255*t.b/r)+","+r*e+")"}return t}var O2=/^([^]*)\{(.*)\}([^]*)$/;function C2(t,e){var r;do{if(r=t.match(O2)){var n=e[r[2]]||"";t=r[1]+n+r[3]}}while(r);return t}var T2=!1;var P2=function(t,e,r,n,i,o,s){if(void 0===n&&(n=i2),"string"==typeof e&&(e=JSON.parse(e)),8!=e.version)throw new Error("glStyle version 8 required.");var a,l;if(o)if("undefined"!=typeof Image){var u=new Image;u.crossOrigin="anonymous",u.onload=function(){a=u,l=[u.width,u.height],t.changed(),u.onload=null},u.src=o}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var c=self;c.postMessage({action:"loadImage",src:o}),c.addEventListener("message",(function(t){"imageLoaded"===t.data.action&&t.data.src===o&&(a=t.data.image,l=[a.width,a.height])}))}for(var h,f=Object(e2.b)(e.layers),p={},d=[],g={},y={},m={},_={},v=0,b=f.length;v<b;++v){var w=f[v],x=w.id;if("string"==typeof r&&w.source==r||-1!==r.indexOf(x)){var E=w["source-layer"];if(!h){h=w.source;var S=e.sources[h];if(!S)throw new Error('Source "'.concat(h,'" is not defined'));var I=S.type;if("vector"!==I&&"geojson"!==I)throw new Error('Source "'.concat(h,'" is not of type "vector" or "geojson", but "').concat(I,'"'))}var O=p[E];O||(O=[],p[E]=O),O.push({layer:w,index:v}),d.push(x)}}var C=new Zb,T=new Kb,P=[],R=function(t,e){var r=t.getProperties(),o=p[r.layer];if(o){var u=n.indexOf(e);-1==u&&(u=function(t,e){for(var r=0,n=e.length;r<n;++r)if(e[r]<t&&r+1<n){var i=e[r]/e[r+1];return r+Math.log(e[r]/t)/Math.log(i)}return n-1}(e,n));for(var c,h=v2[t.getGeometry().getType()],f={properties:r,type:h},d=-1,v=function(n,p){var v=o[n],b=v.layer,w=b.id,x=b.layout||w2,E=b.paint||w2;if("none"===x.visibility||"minzoom"in b&&u<b.minzoom||"maxzoom"in b&&u>=b.maxzoom)return"continue";var S=b.filter;if(!S||function(t,e,r,n,i){return i||console.warn("No filterCache provided to evaluateFilter()"),t in i||(i[t]=Object(e2.d)(e).filter),x2.zoom=n,i[t](x2,r)}(w,S,f,u,_)){c=b;var I=void 0,O=void 0,R=void 0,L=void 0,M=void 0,k=void 0,N=v.index;if(3==h&&("fill"==b.type||"fill-extrusion"==b.type))if(O=E2(b,"paint",b.type+"-opacity",u,f,m),b.type+"-pattern"in E){var A=E2(b,"paint",b.type+"-pattern",u,f,m);if(A){var F="string"==typeof A?C2(A,r):A.toString();if(a&&i&&i[F]){++d,(k=P[d])&&k.getFill()&&!k.getStroke()&&!k.getText()||(k=new ox({fill:new Kb}),P[d]=k),R=k.getFill(),k.setZIndex(N);var D=y[pt=F+"."+O];if(!D){var j=o2((dt=i[F]).width,dt.height),G=j.getContext("2d");G.globalAlpha=O,G.drawImage(a,dt.x,dt.y,dt.width,dt.height,0,0,dt.width,dt.height),D=G.createPattern(j,"repeat"),y[pt]=D}R.setColor(D)}}}else(I=I2(E2(b,"paint",b.type+"-color",u,f,m),O))&&(b.type+"-outline-color"in E&&(M=I2(E2(b,"paint",b.type+"-outline-color",u,f,m),O)),M||(M=I),++d,(k=P[d])&&k.getFill()&&k.getStroke()&&!k.getText()||(k=new ox({fill:new Kb,stroke:new Zb}),P[d]=k),(R=k.getFill()).setColor(I),(L=k.getStroke()).setColor(M),L.setWidth(.5),k.setZIndex(N));if(1!=h&&"line"==b.type){I=!("line-pattern"in E)&&"line-color"in E?I2(E2(b,"paint","line-color",u,f,m),E2(b,"paint","line-opacity",u,f,m)):void 0;var z=E2(b,"paint","line-width",u,f,m);I&&z>0&&(++d,(k=P[d])&&k.getStroke()&&!k.getFill()&&!k.getText()||(k=new ox({stroke:new Zb}),P[d]=k),(L=k.getStroke()).setLineCap(E2(b,"layout","line-cap",u,f,m)),L.setLineJoin(E2(b,"layout","line-join",u,f,m)),L.setMiterLimit(E2(b,"layout","line-miter-limit",u,f,m)),L.setColor(I),L.setWidth(z),L.setLineDash(E["line-dasharray"]?E2(b,"paint","line-dasharray",u,f,m).map((function(t){return t*z})):null),k.setZIndex(N))}var U=!1,B=null,V=0,q=void 0,Y=void 0,W=void 0;if((1==h||2==h)&&"icon-image"in x){var X=E2(b,"layout","icon-image",u,f,m);if(X){q="string"==typeof X?C2(X,r):X.toString();var H=void 0;if(a&&i&&i[q]){var Z=E2(b,"layout","icon-rotation-alignment",u,f,m);if(2==h){var K=t.getGeometry();if(K.getFlatMidpoint||K.getFlatMidpoints){var $=K.getExtent();if(Math.sqrt(Math.max(Math.pow(($[2]-$[0])/e,2),Math.pow(($[3]-$[1])/e,2)))>150){var J="MultiLineString"===K.getType()?K.getFlatMidpoints():K.getFlatMidpoint();if(d2||(d2=new kg("Point",p2=[NaN,NaN],[],{},null)),H=d2,p2[0]=J[0],p2[1]=J[1],"line"===(Rt=E2(b,"layout","symbol-placement",u,f,m))&&"map"===Z)for(var Q=K.getStride(),tt=K.getFlatCoordinates(),et=0,rt=tt.length-Q;et<rt;et+=Q){var nt=tt[et],it=tt[et+1],ot=tt[et+Q],st=tt[et+Q+1],at=Math.min(nt,ot),lt=Math.min(it,st),ut=Math.max(nt,ot),ct=Math.max(it,st);if(J[0]>=at&&J[0]<=ut&&J[1]>=lt&&J[1]<=ct){V=Math.atan2(it-st,ot-nt);break}}}}}if(2!==h||H){var ht=E2(b,"layout","icon-size",u,f,m),ft=void 0!==E["icon-color"]?E2(b,"paint","icon-color",u,f,m):null;if(!ft||0!==ft.a){var pt=q+"."+ht;if(null!==ft&&(pt+="."+ft),!(Y=g[pt])){var dt=i[q];Y=new hw({color:ft?[255*ft.r,255*ft.g,255*ft.b,ft.a]:void 0,img:a,imgSize:l,size:[dt.width,dt.height],offset:[dt.x,dt.y],rotateWithView:"map"===Z,scale:ht/dt.pixelRatio}),g[pt]=Y}}Y&&(++d,(k=P[d])&&k.getImage()&&!k.getFill()&&!k.getStroke()||(k=new ox,P[d]=k),k.setGeometry(H),Y.setRotation(V+n2(E2(b,"layout","icon-rotate",u,f,m))),Y.setOpacity(E2(b,"paint","icon-opacity",u,f,m)),Y.setAnchor(b2[E2(b,"layout","icon-anchor",u,f,m)]),k.setImage(Y),B=k.getText(),k.setText(void 0),k.setZIndex(N),U=!0,W=!1)}else W=!0}}}if(1==h&&"circle-radius"in E){++d,(k=P[d])&&k.getImage()&&!k.getFill()&&!k.getStroke()||(k=new ox,P[d]=k);var gt=E2(b,"paint","circle-radius",u,f,m),yt=I2(E2(b,"paint","circle-stroke-color",u,f,m),E2(b,"paint","circle-stroke-opacity",u,f,m)),mt=I2(E2(b,"paint","circle-color",u,f,m),E2(b,"paint","circle-opacity",u,f,m)),_t=E2(b,"paint","circle-stroke-width",u,f,m),vt=gt+"."+yt+"."+mt+"."+_t;(Y=g[vt])||(Y=new Jw({radius:gt,stroke:yt&&_t>0?new Zb({width:_t,color:yt}):void 0,fill:mt?new Kb({color:mt}):void 0}),g[vt]=Y),k.setImage(Y),B=k.getText(),k.setText(void 0),k.setGeometry(void 0),k.setZIndex(N),U=!0}var bt=void 0;if("text-field"in x)bt=C2(E2(b,"layout","text-field",u,f,m).toString(),r).trim(),O=E2(b,"paint","text-opacity",u,f,m);if(bt&&O&&!W){U||(++d,(k=P[d])&&k.getText()&&!k.getFill()&&!k.getStroke()||(k=new ox,P[d]=k),k.setImage(void 0),k.setGeometry(void 0)),k.getText()||k.setText(B||new Qb({padding:[2,2,2,2]})),B=k.getText();var wt=Math.round(E2(b,"layout","text-size",u,f,m)),xt=E2(b,"layout","text-font",u,f,m),Et=E2(b,"layout","text-line-height",u,f,m),St=t2()(s?s(xt):xt,wt,Et),It=x["text-transform"];"uppercase"==It?bt=bt.toUpperCase():"lowercase"==It&&(bt=bt.toLowerCase());var Ot=E2(b,"layout","text-max-width",u,f,m),Ct=E2(b,"layout","text-letter-spacing",u,f,m),Tt=2==h?l2(bt,Ct):f2(bt,St,Ot,Ct);B.setText(Tt),B.setFont(St),B.setRotation(n2(E2(b,"layout","text-rotate",u,f,m)));var Pt=E2(b,"layout","text-anchor",u,f,m),Rt=U||1==h?"point":E2(b,"layout","symbol-placement",u,f,m);B.setPlacement(Rt);var Lt=E2(b,"paint","text-halo-width",u,f,m),Mt=E2(b,"layout","text-offset",u,f,m),kt=E2(b,"paint","text-translate",u,f,m),Nt=0,At=0;if("point"==Rt){var Ft="center";-1!==Pt.indexOf("left")?(Ft="left",At=Lt):-1!==Pt.indexOf("right")&&(Ft="right",At=-Lt),B.setTextAlign(Ft);var Dt=E2(b,"layout","text-rotation-alignment",u,f,m);B.setRotateWithView("map"==Dt)}else B.setMaxAngle(n2(E2(b,"layout","text-max-angle",u,f,m))*bt.length/Tt.length),B.setTextAlign(),B.setRotateWithView(!1);var jt="middle";0==Pt.indexOf("bottom")?(jt="bottom",Nt=-Lt-.5*(Et-1)*wt):0==Pt.indexOf("top")&&(jt="top",Nt=Lt+.5*(Et-1)*wt),B.setTextBaseline(jt),B.setOffsetX(Mt[0]*wt+At+kt[0]),B.setOffsetY(Mt[1]*wt+Nt+kt[1]),T.setColor(I2(E2(b,"paint","text-color",u,f,m),O)),B.setFill(T);var Gt=I2(E2(b,"paint","text-halo-color",u,f,m),O);if(Gt){C.setColor(Gt),Lt*=2;var zt=.5*wt;C.setWidth(Lt<=zt?Lt:zt),B.setStroke(C)}else B.setStroke(void 0);var Ut=E2(b,"layout","text-padding",u,f,m),Bt=B.getPadding();Ut!==Bt[0]&&(Bt[0]=Ut,Bt[1]=Ut,Bt[2]=Ut,Bt[3]=Ut),k.setZIndex(N)}}},b=0,w=o.length;b<w;++b)v(b);return d>-1?(P.length=d+1,T2&&("function"==typeof t.set?t.set("mapbox-layer",c):t.getProperties()["mapbox-layer"]=c),P):void 0}};return t.setStyle(R),t.set("mapbox-source",h),t.set("mapbox-layers",d),R},R2=r(54);function L2(t){return(L2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var M2,k2={},N2=/font-family: ?([^;]*);/,A2=/("|')/g;function F2(t){if(!M2){M2={};for(var e=document.styleSheets,r=0,n=e.length;r<n;++r){var i=e[r];try{var o=i.rules||i.cssRules;if(o)for(var s=0,a=o.length;s<a;++s){var l=o[s];if(5==l.type){var u=l.cssText.match(N2);M2[u[1].replace(A2,"")]=!0}}}catch(t){}}}return t in M2}var D2={},j2=r.n(R2).a.getNames();function G2(t){var e=t.toString();if(e in D2)return t;for(var r=t.map((function(t){var e=t2()(t,1).split(" ");return[e.slice(3).join(" ").replace(/"/g,""),e[1]+e[0]]})),n=0,i=r.length;n<i;++n){var o=r[n],s=o[0];if(!F2(s)&&-1!==j2.indexOf(s)){var a="https://fonts.googleapis.com/css?family="+s.replace(/ /g,"+")+":"+o[1];if(!document.querySelector('link[href="'+a+'"]')){var l=document.createElement("link");l.href=a,l.rel="stylesheet",document.head.appendChild(l)}}}return D2[e]=!0,t}var z2=/^(.*)(\?.*)$/;function U2(t,e){return e&&0===t.indexOf(".")&&(t=e+t),t}function B2(t,e,r){var n=(t=U2(t,e)).match(z2);return n?n[1]+r+(n.length>2?n[2]:""):t+r}function V2(t,e,r,n,i){return new Promise((function(o,s){if("object"!=L2(e)&&(e=JSON.parse(e)),8!=e.version)return s(new Error("glStyle version 8 required."));if(!(t instanceof zS||t instanceof jU))return s(new Error("Can only apply to VectorLayer or VectorTileLayer"));var a,l,u;function c(){u||e.sprite&&!a?u?(t.setStyle(u),o()):s(new Error("Something went wrong trying to apply style.")):(u=P2(t,e,r,i,a,l,G2),t.getStyle()?o():s(new Error("Nothing to show for source [".concat(r,"]"))))}if(e.sprite){var h=.5==(window.devicePixelRatio>=1.5?.5:1)?"@2x":"",f=B2(e.sprite,n,h+".json");fetch(f,{credentials:"same-origin"}).then((function(t){return t.ok||""===h?t:(f=B2(e.sprite,n,".json"),fetch(f,{credentials:"same-origin"}))})).then((function(t){if(t.ok)return t.json();s(new Error("Problem fetching sprite from ".concat(f,": ").concat(t.statusText)))})).then((function(t){if(void 0===t)return s(new Error("No sprites found."));a=t,l=B2(e.sprite,n,h+".png"),c()})).catch((function(t){s(new Error("Sprites cannot be loaded: ".concat(f,": ").concat(t.message)))}))}else c()}))}function q2(t){var e=t.bounds;if(e){var r=xe([e[0],e[1]]),n=xe([e[2],e[3]]);return[r[0],r[1],n[0],n[1]]}}function Y2(t,e){t=r2({},t);var r=[e,JSON.stringify(t)].toString(),n=k2[r];return n||(n=new J1({url:t.tiles?void 0:e,tileJSON:t.tiles?t:void 0}),k2[r]=n),new Promise((function(t){var r=n.on("change",(function(){var i=n.getState();if("ready"===i){var o=n.getTileJSON(),s=Array.isArray(o.tiles)?o.tiles:[o.tiles];if(e)for(var a=0,l=s.length;a<l;++a)s[a]=decodeURI(new URL(s[a],e).href);var u=n.getTileGrid(),c=q2(o),h=o.minzoom||0,f=o.maxzoom||22,p=n.get("ol-source");void 0===p&&(p=new TU({attributions:n.getAttributions(),format:new WU,tileGrid:new gg({origin:u.getOrigin(0),extent:c||u.getExtent(),minZoom:h,resolutions:i2.slice(0,f+1),tileSize:512}),urls:s}),n.set("ol-source",p)),ma(r),t(p)}else"error"===i&&(n.set("ol-source",null),ma(r),t(void 0))}));"ready"===n.getState()&&n.changed()}))}new pj;var W2=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),X2="https://api.mapbox.com";function H2(t){var e="mapbox://";return 0!==t.indexOf(e)?"":t.slice(e.length)}var Z2=function(t){function e(e){var r=t.call(this,Js)||this;return r.error=e,r}return W2(e,t),e}(Xs),K2="vector",$2=function(t){function e(e){var r=this,n=!("declutter"in e)||e.declutter,i=new TU({state:za,format:new WU});return(r=t.call(this,{source:i,declutter:n,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties})||this).sourceId=e.source,r.layers=e.layers,r.accessToken=e.accessToken,r.fetchStyle(e.styleUrl),r}return W2(e,t),e.prototype.fetchStyle=function(t){var e=this,r=function(t,e){var r=H2(t);if(!r)return t;var n="styles/";if(0!==r.indexOf(n))throw new Error("unexpected style url: "+t);var i=r.slice(n.length);return X2+"/styles/v1/"+i+"?&access_token="+e}(t,this.accessToken);fetch(r).then((function(t){if(!t.ok)throw new Error("unexpected response when fetching style: "+t.status);return t.json()})).then((function(t){e.onStyleLoad(t)})).catch((function(t){e.handleError(t)}))},e.prototype.onStyleLoad=function(t){var e,r,n=this;if(this.layers){for(var i={},o=0;o<t.layers.length;++o){var s=t.layers[o];s.source&&(i[s.id]=s.source)}var a=void 0;for(o=0;o<this.layers.length;++o){var l=i[this.layers[o]];if(!l)return void this.handleError(new Error("could not find source for "+this.layers[o]));if(a){if(a!==l)return void this.handleError(new Error("layers can only use a single source, found "+a+" and "+l))}else a=l}e=a,r=this.layers}else e=this.sourceId,r=e;r||(e=Object.keys(t.sources)[0],r=e),t.sprite&&(t.sprite=function(t,e){var r=H2(t);if(!r)return t;var n="sprites/";if(0!==r.indexOf(n))throw new Error("unexpected sprites url: "+t);var i=r.slice(n.length);return X2+"/styles/v1/"+i+"/sprite?access_token="+e}(t.sprite,this.accessToken)),t.glyphs&&(t.glyphs=function(t,e){var r=H2(t);if(!r)return t;var n="fonts/";if(0!==r.indexOf(n))throw new Error("unexpected fonts url: "+t);var i=r.slice(n.length);return X2+"/fonts/v1/"+i+"/0-255.pbf?access_token="+e}(t.glyphs,this.accessToken));var u=t.sources[e];if(u.type===K2){var c,h,f,p=this.getSource();u.url.startsWith("mapbox://")||-1!==u.url.indexOf("{z}")?(p.setUrl((c=u.url,h=this.accessToken,(f=H2(c))?"https://{a-d}.tiles.mapbox.com/v4/"+f+"/{z}/{x}/{y}.vector.pbf?access_token="+h:c)),V2(this,t,r).then((function(){p.setState(Ua)})).catch((function(t){n.handleError(t)}))):Y2(u,u.url).then((function(e){V2(n,t,r).then((function(){n.setSource(e)})).catch((function(t){n.setSource(e),n.handleError(t)}))}))}else this.handleError(new Error("only works for vector sources, found "+u.type))},e.prototype.handleError=function(t){this.dispatchEvent(new Z2(t)),this.getSource().setState(Ba)},e}(jU),J2=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q2=function(t){function e(e,r,n,i,o){var s=this,a=void 0!==o?zd:Bd;return(s=t.call(this,e,r,n,a)||this).loader_=void 0!==o?o:null,s.canvas_=i,s.error_=null,s}return J2(e,t),e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=Vd):this.state=Bd,this.changed()},e.prototype.load=function(){this.state==zd&&(this.state=Ud,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(nm),t3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),e3=function(t){function e(e){var r=t.call(this,e)||this;return r.vectorRenderer_=new jS(e),r.layerImageRatio_=e.getImageRatio(),r.coordinateToVectorPixelTransform_=[1,0,0,1,0,0],r.renderedPixelToCoordinateTransform_=null,r}return t3(e,t),e.prototype.disposeInternal=function(){this.vectorRenderer_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getFeatures=function(t){if(!this.vectorRenderer_)return new Promise((function(t){return t([])}));var e=Ts(this.coordinateToVectorPixelTransform_,Ts(this.renderedPixelToCoordinateTransform_,t.slice()));return this.vectorRenderer_.getFeatures(e)},e.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},e.prototype.prepareFrame=function(t){var e=t.pixelRatio,r=t.viewState,n=r.resolution,i=t.viewHints,o=this.vectorRenderer_,s=t.extent;1!==this.layerImageRatio_&&Bt(s=s.slice(0),this.layerImageRatio_);var a=Gt(s)/n,l=At(s)/n;if(!i[yu]&&!i[mu]&&!Ut(s)){o.useContainer(null,null,1);var u=o.context,c=V({},t,{declutterTree:new mb.a(9),extent:s,size:[a,l],viewState:V({},t.viewState,{rotation:0})}),h=!0,f=new Q2(s,n,e,u.canvas,(function(t){o.prepareFrame(c)&&o.replayGroupChanged&&(o.clipping=!1,o.renderFrame(c,null)&&(o.renderDeclutter(c),h=!1),t())}));f.addEventListener($s,function(){if(f.getState()===Bd){this.image_=h?null:f;var t=f.getResolution(),n=f.getPixelRatio(),i=t*e/n;this.renderedResolution=i,this.coordinateToVectorPixelTransform_=Rs(this.coordinateToVectorPixelTransform_,a/2,l/2,1/i,-1/i,0,-r.center[0],-r.center[1])}}.bind(this)),f.load()}return this.image_&&(this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice()),!!this.image_},e.prototype.preRender=function(){},e.prototype.postRender=function(){},e.prototype.renderDeclutter=function(){},e.prototype.forEachFeatureAtCoordinate=function(e,r,n,i,o){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,r,n,i,o):t.prototype.forEachFeatureAtCoordinate.call(this,e,r,n,i,o)},e}(sg),r3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),n3=function(t){function e(e){var r=this,n=e||{},i=V({},n);return delete i.imageRatio,(r=t.call(this,i)||this).imageRatio_=void 0!==n.imageRatio?n.imageRatio:1,r}return r3(e,t),e.prototype.getImageRatio=function(){return this.imageRatio_},e.prototype.createRenderer=function(){return new e3(this)},e}(tS),i3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function o3(t,e){t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)}function s3(t,e,r,n,i){var o,s,a=t.getGL();switch(o3(a,e),i){case 1:o=a.LUMINANCE;break;case 2:o=a.LUMINANCE_ALPHA;break;case 3:o=a.RGB;break;case 4:o=a.RGBA;break;default:throw new Error("Unsupported number of bands: "+i)}r instanceof Float32Array?(s=a.FLOAT,t.getExtension("OES_texture_float"),t.getExtension("OES_texture_float_linear")):s=a.UNSIGNED_BYTE,a.texImage2D(a.TEXTURE_2D,0,o,n[0],n[1],0,o,s,r)}var a3=function(t){function e(e,r,n){var i=t.call(this)||this;i.tile,i.textures=[],i.handleTileChange_=i.handleTileChange_.bind(i),i.size=Vc(r.getTileSize(e.tileCoord[0])),i.bandCount=NaN,i.helper_=n;var o=new KY(BY,qY);return o.fromArray([0,1,1,1,1,0,0,0]),n.flushBufferData(o),i.coords=o,i.setTile(e),i}return i3(e,t),e.prototype.setTile=function(t){t!==this.tile&&(this.tile&&this.tile.removeEventListener($s,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===hu,this.loaded?this.uploadTile_():t.addEventListener($s,this.handleTileChange_))},e.prototype.uploadTile_=function(){var t=this.helper_,e=t.getGL(),r=this.tile;if(r instanceof um){var n=e.createTexture();return this.textures.push(n),this.bandCount=4,void function(t,e,r){o3(t,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}(e,n,r.getImage())}var i=r.getData(),o=i instanceof Float32Array,s=this.size[0]*this.size[1];this.bandCount=i.byteLength/(o?4:1)/s;var a=Math.ceil(this.bandCount/4);if(1===a){n=e.createTexture();return this.textures.push(n),void s3(t,n,i,this.size,this.bandCount)}for(var l=o?Float32Array:Uint8Array,u=new Array(a),c=0;c<a;++c){n=e.createTexture();this.textures.push(n);var h=c<a-1?4:this.bandCount%4;u[c]=new l(s*h)}for(var f=s*this.bandCount,p=0;p<f;++p){var d=p%this.bandCount,g=d%4,y=(h=(c=Math.floor(d/4))<a-1?4:this.bandCount%4,Math.floor(p/this.bandCount));u[c][y*h+g]=i[p]}for(c=0;c<a;++c){h=c<a-1?4:this.bandCount%4;s3(t,n=this.textures[c],u[c],this.size,h)}},e.prototype.handleTileChange_=function(){this.tile.getState()===hu&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent($s))},e.prototype.disposeInternal=function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var e=0;e<this.textures.length;++e)t.deleteTexture(this.textures[e]);this.tile.removeEventListener($s,this.handleTileChange_)},e}(Ks),l3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u3="u_tileTexture",c3="u_tileTransform",h3="u_transitionAlpha",f3="u_depth",p3="u_texturePixelWidth",d3="u_texturePixelHeight",g3="u_resolution",y3="u_zoom",m3="a_textureCoord",_3=[{name:m3,size:2,type:lW.FLOAT}],v3={};function b3(t){return 2*(1-1/(t+1))-1}function w3(t,e,r){r in t||(t[r]=[]),t[r].push(e)}function x3(t,e){var r=t.layerStatesArray[t.layerIndex];return r.extent&&(e=Ft(e,Fe(r.extent,t.viewState.projection))),e}var E3=function(t){function e(e,r){var n=t.call(this,e,{uniforms:r.uniforms,className:r.className})||this;n.tileTransform_=[1,0,0,1,0,0],n.tempMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n.tempTileRange_=new $d(0,0,0,0),n.tempTileCoord_=ug(0,0,0),n.tempSize_=[0,0],n.program_=n.helper.getProgram(r.fragmentShader,r.vertexShader);var i=new KY(VY,qY);i.fromArray([0,1,3,1,2,3]),n.helper.flushBufferData(i),n.indices_=i;var o=void 0!==r.cacheSize?r.cacheSize:512;return n.tileTextureCache_=new mm(o),n.renderedOpacity_=NaN,n}return l3(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),r=t.getState(),n=e.getUseInterimTilesOnError();return r==hu||r==pu||r==fu&&!n},e.prototype.prepareFrame=function(t){if(Ut(x3(t,t.extent)))return!1;var e=this.getLayer().getSource();return!!e&&e.getState()===Ua},e.prototype.enqueueTiles=function(t,e,r,n){var i=t.viewState,o=this.getLayer().getSource(),s=o.getTileGridForProjection(i.projection),a=this.tileTextureCache_,l=s.getTileRangeForExtentAndZ(e,r),u=Object(st.c)(o);u in t.wantedTiles||(t.wantedTiles[u]={});for(var c=t.wantedTiles[u],h=s.getResolution(r),f=l.minX;f<=l.maxX;++f)for(var p=l.minY;p<=l.maxY;++p){var d=ug(r,f,p,this.tempTileCoord_),g=hg(d),y=void 0,m=void 0;a.containsKey(g)&&(m=(y=a.get(g)).tile),y&&y.tile.key===o.getKey()||(m=o.getTile(r,f,p,t.pixelRatio,i.projection),y?y.setTile(this.isDrawableTile(m)?m:m.getInterimTile()):(y=new a3(m,s,this.helper),a.set(g,y))),w3(n,y,r);var _=m.getKey();c[_]=!0,m.getState()===uu&&(t.tileQueue.isKeyQueued(_)||t.tileQueue.enqueue([m,u,s.getTileCoordCenter(d),h]))}},e.prototype.renderFrame=function(t){this.preRender(t);var e=t.viewState,r=t.layerStatesArray[t.layerIndex],n=x3(t,t.extent),i=this.getLayer().getSource(),o=i.getTileGridForProjection(e.projection),s=o.getZForResolution(e.resolution,i.zDirection),a={};if(t.nextExtent){var l=o.getZForResolution(e.nextResolution,i.zDirection),u=x3(t,t.nextExtent);this.enqueueTiles(t,u,l,a)}this.enqueueTiles(t,n,s,a);for(var c={},h=Object(st.c)(this),f=t.time,p=!1,d=a[s],g=0,y=d.length;g<y;++g){var m=(N=(Y=d[g]).tile).tileCoord;if(Y.loaded){if(1===(A=N.getAlpha(h,f))){N.endTransition(h);continue}p=!0,c[F=hg(m)]=A}if(!this.findAltTiles_(o,m,s+1,a))for(var _=s-1;_>=o.minZoom;--_){if(this.findAltTiles_(o,m,_,a))break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(t,!p);for(var v=Object.keys(a).map(Number).sort(ze),b=this.helper.getGL(),w=e.center[0],x=e.center[1],E=0,S=v.length;E<S;++E){var I=v[E],O=o.getResolution(I),C=Vc(o.getTileSize(I),this.tempSize_),T=o.getOrigin(I),P=(w-T[0])/(C[0]*O),R=(T[1]-x)/(C[1]*O),L=e.resolution/O,M=b3(I),k=a[I];for(g=0,y=k.length;g<y;++g){if((Y=k[g]).loaded){var N,A,F=hg(m=(N=Y.tile).tileCoord),D=m[1],j=m[2];Rs(this.tileTransform_,0,0,2/(t.size[0]*L/C[0]),-2/(t.size[1]*L/C[1]),e.rotation,-(P-D),-(R-j)),this.helper.setUniformMatrixValue(c3,tW(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(Y.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(_3);for(var G=0;G<Y.textures.length;++G){var z="TEXTURE"+G,U=u3+G;b.activeTexture(b[z]),b.bindTexture(b.TEXTURE_2D,Y.textures[G]),b.uniform1i(this.helper.getUniformLocation(U),G)}(A=F in c?c[F]:1)<1&&(t.animate=!0),this.helper.setUniformFloatValue(h3,A),this.helper.setUniformFloatValue(f3,M),this.helper.setUniformFloatValue(p3,C[0]),this.helper.setUniformFloatValue(d3,C[1]),this.helper.setUniformFloatValue(g3,e.resolution),this.helper.setUniformFloatValue(y3,e.zoom),this.helper.drawElements(0,this.indices_.getSize())}}}this.helper.finalizeDraw(t);var B=this.helper.getCanvas(),V=r.opacity;this.renderedOpacity_!==V&&(B.style.opacity=String(V),this.renderedOpacity_=V);for(var q=this.tileTextureCache_;q.canExpireCache();){var Y;(Y=q.pop()).dispose()}return t.postRenderFunctions.push((function(t,e){i.expireCache(i.getProjection(),v3)})),this.postRender(t),B},e.prototype.findAltTiles_=function(t,e,r,n){var i=t.getTileRangeForTileCoordAndZ(e,r,this.tempTileRange_);if(!i)return!1;for(var o=!0,s=this.tileTextureCache_,a=i.minX;a<=i.maxX;++a)for(var l=i.minY;l<=i.maxY;++l){var u=cg(r,a,l),c=!1;if(s.containsKey(u)){var h=s.get(u);h.loaded&&(w3(n,h,r),c=!0)}c||(o=!1)}return o},e.prototype.disposeInternal=function(){var e=this.helper,r=e.getGL();e.deleteBuffer(this.indices_),delete this.indices_,r.deleteProgram(this.program_),delete this.program_;var n=this.tileTextureCache_;n.forEach((function(t){t.dispose()})),n.clear(),delete this.tileTextureCache_,t.prototype.disposeInternal.call(this)},e}(gW);E3.prototype.getLayer;var S3=E3,I3=1,O3=2,C3=4,T3=8,P3=16,R3=31,L3=0,M3={};function k3(t){if("number"==typeof t)return I3;if("boolean"==typeof t)return T3;if("string"==typeof t)return e=t,Ns.test(e)&&(e=Fs(e)),ks.test(e)||0===e.indexOf("rgba(")||0===e.indexOf("rgb(")?C3|O3:O3;var e;if(!Array.isArray(t))throw new Error("Unhandled value type: "+JSON.stringify(t));var r=t;if(r.every((function(t){return"number"==typeof t})))return 3===r.length||4===r.length?C3|P3:P3;if("string"!=typeof r[0])throw new Error("Expected an expression operator but received: "+JSON.stringify(r));var n=M3[r[0]];if(void 0===n)throw new Error("Unrecognized expression operator: "+JSON.stringify(r));return n.getReturnType(r.slice(1))}function N3(t){var e=t.toString();return-1===e.indexOf(".")?e+".0":e}function A3(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec"+t.length+"("+t.map(N3).join(", ")+")"}function F3(t,e){return void 0===t.stringLiteralsMap[e]&&(t.stringLiteralsMap[e]=Object.keys(t.stringLiteralsMap).length),t.stringLiteralsMap[e]}function D3(t,e,r){if(Array.isArray(e)&&"string"==typeof e[0]){var n=M3[e[0]];if(void 0===n)throw new Error("Unrecognized expression operator: "+JSON.stringify(e));return n.toGlsl(t,e.slice(1),r)}var i,o=k3(e);if((o&I3)>0)return N3(e);if((o&T3)>0)return e.toString();if((o&O3)>0&&(void 0===r||r==O3))return function(t,e){return N3(F3(t,e))}(t,e.toString());if((o&C3)>0&&(void 0===r||r==C3))return(i=zs(e).slice()).length<4&&i.push(1),A3(i.map((function(t,e){return e<3?t/255:t})));if((o&P3)>0)return A3(e);throw new Error("Unexpected expression "+e+" (expected type "+r+")")}function j3(t){if(!(k3(t)&I3))throw new Error("A numeric value was expected, got "+JSON.stringify(t)+" instead")}function G3(t){for(var e=0;e<t.length;e++)j3(t[e])}function z3(t){if(!(k3(t)&O3))throw new Error("A string value was expected, got "+JSON.stringify(t)+" instead")}function U3(t){if(!(k3(t)&T3))throw new Error("A boolean value was expected, got "+JSON.stringify(t)+" instead")}function B3(t,e){if(t.length!==e)throw new Error("Exactly "+e+" arguments were expected, got "+t.length+" instead")}function V3(t,e){if(t.length<e)throw new Error("At least "+e+" arguments were expected, got "+t.length+" instead")}function q3(t,e){if(t.length>e)throw new Error("At most "+e+" arguments were expected, got "+t.length+" instead")}function Y3(t){if(t.length%2!=0)throw new Error("An even amount of arguments was expected, got "+t+" instead")}function W3(t,e){if(_(e)%1!=0)throw new Error("Could not infer only one type from the following expression: "+JSON.stringify(t))}function X3(t){return"u_var_"+t}function H3(t){return{getReturnType:function(t){return T3},toGlsl:function(e,r){B3(r,2);for(var n=R3,i=0;i<r.length;i++)n&=k3(r[i]);if(n===L3)throw new Error("All arguments should be of compatible type, got "+JSON.stringify(r)+" instead");return n&=~C3,"("+D3(e,r[0],n)+" "+t+" "+D3(e,r[1],n)+")"}}}function Z3(t){return{getReturnType:function(t){return T3},toGlsl:function(e,r){V3(r,2);for(var n=0;n<r.length;n++)U3(r[n]);return"("+r.map((function(t){return D3(e,t)})).join(" "+t+" ")+")"}}}M3.get={getReturnType:function(t){return R3},toGlsl:function(t,e){B3(e,1),z3(e[0]);var r=e[0].toString();return-1===t.attributes.indexOf(r)&&t.attributes.push(r),(t.inFragmentShader?"v_":"a_")+r}},M3.var={getReturnType:function(t){return R3},toGlsl:function(t,e){B3(e,1),z3(e[0]);var r=e[0].toString();return-1===t.variables.indexOf(r)&&t.variables.push(r),X3(r)}},M3.band={getReturnType:function(t){return I3},toGlsl:function(t,e){V3(e,1),q3(e,3);var r=e[0];if("number"!=typeof r)throw new Error("Band index must be a number");var n=r-1,i=Math.floor(n/4),o=n%4;if(r===t.bandCount&&1===o&&(o=3),1===e.length)return"color"+i+"["+o+"]";var s=e[1],a=e[2]||0;return j3(s),j3(a),"texture2D("+(u3+i)+", v_textureCoord + vec2("+D3(t,s)+" / "+p3+", "+D3(t,a)+" / "+d3+"))["+o+"]"}},M3.time={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,0),"u_time"}},M3.zoom={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,0),"u_zoom"}},M3.resolution={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,0),"u_resolution"}},M3["*"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" * "+D3(t,e[1])+")"}},M3["/"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" / "+D3(t,e[1])+")"}},M3["+"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" + "+D3(t,e[1])+")"}},M3["-"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" - "+D3(t,e[1])+")"}},M3.clamp={getReturnType:function(t){return I3},toGlsl:function(t,e){B3(e,3),G3(e);var r=D3(t,e[1]),n=D3(t,e[2]);return"clamp("+D3(t,e[0])+", "+r+", "+n+")"}},M3["%"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"mod("+D3(t,e[0])+", "+D3(t,e[1])+")"}},M3["^"]={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,2),G3(e),"pow("+D3(t,e[0])+", "+D3(t,e[1])+")"}},M3.abs={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,1),G3(e),"abs("+D3(t,e[0])+")"}},M3.sin={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,1),G3(e),"sin("+D3(t,e[0])+")"}},M3.cos={getReturnType:function(t){return I3},toGlsl:function(t,e){return B3(e,1),G3(e),"cos("+D3(t,e[0])+")"}},M3.atan={getReturnType:function(t){return I3},toGlsl:function(t,e){return V3(e,1),q3(e,2),G3(e),2===e.length?"atan("+D3(t,e[0])+", "+D3(t,e[1])+")":"atan("+D3(t,e[0])+")"}},M3[">"]={getReturnType:function(t){return T3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" > "+D3(t,e[1])+")"}},M3[">="]={getReturnType:function(t){return T3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" >= "+D3(t,e[1])+")"}},M3["<"]={getReturnType:function(t){return T3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" < "+D3(t,e[1])+")"}},M3["<="]={getReturnType:function(t){return T3},toGlsl:function(t,e){return B3(e,2),G3(e),"("+D3(t,e[0])+" <= "+D3(t,e[1])+")"}},M3["=="]=H3("=="),M3["!="]=H3("!="),M3["!"]={getReturnType:function(t){return T3},toGlsl:function(t,e){return B3(e,1),U3(e[0]),"(!"+D3(t,e[0])+")"}},M3.all=Z3("&&"),M3.any=Z3("||"),M3.between={getReturnType:function(t){return T3},toGlsl:function(t,e){B3(e,3),G3(e);var r=D3(t,e[1]),n=D3(t,e[2]),i=D3(t,e[0]);return"("+i+" >= "+r+" && "+i+" <= "+n+")"}},M3.array={getReturnType:function(t){return P3},toGlsl:function(t,e){V3(e,2),q3(e,4),G3(e);var r=e.map((function(e){return D3(t,e,I3)}));return"vec"+e.length+"("+r.join(", ")+")"}},M3.color={getReturnType:function(t){return C3},toGlsl:function(t,e){V3(e,3),q3(e,4),G3(e);var r=e;3===e.length&&r.push(1);var n=e.map((function(e,r){return D3(t,e,I3)+(r<3?" / 255.0":"")}));return"vec"+e.length+"("+n.join(", ")+")"}},M3.interpolate={getReturnType:function(t){for(var e=C3|I3,r=3;r<t.length;r+=2)e&=k3(t[r]);return e},toGlsl:function(t,e,r){Y3(e),V3(e,6);var n,i=e[0];switch(i[0]){case"linear":n=1;break;case"exponential":n=i[1];break;default:n=null}if(!n)throw new Error('Invalid interpolation type for "interpolate" operator, received: '+JSON.stringify(i));var o=void 0!==r?r:R3,s=M3.interpolate.getReturnType(e)&o;W3(e,s);for(var a=D3(t,e[1]),l=N3(n),u="",c=2;c<e.length-2;c+=2){var h=D3(t,e[c]),f=u||D3(t,e[c+1],s),p=D3(t,e[c+2]);u="mix("+f+", "+D3(t,e[c+3],s)+", pow(clamp(("+a+" - "+h+") / ("+p+" - "+h+"), 0.0, 1.0), "+l+"))"}return u}},M3.match={getReturnType:function(t){for(var e=R3,r=2;r<t.length;r+=2)e&=k3(t[r]);return e&=k3(t[t.length-1])},toGlsl:function(t,e,r){Y3(e),V3(e,4);var n=void 0!==r?r:R3,i=M3.match.getReturnType(e)&n;W3(e,i);for(var o=D3(t,e[0]),s=D3(t,e[e.length-1],i),a=null,l=e.length-3;l>=1;l-=2){a="("+o+" == "+D3(t,e[l])+" ? "+D3(t,e[l+1],i)+" : "+(a||s)+")"}return a}},M3.case={getReturnType:function(t){for(var e=R3,r=1;r<t.length;r+=2)e&=k3(t[r]);return e&=k3(t[t.length-1])},toGlsl:function(t,e,r){!function(t){if(t.length%2==0)throw new Error("An odd amount of arguments was expected, got "+t+" instead")}(e),V3(e,3);var n=void 0!==r?r:R3,i=M3.case.getReturnType(e)&n;W3(e,i);for(var o=0;o<e.length-1;o+=2)U3(e[o]);var s=D3(t,e[e.length-1],i),a=null;for(o=e.length-3;o>=0;o-=2){a="("+D3(t,e[o])+" ? "+D3(t,e[o+1],i)+" : "+(a||s)+")"}return a}};var K3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var $3=function(t){function e(e){var r=this,n=e?V({},e):{},i=n.style||{};delete n.style;var o=n.cacheSize;return delete n.cacheSize,(r=t.call(this,n)||this).style_=i,r.cacheSize_=o,r}return K3(e,t),e.prototype.createRenderer=function(){var t=this.getSource(),e=function(t,e){var r="\n    attribute vec2 "+m3+";\n    uniform mat4 "+c3+";\n    uniform float "+f3+";\n\n    varying vec2 v_textureCoord;\n\n    void main() {\n      v_textureCoord = "+m3+";\n      gl_Position = "+c3+" * vec4("+m3+", "+f3+", 1.0);\n    }\n  ",n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},bandCount:e},i=[];if(void 0!==t.color){var o=D3(n,t.color,C3);i.push("color = "+o+";")}if(void 0!==t.contrast){var s=D3(n,t.contrast,I3);i.push("color.rgb = clamp(("+s+" + 1.0) * color.rgb - ("+s+" / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(void 0!==t.exposure){var a=D3(n,t.exposure,I3);i.push("color.rgb = clamp(("+a+" + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(void 0!==t.saturation){var l=D3(n,t.saturation,I3);i.push("\n      float saturation = "+l+" + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    ")}if(void 0!==t.gamma){var u=D3(n,t.gamma,I3);i.push("color.rgb = pow(color.rgb, vec3(1.0 / "+u+"));")}if(void 0!==t.brightness){var c=D3(n,t.brightness,I3);i.push("color.rgb = clamp(color.rgb + "+c+", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}var h={},f=n.variables.length;if(f>1&&!t.variables)throw new Error("Missing variables in style (expected "+n.variables+")");for(var p=function(e){var r=n.variables[e];if(!(r in t.variables))throw new Error("Missing '"+r+"' in style variables");var i=X3(r);h[i]=function(){var e=t.variables[r];return"string"==typeof e&&(e=F3(n,e)),void 0!==e?e:-9999999}},d=0;d<f;++d)p(d);for(var g=Object.keys(h).map((function(t){return"uniform float "+t+";"})),y=Math.ceil(e/4),m=new Array(y),_=0;_<y;++_){var v=u3+_;g.push("uniform sampler2D "+v+";"),m[_]="vec4 color"+_+" = texture2D("+v+", v_textureCoord);"}return{vertexShader:r,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    uniform float "+h3+";\n    uniform float "+p3+";\n    uniform float "+d3+";\n    uniform float "+g3+";\n    uniform float "+y3+";\n\n    "+g.join("\n")+"\n\n    void main() {\n      "+m.join("\n")+"\n\n      vec4 color = color0;\n\n      "+i.join("\n")+"\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= "+h3+";\n    }",uniforms:h}}(this.style_,"bandCount"in t?t.bandCount:4);return this.styleVariables_=this.style_.variables||{},new S3(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,className:this.getClassName(),cacheSize:this.cacheSize_})},e.prototype.updateStyleVariables=function(t){V(this.styleVariables_,t),this.changed()},e}(Gd);$3.prototype.dispose;var J3=$3,Q3=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var t5=function(t){function e(e){var r=this,n=void 0!==e.hidpi&&e.hidpi;(r=t.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",imageSmoothing:e.imageSmoothing,opaque:!0,projection:ye("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:za,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:n?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})||this).hidpi_=n,r.culture_=void 0!==e.culture?e.culture:"en-us",r.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,r.apiKey_=e.key,r.imagerySet_=e.imagerySet;var i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+r.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+r.apiKey_+"&c="+r.culture_;return Object(K1.a)(i,r.handleImageryMetadataResponse.bind(r),void 0,"jsonp"),r}return Q3(e,t),e.prototype.getApiKey=function(){return this.apiKey_},e.prototype.getImagerySet=function(){return this.imagerySet_},e.prototype.handleImageryMetadataResponse=function(t){if(200==t.statusCode&&"OK"==t.statusDescription&&"ValidCredentials"==t.authenticationResultCode&&1==t.resourceSets.length&&1==t.resourceSets[0].resources.length){var e=t.resourceSets[0].resources[0],r=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,n=Rm(this.getProjection()),i=this.hidpi_?2:1,o=e.imageWidth==e.imageHeight?e.imageWidth/i:[e.imageWidth/i,e.imageHeight/i],s=Cm({extent:n,minZoom:e.zoomMin,maxZoom:r,tileSize:o});this.tileGrid=s;var a=this.culture_,l=this.hidpi_;if(this.tileUrlFunction=Dm(e.imageUrlSubdomains.map((function(t){var r=[0,0,0],n=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,i){if(t){ug(t[0],t[1],t[2],r);var o=n;return l&&(o+="&dpi=d1&device=mobile"),o.replace("{quadkey}",function(t){var e,r,n=t[0],i=new Array(n),o=1<<n-1;for(e=0;e<n;++e)r=48,t[1]&o&&(r+=1),t[2]&o&&(r+=2),i[e]=String.fromCharCode(r),o>>=1;return i.join("")}(r))}}}))),e.imageryProviders){var u=Se(ye("EPSG:4326"),this.getProjection());this.setAttributions(function(t){var r=[],n=t.viewState,i=this.getTileGrid(),o=i.getZForResolution(n.resolution,this.zDirection),s=i.getTileCoordForCoordAndZ(n.center,o)[0];return e.imageryProviders.map((function(e){for(var n=!1,i=e.coverageAreas,o=0,a=i.length;o<a;++o){var l=i[o];if(s>=l.zoomMin&&s<=l.zoomMax){var c=l.bbox;if(zt(Vt([c[1],c[0],c[3],c[2]],u),t.extent)){n=!0;break}}}n&&r.push(e.attribution)})),r.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),r}.bind(this))}this.setState(Ua)}else this.setState(Ba)},e}(qm),e5=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),r5=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:void 0!==e.maxZoom?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,transition:e.transition,wrapX:e.wrapX,zDirection:e.zDirection})||this;return r.account_=e.account,r.mapId_=e.map||"",r.config_=e.config||{},r.templateCache_={},r.initializeMap_(),r}return e5(e,t),e.prototype.getConfig=function(){return this.config_},e.prototype.updateConfig=function(t){V(this.config_,t),this.initializeMap_()},e.prototype.setConfig=function(t){this.config_=t||{},this.initializeMap_()},e.prototype.initializeMap_=function(){var t=JSON.stringify(this.config_);if(this.templateCache_[t])this.applyTemplate_(this.templateCache_[t]);else{var e="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(e+="/named/"+this.mapId_);var r=new XMLHttpRequest;r.addEventListener("load",this.handleInitResponse_.bind(this,t)),r.addEventListener("error",this.handleInitError_.bind(this)),r.open("POST",e),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(this.config_))}},e.prototype.handleInitResponse_=function(t,e){var r=e.target;if(!r.status||r.status>=200&&r.status<300){var n=void 0;try{n=JSON.parse(r.responseText)}catch(t){return void this.setState(Ba)}this.applyTemplate_(n),this.templateCache_[t]=n,this.setState(Ua)}else this.setState(Ba)},e.prototype.handleInitError_=function(t){this.setState(Ba)},e.prototype.applyTemplate_=function(t){var e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},e}(zz),n5=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i5=function(t){function e(e){var r=this,n=uu;return(r=t.call(this,e.tileCoord,n,{transition:e.transition})||this).loader_=e.loader,r.data_=null,r.error_=null,r}return n5(e,t),e.prototype.getData=function(){return this.data_},e.prototype.getError=function(){return this.error_},e.prototype.load=function(){this.state=cu,this.changed();var t=this;this.loader_().then((function(e){t.data_=e,t.state=hu,t.changed()})).catch((function(e){t.error_=e,t.state=fu,t.changed()}))},e}(em),o5=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s5=function(t){function e(e){var r=this,n=void 0===e.projection?"EPSG:3857":e.projection,i=e.tileGrid;return void 0===i&&n&&(i=Cm({extent:Rm(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),(r=t.call(this,{cacheSize:.1,projection:n,tileGrid:i,opaque:e.opaque,state:e.state,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition})||this).tileLoadingKeys_={},r.loader_=e.loader,r.handleTileChange_=r.handleTileChange_.bind(r),r.bandCount=void 0===e.bandCount?4:e.bandCount,r}return o5(e,t),e.prototype.setLoader=function(t){this.loader_=t},e.prototype.getTile=function(t,e,r,n,i){var o=cg(t,e,r);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=this.loader_;var a=new i5(V({tileCoord:[t,e,r],loader:function(){return s(t,e,r)}},this.tileOptions));return a.key=this.getKey(),a.addEventListener($s,this.handleTileChange_),this.tileCache.set(o,a),a},e.prototype.handleTileChange_=function(t){var e,r=t.target,n=Object(st.c)(r),i=r.getState();i==cu?(this.tileLoadingKeys_[n]=!0,e=bm):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=i==fu?xm:i==hu?wm:void 0),e&&this.dispatchEvent(new km(e,r))},e}(Nm);let a5;function l5(){return a5||(a5=function(){try{throw new Error}catch(t){const e=(""+t.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return"/"}()),a5}const u5="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,c5=t=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(t);function h5(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}let f5;function p5(){return f5||(f5=function(){if("undefined"==typeof Worker)return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class t extends Worker{constructor(t,e){var r,n;"string"==typeof t&&e&&e._baseURL?t=new URL(t,e._baseURL):"string"==typeof t&&!c5(t)&&l5().match(/^file:\/\//i)&&(t=new URL(t,l5().replace(/\/[^\/]+$/,"/")),(null===(r=null==e?void 0:e.CORSWorkaround)||void 0===r||r)&&(t=h5(`importScripts(${JSON.stringify(t)});`))),"string"==typeof t&&c5(t)&&(null===(n=null==e?void 0:e.CORSWorkaround)||void 0===n||n)&&(t=h5(`importScripts(${JSON.stringify(t)});`)),super(t,e)}}class e extends t{constructor(t,e){super(window.URL.createObjectURL(t),e)}static fromText(t,r){const n=new window.Blob([t],{type:"text/javascript"});return new e(n,r)}}return{blob:e,default:t}}()),f5}p5().blob;const d5=p5().default;var g5,y5=r(10),m5=r.n(y5),_5=r(55),v5=r(118),b5=r(15);function w5(t){return Promise.all(t.map(t=>{const e=t=>({status:"fulfilled",value:t}),r=t=>({status:"rejected",reason:t}),n=Promise.resolve(t);try{return n.then(e,r)}catch(t){return Promise.reject(t)}}))}!function(t){t.initialized="initialized",t.taskCanceled="taskCanceled",t.taskCompleted="taskCompleted",t.taskFailed="taskFailed",t.taskQueued="taskQueued",t.taskQueueDrained="taskQueueDrained",t.taskStart="taskStart",t.terminated="terminated"}(g5||(g5={}));var x5=r(4);function E5(t){throw Error(t)}const S5={errors:t=>t[x5.a]||E5("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:t=>t[x5.b]||E5("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:t=>t[x5.c]()};var I5=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}l((n=n.apply(t,e||[])).next())}))};let O5=1;class C5{constructor(t,e){this.eventSubject=new _5.a,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const r="number"==typeof e?{size:e}:e||{},{size:n=u5}=r;this.debug=m5()("threads:pool:"+(r.name||String(O5++)).replace(/\W/g," ").trim().replace(/\s+/g,"-")),this.options=r,this.workers=function(t,e){return function(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}(e).map(()=>({init:t(),runningTasks:[]}))}(t,n),this.eventObservable=Object(v5.a)(b5.a.from(this.eventSubject)),Promise.all(this.workers.map(t=>t.init)).then(()=>this.eventSubject.next({type:g5.initialized,size:this.workers.length}),t=>{this.debug("Error while initializing pool worker:",t),this.eventSubject.error(t),this.initErrors.push(t)})}findIdlingWorker(){const{concurrency:t=1}=this.options;return this.workers.find(e=>e.runningTasks.length<t)}runPoolTask(t,e){return I5(this,void 0,void 0,(function*(){const r=this.workers.indexOf(t)+1;this.debug(`Running task #${e.id} on worker #${r}...`),this.eventSubject.next({type:g5.taskStart,taskID:e.id,workerID:r});try{const n=yield e.run(yield t.init);this.debug(`Task #${e.id} completed successfully`),this.eventSubject.next({type:g5.taskCompleted,returnValue:n,taskID:e.id,workerID:r})}catch(t){this.debug(`Task #${e.id} failed`),this.eventSubject.next({type:g5.taskFailed,taskID:e.id,error:t,workerID:r})}}))}run(t,e){return I5(this,void 0,void 0,(function*(){const r=(()=>I5(this,void 0,void 0,(function*(){var n;yield(n=0,new Promise(t=>setTimeout(t,n)));try{yield this.runPoolTask(t,e)}finally{t.runningTasks=t.runningTasks.filter(t=>t!==r),this.isClosing||this.scheduleWork()}})))();t.runningTasks.push(r)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const t=this.findIdlingWorker();if(!t)return;const e=this.taskQueue.shift();if(!e)return this.debug("Task queue is empty"),void this.eventSubject.next({type:g5.taskQueueDrained});this.run(t,e)}taskCompletion(t){return new Promise((e,r)=>{const n=this.events().subscribe(i=>{i.type===g5.taskCompleted&&i.taskID===t?(n.unsubscribe(),e(i.returnValue)):i.type===g5.taskFailed&&i.taskID===t?(n.unsubscribe(),r(i.error)):i.type===g5.terminated&&(n.unsubscribe(),r(Error("Pool has been terminated before task was run.")))})})}settled(t=!1){return I5(this,void 0,void 0,(function*(){const e=()=>{return t=this.workers,e=t=>t.runningTasks,t.reduce((t,r)=>[...t,...e(r)],[]);var t,e},r=[],n=this.eventObservable.subscribe(t=>{t.type===g5.taskFailed&&r.push(t.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):t&&0===this.taskQueue.length?(yield w5(e()),r):(yield new Promise((t,e)=>{const r=this.eventObservable.subscribe({next(e){e.type===g5.taskQueueDrained&&(r.unsubscribe(),t(void 0))},error:e})}),yield w5(e()),n.unsubscribe(),r)}))}completed(t=!1){return I5(this,void 0,void 0,(function*(){const e=this.settled(t),r=new Promise((t,r)=>{const n=this.eventObservable.subscribe({next(i){i.type===g5.taskQueueDrained?(n.unsubscribe(),t(e)):i.type===g5.taskFailed&&(n.unsubscribe(),r(i.error))},error:r})}),n=yield Promise.race([e,r]);if(n.length>0)throw n[0]}))}events(){return this.eventObservable}queue(t){const{maxQueuedJobs:e=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const r=this.nextTaskID++,n=this.taskCompletion(r);n.catch(t=>{this.debug(`Task #${r} errored:`,t)});const i={id:r,run:t,cancel:()=>{-1!==this.taskQueue.indexOf(i)&&(this.taskQueue=this.taskQueue.filter(t=>t!==i),this.eventSubject.next({type:g5.taskCanceled,taskID:i.id}))},then:n.then.bind(n)};if(this.taskQueue.length>=e)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${i.id}...`),this.taskQueue.push(i),this.eventSubject.next({type:g5.taskQueued,taskID:i.id}),this.scheduleWork(),i}terminate(t){return I5(this,void 0,void 0,(function*(){this.isClosing=!0,t||(yield this.completed(!0)),this.eventSubject.next({type:g5.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(t=>I5(this,void 0,void 0,(function*(){return S5.terminate(yield t.init)}))))}))}}function T5(t,e){return new C5(t,e)}C5.EventType=g5,T5.EventType=g5;const P5=T5;var R5=r(31),L5=r(57);const M5="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var k5=class{constructor(t=M5,e=new d5("./decoder.worker.js")){this.pool=P5(()=>Object(R5.a)(e),t)}async decode(t,e){return new Promise((r,n)=>{this.pool.queue(async i=>{try{const n=await i(t,Object(L5.a)(e));r(n)}catch(t){n(t)}})})}destroy(){this.pool.terminate(!0)}};function N5(t){return(e,...r)=>F5(t,e,r)}function A5(t,e){return N5(z5(t,e).get)}const{apply:F5,construct:D5,defineProperty:j5,get:G5,getOwnPropertyDescriptor:z5,getPrototypeOf:U5,has:B5,ownKeys:V5,set:q5,setPrototypeOf:Y5}=Reflect,W5=(Proxy,Number),{isFinite:X5,isNaN:H5}=W5,{iterator:Z5,species:K5,toStringTag:$5,for:J5}=Symbol,Q5=Object,{create:t4,defineProperty:e4,freeze:r4,is:n4}=Q5,i4=Q5.prototype,o4=(N5(i4.isPrototypeOf),Q5.hasOwn||N5(i4.hasOwnProperty),Array),s4=(o4.isArray,o4.prototype),a4=(N5(s4.join),N5(s4.push),N5(s4.toLocaleString),s4[Z5]),l4=N5(a4),u4=(Math.trunc,ArrayBuffer),c4=(u4.isView,N5(u4.prototype.slice),A5(u4.prototype,"byteLength"),"undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null),h4=(c4&&A5(c4.prototype,"byteLength"),U5(Uint8Array)),f4=(h4.from,h4.prototype),p4=(f4[Z5],N5(f4.keys),N5(f4.values),N5(f4.entries),N5(f4.set),N5(f4.reverse),N5(f4.fill),N5(f4.copyWithin),N5(f4.sort),N5(f4.slice),N5(f4.subarray),A5(f4,"buffer"),A5(f4,"byteOffset"),A5(f4,"length"),A5(f4,$5),Uint16Array,Uint32Array),d4=Float32Array,g4=U5([][Z5]()),y4=N5(g4.next),m4=N5(function*(){}().next),_4=U5(g4),v4=DataView.prototype,b4=N5(v4.getUint16),w4=(N5(v4.setUint16),TypeError,RangeError,Set.prototype),x4=(N5(w4.add),N5(w4.has),WeakMap),E4=x4.prototype,S4=N5(E4.get),I4=(N5(E4.has),N5(E4.set)),O4=new x4,C4=t4(null,{next:{value:function(){const t=S4(O4,this);return y4(t)}},[Z5]:{value:function(){return this}}});function T4(t){if(t[Z5]===a4)return t;const e=t4(C4);return I4(O4,e,l4(t)),e}const P4=new x4,R4=t4(_4,{next:{value:function(){const t=S4(P4,this);return m4(t)},writable:!0,configurable:!0}});for(const t of V5(g4))"next"!==t&&e4(R4,t,z5(g4,t));const L4=new u4(4),M4=new d4(L4),k4=new p4(L4),N4=new p4(512),A4=new p4(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(N4[t]=0,N4[256|t]=32768,A4[t]=24,A4[256|t]=24):e<-14?(N4[t]=1024>>-e-14,N4[256|t]=1024>>-e-14|32768,A4[t]=-e-1,A4[256|t]=-e-1):e<=15?(N4[t]=e+15<<10,N4[256|t]=e+15<<10|32768,A4[t]=13,A4[256|t]=13):e<128?(N4[t]=31744,N4[256|t]=64512,A4[t]=24,A4[256|t]=24):(N4[t]=31744,N4[256|t]=64512,A4[t]=13,A4[256|t]=13)}const F4=new p4(2048),D4=new p4(64),j4=new p4(64);F4[0]=0;for(let t=1;t<1024;++t){let e=t<<13,r=0;for(;0==(8388608&e);)r-=8388608,e<<=1;e&=-8388609,r+=947912704,F4[t]=e|r}for(let t=1024;t<2048;++t)F4[t]=939524096+(t-1024<<13);D4[0]=0;for(let t=1;t<31;++t)D4[t]=t<<23;D4[31]=1199570944,D4[32]=2147483648;for(let t=33;t<63;++t)D4[t]=2147483648+(t-32<<23);D4[63]=3347054592,j4[0]=0;for(let t=1;t<64;++t)j4[t]=32===t?0:1024;function G4(t,e,...r){return function(t){const e=t>>10;return k4[0]=F4[j4[e]+(1023&t)]+D4[e],M4[0]}(b4(t,e,...T4(r)))}var z4=r(25),U4=r.n(z4),B4=r(58),V4=r.n(B4),q4=r(1);const Y4=new Map;function W4(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>Y4.set(t,e))}function X4(t,e,r,n=1){return new(Object.getPrototypeOf(t).constructor)(e*r*n)}function H4(t,e,r){return(1-r)*t+r*e}function Z4(t,e,r,n,i,o="nearest"){switch(o.toLowerCase()){case"nearest":return function(t,e,r,n,i){const o=e/n,s=r/i;return t.map(t=>{const a=X4(t,n,i);for(let l=0;l<i;++l){const i=Math.min(Math.round(s*l),r-1);for(let r=0;r<n;++r){const s=Math.min(Math.round(o*r),e-1),u=t[i*e+s];a[l*n+r]=u}}return a})}(t,e,r,n,i);case"bilinear":case"linear":return function(t,e,r,n,i){const o=e/n,s=r/i;return t.map(t=>{const a=X4(t,n,i);for(let l=0;l<i;++l){const i=s*l,u=Math.floor(i),c=Math.min(Math.ceil(i),r-1);for(let r=0;r<n;++r){const s=o*r,h=s%1,f=Math.floor(s),p=Math.min(Math.ceil(s),e-1),d=t[u*e+f],g=t[u*e+p],y=t[c*e+f],m=t[c*e+p],_=H4(H4(d,g,h),H4(y,m,h),i%1);a[l*n+r]=_}}return a})}(t,e,r,n,i);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function K4(t,e,r,n,i,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return function(t,e,r,n,i,o){const s=e/n,a=r/i,l=X4(t,n,i,o);for(let u=0;u<i;++u){const i=Math.min(Math.round(a*u),r-1);for(let r=0;r<n;++r){const a=Math.min(Math.round(s*r),e-1);for(let s=0;s<o;++s){const c=t[i*e*o+a*o+s];l[u*n*o+r*o+s]=c}}}return l}(t,e,r,n,i,o);case"bilinear":case"linear":return function(t,e,r,n,i,o){const s=e/n,a=r/i,l=X4(t,n,i,o);for(let u=0;u<i;++u){const i=a*u,c=Math.floor(i),h=Math.min(Math.ceil(i),r-1);for(let r=0;r<n;++r){const a=s*r,f=a%1,p=Math.floor(a),d=Math.min(Math.ceil(a),e-1);for(let s=0;s<o;++s){const a=t[c*e*o+p*o+s],g=t[c*e*o+d*o+s],y=t[h*e*o+p*o+s],m=t[h*e*o+d*o+s],_=H4(H4(a,g,f),H4(y,m,f),i%1);l[u*n*o+r*o+s]=_}}}return l}(t,e,r,n,i,o);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function $4(t,e,r){let n=0;for(let i=e;i<r;++i)n+=t[i];return n}function J4(t,e,r){switch(t){case 1:if(e<=8)return new Uint8Array(r);if(e<=16)return new Uint16Array(r);if(e<=32)return new Uint32Array(r);break;case 2:if(8===e)return new Int8Array(r);if(16===e)return new Int16Array(r);if(32===e)return new Int32Array(r);break;case 3:switch(e){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}W4([void 0,1],()=>Promise.resolve().then(r.bind(null,112)).then(t=>t.default)),W4(5,()=>Promise.resolve().then(r.bind(null,113)).then(t=>t.default)),W4(6,()=>{throw new Error("old style JPEG compression is not supported.")}),W4(7,()=>Promise.resolve().then(r.bind(null,114)).then(t=>t.default)),W4([8,32946],()=>Promise.resolve().then(r.bind(null,115)).then(t=>t.default)),W4(32773,()=>Promise.resolve().then(r.bind(null,116)).then(t=>t.default)),W4(34887,()=>Promise.resolve().then(r.bind(null,117)).then(t=>t.default));var Q4=class{constructor(t,e,r,n,i,o){this.fileDirectory=t,this.geoKeys=e,this.dataView=r,this.littleEndian=n,this.tiles=i?{}:null,this.isTiled=!t.StripOffsets;const s=t.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,r=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(t,e){return G4(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){return J4(this.getSampleFormat(t),this.getBitsPerSample(t),e)}async getTileOrStrip(t,e,r,n,i){const o=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight());let a;const{tiles:l}=this;let u,c;1===this.planarConfiguration?a=e*o+t:2===this.planarConfiguration&&(a=r*o*s+e*o+t),this.isTiled?(u=this.fileDirectory.TileOffsets[a],c=this.fileDirectory.TileByteCounts[a]):(u=this.fileDirectory.StripOffsets[a],c=this.fileDirectory.StripByteCounts[a]);const h=(await this.source.fetch([{offset:u,length:c}],i))[0];let f;return null!==l&&l[a]?f=l[a]:(f=(async()=>{let t=await n.decode(this.fileDirectory,h);const r=this.getSampleFormat(),i=this.getBitsPerSample();return function(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}(r,i)&&(t=function(t,e,r,n,i,o,s){const a=new DataView(t),l=2===r?1:n,u=J4(e,i,2===r?s*o:s*o*n),c=parseInt("1".repeat(i),2);if(1===e){let t;t=1===r?n*i:i;let e=o*t;0!=(7&e)&&(e=e+7&-8);for(let t=0;t<s;++t){const r=t*e;for(let e=0;e<o;++e){const n=r+e*l*i;for(let r=0;r<l;++r){const s=n+r*i,h=(t*o+e)*l+r,f=Math.floor(s/8),p=s%8;if(p+i<=8)u[h]=a.getUint8(f)>>8-i-p&c;else if(p+i<=16)u[h]=a.getUint16(f)>>16-i-p&c;else if(p+i<=24){const t=a.getUint16(f)<<8|a.getUint8(f+2);u[h]=t>>24-i-p&c}else u[h]=a.getUint32(f)>>32-i-p&c}}}}return u.buffer}(t,r,this.planarConfiguration,this.getSamplesPerPixel(),i,this.getTileWidth(),this.getBlockHeight(e))),t})(),null!==l&&(l[a]=f)),{x:t,y:e,sample:r,data:await f}}async _readRaster(t,e,r,n,i,o,s,a,l){const u=this.getTileWidth(),c=this.getTileHeight(),h=this.getWidth(),f=this.getHeight(),p=Math.max(Math.floor(t[0]/u),0),d=Math.min(Math.ceil(t[2]/u),Math.ceil(h/u)),g=Math.max(Math.floor(t[1]/c),0),y=Math.min(Math.ceil(t[3]/c),Math.ceil(f/c)),m=t[2]-t[0];let _=this.getBytesPerPixel();const v=[],b=[];for(let t=0;t<e.length;++t)1===this.planarConfiguration?v.push($4(this.fileDirectory.BitsPerSample,0,e[t])/8):v.push(0),b.push(this.getReaderForSample(e[t]));const w=[],{littleEndian:x}=this;for(let o=g;o<y;++o)for(let s=p;s<d;++s)for(let a=0;a<e.length;++a){const p=a,d=e[a];2===this.planarConfiguration&&(_=this.getSampleByteSize(a));const g=this.getTileOrStrip(s,o,d,i,l);w.push(g),g.then(i=>{const o=i.data,s=new DataView(o),a=this.getBlockHeight(i.y),l=i.y*c,d=i.x*u,g=l+a,y=(i.x+1)*u,w=b[p],E=Math.min(a,a-(g-t[3]),f-l),S=Math.min(u,u-(y-t[2]),h-d);for(let i=Math.max(0,t[1]-l);i<E;++i)for(let o=Math.max(0,t[0]-d);o<S;++o){const a=(i*u+o)*_,c=w.call(s,a+v[p],x);let h;n?(h=(i+l-t[1])*m*e.length+(o+d-t[0])*e.length+p,r[h]=c):(h=(i+l-t[1])*m+o+d-t[0],r[p][h]=c)}})}if(await Promise.all(w),o&&t[2]-t[0]!==o||s&&t[3]-t[1]!==s){let i;return i=n?K4(r,t[2]-t[0],t[3]-t[1],o,s,e.length,a):Z4(r,t[2]-t[0],t[3]-t[1],o,s,a),i.width=o,i.height=s,i}return r.width=o||t[2]-t[0],r.height=s||t[3]-t[1],r}async readRasters({window:t,samples:e=[],interleave:r,pool:n=null,width:i,height:o,resampleMethod:s,fillValue:a,signal:l}={}){const u=t||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=(u[2]-u[0])*(u[3]-u[1]),h=this.getSamplesPerPixel();if(e&&e.length){for(let t=0;t<e.length;++t)if(e[t]>=h)return Promise.reject(new RangeError(`Invalid sample index '${e[t]}'.`))}else for(let t=0;t<h;++t)e.push(t);let f;if(r){f=J4(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),c*e.length),a&&f.fill(a)}else{f=[];for(let t=0;t<e.length;++t){const r=this.getArrayForSample(e[t],c);Array.isArray(a)&&t<a.length?r.fill(a[t]):a&&!Array.isArray(a)&&r.fill(a),f.push(r)}}const p=n||await async function(t){const e=Y4.get(t.Compression);if(!e)throw new Error("Unknown compression method identifier: "+t.Compression);return new(await e())(t)}(this.fileDirectory);return await this._readRaster(u,e,f,r,p,i,o,s,l)}async readRGB({window:t,interleave:e=!0,pool:r=null,width:n,height:i,resampleMethod:o,enableAlpha:s=!1,signal:a}={}){const l=t||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const u=this.fileDirectory.PhotometricInterpretation;if(u===q4.j.RGB){let l=[0,1,2];if(this.fileDirectory.ExtraSamples!==q4.a.Unspecified&&s){l=[];for(let t=0;t<this.fileDirectory.BitsPerSample.length;t+=1)l.push(t)}return this.readRasters({window:t,interleave:e,samples:l,pool:r,width:n,height:i,resampleMethod:o,signal:a})}let c;switch(u){case q4.j.WhiteIsZero:case q4.j.BlackIsZero:case q4.j.Palette:c=[0];break;case q4.j.CMYK:c=[0,1,2,3];break;case q4.j.YCbCr:case q4.j.CIELab:c=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const h={window:l,interleave:!0,samples:c,pool:r,width:n,height:i,resampleMethod:o,signal:a},{fileDirectory:f}=this,p=await this.readRasters(h),d=2**this.fileDirectory.BitsPerSample[0];let g;switch(u){case q4.j.WhiteIsZero:g=function(t,e){const{width:r,height:n}=t,i=new Uint8Array(r*n*3);let o;for(let r=0,n=0;r<t.length;++r,n+=3)o=256-t[r]/e*256,i[n]=o,i[n+1]=o,i[n+2]=o;return i}(p,d);break;case q4.j.BlackIsZero:g=function(t,e){const{width:r,height:n}=t,i=new Uint8Array(r*n*3);let o;for(let r=0,n=0;r<t.length;++r,n+=3)o=t[r]/e*256,i[n]=o,i[n+1]=o,i[n+2]=o;return i}(p,d);break;case q4.j.Palette:g=function(t,e){const{width:r,height:n}=t,i=new Uint8Array(r*n*3),o=e.length/3,s=e.length/3*2;for(let r=0,n=0;r<t.length;++r,n+=3){const a=t[r];i[n]=e[a]/65536*256,i[n+1]=e[a+o]/65536*256,i[n+2]=e[a+s]/65536*256}return i}(p,f.ColorMap);break;case q4.j.CMYK:g=function(t){const{width:e,height:r}=t,n=new Uint8Array(e*r*3);for(let e=0,r=0;e<t.length;e+=4,r+=3){const i=t[e],o=t[e+1],s=t[e+2],a=t[e+3];n[r]=(255-i)/256*255*((255-a)/256),n[r+1]=(255-o)/256*255*((255-a)/256),n[r+2]=(255-s)/256*255*((255-a)/256)}return n}(p);break;case q4.j.YCbCr:g=function(t){const{width:e,height:r}=t,n=new Uint8ClampedArray(e*r*3);for(let e=0,r=0;e<t.length;e+=3,r+=3){const i=t[e],o=t[e+1],s=t[e+2];n[r]=i+1.402*(s-128),n[r+1]=i-.34414*(o-128)-.71414*(s-128),n[r+2]=i+1.772*(o-128)}return n}(p);break;case q4.j.CIELab:g=function(t){const{width:e,height:r}=t,n=new Uint8Array(e*r*3);for(let e=0,r=0;e<t.length;e+=3,r+=3){let i,o,s,a=(t[e+0]+16)/116,l=(t[e+1]<<24>>24)/500+a,u=a-(t[e+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787),u=1.08883*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),i=3.2406*l+-1.5372*a+-.4986*u,o=-.9689*l+1.8758*a+.0415*u,s=.0557*l+-.204*a+1.057*u,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,n[r]=255*Math.max(0,Math.min(1,i)),n[r+1]=255*Math.max(0,Math.min(1,o)),n[r+2]=255*Math.max(0,Math.min(1,s))}return n}(p);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const t=new Uint8Array(g.length/3),e=new Uint8Array(g.length/3),r=new Uint8Array(g.length/3);for(let n=0,i=0;n<g.length;n+=3,++i)t[i]=g[n],e[i]=g[n+1],r[i]=g[n+2];g=[t,e,r]}return g.width=p.width,g.height=p.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA;let n=V4()(r,"Item");null!==t&&(n=n.filter(e=>Number(U4()(e,"sample"))===t));for(let t=0;t<n.length;++t){const r=n[t];e[U4()(r,"name")]=r.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(r)return[r[0],r[5],r[10]];if(t){const[e,r,n]=t.getResolution();return[e*t.getWidth()/this.getWidth(),r*t.getHeight()/this.getHeight(),n*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const t=this.getOrigin(),e=this.getResolution(),r=t[0],n=t[1],i=r+e[0]*this.getWidth(),o=n+e[1]*this.getHeight();return[Math.min(r,i),Math.min(n,o),Math.max(r,i),Math.max(n,o)]}};class t6{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const r=this.getUint32(t,e),n=this.getUint32(t+4,e);let i;if(e){if(i=r+2**32*n,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}if(i=2**32*r+n,!Number.isSafeInteger(i))throw new Error(i+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}getInt64(t,e){let r=0;const n=(128&this._dataView.getUint8(t+(e?7:0)))>0;let i=!0;for(let o=0;o<8;o++){let s=this._dataView.getUint8(t+(e?o:7-o));n&&(i?0!==s&&(s=255&~(s-1),i=!1):s=255&~s),r+=s*256**o}return n&&(r=-r),r}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return G4(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class e6{constructor(t,e,r,n){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=r,this._bigTiff=n}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),r=this.readUint32(t+4);let n;if(this._littleEndian){if(n=e+2**32*r,!Number.isSafeInteger(n))throw new Error(n+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return n}if(n=2**32*e+r,!Number.isSafeInteger(n))throw new Error(n+" exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return n}readInt64(t){let e=0;const r=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0;let n=!0;for(let i=0;i<8;i++){let o=this._dataView.getUint8(t+(this._littleEndian?i:7-i));r&&(n?0!==o&&(o=255&~(o-1),n=!1):o=255&~o),e+=o*256**i}return r&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}const r6="\r\n\r\n";function n6(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);const e={};for(const[r,n]of t)e[r.toLowerCase()]=n;return e}function i6(t){return n6(t.split("\r\n").map(t=>{const e=t.split(":").map(t=>t.trim());return e[0]=e[0].toLowerCase(),e}))}function o6(t){let e,r,n;return t&&([,e,r,n]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),r=parseInt(r,10),n=parseInt(n,10)),{start:e,end:r,total:n}}var s6=r(7),a6=r(59),l6=r.n(a6),u6=r(2);class c6{constructor(t,e,r=null){this.offset=t,this.length=e,this.data=r}get top(){return this.offset+this.length}}class h6{constructor(t,e,r){this.offset=t,this.length=e,this.blockIds=r}}class f6 extends s6.a{constructor(t,{blockSize:e=65536,cacheSize:r=100}={}){super(),this.source=t,this.blockSize=e,this.blockCache=new l6.a({max:r}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const r=new Map,n=new Map,i=new Set;for(const{offset:e,length:o}of t){let t=e+o;const{fileSize:s}=this;null!==s&&(t=Math.min(t,s));for(let o=Math.floor(e/this.blockSize)*this.blockSize;o<t;o+=this.blockSize){const t=Math.floor(o/this.blockSize);this.blockCache.has(t)?r.set(t,this.blockCache.get(t)):this.blockRequests.has(t)?n.set(t,this.blockRequests.get(t)):(this.blockIdsToFetch.has(t)||this.blockIdsToFetch.add(t),i.add(t))}}await Object(u6.h)(),this.fetchBlocks(e);for(const t of i){const e=this.blockRequests.get(t),i=this.blockCache.get(t);if(e)n.set(t,e);else{if(!i)throw new Error(`Block ${t} is not in the block requests`);r.set(t,i)}}let o=await Promise.allSettled(Array.from(n.values()));if(o.some(t=>"rejected"===t.status)){const t=new Set;for(const[r,i]of Object(u6.i)(n.keys(),o)){const{rejected:n,reason:o}=i;n&&"AbortError"===o.name&&o.signal!==e&&(this.blockIdsToFetch.add(r),t.add(r))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(e);for(const e of t){const t=this.blockRequests.get(e);if(!t)throw new Error(`Block ${e} is not in the block requests`);n.set(e,t)}o=await Promise.allSettled(Array.from(n.values()))}}if(o.some(t=>"rejected"===t.status)){if(e&&e.aborted)throw new u6.a("Request was aborted");throw new u6.b(o.filter(t=>"rejected"===t.status).map(t=>t.reason),"Request failed")}const s=o.map(t=>t.value),a=new Map(Object(u6.i)(Array.from(n.keys()),s));for(const[t,e]of r)a.set(t,e);return this.readSliceData(t,a)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),r=this.source.fetch(e,t);for(let n=0;n<e.length;++n){const i=e[n];for(const e of i.blockIds){const i=(async()=>{try{const t=(await r)[n],i=e*this.blockSize,o=i-t.offset,s=Math.min(o+this.blockSize,t.data.byteLength),a=t.data.slice(o,s),l=new c6(i,a.byteLength,a);return this.blockCache.set(e,l),l}catch(e){throw"AbortError"===e.name&&(e.signal=t),e}finally{this.blockRequests.delete(e)}})();this.blockRequests.set(e,i)}}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort((t,e)=>t-e);if(0===e.length)return[];let r=[],n=null;const i=[];for(const t of e)null===n||n+1===t?(r.push(t),n=t):(i.push(new h6(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[t],n=t);return i.push(new h6(r[0]*this.blockSize,r.length*this.blockSize,r)),i}readSliceData(t,e){return t.map(t=>{const r=t.offset+t.length,n=Math.floor(t.offset/this.blockSize),i=Math.floor((t.offset+t.length)/this.blockSize),o=new ArrayBuffer(t.length),s=new Uint8Array(o);for(let o=n;o<=i;++o){const n=e.get(o),i=n.offset-t.offset,a=n.top-r;let l,u=0,c=0;i<0?u=-i:i>0&&(c=i),l=a<0?n.length-u:r-n.offset-u;const h=new Uint8Array(n.data,u,l);s.set(h,c)}return o})}}var p6=r(9);class d6 extends p6.b{constructor(t){super(),this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class g6 extends p6.a{constructor(t,e){super(t),this.credentials=e}async request({headers:t,credentials:e,signal:r}={}){const n=await fetch(this.url,{headers:t,credentials:e,signal:r});return new d6(n)}}class y6 extends p6.b{constructor(t,e){super(),this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class m6 extends p6.a{constructRequest(t,e){return new Promise((r,n)=>{const i=new XMLHttpRequest;i.open("GET",this.url),i.responseType="arraybuffer";for(const[e,r]of Object.entries(t))i.setRequestHeader(e,r);i.onload=()=>{const t=i.response;r(new y6(i,t))},i.onerror=n,i.onabort=()=>n(new u6.a("Request aborted")),i.send(),e&&(e.aborted&&i.abort(),e.addEventListener("abort",()=>i.abort()))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}var _6=r(60);class v6 extends s6.a{constructor(t,e,r,n){super(),this.client=t,this.headers=e,this.maxRanges=r,this.allowFullFile=n,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length,Promise.all(t.map(t=>this.fetchSlice(t,e))))}async fetchSlices(t,e){const r=await this.client.request({headers:{...this.headers,Range:"bytes="+t.map(({offset:t,length:e})=>`${t}-${t+e}`).join(",")},signal:e});if(r.ok){if(206===r.status){const{type:n,params:i}=function(t){const[e,...r]=t.split(";").map(t=>t.trim());return{type:e,params:n6(r.map(t=>t.split("=")))}}(r.getHeader("content-type"));if("multipart/byteranges"===n){const t=function(t,e){let r=null;const n=new TextDecoder("ascii"),i=[],o="--"+e,s=o+"--";for(let e=0;e<10;++e)n.decode(new Uint8Array(t,e,o.length))===o&&(r=e);if(null===r)throw new Error("Could not find initial boundary");for(;r<t.byteLength;){const e=n.decode(new Uint8Array(t,r,Math.min(o.length+1024,t.byteLength-r)));if(0===e.length||e.startsWith(s))break;if(!e.startsWith(o))throw new Error("Part does not start with boundary");const a=e.substr(o.length+2);if(0===a.length)break;const l=a.indexOf(r6),u=i6(a.substr(0,l)),{start:c,end:h,total:f}=o6(u["content-range"]),p=r+o.length+l+r6.length,d=parseInt(h,10)+1-parseInt(c,10);i.push({headers:u,data:t.slice(p,p+d),offset:c,length:d,fileSize:f}),r=p+d+4}return i}(await r.getData(),i.boundary);return this._fileSize=t[0].fileSize||null,t}const o=await r.getData(),{start:s,end:a,total:l}=o6(r.getHeader("content-range"));this._fileSize=l||null;const u=[{data:o,offset:s,length:a-s}];if(t.length>1){const r=await Promise.all(t.slice(1).map(t=>this.fetchSlice(t,e)));return u.concat(r)}return u}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await r.getData();return this._fileSize=t.byteLength,[{data:t,offset:0,length:t.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:r,length:n}=t,i=await this.client.request({headers:{...this.headers,Range:`bytes=${r}-${r+n}`},signal:e});if(i.ok){if(206===i.status){const t=await i.getData(),{total:e}=o6(i.getHeader("content-range"));return this._fileSize=e||null,{data:t,offset:r,length:n}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await i.getData();return this._fileSize=t.byteLength,{data:t,offset:0,length:t.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function b6(t,{blockSize:e,cacheSize:r}){return null===e?t:new f6(t,e,r)}function w6(t,{forceXHR:e=!1,...r}={}){return"function"!=typeof fetch||e?"undefined"!=typeof XMLHttpRequest?function(t,{headers:e={},maxRanges:r=0,allowFullFile:n=!1,...i}={}){const o=new m6(t);return b6(new v6(o,e,r,n),i)}(t,r):function(t,{headers:e={},maxRanges:r=0,allowFullFile:n=!1,...i}={}){const o=new _6.a(t);return b6(new v6(o,e,r,n),i)}(t,r):function(t,{headers:e={},credentials:r,maxRanges:n=0,allowFullFile:i=!1,...o}={}){const s=new g6(t,r);return b6(new v6(s,e,n,i),o)}(t,r)}s6.a;s6.a;r(64);const x6=Object(u6.f)(q4.e),E6=Object(u6.f)(q4.i),S6={};Object(u6.c)(S6,x6),Object(u6.c)(S6,E6);Object(u6.f)(q4.g);const I6={nextZero:(t,e)=>{let r=e;for(;0!==t[r];)r++;return r},readUshort:(t,e)=>t[e]<<8|t[e+1],readShort:(t,e)=>{const r=I6.ui8;return r[0]=t[e+1],r[1]=t[e+0],I6.i16[0]},readInt:(t,e)=>{const r=I6.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],I6.i32[0]},readUint:(t,e)=>{const r=I6.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],I6.ui32[0]},readASCII:(t,e,r)=>r.map(r=>String.fromCharCode(t[e+r])).join(""),readFloat:(t,e)=>{const r=I6.ui8;return Object(u6.g)(4,n=>{r[n]=t[e+3-n]}),I6.fl32[0]},readDouble:(t,e)=>{const r=I6.ui8;return Object(u6.g)(8,n=>{r[n]=t[e+7-n]}),I6.fl64[0]},writeUshort:(t,e,r)=>{t[e]=r>>8&255,t[e+1]=255&r},writeUint:(t,e,r)=>{t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=r>>0&255},writeASCII:(t,e,r)=>{Object(u6.g)(r.length,n=>{t[e+n]=r.charCodeAt(n)})},ui8:new Uint8Array(8)};I6.fl64=new Float64Array(I6.ui8.buffer),I6.writeDouble=(t,e,r)=>{I6.fl64[0]=r,Object(u6.g)(8,r=>{t[e+r]=I6.ui8[7-r]})};function O6(t){switch(t){case q4.h.BYTE:case q4.h.ASCII:case q4.h.SBYTE:case q4.h.UNDEFINED:return 1;case q4.h.SHORT:case q4.h.SSHORT:return 2;case q4.h.LONG:case q4.h.SLONG:case q4.h.FLOAT:case q4.h.IFD:return 4;case q4.h.RATIONAL:case q4.h.SRATIONAL:case q4.h.DOUBLE:case q4.h.LONG8:case q4.h.SLONG8:case q4.h.IFD8:return 8;default:throw new RangeError("Invalid field type: "+t)}}function C6(t,e,r,n){let i=null,o=null;const s=O6(e);switch(e){case q4.h.BYTE:case q4.h.ASCII:case q4.h.UNDEFINED:i=new Uint8Array(r),o=t.readUint8;break;case q4.h.SBYTE:i=new Int8Array(r),o=t.readInt8;break;case q4.h.SHORT:i=new Uint16Array(r),o=t.readUint16;break;case q4.h.SSHORT:i=new Int16Array(r),o=t.readInt16;break;case q4.h.LONG:case q4.h.IFD:i=new Uint32Array(r),o=t.readUint32;break;case q4.h.SLONG:i=new Int32Array(r),o=t.readInt32;break;case q4.h.LONG8:case q4.h.IFD8:i=new Array(r),o=t.readUint64;break;case q4.h.SLONG8:i=new Array(r),o=t.readInt64;break;case q4.h.RATIONAL:i=new Uint32Array(2*r),o=t.readUint32;break;case q4.h.SRATIONAL:i=new Int32Array(2*r),o=t.readInt32;break;case q4.h.FLOAT:i=new Float32Array(r),o=t.readFloat32;break;case q4.h.DOUBLE:i=new Float64Array(r),o=t.readFloat64;break;default:throw new RangeError("Invalid field type: "+e)}if(e!==q4.h.RATIONAL&&e!==q4.h.SRATIONAL)for(let e=0;e<r;++e)i[e]=o.call(t,n+e*s);else for(let e=0;e<r;e+=2)i[e]=o.call(t,n+e*s),i[e+1]=o.call(t,n+(e*s+4));return e===q4.h.ASCII?new TextDecoder("utf-8").decode(i):i}class T6{constructor(t,e,r){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=r}}class P6 extends Error{constructor(t){super("No image at index "+t),this.index=t}}class R6{async readRasters(t={}){const{window:e,width:r,height:n}=t;let{resX:i,resY:o,bbox:s}=t;const a=await this.getImage();let l=a;const u=await this.getImageCount(),c=a.getBoundingBox();if(e&&s)throw new Error('Both "bbox" and "window" passed.');if(r||n){if(e){const[t,r]=a.getOrigin(),[n,i]=a.getResolution();s=[t+e[0]*n,r+e[1]*i,t+e[2]*n,r+e[3]*i]}const t=s||c;if(r){if(i)throw new Error("Both width and resX passed");i=(t[2]-t[0])/r}if(n){if(o)throw new Error("Both width and resY passed");o=(t[3]-t[1])/n}}if(i||o){const t=[];for(let e=0;e<u;++e){const r=await this.getImage(e),{SubfileType:n,NewSubfileType:i}=r.fileDirectory;(0===e||2===n||1&i)&&t.push(r)}t.sort((t,e)=>t.getWidth()-e.getWidth());for(let e=0;e<t.length;++e){const r=t[e],n=(c[2]-c[0])/r.getWidth(),s=(c[3]-c[1])/r.getHeight();if(l=r,i&&i>n||o&&o>s)break}}let h=e;if(s){const[t,e]=a.getOrigin(),[r,n]=l.getResolution(a);h=[Math.round((s[0]-t)/r),Math.round((s[1]-e)/n),Math.round((s[2]-t)/r),Math.round((s[3]-e)/n)],h=[Math.min(h[0],h[2]),Math.min(h[1],h[3]),Math.max(h[0],h[2]),Math.max(h[1],h[3])]}return l.readRasters({...t,window:h})}}class L6 extends R6{constructor(t,e,r,n,i={}){super(),this.source=t,this.littleEndian=e,this.bigTiff=r,this.firstIFDOffset=n,this.cache=i.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const r=this.bigTiff?4048:1024;return new e6((await this.source.fetch([{offset:t,length:void 0!==e?e:r}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,r=this.bigTiff?8:2;let n=await this.getSlice(t);const i=this.bigTiff?n.readUint64(t):n.readUint16(t),o=i*e+(this.bigTiff?16:6);n.covers(t,o)||(n=await this.getSlice(t,o));const s={};let a=t+(this.bigTiff?8:2);for(let t=0;t<i;a+=e,++t){const t=n.readUint16(a),e=n.readUint16(a+2),r=this.bigTiff?n.readUint64(a+4):n.readUint32(a+4);let i,o;const l=O6(e),u=a+(this.bigTiff?12:8);if(l*r<=(this.bigTiff?8:4))i=C6(n,e,r,u);else{const t=n.readOffset(u),o=O6(e)*r;if(n.covers(t,o))i=C6(n,e,r,t);else{i=C6(await this.getSlice(t,o),e,r,t)}}o=1===r&&-1===q4.d.indexOf(t)&&e!==q4.h.RATIONAL&&e!==q4.h.SRATIONAL?i[0]:i,s[q4.e[t]]=o}const l=function(t){const e=t.GeoKeyDirectory;if(!e)return null;const r={};for(let n=4;n<=4*e[3];n+=4){const i=q4.i[e[n]],o=e[n+1]?q4.e[e[n+1]]:null,s=e[n+2],a=e[n+3];let l=null;if(o){if(l=t[o],null==l)throw new Error(`Could not get value of geoKey '${i}'.`);"string"==typeof l?l=l.substring(a,a+s-1):l.subarray&&(l=l.subarray(a,a+s),1===s&&(l=l[0]))}else l=a;r[i]=l}return r}(s),u=n.readOffset(t+r+e*i);return new T6(s,l,u)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(0===t)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){if(e instanceof P6)throw new P6(t);throw e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(0===e.nextIFDByteOffset)throw new P6(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new Q4(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;for(;e;)try{await this.requestIFD(t),++t}catch(t){if(!(t instanceof P6))throw t;e=!1}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const e="GDAL_STRUCTURAL_METADATA_SIZE=",r=e.length+100;let n=await this.getSlice(t,r);if(e===C6(n,q4.h.ASCII,e.length,t)){const e=C6(n,q4.h.ASCII,r,t).split("\n")[0],i=Number(e.split("=")[1].split(" ")[0])+e.length;i>r&&(n=await this.getSlice(t,i));const o=C6(n,q4.h.ASCII,i,t);this.ghostValues={},o.split("\n").filter(t=>t.length>0).map(t=>t.split("=")).forEach(([t,e])=>{this.ghostValues[t]=e})}return this.ghostValues}static async fromSource(t,e,r){const n=(await t.fetch([{offset:0,length:1024}],r))[0],i=new t6(n),o=i.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=i.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");l=!0;if(8!==i.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const u=l?i.getUint64(8,s):i.getUint32(4,s);return new L6(t,s,l,u,e)}close(){return"function"==typeof this.source.close&&this.source.close()}}class M6 extends R6{constructor(t,e){super(),this.mainFile=t,this.overviewFiles=e,this.imageFiles=[t].concat(e),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(t),this.fileDirectoriesPerFile}async getImage(t=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let e=0,r=0;for(let n=0;n<this.imageFiles.length;n++){const i=this.imageFiles[n];for(let o=0;o<this.imageCounts[n];o++){if(t===e){const t=await i.requestIFD(r);return new Q4(t.fileDirectory,t.geoKeyDirectory,i.dataView,i.littleEndian,i.cache,i.source)}e++,r++}r=0}throw new RangeError("Invalid image index")}async getImageCount(){if(null!==this.imageCount)return this.imageCount;const t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(t),this.imageCount=this.imageCounts.reduce((t,e)=>t+e,0),this.imageCount}}var k6=new Blob(['function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){asyncGeneratorStep(i,n,a,o,s,"next",e)}function s(e){asyncGeneratorStep(i,n,a,o,s,"throw",e)}o(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var runtime={exports:{}};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),o=new A(n||[]);return i._invoke=function(e,t,r){var n=u;return function(a,i){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===a)throw i;return I()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=x(o,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===u)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var l=c(e,t,r);if("normal"===l.type){if(n=r.done?p:d,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=p,r.method="throw",r.arg=l.arg)}}}(e,r,o),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var u="suspendedStart",d="suspendedYield",h="executing",p="completed",m={};function g(){}function y(){}function _(){}var b={};l(b,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(M([])));w&&w!==r&&n.call(w,i)&&(b=w);var k=_.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(a,i,o,s){var l=c(e[a],e,i);if("throw"!==l.type){var f=l.arg,u=f.value;return u&&"object"===_typeof(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(u).then((function(e){f.value=e,o(f)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a \'throw\' method")}return m}var a=c(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function M(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return y.prototype=_,l(k,"constructor",_),l(_,"constructor",y),y.displayName=l(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new E(f(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(k),l(k,s,"Generator"),l(k,i,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),f=n.call(o,"finallyLoc");if(l&&f){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;D(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(runtime);var worker={},isObservable=function(e){return!!e&&("symbol"===_typeof(Symbol.observable)&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},common$1={},serializers={};function extendSerializer(e,t){var r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:function(e){return t.deserialize(e,r)},serialize:function(e){return t.serialize(e,n)}}}Object.defineProperty(serializers,"__esModule",{value:!0}),serializers.DefaultSerializer=serializers.extendSerializer=void 0,serializers.extendSerializer=extendSerializer;var DefaultErrorSerializer={deserialize:function(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize:function(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},isSerializedError=function(e){return e&&"object"===_typeof(e)&&"__error_marker"in e&&"$$error"===e.__error_marker};serializers.DefaultSerializer={deserialize:function(e){return isSerializedError(e)?DefaultErrorSerializer.deserialize(e):e},serialize:function(e){return e instanceof Error?DefaultErrorSerializer.serialize(e):e}},Object.defineProperty(common$1,"__esModule",{value:!0}),common$1.serialize=common$1.deserialize=common$1.registerSerializer=void 0;var serializers_1=serializers,registeredSerializer=serializers_1.DefaultSerializer;function registerSerializer(e){registeredSerializer=serializers_1.extendSerializer(registeredSerializer,e)}function deserialize(e){return registeredSerializer.deserialize(e)}function serialize(e){return registeredSerializer.serialize(e)}common$1.registerSerializer=registerSerializer,common$1.deserialize=deserialize,common$1.serialize=serialize;var transferable={},symbols={};Object.defineProperty(symbols,"__esModule",{value:!0}),symbols.$worker=symbols.$transferable=symbols.$terminate=symbols.$events=symbols.$errors=void 0,symbols.$errors=Symbol("thread.errors"),symbols.$events=Symbol("thread.events"),symbols.$terminate=Symbol("thread.terminate"),symbols.$transferable=Symbol("thread.transferable"),symbols.$worker=Symbol("thread.worker"),Object.defineProperty(transferable,"__esModule",{value:!0}),transferable.Transfer=transferable.isTransferDescriptor=void 0;var symbols_1=symbols;function isTransferable(e){return!(!e||"object"!==_typeof(e))}function isTransferDescriptor(e){return e&&"object"===_typeof(e)&&e[symbols_1.$transferable]}function Transfer$1(e,t){var r;if(!t){if(!isTransferable(e))throw Error();t=[e]}return _defineProperty(r={},symbols_1.$transferable,!0),_defineProperty(r,"send",e),_defineProperty(r,"transferables",t),r}transferable.isTransferDescriptor=isTransferDescriptor,transferable.Transfer=Transfer$1;var messages$1={},exports,MasterMessageType,WorkerMessageType;exports=messages$1,Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorkerMessageType=exports.MasterMessageType=void 0,(MasterMessageType=exports.MasterMessageType||(exports.MasterMessageType={})).cancel="cancel",MasterMessageType.run="run",(WorkerMessageType=exports.WorkerMessageType||(exports.WorkerMessageType={})).error="error",WorkerMessageType.init="init",WorkerMessageType.result="result",WorkerMessageType.running="running",WorkerMessageType.uncaughtError="uncaughtError";var implementation$1={},implementation_browser={};Object.defineProperty(implementation_browser,"__esModule",{value:!0});var isWorkerRuntime$2=function(){var e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster$2=function(e,t){self.postMessage(e,t)},subscribeToMasterMessages$2=function(e){var t=function(t){e(t.data)};return self.addEventListener("message",t),function(){self.removeEventListener("message",t)}};implementation_browser.default={isWorkerRuntime:isWorkerRuntime$2,postMessageToMaster:postMessageToMaster$2,subscribeToMasterMessages:subscribeToMasterMessages$2};var implementation_tinyWorker={};Object.defineProperty(implementation_tinyWorker,"__esModule",{value:!0}),"undefined"==typeof self&&(commonjsGlobal.self=commonjsGlobal);var isWorkerRuntime$1=function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster$1=function(e){self.postMessage(e)},muxingHandlerSetUp=!1,messageHandlers=new Set,subscribeToMasterMessages$1=function(e){muxingHandlerSetUp||(self.addEventListener("message",(function(e){messageHandlers.forEach((function(t){return t(e.data)}))})),muxingHandlerSetUp=!0),messageHandlers.add(e);return function(){return messageHandlers.delete(e)}};implementation_tinyWorker.default={isWorkerRuntime:isWorkerRuntime$1,postMessageToMaster:postMessageToMaster$1,subscribeToMasterMessages:subscribeToMasterMessages$1};var implementation_worker_threads={},worker_threads={},implementation;function selectImplementation(){return"function"==typeof __non_webpack_require__?__non_webpack_require__("worker_threads"):eval("require")("worker_threads")}function getImplementation(){return implementation||(implementation=selectImplementation()),implementation}Object.defineProperty(worker_threads,"__esModule",{value:!0}),worker_threads.default=getImplementation;var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation_worker_threads,"__esModule",{value:!0});var worker_threads_1=__importDefault$1(worker_threads);function assertMessagePort(e){if(!e)throw Error("Invariant violation: MessagePort to parent is not available.");return e}var isWorkerRuntime=function(){return!worker_threads_1.default().isMainThread},postMessageToMaster=function(e,t){assertMessagePort(worker_threads_1.default().parentPort).postMessage(e,t)},subscribeToMasterMessages=function(e){var t=worker_threads_1.default().parentPort;if(!t)throw Error("Invariant violation: MessagePort to parent is not available.");var r=function(t){e(t)};return assertMessagePort(t).on("message",r),function(){assertMessagePort(t).off("message",r)}};function testImplementation(){worker_threads_1.default()}implementation_worker_threads.default={isWorkerRuntime:isWorkerRuntime,postMessageToMaster:postMessageToMaster,subscribeToMasterMessages:subscribeToMasterMessages,testImplementation:testImplementation};var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation$1,"__esModule",{value:!0});var implementation_browser_1=__importDefault(implementation_browser),implementation_tiny_worker_1=__importDefault(implementation_tinyWorker),implementation_worker_threads_1=__importDefault(implementation_worker_threads),runningInNode="undefined"!=typeof process&&"browser"!==process.arch&&"pid"in process;function selectNodeImplementation(){try{return implementation_worker_threads_1.default.testImplementation(),implementation_worker_threads_1.default}catch(e){return implementation_tiny_worker_1.default}}implementation$1.default=runningInNode?selectNodeImplementation():implementation_browser_1.default,function(e){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.expose=e.isWorkerRuntime=e.Transfer=e.registerSerializer=void 0;var n=r(isObservable),a=common$1,i=transferable,o=messages$1,s=r(implementation$1),l=common$1;Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=transferable;Object.defineProperty(e,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),e.isWorkerRuntime=s.default.isWorkerRuntime;var c=!1,u=new Map,d=function(e){return e&&e.type===o.MasterMessageType.run},h=function(e){return n.default(e)||function(e){return e&&"object"===_typeof(e)&&"function"==typeof e.subscribe}(e)};function p(e){return i.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){var r=p(t),n=r.payload,i=r.transferables,l={type:o.WorkerMessageType.error,uid:e,error:a.serialize(n)};s.default.postMessageToMaster(l,i)}function g(e,t,r){var n=p(r),a=n.payload,i=n.transferables,l={type:o.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:a};s.default.postMessageToMaster(l,i)}function y(e,t){var r={type:o.WorkerMessageType.running,uid:e,resultType:t};s.default.postMessageToMaster(r)}function _(e){try{var t={type:o.WorkerMessageType.uncaughtError,error:a.serialize(e)};s.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\\nLatest error:",t,"\\nOriginal error:",e)}}function b(e,r,n){return t(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,o,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=r.apply(void 0,_toConsumableArray(n)),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",m(e,t.t0));case 7:if(o=h(i)?"observable":"promise",y(e,o),!h(i)){t.next=14;break}s=i.subscribe((function(t){return g(e,!1,a.serialize(t))}),(function(t){m(e,a.serialize(t)),u.delete(e)}),(function(){g(e,!0),u.delete(e)})),u.set(e,s),t.next=24;break;case 14:return t.prev=14,t.next=17,i;case 17:l=t.sent,g(e,!0,a.serialize(l)),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(14),m(e,a.serialize(t.t1));case 24:case"end":return t.stop()}}),t,null,[[0,4],[14,21]])})))}e.expose=function(e){if(!s.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(c)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(c=!0,"function"==typeof e)s.default.subscribeToMasterMessages((function(t){d(t)&&!t.method&&b(t.uid,e,t.args.map(a.deserialize))})),t={type:o.WorkerMessageType.init,exposed:{type:"function"}},s.default.postMessageToMaster(t);else{if("object"!==_typeof(e)||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: ".concat(e));s.default.subscribeToMasterMessages((function(t){d(t)&&t.method&&b(t.uid,e[t.method],t.args.map(a.deserialize))})),function(e){var t={type:o.WorkerMessageType.init,exposed:{type:"module",methods:e}};s.default.postMessageToMaster(t)}(Object.keys(e).filter((function(t){return"function"==typeof e[t]})))}var t;s.default.subscribeToMasterMessages((function(e){if((n=e)&&n.type===o.MasterMessageType.cancel){var t=e.uid,r=u.get(t);r&&(r.unsubscribe(),u.delete(t))}var n}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&s.default.isWorkerRuntime()&&(self.addEventListener("error",(function(e){setTimeout((function(){return _(e.error||e)}),250)})),self.addEventListener("unhandledrejection",(function(e){var t=e.reason;t&&"string"==typeof t.message&&setTimeout((function(){return _(t)}),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&s.default.isWorkerRuntime()&&(process.on("uncaughtException",(function(e){setTimeout((function(){return _(e)}),250)})),process.on("unhandledRejection",(function(e){e&&"string"==typeof e.message&&setTimeout((function(){return _(e)}),250)})))}(worker);var WorkerContext=getDefaultExportFromCjs(worker),expose=WorkerContext.expose;WorkerContext.registerSerializer;var Transfer=WorkerContext.Transfer,registry=new Map;function addDecoder(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){return registry.set(e,t)}))}function getDecoder(e){return _getDecoder.apply(this,arguments)}function _getDecoder(){return(_getDecoder=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=registry.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decode(e,t){return _decode.apply(this,arguments)}function _decode(){return(_decode=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getDecoder(t);case 2:return n=e.sent,e.next=5,n.decode(t,r);case 5:return a=e.sent,e.abrupt("return",Transfer(a));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decodeRowAcc(e,t){var r=e.length-t,n=0;do{for(var a=t;a>0;a--)e[n+t]+=e[n],n++;r-=t}while(r>0)}function decodeRowFloatingPoint(e,t,r){for(var n=0,a=e.length,i=a/r;a>t;){for(var o=t;o>0;--o)e[n+t]+=e[n],++n;a-=t}for(var s=e.slice(),l=0;l<i;++l)for(var f=0;f<r;++f)e[r*l+f]=s[(r-f-1)*i+l]}function applyPredictor(e,t,r,n,a,i){if(!t||1===t)return e;for(var o=0;o<a.length;++o){if(a[o]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(a[o]!==a[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var s=a[0]/8,l=2===i?1:a.length,f=0;f<n&&!(f*l*r*s>=e.byteLength);++f){var c=void 0;if(2===t){switch(a[0]){case 8:c=new Uint8Array(e,f*l*r*s,l*r*s);break;case 16:c=new Uint16Array(e,f*l*r*s,l*r*s/2);break;case 32:c=new Uint32Array(e,f*l*r*s,l*r*s/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(a[0]," bits per sample."))}decodeRowAcc(c,l)}else 3===t&&decodeRowFloatingPoint(c=new Uint8Array(e,f*l*r*s,l*r*s),l,s)}return e}addDecoder([void 0,1],(function(){return Promise.resolve().then((function(){return raw})).then((function(e){return e.default}))})),addDecoder(5,(function(){return Promise.resolve().then((function(){return lzw})).then((function(e){return e.default}))})),addDecoder(6,(function(){throw new Error("old style JPEG compression is not supported.")})),addDecoder(7,(function(){return Promise.resolve().then((function(){return jpeg})).then((function(e){return e.default}))})),addDecoder([8,32946],(function(){return Promise.resolve().then((function(){return deflate})).then((function(e){return e.default}))})),addDecoder(32773,(function(){return Promise.resolve().then((function(){return packbits})).then((function(e){return e.default}))})),addDecoder(34887,(function(){return Promise.resolve().then((function(){return lerc})).then((function(e){return e.default}))})),expose(decode);var BaseDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"decode",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decodeBlock(r);case 2:if(n=e.sent,1===(a=t.Predictor||1)){e.next=9;break}return i=!t.StripOffsets,o=i?t.TileWidth:t.ImageWidth,s=i?t.TileLength:t.RowsPerStrip||t.ImageLength,e.abrupt("return",applyPredictor(n,a,o,s,t.BitsPerSample,t.PlanarConfiguration));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),RawDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return e}}]),r}(),raw=Object.freeze({__proto__:null,default:RawDecoder}),MIN_BITS=9,CLEAR_CODE=256,EOI_CODE=257,MAX_BYTELENGTH=12;function getByte(e,t,r){var n=t%8,a=Math.floor(t/8),i=8-n,o=t+r-8*(a+1),s=8*(a+2)-(t+r),l=8*(a+2)-t;if(s=Math.max(0,s),a>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),EOI_CODE;var f=e[a]&Math.pow(2,8-n)-1,c=f<<=r-i;if(a+1<e.length){var u=e[a+1]>>>s;c+=u<<=Math.max(0,r-l)}if(o>8&&a+2<e.length){var d=8*(a+3)-(t+r);c+=e[a+2]>>>d}return c}function appendReversed(e,t){for(var r=t.length-1;r>=0;r--)e.push(t[r]);return e}function decompress(e){for(var t=new Uint16Array(4093),r=new Uint8Array(4093),n=0;n<=257;n++)t[n]=4096,r[n]=n;var a=258,i=MIN_BITS,o=0;function s(){a=258,i=MIN_BITS}function l(e){var t=getByte(e,o,i);return o+=i,t}function f(e,n){return r[a]=n,t[a]=e,++a-1}function c(e){for(var n=[],a=e;4096!==a;a=t[a])n.push(r[a]);return n}var u=[];s();for(var d,h=new Uint8Array(e),p=l(h);p!==EOI_CODE;){if(p===CLEAR_CODE){for(s(),p=l(h);p===CLEAR_CODE;)p=l(h);if(p===EOI_CODE)break;if(p>CLEAR_CODE)throw new Error("corrupted code at scanline ".concat(p));appendReversed(u,c(p)),d=p}else if(p<a){var m=c(p);appendReversed(u,m),f(d,m[m.length-1]),d=p}else{var g=c(d);if(!g)throw new Error("Bogus entry. Not in dictionary, ".concat(d," / ").concat(a,", position: ").concat(o));appendReversed(u,g),u.push(g[g.length-1]),f(d,g[g.length-1]),d=p}a+1>=Math.pow(2,i)&&(i===MAX_BYTELENGTH?d=void 0:i++),p=l(h)}return new Uint8Array(u)}var LZWDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return decompress(e).buffer}}]),r}(),lzw=Object.freeze({__proto__:null,default:LZWDecoder}),dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),dctCos1=4017,dctSin1=799,dctCos3=3406,dctSin3=2276,dctCos6=1567,dctSin6=3784,dctSqrt2=5793,dctSqrt1d2=2896;function buildHuffmanTable(e,t){for(var r=0,n=[],a=16;a>0&&!e[a-1];)--a;n.push({children:[],index:0});for(var i,o=n[0],s=0;s<a;s++){for(var l=0;l<e[s];l++){for((o=n.pop()).children[o.index]=t[r];o.index>0;)o=n.pop();for(o.index++,n.push(o);n.length<=s;)n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i;r++}s+1<a&&(n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i)}return n[0].children}function decodeScan(e,t,r,n,a,i,o,s,l){var f=r.mcusPerLine,c=r.progressive,u=t,d=t,h=0,p=0;function m(){if(p>0)return p--,h>>p&1;if(255===(h=e[d++])){var t=e[d++];if(t)throw new Error("unexpected marker: ".concat((h<<8|t).toString(16)))}return p=7,h>>>7}function g(e){for(var t,r=e;null!==(t=m());){if("number"==typeof(r=r[t]))return r;if("object"!==_typeof(r))throw new Error("invalid huffman sequence")}return null}function y(e){for(var t=e,r=0;t>0;){var n=m();if(null===n)return;r=r<<1|n,--t}return r}function _(e){var t=y(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var v,w=0;function k(e,t,r,n,a){var i=r%f,o=(r/f|0)*e.v+n,s=i*e.h+a;t(e,e.blocks[o][s])}function T(e,t,r){var n=r/e.blocksPerLine|0,a=r%e.blocksPerLine;t(e,e.blocks[n][a])}var E,x,S,D,A,M,I=n.length;M=c?0===i?0===s?function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r)<<l;e.pred+=n,t[0]=e.pred}:function(e,t){t[0]|=m()<<l}:0===s?function(e,t){if(b>0)b--;else for(var r=i,n=o;r<=n;){var a=g(e.huffmanTableAC),s=15&a,f=a>>4;if(0===s){if(f<15){b=y(f)+(1<<f)-1;break}r+=16}else t[dctZigZag[r+=f]]=_(s)*(1<<l),r++}}:function(e,t){for(var r=i,n=o,a=0;r<=n;){var s=dctZigZag[r],f=t[s]<0?-1:1;switch(w){case 0:var c=g(e.huffmanTableAC),u=15&c;if(a=c>>4,0===u)a<15?(b=y(a)+(1<<a),w=4):(a=16,w=1);else{if(1!==u)throw new Error("invalid ACn encoding");v=_(u),w=a?2:3}continue;case 1:case 2:t[s]?t[s]+=(m()<<l)*f:0==--a&&(w=2===w?3:0);break;case 3:t[s]?t[s]+=(m()<<l)*f:(t[s]=v<<l,w=0);break;case 4:t[s]&&(t[s]+=(m()<<l)*f)}r++}4===w&&0==--b&&(w=0)}:function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r);e.pred+=n,t[0]=e.pred;for(var a=1;a<64;){var i=g(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15)break;a+=16}else t[dctZigZag[a+=s]]=_(o),a++}};var R,O,C=0;O=1===I?n[0].blocksPerLine*n[0].blocksPerColumn:f*r.mcusPerColumn;for(var P=a||O;C<O;){for(x=0;x<I;x++)n[x].pred=0;if(b=0,1===I)for(E=n[0],A=0;A<P;A++)T(E,M,C),C++;else for(A=0;A<P;A++){for(x=0;x<I;x++){var L=E=n[x],U=L.h,B=L.v;for(S=0;S<B;S++)for(D=0;D<U;D++)k(E,M,C,S,D)}if(++C===O)break}if(p=0,(R=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(R>=65488&&R<=65495))break;d+=2}return d-u}function buildComponentData(e,t){var r=[],n=t.blocksPerLine,a=t.blocksPerColumn,i=n<<3,o=new Int32Array(64),s=new Uint8Array(64);function l(e,r,n){var a,i,o,s,l,f,c,u,d,h,p=t.quantizationTable,m=n;for(h=0;h<64;h++)m[h]=e[h]*p[h];for(h=0;h<8;++h){var g=8*h;0!==m[1+g]||0!==m[2+g]||0!==m[3+g]||0!==m[4+g]||0!==m[5+g]||0!==m[6+g]||0!==m[7+g]?(a=dctSqrt2*m[0+g]+128>>8,i=dctSqrt2*m[4+g]+128>>8,o=m[2+g],s=m[6+g],l=dctSqrt1d2*(m[1+g]-m[7+g])+128>>8,u=dctSqrt1d2*(m[1+g]+m[7+g])+128>>8,f=m[3+g]<<4,c=m[5+g]<<4,d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+128>>8,o=o*dctCos6-s*dctSin6+128>>8,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+g]=a+u,m[7+g]=a-u,m[1+g]=i+c,m[6+g]=i-c,m[2+g]=o+f,m[5+g]=o-f,m[3+g]=s+l,m[4+g]=s-l):(d=dctSqrt2*m[0+g]+512>>10,m[0+g]=d,m[1+g]=d,m[2+g]=d,m[3+g]=d,m[4+g]=d,m[5+g]=d,m[6+g]=d,m[7+g]=d)}for(h=0;h<8;++h){var y=h;0!==m[8+y]||0!==m[16+y]||0!==m[24+y]||0!==m[32+y]||0!==m[40+y]||0!==m[48+y]||0!==m[56+y]?(a=dctSqrt2*m[0+y]+2048>>12,i=dctSqrt2*m[32+y]+2048>>12,o=m[16+y],s=m[48+y],l=dctSqrt1d2*(m[8+y]-m[56+y])+2048>>12,u=dctSqrt1d2*(m[8+y]+m[56+y])+2048>>12,f=m[24+y],c=m[40+y],d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+2048>>12,o=o*dctCos6-s*dctSin6+2048>>12,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+y]=a+u,m[56+y]=a-u,m[8+y]=i+c,m[48+y]=i-c,m[16+y]=o+f,m[40+y]=o-f,m[24+y]=s+l,m[32+y]=s-l):(d=dctSqrt2*n[h+0]+8192>>14,m[0+y]=d,m[8+y]=d,m[16+y]=d,m[24+y]=d,m[32+y]=d,m[40+y]=d,m[48+y]=d,m[56+y]=d)}for(h=0;h<64;++h){var _=128+(m[h]+8>>4);r[h]=_<0?0:_>255?255:_}}for(var f=0;f<a;f++){for(var c=f<<3,u=0;u<8;u++)r.push(new Uint8Array(i));for(var d=0;d<n;d++){l(t.blocks[f][d],s,o);for(var h=0,p=d<<3,m=0;m<8;m++)for(var g=r[c+m],y=0;y<8;y++)g[p+y]=s[h++]}}return r}var JpegStreamReader=function(){function e(){_classCallCheck(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return _createClass(e,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(e){var t=0;function r(){var r=e[t]<<8|e[t+1];return t+=2,r}function n(e){var t,r,n=0,a=0;for(r in e.components)e.components.hasOwnProperty(r)&&(n<(t=e.components[r]).h&&(n=t.h),a<t.v&&(a=t.v));var i=Math.ceil(e.samplesPerLine/8/n),o=Math.ceil(e.scanLines/8/a);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/a),f=i*t.h,c=o*t.v,u=[],d=0;d<c;d++){for(var h=[],p=0;p<f;p++)h.push(new Int32Array(64));u.push(h)}t.blocksPerLine=s,t.blocksPerColumn=l,t.blocks=u}e.maxH=n,e.maxV=a,e.mcusPerLine=i,e.mcusPerColumn=o}var a,i,o=r();if(65496!==o)throw new Error("SOI not found");for(o=r();65497!==o;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var s=(a=void 0,i=void 0,a=r(),i=e.subarray(t,t+a-2),t+=i.length,i);65504===o&&74===s[0]&&70===s[1]&&73===s[2]&&70===s[3]&&0===s[4]&&(this.jfif={version:{major:s[5],minor:s[6]},densityUnits:s[7],xDensity:s[8]<<8|s[9],yDensity:s[10]<<8|s[11],thumbWidth:s[12],thumbHeight:s[13],thumbData:s.subarray(14,14+3*s[12]*s[13])}),65518===o&&65===s[0]&&100===s[1]&&111===s[2]&&98===s[3]&&101===s[4]&&0===s[5]&&(this.adobe={version:s[6],flags0:s[7]<<8|s[8],flags1:s[9]<<8|s[10],transformCode:s[11]});break;case 65499:for(var l=r()+t-2;t<l;){var f=e[t++],c=new Int32Array(64);if(f>>4==0)for(var u=0;u<64;u++){c[dctZigZag[u]]=e[t++]}else{if(f>>4!=1)throw new Error("DQT: invalid table spec");for(var d=0;d<64;d++){c[dctZigZag[d]]=r()}}this.quantizationTables[15&f]=c}break;case 65472:case 65473:case 65474:r();for(var h={extended:65473===o,progressive:65474===o,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},p=e[t++],m=void 0,g=0;g<p;g++){m=e[t];var y=e[t+1]>>4,_=15&e[t+1],b=e[t+2];h.componentsOrder.push(m),h.components[m]={h:y,v:_,quantizationIdx:b},t+=3}n(h),this.frames.push(h);break;case 65476:for(var v=r(),w=2;w<v;){for(var k=e[t++],T=new Uint8Array(16),E=0,x=0;x<16;x++,t++)T[x]=e[t],E+=T[x];for(var S=new Uint8Array(E),D=0;D<E;D++,t++)S[D]=e[t];w+=17+E,k>>4==0?this.huffmanTablesDC[15&k]=buildHuffmanTable(T,S):this.huffmanTablesAC[15&k]=buildHuffmanTable(T,S)}break;case 65501:r(),this.resetInterval=r();break;case 65498:r();for(var A=e[t++],M=[],I=this.frames[0],R=0;R<A;R++){var O=I.components[e[t++]],C=e[t++];O.huffmanTableDC=this.huffmanTablesDC[C>>4],O.huffmanTableAC=this.huffmanTablesAC[15&C],M.push(O)}var P=e[t++],L=e[t++],U=e[t++],B=decodeScan(e,t,I,M,this.resetInterval,P,L,U>>4,15&U);t+=B;break;case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker ".concat(o.toString(16)))}o=r()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var t=0;t<this.frames.length;t++)for(var r=this.frames[t].components,n=0,a=Object.keys(r);n<a.length;n++){var i=a[n];r[i].quantizationTable=this.quantizationTables[r[i].quantizationIdx],delete r[i].quantizationIdx}for(var o=e[0],s=o.components,l=o.componentsOrder,f=[],c=o.samplesPerLine,u=o.scanLines,d=0;d<l.length;d++){var h=s[l[d]];f.push({lines:buildComponentData(o,h),scaleX:h.h/o.maxH,scaleY:h.v/o.maxV})}for(var p=new Uint8Array(c*u*f.length),m=0,g=0;g<u;++g)for(var y=0;y<c;++y)for(var _=0;_<f.length;++_){var b=f[_];p[m]=b.lines[0|g*b.scaleY][0|y*b.scaleX],++m}return p}}]),e}(),JpegDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).reader=new JpegStreamReader,e.JPEGTables&&n.reader.parse(e.JPEGTables),n}return _createClass(r,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}]),r}(),jpeg=Object.freeze({__proto__:null,default:JpegDecoder});function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES$1+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES$1);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);var adler32=function(e,t,r,n){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{i=i+(a=a+t[n++]|0)|0}while(--o);a%=65521,i%=65521}return a|i<<16|0},adler32_1=adler32,makeTable=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t},crcTable=new Uint32Array(makeTable()),crc32=function(e,t,r,n){var a=crcTable,i=n+r;e^=-1;for(var o=n;o<i;o++)e=e>>>8^a[255&(e^t[o])];return-1^e},crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},_has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==_typeof(r))throw new TypeError(r+"must be non-object");for(var n in r)_has(r,n)&&(e[n]=r[n])}}return e},flattenChunks=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var a=new Uint8Array(t),i=0,o=0,s=e.length;i<s;i++){var l=e[i];a.set(l,o),o+=l.length}return a},common={assign:assign,flattenChunks:flattenChunks},STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,a,i,o=e.length,s=0;for(a=0;a<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),i=0,a=0;i<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|63&r):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|63&r):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|63&r);return t},buf2binstring=function(e,t){if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},buf2string=function(e,t){var r,n,a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var i=new Array(2*a);for(n=0,r=0;r<a;){var o=e[r++];if(o<128)i[n++]=o;else{var s=_utf8len[o];if(s>4)i[n++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&r<a;)o=o<<6|63&e[r++],s--;s>1?i[n++]=65533:o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|1023&o)}}}return buf2binstring(i,n)},utf8border=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+_utf8len[e[r]]>t?r:t},strings={string2buf:string2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,BAD$1=30,TYPE$1=12,inffast=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=e.state;r=e.next_in,E=e.input,n=r+(e.avail_in-5),a=e.next_out,x=e.output,i=a-(t-e.avail_out),o=a+(e.avail_out-257),s=S.dmax,l=S.wsize,f=S.whave,c=S.wnext,u=S.window,d=S.hold,h=S.bits,p=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,y=(1<<S.distbits)-1;e:do{h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=p[d&g];t:for(;;){if(d>>>=b=_>>>24,h-=b,0===(b=_>>>16&255))x[a++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=p[(65535&_)+(d&(1<<b)-1)];continue t}if(32&b){S.mode=TYPE$1;break e}e.msg="invalid literal/length code",S.mode=BAD$1;break e}v=65535&_,(b&=15)&&(h<b&&(d+=E[r++]<<h,h+=8),v+=d&(1<<b)-1,d>>>=b,h-=b),h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=m[d&y];r:for(;;){if(d>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",S.mode=BAD$1;break e}if(w=65535&_,h<(b&=15)&&(d+=E[r++]<<h,(h+=8)<b&&(d+=E[r++]<<h,h+=8)),(w+=d&(1<<b)-1)>s){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(d>>>=b,h-=b,w>(b=a-i)){if((b=w-b)>f&&S.sane){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(k=0,T=u,0===c){if(k+=l-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}else if(c<b){if(k+=l+c-b,(b-=c)<v){v-=b;do{x[a++]=u[k++]}while(--b);if(k=0,c<v){v-=b=c;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}}else if(k+=c-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}for(;v>2;)x[a++]=T[k++],x[a++]=T[k++],x[a++]=T[k++],v-=3;v&&(x[a++]=T[k++],v>1&&(x[a++]=T[k++]))}else{k=a-w;do{x[a++]=x[k++],x[a++]=x[k++],x[a++]=x[k++],v-=3}while(v>2);v&&(x[a++]=x[k++],v>1&&(x[a++]=x[k++]))}break}}break}}while(r<n&&a<o);r-=v=h>>3,d&=(1<<(h-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=a<o?o-a+257:257-(a-o),S.hold=d,S.bits=h},MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h,p,m,g,y=s.bits,_=0,b=0,v=0,w=0,k=0,T=0,E=0,x=0,S=0,D=0,A=null,M=0,I=new Uint16Array(MAXBITS+1),R=new Uint16Array(MAXBITS+1),O=null,C=0;for(_=0;_<=MAXBITS;_++)I[_]=0;for(b=0;b<n;b++)I[t[r+b]]++;for(k=y,w=MAXBITS;w>=1&&0===I[w];w--);if(k>w&&(k=w),0===w)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(v=1;v<w&&0===I[v];v++);for(k<v&&(k=v),x=1,_=1;_<=MAXBITS;_++)if(x<<=1,(x-=I[_])<0)return-1;if(x>0&&(e===CODES$1||1!==w))return-1;for(R[1]=0,_=1;_<MAXBITS;_++)R[_+1]=R[_]+I[_];for(b=0;b<n;b++)0!==t[r+b]&&(o[R[t[r+b]]++]=b);if(e===CODES$1?(A=O=o,h=19):e===LENS$1?(A=lbase,M-=257,O=lext,C-=257,h=256):(A=dbase,O=dext,h=-1),D=0,b=0,_=v,d=i,T=k,E=0,c=-1,u=(S=1<<k)-1,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;for(;;){p=_-E,o[b]<h?(m=0,g=o[b]):o[b]>h?(m=O[C+o[b]],g=A[M+o[b]]):(m=96,g=0),l=1<<_-E,v=f=1<<T;do{a[d+(D>>E)+(f-=l)]=p<<24|m<<16|g|0}while(0!==f);for(l=1<<_-1;D&l;)l>>=1;if(0!==l?(D&=l-1,D+=l):D=0,b++,0==--I[_]){if(_===w)break;_=t[r+o[b]]}if(_>k&&(D&u)!==c){for(0===E&&(E=k),d+=v,x=1<<(T=_-E);T+E<w&&!((x-=I[T+E])<=0);)T++,x<<=1;if(S+=1<<T,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;a[c=D&u]=k<<24|T<<16|d-i|0}}return 0!==D&&(a[d+D]=_-E<<24|64<<16|0),s.bits=k,0},inftrees=inflate_table,CODES=0,LENS=1,DISTS=2,Z_FINISH$1=constants$2.Z_FINISH,Z_BLOCK=constants$2.Z_BLOCK,Z_TREES=constants$2.Z_TREES,Z_OK$1=constants$2.Z_OK,Z_STREAM_END$1=constants$2.Z_STREAM_END,Z_NEED_DICT$1=constants$2.Z_NEED_DICT,Z_STREAM_ERROR$1=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR$1=constants$2.Z_DATA_ERROR,Z_MEM_ERROR$1=constants$2.Z_MEM_ERROR,Z_BUF_ERROR=constants$2.Z_BUF_ERROR,Z_DEFLATED=constants$2.Z_DEFLATED,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var inflateResetKeep=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1},inflateReset=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=function(e,t){var r;if(!e||!e.state)return Z_STREAM_ERROR$1;var n=e.state;return t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))},inflateInit2=function(e,t){if(!e)return Z_STREAM_ERROR$1;var r=new InflateState;e.state=r,r.window=null;var n=inflateReset2(e,t);return n!==Z_OK$1&&(e.state=null),n},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,lenfix,distfix,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,r,n){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):((a=i.wsize-i.wnext)>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),(n-=a)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},inflate$2=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=0,D=new Uint8Array(4),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(r=e.state).mode===TYPE&&(r.mode=TYPEDO),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,u=s,d=l,T=Z_OK$1;e:for(;;)switch(r.mode){case HEAD:if(0===r.wrap){r.mode=TYPEDO;break}for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(2&r.wrap&&35615===f){r.check=0,D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0),f=0,c=0,r.mode=FLAGS;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=BAD;break}if((15&f)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(c-=4,k=8+(15&(f>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&f?DICTID:TYPE,f=0,c=0;break;case FLAGS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.flags=f,(255&r.flags)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=TIME;case TIME:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.time=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,D[2]=f>>>16&255,D[3]=f>>>24&255,r.check=crc32_1(r.check,D,4,0)),f=0,c=0,r.mode=OS;case OS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=EXLEN;case EXLEN:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),k)),512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(2048&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(4096&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(65535&r.check)){e.msg="header crc mismatch",r.mode=BAD;break}f=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}e.adler=r.check=zswap32(f),f=0,c=0,r.mode=DICT;case DICT:if(0===r.havedict)return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,Z_NEED_DICT$1;e.adler=r.check=1,r.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(r.last){f>>>=7&c,c-=7&c,r.mode=CHECK;break}for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}switch(r.last=1&f,c-=1,3&(f>>>=1)){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,t===Z_TREES){f>>>=2,c-=2;break e}break;case 2:r.mode=TABLE;break;case 3:e.msg="invalid block type",r.mode=BAD}f>>>=2,c-=2;break;case STORED:for(f>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=65535&f,f=0,c=0,r.mode=COPY_,t===Z_TREES)break e;case COPY_:r.mode=COPY;case COPY:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;a.set(n.subarray(i,i+h),o),s-=h,i+=h,l-=h,o+=h,r.length-=h;break}r.mode=TYPE;break;case TABLE:for(;c<14;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.nlen=257+(31&f),f>>>=5,c-=5,r.ndist=1+(31&f),f>>>=5,c-=5,r.ncode=4+(15&f),f>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.lens[A[r.have++]]=7&f,f>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},T=inftrees(CODES,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(_<16)f>>>=g,c-=g,r.lens[r.have++]=_;else{if(16===_){for(x=g+2;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=BAD;break}k=r.lens[r.have-1],h=3+(3&f),f>>>=2,c-=2}else if(17===_){for(x=g+3;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=3+(7&(f>>>=g)),f>>>=3,c-=3}else{for(x=g+7;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=11+(127&(f>>>=g)),f>>>=7,c-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=BAD;break}for(;h--;)r.lens[r.have++]=k}}if(r.mode===BAD)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,E={bits:r.lenbits},T=inftrees(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},T=inftrees(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,T){e.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,t===Z_TREES)break e;case LEN_:r.mode=LEN;case LEN:if(s>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,inffast(e,d),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(y&&0==(240&y)){for(b=g,v=y,w=_;y=(S=r.lencode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,r.length=_,0===y){r.mode=LIT;break}if(32&y){r.back=-1,r.mode=TYPE;break}if(64&y){e.msg="invalid literal/length code",r.mode=BAD;break}r.extra=15&y,r.mode=LENEXT;case LENEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;y=(S=r.distcode[f&(1<<r.distbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(0==(240&y)){for(b=g,v=y,w=_;y=(S=r.distcode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,64&y){e.msg="invalid distance code",r.mode=BAD;break}r.offset=_,r.extra=15&y,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(0===l)break e;if(h=d-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=BAD;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),m=r.window}else m=a,p=o-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do{a[o++]=m[p++]}while(--h);0===r.length&&(r.mode=LEN);break;case LIT:if(0===l)break e;a[o++]=r.length,l--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;c<32;){if(0===s)break e;s--,f|=n[i++]<<c,c+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,o-d):adler32_1(r.check,a,d,o-d)),d=l,(r.flags?f:zswap32(f))!==r.check){e.msg="incorrect data check",r.mode=BAD;break}f=0,c=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=BAD;break}f=0,c=0}r.mode=DONE;case DONE:T=Z_STREAM_END$1;break e;case BAD:T=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,(r.wsize||d!==e.avail_out&&r.mode<BAD&&(r.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,d-e.avail_out),u-=e.avail_in,d-=e.avail_out,e.total_in+=u,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,e.next_out-d):adler32_1(r.check,a,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),(0===u&&0===d||t===Z_FINISH$1)&&T===Z_OK$1&&(T=Z_BUF_ERROR),T},inflateEnd=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1},inflateGetHeader=function(e,t){if(!e||!e.state)return Z_STREAM_ERROR$1;var r=e.state;return 0==(2&r.wrap)?Z_STREAM_ERROR$1:(r.head=t,t.done=!1,Z_OK$1)},inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==DICT?Z_STREAM_ERROR$1:r.mode===DICT&&adler32_1(1,t,n,0)!==r.check?Z_DATA_ERROR$1:updatewindow(e,t,n,n)?(r.mode=MEM,Z_MEM_ERROR$1):(r.havedict=1,Z_OK$1):Z_STREAM_ERROR$1},inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo:inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString=Object.prototype.toString,Z_NO_FLUSH=constants$2.Z_NO_FLUSH,Z_FINISH=constants$2.Z_FINISH,Z_OK=constants$2.Z_OK,Z_STREAM_END=constants$2.Z_STREAM_END,Z_NEED_DICT=constants$2.Z_NEED_DICT,Z_STREAM_ERROR=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR=constants$2.Z_DATA_ERROR,Z_MEM_ERROR=constants$2.Z_MEM_ERROR;function Inflate$1(e){this.options=common.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var r=inflate_1$2.inflateInit2(this.strm,t.windowBits);if(r!==Z_OK)throw new Error(messages[r]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=inflate_1$2.inflateSetDictionary(this.strm,t.dictionary))!==Z_OK))throw new Error(messages[r])}function inflate$1(e,t){var r=new Inflate$1(t);if(r.push(e),r.err)throw r.msg||messages[r.err];return r.result}function inflateRaw$1(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate$1.prototype.push=function(e,t){var r,n,a,i=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(r=inflate_1$2.inflate(i,n))===Z_NEED_DICT&&s&&((r=inflate_1$2.inflateSetDictionary(i,s))===Z_OK?r=inflate_1$2.inflate(i,n):r===Z_DATA_ERROR&&(r=Z_NEED_DICT));i.avail_in>0&&r===Z_STREAM_END&&i.state.wrap>0&&0!==e[i.next_in];)inflate_1$2.inflateReset(i),r=inflate_1$2.inflate(i,n);switch(r){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(r),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||r===Z_STREAM_END))if("string"===this.options.to){var l=strings.utf8border(i.output,i.next_out),f=i.next_out-l,c=strings.buf2string(i.output,l);i.next_out=f,i.avail_out=o-f,f&&i.output.set(i.output.subarray(l,l+f),0),this.onData(c)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==Z_OK||0!==a){if(r===Z_STREAM_END)return r=inflate_1$2.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},Inflate$1.prototype.onData=function(e){this.chunks.push(e)},Inflate$1.prototype.onEnd=function(e){e===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants:constants},inflate=inflate_1$1.inflate,inflate_1=inflate,DeflateDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return inflate_1(new Uint8Array(e)).buffer}}]),r}(),deflate=Object.freeze({__proto__:null,default:DeflateDecoder}),PackbitsDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],n=0;n<e.byteLength;++n){var a=t.getInt8(n);if(a<0){var i=t.getUint8(n+1);a=-a;for(var o=0;o<=a;++o)r.push(i);n+=1}else{for(var s=0;s<=a;++s)r.push(t.getUint8(n+s+1));n+=a+1}}return new Uint8Array(r).buffer}}]),r}(),packbits=Object.freeze({__proto__:null,default:PackbitsDecoder}),LercDecode={exports:{}},module;module=LercDecode,\n/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */\nfunction(){var e,t,r,n,a,i,o,s,l,f,c,u,d,h,p,m,g=(e={defaultNoDataValue:-34027999387901484e22,decode:function(i,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,l=a(i,o.inputOffset||0,s),f=null!==o.noDataValue?o.noDataValue:e.defaultNoDataValue,c=t(l,o.pixelType||Float32Array,o.encodedMaskData,f,o.returnMask),u={width:l.width,height:l.height,pixelData:c.resultPixels,minValue:c.minValue,maxValue:l.pixels.maxValue,noDataValue:f};return c.resultMask&&(u.maskData=c.resultMask),o.returnEncodedMask&&l.mask&&(u.encodedMaskData=l.mask.bitset?l.mask.bitset:null),o.returnFileInfo&&(u.fileInfo=r(l),o.computeUsedBitDepths&&(u.fileInfo.bitDepths=n(l))),u}},t=function(e,t,r,n,a){var o,s,l,f=0,c=e.pixels.numBlocksX,u=e.pixels.numBlocksY,d=Math.floor(e.width/c),h=Math.floor(e.height/u),p=2*e.maxZError,m=Number.MAX_VALUE;r=r||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),a&&r&&(l=new Uint8Array(e.width*e.height));for(var g,y,_=new Float32Array(d*h),b=0;b<=u;b++){var v=b!==u?h:e.height%u;if(0!==v)for(var w=0;w<=c;w++){var k=w!==c?d:e.width%c;if(0!==k){var T,E,x,S,D=b*e.width*h+w*d,A=e.width-k,M=e.pixels.blocks[f];if(M.encoding<2?(0===M.encoding?T=M.rawData:(i(M.stuffedData,M.bitsPerPixel,M.numValidPixels,M.offset,p,_,e.pixels.maxValue),T=_),E=0):x=2===M.encoding?0:M.offset,r)for(y=0;y<v;y++){for(7&D&&(S=r[D>>3],S<<=7&D),g=0;g<k;g++)7&D||(S=r[D>>3]),128&S?(l&&(l[D]=1),m=m>(o=M.encoding<2?T[E++]:x)?o:m,s[D++]=o):(l&&(l[D]=0),s[D++]=n),S<<=1;D+=A}else if(M.encoding<2)for(y=0;y<v;y++){for(g=0;g<k;g++)m=m>(o=T[E++])?o:m,s[D++]=o;D+=A}else for(m=m>x?x:m,y=0;y<v;y++){for(g=0;g<k;g++)s[D++]=x;D+=A}if(1===M.encoding&&E!==M.numValidPixels)throw"Block and Mask do not match";f++}}}return{resultPixels:s,resultMask:l,minValue:m}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var a=e.pixels.blocks[n];0===a.encoding?r.float32=!0:1===a.encoding?r[a.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},a=function(e,t,r){var n={},a=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var i=new DataView(e,t,24);if(n.fileVersion=i.getInt32(0,!0),n.imageType=i.getInt32(4,!0),n.height=i.getUint32(8,!0),n.width=i.getUint32(12,!0),n.maxZError=i.getFloat64(16,!0),t+=24,!r)if(i=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=i.getUint32(0,!0),n.mask.numBlocksX=i.getUint32(4,!0),n.mask.numBytes=i.getUint32(8,!0),n.mask.maxValue=i.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(i=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,f=0;do{if(s>0)for(;s--;)o[f++]=i.getUint8(l++);else{var c=i.getUint8(l++);for(s=-s;s--;)o[f++]=c}s=i.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||f<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));i=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=i.getUint32(0,!0),n.pixels.numBlocksX=i.getUint32(4,!0),n.pixels.numBytes=i.getUint32(8,!0),n.pixels.maxValue=i.getFloat32(12,!0),t+=16;var u=n.pixels.numBlocksX,d=n.pixels.numBlocksY,h=u+(n.width%u>0?1:0),p=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(h*p);for(var m=0,g=0;g<p;g++)for(var y=0;y<h;y++){var _=0,b=e.byteLength-t;i=new DataView(e,t,Math.min(10,b));var v={};n.pixels.blocks[m++]=v;var w=i.getUint8(0);if(_++,v.encoding=63&w,v.encoding>3)throw"Invalid block encoding ("+v.encoding+")";if(2!==v.encoding){if(0!==w&&2!==w){if(w>>=6,v.offsetType=w,2===w)v.offset=i.getInt8(1),_++;else if(1===w)v.offset=i.getInt16(1,!0),_+=2;else{if(0!==w)throw"Invalid block offset type";v.offset=i.getFloat32(1,!0),_+=4}if(1===v.encoding)if(w=i.getUint8(_),_++,v.bitsPerPixel=63&w,w>>=6,v.numValidPixelsType=w,2===w)v.numValidPixels=i.getUint8(_),_++;else if(1===w)v.numValidPixels=i.getUint16(_,!0),_+=2;else{if(0!==w)throw"Invalid valid pixel count type";v.numValidPixels=i.getUint32(_,!0),_+=4}}var k;if(t+=_,3!==v.encoding)if(0===v.encoding){var T=(n.pixels.numBytes-1)/4;if(T!==Math.floor(T))throw"uncompressed block has invalid length";k=new ArrayBuffer(4*T),new Uint8Array(k).set(new Uint8Array(e,t,4*T));var E=new Float32Array(k);v.rawData=E,t+=4*T}else if(1===v.encoding){var x=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),S=Math.ceil(x/4);k=new ArrayBuffer(4*S),new Uint8Array(k).set(new Uint8Array(e,t,x)),v.stuffedData=new Uint32Array(k),t+=x}}else t++}return n.eofOffset=t,n},i=function(e,t,r,n,a,i,o){var s,l,f,c=(1<<t)-1,u=0,d=0,h=Math.ceil((o-n)/a),p=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*p,s=0;s<r;s++){if(0===d&&(f=e[u++],d=32),d>=t)l=f>>>d-t&c,d-=t;else{var m=t-d;l=(f&c)<<m&c,l+=(f=e[u++])>>>(d=32-m)}i[s]=l<h?n+l*a:o}return i},e),y=(o=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h=(1<<r)-1,p=0,m=0,g=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*g,a)for(l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=a[f];else for(d=Math.ceil((s-i)/o),l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=f<d?i+f*o:s},s=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=[],p=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*p;var m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32),u>=t?(d=o>>>u-t&s,u-=t):(d=(o&s)<<(c=t-u)&s,d+=(o=e[l++])>>>(u=32-c)),h[f]=d<m?n+d*a:i;return h.unshift(n),h},l=function(e,t,r,n,a,i,o,s){var l,f,c,u,d=(1<<r)-1,h=0,p=0,m=0;if(a)for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=a[f];else{var g=Math.ceil((s-i)/o);for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=f<g?i+f*o:s}return t},f=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=0,p=[],m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32,h=0),u>=t?(d=o>>>h&s,u-=t,h+=t):(d=o>>>h&s,u=32-(c=t-u),d|=((o=e[l++])&(1<<c)-1)<<t-c,h=c),p[f]=d<m?n+d*a:i;return p.unshift(n),p},c=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*u,a=0;a<n;a++)0===c&&(o=e[f++],c=32),c>=r?(i=o>>>c-r&l,c-=r):(i=(o&l)<<(s=r-c)&l,i+=(o=e[f++])>>>(c=32-s)),t[a]=i;return t},u=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=0;for(a=0;a<n;a++)0===c&&(o=e[f++],c=32,u=0),c>=r?(i=o>>>u&l,c-=r,u+=r):(i=o>>>u&l,c=32-(s=r-c),i|=((o=e[f++])&(1<<s)-1)<<r-s,u=s),t[a]=i;return t},d={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,a=Math.floor(n/2),i=0;a;){var o=a>=359?359:a;a-=o;do{t+=e[i++]<<8,r+=t+=e[i++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[i]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,n),0!==a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var i,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(a.fileVersion=s,r+=4,s>=3&&(a.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),a.height=o.getUint32(0,!0),a.width=o.getUint32(4,!0),r+=8,s>=4?(a.numDims=o.getUint32(8,!0),r+=4):a.numDims=1,o=new DataView(e,r,40),a.numValidPixel=o.getUint32(0,!0),a.microBlockSize=o.getInt32(4,!0),a.blobSize=o.getInt32(8,!0),a.imageType=o.getInt32(12,!0),a.maxZError=o.getFloat64(16,!0),a.zMin=o.getFloat64(24,!0),a.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=a,t.ptr=r,s>=3&&(i=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-i,a.blobSize-14))!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),i=this.readSubArray(e,t.ptr,n,a),o=this.readSubArray(e,t.ptr+a,n,a);t.ptr+=2*a;var s,l=!0;for(s=0;s<r.numDims;s++)if(i[s]!==o[s]){l=!1;break}return r.minValues=i,r.maxValues=o,l},readSubArray:function(e,t,r,n){var a;if(r===Uint8Array)a=new Uint8Array(e,t,n);else{var i=new ArrayBuffer(n);new Uint8Array(i).set(new Uint8Array(e,t,n)),a=new r(i)}return a},readMask:function(e,t){var r,n,a=t.ptr,i=t.headerInfo,o=i.width*i.height,s=i.numValidPixel,l=new DataView(e,a,4),f={};if(f.numBytes=l.getUint32(0,!0),a+=4,(0===s||o===s)&&0!==f.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),f.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,a+=f.numBytes;else if(f.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var c=(l=new DataView(e,a,f.numBytes)).getInt16(0,!0),u=2,d=0,h=0;do{if(c>0)for(;c--;)r[d++]=l.getUint8(u++);else for(h=l.getUint8(u++),c=-c;c--;)r[d++]=h;c=l.getInt16(u,!0),u+=2}while(u<f.numBytes);if(-32768!==c||d<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var p=0,m=0;for(m=0;m<o;m++)7&m?(p=r[m>>3],p<<=7&m):p=r[m>>3],128&p&&(n[m]=1);t.pixels.resultMask=n,f.bitset=r,a+=f.numBytes}return t.ptr=a,t.mask=f,!0},readDataOneSweep:function(e,t,r,n){var a,i=t.ptr,o=t.headerInfo,s=o.numDims,l=o.width*o.height,f=o.imageType,c=o.numValidPixel*d.getDataTypeSize(f)*s,u=t.pixels.resultMask;if(r===Uint8Array)a=new Uint8Array(e,i,c);else{var h=new ArrayBuffer(c);new Uint8Array(h).set(new Uint8Array(e,i,c)),a=new r(h)}if(a.length===l*s)t.pixels.resultPixels=n?d.swapDimensionOrder(a,l,s,r,!0):a;else{t.pixels.resultPixels=new r(l*s);var p=0,m=0,g=0,y=0;if(s>1){if(n){for(m=0;m<l;m++)if(u[m])for(y=m,g=0;g<s;g++,y+=l)t.pixels.resultPixels[y]=a[p++]}else for(m=0;m<l;m++)if(u[m])for(y=m*s,g=0;g<s;g++)t.pixels.resultPixels[y+g]=a[p++]}else for(m=0;m<l;m++)u[m]&&(t.pixels.resultPixels[m]=a[p++])}return i+=c,t.ptr=i,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=n.getInt32(4,!0),i=n.getInt32(8,!0),o=n.getInt32(12,!0);if(i>=o)return!1;var s=new Uint32Array(o-i);d.decodeBits(e,t,s);var l,f,c,u,p=[];for(l=i;l<o;l++)p[f=l-(l<a?0:a)]={first:s[l-i],second:null};var m=e.byteLength-t.ptr,g=Math.ceil(m/4),y=new ArrayBuffer(4*g);new Uint8Array(y).set(new Uint8Array(e,t.ptr,m));var _,b=new Uint32Array(y),v=0,w=0;for(_=b[0],l=i;l<o;l++)(u=p[f=l-(l<a?0:a)].first)>0&&(p[f].second=_<<v>>>32-u,32-v>=u?32===(v+=u)&&(v=0,_=b[++w]):(v+=u-32,_=b[++w],p[f].second|=_>>>32-v));var k=0,T=0,E=new h;for(l=0;l<p.length;l++)void 0!==p[l]&&(k=Math.max(k,p[l].first));T=k>=r?r:k;var x,S,D,A,M,I=[];for(l=i;l<o;l++)if((u=p[f=l-(l<a?0:a)].first)>0)if(x=[u,f],u<=T)for(S=p[f].second<<T-u,D=1<<T-u,c=0;c<D;c++)I[S|c]=x;else for(S=p[f].second,M=E,A=u-1;A>=0;A--)S>>>A&1?(M.right||(M.right=new h),M=M.right):(M.left||(M.left=new h),M=M.left),0!==A||M.val||(M.val=x[1]);return{decodeLut:I,numBitsLUTQick:T,numBitsLUT:k,tree:E,stuffedData:b,srcPtr:w,bitPos:v}},readHuffman:function(e,t,r,n){var a,i,o,s,l,f,c,u,h,p=t.headerInfo.numDims,m=t.headerInfo.height,g=t.headerInfo.width,y=g*m,_=this.readHuffmanTree(e,t),b=_.decodeLut,v=_.tree,w=_.stuffedData,k=_.srcPtr,T=_.bitPos,E=_.numBitsLUTQick,x=_.numBitsLUT,S=0===t.headerInfo.imageType?128:0,D=t.pixels.resultMask,A=0;T>0&&(k++,T=0);var M,I=w[k],R=1===t.encodeMode,O=new r(y*p),C=O;if(p<2||R){for(M=0;M<p;M++)if(p>1&&(C=new r(O.buffer,y*M,y),A=0),t.headerInfo.numValidPixel===g*m)for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(o+=c>0?A:f>0?C[u-g]:A,o&=255,C[u]=o,A=o):C[u]=o}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++)if(D[u]){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(c>0&&D[u-1]?o+=A:f>0&&D[u-g]?o+=C[u-g]:o+=A,o&=255,C[u]=o,A=o):C[u]=o}}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++)if(u=f*g+c,!D||D[u])for(M=0;M<p;M++,u+=y){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,C[u]=o}t.ptr=t.ptr+4*(k+1)+(T>0?4:0),t.pixels.resultPixels=O,p>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(O,y,p,r))},decodeBits:function(e,t,r,n,a){var i=t.headerInfo,d=i.fileVersion,h=0,p=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,m=new DataView(e,t.ptr,p),g=m.getUint8(0);h++;var y=g>>6,_=0===y?4:3-y,b=(32&g)>0,v=31&g,w=0;if(1===_)w=m.getUint8(h),h++;else if(2===_)w=m.getUint16(h,!0),h+=2;else{if(4!==_)throw"Invalid valid pixel count type";w=m.getUint32(h,!0),h+=4}var k,T,E,x,S,D,A,M,I,R=2*i.maxZError,O=i.numDims>1?i.maxValues[a]:i.zMax;if(b){for(t.counter.lut++,M=m.getUint8(h),h++,x=Math.ceil((M-1)*v/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),E=new Uint8Array(T),t.ptr+=h,E.set(new Uint8Array(e,t.ptr,x)),A=new Uint32Array(T),t.ptr+=x,I=0;M-1>>>I;)I++;x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,D=d>=3?f(A,v,M-1,n,R,O):s(A,v,M-1,n,R,O),d>=3?l(k,r,I,w,D):o(k,r,I,w,D)}else t.counter.bitstuffer++,I=v,t.ptr+=h,I>0&&(x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,d>=3?null==n?u(k,r,I,w):l(k,r,I,w,!1,n,R,O):null==n?c(k,r,I,w):o(k,r,I,w,!1,n,R,O))},readTiles:function(e,t,r,n){var a=t.headerInfo,i=a.width,o=a.height,s=i*o,l=a.microBlockSize,f=a.imageType,c=d.getDataTypeSize(f),u=Math.ceil(i/l),h=Math.ceil(o/l);t.pixels.numBlocksY=h,t.pixels.numBlocksX=u,t.pixels.ptr=0;var p,m,g,y,_,b,v,w,k,T,E=0,x=0,S=0,D=0,A=0,M=0,I=0,R=0,O=0,C=0,P=0,L=0,U=0,B=0,$=0,N=new r(l*l),z=o%l||l,Z=i%l||l,G=a.numDims,j=t.pixels.resultMask,V=t.pixels.resultPixels,F=a.fileVersion>=5?14:15,K=a.zMax;for(S=0;S<h;S++)for(A=S!==h-1?l:z,D=0;D<u;D++)for(C=S*i*l+D*l,P=i-(M=D!==u-1?l:Z),w=0;w<G;w++){if(G>1?(T=V,C=S*i*l+D*l,V=new r(t.pixels.resultPixels.buffer,s*w*c,s),K=a.maxValues[w]):T=null,I=e.byteLength-t.ptr,m={},$=0,R=(p=new DataView(e,t.ptr,Math.min(10,I))).getUint8(0),$++,k=a.fileVersion>=5?4&R:0,O=R>>6&255,(R>>2&F)!=(D*l>>3&F))throw"integrity issue";if(k&&0===w)throw"integrity issue";if((_=3&R)>3)throw t.ptr+=$,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(k)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=$,L=(L=A*M*c)<(U=e.byteLength-t.ptr)?L:U,g=new ArrayBuffer(L%c==0?L:L+c-L%c),new Uint8Array(g).set(new Uint8Array(e,t.ptr,L)),y=new r(g),B=0,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=y[B++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=y[B++];C+=P}t.ptr+=B*c}else if(b=d.getDataTypeUsed(k&&f<6?4:f,O),v=d.getOnePixel(m,$,b,p),$+=d.getDataTypeSize(b),3===_)if(t.ptr+=$,t.counter.constantoffset++,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=k?Math.min(K,T[C]+v):v),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=k?Math.min(K,T[C]+v):v,C++;C+=P}else if(t.ptr+=$,d.decodeBits(e,t,N,v,w),$=0,k)if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]+T[C]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=N[$++]+T[C],C++;C+=P}else if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=N[$++];C+=P}else{if(k)if(j)for(E=0;E<A;E++)for(x=0;x<M;x++)j[C]&&(V[C]=T[C]),C++;else for(E=0;E<A;E++)for(x=0;x<M;x++)V[C]=T[C],C++;t.counter.constant++,t.ptr+=$}}G>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(t.pixels.resultPixels,s,G,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:d.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,a=e.headerInfo.maxValues,i=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,l=0,f=0,c=e.pixels.resultMask,u=e.pixels.resultPixels;if(c)if(i>1){if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)c[l]&&(u[f+l]=r);else for(l=0;l<o;l++)if(c[l])for(f=l*i,s=0;s<i;s++)u[f+i]=a[s]}else for(l=0;l<o;l++)c[l]&&(u[l]=r);else if(i>1&&n!==r)if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)u[f+l]=r;else for(l=0;l<o;l++)for(f=l*i,s=0;s<i;s++)u[f+s]=a[s];else for(l=0;l<o*i;l++)u[l]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=-17976931348623157e292&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var a=0;switch(r){case 0:a=n.getInt8(t);break;case 1:a=n.getUint8(t);break;case 2:a=n.getInt16(t,!0);break;case 3:a=n.getUint16(t,!0);break;case 4:a=n.getInt32(t,!0);break;case 5:a=n.getUInt32(t,!0);break;case 6:a=n.getFloat32(t,!0);break;case 7:a=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(e,t,r,n,a){var i=0,o=0,s=0,l=0,f=e;if(r>1)if(f=new n(t*r),a)for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[l]=e[o++];else for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[o++]=e[l];return f}},h=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,a={};a.ptr=t.inputOffset||0,a.pixels={},d.readHeaderInfo(e,a);var i=a.headerInfo,o=i.fileVersion,s=d.getDataTypeArray(i.imageType);if(o>5)throw"unsupported lerc version 2."+o;d.readMask(e,a),i.numValidPixel===i.width*i.height||a.pixels.resultMask||(a.pixels.resultMask=t.maskData);var l=i.width*i.height;a.pixels.resultPixels=new s(l*i.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var f,c=!t.returnPixelInterleavedDims;if(0!==i.numValidPixel)if(i.zMax===i.zMin)d.constructConstantSurface(a,c);else if(o>=4&&d.checkMinMaxRanges(e,a))d.constructConstantSurface(a,c);else{var u=new DataView(e,a.ptr,2),h=u.getUint8(0);if(a.ptr++,h)d.readDataOneSweep(e,a,s,c);else if(o>1&&i.imageType<=1&&Math.abs(i.maxZError-.5)<1e-5){var p=u.getUint8(1);if(a.ptr++,a.encodeMode=p,p>2||o<4&&p>1)throw"Invalid Huffman flag "+p;p?d.readHuffman(e,a,s,c):d.readTiles(e,a,s,c)}else d.readTiles(e,a,s,c)}a.eofOffset=a.ptr,t.inputOffset?(f=a.headerInfo.blobSize+t.inputOffset-a.ptr,Math.abs(f)>=1&&(a.eofOffset=t.inputOffset+a.headerInfo.blobSize)):(f=a.headerInfo.blobSize-a.ptr,Math.abs(f)>=1&&(a.eofOffset=a.headerInfo.blobSize));var m={width:i.width,height:i.height,pixelData:a.pixels.resultPixels,minValue:i.zMin,maxValue:i.zMax,validPixelCount:i.numValidPixel,dimCount:i.numDims,dimStats:{minValues:i.minValues,maxValues:i.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&d.isValidPixelValue(i.imageType,r)){var g=a.pixels.resultMask;for(n=0;n<l;n++)g[n]||(m.pixelData[n]=r);m.noDataValue=r}return a.noDataValue=r,t.returnFileInfo&&(m.fileInfo=d.formatFileInfo(a)),m},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)d.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}}),_=(p=new ArrayBuffer(4),m=new Uint8Array(p),new Uint32Array(p)[0]=1,1===m[0]),b={decode:function(e,t){if(!_)throw"Big endian system is not supported.";var r,n,a=(t=t||{}).inputOffset||0,i=new Uint8Array(e,a,10),o=String.fromCharCode.apply(null,i);if("CntZImage"===o.trim())r=g,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;r=y,n=2}for(var s,l,f,c,u,d,h=0,p=e.byteLength-10,m=[],b={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},v=0;a<p;){var w=r.decode(e,{inputOffset:a,encodedMaskData:s,maskData:f,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});a=w.fileInfo.eofOffset,f=w.maskData,0===h&&(s=w.encodedMaskData,b.width=w.width,b.height=w.height,b.dimCount=w.dimCount||1,b.pixelType=w.pixelType||w.fileInfo.pixelType,b.mask=f),n>1&&(f&&m.push(f),w.fileInfo.mask&&w.fileInfo.mask.numBytes>0&&v++),h++,b.pixels.push(w.pixelData),b.statistics.push({minValue:w.minValue,maxValue:w.maxValue,noDataValue:w.noDataValue,dimStats:w.dimStats})}if(n>1&&v>1){for(d=b.width*b.height,b.bandMasks=m,(f=new Uint8Array(d)).set(m[0]),c=1;c<m.length;c++)for(l=m[c],u=0;u<d;u++)f[u]=f[u]&l[u];b.maskData=f}return b}};module.exports?module.exports=b:this.Lerc=b}();var Lerc=LercDecode.exports,fieldTagNames={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},fieldTags={};for(var key in fieldTagNames)fieldTagNames.hasOwnProperty(key)&&(fieldTags[fieldTagNames[key]]=parseInt(key,10));fieldTags.BitsPerSample,fieldTags.ExtraSamples,fieldTags.SampleFormat,fieldTags.StripByteCounts,fieldTags.StripOffsets,fieldTags.StripRowCounts,fieldTags.TileByteCounts,fieldTags.TileOffsets,fieldTags.SubIFDs;var fieldTypeNames={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},fieldTypes={};for(var _key in fieldTypeNames)fieldTypeNames.hasOwnProperty(_key)&&(fieldTypes[fieldTypeNames[_key]]=parseInt(_key,10));var LercParameters={Version:0,AddCompression:1},LercAddCompression={None:0,Deflate:1},geoKeyNames={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},geoKeys={};for(var _key2 in geoKeyNames)geoKeyNames.hasOwnProperty(_key2)&&(geoKeys[geoKeyNames[_key2]]=parseInt(_key2,10));var LercDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,n.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,n.addCompression=e.LercParameters[LercParameters.AddCompression],n}return _createClass(r,[{key:"decodeBlock",value:function(e){switch(this.addCompression){case LercAddCompression.None:break;case LercAddCompression.Deflate:e=inflate_1(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return Lerc.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),r}(),lerc=Object.freeze({__proto__:null,default:LercDecoder});'],{type:"application/javascript"}),N6=URL.createObjectURL(k6);var A6,F6=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function D6(){return A6||(A6=new k5(void 0,new Worker(N6))),A6}function j6(t){try{return t.getBoundingBox()}catch(r){var e=t.fileDirectory;return[0,0,e.ImageWidth,e.ImageLength]}}function G6(t){try{return t.getOrigin().slice(0,2)}catch(e){return[0,t.fileDirectory.ImageLength]}}function z6(t,e){try{return t.getResolution(e)[0]}catch(r){return e.fileDirectory.ImageWidth/t.fileDirectory.ImageWidth}}function U6(t){var e=t.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey){if(!(n=ye(r="EPSG:"+e.ProjectedCSTypeGeoKey)))(i=f(e.ProjLinearUnitsGeoKey))&&(n=new g({code:r,units:i}));return n}if(e.GeographicTypeGeoKey){var r,n,i;if(!(n=ye(r="EPSG:"+e.GeographicTypeGeoKey)))(i=f(e.GeogAngularUnitsGeoKey))&&(n=new g({code:r,units:i}));return n}return null}function B6(t){return t.getImageCount().then((function(e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t.getImage(n);return Promise.all(r)}))}function V6(t){return(t.overviews?async function(t,e=[],r={},n){const i=await L6.fromSource(w6(t,r),n),o=await Promise.all(e.map(t=>L6.fromSource(w6(t,r))));return new M6(i,o)}(t.url,t.overviews):async function(t,e={},r){return L6.fromSource(w6(t,e),r)}(t.url)).then(B6)}function q6(t,e,r,n,i){if(Array.isArray(t)){var o=t.length;if(!Array.isArray(e)||o!=e.length){var s=new Error(n);throw i(s),s}for(var a=0;a<o;++a)q6(t[a],e[a],r,n,i)}else if(e=e,Math.abs(t-e)>r*t)throw new Error(n)}function Y6(t){return t instanceof Int8Array?127:t instanceof Uint8Array||t instanceof Uint8ClampedArray?255:t instanceof Int16Array?32767:t instanceof Uint16Array?65535:t instanceof Int32Array?2147483647:t instanceof Uint32Array?4294967295:t instanceof Float32Array?34e37:255}var W6=function(t){function e(e){var r=t.call(this,{state:za,tileGrid:null,projection:null,opaque:e.opaque,transition:e.transition})||this;r.sourceInfo_=e.sources;var n=r.sourceInfo_.length;r.sourceImagery_=new Array(n),r.resolutionFactors_=new Array(n),r.samplesPerPixel_,r.nodataValues_,r.normalize_=!1!==e.normalize,r.addAlpha_=!1,r.error_=null,r.readMethod_=e.convertToRGB?"readRGB":"readRasters",r.setKey(r.sourceInfo_.map((function(t){return t.url})).join(","));for(var i=r,o=new Array(n),s=0;s<n;++s)o[s]=V6(r.sourceInfo_[s]);return Promise.all(o).then((function(t){i.configure_(t)})).catch((function(t){console.error(t),i.error_=t,i.setState(Ba)})),r}return F6(e,t),e.prototype.getError=function(){return this.error_},e.prototype.configure_=function(t){for(var e,r,n,i,o=new Array(t.length),s=new Array(t.length),a=0,l=t.length,u=function(l){var u=t[l],h=u.length,f=void 0,p=void 0,d=new Array(h),g=new Array(h);s[l]=new Array(h);for(var y=0;y<h;++y){var m=u[y],_=m.getGDALNoData();s[l][y]=null===_?NaN:_;var v=c.sourceInfo_[l].bands;o[l]=v?v.length:m.getSamplesPerPixel();var b=h-(y+1);f||(f=j6(m)),p||(p=G6(m)),g[b]=z6(m,u[0]),d[b]=[m.getTileWidth(),m.getTileHeight()]}(e?Ft(e,f,e):e=f,r)?q6(r,p,0,E="Origin mismatch for source "+l+", got ["+p+"] but expected ["+r+"]",c.viewRejector):r=p;if(i){i.length-a>g.length&&(a=i.length-g.length);var w=i[i.length-1]/g[g.length-1];c.resolutionFactors_[l]=w;var x=g.map((function(t){return t*w})),E="Resolution mismatch for source "+l+", got ["+x+"] but expected ["+i+"]";q6(i.slice(a,i.length),x,.005,E,c.viewRejector)}else i=g,c.resolutionFactors_[l]=1;n?q6(n.slice(a,n.length),d,0,"Tile size mismatch for source "+l,c.viewRejector):n=d,c.sourceImagery_[l]=u.reverse()},c=this,h=0;h<l;++h)u(h);for(var f=0,p=this.sourceImagery_.length;f<p;++f)for(var d=this.sourceImagery_[f];d.length<i.length;)d.unshift(void 0);if(!this.getProjection()){var g=t[0];for(f=g.length-1;f>=0;--f){var y=U6(g[f]);if(y){this.projection=y;break}}}this.samplesPerPixel_=o,this.nodataValues_=s;t:for(h=0;h<l;++h){if(void 0!==this.sourceInfo_[h].nodata){this.addAlpha_=!0;break}var m=s[h],_=this.sourceInfo_[h].bands;if(_){for(f=0;f<_.length;++f)if(!isNaN(m[_[f]-1])){this.addAlpha_=!0;break t}}else for(var v=0;v<m.length;++v)if(!isNaN(m[v])){this.addAlpha_=!0;break t}}var b=this.addAlpha_?1:0;this.bandCount=o.reduce((function(t,e){return t+=e}),0)+b;var w=new gg({extent:e,minZoom:a,origin:r,resolutions:i,tileSizes:n});this.tileGrid=w,this.setLoader(this.loadTile_.bind(this)),this.setState(Ua),this.viewResolver({projection:this.projection,resolutions:i,center:ke(Mt(e),this.projection),extent:Ae(e,this.projection),zoom:0})},e.prototype.loadTile_=function(t,e,r){for(var n=Vc(this.tileGrid.getTileSize(t)),i=this.sourceImagery_.length,o=new Array(i),s=this.addAlpha_,a=this.bandCount,l=this.samplesPerPixel_,u=this.nodataValues_,c=this.sourceInfo_,h=function(i){var s=c[i],a=f.resolutionFactors_[i],l=[Math.round(e*(n[0]*a)),Math.round(r*(n[1]*a)),Math.round((e+1)*(n[0]*a)),Math.round((r+1)*(n[1]*a))],h=f.sourceImagery_[i][t],p=void 0;s.bands&&(p=s.bands.map((function(t){return t-1})));var d=void 0;d=isNaN(s.nodata)?p?p.map((function(t){return u[i][t]})):u[i]:s.nodata,o[i]=h[f.readMethod_]({window:l,width:n[0],height:n[1],samples:p,fillValue:d,pool:D6(),interleave:!1})},f=this,p=0;p<i;++p)h(p);var d=n[0]*n[1],g=d*a,m=this.normalize_;return Promise.all(o).then((function(t){var e;e=m?new Uint8Array(g):new Float32Array(g);for(var r,n=0,o=0;o<d;++o){for(var a=s,h=0;h<i;++h){var f=c[h],p=f.min,_=f.max,v=void 0,b=void 0;m&&(void 0===p&&(p=(r=t[h][0])instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0),void 0===_&&(_=Y6(t[h][0])),b=-p*(v=255/(_-p)));for(var w=0;w<l[h];++w){var x=t[h][w][o],E=void 0;if(E=m?y(v*x+b,0,255):x,s){var S=f.nodata;if(void 0===S){var I=void 0;I=f.bands?f.bands[w]-1:w,S=u[h][I]}x!==S&&(a=!1,e[n]=E)}else e[n]=E;n++}}s&&(a||(e[n]=255),n++)}return e}))},e}(s5);W6.prototype.getView;var X6=W6,H6=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z6="default",K6="truncated",$6=function(t){function e(e,r,n,i,o,s,a){var l=t.call(this,r,n,i,o,s,a)||this;return l.zoomifyImage_=null,l.tileSize_=e,l}return H6(e,t),e.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=t.prototype.getImage.call(this);if(this.state==hu){var r=this.tileSize_;if(e.width==r[0]&&e.height==r[1])return this.zoomifyImage_=e,e;var n=ol(r[0],r[1]);return n.drawImage(e,0,0),this.zoomifyImage_=n.canvas,n.canvas}return e},e}(um),J6=function(t){function e(e){var r=this,n=e,i=n.size,o=void 0!==n.tierSizeCalculation?n.tierSizeCalculation:Z6,s=n.tilePixelRatio||1,a=i[0],l=i[1],u=[],c=n.tileSize||wu,h=c*s;switch(o){case Z6:for(;a>h||l>h;)u.push([Math.ceil(a/h),Math.ceil(l/h)]),h+=h;break;case K6:for(var f=a,p=l;f>h||p>h;)u.push([Math.ceil(f/h),Math.ceil(p/h)]),f>>=1,p>>=1;break;default:ut(!1,53)}u.push([1,1]),u.reverse();for(var d=[s],g=[0],y=1,m=u.length;y<m;y++)d.push(s<<y),g.push(u[y-1][0]*u[y-1][1]+g[y-1]);d.reverse();var _=new gg({tileSize:c,extent:n.extent||[0,-l,a,0],resolutions:d}),v=n.url;v&&-1==v.indexOf("{TileGroup}")&&-1==v.indexOf("{tileIndex}")&&(v+="{TileGroup}/{z}-{x}-{y}.jpg");var b=Gm(v),w=c*s;var x=Dm(b.map((function(t){return function(e,r,n){if(e){var i=e[0],o=e[1],s=e[2],a=o+s*u[i][0],l={z:i,x:o,y:s,tileIndex:a,TileGroup:"TileGroup"+((a+g[i])/w|0)};return t.replace(/\{(\w+?)\}/g,(function(t,e){return l[e]}))}}}))),E=$6.bind(null,Vc(c*s));(r=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,projection:n.projection,tilePixelRatio:s,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileClass:E,tileGrid:_,tileUrlFunction:x,transition:n.transition})||this).zDirection=n.zDirection;var S=x(_.getTileCoordForCoordAndResolution(Mt(_.getExtent()),d[d.length-1]),1,null),I=new Image;return I.addEventListener("error",function(){w=c,this.changed()}.bind(r)),I.src=S,r}return H6(e,t),e}(qm),Q6=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function t8(t){return t.toLocaleString("en",{maximumFractionDigits:10})}var e8=function(t){function e(e){var r=this,n=e||{},i=n.url||"";i+=i.lastIndexOf("/")===i.length-1||""===i?"":"/";var o=n.version||o0,s=n.sizes||[],a=n.size;ut(null!=a&&Array.isArray(a)&&2==a.length&&!isNaN(a[0])&&a[0]>0&&!isNaN(a[1])&&a[1]>0,60);var l,u,c,h=a[0],f=a[1],p=n.tileSize,d=n.tilePixelRatio||1,g=n.format||"jpg",y=n.quality||(n.version==i0?"native":"default"),m=n.resolutions||[],_=n.supports||[],v=n.extent||[0,-f,h,0],b=null!=s&&Array.isArray(s)&&s.length>0,w=void 0!==p&&("number"==typeof p&&Number.isInteger(p)&&p>0||Array.isArray(p)&&p.length>0),x=null!=_&&Array.isArray(_)&&(Ue(_,"regionByPx")||Ue(_,"regionByPct"))&&(Ue(_,"sizeByWh")||Ue(_,"sizeByH")||Ue(_,"sizeByW")||Ue(_,"sizeByPct"));if(m.sort((function(t,e){return e-t})),w||x)if(null!=p&&("number"==typeof p&&Number.isInteger(p)&&p>0?(l=p,u=p):Array.isArray(p)&&p.length>0&&((1==p.length||null==p[1]&&Number.isInteger(p[0]))&&(l=p[0],u=p[0]),2==p.length&&(Number.isInteger(p[0])&&Number.isInteger(p[1])?(l=p[0],u=p[1]):null==p[0]&&Number.isInteger(p[1])&&(l=p[1],u=p[1])))),void 0!==l&&void 0!==u||(l=wu,u=wu),0==m.length)for(var E=c=Math.max(Math.ceil(Math.log(h/l)/Math.LN2),Math.ceil(Math.log(f/u)/Math.LN2));E>=0;E--)m.push(Math.pow(2,E));else{var S=Math.max.apply(Math,m);c=Math.round(Math.log(S)/Math.LN2)}else if(l=h,u=f,m=[],b){s.sort((function(t,e){return t[0]-e[0]})),c=-1;var I=[];for(E=0;E<s.length;E++){var O=h/s[E][0];m.length>0&&m[m.length-1]==O?I.push(E):(m.push(O),c++)}if(I.length>0)for(E=0;E<I.length;E++)s.splice(I[E]-E,1)}else m.push(1),s.push([h,f]),c=0;var C=new gg({tileSize:[l,u],extent:v,origin:Dt(v),resolutions:m}),T=$6.bind(null,Vc(p||256).map((function(t){return t*d})));return(r=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,state:n.state,tileClass:T,tileGrid:C,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:function(t,e,r){var n,a,p=t[0];if(!(p>c)){var d=t[1],v=t[2],E=m[p];if(!(void 0===d||void 0===v||void 0===E||d<0||Math.ceil(h/E/l)<=d||v<0||Math.ceil(f/E/u)<=v)){if(x||w){var S=d*l*E,I=v*u*E,O=l*E,C=u*E,T=l,P=u;if(S+O>h&&(O=h-S),I+C>f&&(C=f-I),S+l*E>h&&(T=Math.floor((h-S+E-1)/E)),I+u*E>f&&(P=Math.floor((f-I+E-1)/E)),0==S&&O==h&&0==I&&C==f)n="full";else if(!x||Ue(_,"regionByPx"))n=S+","+I+","+O+","+C;else if(Ue(_,"regionByPct")){n="pct:"+t8(S/h*100)+","+t8(I/f*100)+","+t8(O/h*100)+","+t8(C/f*100)}o!=s0||x&&!Ue(_,"sizeByWh")?!x||Ue(_,"sizeByW")?a=T+",":Ue(_,"sizeByH")?a=","+P:Ue(_,"sizeByWh")?a=T+","+P:Ue(_,"sizeByPct")&&(a="pct:"+t8(100/E)):a=T+","+P}else if(n="full",b){var R=s[p][0],L=s[p][1];a=o==s0?R==h&&L==f?"max":R+","+L:R==h?"full":R+","}else a=o==s0?"max":"full";return i+n+"/"+a+"/0/"+y+"."+g}}},transition:n.transition})||this).zDirection=n.zDirection,r}return Q6(e,t),e}(qm),r8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),n8=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{attributions:n.attributions,imageSmoothing:n.imageSmoothing,projection:n.projection,resolutions:n.resolutions})||this).crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null,r.hidpi_=void 0===n.hidpi||n.hidpi,r.url_=n.url,r.imageLoadFunction_=void 0!==n.imageLoadFunction?n.imageLoadFunction:d_,r.params_=n.params||{},r.image_=null,r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==n.ratio?n.ratio:1.5,r}return r8(e,t),e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,r,n){if(void 0===this.url_)return null;e=this.findNearestResolution(e),r=this.hidpi_?r:1;var i=this.image_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==e&&i.getPixelRatio()==r&&gt(i.getExtent(),t))return i;var o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};V(o,this.params_);var s=((t=t.slice())[0]+t[2])/2,a=(t[1]+t[3])/2;if(1!=this.ratio_){var l=this.ratio_*Gt(t)/2,u=this.ratio_*At(t)/2;t[0]=s-l,t[1]=a-u,t[2]=s+l,t[3]=a+u}var c=e/r,h=Math.ceil(Gt(t)/c),f=Math.ceil(At(t)/c);t[0]=s-c*h/2,t[2]=s+c*h/2,t[1]=a-c*f/2,t[3]=a+c*f/2,this.imageSize_[0]=h,this.imageSize_[1]=f;var p=this.getRequestUrl_(t,this.imageSize_,r,n,o);return this.image_=new sm(t,e,r,p,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener($s,this.handleImageChange.bind(this)),this.image_},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.getRequestUrl_=function(t,e,r,n,i){var o=n.getCode().split(/:(?=\d+$)/).pop();i.SIZE=e[0]+","+e[1],i.BBOX=t.join(","),i.BBOXSR=o,i.IMAGESR=o,i.DPI=Math.round(90*r);var s=this.url_,a=s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return a==s&&ut(!1,50),Zm(a,i)},e.prototype.getUrl=function(){return this.url_},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},e.prototype.updateParams=function(t){V(this.params_,t),this.image_=null,this.changed()},e}(g_),i8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o8=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{attributions:n.attributions,imageSmoothing:n.imageSmoothing,projection:n.projection,resolutions:n.resolutions,state:n.state})||this).canvasFunction_=n.canvasFunction,r.canvas_=null,r.renderedRevision_=0,r.ratio_=void 0!==n.ratio?n.ratio:1.5,r}return i8(e,t),e.prototype.getImageInternal=function(t,e,r,n){e=this.findNearestResolution(e);var i=this.canvas_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==e&&i.getPixelRatio()==r&&gt(i.getExtent(),t))return i;Bt(t=t.slice(),this.ratio_);var o=[Gt(t)/e*r,At(t)/e*r],s=this.canvasFunction_.call(this,t,e,r,o,n);return s&&(i=new Q2(t,e,r,s)),this.canvas_=i,this.renderedRevision_=this.getRevision(),i},e}(g_),s8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var a8,l8=function(t){function e(e){var r=t.call(this,{imageSmoothing:e.imageSmoothing,projection:e.projection,resolutions:e.resolutions})||this;return r.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,r.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,r.params_=e.params||{},r.url_=e.url,r.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:d_,r.hidpi_=void 0===e.hidpi||e.hidpi,r.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,r.ratio_=void 0!==e.ratio?e.ratio:1,r.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,r.image_=null,r.renderedRevision_=0,r}return s8(e,t),e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,r,n){e=this.findNearestResolution(e),r=this.hidpi_?r:1;var i=this.image_;if(i&&this.renderedRevision_==this.getRevision()&&i.getResolution()==e&&i.getPixelRatio()==r&&gt(i.getExtent(),t))return i;1!=this.ratio_&&Bt(t=t.slice(),this.ratio_);var o=[Gt(t)/e*r,At(t)/e*r];if(void 0!==this.url_){var s=this.getUrl(this.url_,this.params_,t,o,n);(i=new sm(t,e,r,s,this.crossOrigin_,this.imageLoadFunction_)).addEventListener($s,this.handleImageChange.bind(this))}else i=null;return this.image_=i,this.renderedRevision_=this.getRevision(),i},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.updateParams=function(t){V(this.params_,t),this.changed()},e.prototype.getUrl=function(t,e,r,n,i){var o=function(t,e,r,n){var i=Gt(t),o=At(t),s=e[0],a=e[1],l=.0254/n;return a*i>s*o?i*r/(s*l):o*r/(a*l)}(r,n,this.metersPerUnit_,this.displayDpi_),s=Mt(r),a={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(n[0]),SETDISPLAYHEIGHT:Math.round(n[1]),SETVIEWSCALE:o,SETVIEWCENTERX:s[0],SETVIEWCENTERY:s[1]};return V(a,e),Zm(t,a)},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e}(g_),u8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c8=function(t){function e(e){var r=this,n=void 0!==e.crossOrigin?e.crossOrigin:null,i=void 0!==e.imageLoadFunction?e.imageLoadFunction:d_;return(r=t.call(this,{attributions:e.attributions,imageSmoothing:e.imageSmoothing,projection:ye(e.projection)})||this).url_=e.url,r.imageExtent_=e.imageExtent,r.image_=new sm(r.imageExtent_,void 0,1,r.url_,n,i),r.imageSize_=e.imageSize?e.imageSize:null,r.image_.addEventListener($s,r.handleImageChange.bind(r)),r}return u8(e,t),e.prototype.getImageExtent=function(){return this.imageExtent_},e.prototype.getImageInternal=function(t,e,r,n){return zt(t,this.image_.getExtent())?this.image_:null},e.prototype.getUrl=function(){return this.url_},e.prototype.handleImageChange=function(e){if(this.image_.getState()==Bd){var r=this.image_.getExtent(),n=this.image_.getImage(),i=void 0,o=void 0;this.imageSize_?(i=this.imageSize_[0],o=this.imageSize_[1]):(i=n.width,o=n.height);var s=Gt(r),a=At(r),l=s/i,u=a/o,c=i,h=o;if(l>u?c=Math.round(s/u):h=Math.round(a/l),c!==i||h!==o){var f=ol(c,h);V(f,this.getContextOptions());var p=f.canvas;f.drawImage(n,0,0,i,o,0,0,p.width,p.height),this.image_.setImage(p)}}t.prototype.handleImageChange.call(this,e)},e}(g_),h8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f8=!0;try{new ImageData(10,10)}catch(t){f8=!1}function p8(t){var e=!0;try{new ImageData(10,10)}catch(t){e=!1}function r(t,r,n){return e?new ImageData(t,r,n):{data:t,width:r,height:n}}return function(e){var n=e.buffers,i=e.meta,o=e.imageOps,s=e.width,a=e.height,l=n.length,u=n[0].byteLength;if(o){for(var c=new Array(l),h=0;h<l;++h)c[h]=r(new Uint8ClampedArray(n[h]),s,a);return t(c,i).data.buffer}var f=new Uint8ClampedArray(u),p=new Array(l),d=new Array(l);for(h=0;h<l;++h)p[h]=new Uint8ClampedArray(n[h]),d[h]=[0,0,0,0];for(var g=0;g<u;g+=4){for(var y=0;y<l;++y){var m=p[y];d[y][0]=m[g],d[y][1]=m[g+1],d[y][2]=m[g+2],d[y][3]=m[g+3]}var _=t(d,i);f[g]=_[0],f[g+1]=_[1],f[g+2]=_[2],f[g+3]=_[3]}return f.buffer}}function d8(t,e){var r=Object.keys(t.lib||{}).map((function(e){return"var "+e+" = "+t.lib[e].toString()+";"})).concat(["var __minion__ = ("+p8.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),n=new Blob(r,{type:"text/javascript"}),i=URL.createObjectURL(n),o=new Worker(i);return o.addEventListener("message",e),o}var g8=function(t){function e(e){var r,n=t.call(this)||this;n._imageOps=!!e.imageOps,r=0===e.threads?0:n._imageOps?1:e.threads||1;var i=new Array(r);if(r)for(var o=0;o<r;++o)i[o]=d8(e,n._onWorkerMessage.bind(n,o));else i[0]=function(t,e){var r=p8(t.operation),n=!1;return{postMessage:function(t){setTimeout((function(){n||e({data:{buffer:r(t),meta:t.meta}})}),0)},terminate:function(){n=!0}}}(e,n._onWorkerMessage.bind(n,0));return n._workers=i,n._queue=[],n._maxQueueLength=e.queue||1/0,n._running=0,n._dataLookup={},n._job=null,n}return h8(e,t),e.prototype.process=function(t,e,r){this._enqueue({inputs:t,meta:e,callback:r}),this._dispatch()},e.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},e.prototype._dispatch=function(){if(!this._running&&0!==this._queue.length){var t=this._queue.shift();this._job=t;var e=t.inputs[0].width,r=t.inputs[0].height,n=t.inputs.map((function(t){return t.data.buffer})),i=this._workers.length;if(this._running=i,1!==i)for(var o=t.inputs[0].data.length,s=4*Math.ceil(o/4/i),a=0;a<i;++a){for(var l=a*s,u=[],c=0,h=n.length;c<h;++c)u.push(n[c].slice(l,l+s));this._workers[a].postMessage({buffers:u,meta:t.meta,imageOps:this._imageOps,width:e,height:r},u)}else this._workers[0].postMessage({buffers:n,meta:t.meta,imageOps:this._imageOps,width:e,height:r},n)}},e.prototype._onWorkerMessage=function(t,e){this.disposed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())},e.prototype._resolveJob=function(){var t,e,r=this._job,n=this._workers.length;if(1===n)t=new Uint8ClampedArray(this._dataLookup[0].buffer),e=this._dataLookup[0].meta;else{var i=r.inputs[0].data.length;t=new Uint8ClampedArray(i),e=new Array(n);for(var o=4*Math.ceil(i/4/n),s=0;s<n;++s){var a=this._dataLookup[s].buffer,l=s*o;t.set(new Uint8ClampedArray(a),l),e[s]=this._dataLookup[s].meta}}this._job=null,this._dataLookup={},r.callback(null,function(t,e,r){if(f8)return new ImageData(t,e,r);a8||(a8=document.createElement("canvas").getContext("2d"));var n=a8.createImageData(e,r);return n.data.set(t),n}(t,r.inputs[0].width,r.inputs[0].height),e),this._dispatch()},e.prototype.disposeInternal=function(){for(var t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0},e}(hs),y8="beforeoperations",m8="afteroperations",_8="pixel",v8="image",b8=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.extent=r.extent,i.resolution=r.viewState.resolution/r.pixelRatio,i.data=n,i}return h8(e,t),e}(Xs),w8=function(t){function e(e){var r=t.call(this,{projection:null})||this;r.on,r.once,r.un,r.processor_=null,r.operationType_=void 0!==e.operationType?e.operationType:_8,r.threads_=void 0!==e.threads?e.threads:1,r.layers_=function(t){for(var e=t.length,r=new Array(e),n=0;n<e;++n)r[n]=S8(t[n]);return r}(e.sources);for(var n,i=r.changed.bind(r),o=0,s=r.layers_.length;o<s;++o)r.layers_[o].addEventListener($s,i);return r.tileQueue_=new gu((function(){return 1}),r.changed.bind(r)),r.requestedFrameState_,r.renderedImageCanvas_=null,r.renderedRevision_,r.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:(n=r.layers_,n.map((function(t){return t.getLayerState()}))),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:r.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}},r.setAttributions((function(t){for(var r=[],n=0,i=e.sources.length;n<i;++n){var o=e.sources[n],s=(o instanceof Im?o:o.getSource()).getAttributions();if("function"==typeof s){var a=s(t);r.push.apply(r,a)}}return 0!==r.length?r:null})),void 0!==e.operation&&r.setOperation(e.operation,e.lib),r}return h8(e,t),e.prototype.setOperation=function(t,e){this.processor_&&this.processor_.dispose(),this.processor_=new g8({operation:t,imageOps:this.operationType_===v8,queue:1,lib:e,threads:this.threads_}),this.changed()},e.prototype.updateFrameState_=function(t,e,r){var n=V({},this.frameState_);n.viewState=V({},n.viewState);var i=Mt(t);n.extent=t.slice(),n.size[0]=Math.round(Gt(t)/e),n.size[1]=Math.round(At(t)/e),n.time=Date.now();var o=n.viewState;return o.center=i,o.projection=r,o.resolution=e,n},e.prototype.allSourcesReady_=function(){for(var t=!0,e=0,r=this.layers_.length;e<r;++e)if(this.layers_[e].getSource().getState()!==Ua){t=!1;break}return t},e.prototype.getImage=function(t,e,r,n){if(!this.allSourcesReady_())return null;var i=this.updateFrameState_(t,e,n);if(this.requestedFrameState_=i,this.renderedImageCanvas_){var o=this.renderedImageCanvas_.getResolution(),s=this.renderedImageCanvas_.getExtent();e===o&&Et(t,s)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),i.tileQueue.loadMoreTiles(16,16),i.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},e.prototype.processSources_=function(){for(var t=this.requestedFrameState_,e=this.layers_.length,r=new Array(e),n=0;n<e;++n){t.layerIndex=n;var i=E8(this.layers_[n],t);if(!i)return;r[n]=i}var o={};this.dispatchEvent(new b8(y8,t,o)),this.processor_.process(r,o,this.onWorkerComplete_.bind(this,t))},e.prototype.onWorkerComplete_=function(t,e,r,n){if(!e&&r){var i=t.extent,o=t.viewState.resolution;if(o===this.requestedFrameState_.viewState.resolution&&Et(i,this.requestedFrameState_.extent)){var s;if(this.renderedImageCanvas_)s=this.renderedImageCanvas_.getImage().getContext("2d");else s=ol(Math.round(Gt(i)/o),Math.round(At(i)/o)),this.renderedImageCanvas_=new Q2(i,o,1,s.canvas);s.putImageData(r,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new b8(m8,t,n)),t.animate&&requestAnimationFrame(this.changed.bind(this))}}},e.prototype.disposeInternal=function(){this.processor_&&this.processor_.dispose(),t.prototype.disposeInternal.call(this)},e}(g_);w8.prototype.dispose;var x8=null;function E8(t,e){var r=t.getRenderer();if(!r)throw new Error("Unsupported layer type: "+t);if(!r.prepareFrame(e))return null;var n=e.size[0],i=e.size[1];if(0===n||0===i)return null;var o,s=r.renderFrame(e,null);if(s&&(o=s.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===n&&o.height===i)return o.getContext("2d").getImageData(0,0,n,i);if(x8){var a=x8.canvas;a.width!==n||a.height!==i?x8=ol(n,i):x8.clearRect(0,0,n,i)}else x8=ol(n,i);return x8.drawImage(o,0,0,n,i),x8.getImageData(0,0,n,i)}function S8(t){var e;return t instanceof Im?t instanceof Nm?e=new rg({source:t}):t instanceof g_&&(e=new lg({source:t})):e=t,e}var I8=w8,O8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C8=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',iU],T8={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},P8={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},R8=function(t){function e(e){var r=e.layer.indexOf("-"),n=-1==r?e.layer:e.layer.slice(0,r),i=P8[n],o=T8[e.layer],s=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+o.extension;return t.call(this,{attributions:C8,cacheSize:e.cacheSize,crossOrigin:"anonymous",imageSmoothing:e.imageSmoothing,maxZoom:null!=e.maxZoom?e.maxZoom:i.maxZoom,minZoom:null!=e.minZoom?e.minZoom:i.minZoom,opaque:o.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:s,wrapX:e.wrapX,zDirection:e.zDirection})||this}return O8(e,t),e}(zz),L8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),M8=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:n.tileGrid,tileLoadFunction:n.tileLoadFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).params_=n.params||{},r.hidpi_=void 0===n.hidpi||n.hidpi,r.tmpExtent_=[1/0,1/0,-1/0,-1/0],r.setKey(r.getKeyForParams_()),r}return L8(e,t),e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var r in this.params_)e[t++]=r+"-"+this.params_[r];return e.join("/")},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,r,n,i,o){var s=this.urls;if(s){var a,l=i.getCode().split(/:(?=\d+$)/).pop();if(o.SIZE=e[0]+","+e[1],o.BBOX=r.join(","),o.BBOXSR=l,o.IMAGESR=l,o.DPI=Math.round(o.DPI?o.DPI*n:90*n),1==s.length)a=s[0];else a=s[E(pg(t),s.length)];return Zm(a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),o)}},e.prototype.getTilePixelRatio=function(t){return this.hidpi_?t:1},e.prototype.updateParams=function(t){V(this.params_,t),this.setKey(this.getKeyForParams_())},e.prototype.tileUrlFunction=function(t,e,r){var n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(r)),!(n.getResolutions().length<=t[0])){1==e||this.hidpi_||(e=1);var i=n.getTileCoordExtent(t,this.tmpExtent_),o=Vc(n.getTileSize(t[0]),this.tmpSize);1!=e&&(o=Bc(o,e,this.tmpSize));var s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return V(s,this.params_),this.getRequestUrl_(t,o,i,e,r,s)}},e}(qm),k8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),N8=function(t){function e(e){var r=this,n=e||{};return r=t.call(this,{opaque:!1,projection:n.projection,tileGrid:n.tileGrid,wrapX:void 0===n.wrapX||n.wrapX,zDirection:n.zDirection,url:n.template||"z:{z} x:{x} y:{y}",tileLoadFunction:function(t,e){var n=t.getTileCoord()[0],i=Vc(r.tileGrid.getTileSize(n)),o=ol(i[0],i[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,i[0]+.5,i[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(e,i[0]/2,i[1]/2,i[0]),o.fillText(e,i[0]/2,i[1]/2,i[0]),t.setImage(o.canvas)}})||this}return k8(e,t),e}(zz),A8=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),F8=function(t){function e(e,r,n,i,o,s){var a=t.call(this,e,r)||this;return a.src_=n,a.extent_=i,a.preemptive_=o,a.grid_=null,a.keys_=null,a.data_=null,a.jsonp_=s,a}return A8(e,t),e.prototype.getImage=function(){return null},e.prototype.getData=function(t){if(!this.grid_||!this.keys_)return null;var e=(t[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),r=(t[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),n=this.grid_[Math.floor((1-r)*this.grid_.length)];if("string"!=typeof n)return null;var i=n.charCodeAt(Math.floor(e*n.length));i>=93&&i--,i>=35&&i--;var o=null;if((i-=32)in this.keys_){var s=this.keys_[i];o=this.data_&&s in this.data_?this.data_[s]:s}return o},e.prototype.forDataAtCoordinate=function(t,e,r){this.state==pu&&!0===r?(this.state=uu,pa(this,$s,(function(r){e(this.getData(t))}),this),this.loadInternal_()):!0===r?setTimeout(function(){e(this.getData(t))}.bind(this),0):e(this.getData(t))},e.prototype.getKey=function(){return this.src_},e.prototype.handleError_=function(){this.state=fu,this.changed()},e.prototype.handleLoad_=function(t){this.grid_=t.grid,this.keys_=t.keys,this.data_=t.data,this.state=hu,this.changed()},e.prototype.loadInternal_=function(){if(this.state==uu)if(this.state=cu,this.jsonp_)Object(K1.a)(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",this.src_),t.send()}},e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r=void 0;try{r=JSON.parse(e.responseText)}catch(t){return void this.handleError_()}this.handleLoad_(r)}else this.handleError_()},e.prototype.onXHRError_=function(t){this.handleError_()},e.prototype.load=function(){this.preemptive_?this.loadInternal_():this.setState(pu)},e}(em),D8=function(t){function e(e){var r=t.call(this,{projection:ye("EPSG:3857"),state:za,zDirection:e.zDirection})||this;if(r.preemptive_=void 0===e.preemptive||e.preemptive,r.tileUrlFunction_=jm,r.template_=void 0,r.jsonp_=e.jsonp||!1,e.url)if(r.jsonp_)Object(K1.a)(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var n=new XMLHttpRequest;n.addEventListener("load",r.onXHRLoad_.bind(r)),n.addEventListener("error",r.onXHRError_.bind(r)),n.open("GET",e.url),n.send()}else e.tileJSON?r.handleTileJSONResponse(e.tileJSON):ut(!1,51);return r}return A8(e,t),e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r=void 0;try{r=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTemplate=function(){return this.template_},e.prototype.forDataAtCoordinateAndResolution=function(t,e,r,n){if(this.tileGrid){var i=this.tileGrid.getZForResolution(e,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(t,i);this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(t,r,n)}else!0===n?setTimeout((function(){r(null)}),0):r(null)},e.prototype.handleTileJSONError=function(){this.setState(Ba)},e.prototype.handleTileJSONResponse=function(t){var e,r=ye("EPSG:4326"),n=this.getProjection();if(void 0!==t.bounds){var i=Se(r,n);e=Vt(t.bounds,i)}var o=Rm(n),s=t.minzoom||0,a=Cm({extent:o,maxZoom:t.maxzoom||22,minZoom:s});this.tileGrid=a,this.template_=t.template;var l=t.grids;if(l){if(this.tileUrlFunction_=Fm(l,a),void 0!==t.attribution){var u=void 0!==e?e:o;this.setAttributions((function(e){return zt(u,e.extent)?[t.attribution]:null}))}this.setState(Ua)}else this.setState(Ba)},e.prototype.getTile=function(t,e,r,n,i){var o=cg(t,e,r);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=[t,e,r],a=this.getTileCoordForTileUrlFunction(s,i),l=this.tileUrlFunction_(a,n,i),u=new F8(s,void 0!==l?uu:pu,void 0!==l?l:"",this.tileGrid.getTileCoordExtent(s),this.preemptive_,this.jsonp_);return this.tileCache.set(o,u),u},e.prototype.useTile=function(t,e,r){var n=cg(t,e,r);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Nm),j8=window.M={},G8=window.ol={};j8.ClusteredFeature=Eq,j8.Control=bp,j8.Feature=mq,j8.Filter=WO,j8.Label=ZN,j8.Layer=Ad,j8.Map=JB,j8.Object=ff,j8.Parameters=JN,j8.Plugin=Lq,j8.Popup=CO,j8.RenderFeature=oA,j8.Style=Rx,j8.addProxyException=function(t){var e=new URL(t).origin;-1===tV.indexOf(e)&&tV.push(e)},j8.config=function t(e,r){t[e]=r},j8.control={},j8.control.GetFeatureInfo=pN,j8.control.LayerSwitcher=$C,j8.control.Location=RT,j8.control.Mouse=LR,j8.control.Navtoolbar=dL,j8.control.OverviewMap=rL,j8.control.Panzoom=ML,j8.control.Panzoombar=Np,j8.control.Rotate=wP,j8.control.Rotate.onClick=_P,j8.control.Rotate.onMouseDown=yP,j8.control.Rotate.onMouseMove=vP,j8.control.Rotate.onMouseUp=mP,j8.control.Scale=$T,j8.control.ScaleLine=rR,j8.control.WMCSelector=Uv,j8.dialog={},j8.dialog.error=VO,j8.dialog.info=BO,j8.dialog.show=UO,j8.dialog.success=qO,j8.evt={},j8.evt.ACTIVATED=Wf,j8.evt.ADDED_GEOPACKAGE="added:geopackage",j8.evt.ADDED_GEOPACKAGE_TILE="added:geopackagetile",j8.evt.ADDED_GEOPACKAGE_VECTOR="added:geopackagevector",j8.evt.ADDED_KML=Gf,j8.evt.ADDED_LAYER=Df,j8.evt.ADDED_MBTILES="added:mbtiles",j8.evt.ADDED_MBTILES_VECTOR="added:mbtilesvector",j8.evt.ADDED_TO_MAP=Af,j8.evt.ADDED_TO_PANEL=Ff,j8.evt.ADDED_VECTOR_TILE=Bf,j8.evt.ADDED_WFS=Uf,j8.evt.ADDED_WMC=jf,j8.evt.ADDED_WMS=zf,j8.evt.ADDED_WMTS=Yf,j8.evt.CHANGE=np,j8.evt.CHANGE_PROJ=op,j8.evt.CHANGE_ROTATION=lp,j8.evt.CHANGE_STYLE=sp,j8.evt.CHANGE_WMC=ip,j8.evt.CHANGE_ZOOM=ap,j8.evt.CLICK=up,j8.evt.COMPLETED=rp,j8.evt.DEACTIVATED=Xf,j8.evt.DESTROY=Kf,j8.evt.DOUBLE_CLICK="doubleclick",j8.evt.EventsManager=cf,j8.evt.HIDE=Zf,j8.evt.HOVER_FEATURES=Qf,j8.evt.LEAVE_FEATURES=tp,j8.evt.LOAD=ep,j8.evt.LOAD_LAYERS="load:layers",j8.evt.Listener=lf,j8.evt.MOVE=cp,j8.evt.REMOVED_FROM_MAP=qf,j8.evt.REMOVED_LAYER=Vf,j8.evt.SELECT_FEATURES=$f,j8.evt.SHOW=Hf,j8.evt.UNSELECT_FEATURES=Jf,j8.exception=Of,j8.facade={},j8.facade.Base=Nf,j8.filter=Yq,j8.filter.AND=function(t){var e="",r=t.length;return t.forEach((function(t,n){e+="(".concat(t.toCQL(),")"),n<r-1&&(e+=" AND ")})),new Gq((function(e){return t.every((function(t){return t.getFunctionFilter()(e)}))}),{cqlFilter:e})},j8.filter.EQUAL=function(t,e){return new Gq((function(r){return Object.is(r.getAttribute(t),e)}),{cqlFilter:"".concat(t,"='").concat(e,"'")})},j8.filter.Function=Gq,j8.filter.GT=function(t,e){return new Gq((function(r){return null!=r.getAttribute(t)&&r.getAttribute(t)>e}),{cqlFilter:"".concat(t," > '").concat(e,"'")})},j8.filter.GTE=function(t,e){return new Gq((function(r){return null!=r.getAttribute(t)&&r.getAttribute(t)>=e}),{cqlFilter:"".concat(t," >= '").concat(e,"'")})},j8.filter.LIKE=function(t,e){return new Gq((function(r){return r.getAttribute(t).toString().match(new RegExp(e))}),{cqlFilter:"".concat(t," LIKE '%").concat(e,"%'")})},j8.filter.LT=function(t,e){return new Gq((function(r){return null!=r.getAttribute(t)&&r.getAttribute(t)<e}),{cqlFilter:"".concat(t," < '").concat(e,"'")})},j8.filter.LTE=zH,j8.filter.NOT=function(t){return new Gq((function(e){return!t.getFunctionFilter()(e)}),{cqlFilter:"NOT ".concat(t.toCQL())})},j8.filter.OR=function(t){var e=t.length,r="";return t.forEach((function(t,n){r+="(".concat(t.toCQL(),")"),n<e-1&&(r+=" OR ")})),new Gq((function(e){return t.some((function(t){return t.getFunctionFilter()(e)}))}),{cqlFilter:r})},j8.filter.spatial={},j8.filter.spatial.CONTAIN=function(t){var e=WJ(t);return new Yq((function(t,r){var n=new S$,i=n.read(t);return e.some((function(t){var e=n.read(t);return VJ.contains(e,i)}))}),{cqlFilter:XJ("CONTAINS",e)})},j8.filter.spatial.DISJOINT=function(t){var e=WJ(t);return new Yq((function(t,r){var n=new S$,i=n.read(t);return e.some((function(t){var e=n.read(t);return!VJ.intersects(i,e)}))}),{cqlFilter:XJ("DISJOINT",e)})},j8.filter.spatial.INTERSECT=function(t){var e=WJ(t);return new Yq((function(t,r){var n=new S$,i=n.read(t);return e.some((function(t){var e=n.read(t);return VJ.intersects(i,e)}))}),{cqlFilter:XJ("INTERSECTS",e)})},j8.filter.spatial.WITHIN=function(t){var e=WJ(t);return new Yq((function(t,r){var n=new S$,i=n.read(t);return e.some((function(t){var e=n.read(t);return VJ.contains(e,i)}))}),{cqlFilter:XJ("WITHIN",e)})},j8.filter.spatial.parseParamToGeometries=WJ,j8.format={},j8.format.GeoJSON=Rj,j8.format.WKT=LY,j8.geom={},j8.geom.geojson={},j8.geom.geojson.type={},j8.geom.geojson.type.GEOMETRY_COLLECTION="GeometryCollection",j8.geom.geojson.type.LINE_STRING="LineString",j8.geom.geojson.type.MULTI_LINE_STRING="MultiLineString",j8.geom.geojson.type.MULTI_POINT="MultiPoint",j8.geom.geojson.type.MULTI_POLYGON="MultiPolygon",j8.geom.geojson.type.POINT="Point",j8.geom.geojson.type.POLYGON="Polygon",j8.geom.parse=xG,j8.geom.parseWFS=function(t){var e;return t===yG?e=Eg:t===mG?e=mg:t===_G?e=_g:t===vG?e=vg:t===bG?e=bg:t===wG&&(e=wg),e},j8.geom.wfs={},j8.geom.wfs.type={},j8.geom.wfs.type.LINE=mG,j8.geom.wfs.type.MLINE=bG,j8.geom.wfs.type.MPOINT=vG,j8.geom.wfs.type.MPOLYGON=wG,j8.geom.wfs.type.POINT=yG,j8.geom.wfs.type.POLYGON=_G,j8.geom.wkt={},j8.geom.wkt.type={},j8.geom.wkt.type.CIRCLE=Ig,j8.geom.wkt.type.GEOMETRY=yg,j8.geom.wkt.type.GEOMETRY_COLLECTION=Sg,j8.geom.wkt.type.LINEAR_RING=xg,j8.geom.wkt.type.LINE_STRING=mg,j8.geom.wkt.type.MULTI_LINE_STRING=bg,j8.geom.wkt.type.MULTI_POINT=vg,j8.geom.wkt.type.MULTI_POLYGON=wg,j8.geom.wkt.type.POINT=Eg,j8.geom.wkt.type.POLYGON=_g,j8.handler={},j8.handler.Feature=wA,j8.impl={},j8.impl.Control=Ev,j8.impl.Feature=cq,j8.impl.GetCapabilities=fy,j8.impl.Label=UN,j8.impl.Layer=cy,j8.impl.Map=dv,j8.impl.Popup=dO,j8.impl.RenderFeature=aA,j8.impl.Style=zw,j8.impl.View=$_,j8.impl.control={},j8.impl.control.GetFeatureInfo=rN,j8.impl.control.LayerSwitcher=gb,j8.impl.control.Location=vT,j8.impl.control.Mouse=wR,j8.impl.control.Navtoolbar=iL,j8.impl.control.OverviewMap=qR,j8.impl.control.Panzoom=EL,j8.impl.control.Panzoombar=If,j8.impl.control.Rotate=sP,j8.impl.control.Scale=UT,j8.impl.control.ScaleLine=YP,j8.impl.control.WMCSelector=Mv,j8.impl.format={},j8.impl.format.DescribeFeatureType=Bj,j8.impl.format.DescribeFeatureTypeXML=zj,j8.impl.format.GML=Qj,j8.impl.format.GeoJSON=xj,j8.impl.format.KML=BD,j8.impl.format.WKT=EY,j8.impl.format.WMC=$G,j8.impl.format.WMSCapabilities=$y,j8.impl.format.WMTSCapabilities=NY,j8.impl.format.XML=kj,j8.impl.handler={},j8.impl.handler.Feature=hA,j8.impl.interaction={},j8.impl.interaction.SelectCluster=cI,j8.impl.layer={},j8.impl.layer.AnimatedCluster=KS,j8.impl.layer.Draw=UY,j8.impl.layer.GeoJSON=TB,j8.impl.layer.Heatmap=AW,j8.impl.layer.KML=ZD,j8.impl.layer.MVT=QU,j8.impl.layer.Mapbox=Hz,j8.impl.layer.OSM=pU,j8.impl.layer.Vector=jO,j8.impl.layer.WFS=gG,j8.impl.layer.WMC=sz,j8.impl.layer.WMS=F_,j8.impl.layer.WMTS=Rz,j8.impl.loader={},j8.impl.loader.JSONP=bB,j8.impl.loader.KML=RA,j8.impl.loader.WFS=sG,j8.impl.service={},j8.impl.service.WFS=qj,j8.impl.source={},j8.impl.source.ImageWMS=C_,j8.impl.source.TileWMS=s_,j8.impl.style={},j8.impl.style.Centroid=px,j8.impl.style.Chart=OX,j8.impl.style.Cluster=wI,j8.impl.style.Generic=_C,j8.impl.style.Heatmap=kX,j8.impl.style.Icon=UX,j8.impl.style.Line=lH,j8.impl.style.Path=eC,j8.impl.style.Point=VE,j8.impl.style.Polygon=wx,j8.impl.style.Simple=Hw,j8.impl.utils=ry,j8.language={},j8.language.addTranslation=function(t,e){hp.translations[t]=e},j8.language.getLang=function(){return hp.lang},j8.language.getTranslation=fp,j8.language.getValue=pp,j8.language.setLang=function(t){Object.keys(hp.translations).includes(t)||Of(pp("exception").unsupported_lang),hp.lang=t},j8.layer={},j8.layer.GeoJSON=UB,j8.layer.KML=sj,j8.layer.LayerGroup=sb,j8.layer.MVT=pB,j8.layer.MVT.mode=hB,j8.layer.Mapbox=rU,j8.layer.OSM=wU,j8.layer.Vector=UC,j8.layer.WFS=AG,j8.layer.WMC=pz,j8.layer.WMS=q_,j8.layer.WMTS=jz,j8.layer.type={},j8.layer.type.GeoJSON=Bp,j8.layer.type.KML=Fp,j8.layer.type.MVT=qp,j8.layer.type.Mapbox=Up,j8.layer.type.OSM=zp,j8.layer.type.Vector=Vp,j8.layer.type.WFS=jp,j8.layer.type.WMC=Ap,j8.layer.type.WMS=Dp,j8.layer.type.WMTS=Gp,j8.layer.type.registerLayerType=function(t){t in Yp||(Yp[t]=t)},j8.map=function(t,e){return _V(dv)&&Of(pp("exception").no_impl),new JB(t,e)},j8.parameter={},j8.parameter.center=_d,j8.parameter.geojson=dd,j8.parameter.kml=rd,j8.parameter.layer=Cd,j8.parameter.mapbox=sd,j8.parameter.maxExtent=vd,j8.parameter.mvt=Sd,j8.parameter.osm=cd,j8.parameter.projection=bd,j8.parameter.resolutions=wd,j8.parameter.wfs=Ed,j8.parameter.wmc=yd,j8.parameter.wms=Jp,j8.parameter.wmts=Id,j8.parameter.zoom=xd,j8.projection={},j8.projection.addProjections=us,j8.proxy=function(t){"boolean"==typeof t&&(QB=t)},j8.remote={},j8.remote.Response=nV,j8.remote.get=uV,j8.remote.post=function(t,e,r){return lV(t,e,oV)},j8.removeProxyException=function(t){var e=new URL(t).origin,r=tV.indexOf(e);-1!==r&&tV.splice(r,1)},j8.style={},j8.style.Category=NH,j8.style.Chart=QW,j8.style.Choropleth=QH,j8.style.Cluster=zI,j8.style.Composite=TI,j8.style.Feature=Dx,j8.style.Font=eZ,j8.style.Generic=PC,j8.style.Heatmap=xZ,j8.style.Line=ZX,j8.style.Point=$E,j8.style.Polygon=nE,j8.style.Proportional=wH,j8.style.Proportional.getMinMaxValues=_H,j8.style.Simple=Hx,j8.style.align={},j8.style.align.CENTER=Wb,j8.style.align.JUSTIFY=Hb,j8.style.align.LEFT=Yb,j8.style.align.RIGHT=Xb,j8.style.baseline={},j8.style.baseline.ALPHABETIC=Bb,j8.style.baseline.BOTTOM=Ub,j8.style.baseline.HANGING=Vb,j8.style.baseline.IDEOGRAPHIC=qb,j8.style.baseline.MIDDLE=zb,j8.style.baseline.TOP=Gb,j8.style.chart={},j8.style.chart.Variable=jW,j8.style.chart.schemes=zW,j8.style.chart.types=GW,j8.style.form={},j8.style.form.BAN="BAN",j8.style.form.BLAZON="BLAZON",j8.style.form.BOOKMARK="BOOKMARK",j8.style.form.BUBBLE="BUBBLE",j8.style.form.CIRCLE="CIRCLE",j8.style.form.COMA="COMA",j8.style.form.DIAMOND="DIAMOND",j8.style.form.HEXAGON="HEXAGON",j8.style.form.LOZENGE="LOZENGE",j8.style.form.MARKER="MARKER",j8.style.form.NONE="none",j8.style.form.POI="POI",j8.style.form.SHIELD="SHIELD",j8.style.form.SIGN="SIGN",j8.style.form.SQUARE="SQUARE",j8.style.form.TRIANGLE="TRIANGLE",j8.style.pattern={},j8.style.pattern.BRECCIA="BRECCIA",j8.style.pattern.BRICK="BRICK",j8.style.pattern.CAPS="CAPS",j8.style.pattern.CEMETRY="CEMETRY",j8.style.pattern.CHAOS="CHAOS",j8.style.pattern.CHARACTER="CHARACTER",j8.style.pattern.CIRCLE="CIRCLE",j8.style.pattern.CLAY="CLAY",j8.style.pattern.COAL="COAL",j8.style.pattern.CONGLOMERATE="CONGLOMERATE",j8.style.pattern.CROSS="CROSS",j8.style.pattern.CROSSES="CROSSES",j8.style.pattern.DOLOMITE="DOLOMITE",j8.style.pattern.DOT="DOT",j8.style.pattern.FLOODED="FLOODED",j8.style.pattern.FOREST="FOREST",j8.style.pattern.GRASS="GRASS",j8.style.pattern.GRAVEL="GRAVEL",j8.style.pattern.HATCH="HATCH",j8.style.pattern.HEXAGON="HEXAGON",j8.style.pattern.ICON="ICON",j8.style.pattern.IMAGE="IMAGE",j8.style.pattern.NYLON="NYLON",j8.style.pattern.PINE="PINE",j8.style.pattern.PINES="PINES",j8.style.pattern.ROCK="ROCK",j8.style.pattern.ROCKS="ROCKS",j8.style.pattern.SAND="SAND",j8.style.pattern.SCRUB="SCRUB",j8.style.pattern.SQUARE="SQUARE",j8.style.pattern.SWAMP="SWAMP",j8.style.pattern.TILE="TILE",j8.style.pattern.TREE="TREE",j8.style.pattern.VINE="VINE",j8.style.pattern.WAVE="WAVE",j8.style.pattern.WOVEN="WOVEN",j8.style.quantification={},j8.style.quantification.JENKS=jH,j8.style.quantification.QUANTILE=GH,j8.style.state={},j8.style.state.DEFAULT="default",j8.style.state.NEW="new",j8.style.state.SELECTED="selected",j8.style.textoverflow={},j8.style.textoverflow.ELLIPSIS="ellipsis",j8.style.textoverflow.HIDDEN="",j8.style.textoverflow.VISIBLE="visible",j8.template={},j8.template.add=function(t,e){dV(Ep[t])&&(Ep[t]=e)},j8.template.compile=function(t,e){var r,n,i={};return dV(e)||(i=HV(i,e.vars),r=e.parseToHtml,n=e.scope),new Promise((function(o,s){Ip(t,e).then((function(t){var e=t.call(null,i);!1!==r?o.call(n,NV(e)):o.call(n,e)}))}))},j8.template.compileSync=Sp,j8.template.get=Ip,j8.ui={},j8.ui.Panel=CN,j8.ui.position={},j8.ui.position.BL=_N,j8.ui.position.BR=vN,j8.ui.position.TL=yN,j8.ui.position.TR=mN,j8.units={},j8.units.DOTS_PER_INCH=72,j8.units.INCHES_PER_UNIT=cV,j8.utils={},j8.utils.addParameters=OV,j8.utils.beautifyAttribute=AV,j8.utils.beautifyAttributeName=FV,j8.utils.beautifyString=function(t){var e;return e=(e=(e=(e=(e=(e=(e=t.toLowerCase()).trim(e)).charAt(0).toUpperCase()+e.slice(1)).replace(/_/g," ")).replace(/\s+/," ")).replace(/(\s\w)+/g,(function(t){return t.toUpperCase()}))).replace(/\s+(de|del|las?|el|los?|un|unas?|unos?|y|a|al|en)\s+/gi,(function(t){return t.toLowerCase()}))},j8.utils.concatUrlPaths=DV,j8.utils.decodeHtml=qV,j8.utils.defineFunctionFromString=QV,j8.utils.drawDynamicStyle=oq,j8.utils.enableTouchScroll=UV,j8.utils.escapeJSCode=zV,j8.utils.escapeXSS=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},j8.utils.extend=GV,j8.utils.extendsObj=HV,j8.utils.fillResolutions=RV,j8.utils.generateColorScale=WV,j8.utils.generateIntervals=ZV,j8.utils.generateRandom=CV,j8.utils.generateResolutionsFromExtent=MV,j8.utils.generateResolutionsFromScales=function(t,e,r,n){var i=LV(t,n),o=LV(e,n);return RV(i,o,r)},j8.utils.getEnvolvedExtent=sq,j8.utils.getImageSize=$V,j8.utils.getOpacityFromRgba=function(t){var e,r=/^rgba\s*\((\s*\d+\s*,){3}\s*([\d.]+)\s*\)$/;if(r.test(t)){e=t.replace(r,"$2");try{e=parseFloat(e)}catch(t){throw t}}return e},j8.utils.getParameterValue=IV,j8.utils.getResolutionFromScale=LV,j8.utils.getRgba=function(t,e){return u()(t).alpha(e).css()},j8.utils.getScaleFromResolution=kV,j8.utils.getSystem=aq,j8.utils.getTextFromHtml=YV,j8.utils.getWMSGetCapabilitiesUrl=TV,j8.utils.getWMTSGetCapabilitiesUrl=PV,j8.utils.htmlToString=function(t){var e;if(!_V(t)){var r=document.createElement("div");r.appendChild(t),e=r.innerHTML}return e},j8.utils.includes=jV,j8.utils.inverseColor=XV,j8.utils.isArray=mV,j8.utils.isBoolean=gV,j8.utils.isDynamic=nq,j8.utils.isFunction=vV,j8.utils.isGeometryType=VV,j8.utils.isNull=yV,j8.utils.isNullOrEmpty=_V,j8.utils.isNumber=EV,j8.utils.isObject=bV,j8.utils.isPositiveNumber=function(t){return EV(t)&&t>0},j8.utils.isString=wV,j8.utils.isUndefined=dV,j8.utils.isUrl=xV,j8.utils.normalize=SV,j8.utils.rgbToHex=function(t){var e;try{e=u()(t).hex()}catch(t){throw t}return e},j8.utils.rgbaToHex=function(t){var e;try{e=u()(t).hex()}catch(t){throw t}return e},j8.utils.sameUrl=BV,j8.utils.setDynamicLegend=function(t){iq=t},j8.utils.setEquals=function(t,e){var r=!1;return t.length===e.length&&(r=t.every((function(t){return e.some((function(e){return e.equals(t)}))}))),r},j8.utils.stringToHtml=NV,j8.utils.stringifyFunctions=JV,j8.utils.styleComparator=KV,j8.version=eV,j8.window=sO,G8.AssertionError=lt,G8.Collection=Gl,G8.Feature=Cg,G8.Geolocation=cT,G8.Kinetic=Xh,G8.Map=of,G8.MapBrowserEvent=Wl,G8.Object=wa,G8.Observable=_a,G8.Observable.unByKey=ma,G8.Overlay=nO,G8.PluggableMap=Yc,G8.View=Gc,G8.View=Gc,G8.array={},G8.array.stableSort=function(t,e){var r,n=t.length,i=Array(t.length);for(r=0;r<n;r++)i[r]={index:r,value:t[r]};for(i.sort((function(t,r){return e(t.value,r.value)||t.index-r.index})),r=0;r<t.length;r++)t[r]=i[r].value},G8.color={},G8.color.asArray=zs,G8.color.asString=As,G8.colorlike={},G8.colorlike.asColorLike=pw,G8.control={},G8.control.Attribution=Zc,G8.control.Control=Xc,G8.control.FullScreen=eQ,G8.control.MousePosition=lR,G8.control.OverviewMap=FR,G8.control.Rotate=$c,G8.control.ScaleLine=LP,G8.control.Zoom=Qc,G8.control.ZoomSlider=_f,G8.control.ZoomToExtent=nQ,G8.control.defaults=th,G8.coordinate={},G8.coordinate.add=Qt,G8.coordinate.createStringXY=ee,G8.coordinate.format=ne,G8.coordinate.rotate=oe,G8.coordinate.toStringHDMS=function(t,e){return t?re("NS",t[1],e)+" "+re("EW",t[0],e):""},G8.coordinate.toStringXY=ce,G8.easing={},G8.easing.easeIn=Pu,G8.easing.easeOut=Ru,G8.easing.inAndOut=Lu,G8.easing.linear=Mu,G8.easing.upAndDown=ku,G8.events={},G8.events.condition={},G8.events.condition.altKeyOnly=hh,G8.events.condition.altShiftKeysOnly=fh,G8.events.condition.always=gh,G8.events.condition.click=function(t){return t.type==Xl.CLICK},G8.events.condition.doubleClick=function(t){return t.type==Xl.DBLCLICK},G8.events.condition.focus=ph,G8.events.condition.mouseOnly=xh,G8.events.condition.never=mh,G8.events.condition.noModifierKeys=vh,G8.events.condition.penOnly=function(t){var e=t.originalEvent;return ut(void 0!==e,56),"pen"===e.pointerType},G8.events.condition.platformModifierKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&(vs?e.metaKey:e.ctrlKey)&&!e.shiftKey},G8.events.condition.pointerMove=function(t){return"pointermove"==t.type},G8.events.condition.primaryAction=Eh,G8.events.condition.shiftKeyOnly=bh,G8.events.condition.singleClick=_h,G8.events.condition.targetNotEditable=wh,G8.events.condition.touchOnly=function(t){var e=t.originalEvent;return ut(void 0!==e,56),"touch"===e.pointerType},G8.extent={},G8.extent.applyTransform=Vt,G8.extent.boundingExtent=ct,G8.extent.buffer=ht,G8.extent.containsCoordinate=dt,G8.extent.containsExtent=gt,G8.extent.containsXY=yt,G8.extent.createEmpty=_t,G8.extent.equals=Et,G8.extent.extend=St,G8.extent.getArea=Pt,G8.extent.getBottomLeft=Rt,G8.extent.getBottomRight=Lt,G8.extent.getCenter=Mt,G8.extent.getHeight=At,G8.extent.getIntersection=Ft,G8.extent.getSize=function(t){return[t[2]-t[0],t[3]-t[1]]},G8.extent.getTopLeft=Dt,G8.extent.getTopRight=jt,G8.extent.getWidth=Gt,G8.extent.intersects=zt,G8.extent.isEmpty=Ut,G8.featureloader={},G8.featureloader.setWithCredentials=function(t){Lb=t},G8.featureloader.xhr=kb,G8.format={},G8.format.EsriJSON=hQ,G8.format.Feature=kL,G8.format.GML=Wj,G8.format.GML2=WL,G8.format.GML3=KL,G8.format.GML32=QL,G8.format.GMLBase=BL,G8.format.GPX=XQ,G8.format.GeoJSON=pj,G8.format.IGC=r0,G8.format.IIIFInfo=f0,G8.format.KML=kD,G8.format.MVT=WU,G8.format.OSMXML=b0,G8.format.Polyline=T0,G8.format.Polyline.decodeDeltas=S0,G8.format.Polyline.decodeFloats=O0,G8.format.Polyline.encodeDeltas=E0,G8.format.Polyline.encodeFloats=I0,G8.format.TopoJSON=D0,G8.format.WFS=Bk,G8.format.WFS.writeFilter=function(t,e){var r=e||"1.1.0",n=Ze(Uk(r),"Filter"),i={node:n};return V(i,{version:r,filter:t}),Ik(n,t,[i]),n},G8.format.WKB=J0,G8.format.WKT=gY,G8.format.WMSCapabilities=jy,G8.format.WMSGetFeatureInfo=t1,G8.format.WMTSCapabilities=dn,G8.format.filter={},G8.format.filter.Bbox=sM,G8.format.filter.Contains=cM,G8.format.filter.DWithin=fM,G8.format.filter.Disjoint=dM,G8.format.filter.During=_M,G8.format.filter.EqualTo=xM,G8.format.filter.GreaterThan=SM,G8.format.filter.GreaterThanOrEqualTo=OM,G8.format.filter.Intersects=TM,G8.format.filter.IsBetween=RM,G8.format.filter.IsLike=MM,G8.format.filter.IsNull=NM,G8.format.filter.LessThan=FM,G8.format.filter.LessThanOrEqualTo=jM,G8.format.filter.Not=zM,G8.format.filter.NotEqualTo=BM,G8.format.filter.Or=qM,G8.format.filter.Within=XM,G8.format.filter.and=HM,G8.format.filter.bbox=ZM,G8.format.filter.between=function(t,e,r){return new RM(t,e,r)},G8.format.filter.contains=function(t,e,r){return new cM(t,e,r)},G8.format.filter.disjoint=function(t,e,r){return new dM(t,e,r)},G8.format.filter.during=function(t,e,r){return new _M(t,e,r)},G8.format.filter.dwithin=function(t,e,r,n,i){return new fM(t,e,r,n,i)},G8.format.filter.equalTo=function(t,e,r){return new xM(t,e,r)},G8.format.filter.greaterThan=function(t,e){return new SM(t,e)},G8.format.filter.greaterThanOrEqualTo=function(t,e){return new OM(t,e)},G8.format.filter.intersects=function(t,e,r){return new TM(t,e,r)},G8.format.filter.isNull=function(t){return new NM(t)},G8.format.filter.lessThan=function(t,e){return new FM(t,e)},G8.format.filter.lessThanOrEqualTo=function(t,e){return new jM(t,e)},G8.format.filter.like=function(t,e,r,n,i,o){return new MM(t,e,r,n,i,o)},G8.format.filter.not=function(t){return new zM(t)},G8.format.filter.notEqualTo=function(t,e,r){return new BM(t,e,r)},G8.format.filter.or=function(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(qM,e))},G8.format.filter.within=function(t,e,r){return new XM(t,e,r)},G8.geom={},G8.geom.Circle=Hg,G8.geom.Geometry=Vu,G8.geom.GeometryCollection=Yg,G8.geom.LineString=Fg,G8.geom.LinearRing=fc,G8.geom.MultiLineString=zg,G8.geom.MultiPoint=jg,G8.geom.MultiPolygon=Bg,G8.geom.Point=dc,G8.geom.Polygon=Rc,G8.geom.Polygon.circular=Lc,G8.geom.Polygon.fromCircle=kc,G8.geom.Polygon.fromExtent=Mc,G8.geom.SimpleGeometry=Wu,G8.has={},G8.has.DEVICE_PIXEL_RATIO=bs,G8.interaction={},G8.interaction.DoubleClickZoom=sh,G8.interaction.DragAndDrop=i1,G8.interaction.DragBox=Fh,G8.interaction.DragPan=Ih,G8.interaction.DragRotate=Ch,G8.interaction.DragRotateAndZoom=s1,G8.interaction.DragZoom=jh,G8.interaction.Draw=y1,G8.interaction.Draw.createBox=function(){return function(t,e,r){var n=ct([t[0],t[t.length-1]].map((function(t){return Ne(t,r)}))),i=[[Rt(n),Lt(n),jt(n),Dt(n),Rt(n)]],o=e;o?o.setCoordinates(i):o=new Rc(i);var s=Me();return s&&o.transform(r,s),o}},G8.interaction.Draw.createRegularPolygon=function(t,e){return function(r,n,i){var o=Ne(r[0],i),s=Ne(r[r.length-1],i),a=Math.sqrt(ae(o,s)),l=n||kc(new Hg(o),t),u=e;if(!e&&0!==e){var c=s[0]-o[0],h=s[1]-o[1];u=Math.atan2(h,c)}Nc(l,o,a,u);var f=Me();return f&&l.transform(i,f),l}},G8.interaction.Extent=E1,G8.interaction.Interaction=ih,G8.interaction.KeyboardPan=qh,G8.interaction.KeyboardZoom=Wh,G8.interaction.Modify=N1,G8.interaction.MouseWheelZoom=$h,G8.interaction.PinchRotate=Qh,G8.interaction.PinchZoom=ef,G8.interaction.Pointer=uh,G8.interaction.Select=eI,G8.interaction.Snap=j1,G8.interaction.Translate=q1,G8.interaction.defaults=rf,G8.layer={},G8.layer.Base=ka,G8.layer.BaseImage=ig,G8.layer.BaseTile=Gd,G8.layer.BaseVector=tS,G8.layer.Graticule=Z1,G8.layer.Group=Bl,G8.layer.Heatmap=CW,G8.layer.Image=lg,G8.layer.Layer=Ya,G8.layer.MapboxVector=$2,G8.layer.Tile=rg,G8.layer.Vector=zS,G8.layer.VectorImage=n3,G8.layer.VectorTile=jU,G8.layer.VectorTileRenderType={},G8.layer.VectorTileRenderType.HYBRID=void 0,G8.layer.VectorTileRenderType.IMAGE=void 0,G8.layer.VectorTileRenderType.VECTOR=void 0,G8.layer.WebGLTile=J3,G8.loadingstrategy={},G8.loadingstrategy.all=Ob,G8.loadingstrategy.bbox=function(t,e){return[t]},G8.loadingstrategy.tile=function(t){return function(e,r,n){var i=t.getZForResolution(function(t,e){if(!Le)return t;var r=ye(e).getUnits(),n=Le.getUnits();return r&&n?t*p[n]/p[r]:t}(r,n)),o=t.getTileRangeForExtentAndZ(Fe(e,n),i),s=[],a=[i,0,0];for(a[1]=o.minX;a[1]<=o.maxX;++a[1])for(a[2]=o.minY;a[2]<=o.maxY;++a[2])s.push(Ae(t.getTileCoordExtent(a),n));return s}},G8.proj={},G8.proj.Projection=g,G8.proj.Units=d,G8.proj.Units.METERS_PER_UNIT=p,G8.proj.addCoordinateTransforms=we,G8.proj.addEquivalentProjections=_e,G8.proj.addProjection=ge,G8.proj.equivalent=Ee,G8.proj.fromLonLat=xe,G8.proj.get=ye,G8.proj.getPointResolution=me,G8.proj.getTransform=Ie,G8.proj.proj4={},G8.proj.proj4.register=as,G8.proj.toLonLat=function(t,e){var r=Oe(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),n=r[0];return(n<-180||n>180)&&(r[0]=E(n+180,360)-180),r},G8.proj.transform=Oe,G8.proj.transformExtent=Ce,G8.render={},G8.render.VectorContext=fw,G8.render.canvas={},G8.render.canvas.labelCache=wl,G8.render.getRenderPixel=function(t,e){var r=e.slice(0);return Ts(t.inversePixelTransform.slice(),r),r},G8.render.getVectorContext=Pw,G8.render.toContext=Tw,G8.renderer={},G8.renderer.Composite=kl,G8.renderer.canvas={},G8.renderer.canvas.ImageLayer=sg,G8.renderer.canvas.TileLayer=tg,G8.renderer.canvas.VectorImageLayer=e3,G8.renderer.canvas.VectorLayer=jS,G8.renderer.canvas.VectorTileLayer=FU,G8.renderer.webgl={},G8.renderer.webgl.PointsLayer=wW,G8.renderer.webgl.TileLayer=S3,G8.size={},G8.size.toSize=Vc,G8.source={},G8.source.BingMaps=t5,G8.source.CartoDB=r5,G8.source.Cluster=jb,G8.source.DataTile=s5,G8.source.GeoTIFF=X6,G8.source.IIIF=e8,G8.source.Image=g_,G8.source.ImageArcGISRest=n8,G8.source.ImageCanvas=o8,G8.source.ImageMapGuide=l8,G8.source.ImageStatic=c8,G8.source.ImageWMS=__,G8.source.OSM=oU,G8.source.OSM.ATTRIBUTION=iU,G8.source.Raster=I8,G8.source.Source=Im,G8.source.Stamen=R8,G8.source.Tile=Nm,G8.source.TileArcGISRest=M8,G8.source.TileDebug=N8,G8.source.TileImage=qm,G8.source.TileJSON=J1,G8.source.TileWMS=$m,G8.source.UTFGrid=D8,G8.source.Vector=Fb,G8.source.VectorTile=TU,G8.source.WMSServerType={},G8.source.WMSServerType.CARMENTA_SERVER=void 0,G8.source.WMSServerType.GEOSERVER=void 0,G8.source.WMSServerType.MAPSERVER=void 0,G8.source.WMSServerType.QGIS=void 0,G8.source.WMTS=wz,G8.source.WMTS.optionsFromCapabilities=xz,G8.source.XYZ=zz,G8.source.Zoomify=J6,G8.sphere={},G8.sphere.getArea=function t(e,r){var n=r||{},i=n.radius||Wt,o=n.projection||"EPSG:3857",s=e.getType();s!==Yt.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,l,u,c,h,f,p=0;switch(s){case Yt.POINT:case Yt.MULTI_POINT:case Yt.LINE_STRING:case Yt.MULTI_LINE_STRING:case Yt.LINEAR_RING:break;case Yt.POLYGON:for(a=e.getCoordinates(),p=Math.abs(Zt(a[0],i)),u=1,c=a.length;u<c;++u)p-=Math.abs(Zt(a[u],i));break;case Yt.MULTI_POLYGON:for(u=0,c=(a=e.getCoordinates()).length;u<c;++u)for(l=a[u],p+=Math.abs(Zt(l[0],i)),h=1,f=l.length;h<f;++h)p-=Math.abs(Zt(l[h],i));break;case Yt.GEOMETRY_COLLECTION:var d=e.getGeometries();for(u=0,c=d.length;u<c;++u)p+=t(d[u],r);break;default:throw new Error("Unsupported geometry type: "+s)}return p},G8.sphere.getDistance=Xt,G8.sphere.getLength=function t(e,r){var n=r||{},i=n.radius||Wt,o=n.projection||"EPSG:3857",s=e.getType();s!==Yt.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,l,u,c,h,f,p=0;switch(s){case Yt.POINT:case Yt.MULTI_POINT:break;case Yt.LINE_STRING:case Yt.LINEAR_RING:p=Ht(a=e.getCoordinates(),i);break;case Yt.MULTI_LINE_STRING:case Yt.POLYGON:for(u=0,c=(a=e.getCoordinates()).length;u<c;++u)p+=Ht(a[u],i);break;case Yt.MULTI_POLYGON:for(u=0,c=(a=e.getCoordinates()).length;u<c;++u)for(h=0,f=(l=a[u]).length;h<f;++h)p+=Ht(l[h],i);break;case Yt.GEOMETRY_COLLECTION:var d=e.getGeometries();for(u=0,c=d.length;u<c;++u)p+=t(d[u],r);break;default:throw new Error("Unsupported geometry type: "+s)}return p},G8.style={},G8.style.Circle=Jw,G8.style.Fill=Kb,G8.style.Icon=hw,G8.style.IconAnchorUnits={},G8.style.IconAnchorUnits.FRACTION=void 0,G8.style.IconAnchorUnits.PIXELS=void 0,G8.style.IconImageCache={},G8.style.IconImageCache.shared=Ys,G8.style.IconOrigin={},G8.style.IconOrigin.BOTTOM_LEFT=void 0,G8.style.IconOrigin.BOTTOM_RIGHT=void 0,G8.style.IconOrigin.TOP_LEFT=void 0,G8.style.IconOrigin.TOP_RIGHT=void 0,G8.style.Image=sw,G8.style.RegularShape=Kw,G8.style.Stroke=Zb,G8.style.Style=ox,G8.style.Text=Qb,G8.tilegrid={},G8.tilegrid.TileGrid=gg,G8.tilegrid.WMTS=_z,G8.tilegrid.WMTS.createFromCapabilitiesMatrixSet=vz,G8.tilegrid.createXYZ=Cm,G8.transform={},G8.transform.composeCssTransform=function(t,e,r,n,i,o,s){return Ms(Rs([1,0,0,1,0,0],t,e,r,n,i,o,s))},G8.util={},G8.util.getUid=st.c,G8.webgl={},G8.webgl.ARRAY_BUFFER=BY,G8.webgl.Buffer=KY,G8.webgl.DYNAMIC_DRAW=YY,G8.webgl.ELEMENT_ARRAY_BUFFER=VY,G8.webgl.Helper=hW,G8.webgl.Helper.computeAttributesStride=uW,G8.webgl.PostProcessingPass=QY,G8.webgl.RenderTarget=mW,G8.webgl.STATIC_DRAW=qY,G8.webgl.STREAM_DRAW=35040,G8.xml={},G8.xml.getAllTextContent=Ke,G8.xml.parse=Qe,G8.xml.registerDocument=function(t){yr=t},G8.xml.registerXMLSerializer=function(t){gr=t},window.jsts=r(107),window.Handlebars=r(8),j8.plugin={}},,,,function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return i}));var n=r(5);class i extends n.a{decodeBlock(t){return t}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return s}));var n=r(5);function i(t,e){for(let r=e.length-1;r>=0;r--)t.push(e[r]);return t}function o(t){const e=new Uint16Array(4093),r=new Uint8Array(4093);for(let t=0;t<=257;t++)e[t]=4096,r[t]=t;let n=258,o=9,s=0;function a(){n=258,o=9}function l(t){const e=function(t,e,r){const n=e%8,i=Math.floor(e/8),o=8-n,s=e+r-8*(i+1);let a=8*(i+2)-(e+r);const l=8*(i+2)-e;if(a=Math.max(0,a),i>=t.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let u=t[i]&2**(8-n)-1;u<<=r-o;let c=u;if(i+1<t.length){let e=t[i+1]>>>a;e<<=Math.max(0,r-l),c+=e}if(s>8&&i+2<t.length){const n=8*(i+3)-(e+r);c+=t[i+2]>>>n}return c}(t,s,o);return s+=o,e}function u(t,i){return r[n]=i,e[n]=t,n++,n-1}function c(t){const n=[];for(let i=t;4096!==i;i=e[i])n.push(r[i]);return n}const h=[];a();const f=new Uint8Array(t);let p,d=l(f);for(;257!==d;){if(256===d){for(a(),d=l(f);256===d;)d=l(f);if(257===d)break;if(d>256)throw new Error("corrupted code at scanline "+d);i(h,c(d)),p=d}else if(d<n){const t=c(d);i(h,t),u(p,t[t.length-1]),p=d}else{const t=c(p);if(!t)throw new Error(`Bogus entry. Not in dictionary, ${p} / ${n}, position: ${s}`);i(h,t),h.push(t[t.length-1]),u(p,t[t.length-1]),p=d}n+1>=2**o&&(12===o?p=void 0:o++),d=l(f)}return new Uint8Array(h)}class s extends n.a{decodeBlock(t){return o(t).buffer}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return m}));var n=r(5);const i=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,s=799,a=3406,l=2276,u=1567,c=3784,h=5793,f=2896;function p(t,e){let r=0;const n=[];let i=16;for(;i>0&&!t[i-1];)--i;n.push({children:[],index:0});let o,s=n[0];for(let a=0;a<i;a++){for(let i=0;i<t[a];i++){for(s=n.pop(),s.children[s.index]=e[r];s.index>0;)s=n.pop();for(s.index++,n.push(s);n.length<=a;)n.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<i&&(n.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return n[0].children}function d(t,e,r,n,o,s,a,l,u){const{mcusPerLine:c,progressive:h}=r,f=e;let p=e,d=0,g=0;function y(){if(g>0)return g--,d>>g&1;if(d=t[p++],255===d){const e=t[p++];if(e)throw new Error("unexpected marker: "+(d<<8|e).toString(16))}return g=7,d>>>7}function m(t){let e,r=t;for(;null!==(e=y());){if(r=r[e],"number"==typeof r)return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function _(t){let e=t,r=0;for(;e>0;){const t=y();if(null===t)return;r=r<<1|t,--e}return r}function v(t){const e=_(t);return e>=1<<t-1?e:e+(-1<<t)+1}let b=0;let w,x=0;function E(t,e,r,n,i){const o=r%c,s=(r/c|0)*t.v+n,a=o*t.h+i;e(t,t.blocks[s][a])}function S(t,e,r){const n=r/t.blocksPerLine|0,i=r%t.blocksPerLine;e(t,t.blocks[n][i])}const I=n.length;let O,C,T,P,R,L;L=h?0===s?0===l?function(t,e){const r=m(t.huffmanTableDC),n=0===r?0:v(r)<<u;t.pred+=n,e[0]=t.pred}:function(t,e){e[0]|=y()<<u}:0===l?function(t,e){if(b>0)return void b--;let r=s;const n=a;for(;r<=n;){const n=m(t.huffmanTableAC),o=15&n,s=n>>4;if(0===o){if(s<15){b=_(s)+(1<<s)-1;break}r+=16}else r+=s,e[i[r]]=v(o)*(1<<u),r++}}:function(t,e){let r=s;const n=a;let o=0;for(;r<=n;){const n=i[r],s=e[n]<0?-1:1;switch(x){case 0:{const e=m(t.huffmanTableAC),r=15&e;if(o=e>>4,0===r)o<15?(b=_(o)+(1<<o),x=4):(o=16,x=1);else{if(1!==r)throw new Error("invalid ACn encoding");w=v(r),x=o?2:3}continue}case 1:case 2:e[n]?e[n]+=(y()<<u)*s:(o--,0===o&&(x=2===x?3:0));break;case 3:e[n]?e[n]+=(y()<<u)*s:(e[n]=w<<u,x=0);break;case 4:e[n]&&(e[n]+=(y()<<u)*s)}r++}4===x&&(b--,0===b&&(x=0))}:function(t,e){const r=m(t.huffmanTableDC),n=0===r?0:v(r);t.pred+=n,e[0]=t.pred;let o=1;for(;o<64;){const r=m(t.huffmanTableAC),n=15&r,s=r>>4;if(0===n){if(s<15)break;o+=16}else o+=s,e[i[o]]=v(n),o++}};let M,k,N=0;k=1===I?n[0].blocksPerLine*n[0].blocksPerColumn:c*r.mcusPerColumn;const A=o||k;for(;N<k;){for(C=0;C<I;C++)n[C].pred=0;if(b=0,1===I)for(O=n[0],R=0;R<A;R++)S(O,L,N),N++;else for(R=0;R<A;R++){for(C=0;C<I;C++){O=n[C];const{h:t,v:e}=O;for(T=0;T<e;T++)for(P=0;P<t;P++)E(O,L,N,T,P)}if(N++,N===k)break}if(g=0,M=t[p]<<8|t[p+1],M<65280)throw new Error("marker was not found");if(!(M>=65488&&M<=65495))break;p+=2}return p-f}function g(t,e){const r=[],{blocksPerLine:n,blocksPerColumn:i}=e,p=n<<3,d=new Int32Array(64),g=new Uint8Array(64);function y(t,r,n){const i=e.quantizationTable;let p,d,g,y,m,_,v,b,w;const x=n;let E;for(E=0;E<64;E++)x[E]=t[E]*i[E];for(E=0;E<8;++E){const t=8*E;0!==x[1+t]||0!==x[2+t]||0!==x[3+t]||0!==x[4+t]||0!==x[5+t]||0!==x[6+t]||0!==x[7+t]?(p=h*x[0+t]+128>>8,d=h*x[4+t]+128>>8,g=x[2+t],y=x[6+t],m=f*(x[1+t]-x[7+t])+128>>8,b=f*(x[1+t]+x[7+t])+128>>8,_=x[3+t]<<4,v=x[5+t]<<4,w=p-d+1>>1,p=p+d+1>>1,d=w,w=g*c+y*u+128>>8,g=g*u-y*c+128>>8,y=w,w=m-v+1>>1,m=m+v+1>>1,v=w,w=b+_+1>>1,_=b-_+1>>1,b=w,w=p-y+1>>1,p=p+y+1>>1,y=w,w=d-g+1>>1,d=d+g+1>>1,g=w,w=m*l+b*a+2048>>12,m=m*a-b*l+2048>>12,b=w,w=_*s+v*o+2048>>12,_=_*o-v*s+2048>>12,v=w,x[0+t]=p+b,x[7+t]=p-b,x[1+t]=d+v,x[6+t]=d-v,x[2+t]=g+_,x[5+t]=g-_,x[3+t]=y+m,x[4+t]=y-m):(w=h*x[0+t]+512>>10,x[0+t]=w,x[1+t]=w,x[2+t]=w,x[3+t]=w,x[4+t]=w,x[5+t]=w,x[6+t]=w,x[7+t]=w)}for(E=0;E<8;++E){const t=E;0!==x[8+t]||0!==x[16+t]||0!==x[24+t]||0!==x[32+t]||0!==x[40+t]||0!==x[48+t]||0!==x[56+t]?(p=h*x[0+t]+2048>>12,d=h*x[32+t]+2048>>12,g=x[16+t],y=x[48+t],m=f*(x[8+t]-x[56+t])+2048>>12,b=f*(x[8+t]+x[56+t])+2048>>12,_=x[24+t],v=x[40+t],w=p-d+1>>1,p=p+d+1>>1,d=w,w=g*c+y*u+2048>>12,g=g*u-y*c+2048>>12,y=w,w=m-v+1>>1,m=m+v+1>>1,v=w,w=b+_+1>>1,_=b-_+1>>1,b=w,w=p-y+1>>1,p=p+y+1>>1,y=w,w=d-g+1>>1,d=d+g+1>>1,g=w,w=m*l+b*a+2048>>12,m=m*a-b*l+2048>>12,b=w,w=_*s+v*o+2048>>12,_=_*o-v*s+2048>>12,v=w,x[0+t]=p+b,x[56+t]=p-b,x[8+t]=d+v,x[48+t]=d-v,x[16+t]=g+_,x[40+t]=g-_,x[24+t]=y+m,x[32+t]=y-m):(w=h*n[E+0]+8192>>14,x[0+t]=w,x[8+t]=w,x[16+t]=w,x[24+t]=w,x[32+t]=w,x[40+t]=w,x[48+t]=w,x[56+t]=w)}for(E=0;E<64;++E){const t=128+(x[E]+8>>4);r[E]=t<0?0:t>255?255:t}}for(let t=0;t<i;t++){const i=t<<3;for(let t=0;t<8;t++)r.push(new Uint8Array(p));for(let o=0;o<n;o++){y(e.blocks[t][o],g,d);let n=0;const s=o<<3;for(let t=0;t<8;t++){const e=r[i+t];for(let t=0;t<8;t++)e[s+t]=g[n++]}}}return r}class y{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(t){let e=0;function r(){const r=t[e]<<8|t[e+1];return e+=2,r}function n(){const n=r(),i=t.subarray(e,e+n-2);return e+=i.length,i}function o(t){let e,r,n=0,i=0;for(r in t.components)t.components.hasOwnProperty(r)&&(e=t.components[r],n<e.h&&(n=e.h),i<e.v&&(i=e.v));const o=Math.ceil(t.samplesPerLine/8/n),s=Math.ceil(t.scanLines/8/i);for(r in t.components)if(t.components.hasOwnProperty(r)){e=t.components[r];const a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/n),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/i),u=o*e.h,c=s*e.v,h=[];for(let t=0;t<c;t++){const t=[];for(let e=0;e<u;e++)t.push(new Int32Array(64));h.push(t)}e.blocksPerLine=a,e.blocksPerColumn=l,e.blocks=h}t.maxH=n,t.maxV=i,t.mcusPerLine=o,t.mcusPerColumn=s}let s=r();if(65496!==s)throw new Error("SOI not found");for(s=r();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const t=n();65504===s&&74===t[0]&&70===t[1]&&73===t[2]&&70===t[3]&&0===t[4]&&(this.jfif={version:{major:t[5],minor:t[6]},densityUnits:t[7],xDensity:t[8]<<8|t[9],yDensity:t[10]<<8|t[11],thumbWidth:t[12],thumbHeight:t[13],thumbData:t.subarray(14,14+3*t[12]*t[13])}),65518===s&&65===t[0]&&100===t[1]&&111===t[2]&&98===t[3]&&101===t[4]&&0===t[5]&&(this.adobe={version:t[6],flags0:t[7]<<8|t[8],flags1:t[9]<<8|t[10],transformCode:t[11]});break}case 65499:{const n=r()+e-2;for(;e<n;){const n=t[e++],o=new Int32Array(64);if(n>>4==0)for(let r=0;r<64;r++){o[i[r]]=t[e++]}else{if(n>>4!=1)throw new Error("DQT: invalid table spec");for(let t=0;t<64;t++){o[i[t]]=r()}}this.quantizationTables[15&n]=o}break}case 65472:case 65473:case 65474:{r();const n={extended:65473===s,progressive:65474===s,precision:t[e++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},i=t[e++];let a;for(let r=0;r<i;r++){a=t[e];const r=t[e+1]>>4,i=15&t[e+1],o=t[e+2];n.componentsOrder.push(a),n.components[a]={h:r,v:i,quantizationIdx:o},e+=3}o(n),this.frames.push(n);break}case 65476:{const n=r();for(let r=2;r<n;){const n=t[e++],i=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,e++)i[r]=t[e],o+=i[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,e++)s[r]=t[e];r+=17+o,n>>4==0?this.huffmanTablesDC[15&n]=p(i,s):this.huffmanTablesAC[15&n]=p(i,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const n=t[e++],i=[],o=this.frames[0];for(let r=0;r<n;r++){const r=o.components[t[e++]],n=t[e++];r.huffmanTableDC=this.huffmanTablesDC[n>>4],r.huffmanTableAC=this.huffmanTablesAC[15&n],i.push(r)}const s=t[e++],a=t[e++],l=t[e++],u=d(t,e,o,i,this.resetInterval,s,a,l>>4,15&l);e+=u;break}case 65535:255!==t[e]&&e--;break;default:if(255===t[e-3]&&t[e-2]>=192&&t[e-2]<=254){e-=3;break}throw new Error("unknown JPEG marker "+s.toString(16))}s=r()}}getResult(){const{frames:t}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let t=0;t<this.frames.length;t++){const e=this.frames[t].components;for(const t of Object.keys(e))e[t].quantizationTable=this.quantizationTables[e[t].quantizationIdx],delete e[t].quantizationIdx}const e=t[0],{components:r,componentsOrder:n}=e,i=[],o=e.samplesPerLine,s=e.scanLines;for(let t=0;t<n.length;t++){const o=r[n[t]];i.push({lines:g(0,o),scaleX:o.h/e.maxH,scaleY:o.v/e.maxV})}const a=new Uint8Array(o*s*i.length);let l=0;for(let t=0;t<s;++t)for(let e=0;e<o;++e)for(let r=0;r<i.length;++r){const n=i[r];a[l]=n.lines[0|t*n.scaleY][0|e*n.scaleX],++l}return a}}class m extends n.a{constructor(t){super(),this.reader=new y,t.JPEGTables&&this.reader.parse(t.JPEGTables)}decodeBlock(t){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(t)),this.reader.getResult().buffer}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var n=r(19),i=r(5);class o extends i.a{decodeBlock(t){return Object(n.a)(new Uint8Array(t)).buffer}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return i}));var n=r(5);class i extends n.a{decodeBlock(t){const e=new DataView(t),r=[];for(let n=0;n<t.byteLength;++n){let t=e.getInt8(n);if(t<0){const i=e.getUint8(n+1);t=-t;for(let e=0;e<=t;++e)r.push(i);n+=1}else{for(let i=0;i<=t;++i)r.push(e.getUint8(n+i+1));n+=t+1}}return new Uint8Array(r).buffer}}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return l}));var n=r(19),i=r(65),o=r.n(i),s=r(5),a=r(1);class l extends s.a{constructor(t){super(),this.planarConfiguration=void 0!==t.PlanarConfiguration?t.PlanarConfiguration:1,this.samplesPerPixel=void 0!==t.SamplesPerPixel?t.SamplesPerPixel:1,this.addCompression=t.LercParameters[a.c.AddCompression]}decodeBlock(t){switch(this.addCompression){case a.b.None:break;case a.b.Deflate:t=Object(n.a)(new Uint8Array(t)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: "+this.addCompression)}return o.a.decode(t,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}},function(t,e,r){"use strict";var n=r(15),i=r(55);var o=function(t){"function"==typeof t?t():t&&"function"==typeof t.unsubscribe&&t.unsubscribe()};e.a=function(t){const e=new i.a;let r,s=0;return new n.a(n=>{r||(r=t.subscribe(e));const i=e.subscribe(n);return s++,()=>{s--,i.unsubscribe(),0===s&&(o(r),r=void 0)}})}}]);
//# sourceMappingURL=mapea-6.1.0.ol.min.js.map